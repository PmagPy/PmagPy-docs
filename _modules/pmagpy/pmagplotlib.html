
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>pmagpy.pmagplotlib &#8212; PmagPy Documentation</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/pmagpy_logo_notext.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">PmagPy Documentation</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    PmagPy: An open source package for paleomagnetic data analysis
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Installation
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../installation/PmagPy_install.html">
   Installing
   <strong>
    PmagPy
   </strong>
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../installation/osx_pip.html">
     OSX pip install
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../installation/osx_developer.html">
     OSX developer install
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../installation/windows_pip.html">
     Windows pip install
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../installation/windows_developer.html">
     Windows developer install
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../installation/linux_pip.html">
     Linux pip install
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../installation/linux_developer.html">
     Linux developer install
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Documentation notebooks
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../documentation_notebooks/PmagPy_introduction.html">
   Introduction to PmagPy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../documentation_notebooks/PmagPy_calculations.html">
   Calculations with PmagPy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../documentation_notebooks/PmagPy_plots_analysis.html">
   Visualizations and more analysis with PmagPy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../documentation_notebooks/PmagPy_MagIC.html">
   Working with the MagIC database using PmagPy
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Example notebooks
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../example_notebooks/example_notebooks.html">
   Example notebooks
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../example_notebooks/Tauxe_etal_2016.html">
     Tauxe et al. 2016 example notebook
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Function docstrings
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../api/api.html">
   API Reference
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/pmagpy/pmagpy-docs"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/pmagpy/pmagpy-docs/issues/new?title=Issue%20on%20page%20%2F_modules/pmagpy/pmagplotlib.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1></h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <h1>Source code for pmagpy.pmagplotlib</h1><div class="highlight"><pre>
<span></span><span class="c1"># /usr/bin/env pythonw</span>

<span class="c1"># pylint: skip-file</span>
<span class="c1"># pylint: disable-all</span>
<span class="c1"># causes too many errors and crashes</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="kn">from</span> <span class="nn">past.utils</span> <span class="kn">import</span> <span class="n">old_div</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>  <span class="c1"># what you don&#39;t know won&#39;t hurt you</span>
<span class="kn">from</span> <span class="nn">distutils.version</span> <span class="kn">import</span> <span class="n">LooseVersion</span>

<span class="c1"># no longer setting backend here</span>
<span class="kn">from</span> <span class="nn">pmag_env</span> <span class="kn">import</span> <span class="n">set_env</span>
<span class="n">isServer</span> <span class="o">=</span> <span class="n">set_env</span><span class="o">.</span><span class="n">isServer</span>
<span class="n">verbose</span> <span class="o">=</span> <span class="n">set_env</span><span class="o">.</span><span class="n">verbose</span>

<span class="kn">from</span> <span class="nn">pmagpy</span> <span class="kn">import</span> <span class="n">pmag</span>
<span class="kn">from</span> <span class="nn">pmagpy</span> <span class="kn">import</span> <span class="n">find_pmag_dir</span>
<span class="kn">from</span> <span class="nn">pmagpy</span> <span class="kn">import</span> <span class="n">contribution_builder</span> <span class="k">as</span> <span class="n">cb</span>
<span class="n">has_cartopy</span><span class="p">,</span> <span class="n">Cartopy</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">import_cartopy</span><span class="p">()</span>
<span class="k">if</span> <span class="n">has_cartopy</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>
    <span class="kn">from</span> <span class="nn">cartopy</span> <span class="kn">import</span> <span class="n">config</span>
    <span class="kn">from</span> <span class="nn">cartopy.mpl.ticker</span> <span class="kn">import</span> <span class="n">LongitudeFormatter</span><span class="p">,</span> <span class="n">LatitudeFormatter</span>
    <span class="kn">from</span> <span class="nn">cartopy.mpl.gridliner</span> <span class="kn">import</span> <span class="n">LONGITUDE_FORMATTER</span><span class="p">,</span> <span class="n">LATITUDE_FORMATTER</span>
    <span class="kn">from</span> <span class="nn">cartopy</span> <span class="kn">import</span> <span class="n">feature</span> <span class="k">as</span> <span class="n">cfeature</span>
    <span class="kn">from</span> <span class="nn">cartopy.feature</span> <span class="kn">import</span> <span class="n">NaturalEarthFeature</span><span class="p">,</span> <span class="n">LAND</span><span class="p">,</span> <span class="n">COASTLINE</span><span class="p">,</span> <span class="n">OCEAN</span><span class="p">,</span> <span class="n">LAKES</span><span class="p">,</span> <span class="n">BORDERS</span>
<span class="n">has_basemap</span><span class="p">,</span> <span class="n">Basemap</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">import_basemap</span><span class="p">()</span>


<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">cm</span> <span class="k">as</span> <span class="n">color_map</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">pylab</span> <span class="kn">import</span> <span class="n">meshgrid</span>  <span class="c1"># matplotlib&#39;s meshgrid function</span>
<span class="kn">import</span> <span class="nn">matplotlib.ticker</span> <span class="k">as</span> <span class="nn">mticker</span>
<span class="nb">globals</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">graphmenu</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">global</span> <span class="n">version_num</span>
<span class="n">version_num</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">get_version</span><span class="p">()</span>

<span class="c1"># if running on a server use Agg to avoid $DISPLAY not found errors</span>
<span class="k">if</span> <span class="n">isServer</span><span class="p">:</span>
    <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">switch_backend</span><span class="p">(</span><span class="s1">&#39;Agg&#39;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">__version__</span> <span class="o">&lt;</span> <span class="s1">&#39;2.1&#39;</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;-W- Please upgrade to matplotlib &gt;= 2.1</span>
<span class="s2">    On the command line, for Anaconda users:</span>
<span class="s2">       conda upgrade matplotlib</span>
<span class="s2">    For those with an alternative Python distribution:</span>
<span class="s2">       pip install matplotlib --upgrade</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">show_fig</span><span class="p">(</span><span class="n">fig</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<div class="viewcode-block" id="draw_figs"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmagplotlib.draw_figs">[docs]</a><span class="k">def</span> <span class="nf">draw_figs</span><span class="p">(</span><span class="n">FIGS</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Can only be used if matplotlib backend is set to TKAgg</span>
<span class="sd">    Does not play well with wxPython</span>
<span class="sd">    Parameters</span>
<span class="sd">    _________</span>
<span class="sd">    FIGS : dictionary of figure names as keys and numbers as values</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">is_win</span> <span class="o">=</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;win32&#39;</span><span class="p">,</span> <span class="s1">&#39;win64&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">is_win</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ion</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">fig</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">FIGS</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ioff</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">is_win</span><span class="p">:</span>
        <span class="c1"># this style basically works for Windows</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;You must manually close all plots to continue&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


<span class="k">def</span> <span class="nf">clearFIG</span><span class="p">(</span><span class="n">fignum</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">fignum</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">isServer</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figtext</span><span class="p">(</span><span class="mf">.02</span><span class="p">,</span> <span class="mf">.01</span><span class="p">,</span> <span class="n">version_num</span><span class="p">)</span>

<span class="c1"># def gui_init(gvars,interface):</span>
<span class="c1">#	global globals, graphmenu</span>
<span class="c1">##	globals = gvars</span>
<span class="c1">##	graphmenu = interface</span>
<span class="c1">#</span>


<span class="k">def</span> <span class="nf">click</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;you clicked&#39;</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">xdata</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">ydata</span><span class="p">)</span>
<span class="c1">#</span>
<span class="c1">#</span>


<div class="viewcode-block" id="delticks"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmagplotlib.delticks">[docs]</a><span class="k">def</span> <span class="nf">delticks</span><span class="p">(</span><span class="n">fig</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">     deletes half the x-axis tick marks</span>
<span class="sd">    Parameters</span>
<span class="sd">    ___________</span>
<span class="sd">    fig : matplotlib figure number</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">locs</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_ticklocs</span><span class="p">()</span>
    <span class="n">nlocs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">locs</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">locs</span><span class="p">),</span> <span class="mi">2</span><span class="p">)))</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">nlocs</span><span class="p">)</span></div>


<span class="n">fig_x_pos</span> <span class="o">=</span> <span class="mi">25</span>
<span class="n">fig_y_pos</span> <span class="o">=</span> <span class="mi">25</span>
<span class="n">plt_num</span> <span class="o">=</span> <span class="mi">0</span>


<div class="viewcode-block" id="plot_init"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmagplotlib.plot_init">[docs]</a><span class="k">def</span> <span class="nf">plot_init</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    initializes plot number fignum with width w and height h</span>
<span class="sd">    Parameters</span>
<span class="sd">    __________</span>
<span class="sd">    fignum : matplotlib figure number</span>
<span class="sd">    w : width</span>
<span class="sd">    h : height</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">fig_x_pos</span><span class="p">,</span> <span class="n">fig_y_pos</span><span class="p">,</span> <span class="n">plt_num</span>
    <span class="n">dpi</span> <span class="o">=</span> <span class="mi">80</span>
    <span class="k">if</span> <span class="n">isServer</span><span class="p">:</span>
        <span class="n">dpi</span> <span class="o">=</span> <span class="mi">240</span>
    <span class="c1"># plt.ion()</span>
    <span class="n">plt_num</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">fignum</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">isServer</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">set_env</span><span class="o">.</span><span class="n">IS_NOTEBOOK</span><span class="p">):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">get_current_fig_manager</span><span class="p">()</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="c1"># plt.get_current_fig_manager().window.wm_geometry(&#39;+%d+%d&#39; %</span>
        <span class="c1"># (fig_x_pos,fig_y_pos)) # this only works with matplotlib.use(&#39;TKAgg&#39;)</span>
        <span class="n">fig_x_pos</span> <span class="o">=</span> <span class="n">fig_x_pos</span> <span class="o">+</span> <span class="n">dpi</span> <span class="o">*</span> <span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="o">+</span> <span class="mi">25</span>
        <span class="k">if</span> <span class="n">plt_num</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">plt_num</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">fig_x_pos</span> <span class="o">=</span> <span class="mi">25</span>
            <span class="n">fig_y_pos</span> <span class="o">=</span> <span class="n">fig_y_pos</span> <span class="o">+</span> <span class="n">dpi</span> <span class="o">*</span> <span class="p">(</span><span class="n">h</span><span class="p">)</span> <span class="o">+</span> <span class="mi">25</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figtext</span><span class="p">(</span><span class="mf">.02</span><span class="p">,</span> <span class="mf">.01</span><span class="p">,</span> <span class="n">version_num</span><span class="p">)</span>
<span class="c1"># plt.connect(&#39;button_press_event&#39;,click)</span>
<span class="c1">#</span>
    <span class="c1"># plt.ioff()</span>
    <span class="k">return</span> <span class="n">fig</span></div>


<div class="viewcode-block" id="plot3d_init"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmagplotlib.plot3d_init">[docs]</a><span class="k">def</span> <span class="nf">plot3d_init</span><span class="p">(</span><span class="n">fignum</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    initializes 3D plot</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">fignum</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax</span></div>


<div class="viewcode-block" id="plot_square"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmagplotlib.plot_square">[docs]</a><span class="k">def</span> <span class="nf">plot_square</span><span class="p">(</span><span class="n">fignum</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    makes the figure square (equal axes)</span>
<span class="sd">    Parameters</span>
<span class="sd">    __________</span>
<span class="sd">    fignum : matplotlib figure number</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">fignum</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="gaussfunc"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmagplotlib.gaussfunc">[docs]</a><span class="k">def</span> <span class="nf">gaussfunc</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">ybar</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    cumulative normal distribution function of the variable y</span>
<span class="sd">    with mean ybar,standard deviation sigma</span>
<span class="sd">    uses expression 7.1.26 from Abramowitz &amp; Stegun</span>
<span class="sd">    accuracy better than 1.5e-7 absolute</span>
<span class="sd">    Parameters</span>
<span class="sd">    _________</span>
<span class="sd">    y : input variable</span>
<span class="sd">    ybar : mean</span>
<span class="sd">    sigma : standard deviation</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">ybar</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">2.</span><span class="p">)</span> <span class="o">*</span> <span class="n">sigma</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">.3275911</span> <span class="o">*</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="n">erf</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span> <span class="o">*</span> <span class="p">(</span><span class="mf">.254829592</span> <span class="o">-</span> <span class="n">t</span> <span class="o">*</span> <span class="p">(</span><span class="mf">.284496736</span> <span class="o">-</span>
                                                        <span class="n">t</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.421413741</span> <span class="o">-</span> <span class="n">t</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.453152027</span> <span class="o">-</span> <span class="n">t</span> <span class="o">*</span> <span class="mf">1.061405429</span><span class="p">))))</span>
    <span class="n">erf</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">erf</span><span class="p">)</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">x</span><span class="o">/</span><span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">sign</span> <span class="o">*</span> <span class="n">erf</span><span class="p">)</span></div>


<div class="viewcode-block" id="k_s"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmagplotlib.k_s">[docs]</a><span class="k">def</span> <span class="nf">k_s</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Kolmorgorov-Smirnov statistic. Finds the</span>
<span class="sd">    probability that the data are distributed</span>
<span class="sd">    as func - used method of Numerical Recipes (Press et al., 1986)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">xbar</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">gausspars</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">d</span><span class="p">,</span> <span class="n">f</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">b</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">gaussfunc</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="n">xbar</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">f</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">abs</span><span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="n">a</span><span class="p">):</span>
            <span class="n">delta</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">f</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">delta</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">delta</span> <span class="o">&gt;</span> <span class="n">d</span><span class="p">:</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">delta</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">b</span>
    <span class="k">return</span> <span class="n">d</span><span class="p">,</span> <span class="n">xbar</span><span class="p">,</span> <span class="n">sigma</span></div>


<div class="viewcode-block" id="qsnorm"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmagplotlib.qsnorm">[docs]</a><span class="k">def</span> <span class="nf">qsnorm</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    rational approximation for x where q(x)=d, q being the cumulative</span>
<span class="sd">    normal distribution function. taken from Abramowitz &amp; Stegun p. 933</span>
<span class="sd">    |error(x)| &lt; 4.5*10**-4</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">p</span>
    <span class="k">if</span> <span class="n">d</span> <span class="o">&lt;</span> <span class="mf">0.</span> <span class="ow">or</span> <span class="n">d</span> <span class="o">&gt;</span> <span class="mf">1.</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;d not in (1,1) &#39;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mf">0.</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">d</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">d</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">d</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">t2</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">t2</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">t</span> <span class="o">-</span> <span class="p">((</span><span class="mf">2.515517</span> <span class="o">+</span> <span class="mf">.802853</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="mf">.010328</span> <span class="o">*</span> <span class="n">t2</span><span class="p">)</span><span class="o">/</span>
                        <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="mf">1.432788</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="mf">.189269</span> <span class="o">*</span> <span class="n">t2</span> <span class="o">+</span> <span class="mf">.001308</span> <span class="o">*</span> <span class="n">t</span> <span class="o">*</span> <span class="n">t2</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">p</span> <span class="o">&lt;</span> <span class="mf">0.5</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="n">x</span>
    <span class="k">return</span> <span class="n">x</span></div>


<span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="n">fig</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<div class="viewcode-block" id="plot_xy"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmagplotlib.plot_xy">[docs]</a><span class="k">def</span> <span class="nf">plot_xy</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    deprecated, used in curie</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">fignum</span><span class="p">)</span>
<span class="c1">#    if &#39;poly&#39; in kwargs.keys():</span>
<span class="c1">#          coeffs=np.polyfit(X,Y,kwargs[&#39;poly&#39;])</span>
<span class="c1">#          polynomial=np.poly1d(coeffs)</span>
<span class="c1">#          xs=np.arange(np.min(X),np.max(X))</span>
<span class="c1">#          ys=polynomial(xs)</span>
<span class="c1">#          plt.plot(xs,ys)</span>
<span class="c1">#          print coefs</span>
<span class="c1">#          print polynomial</span>
    <span class="k">if</span> <span class="s1">&#39;sym&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="n">sym</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;sym&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">sym</span> <span class="o">=</span> <span class="s1">&#39;ro&#39;</span>
    <span class="k">if</span> <span class="s1">&#39;lw&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="n">lw</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;lw&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">lw</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="s1">&#39;xerr&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="n">sym</span><span class="p">,</span> <span class="n">xerr</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;xerr&#39;</span><span class="p">])</span>
    <span class="k">if</span> <span class="s1">&#39;yerr&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="n">sym</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;yerr&#39;</span><span class="p">])</span>
    <span class="k">if</span> <span class="s1">&#39;axis&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="k">if</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;axis&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;semilogx&#39;</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">sym</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">markerfacecolor</span><span class="o">=</span><span class="n">sym</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;axis&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;semilogy&#39;</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">sym</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">markerfacecolor</span><span class="o">=</span><span class="n">sym</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;axis&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;loglog&#39;</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">sym</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">markerfacecolor</span><span class="o">=</span><span class="n">sym</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">sym</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">lw</span><span class="p">)</span>
    <span class="k">if</span> <span class="s1">&#39;xlab&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;xlab&#39;</span><span class="p">])</span>
    <span class="k">if</span> <span class="s1">&#39;ylab&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;ylab&#39;</span><span class="p">])</span>
    <span class="k">if</span> <span class="s1">&#39;title&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">])</span>
    <span class="k">if</span> <span class="s1">&#39;xmin&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;xmin&#39;</span><span class="p">],</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;xmax&#39;</span><span class="p">],</span>
                  <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;ymin&#39;</span><span class="p">],</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;ymax&#39;</span><span class="p">]])</span>
    <span class="k">if</span> <span class="s1">&#39;notes&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="k">for</span> <span class="n">note</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;notes&#39;</span><span class="p">]:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">note</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">note</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">note</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span></div>


<div class="viewcode-block" id="plot_site"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmagplotlib.plot_site">[docs]</a><span class="k">def</span> <span class="nf">plot_site</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span> <span class="n">SiteRec</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    deprecated (used in ipmag)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Site mean data: &#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;   dec    inc n_lines n_planes kappa R alpha_95 comp coord&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">SiteRec</span><span class="p">[</span><span class="s1">&#39;site_dec&#39;</span><span class="p">],</span> <span class="n">SiteRec</span><span class="p">[</span><span class="s1">&#39;site_inc&#39;</span><span class="p">],</span> <span class="n">SiteRec</span><span class="p">[</span><span class="s1">&#39;site_n_lines&#39;</span><span class="p">],</span> <span class="n">SiteRec</span><span class="p">[</span><span class="s1">&#39;site_n_planes&#39;</span><span class="p">],</span> <span class="n">SiteRec</span><span class="p">[</span><span class="s1">&#39;site_k&#39;</span><span class="p">],</span>
          <span class="n">SiteRec</span><span class="p">[</span><span class="s1">&#39;site_r&#39;</span><span class="p">],</span> <span class="n">SiteRec</span><span class="p">[</span><span class="s1">&#39;site_alpha95&#39;</span><span class="p">],</span> <span class="n">SiteRec</span><span class="p">[</span><span class="s1">&#39;site_comp_name&#39;</span><span class="p">],</span> <span class="n">SiteRec</span><span class="p">[</span><span class="s1">&#39;site_tilt_correction&#39;</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;sample/specimen, dec, inc, n_specs/a95,| method codes &#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">: </span><span class="si">%s</span><span class="s1"> </span><span class="si">%s</span><span class="s1"> </span><span class="si">%s</span><span class="s1"> / </span><span class="si">%s</span><span class="s1"> | </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;er_&#39;</span> <span class="o">+</span> <span class="n">key</span> <span class="o">+</span> <span class="s1">&#39;_name&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">key</span> <span class="o">+</span> <span class="s1">&#39;_dec&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                                          <span class="p">[</span><span class="n">key</span> <span class="o">+</span> <span class="s1">&#39;_inc&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">key</span> <span class="o">+</span> <span class="s1">&#39;_n&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">key</span> <span class="o">+</span> <span class="s1">&#39;_alpha95&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;magic_method_codes&#39;</span><span class="p">]))</span>
    <span class="n">plot_slnp</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span> <span class="n">SiteRec</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
    <span class="n">plot</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;s[a]ve plot, [q]uit or &lt;return&gt; to continue:   &quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">plot</span> <span class="o">==</span> <span class="s1">&#39;q&#39;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;CUL8R&quot;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">plot</span> <span class="o">==</span> <span class="s1">&#39;a&#39;</span><span class="p">:</span>
        <span class="n">files</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">EQ</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="n">files</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">site</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">key</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">fmt</span>
        <span class="n">save_plots</span><span class="p">(</span><span class="n">EQ</span><span class="p">,</span> <span class="n">files</span><span class="p">)</span></div>


<div class="viewcode-block" id="plot_qq_norm"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmagplotlib.plot_qq_norm">[docs]</a><span class="k">def</span> <span class="nf">plot_qq_norm</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    makes a Quantile-Quantile plot for data</span>
<span class="sd">    Parameters</span>
<span class="sd">    _________</span>
<span class="sd">    fignum : matplotlib figure number</span>
<span class="sd">    Y : list or array of data</span>
<span class="sd">    title : title string for plot</span>

<span class="sd">    Returns</span>
<span class="sd">    ___________</span>
<span class="sd">    d,dc : the values for D and Dc (the critical value)</span>
<span class="sd">       if d&gt;dc, likely to be normally distributed (95\% confidence)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">fignum</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
        <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>  <span class="c1"># sort the data</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
    <span class="n">d</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="n">k_s</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
    <span class="n">dc</span> <span class="o">=</span> <span class="mf">0.886</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
    <span class="n">X</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># list for normal quantile</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">p</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">qsnorm</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="s1">&#39;ro&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Normal Quantile&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Data Quantile&#39;</span><span class="p">)</span>
    <span class="n">bounds</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">()</span>
    <span class="n">notestr</span> <span class="o">=</span> <span class="s1">&#39;N: &#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="si">%i</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">.9</span> <span class="o">*</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mf">.9</span> <span class="o">*</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">notestr</span><span class="p">)</span>
    <span class="n">notestr</span> <span class="o">=</span> <span class="s1">&#39;mean: &#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="si">%8.3e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">mean</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">.9</span> <span class="o">*</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mf">.8</span> <span class="o">*</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">notestr</span><span class="p">)</span>
    <span class="n">notestr</span> <span class="o">=</span> <span class="s1">&#39;std dev: &#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="si">%8.3e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sigma</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">.9</span> <span class="o">*</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mf">.7</span> <span class="o">*</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">notestr</span><span class="p">)</span>
    <span class="n">notestr</span> <span class="o">=</span> <span class="s1">&#39;D: &#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="si">%8.3e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">d</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">.9</span> <span class="o">*</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mf">.6</span> <span class="o">*</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">notestr</span><span class="p">)</span>
    <span class="n">notestr</span> <span class="o">=</span> <span class="s1">&#39;Dc: &#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="si">%8.3e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">dc</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">.9</span> <span class="o">*</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mf">.5</span> <span class="o">*</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">notestr</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">d</span><span class="p">,</span> <span class="n">dc</span></div>


<div class="viewcode-block" id="plot_qq_unf"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmagplotlib.plot_qq_unf">[docs]</a><span class="k">def</span> <span class="nf">plot_qq_unf</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">subplot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">degrees</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    plots data against a uniform distribution in 0=&gt;360.</span>
<span class="sd">    Parameters</span>
<span class="sd">    _________</span>
<span class="sd">    fignum : matplotlib figure number</span>
<span class="sd">    D : data</span>
<span class="sd">    title : title for plot</span>
<span class="sd">    subplot : if True, make this number one of two subplots</span>
<span class="sd">    degrees : if True, assume that these are degrees</span>

<span class="sd">    Return</span>
<span class="sd">    Mu : Mu statistic (Fisher et al., 1987)</span>
<span class="sd">    Mu_crit : critical value of Mu for uniform distribution</span>

<span class="sd">    Effect</span>
<span class="sd">    ______</span>
<span class="sd">    makes a Quantile Quantile plot of data</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">subplot</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">fignum</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">fignum</span><span class="p">)</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">dpos</span><span class="p">,</span> <span class="n">dneg</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span>
    <span class="k">if</span> <span class="n">degrees</span><span class="p">:</span>
        <span class="n">D</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">D</span><span class="p">))</span> <span class="o">%</span> <span class="mi">360</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">D</span><span class="o">/</span><span class="n">D</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">D</span><span class="p">))</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">D</span><span class="p">))</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span><span class="o">/</span><span class="n">n</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span><span class="o">/</span><span class="n">n</span><span class="p">)</span><span class="o">-</span><span class="n">X</span>
    <span class="n">ds_neg</span> <span class="o">=</span> <span class="n">X</span><span class="o">-</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">n</span> <span class="c1"># bugfix from Qian (6/17/21)</span>
    <span class="n">dpos</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
    <span class="c1">#dneg = ds.min() # this is wrong</span>
    <span class="n">dneg</span> <span class="o">=</span> <span class="n">ds_neg</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="c1"># bugfix from Qian (6/17/21)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="s1">&#39;ro&#39;</span><span class="p">)</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">dneg</span> <span class="o">+</span> <span class="n">dpos</span>  <span class="c1"># kuiper&#39;s v</span>
    <span class="c1"># Mu of fisher et al. equation 5.16</span>
    <span class="n">Mu</span> <span class="o">=</span> <span class="n">v</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.567</span> <span class="o">+</span> <span class="mf">1.623</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">])</span>
    <span class="n">bounds</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">()</span>
    <span class="n">notestr</span> <span class="o">=</span> <span class="s1">&#39;N: &#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="si">%i</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">.1</span> <span class="o">*</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mf">.9</span> <span class="o">*</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">notestr</span><span class="p">)</span>
    <span class="n">notestr</span> <span class="o">=</span> <span class="s1">&#39;Mu: &#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="si">%7.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Mu</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">.1</span> <span class="o">*</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mf">.8</span> <span class="o">*</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">notestr</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">Mu</span> <span class="o">&gt;</span> <span class="mf">1.347</span><span class="p">:</span>
        <span class="n">notestr</span> <span class="o">=</span> <span class="s2">&quot;Non-uniform (99%)&quot;</span>
    <span class="k">elif</span> <span class="n">Mu</span> <span class="o">&lt;</span> <span class="mf">1.207</span><span class="p">:</span>
        <span class="n">notestr</span> <span class="o">=</span> <span class="s2">&quot;Uniform (95%)&quot;</span>
    <span class="k">elif</span> <span class="n">Mu</span> <span class="o">&gt;</span> <span class="mf">1.207</span><span class="p">:</span>
        <span class="n">notestr</span> <span class="o">=</span> <span class="s2">&quot;Uniform (99%)&quot;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">.1</span> <span class="o">*</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mf">.7</span> <span class="o">*</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">notestr</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">.1</span> <span class="o">*</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mf">.7</span> <span class="o">*</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">notestr</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Uniform Quantile&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Data Quantile&#39;</span><span class="p">)</span>
    <span class="c1">#print (v,dneg,dpos)#DEBUG</span>
    <span class="k">return</span> <span class="n">Mu</span><span class="p">,</span> <span class="mf">1.207</span></div>


<div class="viewcode-block" id="plot_qq_exp"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmagplotlib.plot_qq_exp">[docs]</a><span class="k">def</span> <span class="nf">plot_qq_exp</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">subplot</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    plots data against an exponential distribution in 0=&gt;90.</span>

<span class="sd">    Parameters</span>
<span class="sd">    _________</span>
<span class="sd">    fignum : matplotlib figure number</span>
<span class="sd">    I : data</span>
<span class="sd">    title : plot title</span>
<span class="sd">    subplot : boolean, if True plot as subplot with 1 row, two columns with fignum the plot number</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">subplot</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">fignum</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">fignum</span><span class="p">)</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">dpos</span><span class="p">,</span> <span class="n">dneg</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span>
    <span class="n">rad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.</span>
    <span class="n">xsum</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">I</span><span class="p">:</span>
        <span class="n">theta</span> <span class="o">=</span> <span class="p">(</span><span class="mf">90.</span> <span class="o">-</span> <span class="n">i</span><span class="p">)</span> <span class="o">*</span> <span class="n">rad</span>
        <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span>
        <span class="n">xsum</span> <span class="o">+=</span> <span class="n">X</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">X</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
    <span class="n">kappa</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">)</span><span class="o">/</span><span class="n">xsum</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)):</span>
        <span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span><span class="o">/</span><span class="n">n</span>
        <span class="n">Y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">p</span><span class="p">))</span>
        <span class="n">f</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">kappa</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">/</span><span class="n">n</span> <span class="o">-</span> <span class="n">f</span>
        <span class="k">if</span> <span class="n">dpos</span> <span class="o">&lt;</span> <span class="n">ds</span><span class="p">:</span>
            <span class="n">dpos</span> <span class="o">=</span> <span class="n">ds</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">f</span> <span class="o">-</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">)</span><span class="o">/</span><span class="n">n</span>
        <span class="k">if</span> <span class="n">dneg</span> <span class="o">&lt;</span> <span class="n">ds</span><span class="p">:</span>
            <span class="n">dneg</span> <span class="o">=</span> <span class="n">ds</span>
    <span class="k">if</span> <span class="n">dneg</span> <span class="o">&gt;</span> <span class="n">dpos</span><span class="p">:</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">dneg</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">dpos</span>
    <span class="n">Me</span> <span class="o">=</span> <span class="p">(</span><span class="n">ds</span> <span class="o">-</span> <span class="p">(</span><span class="mf">0.2</span><span class="o">/</span><span class="n">n</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.26</span> <span class="o">+</span>
                                     <span class="p">(</span><span class="mf">0.5</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">))))</span>  <span class="c1"># Eq. 5.15 from Fisher et al. (1987)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="s1">&#39;ro&#39;</span><span class="p">)</span>
    <span class="n">bounds</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">3</span><span class="p">]])</span>
    <span class="n">notestr</span> <span class="o">=</span> <span class="s1">&#39;N: &#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="si">%i</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">.1</span> <span class="o">*</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mf">.9</span> <span class="o">*</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">notestr</span><span class="p">)</span>
    <span class="n">notestr</span> <span class="o">=</span> <span class="s1">&#39;Me: &#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="si">%7.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Me</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">.1</span> <span class="o">*</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mf">.8</span> <span class="o">*</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">notestr</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">Me</span> <span class="o">&gt;</span> <span class="mf">1.094</span><span class="p">:</span>
        <span class="n">notestr</span> <span class="o">=</span> <span class="s2">&quot;Not Exponential&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">notestr</span> <span class="o">=</span> <span class="s2">&quot;Exponential (95%)&quot;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">.1</span> <span class="o">*</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mf">.7</span> <span class="o">*</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">notestr</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Exponential Quantile&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Data Quantile&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Me</span><span class="p">,</span> <span class="mf">1.094</span></div>


<div class="viewcode-block" id="plot_net"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmagplotlib.plot_net">[docs]</a><span class="k">def</span> <span class="nf">plot_net</span><span class="p">(</span><span class="n">fignum</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    draws circle and tick marks for equal area projection</span>
<span class="sd">    Parameters</span>
<span class="sd">    _________</span>
<span class="sd">    fignum : matplotlib figure number</span>
<span class="sd">    &quot;&quot;&quot;</span>
<span class="c1">#</span>
<span class="c1"># make the perimeter</span>
<span class="c1">#</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">fignum</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">isServer</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figtext</span><span class="p">(</span><span class="mf">.02</span><span class="p">,</span> <span class="mf">.01</span><span class="p">,</span> <span class="n">version_num</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
    <span class="n">Dcirc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">361.</span><span class="p">)</span>
    <span class="n">Icirc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">361</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">)</span>
    <span class="n">Xcirc</span><span class="p">,</span> <span class="n">Ycirc</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">361</span><span class="p">):</span>
        <span class="n">XY</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">dimap</span><span class="p">(</span><span class="n">Dcirc</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">Icirc</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="n">Xcirc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XY</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">Ycirc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XY</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xcirc</span><span class="p">,</span> <span class="n">Ycirc</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="c1">#</span>
<span class="c1"># put on the tick marks</span>
    <span class="n">Xsym</span><span class="p">,</span> <span class="n">Ysym</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
        <span class="n">XY</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">dimap</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="n">I</span><span class="p">)</span>
        <span class="n">Xsym</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XY</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">Ysym</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XY</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xsym</span><span class="p">,</span> <span class="n">Ysym</span><span class="p">,</span> <span class="s1">&#39;k+&#39;</span><span class="p">)</span>
    <span class="n">Xsym</span><span class="p">,</span> <span class="n">Ysym</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
        <span class="n">XY</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">dimap</span><span class="p">(</span><span class="mf">90.</span><span class="p">,</span> <span class="n">I</span><span class="p">)</span>
        <span class="n">Xsym</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XY</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">Ysym</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XY</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xsym</span><span class="p">,</span> <span class="n">Ysym</span><span class="p">,</span> <span class="s1">&#39;k+&#39;</span><span class="p">)</span>
    <span class="n">Xsym</span><span class="p">,</span> <span class="n">Ysym</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
        <span class="n">XY</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">dimap</span><span class="p">(</span><span class="mf">180.</span><span class="p">,</span> <span class="n">I</span><span class="p">)</span>
        <span class="n">Xsym</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XY</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">Ysym</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XY</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xsym</span><span class="p">,</span> <span class="n">Ysym</span><span class="p">,</span> <span class="s1">&#39;k+&#39;</span><span class="p">)</span>
    <span class="n">Xsym</span><span class="p">,</span> <span class="n">Ysym</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
        <span class="n">XY</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">dimap</span><span class="p">(</span><span class="mf">270.</span><span class="p">,</span> <span class="n">I</span><span class="p">)</span>
        <span class="n">Xsym</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XY</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">Ysym</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XY</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xsym</span><span class="p">,</span> <span class="n">Ysym</span><span class="p">,</span> <span class="s1">&#39;k+&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">D</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
        <span class="n">Xtick</span><span class="p">,</span> <span class="n">Ytick</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
            <span class="n">XY</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">dimap</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">I</span><span class="p">)</span>
            <span class="n">Xtick</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XY</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">Ytick</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XY</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xtick</span><span class="p">,</span> <span class="n">Ytick</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
    <span class="n">BoxX</span><span class="p">,</span> <span class="n">BoxY</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.1</span><span class="p">]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">BoxX</span><span class="p">,</span> <span class="n">BoxY</span><span class="p">,</span> <span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span></div>


<span class="k">def</span> <span class="nf">plot_di</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span> <span class="n">DIblock</span><span class="p">):</span>
    <span class="k">global</span> <span class="nb">globals</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    plots directions on equal area net</span>
<span class="sd">    Parameters</span>
<span class="sd">    _________</span>
<span class="sd">    fignum : matplotlib figure number</span>
<span class="sd">    DIblock : nested list of dec, inc pairs</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">X_down</span><span class="p">,</span> <span class="n">X_up</span><span class="p">,</span> <span class="n">Y_down</span><span class="p">,</span> <span class="n">Y_up</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>  <span class="c1"># initialize some variables</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">fignum</span><span class="p">)</span>
<span class="c1">#</span>
<span class="c1">#   plot the data - separate upper and lower hemispheres</span>
<span class="c1">#</span>
    <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">DIblock</span><span class="p">:</span>
        <span class="n">Up</span><span class="p">,</span> <span class="n">Down</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
        <span class="n">XY</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">dimap</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">rec</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">rec</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">X_down</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XY</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">Y_down</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XY</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">X_up</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XY</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">Y_up</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XY</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="c1">#</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_down</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1">#        plt.scatter(X_down,Y_down,marker=&#39;s&#39;,c=&#39;r&#39;)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_down</span><span class="p">,</span> <span class="n">Y_down</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">globals</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">globals</span><span class="o">.</span><span class="n">DIlist</span> <span class="o">=</span> <span class="n">X_down</span>
            <span class="nb">globals</span><span class="o">.</span><span class="n">DIlisty</span> <span class="o">=</span> <span class="n">Y_down</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_up</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1">#        plt.scatter(X_up,Y_up,marker=&#39;s&#39;,facecolor=&#39;none&#39;,edgecolor=&#39;black&#39;)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_up</span><span class="p">,</span> <span class="n">Y_up</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span>
                    <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">globals</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">globals</span><span class="o">.</span><span class="n">DIlist</span> <span class="o">=</span> <span class="n">X_up</span>
            <span class="nb">globals</span><span class="o">.</span><span class="n">DIlisty</span> <span class="o">=</span> <span class="n">Y_up</span>


<span class="k">def</span> <span class="nf">plot_di_sym</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span> <span class="n">DIblock</span><span class="p">,</span> <span class="n">sym</span><span class="p">):</span>
    <span class="k">global</span> <span class="nb">globals</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    plots directions on equal area net</span>
<span class="sd">    Parameters</span>
<span class="sd">    _________</span>
<span class="sd">    fignum : matplotlib figure number</span>
<span class="sd">    DIblock : nested list of dec, inc pairs</span>
<span class="sd">    sym : set matplotlib symbol (e.g., &#39;bo&#39; for blue circles)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">X_down</span><span class="p">,</span> <span class="n">X_up</span><span class="p">,</span> <span class="n">Y_down</span><span class="p">,</span> <span class="n">Y_up</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>  <span class="c1"># initialize some variables</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">fignum</span><span class="p">)</span>
<span class="c1">#</span>
<span class="c1">#   plot the data - separate upper and lower hemispheres</span>
<span class="c1">#</span>
    <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">DIblock</span><span class="p">:</span>
        <span class="n">Up</span><span class="p">,</span> <span class="n">Down</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
        <span class="n">XY</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">dimap</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">rec</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">rec</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">X_down</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XY</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">Y_down</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XY</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">X_up</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XY</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">Y_up</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XY</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="c1">#</span>
    <span class="k">if</span> <span class="s1">&#39;size&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="n">size</span> <span class="o">=</span> <span class="mi">50</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">size</span> <span class="o">=</span> <span class="n">sym</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="s1">&#39;edgecolor&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="n">sym</span><span class="p">[</span><span class="s1">&#39;edgecolor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;k&#39;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_down</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_down</span><span class="p">,</span> <span class="n">Y_down</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;lower&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                    <span class="n">c</span><span class="o">=</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;lower&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;edgecolor&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">globals</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">globals</span><span class="o">.</span><span class="n">DIlist</span> <span class="o">=</span> <span class="n">X_down</span>
            <span class="nb">globals</span><span class="o">.</span><span class="n">DIlisty</span> <span class="o">=</span> <span class="n">Y_down</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_up</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_up</span><span class="p">,</span> <span class="n">Y_up</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;upper&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                    <span class="n">c</span><span class="o">=</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;upper&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;edgecolor&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">globals</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">globals</span><span class="o">.</span><span class="n">DIlist</span> <span class="o">=</span> <span class="n">X_up</span>
            <span class="nb">globals</span><span class="o">.</span><span class="n">DIlisty</span> <span class="o">=</span> <span class="n">Y_up</span>


<div class="viewcode-block" id="plot_circ"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmagplotlib.plot_circ">[docs]</a><span class="k">def</span> <span class="nf">plot_circ</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span> <span class="n">pole</span><span class="p">,</span> <span class="n">ang</span><span class="p">,</span> <span class="n">col</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    function to put a small circle on an equal area projection plot, fig,fignum</span>
<span class="sd">    Parameters</span>
<span class="sd">    __________</span>
<span class="sd">    fignum : matplotlib figure number</span>
<span class="sd">    pole : dec,inc of center of circle</span>
<span class="sd">    ang : angle of circle</span>
<span class="sd">    col :</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">fignum</span><span class="p">)</span>
    <span class="n">D_c</span><span class="p">,</span> <span class="n">I_c</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">circ</span><span class="p">(</span><span class="n">pole</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pole</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ang</span><span class="p">)</span>
    <span class="n">X_c_up</span><span class="p">,</span> <span class="n">Y_c_up</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">X_c_d</span><span class="p">,</span> <span class="n">Y_c_d</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">D_c</span><span class="p">)):</span>
        <span class="n">XY</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">dimap</span><span class="p">(</span><span class="n">D_c</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">I_c</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">I_c</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">X_c_up</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XY</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">Y_c_up</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XY</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">X_c_d</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XY</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">Y_c_d</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XY</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_c_d</span><span class="p">,</span> <span class="n">Y_c_d</span><span class="p">,</span> <span class="n">col</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_c_up</span><span class="p">,</span> <span class="n">Y_c_up</span><span class="p">,</span> <span class="s1">&#39;c.&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span></div>


<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#</span>
<div class="viewcode-block" id="plot_zij"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmagplotlib.plot_zij">[docs]</a><span class="k">def</span> <span class="nf">plot_zij</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span> <span class="n">datablock</span><span class="p">,</span> <span class="n">angle</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    function to make Zijderveld diagrams</span>

<span class="sd">    Parameters</span>
<span class="sd">    __________</span>
<span class="sd">    fignum : matplotlib figure number</span>
<span class="sd">    datablock : nested list of [step, dec, inc, M (Am2), type, quality]</span>
<span class="sd">                where type is a string, either &#39;ZI&#39; or &#39;IZ&#39; for IZZI experiments</span>
<span class="sd">    angle : desired rotation in the horizontal plane (0 puts X on X axis)</span>
<span class="sd">    s : specimen name</span>
<span class="sd">    norm : if True, normalize to initial magnetization = unity</span>

<span class="sd">    Effects</span>
<span class="sd">    _______</span>
<span class="sd">    makes a zijderveld plot</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="nb">globals</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">fignum</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">isServer</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figtext</span><span class="p">(</span><span class="mf">.02</span><span class="p">,</span> <span class="mf">.01</span><span class="p">,</span> <span class="n">version_num</span><span class="p">)</span>
    <span class="n">amin</span><span class="p">,</span> <span class="n">amax</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">100.</span>
    <span class="k">if</span> <span class="n">norm</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">fact</span> <span class="o">=</span> <span class="mf">1.</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">fact</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="n">datablock</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span>   <span class="c1"># normalize to NRM=1</span>
        <span class="k">except</span> <span class="ne">ZeroDivisionError</span><span class="p">:</span>
            <span class="n">fact</span> <span class="o">=</span> <span class="mf">1.</span>
    <span class="c1"># convert datablock to DataFrame data with  dec,inc, int</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">datablock</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
        <span class="n">data</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;treat&#39;</span><span class="p">,</span> <span class="s1">&#39;dec&#39;</span><span class="p">,</span> <span class="s1">&#39;inc&#39;</span><span class="p">,</span> <span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="s1">&#39;quality&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
        <span class="n">data</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;treat&#39;</span><span class="p">,</span> <span class="s1">&#39;dec&#39;</span><span class="p">,</span> <span class="s1">&#39;inc&#39;</span><span class="p">,</span> <span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="s1">&#39;quality&#39;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
        <span class="n">data</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;treat&#39;</span><span class="p">,</span> <span class="s1">&#39;dec&#39;</span><span class="p">,</span> <span class="s1">&#39;inc&#39;</span><span class="p">,</span> <span class="s1">&#39;int&#39;</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="s1">&#39;quality&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">]</span>
    <span class="c1">#print (len(data.columns))</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;int&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;int&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">fact</span>  <span class="c1"># normalize</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">angle</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span>  <span class="c1"># adjust X axis angle</span>
    <span class="n">gdata</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;quality&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">)]</span>
    <span class="n">bdata</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;quality&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)]</span>
    <span class="n">forVDS</span> <span class="o">=</span> <span class="n">gdata</span><span class="p">[[</span><span class="s1">&#39;dec&#39;</span><span class="p">,</span> <span class="s1">&#39;inc&#39;</span><span class="p">,</span> <span class="s1">&#39;int&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
    <span class="n">gXYZ</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">dir2cart</span><span class="p">(</span><span class="n">forVDS</span><span class="p">))</span>
    <span class="n">gXYZ</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">]</span>
    <span class="n">amax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">gXYZ</span><span class="o">.</span><span class="n">X</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">gXYZ</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
    <span class="n">amin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">gXYZ</span><span class="o">.</span><span class="n">X</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">gXYZ</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
    <span class="k">if</span> <span class="n">amin</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">amin</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">bXYZ</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">dir2cart</span><span class="p">(</span><span class="n">bdata</span><span class="p">[[</span><span class="s1">&#39;dec&#39;</span><span class="p">,</span> <span class="s1">&#39;inc&#39;</span><span class="p">,</span> <span class="s1">&#39;int&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="c1"># plotting stuff</span>
    <span class="k">if</span> <span class="n">angle</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">tempstr</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> Declination rotated by: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="k">if</span> <span class="nb">globals</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">globals</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="nb">globals</span><span class="o">.</span><span class="n">END</span><span class="p">,</span> <span class="n">tempstr</span><span class="p">)</span>
        <span class="nb">globals</span><span class="o">.</span><span class="n">Zlist</span> <span class="o">=</span> <span class="n">gXYZ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="nb">globals</span><span class="o">.</span><span class="n">Zlisty</span> <span class="o">=</span> <span class="n">gXYZ</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="nb">globals</span><span class="o">.</span><span class="n">Zlistz</span> <span class="o">=</span> <span class="n">gXYZ</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">bXYZ</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">bXYZ</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">bXYZ</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">bXYZ</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">bXYZ</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">gXYZ</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">],</span> <span class="n">gXYZ</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">],</span> <span class="s1">&#39;ro&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">gXYZ</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">],</span> <span class="n">gXYZ</span><span class="p">[</span><span class="s1">&#39;Z&#39;</span><span class="p">],</span> <span class="s1">&#39;ws&#39;</span><span class="p">,</span> <span class="n">markeredgecolor</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">gXYZ</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">],</span> <span class="n">gXYZ</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">],</span> <span class="s1">&#39;r-&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">gXYZ</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">],</span> <span class="n">gXYZ</span><span class="p">[</span><span class="s1">&#39;Z&#39;</span><span class="p">],</span> <span class="s1">&#39;b-&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">gXYZ</span><span class="p">)):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">(</span><span class="n">gXYZ</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">],</span> <span class="n">gXYZ</span><span class="p">[</span><span class="s1">&#39;Z&#39;</span><span class="p">]</span>
                              <span class="p">[</span><span class="n">k</span><span class="p">]),</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">amin</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">amax</span> <span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span><span class="n">amin</span><span class="o">=</span><span class="mi">0</span> <span class="c1"># complete the line</span>
    <span class="k">if</span> <span class="n">amin</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">amax</span> <span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span><span class="n">amax</span><span class="o">=</span><span class="mi">0</span> <span class="c1"># complete the line</span>
    <span class="n">xline</span> <span class="o">=</span> <span class="p">[</span><span class="n">amin</span><span class="p">,</span> <span class="n">amax</span><span class="p">]</span>
   <span class="c1"># yline=[-amax,-amin]</span>
    <span class="n">yline</span> <span class="o">=</span> <span class="p">[</span><span class="n">amax</span><span class="p">,</span> <span class="n">amin</span><span class="p">]</span>
    <span class="n">zline</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xline</span><span class="p">,</span> <span class="n">zline</span><span class="p">,</span> <span class="s1">&#39;k-&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">zline</span><span class="p">,</span> <span class="n">xline</span><span class="p">,</span> <span class="s1">&#39;k-&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">angle</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">xlab</span> <span class="o">=</span> <span class="s2">&quot;X: rotated to Dec = &quot;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="si">%7.1f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">angle</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">angle</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">xlab</span> <span class="o">=</span> <span class="s2">&quot;X: rotated to Dec = &quot;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="si">%7.1f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">angle</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">xlab</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Circles: Y; Squares: Z&#39;</span><span class="p">)</span>
    <span class="n">tstring</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="s1">&#39;: NRM = &#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="si">%9.2e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">datablock</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="n">amin</span><span class="p">,</span> <span class="n">amax</span><span class="p">,</span> <span class="n">amax</span><span class="p">,</span> <span class="n">amin</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">tstring</span><span class="p">)</span></div>
<span class="c1">#</span>
<span class="c1">#</span>


<div class="viewcode-block" id="plot_mag"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmagplotlib.plot_mag">[docs]</a><span class="k">def</span> <span class="nf">plot_mag</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span> <span class="n">datablock</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">num</span><span class="p">,</span> <span class="n">units</span><span class="p">,</span> <span class="n">norm</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    plots magnetization against (de)magnetizing temperature or field</span>

<span class="sd">    Parameters</span>
<span class="sd">    _________________</span>
<span class="sd">    fignum : matplotlib figure number for plotting</span>
<span class="sd">    datablock : nested list of [step, 0, 0, magnetization, 1,quality]</span>
<span class="sd">    s : string for title</span>
<span class="sd">    num : matplotlib figure number, can set to 1</span>
<span class="sd">    units : [T,K,U] for tesla, kelvin or arbitrary</span>
<span class="sd">    norm : [True,False] if True, normalize</span>

<span class="sd">    Effects</span>
<span class="sd">    ______</span>
<span class="sd">        plots figure</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="nb">globals</span><span class="p">,</span> <span class="n">graphmenu</span>
    <span class="n">Ints</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">plotrec</span> <span class="ow">in</span> <span class="n">datablock</span><span class="p">:</span>
        <span class="n">Ints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">plotrec</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">Ints</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">fignum</span><span class="p">)</span>
    <span class="n">T</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">Tv</span><span class="p">,</span> <span class="n">recnum</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="mi">0</span>
    <span class="n">Mex</span><span class="p">,</span> <span class="n">Tex</span><span class="p">,</span> <span class="n">Vdif</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">recbak</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">datablock</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">rec</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;g&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">units</span> <span class="o">==</span> <span class="s2">&quot;T&quot;</span><span class="p">:</span>
                <span class="n">T</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">)</span>
                <span class="n">Tv</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">recnum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">Tv</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">units</span> <span class="o">==</span> <span class="s2">&quot;U&quot;</span><span class="p">:</span>
                <span class="n">T</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">Tv</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">recnum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">Tv</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">elif</span> <span class="n">units</span> <span class="o">==</span> <span class="s2">&quot;K&quot;</span><span class="p">:</span>
                <span class="n">T</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">273</span><span class="p">)</span>
                <span class="n">Tv</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">273</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">recnum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">Tv</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">273</span><span class="p">)</span>
            <span class="k">elif</span> <span class="s2">&quot;T&quot;</span> <span class="ow">in</span> <span class="n">units</span> <span class="ow">and</span> <span class="s2">&quot;K&quot;</span> <span class="ow">in</span> <span class="n">units</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">rec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">1.</span><span class="p">:</span>
                    <span class="n">T</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">)</span>
                    <span class="n">Tv</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">T</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">273</span><span class="p">)</span>
                    <span class="n">Tv</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">273</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">recnum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">Tv</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">273</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">T</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">Tv</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">recnum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">Tv</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">norm</span><span class="p">:</span>
                <span class="n">M</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">/</span><span class="n">Ints</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">M</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">recnum</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">rec</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">recbak</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">v</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">if</span> <span class="n">recbak</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">rec</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                    <span class="n">V0</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">dir2cart</span><span class="p">([</span><span class="n">recbak</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">recbak</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">recbak</span><span class="p">[</span><span class="mi">3</span><span class="p">]])</span>
                    <span class="n">V1</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">dir2cart</span><span class="p">([</span><span class="n">rec</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">rec</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">rec</span><span class="p">[</span><span class="mi">3</span><span class="p">]])</span>
                    <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
                        <span class="n">v</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">V1</span><span class="p">[</span><span class="n">el</span><span class="p">]</span> <span class="o">-</span> <span class="n">V0</span><span class="p">[</span><span class="n">el</span><span class="p">]))</span>
                    <span class="n">vdir</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">cart2dir</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                    <span class="c1"># append vector difference</span>
                    <span class="n">Vdif</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vdir</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="n">Ints</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                    <span class="n">Vdif</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vdir</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="n">Ints</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">recbak</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">rec</span><span class="p">:</span>
                <span class="n">recbak</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">el</span><span class="p">)</span>
            <span class="n">delta</span> <span class="o">=</span> <span class="mf">.005</span> <span class="o">*</span> <span class="n">M</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">num</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">recnum</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">T</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">delta</span><span class="p">,</span> <span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                             <span class="p">(</span><span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">recnum</span><span class="p">)),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
            <span class="n">recnum</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">rec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">200</span><span class="p">:</span>
                <span class="n">Tex</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">rec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">200</span><span class="p">:</span>
                <span class="n">Tex</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">273</span><span class="p">)</span>
            <span class="n">Mex</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">/</span><span class="n">Ints</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">recnum</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="nb">globals</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">globals</span><span class="o">.</span><span class="n">MTlist</span> <span class="o">=</span> <span class="n">T</span>
        <span class="nb">globals</span><span class="o">.</span><span class="n">MTlisty</span> <span class="o">=</span> <span class="n">M</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">Mex</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">Tex</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">Tex</span><span class="p">,</span> <span class="n">Mex</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">Vdif</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">Vdif</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vdir</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="n">Ints</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">Vdif</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">Tv</span><span class="p">:</span>
        <span class="n">Tv</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Tv</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="s1">&#39;ro&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">Tv</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">Vdif</span><span class="p">)</span> <span class="ow">and</span> <span class="n">norm</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Tv</span><span class="p">,</span> <span class="n">Vdif</span><span class="p">,</span> <span class="s1">&#39;g-&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">units</span> <span class="o">==</span> <span class="s2">&quot;T&quot;</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Step (mT)&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">units</span> <span class="o">==</span> <span class="s2">&quot;K&quot;</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Step (C)&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">units</span> <span class="o">==</span> <span class="s2">&quot;J&quot;</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Step (J)&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Step [mT,C]&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">norm</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Fractional Magnetization&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">norm</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Magnetization&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
    <span class="n">tstring</span> <span class="o">=</span> <span class="n">s</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">tstring</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span></div>

<span class="c1">#</span>
<span class="c1">#</span>


<div class="viewcode-block" id="plot_zed"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmagplotlib.plot_zed">[docs]</a><span class="k">def</span> <span class="nf">plot_zed</span><span class="p">(</span><span class="n">ZED</span><span class="p">,</span> <span class="n">datablock</span><span class="p">,</span> <span class="n">angle</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">units</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    function to make equal area plot and zijderveld plot</span>

<span class="sd">    Parameters</span>
<span class="sd">    _________</span>
<span class="sd">    ZED : dictionary with keys for plots</span>
<span class="sd">        eqarea : figure number for equal area projection</span>
<span class="sd">        zijd   : figure number for  zijderveld plot</span>
<span class="sd">        demag :  figure number for magnetization against demag step</span>
<span class="sd">        datablock : nested list of [step, dec, inc, M (Am2), quality]</span>
<span class="sd">        step : units assumed in SI</span>
<span class="sd">        M    : units assumed Am2</span>
<span class="sd">        quality : [g,b], good or bad measurement; if bad will be marked as such</span>
<span class="sd">    angle : angle for X axis in horizontal plane, if 0, x will be 0 declination</span>
<span class="sd">    s : specimen name</span>
<span class="sd">    units :  SI units [&#39;K&#39;,&#39;T&#39;,&#39;U&#39;] for kelvin, tesla or undefined</span>

<span class="sd">    Effects</span>
<span class="sd">    _______</span>
<span class="sd">       calls plotting functions for equal area, zijderveld and demag figures</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">fignum</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">ZED</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">ZED</span><span class="p">[</span><span class="n">fignum</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">isServer</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">figtext</span><span class="p">(</span><span class="mf">.02</span><span class="p">,</span> <span class="mf">.01</span><span class="p">,</span> <span class="n">version_num</span><span class="p">)</span>
    <span class="n">DIbad</span><span class="p">,</span> <span class="n">DIgood</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">datablock</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">cb</span><span class="o">.</span><span class="n">is_null</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">zero_as_null</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-W- You are missing a declination for specimen&#39;</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="s1">&#39;, skipping this row&#39;</span><span class="p">)</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">cb</span><span class="o">.</span><span class="n">is_null</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">zero_as_null</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-W- You are missing an inclination for specimen&#39;</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="s1">&#39;, skipping this row&#39;</span><span class="p">)</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">rec</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span>
            <span class="n">DIbad</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">rec</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">rec</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">DIgood</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">rec</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">rec</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
    <span class="n">badsym</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;lower&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">],</span> <span class="s1">&#39;upper&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">]}</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">DIgood</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">plot_eq</span><span class="p">(</span><span class="n">ZED</span><span class="p">[</span><span class="s1">&#39;eqarea&#39;</span><span class="p">],</span> <span class="n">DIgood</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">DIbad</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">plot_di_sym</span><span class="p">(</span><span class="n">ZED</span><span class="p">[</span><span class="s1">&#39;eqarea&#39;</span><span class="p">],</span> <span class="n">DIbad</span><span class="p">,</span> <span class="n">badsym</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">DIbad</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">plot_eq_sym</span><span class="p">(</span><span class="n">ZED</span><span class="p">[</span><span class="s1">&#39;eqarea&#39;</span><span class="p">],</span> <span class="n">DIbad</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">badsym</span><span class="p">)</span>
    <span class="n">AngleX</span><span class="p">,</span> <span class="n">AngleY</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">XY</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">dimap</span><span class="p">(</span><span class="n">angle</span><span class="p">,</span> <span class="mf">90.</span><span class="p">)</span>
    <span class="n">AngleX</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XY</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">AngleY</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XY</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">XY</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">dimap</span><span class="p">(</span><span class="n">angle</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
    <span class="n">AngleX</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XY</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">AngleY</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XY</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">ZED</span><span class="p">[</span><span class="s1">&#39;eqarea&#39;</span><span class="p">])</span>
    <span class="c1"># Draw a line for Zijderveld horizontal axis</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">AngleX</span><span class="p">,</span> <span class="n">AngleY</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">AngleX</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">AngleX</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.01</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">AngleX</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">AngleX</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="nb">abs</span><span class="p">(</span><span class="n">AngleX</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span> <span class="o">*</span> <span class="mf">.1</span><span class="p">,</span>
             <span class="n">AngleY</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">AngleY</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="nb">abs</span><span class="p">(</span><span class="n">AngleY</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span> <span class="o">*</span> <span class="mf">.1</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">)</span>
    <span class="n">norm</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="c1">#if units==&quot;U&quot;: norm=0</span>
    <span class="c1"># if there are NO good points, don&#39;t try to plot</span>
    <span class="k">if</span> <span class="n">DIgood</span><span class="p">:</span>
        <span class="n">plot_mag</span><span class="p">(</span><span class="n">ZED</span><span class="p">[</span><span class="s1">&#39;demag&#39;</span><span class="p">],</span> <span class="n">datablock</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">units</span><span class="p">,</span> <span class="n">norm</span><span class="p">)</span>
        <span class="n">plot_zij</span><span class="p">(</span><span class="n">ZED</span><span class="p">[</span><span class="s1">&#39;zijd&#39;</span><span class="p">],</span> <span class="n">datablock</span><span class="p">,</span> <span class="n">angle</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">norm</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ZED</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;demag&#39;</span><span class="p">)</span>
        <span class="n">ZED</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;zijd&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ZED</span></div>


<div class="viewcode-block" id="plot_dir"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmagplotlib.plot_dir">[docs]</a><span class="k">def</span> <span class="nf">plot_dir</span><span class="p">(</span><span class="n">ZED</span><span class="p">,</span> <span class="n">pars</span><span class="p">,</span> <span class="n">datablock</span><span class="p">,</span> <span class="n">angle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    function to put the great circle on the equal area projection</span>
<span class="sd">    and plot start and end points of calculation</span>

<span class="sd">    DEPRECATED (used in zeq_magic)</span>
<span class="sd">    &quot;&quot;&quot;</span>
<span class="c1">#</span>
<span class="c1"># find start and end points from datablock</span>
<span class="c1">#</span>
    <span class="k">if</span> <span class="n">pars</span><span class="p">[</span><span class="s2">&quot;calculation_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;DE-FM&#39;</span><span class="p">:</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">ZED</span><span class="p">[</span><span class="s1">&#39;eqarea&#39;</span><span class="p">])</span>
        <span class="n">XY</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">dimap</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_dec&quot;</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_inc&quot;</span><span class="p">])</span>
        <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XY</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XY</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="k">return</span>
    <span class="n">StartDir</span><span class="p">,</span> <span class="n">EndDir</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">datablock</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">rec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">pars</span><span class="p">[</span><span class="s2">&quot;measurement_step_min&quot;</span><span class="p">]:</span>
            <span class="n">StartDir</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">StartDir</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_direction_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;l&#39;</span><span class="p">:</span>
                <span class="n">StartDir</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">/</span><span class="n">datablock</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">rec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">pars</span><span class="p">[</span><span class="s2">&quot;measurement_step_max&quot;</span><span class="p">]:</span>
            <span class="n">EndDir</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">EndDir</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_direction_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;l&#39;</span><span class="p">:</span>
                <span class="n">EndDir</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">/</span><span class="n">datablock</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>

<span class="c1">#</span>
<span class="c1">#  put them on the plots</span>
<span class="c1">#</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">pole</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">pars</span><span class="p">[</span><span class="s2">&quot;calculation_type&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;DE-BFP&#39;</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">ZED</span><span class="p">[</span><span class="s1">&#39;eqarea&#39;</span><span class="p">])</span>
        <span class="n">XY</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">dimap</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_dec&quot;</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_inc&quot;</span><span class="p">])</span>
        <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XY</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XY</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="n">StartDir</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">StartDir</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">angle</span>
        <span class="n">EndDir</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">EndDir</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">angle</span>
        <span class="n">XYZs</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">dir2cart</span><span class="p">(</span><span class="n">StartDir</span><span class="p">)</span>
        <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XYZs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XYZs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">z</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XYZs</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">XYZe</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">dir2cart</span><span class="p">(</span><span class="n">EndDir</span><span class="p">)</span>
        <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XYZe</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XYZe</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">z</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XYZe</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">ZED</span><span class="p">[</span><span class="s1">&#39;zijd&#39;</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="c1">#</span>
<span class="c1"># put on best fit line</span>
<span class="c1"># new way (from Jeff Gee&#39;s favorite website http://GET THIS):</span>
<span class="c1">#      P1=pmag.dir2cart([(pars[&quot;specimen_dec&quot;]-angle),pars[&quot;specimen_inc&quot;],1.]) #  princ comp.</span>
<span class="c1">#      P2=pmag.dir2cart([(pars[&quot;specimen_dec&quot;]-angle-180.),-pars[&quot;specimen_inc&quot;],1.]) # antipode of princ comp.</span>
<span class="c1">#      P21,Ps,Pe,Xs,Xe=[],[],[],[],[]</span>
<span class="c1">#      for i in range(3):</span>
<span class="c1">#          P21.append(P2[i]-P1[i])</span>
<span class="c1">#          Ps.append(XYZs[i]-P1[i])</span>
<span class="c1">#          Pe.append(XYZe[i]-P1[i])</span>
<span class="c1">#      norm=pmag.cart2dir(P21)[2]</span>
<span class="c1">#      us=(Ps[0]*P21[0]+Ps[1]*P21[1]+Ps[2]*P21[2])/(norm**2)</span>
<span class="c1">#      ue=(Pe[0]*P21[0]+Pe[1]*P21[1]+Pe[2]*P21[2])/(norm**2)</span>
<span class="c1">#      px,py,pz=[],[],[]</span>
<span class="c1">#      for i in range(3):</span>
<span class="c1">#          Xs.append(P1[i]+us*(P2[i]-P1[i]))</span>
<span class="c1">#          Xe.append(P1[i]+ue*(P2[i]-P1[i]))</span>
<span class="c1">#   old way:</span>
        <span class="n">cm</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s2">&quot;center_of_mass&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">cm</span> <span class="o">!=</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]:</span>
            <span class="n">cm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s2">&quot;center_of_mass&quot;</span><span class="p">])</span><span class="o">/</span><span class="n">datablock</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
            <span class="n">cmDir</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">cart2dir</span><span class="p">(</span><span class="n">cm</span><span class="p">)</span>
            <span class="n">cmDir</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">cmDir</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">angle</span>
            <span class="n">cm</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">dir2cart</span><span class="p">(</span><span class="n">cmDir</span><span class="p">)</span>
            <span class="n">diff</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
                <span class="n">diff</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XYZe</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">XYZs</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">diff</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">diff</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">diff</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">P</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">dir2cart</span><span class="p">(</span>
                <span class="p">((</span><span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_dec&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">angle</span><span class="p">),</span> <span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_inc&quot;</span><span class="p">],</span> <span class="n">R</span><span class="o">/</span><span class="mf">2.5</span><span class="p">))</span>
            <span class="n">px</span><span class="p">,</span> <span class="n">py</span><span class="p">,</span> <span class="n">pz</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
            <span class="n">px</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">cm</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">P</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="n">py</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">cm</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">P</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
            <span class="n">pz</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">cm</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">P</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
            <span class="n">px</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">cm</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">P</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="n">py</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">cm</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">P</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
            <span class="n">pz</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">cm</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">P</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">px</span><span class="p">,</span> <span class="n">py</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">px</span><span class="p">,</span> <span class="n">pz</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">ZED</span><span class="p">[</span><span class="s1">&#39;eqarea&#39;</span><span class="p">])</span>
        <span class="n">XY</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">dimap</span><span class="p">(</span><span class="n">StartDir</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">StartDir</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XY</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XY</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">XY</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">dimap</span><span class="p">(</span><span class="n">EndDir</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">EndDir</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XY</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XY</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
        <span class="n">pole</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_dec&quot;</span><span class="p">])</span>
        <span class="n">pole</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_inc&quot;</span><span class="p">])</span>
        <span class="n">plot_circ</span><span class="p">(</span><span class="n">ZED</span><span class="p">[</span><span class="s1">&#39;eqarea&#39;</span><span class="p">],</span> <span class="n">pole</span><span class="p">,</span> <span class="mf">90.</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">((</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span></div>
        <span class="c1">#plt.draw()</span>


<div class="viewcode-block" id="plot_arai"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmagplotlib.plot_arai">[docs]</a><span class="k">def</span> <span class="nf">plot_arai</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span> <span class="n">indata</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">units</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    makes Arai plots for Thellier-Thellier type experiments</span>

<span class="sd">    Parameters</span>
<span class="sd">    __________</span>
<span class="sd">    fignum : figure number of matplotlib plot object</span>
<span class="sd">    indata : nested list of data for Arai plots:</span>
<span class="sd">        the araiblock of data prepared by pmag.sortarai()</span>
<span class="sd">    s : specimen name</span>
<span class="sd">    units : [K, J, &quot;&quot;] (kelvin, joules, unknown)</span>
<span class="sd">    Effects</span>
<span class="sd">    _______</span>
<span class="sd">    makes the Arai plot</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="nb">globals</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">fignum</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">isServer</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figtext</span><span class="p">(</span><span class="mf">.02</span><span class="p">,</span> <span class="mf">.01</span><span class="p">,</span> <span class="n">version_num</span><span class="p">)</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x_zi</span><span class="p">,</span> <span class="n">y_zi</span><span class="p">,</span> <span class="n">x_iz</span><span class="p">,</span> <span class="n">y_iz</span><span class="p">,</span> <span class="n">xptrm</span><span class="p">,</span> <span class="n">yptrm</span><span class="p">,</span> <span class="n">xptrmt</span><span class="p">,</span> <span class="n">yptrmt</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">xzptrm</span><span class="p">,</span> <span class="n">yzptrm</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>  <span class="c1"># zero field ptrm checks</span>
    <span class="n">zptrm_check</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">first_Z</span><span class="p">,</span> <span class="n">first_I</span><span class="p">,</span> <span class="n">ptrm_check</span><span class="p">,</span> <span class="n">ptrm_tail</span><span class="p">,</span> <span class="n">zptrm_check</span> <span class="o">=</span> <span class="n">indata</span><span class="p">[</span>
        <span class="mi">0</span><span class="p">],</span> <span class="n">indata</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">indata</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">indata</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">indata</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">indata</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">6</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">indata</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="s2">&quot;:PERP&quot;</span>  <span class="c1"># there are Delta checks, must be a LP-PI-M-S perp experiment</span>
    <span class="n">recnum</span><span class="p">,</span> <span class="n">yes</span><span class="p">,</span> <span class="n">Nptrm</span><span class="p">,</span> <span class="n">Nptrmt</span><span class="p">,</span> <span class="n">diffcum</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
<span class="c1"># plot the NRM-pTRM data</span>
    <span class="n">forVDS</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">zrec</span> <span class="ow">in</span> <span class="n">first_Z</span><span class="p">:</span>
        <span class="n">forVDS</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">zrec</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">zrec</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">zrec</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">/</span><span class="n">first_Z</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]])</span>
        <span class="n">ZI</span> <span class="o">=</span> <span class="n">zrec</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">zrec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;0&#39;</span><span class="p">:</span>
            <span class="n">irec</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">zrec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;273&#39;</span> <span class="ow">and</span> <span class="n">units</span> <span class="o">==</span> <span class="s1">&#39;K&#39;</span><span class="p">:</span>
            <span class="n">irec</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;273&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">irec</span> <span class="ow">in</span> <span class="n">first_I</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">irec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">zrec</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                    <span class="k">break</span>
<span class="c1"># save the NRM data used for calculation in Vi</span>
        <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">irec</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">/</span><span class="n">first_Z</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span>
        <span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zrec</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">/</span><span class="n">first_Z</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">ZI</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">x_zi</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">irec</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">/</span><span class="n">first_Z</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span>
            <span class="n">y_zi</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zrec</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">/</span><span class="n">first_Z</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">x_iz</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">irec</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">/</span><span class="n">first_Z</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span>
            <span class="n">y_iz</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zrec</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">/</span><span class="n">first_Z</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">recnum</span><span class="p">)),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
        <span class="n">recnum</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="c1"># now deal with ptrm checks.</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ptrm_check</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">prec</span> <span class="ow">in</span> <span class="n">ptrm_check</span><span class="p">:</span>
            <span class="n">step</span> <span class="o">=</span> <span class="n">prec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">zrec</span> <span class="ow">in</span> <span class="n">first_Z</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">zrec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">step</span><span class="p">:</span>
                    <span class="k">break</span>
            <span class="n">xptrm</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prec</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">/</span><span class="n">first_Z</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span>
            <span class="n">yptrm</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zrec</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">/</span><span class="n">first_Z</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span>
<span class="c1"># now deal with zptrm checks.</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">zptrm_check</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">prec</span> <span class="ow">in</span> <span class="n">zptrm_check</span><span class="p">:</span>
            <span class="n">step</span> <span class="o">=</span> <span class="n">prec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">zrec</span> <span class="ow">in</span> <span class="n">first_Z</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">zrec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">step</span><span class="p">:</span>
                    <span class="k">break</span>
            <span class="n">xzptrm</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prec</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">/</span><span class="n">first_Z</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span>
            <span class="n">yzptrm</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zrec</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">/</span><span class="n">first_Z</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span>
<span class="c1"># and the pTRM tails</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ptrm_tail</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">trec</span> <span class="ow">in</span> <span class="n">ptrm_tail</span><span class="p">:</span>
            <span class="n">step</span> <span class="o">=</span> <span class="n">trec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">irec</span> <span class="ow">in</span> <span class="n">first_I</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">irec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">step</span><span class="p">:</span>
                    <span class="k">break</span>
            <span class="n">xptrmt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">irec</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">/</span><span class="n">first_Z</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span>
            <span class="n">yptrmt</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">trec</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">/</span><span class="n">first_Z</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]))</span>
<span class="c1"># now plot stuff</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Can&#39;t do nuttin for ya&quot;</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_zi</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_zi</span><span class="p">,</span> <span class="n">y_zi</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span>
                        <span class="n">edgecolors</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">)</span>  <span class="c1"># zero field-infield</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_iz</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_iz</span><span class="p">,</span> <span class="n">y_iz</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span>
                        <span class="n">faceted</span><span class="o">=</span><span class="s2">&quot;True&quot;</span><span class="p">)</span>  <span class="c1"># infield-zerofield</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_zi</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_zi</span><span class="p">,</span> <span class="n">y_zi</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>  <span class="c1"># zero field-infield</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_iz</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_iz</span><span class="p">,</span> <span class="n">y_iz</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>  <span class="c1"># infield-zerofield</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">globals</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">globals</span><span class="o">.</span><span class="n">MTlist</span> <span class="o">=</span> <span class="n">x</span>
        <span class="nb">globals</span><span class="o">.</span><span class="n">MTlisty</span> <span class="o">=</span> <span class="n">y</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">xptrm</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xptrm</span><span class="p">,</span> <span class="n">yptrm</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">xzptrm</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xzptrm</span><span class="p">,</span> <span class="n">yzptrm</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">xptrmt</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xptrmt</span><span class="p">,</span> <span class="n">yptrmt</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;pTRM gained&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;NRM remaining&quot;</span><span class="p">)</span>
    <span class="n">tstring</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="s1">&#39;: NRM = &#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="si">%9.2e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">first_Z</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">tstring</span><span class="p">)</span>
<span class="c1"># put on VDS</span>
    <span class="n">vds</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">dovds</span><span class="p">(</span><span class="n">forVDS</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">vds</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="n">vds</span> <span class="o">-</span> <span class="mf">.1</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;VDS &#39;</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span></div>
<span class="c1">#    bounds=plt.axis()</span>
<span class="c1">#    if bounds[1]&lt;1:plt.axis([bounds[0], 1., bounds[2], bounds[3]])</span>


<div class="viewcode-block" id="plot_np"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmagplotlib.plot_np">[docs]</a><span class="k">def</span> <span class="nf">plot_np</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span> <span class="n">indata</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">units</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    makes plot of de(re)magnetization data for Thellier-Thellier type experiment</span>

<span class="sd">    Parameters</span>
<span class="sd">    __________</span>
<span class="sd">    fignum : matplotlib figure number</span>
<span class="sd">    indata :  araiblock from, e.g., pmag.sortarai()</span>
<span class="sd">    s : specimen name</span>
<span class="sd">    units : [K, J, &quot;&quot;] (kelvin, joules, unknown)</span>

<span class="sd">    Effect</span>
<span class="sd">    _______</span>
<span class="sd">    Makes a plot</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="nb">globals</span>
    <span class="n">first_Z</span><span class="p">,</span> <span class="n">first_I</span><span class="p">,</span> <span class="n">ptrm_check</span><span class="p">,</span> <span class="n">ptrm_tail</span> <span class="o">=</span> <span class="n">indata</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">indata</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">indata</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">indata</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">fignum</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">isServer</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figtext</span><span class="p">(</span><span class="mf">.02</span><span class="p">,</span> <span class="mf">.01</span><span class="p">,</span> <span class="n">version_num</span><span class="p">)</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">recnum</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="mi">0</span>
<span class="c1">#</span>
    <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">first_Z</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">units</span> <span class="o">==</span> <span class="s2">&quot;K&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">rec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">273.</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">units</span> <span class="o">==</span> <span class="s2">&quot;J&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="ow">not</span> <span class="n">units</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">units</span> <span class="o">==</span> <span class="s2">&quot;T&quot;</span><span class="p">):</span>
            <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">Y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">old_div</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">first_Z</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]))</span>
        <span class="n">delta</span> <span class="o">=</span> <span class="mf">.02</span> <span class="o">*</span> <span class="n">Y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">recnum</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">delta</span><span class="p">,</span> <span class="n">Y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">delta</span><span class="p">,</span>
                     <span class="p">(</span><span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">recnum</span><span class="p">)),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
        <span class="n">recnum</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">first_I</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">units</span> <span class="o">==</span> <span class="s2">&quot;K&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">rec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">273</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">units</span> <span class="o">==</span> <span class="s2">&quot;J&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="ow">not</span> <span class="n">units</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">units</span> <span class="o">==</span> <span class="s2">&quot;T&quot;</span><span class="p">):</span>
            <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">Y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">old_div</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">first_Z</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]))</span>
    <span class="k">if</span> <span class="nb">globals</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">globals</span><span class="o">.</span><span class="n">DIlist</span> <span class="o">=</span> <span class="n">X</span>
        <span class="nb">globals</span><span class="o">.</span><span class="n">DIlisty</span> <span class="o">=</span> <span class="n">Y</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Circles: NRM; Squares: pTRM&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">units</span> <span class="o">==</span> <span class="s2">&quot;K&quot;</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Temperature (C)&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">units</span> <span class="o">==</span> <span class="s2">&quot;J&quot;</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Microwave Energy (J)&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="s2">&quot;: NRM = &quot;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="si">%9.2e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">first_Z</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="plot_arai_zij"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmagplotlib.plot_arai_zij">[docs]</a><span class="k">def</span> <span class="nf">plot_arai_zij</span><span class="p">(</span><span class="n">ZED</span><span class="p">,</span> <span class="n">araiblock</span><span class="p">,</span> <span class="n">zijdblock</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">units</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    calls the four plotting programs for Thellier-Thellier experiments</span>

<span class="sd">    Parameters</span>
<span class="sd">    __________</span>
<span class="sd">    ZED : dictionary with plotting figure keys:</span>
<span class="sd">        deremag : figure for de (re) magnezation plots</span>
<span class="sd">        arai : figure for the Arai diagram</span>
<span class="sd">        eqarea : equal area projection of data, color coded by</span>
<span class="sd">            red circles: ZI steps</span>
<span class="sd">            blue squares: IZ steps</span>
<span class="sd">            yellow triangles : pTRM steps</span>
<span class="sd">        zijd : Zijderveld diagram color coded by ZI, IZ steps</span>
<span class="sd">        deremag : demagnetization and remagnetization versus temperature</span>
<span class="sd">    araiblock : nested list of required data from Arai plots</span>
<span class="sd">    zijdblock : nested list of required data for Zijderveld plots</span>
<span class="sd">    s : specimen name</span>
<span class="sd">    units : units for the arai and zijderveld plots</span>

<span class="sd">    Effects</span>
<span class="sd">    ________</span>
<span class="sd">    Makes four plots from the data by calling</span>
<span class="sd">    plot_arai : Arai plots</span>
<span class="sd">    plot_teq : equal area projection for Thellier data</span>
<span class="sd">    plotZ : Zijderveld diagram</span>
<span class="sd">    plot_np : de (re) magnetization diagram</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">angle</span> <span class="o">=</span> <span class="n">zijdblock</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">norm</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">units</span> <span class="o">==</span> <span class="s2">&quot;U&quot;</span><span class="p">:</span>
        <span class="n">norm</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">plot_arai</span><span class="p">(</span><span class="n">ZED</span><span class="p">[</span><span class="s1">&#39;arai&#39;</span><span class="p">],</span> <span class="n">araiblock</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">units</span><span class="p">)</span>
    <span class="n">plot_teq</span><span class="p">(</span><span class="n">ZED</span><span class="p">[</span><span class="s1">&#39;eqarea&#39;</span><span class="p">],</span> <span class="n">araiblock</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">plot_zij</span><span class="p">(</span><span class="n">ZED</span><span class="p">[</span><span class="s1">&#39;zijd&#39;</span><span class="p">],</span> <span class="n">zijdblock</span><span class="p">,</span> <span class="n">angle</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">norm</span><span class="p">)</span>
    <span class="n">plot_np</span><span class="p">(</span><span class="n">ZED</span><span class="p">[</span><span class="s1">&#39;deremag&#39;</span><span class="p">],</span> <span class="n">araiblock</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">units</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ZED</span></div>


<div class="viewcode-block" id="plot_b"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmagplotlib.plot_b">[docs]</a><span class="k">def</span> <span class="nf">plot_b</span><span class="p">(</span><span class="n">Figs</span><span class="p">,</span> <span class="n">araiblock</span><span class="p">,</span> <span class="n">zijdblock</span><span class="p">,</span> <span class="n">pars</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    deprecated (used in thellier_magic/microwave_magic)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">angle</span> <span class="o">=</span> <span class="n">zijdblock</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">plotblock</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">Dir</span><span class="p">,</span> <span class="n">zx</span><span class="p">,</span> <span class="n">zy</span><span class="p">,</span> <span class="n">zz</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">ay</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">zstart</span><span class="p">,</span> <span class="n">zend</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">zijdblock</span><span class="p">)</span>
    <span class="n">first_Z</span><span class="p">,</span> <span class="n">first_I</span> <span class="o">=</span> <span class="n">araiblock</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">araiblock</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">zijdblock</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">rec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">pars</span><span class="p">[</span><span class="s2">&quot;measurement_step_min&quot;</span><span class="p">]:</span>
            <span class="n">Dir</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">rec</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">angle</span><span class="p">,</span> <span class="n">rec</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                        <span class="n">old_div</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">zijdblock</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">])))</span>
        <span class="k">if</span> <span class="n">rec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">pars</span><span class="p">[</span><span class="s2">&quot;measurement_step_max&quot;</span><span class="p">]:</span>
            <span class="n">Dir</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">rec</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">angle</span><span class="p">,</span> <span class="n">rec</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                        <span class="n">old_div</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">zijdblock</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">])))</span>
    <span class="k">for</span> <span class="n">drec</span> <span class="ow">in</span> <span class="n">Dir</span><span class="p">:</span>
        <span class="n">cart</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">dir2cart</span><span class="p">(</span><span class="n">drec</span><span class="p">)</span>
        <span class="n">zx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cart</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
      <span class="c1">#   zy.append(-cart[1])</span>
      <span class="c1">#   zz.append(-cart[2])</span>
        <span class="n">zy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cart</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">zz</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cart</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">zx</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">Figs</span><span class="p">[</span><span class="s1">&#39;zijd&#39;</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">zx</span><span class="p">,</span> <span class="n">zy</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">zx</span><span class="p">,</span> <span class="n">zz</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">old_div</span><span class="p">(</span><span class="n">first_I</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span> <span class="n">first_Z</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">old_div</span><span class="p">(</span><span class="n">first_I</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span> <span class="n">first_Z</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]))</span>
    <span class="n">ay</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">old_div</span><span class="p">(</span><span class="n">first_Z</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span> <span class="n">first_Z</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]))</span>
    <span class="n">ay</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">old_div</span><span class="p">(</span><span class="n">first_Z</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span> <span class="n">first_Z</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]))</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">first_Z</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">first_Z</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">pars</span><span class="p">[</span><span class="s2">&quot;measurement_step_min&quot;</span><span class="p">]:</span>
            <span class="n">ay</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">old_div</span><span class="p">(</span><span class="n">first_Z</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span> <span class="n">first_Z</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]))</span>
        <span class="k">if</span> <span class="n">first_Z</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">pars</span><span class="p">[</span><span class="s2">&quot;measurement_step_max&quot;</span><span class="p">]:</span>
            <span class="n">ay</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">old_div</span><span class="p">(</span><span class="n">first_Z</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span> <span class="n">first_Z</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]))</span>
        <span class="k">if</span> <span class="n">first_I</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">pars</span><span class="p">[</span><span class="s2">&quot;measurement_step_min&quot;</span><span class="p">]:</span>
            <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">old_div</span><span class="p">(</span><span class="n">first_I</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span> <span class="n">first_Z</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]))</span>
        <span class="k">if</span> <span class="n">first_I</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">pars</span><span class="p">[</span><span class="s2">&quot;measurement_step_max&quot;</span><span class="p">]:</span>
            <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">old_div</span><span class="p">(</span><span class="n">first_I</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span> <span class="n">first_Z</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]))</span>
    <span class="n">new_Z</span><span class="p">,</span> <span class="n">new_I</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">zrec</span> <span class="ow">in</span> <span class="n">first_Z</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">zrec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;measurement_step_min&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">zrec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;measurement_step_max&#39;</span><span class="p">]:</span>
            <span class="n">new_Z</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zrec</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">irec</span> <span class="ow">in</span> <span class="n">first_I</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">irec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;measurement_step_min&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">irec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;measurement_step_max&#39;</span><span class="p">]:</span>
            <span class="n">new_I</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">irec</span><span class="p">)</span>
    <span class="n">newblock</span> <span class="o">=</span> <span class="p">[</span><span class="n">new_Z</span><span class="p">,</span> <span class="n">new_I</span><span class="p">]</span>
    <span class="n">plot_teq</span><span class="p">(</span><span class="n">Figs</span><span class="p">[</span><span class="s1">&#39;eqarea&#39;</span><span class="p">],</span> <span class="n">newblock</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">pars</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">Figs</span><span class="p">[</span><span class="s1">&#39;arai&#39;</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">ay</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="c1">#</span>
<span class="c1">#  find midpoint between two endpoints</span>
<span class="c1">#</span>
    <span class="n">sy</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">sy</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_b&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span>
               <span class="n">old_div</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_ytot&quot;</span><span class="p">],</span> <span class="n">first_Z</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">])))</span>
    <span class="n">sy</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_b&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
               <span class="n">old_div</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_ytot&quot;</span><span class="p">],</span> <span class="n">first_Z</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">])))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">bounds</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;specimen_grade&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
        <span class="n">notestr</span> <span class="o">=</span> <span class="s1">&#39;Grade: &#39;</span> <span class="o">+</span> <span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_grade&quot;</span><span class="p">]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">.7</span> <span class="o">*</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mf">.9</span> <span class="o">*</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">notestr</span><span class="p">)</span>
    <span class="n">notestr</span> <span class="o">=</span> <span class="s1">&#39;B: &#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="si">%6.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_int&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; uT&#39;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">.7</span> <span class="o">*</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mf">.8</span> <span class="o">*</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">notestr</span><span class="p">)</span></div>


<div class="viewcode-block" id="plot_slnp"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmagplotlib.plot_slnp">[docs]</a><span class="k">def</span> <span class="nf">plot_slnp</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span> <span class="n">SiteRec</span><span class="p">,</span> <span class="n">datablock</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    plots lines and planes on a great  circle with alpha 95 and mean</span>
<span class="sd">    deprecated (used in pmagplotlib)</span>
<span class="sd">    &quot;&quot;&quot;</span>
<span class="c1"># make the stereonet</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">fignum</span><span class="p">)</span>
    <span class="n">plot_net</span><span class="p">(</span><span class="n">fignum</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">SiteRec</span><span class="p">[</span><span class="s1">&#39;er_site_name&#39;</span><span class="p">]</span>
<span class="c1">#</span>
<span class="c1">#   plot on the data</span>
<span class="c1">#</span>
    <span class="n">coord</span> <span class="o">=</span> <span class="n">SiteRec</span><span class="p">[</span><span class="s1">&#39;site_tilt_correction&#39;</span><span class="p">]</span>
    <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">if</span> <span class="n">coord</span> <span class="o">==</span> <span class="s1">&#39;-1&#39;</span><span class="p">:</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="s2">&quot;: specimen coordinates&quot;</span>
    <span class="k">if</span> <span class="n">coord</span> <span class="o">==</span> <span class="s1">&#39;0&#39;</span><span class="p">:</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="s2">&quot;: geographic coordinates&quot;</span>
    <span class="k">if</span> <span class="n">coord</span> <span class="o">==</span> <span class="s1">&#39;100&#39;</span><span class="p">:</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="s2">&quot;: tilt corrected coordinates&quot;</span>
    <span class="n">DIblock</span><span class="p">,</span> <span class="n">GCblock</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">plotrec</span> <span class="ow">in</span> <span class="n">datablock</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">plotrec</span><span class="p">[</span><span class="n">key</span> <span class="o">+</span> <span class="s1">&#39;_direction_type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;p&#39;</span><span class="p">:</span>  <span class="c1"># direction is pole to plane</span>
            <span class="n">GCblock</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">plotrec</span><span class="p">[</span><span class="n">key</span> <span class="o">+</span> <span class="s2">&quot;_dec&quot;</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">plotrec</span><span class="p">[</span><span class="n">key</span> <span class="o">+</span> <span class="s2">&quot;_inc&quot;</span><span class="p">])))</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># assume direction is a directed line</span>
            <span class="n">DIblock</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">plotrec</span><span class="p">[</span><span class="n">key</span> <span class="o">+</span> <span class="s2">&quot;_dec&quot;</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">plotrec</span><span class="p">[</span><span class="n">key</span> <span class="o">+</span> <span class="s2">&quot;_inc&quot;</span><span class="p">])))</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">DIblock</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">plot_di</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span> <span class="n">DIblock</span><span class="p">)</span>  <span class="c1"># plot directed lines</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">GCblock</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">pole</span> <span class="ow">in</span> <span class="n">GCblock</span><span class="p">:</span>
            <span class="n">plot_circ</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span> <span class="n">pole</span><span class="p">,</span> <span class="mf">90.</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">)</span>  <span class="c1"># plot directed lines</span>
<span class="c1">#</span>
<span class="c1"># put on the mean direction</span>
<span class="c1">#</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">XY</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">dimap</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">SiteRec</span><span class="p">[</span><span class="s2">&quot;site_dec&quot;</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">SiteRec</span><span class="p">[</span><span class="s2">&quot;site_inc&quot;</span><span class="p">]))</span>
    <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XY</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XY</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
<span class="c1">#</span>
<span class="c1"># get the alpha95</span>
<span class="c1">#</span>
    <span class="n">Xcirc</span><span class="p">,</span> <span class="n">Ycirc</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">Da95</span><span class="p">,</span> <span class="n">Ia95</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">circ</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">SiteRec</span><span class="p">[</span><span class="s2">&quot;site_dec&quot;</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span>
        <span class="n">SiteRec</span><span class="p">[</span><span class="s2">&quot;site_inc&quot;</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">SiteRec</span><span class="p">[</span><span class="s2">&quot;site_alpha95&quot;</span><span class="p">]))</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Da95</span><span class="p">)):</span>
        <span class="n">XY</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">dimap</span><span class="p">(</span><span class="n">Da95</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">Ia95</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="n">Xcirc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XY</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">Ycirc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XY</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xcirc</span><span class="p">,</span> <span class="n">Ycirc</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="plot_lnp"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmagplotlib.plot_lnp">[docs]</a><span class="k">def</span> <span class="nf">plot_lnp</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">datablock</span><span class="p">,</span> <span class="n">fpars</span><span class="p">,</span> <span class="n">direction_type_key</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    plots lines and planes on a great  circle with alpha 95 and mean</span>

<span class="sd">    Parameters</span>
<span class="sd">    _________</span>
<span class="sd">    fignum : number of plt.figure() object</span>
<span class="sd">    s : str</span>
<span class="sd">      name of site for title</span>
<span class="sd">    datablock : nested list of dictionaries with keys in 3.0 or 2.5 format</span>
<span class="sd">        3.0 keys: dir_dec, dir_inc, dir_tilt_correction = [-1,0,100], method_codes =[&#39;DE-BFP&#39;,&#39;DE-BFL&#39;]</span>
<span class="sd">        2.5 keys: dec, inc, tilt_correction = [-1,0,100],direction_type_key =[&#39;p&#39;,&#39;l&#39;]</span>
<span class="sd">    fpars : Fisher parameters calculated by, e.g., pmag.dolnp() or pmag.dolnp3_0()</span>
<span class="sd">    direction_type_key : key for dictionary direction_type (&#39;specimen_direction_type&#39;)</span>
<span class="sd">    Effects</span>
<span class="sd">    _______</span>
<span class="sd">    plots the site level figure</span>
<span class="sd">    &quot;&quot;&quot;</span>
<span class="c1"># make the stereonet</span>
    <span class="n">plot_net</span><span class="p">(</span><span class="n">fignum</span><span class="p">)</span>
<span class="c1">#</span>
<span class="c1">#   plot on the data</span>
<span class="c1">#</span>
    <span class="n">dec_key</span><span class="p">,</span> <span class="n">inc_key</span><span class="p">,</span> <span class="n">tilt_key</span> <span class="o">=</span> <span class="s1">&#39;dec&#39;</span><span class="p">,</span> <span class="s1">&#39;inc&#39;</span><span class="p">,</span> <span class="s1">&#39;tilt_correction&#39;</span>
    <span class="k">if</span> <span class="s1">&#39;dir_dec&#39;</span> <span class="ow">in</span> <span class="n">datablock</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>  <span class="c1"># this is data model 3.0</span>
        <span class="n">dec_key</span><span class="p">,</span> <span class="n">inc_key</span><span class="p">,</span> <span class="n">tilt_key</span> <span class="o">=</span> <span class="s1">&#39;dir_dec&#39;</span><span class="p">,</span> <span class="s1">&#39;dir_inc&#39;</span><span class="p">,</span> <span class="s1">&#39;dir_tilt_correction&#39;</span>
    <span class="n">coord</span> <span class="o">=</span> <span class="n">datablock</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">tilt_key</span><span class="p">]</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">s</span>
    <span class="k">if</span> <span class="n">coord</span> <span class="o">==</span> <span class="s1">&#39;-1&#39;</span><span class="p">:</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">title</span> <span class="o">+</span> <span class="s2">&quot;: specimen coordinates&quot;</span>
    <span class="k">if</span> <span class="n">coord</span> <span class="o">==</span> <span class="s1">&#39;0&#39;</span><span class="p">:</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">title</span> <span class="o">+</span> <span class="s2">&quot;: geographic coordinates&quot;</span>
    <span class="k">if</span> <span class="n">coord</span> <span class="o">==</span> <span class="s1">&#39;100&#39;</span><span class="p">:</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">title</span> <span class="o">+</span> <span class="s2">&quot;: tilt corrected coordinates&quot;</span>
    <span class="n">DIblock</span><span class="p">,</span> <span class="n">GCblock</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">plotrec</span> <span class="ow">in</span> <span class="n">datablock</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;direction_type_key&#39;</span> <span class="ow">in</span> <span class="n">plotrec</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="n">plotrec</span><span class="p">[</span><span class="n">direction_type_key</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;p&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="s1">&#39;DE-BFP&#39;</span> <span class="ow">in</span> <span class="n">plotrec</span><span class="p">[</span><span class="s1">&#39;method_codes&#39;</span><span class="p">]:</span>  <span class="c1"># direction is pole to plane</span>
       <span class="c1"># if plotrec[direction_type_key] == &#39;p&#39;:  # direction is pole to plane</span>
            <span class="n">GCblock</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="nb">float</span><span class="p">(</span><span class="n">plotrec</span><span class="p">[</span><span class="n">dec_key</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">plotrec</span><span class="p">[</span><span class="n">inc_key</span><span class="p">])))</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># assume direction is a directed line</span>
            <span class="n">DIblock</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="nb">float</span><span class="p">(</span><span class="n">plotrec</span><span class="p">[</span><span class="n">dec_key</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">plotrec</span><span class="p">[</span><span class="n">inc_key</span><span class="p">])))</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">DIblock</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">plot_di</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span> <span class="n">DIblock</span><span class="p">)</span>  <span class="c1"># plot directed lines</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">GCblock</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">pole</span> <span class="ow">in</span> <span class="n">GCblock</span><span class="p">:</span>
            <span class="n">plot_circ</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span> <span class="n">pole</span><span class="p">,</span> <span class="mf">90.</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">)</span>  <span class="c1"># plot directed lines</span>
<span class="c1">#</span>
<span class="c1"># put on the mean direction</span>
<span class="c1">#</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">XY</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">dimap</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">fpars</span><span class="p">[</span><span class="s2">&quot;dec&quot;</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">fpars</span><span class="p">[</span><span class="s2">&quot;inc&quot;</span><span class="p">]))</span>
    <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XY</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XY</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">fignum</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
<span class="c1">#</span>
<span class="c1"># get the alpha95</span>
<span class="c1">#</span>
    <span class="n">Xcirc</span><span class="p">,</span> <span class="n">Ycirc</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">Da95</span><span class="p">,</span> <span class="n">Ia95</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">circ</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">fpars</span><span class="p">[</span><span class="s2">&quot;dec&quot;</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span>
        <span class="n">fpars</span><span class="p">[</span><span class="s2">&quot;inc&quot;</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">fpars</span><span class="p">[</span><span class="s2">&quot;alpha95&quot;</span><span class="p">]))</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Da95</span><span class="p">)):</span>
        <span class="n">XY</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">dimap</span><span class="p">(</span><span class="n">Da95</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">Ia95</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="n">Xcirc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XY</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">Ycirc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XY</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xcirc</span><span class="p">,</span> <span class="n">Ycirc</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="plot_eq"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmagplotlib.plot_eq">[docs]</a><span class="k">def</span> <span class="nf">plot_eq</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span> <span class="n">DIblock</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    plots directions on eqarea projection</span>
<span class="sd">    Parameters</span>
<span class="sd">    __________</span>
<span class="sd">    fignum : matplotlib figure number</span>
<span class="sd">    DIblock : nested list of dec/inc pairs</span>
<span class="sd">    s : specimen name</span>
<span class="sd">    &quot;&quot;&quot;</span>
<span class="c1"># make the stereonet</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">fignum</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">DIblock</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span>
    <span class="c1"># plt.clf()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">isServer</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figtext</span><span class="p">(</span><span class="mf">.02</span><span class="p">,</span> <span class="mf">.01</span><span class="p">,</span> <span class="n">version_num</span><span class="p">)</span>
    <span class="n">plot_net</span><span class="p">(</span><span class="n">fignum</span><span class="p">)</span>
<span class="c1">#</span>
<span class="c1">#   put on the directions</span>
<span class="c1">#</span>
    <span class="n">plot_di</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span> <span class="n">DIblock</span><span class="p">)</span>  <span class="c1"># plot directions</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.15</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span></div>


<div class="viewcode-block" id="plot_eq_sym"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmagplotlib.plot_eq_sym">[docs]</a><span class="k">def</span> <span class="nf">plot_eq_sym</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span> <span class="n">DIblock</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">sym</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    plots directions with specified symbol</span>
<span class="sd">    Parameters</span>
<span class="sd">    __________</span>
<span class="sd">    fignum : matplotlib figure number</span>
<span class="sd">    DIblock : nested list of dec/inc pairs</span>
<span class="sd">    s : specimen name</span>
<span class="sd">    sym : matplotlib symbol (e.g., &#39;bo&#39; for blue circle)</span>
<span class="sd">    &quot;&quot;&quot;</span>
<span class="c1"># make the stereonet</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">fignum</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">DIblock</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span>
    <span class="c1"># plt.clf()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">isServer</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figtext</span><span class="p">(</span><span class="mf">.02</span><span class="p">,</span> <span class="mf">.01</span><span class="p">,</span> <span class="n">version_num</span><span class="p">)</span>
    <span class="n">plot_net</span><span class="p">(</span><span class="n">fignum</span><span class="p">)</span>
<span class="c1">#</span>
<span class="c1">#   put on the directions</span>
<span class="c1">#</span>
    <span class="n">plot_di_sym</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span> <span class="n">DIblock</span><span class="p">,</span> <span class="n">sym</span><span class="p">)</span>  <span class="c1"># plot directions with symbols in sym</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.15</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span></div>
<span class="c1">#</span>


<div class="viewcode-block" id="plot_teq"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmagplotlib.plot_teq">[docs]</a><span class="k">def</span> <span class="nf">plot_teq</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span> <span class="n">araiblock</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">pars</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    plots directions  of pTRM steps and zero field steps</span>

<span class="sd">    Parameters</span>
<span class="sd">    __________</span>
<span class="sd">    fignum : figure number for matplotlib object</span>
<span class="sd">    araiblock : nested list of data from pmag.sortarai()</span>
<span class="sd">    s : specimen name</span>
<span class="sd">    pars : default is &quot;&quot;,</span>
<span class="sd">        otherwise is dictionary with keys:</span>
<span class="sd">        &#39;measurement_step_min&#39; and &#39;measurement_step_max&#39;</span>

<span class="sd">    Effects</span>
<span class="sd">    _______</span>
<span class="sd">    makes the equal area projection with color coded symbols</span>
<span class="sd">        red circles: ZI steps</span>
<span class="sd">        blue squares: IZ steps</span>
<span class="sd">        yellow : pTRM steps</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">first_Z</span><span class="p">,</span> <span class="n">first_I</span> <span class="o">=</span> <span class="n">araiblock</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">araiblock</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="c1"># make the stereonet</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">fignum</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
    <span class="n">ZIblock</span><span class="p">,</span> <span class="n">IZblock</span><span class="p">,</span> <span class="n">pTblock</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">zrec</span> <span class="ow">in</span> <span class="n">first_Z</span><span class="p">:</span>  <span class="c1"># sort out the zerofield steps</span>
        <span class="k">if</span> <span class="n">zrec</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># this is a ZI step</span>
            <span class="n">ZIblock</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">zrec</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">zrec</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">IZblock</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">zrec</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">zrec</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>
    <span class="n">plot_net</span><span class="p">(</span><span class="n">fignum</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">pars</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
        <span class="nb">min</span><span class="p">,</span> <span class="nb">max</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s2">&quot;measurement_step_min&quot;</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span>
            <span class="n">pars</span><span class="p">[</span><span class="s2">&quot;measurement_step_max&quot;</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">min</span><span class="p">,</span> <span class="nb">max</span> <span class="o">=</span> <span class="n">first_I</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">first_I</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">irec</span> <span class="ow">in</span> <span class="n">first_I</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">irec</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">irec</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">irec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="nb">min</span> <span class="ow">and</span> <span class="n">irec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="nb">max</span><span class="p">:</span>
            <span class="n">pTblock</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">irec</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">irec</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ZIblock</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">IZblock</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">pTblock</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">isServer</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figtext</span><span class="p">(</span><span class="mf">.02</span><span class="p">,</span> <span class="mf">.01</span><span class="p">,</span> <span class="n">version_num</span><span class="p">)</span>
<span class="c1">#</span>
<span class="c1">#   put on the directions</span>
<span class="c1">#</span>
    <span class="n">sym</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;lower&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">],</span> <span class="s1">&#39;upper&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">]}</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ZIblock</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">plot_di_sym</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span> <span class="n">ZIblock</span><span class="p">,</span> <span class="n">sym</span><span class="p">)</span>  <span class="c1"># plot ZI directions</span>
    <span class="n">sym</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;lower&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">],</span> <span class="s1">&#39;upper&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">]}</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">IZblock</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">plot_di_sym</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span> <span class="n">IZblock</span><span class="p">,</span> <span class="n">sym</span><span class="p">)</span>  <span class="c1"># plot IZ directions</span>
    <span class="n">sym</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;lower&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">],</span> <span class="s1">&#39;upper&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">]}</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pTblock</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">plot_di_sym</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span> <span class="n">pTblock</span><span class="p">,</span> <span class="n">sym</span><span class="p">)</span>  <span class="c1"># plot pTRM directions</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.15</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span></div>


<div class="viewcode-block" id="save_plots"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmagplotlib.save_plots">[docs]</a><span class="k">def</span> <span class="nf">save_plots</span><span class="p">(</span><span class="n">Figs</span><span class="p">,</span> <span class="n">filenames</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Figs : dict</span>
<span class="sd">        dictionary of plots, e.g. {&#39;eqarea&#39;: 1, ...}</span>
<span class="sd">    filenames : dict</span>
<span class="sd">        dictionary of filenames, e.g. {&#39;eqarea&#39;: &#39;mc01a_eqarea.svg&#39;, ...}</span>
<span class="sd">        dict keys should correspond with Figs</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">saved</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Figs</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">Figs</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            <span class="n">fname</span> <span class="o">=</span> <span class="n">filenames</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">set_env</span><span class="o">.</span><span class="n">IS_WIN</span><span class="p">:</span>  <span class="c1"># always truncate filenames if on Windows</span>
                <span class="n">fname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">fname</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">isServer</span><span class="p">:</span>  <span class="c1"># remove illegal &#39;:&#39; character for windows</span>
                <span class="n">fname</span> <span class="o">=</span> <span class="n">fname</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;incl_directory&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">set_env</span><span class="o">.</span><span class="n">IS_WIN</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;incl_directory&#39;</span><span class="p">]:</span>
                    <span class="k">pass</span> <span class="c1"># do not flatten file name</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">fname</span> <span class="o">=</span> <span class="n">fname</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span> <span class="c1"># flatten file name</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">fname</span> <span class="o">=</span> <span class="n">fname</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span> <span class="c1"># flatten file name</span>
            <span class="k">if</span> <span class="s1">&#39;dpi&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;dpi&#39;</span><span class="p">])</span>
            <span class="k">elif</span> <span class="n">isServer</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">240</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">Figs</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="s2">&quot; saved in &quot;</span><span class="p">,</span> <span class="n">fname</span><span class="p">)</span>
            <span class="n">saved</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">Figs</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">ex</span><span class="p">),</span> <span class="n">ex</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;could not save: &#39;</span><span class="p">,</span> <span class="n">Figs</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">filenames</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;output file format not supported &quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">saved</span></div>
<span class="c1">#</span>


<div class="viewcode-block" id="plot_evec"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmagplotlib.plot_evec">[docs]</a><span class="k">def</span> <span class="nf">plot_evec</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span> <span class="n">Vs</span><span class="p">,</span> <span class="n">symsize</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    plots eigenvector directions of S vectors</span>

<span class="sd">    Parameters</span>
<span class="sd">    ________</span>
<span class="sd">    fignum : matplotlib figure number</span>
<span class="sd">    Vs : nested list of eigenvectors</span>
<span class="sd">    symsize : size in pts for symbol</span>
<span class="sd">    title : title for plot</span>
<span class="sd">    &quot;&quot;&quot;</span>
<span class="c1">#</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">fignum</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.15</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>
    <span class="c1"># plot V1s as squares, V2s as triangles and V3s as circles</span>
    <span class="n">symb</span><span class="p">,</span> <span class="n">symkey</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">],</span> <span class="mi">0</span>
    <span class="n">col</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">]</span>  <span class="c1"># plot V1s rec, V2s blue, V3s black</span>
    <span class="k">for</span> <span class="n">VEC</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">Vdirs</span> <span class="ow">in</span> <span class="n">Vs</span><span class="p">:</span>
            <span class="c1">#</span>
            <span class="c1">#</span>
            <span class="c1">#   plot the V1 data  first</span>
            <span class="c1">#</span>
            <span class="n">XY</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">dimap</span><span class="p">(</span><span class="n">Vdirs</span><span class="p">[</span><span class="n">VEC</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">Vdirs</span><span class="p">[</span><span class="n">VEC</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XY</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">Y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XY</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">symsize</span><span class="p">,</span>
                    <span class="n">marker</span><span class="o">=</span><span class="n">symb</span><span class="p">[</span><span class="n">VEC</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">col</span><span class="p">[</span><span class="n">VEC</span><span class="p">],</span> <span class="n">edgecolors</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span></div>
<span class="c1">#</span>


<div class="viewcode-block" id="plot_ell"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmagplotlib.plot_ell">[docs]</a><span class="k">def</span> <span class="nf">plot_ell</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span> <span class="n">pars</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    function to calculate/plot points on an ellipse about Pdec,Pdip with angle beta,gamma</span>
<span class="sd">    Parameters</span>
<span class="sd">    _________</span>
<span class="sd">    fignum : matplotlib figure number</span>
<span class="sd">    pars : list of [Pdec, Pinc, beta, Bdec, Binc, gamma, Gdec, Ginc ]</span>
<span class="sd">         where P is direction, Bdec,Binc are beta direction, and Gdec,Ginc are gamma direction</span>
<span class="sd">    col : color for ellipse (default is black &#39;k&#39;)</span>
<span class="sd">    lower : boolean, if True, lower hemisphere projection</span>
<span class="sd">    plot : boolean, if False, return the points, if True, make the plot</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.</span>
    <span class="n">Pdec</span><span class="p">,</span> <span class="n">Pinc</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">Bdec</span><span class="p">,</span> <span class="n">Binc</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">Gdec</span><span class="p">,</span> <span class="n">Ginc</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span>
        <span class="mi">1</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">beta</span> <span class="o">&gt;</span> <span class="mf">90.</span> <span class="ow">or</span> <span class="n">gamma</span> <span class="o">&gt;</span> <span class="mi">90</span><span class="p">:</span>
        <span class="n">beta</span> <span class="o">=</span> <span class="mf">180.</span> <span class="o">-</span> <span class="n">beta</span>
        <span class="n">gamma</span> <span class="o">=</span> <span class="mf">180.</span> <span class="o">-</span> <span class="n">gamma</span>
        <span class="n">Pdec</span> <span class="o">=</span> <span class="n">Pdec</span> <span class="o">-</span> <span class="mf">180.</span>
        <span class="n">Pinc</span> <span class="o">=</span> <span class="o">-</span><span class="n">Pinc</span>
    <span class="n">beta</span><span class="p">,</span> <span class="n">gamma</span> <span class="o">=</span> <span class="n">beta</span> <span class="o">*</span> <span class="n">rad</span><span class="p">,</span> <span class="n">gamma</span> <span class="o">*</span> <span class="n">rad</span>  <span class="c1"># convert to radians</span>
    <span class="n">X_ell</span><span class="p">,</span> <span class="n">Y_ell</span><span class="p">,</span> <span class="n">X_up</span><span class="p">,</span> <span class="n">Y_up</span><span class="p">,</span> <span class="n">PTS</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">nums</span> <span class="o">=</span> <span class="mi">201</span>
    <span class="n">xnum</span> <span class="o">=</span> <span class="n">old_div</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">nums</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">),</span> <span class="mf">2.</span><span class="p">)</span>
<span class="c1"># set up t matrix</span>
    <span class="n">t</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">dir2cart</span><span class="p">((</span><span class="n">Pdec</span><span class="p">,</span> <span class="n">Pinc</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span>  <span class="c1"># convert to cartesian coordintes</span>
    <span class="k">if</span> <span class="n">lower</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="c1"># set up rotation matrix t</span>
    <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">t</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">dir2cart</span><span class="p">((</span><span class="n">Bdec</span><span class="p">,</span> <span class="n">Binc</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">lower</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">t</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">dir2cart</span><span class="p">((</span><span class="n">Gdec</span><span class="p">,</span> <span class="n">Ginc</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">lower</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">t</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="c1"># set up v matrix</span>
    <span class="n">v</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nums</span><span class="p">):</span>  <span class="c1"># incremental point along ellipse</span>
        <span class="n">psi</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">xnum</span>
        <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">psi</span><span class="p">)</span>
        <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">gamma</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">psi</span><span class="p">)</span>
        <span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">elli</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="c1"># calculate points on the ellipse</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
                <span class="c1"># cartesian coordinate j of ellipse</span>
                <span class="n">elli</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">elli</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">t</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="n">pts</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">cart2dir</span><span class="p">(</span><span class="n">elli</span><span class="p">)</span>
        <span class="n">PTS</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">pts</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pts</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
        <span class="c1"># put on an equal area projection</span>
        <span class="n">R</span> <span class="o">=</span> <span class="n">old_div</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span>
            <span class="mf">1.</span> <span class="o">-</span> <span class="nb">abs</span><span class="p">(</span><span class="n">elli</span><span class="p">[</span><span class="mi">2</span><span class="p">])),</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">elli</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">elli</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)))</span>
        <span class="k">if</span> <span class="n">elli</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1">#            for i in range(3): elli[i]=-elli[i]</span>
            <span class="n">X_up</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">elli</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">R</span><span class="p">)</span>
            <span class="n">Y_up</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">elli</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">R</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">X_ell</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">elli</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">R</span><span class="p">)</span>
            <span class="n">Y_ell</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">elli</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">R</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">plot</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">fignum</span><span class="p">)</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">col</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;.&#39;</span>
        <span class="k">if</span> <span class="n">X_ell</span> <span class="o">!=</span> <span class="p">[]:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_ell</span><span class="p">,</span> <span class="n">Y_ell</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">X_up</span> <span class="o">!=</span> <span class="p">[]:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_up</span><span class="p">,</span> <span class="n">Y_up</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">PTS</span></div>


<span class="c1">#</span>
<span class="c1">#</span>
<span class="n">fig_y_pos</span> <span class="o">=</span> <span class="mi">25</span>


<span class="k">def</span> <span class="nf">vertical_plot_init</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">):</span>

    <span class="c1"># this is same as plot_init, but stacks things  vertically</span>
    <span class="k">global</span> <span class="n">fig_y_pos</span>
    <span class="n">dpi</span> <span class="o">=</span> <span class="mi">80</span>
    <span class="c1"># plt.ion()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">fignum</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>
<span class="c1">#    if not isServer:</span>
<span class="c1">#        plt.get_current_fig_manager().window.wm_geometry(&#39;+%d+%d&#39; % (25,fig_y_pos))</span>
<span class="c1">#        fig_y_pos = fig_y_pos + dpi*(h) + 25</span>


<div class="viewcode-block" id="plot_strat"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmagplotlib.plot_strat">[docs]</a><span class="k">def</span> <span class="nf">plot_strat</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">     plots a time/depth series</span>
<span class="sd">     Parameters</span>
<span class="sd">     _________</span>
<span class="sd">     fignum : matplotlib figure number</span>
<span class="sd">     data : nested list of [X,Y] pairs</span>
<span class="sd">     labels : [xlabel, ylabel, title]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">vertical_plot_init</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">xlab</span><span class="p">,</span> <span class="n">ylab</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">labels</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">labels</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">Y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="s1">&#39;ro&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">xlab</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">ylab</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span></div>

<span class="c1">#</span>
<span class="c1">#</span>


<div class="viewcode-block" id="plot_cdf"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmagplotlib.plot_cdf">[docs]</a><span class="k">def</span> <span class="nf">plot_cdf</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">xlab</span><span class="p">,</span> <span class="n">sym</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Makes a plot of the cumulative distribution function.</span>
<span class="sd">    Parameters</span>
<span class="sd">    __________</span>
<span class="sd">    fignum : matplotlib figure number</span>
<span class="sd">    data : list of data to be plotted - doesn&#39;t need to be sorted</span>
<span class="sd">    sym : matplotlib symbol for plotting, e.g., &#39;r--&#39; for a red dashed line</span>
<span class="sd">    **kwargs :  optional dictionary with {&#39;color&#39;: color, &#39;linewidth&#39;:linewidth, &#39;fontsize&#39;:fontsize for axes labels}</span>

<span class="sd">    Returns</span>
<span class="sd">    __________</span>
<span class="sd">    x : sorted list of data</span>
<span class="sd">    y : fraction of cdf</span>
<span class="sd">    &quot;&quot;&quot;</span>
<span class="c1">#</span>
    <span class="c1">#if len(sym)==1:sym=sym+&#39;-&#39;</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">fignum</span><span class="p">)</span>
    <span class="c1"># sdata=np.array(data).sort()</span>
    <span class="n">sdata</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="n">sdata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>  <span class="c1"># have to copy the data to avoid overwriting it!</span>
    <span class="n">sdata</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sdata</span><span class="p">)):</span>
        <span class="n">Y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sdata</span><span class="p">)))</span>
        <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sdata</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
    <span class="k">if</span> <span class="s1">&#39;color&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="s1">&#39;linewidth&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="n">lw</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;linewidth&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">lw</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">color</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">lw</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">sym</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">lw</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">xlab</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fontsize&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Cumulative Distribution&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fontsize&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span></div>
<span class="c1">#</span>


<div class="viewcode-block" id="plot_hs"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmagplotlib.plot_hs">[docs]</a><span class="k">def</span> <span class="nf">plot_hs</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span> <span class="n">Ys</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">ls</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    plots  horizontal lines at Ys values</span>

<span class="sd">    Parameters</span>
<span class="sd">    _________</span>
<span class="sd">    fignum : matplotlib figure number</span>
<span class="sd">    Ys : list of Y values for lines</span>
<span class="sd">    c : color for lines</span>
<span class="sd">    ls : linestyle for lines</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">fignum</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">yv</span> <span class="ow">in</span> <span class="n">Ys</span><span class="p">:</span>
        <span class="n">bounds</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">yv</span><span class="p">,</span> <span class="n">xmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="n">ls</span><span class="p">)</span></div>
<span class="c1">#</span>


<div class="viewcode-block" id="plot_vs"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmagplotlib.plot_vs">[docs]</a><span class="k">def</span> <span class="nf">plot_vs</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span> <span class="n">Xs</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">ls</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    plots  vertical lines at Xs values</span>

<span class="sd">    Parameters</span>
<span class="sd">    _________</span>
<span class="sd">    fignum : matplotlib figure number</span>
<span class="sd">    Xs : list of X values for lines</span>
<span class="sd">    c : color for lines</span>
<span class="sd">    ls : linestyle for lines</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">fignum</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">xv</span> <span class="ow">in</span> <span class="n">Xs</span><span class="p">:</span>
        <span class="n">bounds</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">xv</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="n">bounds</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">ymax</span><span class="o">=</span><span class="n">bounds</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="n">ls</span><span class="p">)</span></div>


<span class="k">def</span> <span class="nf">plot_ts</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span> <span class="n">dates</span><span class="p">,</span> <span class="n">ts</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    plot the geomagnetic polarity time scale</span>

<span class="sd">    Parameters</span>
<span class="sd">    __________</span>
<span class="sd">    fignum : matplotlib figure number</span>
<span class="sd">    dates : bounding dates for plot</span>
<span class="sd">    ts : time scale ck95, gts04, or gts12</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">vertical_plot_init</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">TS</span><span class="p">,</span> <span class="n">Chrons</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">get_ts</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">TS</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">d</span> <span class="o">&lt;=</span> <span class="n">dates</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">d</span> <span class="o">&gt;=</span> <span class="n">dates</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">ind</span> <span class="o">=</span> <span class="n">TS</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
                    <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">TS</span><span class="p">[</span><span class="n">ind</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
                    <span class="n">Y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span> <span class="o">%</span> <span class="mi">2</span><span class="p">)</span>
                <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
                <span class="n">Y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span> <span class="o">%</span> <span class="mi">2</span><span class="p">)</span>
                <span class="n">p</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
                <span class="n">Y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span> <span class="o">%</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dates</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">Y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span> <span class="o">%</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
            <span class="n">plot_vs</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span> <span class="n">dates</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>
            <span class="n">plot_hs</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">.1</span><span class="p">],</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Age (Ma): &quot;</span> <span class="o">+</span> <span class="n">ts</span><span class="p">)</span>
            <span class="n">isign</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">Chrons</span><span class="p">:</span>
                <span class="n">off</span> <span class="o">=</span> <span class="o">-</span><span class="mf">.1</span>
                <span class="n">isign</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">isign</span>
                <span class="k">if</span> <span class="n">isign</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">off</span> <span class="o">=</span> <span class="mf">1.05</span>
                <span class="k">if</span> <span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">X</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mf">.2</span><span class="p">,</span> <span class="n">off</span><span class="p">,</span> <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">return</span>


<div class="viewcode-block" id="plot_hys"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmagplotlib.plot_hys">[docs]</a><span class="k">def</span> <span class="nf">plot_hys</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">   function to plot hysteresis data</span>
<span class="sd">   Parameters:</span>
<span class="sd">   _____________________</span>
<span class="sd">   Input :</span>
<span class="sd">       fignum : matplotlib figure number</span>
<span class="sd">       B : list of field values (in tesla)</span>
<span class="sd">       M : list of magnetizations</span>
<span class="sd">   Output :</span>
<span class="sd">       hpars : dictionary of hysteresis parameters</span>
<span class="sd">           keys: [&#39;hysteresis_xhf&#39;, &#39;hysteresis_ms_moment&#39;, &#39;hysteresis_mr_moment&#39;, &#39;hysteresis_bc&#39;]</span>
<span class="sd">       deltaM : list of differences between down and upgoing loops</span>
<span class="sd">       Bdm : field values</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">B</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
    <span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">spline</span>
    <span class="k">if</span> <span class="n">fignum</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">fignum</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">isServer</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">figtext</span><span class="p">(</span><span class="mf">.02</span><span class="p">,</span> <span class="mf">.01</span><span class="p">,</span> <span class="n">version_num</span><span class="p">)</span>
    <span class="n">hpars</span> <span class="o">=</span> <span class="p">{}</span>
<span class="c1"># close up loop</span>
    <span class="n">Npts</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
    <span class="n">B70</span> <span class="o">=</span> <span class="mf">0.7</span> <span class="o">*</span> <span class="n">B</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># 70 percent of maximum field</span>
    <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">B</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">b</span> <span class="o">&lt;</span> <span class="n">B70</span><span class="p">:</span>
            <span class="k">break</span>
    <span class="n">Nint</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">Nint</span> <span class="o">&gt;</span> <span class="mi">30</span><span class="p">:</span>
        <span class="n">Nint</span> <span class="o">=</span> <span class="mi">30</span>
    <span class="k">if</span> <span class="n">Nint</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">:</span>
        <span class="n">Nint</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="n">Bzero</span><span class="p">,</span> <span class="n">Mzero</span><span class="p">,</span> <span class="n">Mfix</span><span class="p">,</span> <span class="n">Mnorm</span><span class="p">,</span> <span class="n">Madj</span><span class="p">,</span> <span class="n">MadjN</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">Mazero</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">m_init</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">M</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">m_fin</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">diff</span> <span class="o">=</span> <span class="n">m_fin</span> <span class="o">-</span> <span class="n">m_init</span>
    <span class="n">Bmin</span> <span class="o">=</span> <span class="mf">0.</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Npts</span><span class="p">):</span>
        <span class="n">frac</span> <span class="o">=</span> <span class="n">old_div</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">Npts</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">Mfix</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">M</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">diff</span> <span class="o">*</span> <span class="n">frac</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">Bzero</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="ow">and</span> <span class="n">B</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">Bzero</span> <span class="o">=</span> <span class="n">k</span>
        <span class="k">if</span> <span class="n">B</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">Bmin</span><span class="p">:</span>
            <span class="n">Bmin</span> <span class="o">=</span> <span class="n">B</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="n">kmin</span> <span class="o">=</span> <span class="n">k</span>
    <span class="c1"># adjust slope with first 30 data points (throwing out first 3)</span>
    <span class="n">Bslop</span> <span class="o">=</span> <span class="n">B</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="n">Nint</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span>
    <span class="n">Mslop</span> <span class="o">=</span> <span class="n">Mfix</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="n">Nint</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span>
    <span class="c1"># best fit line to high field points</span>
    <span class="n">polyU</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">Bslop</span><span class="p">,</span> <span class="n">Mslop</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># adjust slope with first 30 points of ascending branch</span>
    <span class="n">Bslop</span> <span class="o">=</span> <span class="n">B</span><span class="p">[</span><span class="n">kmin</span><span class="p">:</span><span class="n">kmin</span> <span class="o">+</span> <span class="p">(</span><span class="n">Nint</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
    <span class="n">Mslop</span> <span class="o">=</span> <span class="n">Mfix</span><span class="p">[</span><span class="n">kmin</span><span class="p">:</span><span class="n">kmin</span> <span class="o">+</span> <span class="p">(</span><span class="n">Nint</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
    <span class="c1"># best fit line to high field points</span>
    <span class="n">polyL</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">Bslop</span><span class="p">,</span> <span class="n">Mslop</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">xhf</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">polyU</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">polyL</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>  <span class="c1"># mean of two slopes</span>
    <span class="c1"># convert B to A/m, high field slope in m^3</span>
    <span class="n">hpars</span><span class="p">[</span><span class="s1">&#39;hysteresis_xhf&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%8.2e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">xhf</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mf">1e-7</span><span class="p">)</span>
    <span class="n">meanint</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">polyU</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">polyL</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>  <span class="c1"># mean of two intercepts</span>
    <span class="n">Msat</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">polyU</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">polyL</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>  <span class="c1"># mean of saturation remanence</span>
    <span class="n">Moff</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Npts</span><span class="p">):</span>
        <span class="c1"># take out linear slope and offset (makes symmetric about origin)</span>
        <span class="n">Moff</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">Mfix</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">xhf</span> <span class="o">*</span> <span class="n">B</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">meanint</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">Mzero</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="ow">and</span> <span class="n">Moff</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">Mzero</span> <span class="o">=</span> <span class="n">k</span>
        <span class="k">if</span> <span class="n">Mzero</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span> <span class="ow">and</span> <span class="n">Mazero</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="ow">and</span> <span class="n">Moff</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">Mazero</span> <span class="o">=</span> <span class="n">k</span>
    <span class="n">hpars</span><span class="p">[</span><span class="s1">&#39;hysteresis_ms_moment&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%8.3e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Msat</span><span class="p">)</span>  <span class="c1"># Ms in Am^2</span>
<span class="c1">#</span>
<span class="c1"># split into upper and lower loops for splining</span>
    <span class="n">Mupper</span><span class="p">,</span> <span class="n">Bupper</span><span class="p">,</span> <span class="n">Mlower</span><span class="p">,</span> <span class="n">Blower</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">deltaM</span><span class="p">,</span> <span class="n">Bdm</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>  <span class="c1"># diff between upper and lower curves at Bdm</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">kmin</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">Mupper</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">old_div</span><span class="p">(</span><span class="n">Moff</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">Msat</span><span class="p">))</span>
        <span class="n">Bupper</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">B</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">kmin</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">B</span><span class="p">)):</span>
        <span class="n">Mlower</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">old_div</span><span class="p">(</span><span class="n">Moff</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">Msat</span><span class="p">))</span>
        <span class="n">Blower</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">B</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
    <span class="n">Iupper</span> <span class="o">=</span> <span class="n">spline</span><span class="o">.</span><span class="n">Spline</span><span class="p">(</span><span class="n">Bupper</span><span class="p">,</span> <span class="n">Mupper</span><span class="p">)</span>  <span class="c1"># get splines for upper up and down</span>
    <span class="n">Ilower</span> <span class="o">=</span> <span class="n">spline</span><span class="o">.</span><span class="n">Spline</span><span class="p">(</span><span class="n">Blower</span><span class="p">,</span> <span class="n">Mlower</span><span class="p">)</span>  <span class="c1"># get splines for lower</span>
    <span class="n">incr</span> <span class="o">=</span> <span class="n">B</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mf">.01</span>
    <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">B</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">step</span><span class="o">=</span><span class="n">incr</span><span class="p">):</span>  <span class="c1"># get range of field values</span>
        <span class="n">Mpos</span> <span class="o">=</span> <span class="p">((</span><span class="n">Iupper</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">-</span> <span class="n">Ilower</span><span class="p">(</span><span class="n">b</span><span class="p">)))</span>  <span class="c1"># evaluate on both sides of B</span>
        <span class="n">Mneg</span> <span class="o">=</span> <span class="p">((</span><span class="n">Iupper</span><span class="p">(</span><span class="o">-</span><span class="n">b</span><span class="p">)</span> <span class="o">-</span> <span class="n">Ilower</span><span class="p">(</span><span class="o">-</span><span class="n">b</span><span class="p">)))</span>
        <span class="n">Bdm</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
        <span class="n">deltaM</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">Mpos</span> <span class="o">+</span> <span class="n">Mneg</span><span class="p">))</span>  <span class="c1"># take average delta M</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Npts</span><span class="p">):</span>
        <span class="n">MadjN</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">old_div</span><span class="p">(</span><span class="n">Moff</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">Msat</span><span class="p">))</span>
        <span class="n">Mnorm</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">old_div</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">Msat</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">fignum</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">Mnorm</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">MadjN</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;B (T)&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;M/Msat&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="c1"># find Mr : average of two spline fits evaluated at B=0 (times Msat)</span>
    <span class="n">Mr</span> <span class="o">=</span> <span class="n">Msat</span> <span class="o">*</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">Iupper</span><span class="p">(</span><span class="mf">0.</span><span class="p">)</span> <span class="o">-</span> <span class="n">Ilower</span><span class="p">(</span><span class="mf">0.</span><span class="p">))</span>
    <span class="n">hpars</span><span class="p">[</span><span class="s1">&#39;hysteresis_mr_moment&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%8.3e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Mr</span><span class="p">)</span>
<span class="c1"># find Bc (x intercept), interpolate between two bounding points</span>
    <span class="n">Bz</span> <span class="o">=</span> <span class="n">B</span><span class="p">[</span><span class="n">Mzero</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span><span class="n">Mzero</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">Mz</span> <span class="o">=</span> <span class="n">Moff</span><span class="p">[</span><span class="n">Mzero</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span><span class="n">Mzero</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">Baz</span> <span class="o">=</span> <span class="n">B</span><span class="p">[</span><span class="n">Mazero</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span><span class="n">Mazero</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">Maz</span> <span class="o">=</span> <span class="n">Moff</span><span class="p">[</span><span class="n">Mazero</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span><span class="n">Mazero</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># best fit line through two bounding points</span>
        <span class="n">poly</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">Bz</span><span class="p">,</span> <span class="n">Mz</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">Bc</span> <span class="o">=</span> <span class="n">old_div</span><span class="p">(</span><span class="o">-</span><span class="n">poly</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">poly</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>  <span class="c1"># x intercept</span>
        <span class="c1"># best fit line through two bounding points</span>
        <span class="n">poly</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">Baz</span><span class="p">,</span> <span class="n">Maz</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">Bac</span> <span class="o">=</span> <span class="n">old_div</span><span class="p">(</span><span class="o">-</span><span class="n">poly</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">poly</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>  <span class="c1"># x intercept</span>
        <span class="n">hpars</span><span class="p">[</span><span class="s1">&#39;hysteresis_bc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%8.3e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">Bc</span><span class="p">)</span> <span class="o">+</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Bac</span><span class="p">)))</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">hpars</span><span class="p">[</span><span class="s1">&#39;hysteresis_bc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span>
    <span class="k">return</span> <span class="n">hpars</span><span class="p">,</span> <span class="n">deltaM</span><span class="p">,</span> <span class="n">Bdm</span></div>
<span class="c1">#</span>


<div class="viewcode-block" id="plot_delta_m"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmagplotlib.plot_delta_m">[docs]</a><span class="k">def</span> <span class="nf">plot_delta_m</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">DM</span><span class="p">,</span> <span class="n">Bcr</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    function to plot Delta M curves</span>

<span class="sd">    Parameters</span>
<span class="sd">    __________</span>
<span class="sd">    fignum : matplotlib figure number</span>
<span class="sd">    B : array of field values</span>
<span class="sd">    DM : array of difference between top and bottom curves in hysteresis loop</span>
<span class="sd">    Bcr : coercivity of remanence</span>
<span class="sd">    s : specimen name</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">fignum</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">isServer</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figtext</span><span class="p">(</span><span class="mf">.02</span><span class="p">,</span> <span class="mf">.01</span><span class="p">,</span> <span class="n">version_num</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">DM</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;B (T)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Delta M&#39;</span><span class="p">)</span>
    <span class="n">linex</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">Bcr</span><span class="p">,</span> <span class="n">Bcr</span><span class="p">]</span>
    <span class="n">liney</span> <span class="o">=</span> <span class="p">[</span><span class="n">old_div</span><span class="p">(</span><span class="n">DM</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mf">2.</span><span class="p">),</span> <span class="n">old_div</span><span class="p">(</span><span class="n">DM</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mf">2.</span><span class="p">),</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">linex</span><span class="p">,</span> <span class="n">liney</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">s</span><span class="p">)</span></div>
<span class="c1">#</span>


<div class="viewcode-block" id="plot_d_delta_m"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmagplotlib.plot_d_delta_m">[docs]</a><span class="k">def</span> <span class="nf">plot_d_delta_m</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span> <span class="n">Bdm</span><span class="p">,</span> <span class="n">DdeltaM</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    function to plot d (Delta M)/dB  curves</span>

<span class="sd">    Parameters</span>
<span class="sd">    __________</span>
<span class="sd">    fignum : matplotlib figure number</span>
<span class="sd">    Bdm : change in field</span>
<span class="sd">    Ddelta M : change in delta M</span>
<span class="sd">    s : specimen name</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">fignum</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">isServer</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figtext</span><span class="p">(</span><span class="mf">.02</span><span class="p">,</span> <span class="mf">.01</span><span class="p">,</span> <span class="n">version_num</span><span class="p">)</span>
    <span class="n">start</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">Bdm</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">DdeltaM</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Bdm</span><span class="p">[</span><span class="n">start</span><span class="p">:],</span> <span class="n">DdeltaM</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;B (T)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;d (Delta M)/dB&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">s</span><span class="p">)</span></div>
<span class="c1">#</span>


<div class="viewcode-block" id="plot_imag"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmagplotlib.plot_imag">[docs]</a><span class="k">def</span> <span class="nf">plot_imag</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span> <span class="n">Bimag</span><span class="p">,</span> <span class="n">Mimag</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    function to plot d (Delta M)/dB  curves</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">fignum</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">isServer</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figtext</span><span class="p">(</span><span class="mf">.02</span><span class="p">,</span> <span class="mf">.01</span><span class="p">,</span> <span class="n">version_num</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Bimag</span><span class="p">,</span> <span class="n">Mimag</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;B (T)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;M/Ms&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">s</span><span class="p">)</span></div>
<span class="c1">#</span>


<div class="viewcode-block" id="plot_hdd"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmagplotlib.plot_hdd">[docs]</a><span class="k">def</span> <span class="nf">plot_hdd</span><span class="p">(</span><span class="n">HDD</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to make hysteresis, deltaM and DdeltaM plots</span>
<span class="sd">    Parameters:</span>
<span class="sd">    _______________</span>
<span class="sd">    Input</span>
<span class="sd">        HDD :  dictionary with figure numbers for the keys:</span>
<span class="sd">            &#39;hyst&#39; : hysteresis plot  normalized to maximum value</span>
<span class="sd">            &#39;deltaM&#39; : Delta M plot</span>
<span class="sd">            &#39;DdeltaM&#39; : differential of Delta M plot</span>
<span class="sd">        B : list of field values in tesla</span>
<span class="sd">        M : list of magnetizations in arbitrary units</span>
<span class="sd">        s : specimen name string</span>
<span class="sd">    Ouput</span>
<span class="sd">      hpars : dictionary of hysteresis parameters with keys:</span>
<span class="sd">        &#39;hysteresis_xhf&#39;, &#39;hysteresis_ms_moment&#39;, &#39;hysteresis_mr_moment&#39;, &#39;hysteresis_bc&#39;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">hpars</span><span class="p">,</span> <span class="n">deltaM</span><span class="p">,</span> <span class="n">Bdm</span> <span class="o">=</span> <span class="n">plot_hys</span><span class="p">(</span>
        <span class="n">HDD</span><span class="p">[</span><span class="s1">&#39;hyst&#39;</span><span class="p">],</span> <span class="n">B</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>  <span class="c1"># Moff is the &quot;fixed&quot; loop data</span>
    <span class="n">DdeltaM</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">Mhalf</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">Bdm</span><span class="p">)):</span>
        <span class="c1"># differnential</span>
        <span class="n">DdeltaM</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">old_div</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">deltaM</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">deltaM</span><span class="p">[</span><span class="n">k</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]),</span> <span class="p">(</span><span class="n">Bdm</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">Bdm</span><span class="p">[</span><span class="n">k</span> <span class="o">-</span> <span class="mi">2</span><span class="p">])))</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">deltaM</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">old_div</span><span class="p">(</span><span class="n">deltaM</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">deltaM</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mf">0.5</span><span class="p">:</span>
            <span class="n">Mhalf</span> <span class="o">=</span> <span class="n">k</span>
            <span class="k">break</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">Bhf</span> <span class="o">=</span> <span class="n">Bdm</span><span class="p">[</span><span class="n">Mhalf</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span><span class="n">Mhalf</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">Mhf</span> <span class="o">=</span> <span class="n">deltaM</span><span class="p">[</span><span class="n">Mhalf</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span><span class="n">Mhalf</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
        <span class="c1"># best fit line through two bounding points</span>
        <span class="n">poly</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">Bhf</span><span class="p">,</span> <span class="n">Mhf</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">Bcr</span> <span class="o">=</span> <span class="n">old_div</span><span class="p">((</span><span class="mf">.5</span> <span class="o">*</span> <span class="n">deltaM</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">poly</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">poly</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">hpars</span><span class="p">[</span><span class="s1">&#39;hysteresis_bcr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%8.3e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Bcr</span><span class="p">)</span>
        <span class="n">hpars</span><span class="p">[</span><span class="s1">&#39;magic_method_codes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;LP-BCR-HDM&quot;</span>
        <span class="k">if</span> <span class="n">HDD</span><span class="p">[</span><span class="s1">&#39;deltaM&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">plot_delta_m</span><span class="p">(</span><span class="n">HDD</span><span class="p">[</span><span class="s1">&#39;deltaM&#39;</span><span class="p">],</span> <span class="n">Bdm</span><span class="p">,</span> <span class="n">deltaM</span><span class="p">,</span> <span class="n">Bcr</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
            <span class="n">plot_d_delta_m</span><span class="p">(</span><span class="n">HDD</span><span class="p">[</span><span class="s1">&#39;DdeltaM&#39;</span><span class="p">],</span> <span class="n">Bdm</span><span class="p">,</span> <span class="n">DdeltaM</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">hpars</span><span class="p">[</span><span class="s1">&#39;hysteresis_bcr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span>
        <span class="n">hpars</span><span class="p">[</span><span class="s1">&#39;magic_method_codes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">return</span> <span class="n">hpars</span></div>
<span class="c1">#</span>


<div class="viewcode-block" id="plot_day"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmagplotlib.plot_day">[docs]</a><span class="k">def</span> <span class="nf">plot_day</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span> <span class="n">BcrBc</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">sym</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    function to plot Day plots</span>

<span class="sd">    Parameters</span>
<span class="sd">    _________</span>
<span class="sd">    fignum : matplotlib figure number</span>
<span class="sd">    BcrBc : list or array ratio of coercivity of remenance to coercivity</span>
<span class="sd">    S : list or array ratio of saturation remanence to saturation magnetization (squareness)</span>
<span class="sd">    sym : matplotlib symbol (e.g., &#39;rs&#39; for red squares)</span>
<span class="sd">    **kwargs :  dictionary with {&#39;names&#39;:[list of names for symbols]}</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">fignum</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">BcrBc</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">sym</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mf">.05</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mf">.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Bcr/Bc&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Mr/Ms&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Day Plot&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
    <span class="c1">#bounds= plt.axis()</span>
    <span class="c1">#plt.axis([0, bounds[1],0, 1])</span>
    <span class="n">mu_o</span> <span class="o">=</span> <span class="mf">4.</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mf">1e-7</span>
    <span class="n">Bc_sd</span> <span class="o">=</span> <span class="mf">46e-3</span>  <span class="c1"># (MV1H) dunlop and carter-stiglitz 2006 (in T)</span>
    <span class="n">Bc_md</span> <span class="o">=</span> <span class="mf">5.56e-3</span>  <span class="c1"># (041183) dunlop and carter-stiglitz 2006 (in T)</span>
    <span class="n">chi_sd</span> <span class="o">=</span> <span class="mf">5.20e6</span> <span class="o">*</span> <span class="n">mu_o</span>  <span class="c1"># now in T</span>
    <span class="n">chi_md</span> <span class="o">=</span> <span class="mf">4.14e6</span> <span class="o">*</span> <span class="n">mu_o</span>  <span class="c1"># now in T</span>
    <span class="n">chi_r_sd</span> <span class="o">=</span> <span class="mf">4.55e6</span> <span class="o">*</span> <span class="n">mu_o</span>  <span class="c1"># now in T</span>
    <span class="n">chi_r_md</span> <span class="o">=</span> <span class="mf">0.88e6</span> <span class="o">*</span> <span class="n">mu_o</span>  <span class="c1"># now in T</span>
    <span class="n">Bcr_sd</span><span class="p">,</span> <span class="n">Bcr_md</span> <span class="o">=</span> <span class="mf">52.5e-3</span><span class="p">,</span> <span class="mf">26.1e-3</span>  <span class="c1"># (MV1H and 041183 in DC06 in tesla)</span>
    <span class="n">Ms</span> <span class="o">=</span> <span class="mf">480e3</span>  <span class="c1"># A/m</span>
    <span class="n">p</span> <span class="o">=</span> <span class="mf">.1</span>  <span class="c1"># from Dunlop 2002</span>
    <span class="n">N</span> <span class="o">=</span> <span class="n">old_div</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">)</span>  <span class="c1"># demagnetizing factor</span>
    <span class="n">f_sd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">.01</span><span class="p">)</span>  <span class="c1"># fraction of sd</span>
    <span class="n">f_md</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">f_sd</span>  <span class="c1"># fraction of md</span>
    <span class="n">f_sp</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">f_sd</span>  <span class="c1"># fraction of sp</span>
    <span class="c1"># Mr/Ms ratios for USD,MD and Jax shaped</span>
    <span class="n">sdrat</span><span class="p">,</span> <span class="n">mdrat</span><span class="p">,</span> <span class="n">cbrat</span> <span class="o">=</span> <span class="mf">0.498</span><span class="p">,</span> <span class="mf">0.048</span><span class="p">,</span> <span class="mf">0.6</span>
    <span class="n">Mrat</span> <span class="o">=</span> <span class="n">f_sd</span> <span class="o">*</span> <span class="n">sdrat</span> <span class="o">+</span> <span class="n">f_md</span> <span class="o">*</span> <span class="n">mdrat</span>  <span class="c1"># linear mixing - eq. 9 in Dunlop 2002</span>
    <span class="n">Bc</span> <span class="o">=</span> <span class="n">old_div</span><span class="p">((</span><span class="n">f_sd</span> <span class="o">*</span> <span class="n">chi_sd</span> <span class="o">*</span> <span class="n">Bc_sd</span> <span class="o">+</span> <span class="n">f_md</span> <span class="o">*</span> <span class="n">chi_md</span> <span class="o">*</span> <span class="n">Bc_md</span><span class="p">),</span>
                 <span class="p">(</span><span class="n">f_sd</span> <span class="o">*</span> <span class="n">chi_sd</span> <span class="o">+</span> <span class="n">f_md</span> <span class="o">*</span> <span class="n">chi_md</span><span class="p">))</span>  <span class="c1"># eq. 10 in Dunlop 2002</span>
    <span class="n">Bcr</span> <span class="o">=</span> <span class="n">old_div</span><span class="p">((</span><span class="n">f_sd</span> <span class="o">*</span> <span class="n">chi_r_sd</span> <span class="o">*</span> <span class="n">Bcr_sd</span> <span class="o">+</span> <span class="n">f_md</span> <span class="o">*</span> <span class="n">chi_r_md</span> <span class="o">*</span> <span class="n">Bcr_md</span><span class="p">),</span>
                  <span class="p">(</span><span class="n">f_sd</span> <span class="o">*</span> <span class="n">chi_r_sd</span> <span class="o">+</span> <span class="n">f_md</span> <span class="o">*</span> <span class="n">chi_r_md</span><span class="p">))</span>  <span class="c1"># eq. 11 in Dunlop 2002</span>
    <span class="n">chi_sps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="n">chi_sd</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">old_div</span><span class="p">(</span><span class="n">Bcr</span><span class="p">,</span> <span class="n">Bc</span><span class="p">),</span> <span class="n">Mrat</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="s1">&#39;names&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="n">names</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;names&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">)):</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">BcrBc</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">S</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">names</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>  <span class="c1"># ,&#39;ha&#39;=&#39;left&#39;</span></div>


<span class="c1">#</span>
<div class="viewcode-block" id="plot_s_bc"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmagplotlib.plot_s_bc">[docs]</a><span class="k">def</span> <span class="nf">plot_s_bc</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span> <span class="n">Bc</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">sym</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    function to plot Squareness,Coercivity</span>

<span class="sd">    Parameters</span>
<span class="sd">    __________</span>
<span class="sd">    fignum : matplotlib figure number</span>
<span class="sd">    Bc : list or array coercivity values</span>
<span class="sd">    S : list or array of ratio of saturation remanence to saturation</span>
<span class="sd">    sym : matplotlib symbol (e.g., &#39;g^&#39; for green triangles)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">fignum</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Bc</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">sym</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Bc&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Mr/Ms&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Squareness-Coercivity Plot&#39;</span><span class="p">)</span>
    <span class="n">bounds</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span></div>
<span class="c1">#</span>


<div class="viewcode-block" id="plot_s_bcr"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmagplotlib.plot_s_bcr">[docs]</a><span class="k">def</span> <span class="nf">plot_s_bcr</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span> <span class="n">Bcr</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">sym</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    function to plot Squareness,Coercivity of remanence</span>

<span class="sd">    Parameters</span>
<span class="sd">    __________</span>
<span class="sd">    fignum : matplotlib figure number</span>
<span class="sd">    Bcr : list or array coercivity of remenence values</span>
<span class="sd">    S : list or array of ratio of saturation remanence to saturation</span>
<span class="sd">    sym : matplotlib symbol (e.g., &#39;g^&#39; for green triangles)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">fignum</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Bcr</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">sym</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Bcr&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Mr/Ms&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Squareness-Bcr Plot&#39;</span><span class="p">)</span>
    <span class="n">bounds</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span></div>
<span class="c1">#</span>


<div class="viewcode-block" id="plot_bcr"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmagplotlib.plot_bcr">[docs]</a><span class="k">def</span> <span class="nf">plot_bcr</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span> <span class="n">Bcr1</span><span class="p">,</span> <span class="n">Bcr2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    function to plot two estimates of Bcr against each other</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">fignum</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Bcr1</span><span class="p">,</span> <span class="n">Bcr2</span><span class="p">,</span> <span class="s1">&#39;ro&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Bcr1&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Bcr2&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Compare coercivity of remanence&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="plot_hpars"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmagplotlib.plot_hpars">[docs]</a><span class="k">def</span> <span class="nf">plot_hpars</span><span class="p">(</span><span class="n">HDD</span><span class="p">,</span> <span class="n">hpars</span><span class="p">,</span> <span class="n">sym</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    function to plot hysteresis parameters</span>
<span class="sd">    deprecated (used in hysteresis_magic)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">HDD</span><span class="p">[</span><span class="s1">&#39;hyst&#39;</span><span class="p">])</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">Y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">old_div</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">hpars</span><span class="p">[</span><span class="s1">&#39;hysteresis_mr_moment&#39;</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span>
        <span class="n">hpars</span><span class="p">[</span><span class="s1">&#39;hysteresis_ms_moment&#39;</span><span class="p">])))</span>
    <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">hpars</span><span class="p">[</span><span class="s1">&#39;hysteresis_bc&#39;</span><span class="p">]))</span>
    <span class="n">Y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">sym</span><span class="p">)</span>
    <span class="n">bounds</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">()</span>
    <span class="n">n4</span> <span class="o">=</span> <span class="s1">&#39;Ms: &#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="si">%8.2e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">hpars</span><span class="p">[</span><span class="s1">&#39;hysteresis_ms_moment&#39;</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39; Am^2&#39;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mf">.9</span> <span class="o">*</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="mf">.9</span><span class="p">,</span> <span class="n">n4</span><span class="p">)</span>
    <span class="n">n1</span> <span class="o">=</span> <span class="s1">&#39;Mr: &#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="si">%8.2e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">hpars</span><span class="p">[</span><span class="s1">&#39;hysteresis_mr_moment&#39;</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39; Am^2&#39;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mf">.9</span> <span class="o">*</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="mf">.7</span><span class="p">,</span> <span class="n">n1</span><span class="p">)</span>
    <span class="n">n2</span> <span class="o">=</span> <span class="s1">&#39;Bc: &#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="si">%8.2e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">hpars</span><span class="p">[</span><span class="s1">&#39;hysteresis_bc&#39;</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39; T&#39;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mf">.9</span> <span class="o">*</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="mf">.5</span><span class="p">,</span> <span class="n">n2</span><span class="p">)</span>
    <span class="k">if</span> <span class="s1">&#39;hysteresis_xhf&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">hpars</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="n">n3</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;Xhf: &#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="si">%8.2e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">hpars</span><span class="p">[</span><span class="s1">&#39;hysteresis_xhf&#39;</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39; m^3&#39;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mf">.9</span> <span class="o">*</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="mf">.3</span><span class="p">,</span> <span class="n">n3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">HDD</span><span class="p">[</span><span class="s1">&#39;deltaM&#39;</span><span class="p">])</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Bcr</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="s2">&quot;&quot;</span>
    <span class="k">if</span> <span class="s1">&#39;hysteresis_bcr&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">hpars</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">hpars</span><span class="p">[</span><span class="s1">&#39;hysteresis_bcr&#39;</span><span class="p">]))</span>
        <span class="n">Y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">Bcr</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">hpars</span><span class="p">[</span><span class="s1">&#39;hysteresis_bcr&#39;</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">sym</span><span class="p">)</span>
    <span class="n">bounds</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">Bcr</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
        <span class="n">n1</span> <span class="o">=</span> <span class="s1">&#39;Bcr: &#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="si">%8.2e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Bcr</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; T&#39;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mf">.5</span> <span class="o">*</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mf">.9</span> <span class="o">*</span> <span class="n">bounds</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">n1</span><span class="p">)</span></div>
<span class="c1">#</span>


<div class="viewcode-block" id="plot_irm"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmagplotlib.plot_irm">[docs]</a><span class="k">def</span> <span class="nf">plot_irm</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    function to plot IRM backfield curves</span>

<span class="sd">    Parameters</span>
<span class="sd">    _________</span>
<span class="sd">    fignum : matplotlib figure number</span>
<span class="sd">    B : list or array of field values</span>
<span class="sd">    M : list or array of magnetizations</span>
<span class="sd">    title : string title for plot</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rpars</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">Mnorm</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">backfield</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">B</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">M</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">break</span>
    <span class="k">if</span> <span class="n">k</span> <span class="o">&lt;=</span> <span class="mi">5</span><span class="p">:</span>
        <span class="n">kmin</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">kmin</span> <span class="o">=</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">5</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">kmin</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">B</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">B</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">backfield</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">Y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">backfield</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">poly</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">poly</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">bcr</span> <span class="o">=</span> <span class="p">(</span><span class="n">old_div</span><span class="p">(</span><span class="o">-</span><span class="n">poly</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">poly</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">bcr</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">rpars</span><span class="p">[</span><span class="s1">&#39;remanence_mr_moment&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%8.3e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">rpars</span><span class="p">[</span><span class="s1">&#39;remanence_bcr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%8.3e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="o">-</span><span class="n">bcr</span><span class="p">)</span>
        <span class="n">rpars</span><span class="p">[</span><span class="s1">&#39;magic_method_codes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;LP-BCR-BF&#39;</span>
        <span class="k">if</span> <span class="n">M</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">M</span><span class="p">:</span>
                <span class="n">Mnorm</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">old_div</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">M</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>  <span class="c1"># normalize to unity Msat</span>
            <span class="n">title</span> <span class="o">=</span> <span class="n">title</span> <span class="o">+</span> <span class="s1">&#39;:&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="si">%8.3e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">M</span><span class="p">:</span>
                <span class="n">Mnorm</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">old_div</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>  <span class="c1"># normalize to unity Msat</span>
            <span class="n">title</span> <span class="o">=</span> <span class="n">title</span> <span class="o">+</span> <span class="s1">&#39;:&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="si">%8.3e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="c1"># do plots if desired</span>
    <span class="k">if</span> <span class="n">fignum</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">M</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># skip plot for fignum = 0</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">fignum</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">isServer</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">figtext</span><span class="p">(</span><span class="mf">.02</span><span class="p">,</span> <span class="mf">.01</span><span class="p">,</span> <span class="n">version_num</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">Mnorm</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;B (T)&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;M/Mr&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">backfield</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">([</span><span class="n">bcr</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
            <span class="n">bounds</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">()</span>
            <span class="n">n1</span> <span class="o">=</span> <span class="s1">&#39;Bcr: &#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="si">%8.2e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="o">-</span><span class="n">bcr</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; T&#39;</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">figtext</span><span class="p">(</span><span class="mf">.2</span><span class="p">,</span> <span class="mf">.5</span><span class="p">,</span> <span class="n">n1</span><span class="p">)</span>
            <span class="n">n2</span> <span class="o">=</span> <span class="s1">&#39;Mr: &#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="si">%8.2e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39; Am^2&#39;</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">figtext</span><span class="p">(</span><span class="mf">.2</span><span class="p">,</span> <span class="mf">.45</span><span class="p">,</span> <span class="n">n2</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">fignum</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">fignum</span><span class="p">)</span>
        <span class="c1"># plt.clf()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">isServer</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">figtext</span><span class="p">(</span><span class="mf">.02</span><span class="p">,</span> <span class="mf">.01</span><span class="p">,</span> <span class="n">version_num</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;M[0]=0,  skipping specimen&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">rpars</span></div>


<div class="viewcode-block" id="plot_xtf"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmagplotlib.plot_xtf">[docs]</a><span class="k">def</span> <span class="nf">plot_xtf</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span> <span class="n">XTF</span><span class="p">,</span> <span class="n">Fs</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    function to plot series of chi measurements as a function of temperature, holding field constant and varying frequency</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">fignum</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Temperature (K)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Susceptibility (m^3/kg)&#39;</span><span class="p">)</span>
    <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">Flab</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">freq</span> <span class="ow">in</span> <span class="n">XTF</span><span class="p">:</span>
        <span class="n">T</span><span class="p">,</span> <span class="n">X</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">xt</span> <span class="ow">in</span> <span class="n">freq</span><span class="p">:</span>
            <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xt</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">T</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xt</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">T</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">Fs</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39; Hz&#39;</span><span class="p">)</span>
<span class="c1">#        Flab.append(str(int(Fs[k]))+&#39; Hz&#39;)</span>
        <span class="n">k</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">e</span> <span class="o">+</span> <span class="s1">&#39;: B = &#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="si">%8.1e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; T&#39;</span><span class="p">)</span></div>
<span class="c1">#    plt.legend(Flab,&#39;upper left&#39;)</span>
<span class="c1">#</span>


<div class="viewcode-block" id="plot_xtb"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmagplotlib.plot_xtb">[docs]</a><span class="k">def</span> <span class="nf">plot_xtb</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span> <span class="n">XTB</span><span class="p">,</span> <span class="n">Bs</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">f</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; function to plot series of chi measurements as a function of temperature, holding frequency constant and varying B</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">fignum</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Temperature (K)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Susceptibility (m^3/kg)&#39;</span><span class="p">)</span>
    <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">Blab</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">XTB</span><span class="p">:</span>
        <span class="n">T</span><span class="p">,</span> <span class="n">X</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">xt</span> <span class="ow">in</span> <span class="n">field</span><span class="p">:</span>
            <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xt</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">T</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xt</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">T</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;</span><span class="si">%8.2e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Bs</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39; T&#39;</span><span class="p">)</span>
<span class="c1">#        Blab.append(&#39;%8.1e&#39;%(Bs[k])+&#39; T&#39;)</span>
        <span class="n">k</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">e</span> <span class="o">+</span> <span class="s1">&#39;: f = &#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="si">%i</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">f</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39; Hz&#39;</span><span class="p">)</span></div>
<span class="c1">#    plt.legend(Blab,&#39;upper left&#39;)</span>
<span class="c1">#</span>


<div class="viewcode-block" id="plot_xft"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmagplotlib.plot_xft">[docs]</a><span class="k">def</span> <span class="nf">plot_xft</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span> <span class="n">XF</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; function to plot series of chi measurements as a function of temperature, holding field constant and varying frequency</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">fignum</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">isServer</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figtext</span><span class="p">(</span><span class="mf">.02</span><span class="p">,</span> <span class="mf">.01</span><span class="p">,</span> <span class="n">version_num</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Susceptibility (m^3/kg)&#39;</span><span class="p">)</span>
    <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">F</span><span class="p">,</span> <span class="n">X</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">xf</span> <span class="ow">in</span> <span class="n">XF</span><span class="p">:</span>
        <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xf</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">F</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xf</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">semilogx</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">e</span> <span class="o">+</span> <span class="s1">&#39;: B = &#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="si">%8.1e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; T&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;</span><span class="si">%i</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">T</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39; K&#39;</span><span class="p">])</span></div>
<span class="c1">#</span>


<div class="viewcode-block" id="plot_xbt"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmagplotlib.plot_xbt">[docs]</a><span class="k">def</span> <span class="nf">plot_xbt</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span> <span class="n">XB</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; function to plot series of chi measurements as a function of temperature, holding field constant and varying frequency</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">fignum</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">isServer</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figtext</span><span class="p">(</span><span class="mf">.02</span><span class="p">,</span> <span class="mf">.01</span><span class="p">,</span> <span class="n">version_num</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Field (T)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Susceptibility (m^3/kg)&#39;</span><span class="p">)</span>
    <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">B</span><span class="p">,</span> <span class="n">X</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">xb</span> <span class="ow">in</span> <span class="n">XB</span><span class="p">:</span>
        <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xb</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">B</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xb</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;</span><span class="si">%i</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">T</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39; K&#39;</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">e</span> <span class="o">+</span> <span class="s1">&#39;: f = &#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="si">%i</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">f</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39; Hz&#39;</span><span class="p">)</span></div>
<span class="c1">#</span>


<div class="viewcode-block" id="plot_ltc"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmagplotlib.plot_ltc">[docs]</a><span class="k">def</span> <span class="nf">plot_ltc</span><span class="p">(</span><span class="n">LTC_CM</span><span class="p">,</span> <span class="n">LTC_CT</span><span class="p">,</span> <span class="n">LTC_WM</span><span class="p">,</span> <span class="n">LTC_WT</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    function to plot low temperature cycling experiments</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">leglist</span><span class="p">,</span> <span class="n">init</span> <span class="o">=</span> <span class="p">[],</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">LTC_CM</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">init</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">plot_init</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">LTC_CT</span><span class="p">,</span> <span class="n">LTC_CM</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
        <span class="n">leglist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;RT SIRM, measured while cooling&#39;</span><span class="p">)</span>
        <span class="n">init</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">LTC_WM</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">init</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">plot_init</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">LTC_WT</span><span class="p">,</span> <span class="n">LTC_WM</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="n">leglist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;RT SIRM, measured while warming&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">init</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">leglist</span><span class="p">,</span> <span class="s1">&#39;lower left&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Temperature (K)&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Magnetization (Am^2/kg)&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">LTC_CM</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">LTC_CT</span><span class="p">,</span> <span class="n">LTC_CM</span><span class="p">,</span> <span class="s1">&#39;bo&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">LTC_WM</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">LTC_WT</span><span class="p">,</span> <span class="n">LTC_WM</span><span class="p">,</span> <span class="s1">&#39;ro&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">e</span><span class="p">)</span></div>


<span class="k">def</span> <span class="nf">plot_anis</span><span class="p">(</span><span class="n">ANIS</span><span class="p">,</span> <span class="n">Ss</span><span class="p">,</span> <span class="n">iboot</span><span class="p">,</span> <span class="n">ihext</span><span class="p">,</span> <span class="n">ivec</span><span class="p">,</span> <span class="n">ipar</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">plot</span><span class="p">,</span> <span class="n">comp</span><span class="p">,</span> <span class="n">vec</span><span class="p">,</span> <span class="n">Dir</span><span class="p">,</span> <span class="n">nb</span><span class="p">):</span>
    <span class="n">imeas</span><span class="p">,</span> <span class="n">bpars</span><span class="p">,</span> <span class="n">hpars</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">npts</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">Ss</span><span class="p">)</span>  <span class="c1"># number of data points</span>
    <span class="n">plots</span> <span class="o">=</span> <span class="p">{}</span>
<span class="c1">#</span>
<span class="c1"># plot eigenvectors:</span>
<span class="c1">#</span>
    <span class="n">Vs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">Ss</span><span class="p">:</span>
        <span class="n">tau</span><span class="p">,</span> <span class="n">V</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">doseigs</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="n">Vs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
    <span class="n">nf</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">avs</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">sbar</span><span class="p">(</span><span class="n">Ss</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">plot</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">ANIS</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">ANIS</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">isServer</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">figtext</span><span class="p">(</span><span class="mf">.02</span><span class="p">,</span> <span class="mf">.01</span><span class="p">,</span> <span class="n">version_num</span><span class="p">)</span>
        <span class="n">plot_net</span><span class="p">(</span><span class="n">ANIS</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">])</span>  <span class="c1"># draw the net</span>
        <span class="n">plot_evec</span><span class="p">(</span><span class="n">ANIS</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">],</span> <span class="n">Vs</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>  <span class="c1"># put on the data eigenvectors</span>
<span class="c1">#</span>
<span class="c1"># plot mean eigenvectors</span>
<span class="c1">#</span>
    <span class="n">Vs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">mtau</span><span class="p">,</span> <span class="n">mV</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">doseigs</span><span class="p">(</span><span class="n">avs</span><span class="p">)</span>
    <span class="n">Vs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mV</span><span class="p">)</span>
    <span class="n">hpars</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">dohext</span><span class="p">(</span><span class="n">nf</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">avs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">plot</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="n">ihext</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="n">title</span> <span class="o">+</span> <span class="s2">&quot;Hext&quot;</span>
        <span class="k">if</span> <span class="n">iboot</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="n">title</span> <span class="o">+</span> <span class="s2">&quot;:Bootstrap&quot;</span>
        <span class="k">if</span> <span class="n">ipar</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="n">title</span> <span class="o">+</span> <span class="s2">&quot;:Parametric&quot;</span>
        <span class="k">if</span> <span class="n">title</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;:&quot;</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="n">title</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="n">plot_net</span><span class="p">(</span><span class="n">ANIS</span><span class="p">[</span><span class="s1">&#39;conf&#39;</span><span class="p">])</span>  <span class="c1"># draw the net</span>
        <span class="n">plot_evec</span><span class="p">(</span><span class="n">ANIS</span><span class="p">[</span><span class="s1">&#39;conf&#39;</span><span class="p">],</span> <span class="n">Vs</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>  <span class="c1"># put on the mean eigenvectors</span>
<span class="c1">#</span>
<span class="c1"># plot mean confidence</span>
<span class="c1">#</span>
    <span class="k">if</span> <span class="n">iboot</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Doing bootstrap - be patient&#39;</span><span class="p">)</span>
        <span class="n">Tmean</span><span class="p">,</span> <span class="n">Vmean</span><span class="p">,</span> <span class="n">Taus</span><span class="p">,</span> <span class="n">BVs</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">s_boot</span><span class="p">(</span>
            <span class="n">Ss</span><span class="p">,</span> <span class="n">ipar</span><span class="p">,</span> <span class="n">nb</span><span class="p">)</span>  <span class="c1"># get eigenvectors of mean tensor</span>
        <span class="n">bpars</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">sbootpars</span><span class="p">(</span><span class="n">Taus</span><span class="p">,</span> <span class="n">BVs</span><span class="p">)</span>
        <span class="n">bpars</span><span class="p">[</span><span class="s1">&#39;t1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hpars</span><span class="p">[</span><span class="s1">&#39;t1&#39;</span><span class="p">]</span>
        <span class="n">bpars</span><span class="p">[</span><span class="s1">&#39;t2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hpars</span><span class="p">[</span><span class="s1">&#39;t2&#39;</span><span class="p">]</span>
        <span class="n">bpars</span><span class="p">[</span><span class="s1">&#39;t3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hpars</span><span class="p">[</span><span class="s1">&#39;t3&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">plot</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ivec</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="c1"># put on the data eigenvectors</span>
                <span class="n">plot_evec</span><span class="p">(</span><span class="n">ANIS</span><span class="p">[</span><span class="s1">&#39;conf&#39;</span><span class="p">],</span> <span class="n">BVs</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ellpars</span> <span class="o">=</span> <span class="p">[</span><span class="n">hpars</span><span class="p">[</span><span class="s2">&quot;v1_dec&quot;</span><span class="p">],</span> <span class="n">hpars</span><span class="p">[</span><span class="s2">&quot;v1_inc&quot;</span><span class="p">],</span> <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v1_zeta&quot;</span><span class="p">],</span> <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v1_zeta_dec&quot;</span><span class="p">],</span>
                           <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v1_zeta_inc&quot;</span><span class="p">],</span> <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v1_eta&quot;</span><span class="p">],</span> <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v1_eta_dec&quot;</span><span class="p">],</span> <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v1_eta_inc&quot;</span><span class="p">]]</span>
                <span class="n">plot_ell</span><span class="p">(</span><span class="n">ANIS</span><span class="p">[</span><span class="s1">&#39;conf&#39;</span><span class="p">],</span> <span class="n">ellpars</span><span class="p">,</span> <span class="s1">&#39;r-,&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">ellpars</span> <span class="o">=</span> <span class="p">[</span><span class="n">hpars</span><span class="p">[</span><span class="s2">&quot;v2_dec&quot;</span><span class="p">],</span> <span class="n">hpars</span><span class="p">[</span><span class="s2">&quot;v2_inc&quot;</span><span class="p">],</span> <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v2_zeta&quot;</span><span class="p">],</span> <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v2_zeta_dec&quot;</span><span class="p">],</span>
                           <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v2_zeta_inc&quot;</span><span class="p">],</span> <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v2_eta&quot;</span><span class="p">],</span> <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v2_eta_dec&quot;</span><span class="p">],</span> <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v2_eta_inc&quot;</span><span class="p">]]</span>
                <span class="n">plot_ell</span><span class="p">(</span><span class="n">ANIS</span><span class="p">[</span><span class="s1">&#39;conf&#39;</span><span class="p">],</span> <span class="n">ellpars</span><span class="p">,</span> <span class="s1">&#39;b-,&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">ellpars</span> <span class="o">=</span> <span class="p">[</span><span class="n">hpars</span><span class="p">[</span><span class="s2">&quot;v3_dec&quot;</span><span class="p">],</span> <span class="n">hpars</span><span class="p">[</span><span class="s2">&quot;v3_inc&quot;</span><span class="p">],</span> <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v3_zeta&quot;</span><span class="p">],</span> <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v3_zeta_dec&quot;</span><span class="p">],</span>
                           <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v3_zeta_inc&quot;</span><span class="p">],</span> <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v3_eta&quot;</span><span class="p">],</span> <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v3_eta_dec&quot;</span><span class="p">],</span> <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v3_eta_inc&quot;</span><span class="p">]]</span>
                <span class="n">plot_ell</span><span class="p">(</span><span class="n">ANIS</span><span class="p">[</span><span class="s1">&#39;conf&#39;</span><span class="p">],</span> <span class="n">ellpars</span><span class="p">,</span> <span class="s1">&#39;k-,&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">ANIS</span><span class="p">[</span><span class="s1">&#39;tcdf&#39;</span><span class="p">])</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">isServer</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">figtext</span><span class="p">(</span><span class="mf">.02</span><span class="p">,</span> <span class="mf">.01</span><span class="p">,</span> <span class="n">version_num</span><span class="p">)</span>
            <span class="n">ts</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">Taus</span><span class="p">:</span>
                <span class="n">ts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">plot_cdf</span><span class="p">(</span><span class="n">ANIS</span><span class="p">[</span><span class="s1">&#39;tcdf&#39;</span><span class="p">],</span> <span class="n">ts</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="n">ts</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="n">tminind</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">0.025</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">ts</span><span class="p">))</span>
            <span class="n">tmaxind</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">0.975</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">ts</span><span class="p">))</span>
            <span class="n">tbounds</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">tbounds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ts</span><span class="p">[</span><span class="n">tminind</span><span class="p">])</span>
            <span class="n">tbounds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ts</span><span class="p">[</span><span class="n">tmaxind</span><span class="p">])</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">tbounds</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">tbounds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
            <span class="c1"># plot_vs(ANIS[&#39;tcdf&#39;],tbounds,&#39;r&#39;,&#39;-&#39;) # there is some bug in here</span>
            <span class="c1"># - can&#39;t figure it out</span>
            <span class="n">ts</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">Taus</span><span class="p">:</span>
                <span class="n">ts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">plot_cdf</span><span class="p">(</span><span class="n">ANIS</span><span class="p">[</span><span class="s1">&#39;tcdf&#39;</span><span class="p">],</span> <span class="n">ts</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="n">ts</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="n">tminind</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">0.025</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">ts</span><span class="p">))</span>
            <span class="n">tmaxind</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">0.975</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">ts</span><span class="p">))</span>
            <span class="n">tbounds</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">tbounds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ts</span><span class="p">[</span><span class="n">tminind</span><span class="p">])</span>
            <span class="n">tbounds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ts</span><span class="p">[</span><span class="n">tmaxind</span><span class="p">])</span>
            <span class="c1"># plot_vs(ANIS[&#39;tcdf&#39;],tbounds,&#39;b&#39;,&#39;-&#39;)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">tbounds</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">tbounds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">)</span>
            <span class="n">ts</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">Taus</span><span class="p">:</span>
                <span class="n">ts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
            <span class="n">plot_cdf</span><span class="p">(</span><span class="n">ANIS</span><span class="p">[</span><span class="s1">&#39;tcdf&#39;</span><span class="p">],</span> <span class="n">ts</span><span class="p">,</span> <span class="s2">&quot;Eigenvalues&quot;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="n">ts</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="n">tminind</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">0.025</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">ts</span><span class="p">))</span>
            <span class="n">tmaxind</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">0.975</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">ts</span><span class="p">))</span>
            <span class="n">tbounds</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">tbounds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ts</span><span class="p">[</span><span class="n">tminind</span><span class="p">])</span>
            <span class="n">tbounds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ts</span><span class="p">[</span><span class="n">tmaxind</span><span class="p">])</span>
            <span class="n">plot_vs</span><span class="p">(</span><span class="n">ANIS</span><span class="p">[</span><span class="s1">&#39;tcdf&#39;</span><span class="p">],</span> <span class="n">tbounds</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">tbounds</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">tbounds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">comp</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># do eigenvector of choice</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">ANIS</span><span class="p">[</span><span class="s1">&#39;conf&#39;</span><span class="p">])</span>
                <span class="n">XY</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">dimap</span><span class="p">(</span><span class="n">Dir</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Dir</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">([</span><span class="n">XY</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="n">XY</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
                <span class="n">Ccart</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">dir2cart</span><span class="p">(</span><span class="n">Dir</span><span class="p">)</span>
                <span class="n">Vxs</span><span class="p">,</span> <span class="n">Vys</span><span class="p">,</span> <span class="n">Vzs</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">BVs</span><span class="p">:</span>
                    <span class="n">cart</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">dir2cart</span><span class="p">([</span><span class="n">v</span><span class="p">[</span><span class="n">vec</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="n">vec</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="mf">1.</span><span class="p">])</span>
                    <span class="n">Vxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cart</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="n">Vys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cart</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                    <span class="n">Vzs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cart</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">ANIS</span><span class="p">[</span><span class="s1">&#39;vxcdf&#39;</span><span class="p">])</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">isServer</span><span class="p">:</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">figtext</span><span class="p">(</span><span class="mf">.02</span><span class="p">,</span> <span class="mf">.01</span><span class="p">,</span> <span class="n">version_num</span><span class="p">)</span>
                <span class="n">plot_cdf</span><span class="p">(</span><span class="n">ANIS</span><span class="p">[</span><span class="s1">&#39;vxcdf&#39;</span><span class="p">],</span> <span class="n">Vxs</span><span class="p">,</span> <span class="s2">&quot;V_&quot;</span> <span class="o">+</span>
                         <span class="nb">str</span><span class="p">(</span><span class="n">vec</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="n">Vxs</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
                <span class="n">vminind</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">0.025</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">Vxs</span><span class="p">))</span>
                <span class="n">vmaxind</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">0.975</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">Vxs</span><span class="p">))</span>
                <span class="n">vbounds</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">vbounds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Vxs</span><span class="p">[</span><span class="n">vminind</span><span class="p">])</span>
                <span class="n">vbounds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Vxs</span><span class="p">[</span><span class="n">vmaxind</span><span class="p">])</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">vbounds</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">vbounds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
                <span class="c1"># plot_vs(ANIS[&#39;vxcdf&#39;],vbounds,&#39;r&#39;,&#39;--&#39;)</span>
                <span class="c1"># plot_vs(ANIS[&#39;vxcdf&#39;],[Ccart[0]],&#39;r&#39;,&#39;-&#39;)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Ccart</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
                <span class="n">plot_cdf</span><span class="p">(</span><span class="n">ANIS</span><span class="p">[</span><span class="s1">&#39;vycdf&#39;</span><span class="p">],</span> <span class="n">Vys</span><span class="p">,</span> <span class="s2">&quot;V_&quot;</span> <span class="o">+</span>
                         <span class="nb">str</span><span class="p">(</span><span class="n">vec</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="n">Vys</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
                <span class="n">vminind</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">0.025</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">Vys</span><span class="p">))</span>
                <span class="n">vmaxind</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">0.975</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">Vys</span><span class="p">))</span>
                <span class="n">vbounds</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">vbounds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Vys</span><span class="p">[</span><span class="n">vminind</span><span class="p">])</span>
                <span class="n">vbounds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Vys</span><span class="p">[</span><span class="n">vmaxind</span><span class="p">])</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">vbounds</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">vbounds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Ccart</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
                <span class="c1"># plot_vs(ANIS[&#39;vycdf&#39;],vbounds,&#39;b&#39;,&#39;--&#39;)</span>
                <span class="c1"># plot_vs(ANIS[&#39;vycdf&#39;],[Ccart[1]],&#39;b&#39;,&#39;-&#39;)</span>
                <span class="n">plot_cdf</span><span class="p">(</span><span class="n">ANIS</span><span class="p">[</span><span class="s1">&#39;vzcdf&#39;</span><span class="p">],</span> <span class="n">Vzs</span><span class="p">,</span> <span class="s2">&quot;V_&quot;</span> <span class="o">+</span>
                         <span class="nb">str</span><span class="p">(</span><span class="n">vec</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;3&quot;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="n">Vzs</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
                <span class="n">vminind</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">0.025</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">Vzs</span><span class="p">))</span>
                <span class="n">vmaxind</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">0.975</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">Vzs</span><span class="p">))</span>
                <span class="n">vbounds</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">vbounds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Vzs</span><span class="p">[</span><span class="n">vminind</span><span class="p">])</span>
                <span class="n">vbounds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Vzs</span><span class="p">[</span><span class="n">vmaxind</span><span class="p">])</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">vbounds</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">vbounds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Ccart</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
                <span class="c1"># plot_vs(ANIS[&#39;vzcdf&#39;],vbounds,&#39;k&#39;,&#39;--&#39;)</span>
                <span class="c1"># plot_vs(ANIS[&#39;vzcdf&#39;],[Ccart[2]],&#39;k&#39;,&#39;-&#39;)</span>
        <span class="n">bpars</span><span class="p">[</span><span class="s1">&#39;v1_dec&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hpars</span><span class="p">[</span><span class="s1">&#39;v1_dec&#39;</span><span class="p">]</span>
        <span class="n">bpars</span><span class="p">[</span><span class="s1">&#39;v2_dec&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hpars</span><span class="p">[</span><span class="s1">&#39;v2_dec&#39;</span><span class="p">]</span>
        <span class="n">bpars</span><span class="p">[</span><span class="s1">&#39;v3_dec&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hpars</span><span class="p">[</span><span class="s1">&#39;v3_dec&#39;</span><span class="p">]</span>
        <span class="n">bpars</span><span class="p">[</span><span class="s1">&#39;v1_inc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hpars</span><span class="p">[</span><span class="s1">&#39;v1_inc&#39;</span><span class="p">]</span>
        <span class="n">bpars</span><span class="p">[</span><span class="s1">&#39;v2_inc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hpars</span><span class="p">[</span><span class="s1">&#39;v2_inc&#39;</span><span class="p">]</span>
        <span class="n">bpars</span><span class="p">[</span><span class="s1">&#39;v3_inc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hpars</span><span class="p">[</span><span class="s1">&#39;v3_inc&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">ihext</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">plot</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">ellpars</span> <span class="o">=</span> <span class="p">[</span><span class="n">hpars</span><span class="p">[</span><span class="s2">&quot;v1_dec&quot;</span><span class="p">],</span> <span class="n">hpars</span><span class="p">[</span><span class="s2">&quot;v1_inc&quot;</span><span class="p">],</span> <span class="n">hpars</span><span class="p">[</span><span class="s2">&quot;e12&quot;</span><span class="p">],</span> <span class="n">hpars</span><span class="p">[</span><span class="s2">&quot;v2_dec&quot;</span><span class="p">],</span>
                   <span class="n">hpars</span><span class="p">[</span><span class="s2">&quot;v2_inc&quot;</span><span class="p">],</span> <span class="n">hpars</span><span class="p">[</span><span class="s2">&quot;e13&quot;</span><span class="p">],</span> <span class="n">hpars</span><span class="p">[</span><span class="s2">&quot;v3_dec&quot;</span><span class="p">],</span> <span class="n">hpars</span><span class="p">[</span><span class="s2">&quot;v3_inc&quot;</span><span class="p">]]</span>
        <span class="n">plot_ell</span><span class="p">(</span><span class="n">ANIS</span><span class="p">[</span><span class="s1">&#39;conf&#39;</span><span class="p">],</span> <span class="n">ellpars</span><span class="p">,</span> <span class="s1">&#39;r-,&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">ellpars</span> <span class="o">=</span> <span class="p">[</span><span class="n">hpars</span><span class="p">[</span><span class="s2">&quot;v2_dec&quot;</span><span class="p">],</span> <span class="n">hpars</span><span class="p">[</span><span class="s2">&quot;v2_inc&quot;</span><span class="p">],</span> <span class="n">hpars</span><span class="p">[</span><span class="s2">&quot;e23&quot;</span><span class="p">],</span> <span class="n">hpars</span><span class="p">[</span><span class="s2">&quot;v3_dec&quot;</span><span class="p">],</span>
                   <span class="n">hpars</span><span class="p">[</span><span class="s2">&quot;v3_inc&quot;</span><span class="p">],</span> <span class="n">hpars</span><span class="p">[</span><span class="s2">&quot;e12&quot;</span><span class="p">],</span> <span class="n">hpars</span><span class="p">[</span><span class="s2">&quot;v1_dec&quot;</span><span class="p">],</span> <span class="n">hpars</span><span class="p">[</span><span class="s2">&quot;v1_inc&quot;</span><span class="p">]]</span>
        <span class="n">plot_ell</span><span class="p">(</span><span class="n">ANIS</span><span class="p">[</span><span class="s1">&#39;conf&#39;</span><span class="p">],</span> <span class="n">ellpars</span><span class="p">,</span> <span class="s1">&#39;b-,&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">ellpars</span> <span class="o">=</span> <span class="p">[</span><span class="n">hpars</span><span class="p">[</span><span class="s2">&quot;v3_dec&quot;</span><span class="p">],</span> <span class="n">hpars</span><span class="p">[</span><span class="s2">&quot;v3_inc&quot;</span><span class="p">],</span> <span class="n">hpars</span><span class="p">[</span><span class="s2">&quot;e13&quot;</span><span class="p">],</span> <span class="n">hpars</span><span class="p">[</span><span class="s2">&quot;v1_dec&quot;</span><span class="p">],</span>
                   <span class="n">hpars</span><span class="p">[</span><span class="s2">&quot;v1_inc&quot;</span><span class="p">],</span> <span class="n">hpars</span><span class="p">[</span><span class="s2">&quot;e23&quot;</span><span class="p">],</span> <span class="n">hpars</span><span class="p">[</span><span class="s2">&quot;v2_dec&quot;</span><span class="p">],</span> <span class="n">hpars</span><span class="p">[</span><span class="s2">&quot;v2_inc&quot;</span><span class="p">]]</span>
        <span class="n">plot_ell</span><span class="p">(</span><span class="n">ANIS</span><span class="p">[</span><span class="s1">&#39;conf&#39;</span><span class="p">],</span> <span class="n">ellpars</span><span class="p">,</span> <span class="s1">&#39;k-,&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">bpars</span><span class="p">,</span> <span class="n">hpars</span>
<span class="c1">####</span>


<span class="k">def</span> <span class="nf">plot_trm</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">TRM</span><span class="p">,</span> <span class="n">Bp</span><span class="p">,</span> <span class="n">Mp</span><span class="p">,</span> <span class="n">NLpars</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
    <span class="c1">#</span>
    <span class="c1"># plots TRM acquisition data and correction to B_estimated to B_ancient</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">fig</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">isServer</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figtext</span><span class="p">(</span><span class="mf">.02</span><span class="p">,</span> <span class="mf">.01</span><span class="p">,</span> <span class="n">version_num</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;B (uT)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Fractional TRM &#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span> <span class="o">+</span> <span class="s1">&#39;:TRM=&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="si">%8.2e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Mp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
<span class="c1">#</span>
<span class="c1"># scale data</span>
    <span class="n">Bnorm</span><span class="p">,</span> <span class="n">Bpnorm</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">Tnorm</span><span class="p">,</span> <span class="n">Mnorm</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">B</span><span class="p">:</span>
        <span class="n">Bnorm</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">Bp</span><span class="p">:</span>
        <span class="n">Bpnorm</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">TRM</span><span class="p">:</span>
        <span class="n">Tnorm</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">old_div</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Mp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">Mp</span><span class="p">:</span>
        <span class="n">Mnorm</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">old_div</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Mp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Bnorm</span><span class="p">,</span> <span class="n">Tnorm</span><span class="p">,</span> <span class="s1">&#39;go&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Bpnorm</span><span class="p">,</span> <span class="n">Mnorm</span><span class="p">,</span> <span class="s1">&#39;g-&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">NLpars</span><span class="p">[</span><span class="s1">&#39;banc&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">NLpars</span><span class="p">[</span><span class="s1">&#39;best&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">],</span>
                 <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">old_div</span><span class="p">(</span><span class="n">NLpars</span><span class="p">[</span><span class="s1">&#39;banc_npred&#39;</span><span class="p">],</span> <span class="n">Mp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])],</span> <span class="s1">&#39;b--&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">NLpars</span><span class="p">[</span><span class="s1">&#39;best&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">,</span> <span class="n">NLpars</span><span class="p">[</span><span class="s1">&#39;banc&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">],</span> <span class="p">[</span><span class="n">old_div</span><span class="p">(</span>
            <span class="n">NLpars</span><span class="p">[</span><span class="s1">&#39;banc_npred&#39;</span><span class="p">],</span> <span class="n">Mp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="n">old_div</span><span class="p">(</span><span class="n">NLpars</span><span class="p">[</span><span class="s1">&#39;banc_npred&#39;</span><span class="p">],</span> <span class="n">Mp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])],</span> <span class="s1">&#39;r--&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">NLpars</span><span class="p">[</span><span class="s1">&#39;best&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">],</span>
                 <span class="p">[</span><span class="n">old_div</span><span class="p">(</span><span class="n">NLpars</span><span class="p">[</span><span class="s1">&#39;banc_npred&#39;</span><span class="p">],</span> <span class="n">Mp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])],</span> <span class="s1">&#39;bd&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">NLpars</span><span class="p">[</span><span class="s1">&#39;banc&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">],</span>
                 <span class="p">[</span><span class="n">old_div</span><span class="p">(</span><span class="n">NLpars</span><span class="p">[</span><span class="s1">&#39;banc_npred&#39;</span><span class="p">],</span> <span class="n">Mp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])],</span> <span class="s1">&#39;rs&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">NLpars</span><span class="p">[</span><span class="s1">&#39;best&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">],</span>
                 <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">old_div</span><span class="p">(</span><span class="n">NLpars</span><span class="p">[</span><span class="s1">&#39;best_npred&#39;</span><span class="p">],</span> <span class="n">Mp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])],</span> <span class="s1">&#39;b--&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">NLpars</span><span class="p">[</span><span class="s1">&#39;best&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">],</span>
                 <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">old_div</span><span class="p">(</span><span class="n">NLpars</span><span class="p">[</span><span class="s1">&#39;best_npred&#39;</span><span class="p">],</span> <span class="n">Mp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])],</span> <span class="s1">&#39;bd&#39;</span><span class="p">)</span>

<span class="c1">###</span>


<span class="k">def</span> <span class="nf">plot_tds</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">tdsblock</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">fig</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">isServer</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figtext</span><span class="p">(</span><span class="mf">.02</span><span class="p">,</span> <span class="mf">.01</span><span class="p">,</span> <span class="n">version_num</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Fraction TRM remaining&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Fraction NRM remaining&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">tdsblock</span><span class="p">:</span>
        <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>  <span class="c1"># TRM on X</span>
        <span class="n">Y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>  <span class="c1"># NRM on Y</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">Y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39; </span><span class="si">%3.1f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="mi">273</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="s1">&#39;ro&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>


<div class="viewcode-block" id="plot_conf"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmagplotlib.plot_conf">[docs]</a><span class="k">def</span> <span class="nf">plot_conf</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">datablock</span><span class="p">,</span> <span class="n">pars</span><span class="p">,</span> <span class="n">new</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    plots directions and confidence ellipses</span>
<span class="sd">    &quot;&quot;&quot;</span>
<span class="c1"># make the stereonet</span>
    <span class="k">if</span> <span class="n">new</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">plot_net</span><span class="p">(</span><span class="n">fignum</span><span class="p">)</span>
<span class="c1">#</span>
<span class="c1">#   plot the data</span>
<span class="c1">#</span>
    <span class="n">DIblock</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">plotrec</span> <span class="ow">in</span> <span class="n">datablock</span><span class="p">:</span>
        <span class="n">DIblock</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="nb">float</span><span class="p">(</span><span class="n">plotrec</span><span class="p">[</span><span class="s2">&quot;dec&quot;</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">plotrec</span><span class="p">[</span><span class="s2">&quot;inc&quot;</span><span class="p">])))</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">DIblock</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">plot_di</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span> <span class="n">DIblock</span><span class="p">)</span>  <span class="c1"># plot directed lines</span>
<span class="c1">#</span>
<span class="c1"># put on the mean direction</span>
<span class="c1">#</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">XY</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">dimap</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XY</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XY</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">fignum</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">new</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="c1">#</span>
<span class="c1"># plot the ellipse</span>
<span class="c1">#</span>
    <span class="n">plot_ell</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span> <span class="n">pars</span><span class="p">,</span> <span class="s1">&#39;r-,&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span></div>


<span class="n">EI_plot_num</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">maxE</span><span class="p">,</span> <span class="n">minE</span><span class="p">,</span> <span class="n">maxI</span><span class="p">,</span> <span class="n">minI</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">90</span>


<span class="k">def</span> <span class="nf">plot_ei</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">f</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">EI_plot_num</span><span class="p">,</span> <span class="n">maxE</span><span class="p">,</span> <span class="n">minE</span><span class="p">,</span> <span class="n">minI</span><span class="p">,</span> <span class="n">maxI</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">fignum</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">EI_plot_num</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Inclination&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Elongation&quot;</span><span class="p">)</span>
        <span class="n">EI_plot_num</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">I</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">E</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39; </span><span class="si">%4.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">f</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">I</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="n">E</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39; </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;f=1&#39;</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">f</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="s1">&#39;g-&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">plot_v2s</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span> <span class="n">V2s</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">f</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">fignum</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="n">V2s</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Inclination&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Elongation direction&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">plot_com</span><span class="p">(</span><span class="n">CDF</span><span class="p">,</span> <span class="n">BDI1</span><span class="p">,</span> <span class="n">BDI2</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
    <span class="c1">#</span>
    <span class="c1">#   convert to cartesian coordinates X1,X2, Y1,Y2 and Z1, Z2</span>
    <span class="c1">#</span>
    <span class="n">cart</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">dir2cart</span><span class="p">(</span><span class="n">BDI1</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
    <span class="n">X1</span><span class="p">,</span> <span class="n">Y1</span><span class="p">,</span> <span class="n">Z1</span> <span class="o">=</span> <span class="n">cart</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cart</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">cart</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="nb">min</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">0.025</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">X1</span><span class="p">))</span>
    <span class="nb">max</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">0.975</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">X1</span><span class="p">))</span>
    <span class="n">X1</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">plot_cdf</span><span class="p">(</span><span class="n">CDF</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">],</span> <span class="n">X1</span><span class="p">,</span> <span class="s2">&quot;X component&quot;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">bounds1</span> <span class="o">=</span> <span class="p">[</span><span class="n">X1</span><span class="p">[</span><span class="nb">min</span><span class="p">],</span> <span class="n">X1</span><span class="p">[</span><span class="nb">max</span><span class="p">]]</span>
    <span class="n">plot_vs</span><span class="p">(</span><span class="n">CDF</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">],</span> <span class="n">bounds1</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>
    <span class="n">Y1</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">plot_cdf</span><span class="p">(</span><span class="n">CDF</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">],</span> <span class="n">Y1</span><span class="p">,</span> <span class="s2">&quot;Y component&quot;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">bounds1</span> <span class="o">=</span> <span class="p">[</span><span class="n">Y1</span><span class="p">[</span><span class="nb">min</span><span class="p">],</span> <span class="n">Y1</span><span class="p">[</span><span class="nb">max</span><span class="p">]]</span>
    <span class="n">plot_vs</span><span class="p">(</span><span class="n">CDF</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">],</span> <span class="n">bounds1</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>
    <span class="n">Z1</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">plot_cdf</span><span class="p">(</span><span class="n">CDF</span><span class="p">[</span><span class="s1">&#39;Z&#39;</span><span class="p">],</span> <span class="n">Z1</span><span class="p">,</span> <span class="s2">&quot;Z component&quot;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">bounds1</span> <span class="o">=</span> <span class="p">[</span><span class="n">Z1</span><span class="p">[</span><span class="nb">min</span><span class="p">],</span> <span class="n">Z1</span><span class="p">[</span><span class="nb">max</span><span class="p">]]</span>
    <span class="n">plot_vs</span><span class="p">(</span><span class="n">CDF</span><span class="p">[</span><span class="s1">&#39;Z&#39;</span><span class="p">],</span> <span class="n">bounds1</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>
    <span class="c1"># draw_figs(CDF)</span>
    <span class="k">if</span> <span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>  <span class="c1"># repeat for second data set</span>
        <span class="n">bounds2</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">cart</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">dir2cart</span><span class="p">(</span><span class="n">BDI2</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
        <span class="n">X2</span><span class="p">,</span> <span class="n">Y2</span><span class="p">,</span> <span class="n">Z2</span> <span class="o">=</span> <span class="n">cart</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cart</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">cart</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">X2</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">plot_cdf</span><span class="p">(</span><span class="n">CDF</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">],</span> <span class="n">X2</span><span class="p">,</span> <span class="s2">&quot;X component&quot;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">bounds2</span> <span class="o">=</span> <span class="p">[</span><span class="n">X2</span><span class="p">[</span><span class="nb">min</span><span class="p">],</span> <span class="n">X2</span><span class="p">[</span><span class="nb">max</span><span class="p">]]</span>
        <span class="n">plot_vs</span><span class="p">(</span><span class="n">CDF</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">],</span> <span class="n">bounds2</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">)</span>
        <span class="n">Y2</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">plot_cdf</span><span class="p">(</span><span class="n">CDF</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">],</span> <span class="n">Y2</span><span class="p">,</span> <span class="s2">&quot;Y component&quot;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">bounds2</span> <span class="o">=</span> <span class="p">[</span><span class="n">Y2</span><span class="p">[</span><span class="nb">min</span><span class="p">],</span> <span class="n">Y2</span><span class="p">[</span><span class="nb">max</span><span class="p">]]</span>
        <span class="n">plot_vs</span><span class="p">(</span><span class="n">CDF</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">],</span> <span class="n">bounds2</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">)</span>
        <span class="n">Z2</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">plot_cdf</span><span class="p">(</span><span class="n">CDF</span><span class="p">[</span><span class="s1">&#39;Z&#39;</span><span class="p">],</span> <span class="n">Z2</span><span class="p">,</span> <span class="s2">&quot;Z component&quot;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">bounds2</span> <span class="o">=</span> <span class="p">[</span><span class="n">Z2</span><span class="p">[</span><span class="nb">min</span><span class="p">],</span> <span class="n">Z2</span><span class="p">[</span><span class="nb">max</span><span class="p">]]</span>
        <span class="n">plot_vs</span><span class="p">(</span><span class="n">CDF</span><span class="p">[</span><span class="s1">&#39;Z&#39;</span><span class="p">],</span> <span class="n">bounds2</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cart</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">dir2cart</span><span class="p">([</span><span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mf">1.0</span><span class="p">])</span>
        <span class="n">plot_vs</span><span class="p">(</span><span class="n">CDF</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">],</span> <span class="p">[</span><span class="n">cart</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">)</span>
        <span class="n">plot_vs</span><span class="p">(</span><span class="n">CDF</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">],</span> <span class="p">[</span><span class="n">cart</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">)</span>
        <span class="n">plot_vs</span><span class="p">(</span><span class="n">CDF</span><span class="p">[</span><span class="s1">&#39;Z&#39;</span><span class="p">],</span> <span class="p">[</span><span class="n">cart</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">)</span>
    <span class="k">return</span>

<span class="c1"># functions for images - requires additional modules</span>
<span class="c1">#</span>
<span class="c1">#import Image,os</span>
<span class="c1"># def combineFigs(Name,filenames,Ncols):</span>
<span class="c1">#    Nfigs=len(filenames.keys())</span>
<span class="c1">#    Nrows=Nfigs/Ncols+Nfigs%Ncols</span>
<span class="c1">#    print Nrows,Ncols</span>
<span class="c1">#    S=500 # fig size</span>
<span class="c1">#    size=(S,S)</span>
<span class="c1">#    image=Image.new(&#39;RGBA&#39;,(Ncols*S,Nrows*S))</span>
<span class="c1">#    Nrow,row,col,pic=1,1,1,0</span>
<span class="c1">#    for key in filenames.keys():</span>
<span class="c1">#        pic+=1</span>
<span class="c1">#        print  filenames[key]</span>
<span class="c1">#        im=Image.open(filenames[key])</span>
<span class="c1">#        im.thumbnail(size)</span>
<span class="c1">#        image.paste(im,(col,row))</span>
<span class="c1">#        print col,row</span>
<span class="c1">#        col+=S</span>
<span class="c1">#        if pic ==Ncols:</span>
<span class="c1">#            col=1</span>
<span class="c1">#            Nrow+=1</span>
<span class="c1">#            row=Nrow*size</span>
<span class="c1">#    image.save(Name+&#39;.png&#39;)</span>
<span class="c1">#    for key in filenames.keys():</span>
<span class="c1">#        os.remove(filenames[key])</span>


<div class="viewcode-block" id="add_borders"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmagplotlib.add_borders">[docs]</a><span class="k">def</span> <span class="nf">add_borders</span><span class="p">(</span><span class="n">Figs</span><span class="p">,</span> <span class="n">titles</span><span class="p">,</span> <span class="n">border_color</span><span class="o">=</span><span class="s1">&#39;#000000&#39;</span><span class="p">,</span> <span class="n">text_color</span><span class="o">=</span><span class="s1">&#39;#800080&#39;</span><span class="p">,</span> <span class="n">con_id</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Formatting for generating plots on the server</span>
<span class="sd">    Default border color: black</span>
<span class="sd">    Default text color: purple</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">split_title</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add &#39;\n&#39;s to split of overly long titles</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">s_list</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">tot</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">line</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">s_list</span><span class="p">:</span>
            <span class="n">tot</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">tot</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">:</span>
                <span class="n">line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">line</span><span class="p">))</span>
                <span class="n">line</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">tot</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">line</span><span class="p">))</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>

    <span class="c1"># format contribution id if available</span>
    <span class="k">if</span> <span class="n">con_id</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">str</span><span class="p">(</span><span class="n">con_id</span><span class="p">)</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">):</span>
            <span class="n">con_id</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">con_id</span><span class="p">)</span>

    <span class="kn">import</span> <span class="nn">datetime</span>
    <span class="n">now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Figs</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>

        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">Figs</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
        <span class="n">plot_title</span> <span class="o">=</span> <span class="n">split_title</span><span class="p">(</span><span class="n">titles</span><span class="p">[</span><span class="n">key</span><span class="p">])</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">set_figheight</span><span class="p">(</span><span class="mf">5.5</span><span class="p">)</span>
        <span class="c1">#get returns Bbox with x0, y0, x1, y1</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
        <span class="c1"># tweak some of the default values</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">pos</span><span class="o">.</span><span class="n">x1</span> <span class="o">-</span> <span class="n">pos</span><span class="o">.</span><span class="n">x0</span>
        <span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">pos</span><span class="o">.</span><span class="n">y1</span> <span class="o">-</span> <span class="n">pos</span><span class="o">.</span><span class="n">y0</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1.1</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">pos</span><span class="o">.</span><span class="n">x0</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">pos</span><span class="o">.</span><span class="n">y0</span> <span class="o">*</span> <span class="mf">1.3</span>
        <span class="c1"># set takes: left, bottom, width, height</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_position</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">])</span>

        <span class="c1"># add an axis covering the entire figure</span>
        <span class="n">border_ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="n">border_ax</span><span class="o">.</span><span class="n">set_frame_on</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">border_ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
        <span class="n">border_ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
        <span class="c1"># add a border</span>
        <span class="k">if</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="ow">in</span> <span class="n">plot_title</span><span class="p">:</span>
            <span class="n">y_val</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># lower border</span>
            <span class="c1">#fig.set_figheight(6.25)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">y_val</span> <span class="o">=</span> <span class="mf">1.04</span>  <span class="c1"># higher border</span>
        <span class="c1">#border_ax.text(-0.02, y_val, &quot;                                                                                                   #                                                                                      |&quot;,</span>
        <span class="c1">#               horizontalalignment=&#39;left&#39;,</span>
        <span class="c1">#               verticalalignment=&#39;top&#39;,</span>
        <span class="c1">#               color=text_color,</span>
        <span class="c1">#               bbox=dict(edgecolor=border_color,</span>
        <span class="c1">#                         facecolor=&#39;#FFFFFF&#39;, linewidth=0.25),</span>
        <span class="c1">#               size=50)</span>
        <span class="c1">#border_ax.text(-0.02, 0, &quot;|                                                                                                      #                                                                                   |&quot;,</span>
        <span class="c1">#               horizontalalignment=&#39;left&#39;,</span>
        <span class="c1">#               verticalalignment=&#39;bottom&#39;,</span>
        <span class="c1">#               color=text_color,</span>
        <span class="c1">#               bbox=dict(edgecolor=border_color,</span>
        <span class="c1">#                         facecolor=&#39;#FFFFFF&#39;, linewidth=0.25),</span>
        <span class="c1">#               size=20)#18)</span>

        <span class="c1"># add text</span>

        <span class="n">border_ax</span><span class="o">.</span><span class="n">text</span><span class="p">((</span><span class="mf">4.</span> <span class="o">/</span> <span class="n">fig</span><span class="o">.</span><span class="n">get_figwidth</span><span class="p">())</span> <span class="o">*</span> <span class="mf">0.015</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="n">now</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">, %I:%M:%S </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;UT&#39;</span><span class="p">)),</span>
                       <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
                       <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span>
                       <span class="n">color</span><span class="o">=</span><span class="n">text_color</span><span class="p">,</span>
                       <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">border_ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.98</span><span class="p">,</span> <span class="n">plot_title</span><span class="p">,</span>
                       <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                       <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span>
                       <span class="n">color</span><span class="o">=</span><span class="n">text_color</span><span class="p">,</span>
                       <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
        <span class="n">border_ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="mf">4.</span> <span class="o">/</span> <span class="n">fig</span><span class="o">.</span><span class="n">get_figwidth</span><span class="p">())</span> <span class="o">*</span> <span class="mf">0.015</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="s1">&#39;earthref.org/MagIC</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">con_id</span><span class="p">),</span>
                       <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span>
                       <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span>
                       <span class="n">color</span><span class="o">=</span><span class="n">text_color</span><span class="p">,</span>
                       <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Figs</span></div>


<div class="viewcode-block" id="plot_map_basemap"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmagplotlib.plot_map_basemap">[docs]</a><span class="k">def</span> <span class="nf">plot_map_basemap</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span> <span class="n">lats</span><span class="p">,</span> <span class="n">lons</span><span class="p">,</span> <span class="n">Opts</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    plot_map_basemap(fignum, lats,lons,Opts)</span>
<span class="sd">    makes a basemap with lats/lons</span>
<span class="sd">        requires working installation of Basemap</span>
<span class="sd">    Parameters:</span>
<span class="sd">    _______________</span>
<span class="sd">    fignum : matplotlib figure number</span>
<span class="sd">    lats : array or list of latitudes</span>
<span class="sd">    lons : array or list of longitudes</span>
<span class="sd">    Opts : dictionary of plotting options:</span>
<span class="sd">        Opts.keys=</span>
<span class="sd">            latmin : minimum latitude for plot</span>
<span class="sd">            latmax : maximum latitude for plot</span>
<span class="sd">            lonmin : minimum longitude for plot</span>
<span class="sd">            lonmax : maximum longitude</span>
<span class="sd">            lat_0 : central latitude</span>
<span class="sd">            lon_0 : central longitude</span>
<span class="sd">            proj : projection [basemap projections, e.g., moll=Mollweide, merc=Mercator, ortho=orthorhombic,</span>
<span class="sd">                lcc=Lambert Conformal]</span>
<span class="sd">            sym : matplotlib symbol</span>
<span class="sd">            symsize : symbol size in pts</span>
<span class="sd">            edge : markeredgecolor</span>
<span class="sd">            pltgrid : plot the grid [1,0]</span>
<span class="sd">            res :  resolution [c,l,i,h] for crude, low, intermediate, high</span>
<span class="sd">            boundinglat : bounding latitude</span>
<span class="sd">            sym : matplotlib symbol for plotting</span>
<span class="sd">            symsize : matplotlib symbol size for plotting</span>
<span class="sd">            names : list of names for lats/lons (if empty, none will be plotted)</span>
<span class="sd">            pltgrd : if True, put on grid lines</span>
<span class="sd">            padlat : padding of latitudes</span>
<span class="sd">            padlon : padding of longitudes</span>
<span class="sd">            gridspace : grid line spacing</span>
<span class="sd">            details : dictionary with keys:</span>
<span class="sd">                coasts : if True, plot coastlines</span>
<span class="sd">                rivers : if True, plot rivers</span>
<span class="sd">                states : if True, plot states</span>
<span class="sd">                countries : if True, plot countries</span>
<span class="sd">                ocean : if True, plot ocean</span>
<span class="sd">                fancy : if True, plot etopo 20 grid</span>
<span class="sd">                    NB:  etopo must be installed</span>
<span class="sd">        if Opts keys not set :these are the defaults:</span>
<span class="sd">           Opts={&#39;latmin&#39;:-90,&#39;latmax&#39;:90,&#39;lonmin&#39;:0,&#39;lonmax&#39;:360,&#39;lat_0&#39;:0,&#39;lon_0&#39;:0,&#39;proj&#39;:&#39;moll&#39;,&#39;sym&#39;:&#39;ro,&#39;symsize&#39;:5,&#39;pltgrid&#39;:1,&#39;res&#39;:&#39;c&#39;,&#39;boundinglat&#39;:0.,&#39;padlon&#39;:0,&#39;padlat&#39;:0,&#39;gridspace&#39;:30,&#39;details&#39;:all False,&#39;edge&#39;:None}</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">has_basemap</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-W- Basemap must be installed to run plot_map_basemap&#39;</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">fignum</span><span class="p">)</span>
    <span class="n">rgba_land</span> <span class="o">=</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>
    <span class="n">rgba_ocean</span> <span class="o">=</span> <span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>
    <span class="n">ExMer</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;sinus&#39;</span><span class="p">,</span> <span class="s1">&#39;moll&#39;</span><span class="p">,</span> <span class="s1">&#39;lcc&#39;</span><span class="p">]</span>
    <span class="c1"># draw meridian labels on the bottom [left,right,top,bottom]</span>
    <span class="n">mlabels</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">plabels</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>  <span class="c1"># draw parallel labels on the left</span>
    <span class="c1"># set default Options</span>
    <span class="n">Opts_defaults</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;latmin&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="s1">&#39;latmax&#39;</span><span class="p">:</span> <span class="mi">90</span><span class="p">,</span> <span class="s1">&#39;lonmin&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;lonmax&#39;</span><span class="p">:</span> <span class="mi">360</span><span class="p">,</span>
                     <span class="s1">&#39;lat_0&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;lon_0&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;proj&#39;</span><span class="p">:</span> <span class="s1">&#39;moll&#39;</span><span class="p">,</span> <span class="s1">&#39;sym&#39;</span><span class="p">:</span> <span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="s1">&#39;symsize&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
                     <span class="s1">&#39;edge&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;pltgrid&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;res&#39;</span><span class="p">:</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;boundinglat&#39;</span><span class="p">:</span> <span class="mf">0.</span><span class="p">,</span>
                     <span class="s1">&#39;padlon&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;padlat&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;gridspace&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span>
                     <span class="s1">&#39;details&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;fancy&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;coasts&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;rivers&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;states&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;countries&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;ocean&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}}</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">Opts_defaults</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">Opts</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="n">key</span> <span class="o">!=</span> <span class="s1">&#39;details&#39;</span><span class="p">:</span>
            <span class="n">Opts</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">Opts_defaults</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;details&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">Opts</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">Opts</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">Opts_defaults</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">detail_key</span> <span class="ow">in</span> <span class="n">Opts_defaults</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">detail_key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">Opts</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">Opts</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="n">detail_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">Opts_defaults</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="n">detail_key</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;proj&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">ExMer</span><span class="p">:</span>
        <span class="n">mlabels</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;proj&#39;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ExMer</span><span class="p">:</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">Basemap</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;proj&#39;</span><span class="p">],</span> <span class="n">lat_0</span><span class="o">=</span><span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;lat_0&#39;</span><span class="p">],</span>
                    <span class="n">lon_0</span><span class="o">=</span><span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;lon_0&#39;</span><span class="p">],</span> <span class="n">resolution</span><span class="o">=</span><span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;res&#39;</span><span class="p">])</span>
        <span class="n">plabels</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">Basemap</span><span class="p">(</span><span class="n">llcrnrlon</span><span class="o">=</span><span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;lonmin&#39;</span><span class="p">],</span> <span class="n">llcrnrlat</span><span class="o">=</span><span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;latmin&#39;</span><span class="p">],</span> <span class="n">urcrnrlat</span><span class="o">=</span><span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;latmax&#39;</span><span class="p">],</span> <span class="n">urcrnrlon</span><span class="o">=</span><span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;lonmax&#39;</span><span class="p">],</span>
                    <span class="n">projection</span><span class="o">=</span><span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;proj&#39;</span><span class="p">],</span> <span class="n">lat_0</span><span class="o">=</span><span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;lat_0&#39;</span><span class="p">],</span> <span class="n">lon_0</span><span class="o">=</span><span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;lon_0&#39;</span><span class="p">],</span> <span class="n">lat_ts</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;res&#39;</span><span class="p">],</span> <span class="n">boundinglat</span><span class="o">=</span><span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;boundinglat&#39;</span><span class="p">])</span>
    <span class="k">if</span> <span class="s1">&#39;details&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Opts</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="k">if</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;details&#39;</span><span class="p">][</span><span class="s1">&#39;fancy&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">mpl_toolkits.basemap</span> <span class="kn">import</span> <span class="n">basemap_datadir</span>
            <span class="n">EDIR</span> <span class="o">=</span> <span class="n">basemap_datadir</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span>
            <span class="n">etopo</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">EDIR</span> <span class="o">+</span> <span class="s1">&#39;etopo20data.gz&#39;</span><span class="p">)</span>
            <span class="n">elons</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">EDIR</span> <span class="o">+</span> <span class="s1">&#39;etopo20lons.gz&#39;</span><span class="p">)</span>
            <span class="n">elats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">EDIR</span> <span class="o">+</span> <span class="s1">&#39;etopo20lats.gz&#39;</span><span class="p">)</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">m</span><span class="p">(</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">elons</span><span class="p">,</span> <span class="n">elats</span><span class="p">))</span>
            <span class="n">cs</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">etopo</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">color_map</span><span class="o">.</span><span class="n">jet</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;details&#39;</span><span class="p">][</span><span class="s1">&#39;coasts&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">m</span><span class="o">.</span><span class="n">drawcoastlines</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;details&#39;</span><span class="p">][</span><span class="s1">&#39;rivers&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">m</span><span class="o">.</span><span class="n">drawrivers</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;details&#39;</span><span class="p">][</span><span class="s1">&#39;states&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">m</span><span class="o">.</span><span class="n">drawstates</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;details&#39;</span><span class="p">][</span><span class="s1">&#39;countries&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">m</span><span class="o">.</span><span class="n">drawcountries</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;details&#39;</span><span class="p">][</span><span class="s1">&#39;ocean&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">m</span><span class="o">.</span><span class="n">drawlsmask</span><span class="p">(</span><span class="n">land_color</span><span class="o">=</span><span class="n">rgba_land</span><span class="p">,</span>
                             <span class="n">ocean_color</span><span class="o">=</span><span class="n">rgba_ocean</span><span class="p">,</span> <span class="n">lsmask_lats</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                <span class="c1"># this is caused by basemap function: _readlsmask</span>
                <span class="c1"># interacting with numpy</span>
                <span class="c1"># (a float is provided, numpy wants an int).</span>
                <span class="c1"># hopefully will be fixed eventually.</span>
                <span class="k">pass</span>
    <span class="k">if</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;pltgrid&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0.</span><span class="p">:</span>
        <span class="n">circles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;latmin&#39;</span><span class="p">],</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;latmax&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mf">15.</span><span class="p">,</span> <span class="mf">15.</span><span class="p">)</span>
        <span class="n">meridians</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;lonmin&#39;</span><span class="p">],</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;lonmax&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mf">30.</span><span class="p">,</span> <span class="mf">30.</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;pltgrid&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;proj&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">ExMer</span> <span class="ow">or</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;proj&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;lcc&#39;</span><span class="p">:</span>
            <span class="n">circles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mf">180.</span> <span class="o">+</span>
                                <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;gridspace&#39;</span><span class="p">],</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;gridspace&#39;</span><span class="p">])</span>
            <span class="n">meridians</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">360.</span><span class="p">,</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;gridspace&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">g</span> <span class="o">=</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;gridspace&#39;</span><span class="p">]</span>
            <span class="n">latmin</span><span class="p">,</span> <span class="n">lonmin</span> <span class="o">=</span> <span class="n">g</span> <span class="o">*</span> \
                <span class="nb">int</span><span class="p">(</span><span class="n">old_div</span><span class="p">(</span><span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;latmin&#39;</span><span class="p">],</span> <span class="n">g</span><span class="p">)),</span> <span class="n">g</span> <span class="o">*</span> \
                <span class="nb">int</span><span class="p">(</span><span class="n">old_div</span><span class="p">(</span><span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;lonmin&#39;</span><span class="p">],</span> <span class="n">g</span><span class="p">))</span>
            <span class="n">latmax</span><span class="p">,</span> <span class="n">lonmax</span> <span class="o">=</span> <span class="n">g</span> <span class="o">*</span> \
                <span class="nb">int</span><span class="p">(</span><span class="n">old_div</span><span class="p">(</span><span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;latmax&#39;</span><span class="p">],</span> <span class="n">g</span><span class="p">)),</span> <span class="n">g</span> <span class="o">*</span> \
                <span class="nb">int</span><span class="p">(</span><span class="n">old_div</span><span class="p">(</span><span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;lonmax&#39;</span><span class="p">],</span> <span class="n">g</span><span class="p">))</span>
            <span class="c1"># circles=np.arange(latmin-2.*Opts[&#39;padlat&#39;],latmax+2.*Opts[&#39;padlat&#39;],Opts[&#39;gridspace&#39;])</span>
            <span class="c1"># meridians=np.arange(lonmin-2.*Opts[&#39;padlon&#39;],lonmax+2.*Opts[&#39;padlon&#39;],Opts[&#39;gridspace&#39;])</span>
            <span class="n">meridians</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
            <span class="n">circles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;pltgrid&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># m.drawparallels(circles,color=&#39;black&#39;,labels=plabels)</span>
        <span class="c1"># m.drawmeridians(meridians,color=&#39;black&#39;,labels=mlabels)</span>
        <span class="c1"># skip the labels - they are ugly</span>
        <span class="n">m</span><span class="o">.</span><span class="n">drawparallels</span><span class="p">(</span><span class="n">circles</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
        <span class="c1"># skip the labels - they are ugly</span>
        <span class="n">m</span><span class="o">.</span><span class="n">drawmeridians</span><span class="p">(</span><span class="n">meridians</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
        <span class="n">m</span><span class="o">.</span><span class="n">drawmapboundary</span><span class="p">()</span>
    <span class="n">prn_name</span><span class="p">,</span> <span class="n">symsize</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span>
    <span class="k">if</span> <span class="s1">&#39;names&#39;</span> <span class="ow">in</span> <span class="n">Opts</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;names&#39;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">names</span> <span class="o">=</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;names&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">prn_name</span> <span class="o">=</span> <span class="mi">1</span>
<span class="c1">#</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="s1">&#39;symsize&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Opts</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="n">symsize</span> <span class="o">=</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;symsize&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;sym&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>  <span class="c1"># just plot points</span>
        <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">m</span><span class="p">(</span><span class="n">lons</span><span class="p">,</span> <span class="n">lats</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">prn_name</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">pt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lats</span><span class="p">)):</span>
                <span class="n">T</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">pt</span><span class="p">]</span> <span class="o">+</span> <span class="mi">5000</span><span class="p">,</span> <span class="n">Y</span><span class="p">[</span><span class="n">pt</span><span class="p">]</span> <span class="o">-</span> <span class="mi">5000</span><span class="p">,</span> <span class="n">names</span><span class="p">[</span><span class="n">pt</span><span class="p">]))</span>
        <span class="n">m</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;sym&#39;</span><span class="p">],</span> <span class="n">markersize</span><span class="o">=</span><span class="n">symsize</span><span class="p">,</span>
               <span class="n">markeredgecolor</span><span class="o">=</span><span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;edge&#39;</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># for lines,  need to separate chunks using lat==100.</span>
        <span class="n">chunk</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">while</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">lats</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">lats</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">90</span><span class="p">:</span>  <span class="c1"># part of string</span>
                <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">m</span><span class="p">(</span><span class="n">lons</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">lats</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mf">1e20</span><span class="p">:</span>
                    <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="mf">1e20</span><span class="p">:</span>
                    <span class="n">Y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>  <span class="c1"># exclude off the map points</span>
                <span class="k">if</span> <span class="n">prn_name</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">T</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">5000</span><span class="p">,</span> <span class="n">y</span> <span class="o">-</span> <span class="mi">5000</span><span class="p">,</span> <span class="n">names</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span>
                <span class="n">k</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1"># need to skip 100.0s and move to next chunk</span>
                <span class="c1"># plot previous chunk</span>
                <span class="n">m</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;sym&#39;</span><span class="p">],</span> <span class="n">markersize</span><span class="o">=</span><span class="n">symsize</span><span class="p">,</span>
                       <span class="n">markeredgecolor</span><span class="o">=</span><span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;edge&#39;</span><span class="p">])</span>
                <span class="n">chunk</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">while</span> <span class="n">lats</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">90.</span> <span class="ow">and</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">lats</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">k</span> <span class="o">+=</span> <span class="mi">1</span>  <span class="c1"># skip bad points</span>
                <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">T</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">m</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;sym&#39;</span><span class="p">],</span> <span class="n">markersize</span><span class="o">=</span><span class="n">symsize</span><span class="p">,</span>
                   <span class="n">markeredgecolor</span><span class="o">=</span><span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;edge&#39;</span><span class="p">])</span>  <span class="c1"># plot last chunk</span></div>


<div class="viewcode-block" id="plot_map"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmagplotlib.plot_map">[docs]</a><span class="k">def</span> <span class="nf">plot_map</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span> <span class="n">lats</span><span class="p">,</span> <span class="n">lons</span><span class="p">,</span> <span class="n">Opts</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    makes a cartopy map  with lats/lons</span>
<span class="sd">    Requires installation of cartopy</span>

<span class="sd">    Parameters:</span>
<span class="sd">    _______________</span>
<span class="sd">    fignum : matplotlib figure number</span>
<span class="sd">    lats : array or list of latitudes</span>
<span class="sd">    lons : array or list of longitudes</span>
<span class="sd">    Opts : dictionary of plotting options:</span>
<span class="sd">        Opts.keys=</span>
<span class="sd">            proj : projection [supported cartopy projections:</span>
<span class="sd">                pc = Plate Carree</span>
<span class="sd">                aea = Albers Equal Area</span>
<span class="sd">                aeqd = Azimuthal Equidistant</span>
<span class="sd">                lcc = Lambert Conformal</span>
<span class="sd">                lcyl = Lambert Cylindrical</span>
<span class="sd">                merc = Mercator</span>
<span class="sd">                mill = Miller Cylindrical</span>
<span class="sd">                moll = Mollweide [default]</span>
<span class="sd">                ortho = Orthographic</span>
<span class="sd">                robin = Robinson</span>
<span class="sd">                sinu = Sinusoidal</span>
<span class="sd">                stere = Stereographic</span>
<span class="sd">                tmerc = Transverse Mercator</span>
<span class="sd">                utm = UTM [set zone and south keys in Opts]</span>
<span class="sd">                laea = Lambert Azimuthal Equal Area</span>
<span class="sd">                geos = Geostationary</span>
<span class="sd">                npstere = North-Polar Stereographic</span>
<span class="sd">                spstere = South-Polar Stereographic</span>
<span class="sd">            latmin : minimum latitude for plot</span>
<span class="sd">            latmax : maximum latitude for plot</span>
<span class="sd">            lonmin : minimum longitude for plot</span>
<span class="sd">            lonmax : maximum longitude</span>
<span class="sd">            lat_0 : central latitude</span>
<span class="sd">            lon_0 : central longitude</span>
<span class="sd">            sym : matplotlib symbol</span>
<span class="sd">            symsize : symbol size in pts</span>
<span class="sd">            edge : markeredgecolor</span>
<span class="sd">            cmap : matplotlib color map</span>
<span class="sd">            res :  resolution [c,l,i,h] for low/crude, intermediate, high</span>
<span class="sd">            boundinglat : bounding latitude</span>
<span class="sd">            sym : matplotlib symbol for plotting</span>
<span class="sd">            symsize : matplotlib symbol size for plotting</span>
<span class="sd">            names : list of names for lats/lons (if empty, none will be plotted)</span>
<span class="sd">            pltgrd : if True, put on grid lines</span>
<span class="sd">            padlat : padding of latitudes</span>
<span class="sd">            padlon : padding of longitudes</span>
<span class="sd">            gridspace : grid line spacing</span>
<span class="sd">            global : global projection [default is True]</span>
<span class="sd">            oceancolor : &#39;azure&#39;</span>
<span class="sd">            landcolor : &#39;bisque&#39; [choose any of the valid color names for matplotlib</span>
<span class="sd">              see https://matplotlib.org/examples/color/named_colors.html</span>
<span class="sd">            details : dictionary with keys:</span>
<span class="sd">                coasts : if True, plot coastlines</span>
<span class="sd">                rivers : if True, plot rivers</span>
<span class="sd">                states : if True, plot states</span>
<span class="sd">                countries : if True, plot countries</span>
<span class="sd">                ocean : if True, plot ocean</span>
<span class="sd">                lakes : if True, plot lakes</span>
<span class="sd">                fancy : if True, plot etopo 20 grid</span>
<span class="sd">                    NB:  etopo must be installed</span>
<span class="sd">        if Opts keys not set :these are the defaults:</span>
<span class="sd">           Opts={&#39;latmin&#39;:-90,&#39;latmax&#39;:90,&#39;lonmin&#39;:0,&#39;lonmax&#39;:360,&#39;lat_0&#39;:0,&#39;lon_0&#39;:0,&#39;proj&#39;:&#39;moll&#39;,&#39;sym&#39;:&#39;ro,&#39;symsize&#39;:5,&#39;edge&#39;:&#39;black&#39;,&#39;pltgrid&#39;:1,&#39;res&#39;:&#39;c&#39;,&#39;boundinglat&#39;:0.,&#39;padlon&#39;:0,&#39;padlat&#39;:0,&#39;gridspace&#39;:30,&#39;details&#39;:all False,&#39;edge&#39;:None,&#39;cmap&#39;:&#39;jet&#39;,&#39;fancy&#39;:0,&#39;zone&#39;:&#39;&#39;,&#39;south&#39;:False,&#39;oceancolor&#39;:&#39;azure&#39;,&#39;landcolor&#39;:&#39;bisque&#39;}</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">has_cartopy</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;This function requires installation of cartopy&#39;</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">cm</span>
    <span class="c1"># draw meridian labels on the bottom [left,right,top,bottom]</span>
    <span class="n">mlabels</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">plabels</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>  <span class="c1"># draw parallel labels on the left</span>
    <span class="n">Opts_defaults</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;latmin&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="s1">&#39;latmax&#39;</span><span class="p">:</span> <span class="mi">90</span><span class="p">,</span> <span class="s1">&#39;lonmin&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;lonmax&#39;</span><span class="p">:</span> <span class="mi">360</span><span class="p">,</span>
                     <span class="s1">&#39;lat_0&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;lon_0&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;proj&#39;</span><span class="p">:</span> <span class="s1">&#39;moll&#39;</span><span class="p">,</span> <span class="s1">&#39;sym&#39;</span><span class="p">:</span> <span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="s1">&#39;symsize&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
                     <span class="s1">&#39;edge&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;pltgrid&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;res&#39;</span><span class="p">:</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;boundinglat&#39;</span><span class="p">:</span> <span class="mf">0.</span><span class="p">,</span>
                     <span class="s1">&#39;padlon&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;padlat&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;gridspace&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s1">&#39;global&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;cmap&#39;</span><span class="p">:</span> <span class="s1">&#39;jet&#39;</span><span class="p">,</span><span class="s1">&#39;oceancolor&#39;</span><span class="p">:</span><span class="s1">&#39;azure&#39;</span><span class="p">,</span><span class="s1">&#39;landcolor&#39;</span><span class="p">:</span><span class="s1">&#39;bisque&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;details&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;fancy&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;coasts&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;rivers&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;states&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;countries&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;ocean&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;lakes&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>
                     <span class="s1">&#39;edgecolor&#39;</span><span class="p">:</span> <span class="s1">&#39;face&#39;</span><span class="p">}</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">Opts_defaults</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">Opts</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="n">key</span> <span class="o">!=</span> <span class="s1">&#39;details&#39;</span><span class="p">:</span>
            <span class="n">Opts</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">Opts_defaults</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;details&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">Opts</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">Opts</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">Opts_defaults</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">detail_key</span> <span class="ow">in</span> <span class="n">Opts_defaults</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">detail_key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">Opts</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">Opts</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="n">detail_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">Opts_defaults</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="n">detail_key</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;proj&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;pc&#39;</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;lonmin&#39;</span><span class="p">],</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;lonmax&#39;</span><span class="p">],</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;latmin&#39;</span><span class="p">],</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;latmax&#39;</span><span class="p">]],</span>
                      <span class="n">crs</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
    <span class="k">if</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;proj&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;aea&#39;</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">AlbersEqualArea</span><span class="p">(</span>
            <span class="n">central_longitude</span><span class="o">=</span><span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;lon_0&#39;</span><span class="p">],</span>
            <span class="n">central_latitude</span><span class="o">=</span><span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;lat_0&#39;</span><span class="p">],</span>
            <span class="n">false_easting</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">false_northing</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">standard_parallels</span><span class="o">=</span><span class="p">(</span><span class="mf">20.0</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">),</span>
            <span class="n">globe</span><span class="o">=</span><span class="kc">None</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;proj&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;lcc&#39;</span><span class="p">:</span>
        <span class="n">proj</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">LambertConformal</span><span class="p">(</span><span class="n">central_longitude</span><span class="o">=</span><span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;lon_0&#39;</span><span class="p">],</span>  <span class="n">central_latitude</span><span class="o">=</span><span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;lat_0&#39;</span><span class="p">],</span>\
               <span class="n">false_easting</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">false_northing</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">standard_parallels</span><span class="o">=</span><span class="p">(</span><span class="mf">20.0</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">),</span>
               <span class="n">globe</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span><span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">proj</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;lonmin&#39;</span><span class="p">],</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;lonmax&#39;</span><span class="p">],</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;latmin&#39;</span><span class="p">],</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;latmax&#39;</span><span class="p">]],</span>
                      <span class="n">crs</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
    <span class="k">if</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;proj&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;lcyl&#39;</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">LambertCylindrical</span><span class="p">(</span>
            <span class="n">central_longitude</span><span class="o">=</span><span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;lon_0&#39;</span><span class="p">]))</span>

    <span class="k">if</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;proj&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;merc&#39;</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">Mercator</span><span class="p">(</span>
            <span class="n">central_longitude</span><span class="o">=</span><span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;lon_0&#39;</span><span class="p">],</span> <span class="n">min_latitude</span><span class="o">=</span><span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;latmin&#39;</span><span class="p">],</span>
            <span class="n">max_latitude</span><span class="o">=</span><span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;latmax&#39;</span><span class="p">],</span> <span class="n">latitude_true_scale</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">globe</span><span class="o">=</span><span class="kc">None</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;lonmin&#39;</span><span class="p">],</span><span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;lonmax&#39;</span><span class="p">],</span>\
                     <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;latmin&#39;</span><span class="p">],</span><span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;latmax&#39;</span><span class="p">]])</span>
    <span class="k">if</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;proj&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;mill&#39;</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">Miller</span><span class="p">(</span>
            <span class="n">central_longitude</span><span class="o">=</span><span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;lon_0&#39;</span><span class="p">]))</span>
    <span class="k">if</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;proj&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;moll&#39;</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">Mollweide</span><span class="p">(</span>
            <span class="n">central_longitude</span><span class="o">=</span><span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;lat_0&#39;</span><span class="p">],</span> <span class="n">globe</span><span class="o">=</span><span class="kc">None</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;proj&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;ortho&#39;</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">Orthographic</span><span class="p">(</span>
            <span class="n">central_longitude</span><span class="o">=</span><span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;lon_0&#39;</span><span class="p">],</span>
            <span class="n">central_latitude</span><span class="o">=</span><span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;lat_0&#39;</span><span class="p">]))</span>
    <span class="k">if</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;proj&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;robin&#39;</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">Robinson</span><span class="p">(</span>
            <span class="n">central_longitude</span><span class="o">=</span><span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;lon_0&#39;</span><span class="p">],</span>
            <span class="n">globe</span><span class="o">=</span><span class="kc">None</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;proj&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;sinu&#39;</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">Sinusoidal</span><span class="p">(</span>
            <span class="n">central_longitude</span><span class="o">=</span><span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;lon_0&#39;</span><span class="p">],</span>
            <span class="n">false_easting</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">false_northing</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
            <span class="n">globe</span><span class="o">=</span><span class="kc">None</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;proj&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;stere&#39;</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">Stereographic</span><span class="p">(</span>
            <span class="n">central_longitude</span><span class="o">=</span><span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;lon_0&#39;</span><span class="p">],</span>
            <span class="n">false_easting</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">false_northing</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
            <span class="n">true_scale_latitude</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">scale_factor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">globe</span><span class="o">=</span><span class="kc">None</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;proj&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;tmerc&#39;</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">TransverseMercator</span><span class="p">(</span>
            <span class="n">central_longitude</span><span class="o">=</span><span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;lon_0&#39;</span><span class="p">],</span> <span class="n">central_latitude</span><span class="o">=</span><span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;lat_0&#39;</span><span class="p">],</span>
            <span class="n">false_easting</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">false_northing</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
            <span class="n">scale_factor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">globe</span><span class="o">=</span><span class="kc">None</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;proj&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;utm&#39;</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">UTM</span><span class="p">(</span>
            <span class="n">zone</span><span class="o">=</span><span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;zone&#39;</span><span class="p">],</span>
            <span class="n">southern_hemisphere</span><span class="o">=</span><span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;south&#39;</span><span class="p">],</span>
            <span class="n">globe</span><span class="o">=</span><span class="kc">None</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;proj&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;geos&#39;</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">Geostationary</span><span class="p">(</span>
            <span class="n">central_longitude</span><span class="o">=</span><span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;lon_0&#39;</span><span class="p">],</span>
            <span class="n">false_easting</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">false_northing</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
            <span class="n">satellite_height</span><span class="o">=</span><span class="mi">35785831</span><span class="p">,</span>
            <span class="n">sweep_axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span>
            <span class="n">globe</span><span class="o">=</span><span class="kc">None</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;proj&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;laea&#39;</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">LambertAzimuthalEqualArea</span><span class="p">(</span>
            <span class="n">central_longitude</span><span class="o">=</span><span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;lon_0&#39;</span><span class="p">],</span> <span class="n">central_latitude</span><span class="o">=</span><span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;lat_0&#39;</span><span class="p">],</span>
            <span class="n">false_easting</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">false_northing</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
            <span class="n">globe</span><span class="o">=</span><span class="kc">None</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;proj&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;npstere&#39;</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">NorthPolarStereo</span><span class="p">(</span>
            <span class="n">central_longitude</span><span class="o">=</span><span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;lon_0&#39;</span><span class="p">],</span>
            <span class="n">true_scale_latitude</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">globe</span><span class="o">=</span><span class="kc">None</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;proj&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;spstere&#39;</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">SouthPolarStereo</span><span class="p">(</span>
            <span class="n">central_longitude</span><span class="o">=</span><span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;lon_0&#39;</span><span class="p">],</span>
            <span class="n">true_scale_latitude</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">globe</span><span class="o">=</span><span class="kc">None</span><span class="p">))</span>

    <span class="k">if</span> <span class="s1">&#39;details&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Opts</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="k">if</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;details&#39;</span><span class="p">][</span><span class="s1">&#39;fancy&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">pmag_data_dir</span> <span class="o">=</span> <span class="n">find_pmag_dir</span><span class="o">.</span><span class="n">get_data_files_dir</span><span class="p">()</span>
            <span class="n">EDIR</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pmag_data_dir</span><span class="p">,</span> <span class="s2">&quot;etopo20&quot;</span><span class="p">)</span>
            <span class="n">etopo_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">EDIR</span><span class="p">,</span> <span class="s1">&#39;etopo20data.gz&#39;</span><span class="p">)</span>
            <span class="n">etopo</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">EDIR</span><span class="p">,</span> <span class="s1">&#39;etopo20data.gz&#39;</span><span class="p">))</span>
            <span class="n">elons</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">EDIR</span><span class="p">,</span> <span class="s1">&#39;etopo20lons.gz&#39;</span><span class="p">))</span>
            <span class="n">elats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">EDIR</span><span class="p">,</span> <span class="s1">&#39;etopo20lats.gz&#39;</span><span class="p">))</span>
            <span class="n">xx</span><span class="p">,</span> <span class="n">yy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">elons</span><span class="p">,</span> <span class="n">elats</span><span class="p">)</span>
            <span class="n">levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">8000</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>  <span class="c1"># define contour intervals</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">etopo</span><span class="p">,</span> <span class="n">levels</span><span class="p">,</span>
                            <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span>
                            <span class="n">cmap</span><span class="o">=</span><span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;cmap&#39;</span><span class="p">])</span>
            <span class="n">cbar</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;res&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;c&#39;</span> <span class="ow">or</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;res&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;l&#39;</span><span class="p">:</span>
            <span class="n">resolution</span><span class="o">=</span><span class="s1">&#39;110m&#39;</span>
        <span class="k">elif</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;res&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;i&#39;</span><span class="p">:</span>
            <span class="n">resolution</span><span class="o">=</span><span class="s1">&#39;50m&#39;</span>
        <span class="k">elif</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;res&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;h&#39;</span><span class="p">:</span>
            <span class="n">resolution</span><span class="o">=</span><span class="s1">&#39;10m&#39;</span>
        <span class="k">if</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;details&#39;</span><span class="p">][</span><span class="s1">&#39;coasts&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">resolution</span><span class="o">=</span><span class="n">resolution</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;details&#39;</span><span class="p">][</span><span class="s1">&#39;rivers&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">RIVERS</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;details&#39;</span><span class="p">][</span><span class="s1">&#39;states&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">states_provinces</span> <span class="o">=</span> <span class="n">cfeature</span><span class="o">.</span><span class="n">NaturalEarthFeature</span><span class="p">(</span>
                <span class="n">category</span><span class="o">=</span><span class="s1">&#39;cultural&#39;</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="s1">&#39;admin_1_states_provinces_lines&#39;</span><span class="p">,</span>
                <span class="n">scale</span><span class="o">=</span><span class="n">resolution</span><span class="p">,</span>
                <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span>
                <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span>
                <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dotted&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">states_provinces</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;details&#39;</span><span class="p">][</span><span class="s1">&#39;countries&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">BORDERS</span><span class="o">.</span><span class="n">with_scale</span><span class="p">(</span><span class="n">resolution</span><span class="p">),</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;details&#39;</span><span class="p">][</span><span class="s1">&#39;ocean&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">OCEAN</span><span class="o">.</span><span class="n">with_scale</span><span class="p">(</span><span class="n">resolution</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;oceancolor&#39;</span><span class="p">])</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">LAND</span><span class="o">.</span><span class="n">with_scale</span><span class="p">(</span><span class="n">resolution</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;landcolor&#39;</span><span class="p">])</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">LAKES</span><span class="o">.</span><span class="n">with_scale</span><span class="p">(</span><span class="n">resolution</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;oceancolor&#39;</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;proj&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;merc&#39;</span><span class="p">,</span> <span class="s1">&#39;pc&#39;</span><span class="p">,</span><span class="s1">&#39;lcc&#39;</span><span class="p">,</span><span class="s1">&#39;ortho&#39;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;pltgrid&#39;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;proj&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;lcc&#39;</span><span class="p">:</span>
                <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
                <span class="c1">#xticks=list(np.arange(Opts[&#39;lonmin&#39;],Opts[&#39;lonmax&#39;]+Opts[&#39;gridspace&#39;],Opts[&#39;gridspace&#39;]))</span>
                <span class="c1">#yticks=list(np.arange(Opts[&#39;latmin&#39;],Opts[&#39;latmax&#39;]+Opts[&#39;gridspace&#39;],Opts[&#39;gridspace&#39;]))</span>
                <span class="n">xticks</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span><span class="mi">180</span><span class="p">,</span><span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;gridspace&#39;</span><span class="p">]))</span>
                <span class="n">yticks</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;gridspace&#39;</span><span class="p">]))</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">ylocs</span><span class="o">=</span><span class="n">yticks</span><span class="p">,</span><span class="n">xlocs</span><span class="o">=</span><span class="n">xticks</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                              <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dotted&#39;</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">LONGITUDE_FORMATTER</span><span class="p">)</span> <span class="c1"># you need this here</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">LATITUDE_FORMATTER</span><span class="p">)</span><span class="c1"># you need this here, too</span>

                <span class="k">try</span><span class="p">:</span>
                    <span class="kn">import</span> <span class="nn">pmagpy.lcc_ticks</span> <span class="k">as</span> <span class="nn">lcc_ticks</span>
                    <span class="n">lcc_ticks</span><span class="o">.</span><span class="n">lambert_xticks</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">xticks</span><span class="p">)</span>
                    <span class="n">lcc_ticks</span><span class="o">.</span><span class="n">lambert_yticks</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">yticks</span><span class="p">)</span>

                <span class="k">except</span><span class="p">:</span>
                    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;plotting of tick marks on Lambert Conformal requires the package &quot;shapely&quot;.</span><span class="se">\n</span><span class="s1"> Try importing with &quot;conda install -c conda-forge shapely&quot;&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;proj&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;ortho&#39;</span><span class="p">:</span>
                    <span class="n">draw_labels</span><span class="o">=</span><span class="kc">False</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">draw_labels</span><span class="o">=</span><span class="kc">True</span>
                <span class="n">gl</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">crs</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                              <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dotted&#39;</span><span class="p">,</span> <span class="n">draw_labels</span><span class="o">=</span><span class="n">draw_labels</span><span class="p">)</span>
                <span class="n">gl</span><span class="o">.</span><span class="n">ylocator</span> <span class="o">=</span> <span class="n">mticker</span><span class="o">.</span><span class="n">FixedLocator</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">80</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;gridspace&#39;</span><span class="p">]))</span>
                <span class="n">gl</span><span class="o">.</span><span class="n">xlocator</span> <span class="o">=</span> <span class="n">mticker</span><span class="o">.</span><span class="n">FixedLocator</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">181</span><span class="p">,</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;gridspace&#39;</span><span class="p">]))</span>
                <span class="n">gl</span><span class="o">.</span><span class="n">xformatter</span> <span class="o">=</span> <span class="n">LONGITUDE_FORMATTER</span>
                <span class="n">gl</span><span class="o">.</span><span class="n">yformatter</span> <span class="o">=</span> <span class="n">LATITUDE_FORMATTER</span>
                <span class="n">gl</span><span class="o">.</span><span class="n">xlabels_top</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1">#else:</span>
        <span class="c1">#    gl = ax.gridlines(crs=ccrs.PlateCarree(),</span>
        <span class="c1">#                      linewidth=2, linestyle=&#39;dotted&#39;)</span>
    <span class="k">elif</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;pltgrid&#39;</span><span class="p">]:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;gridlines only supported for PlateCarree, Orthorhombic, Lambert Conformal, and Mercator plots currently&#39;</span><span class="p">)</span>
    <span class="n">prn_name</span><span class="p">,</span> <span class="n">symsize</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span>
    <span class="c1"># if &#39;names&#39; in list(Opts.keys()) &gt; 0:</span>
    <span class="c1">#    names = Opts[&#39;names&#39;]</span>
    <span class="c1">#    if len(names) &gt; 0:</span>
    <span class="c1">#        prn_name = 1</span>
<span class="c1">##</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="s1">&#39;symsize&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Opts</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="n">symsize</span> <span class="o">=</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;symsize&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;sym&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>  <span class="c1"># just plot points</span>
        <span class="n">color</span><span class="p">,</span> <span class="n">symbol</span> <span class="o">=</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;sym&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;sym&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">lons</span><span class="p">,</span> <span class="n">lats</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;symsize&#39;</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">symbol</span><span class="p">,</span>
                   <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">edgecolors</span><span class="o">=</span><span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;edgecolor&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">prn_name</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;labels not yet implemented in plot_map&#39;</span><span class="p">)</span>
            <span class="c1"># for pt in range(len(lats)):</span>
            <span class="c1">#    T.append(plt.text(X[pt] + 5000, Y[pt] - 5000, names[pt]))</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># for lines,  need to separate chunks using lat==100.</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lons</span><span class="p">,</span> <span class="n">lats</span><span class="p">,</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;sym&#39;</span><span class="p">],</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
    <span class="k">if</span> <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;global&#39;</span><span class="p">]:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_global</span><span class="p">()</span></div>


<div class="viewcode-block" id="plot_mag_map_basemap"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmagplotlib.plot_mag_map_basemap">[docs]</a><span class="k">def</span> <span class="nf">plot_mag_map_basemap</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span> <span class="n">element</span><span class="p">,</span> <span class="n">lons</span><span class="p">,</span> <span class="n">lats</span><span class="p">,</span> <span class="n">element_type</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdYlBu&#39;</span><span class="p">,</span> <span class="n">lon_0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">date</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    makes a color contour map of geomagnetic field element</span>

<span class="sd">    Parameters</span>
<span class="sd">    ____________</span>
<span class="sd">    fignum : matplotlib figure number</span>
<span class="sd">    element : field element array from pmag.do_mag_map for plotting</span>
<span class="sd">    lons : longitude array from pmag.do_mag_map for plotting</span>
<span class="sd">    lats : latitude array from pmag.do_mag_map for plotting</span>
<span class="sd">    element_type : [B,Br,I,D] geomagnetic element type</span>
<span class="sd">        B : field intensity</span>
<span class="sd">        Br : radial field intensity</span>
<span class="sd">        I : inclinations</span>
<span class="sd">        D : declinations</span>
<span class="sd">    Optional</span>
<span class="sd">    _________</span>
<span class="sd">        cmap : matplotlib color map</span>
<span class="sd">        lon_0 : central longitude of the Hammer projection</span>
<span class="sd">        date : date used for field evaluation,</span>
<span class="sd">               if custom ghfile was used, supply filename</span>


<span class="sd">    Effects</span>
<span class="sd">    ______________</span>
<span class="sd">    plots a Hammer projection color contour with  the desired field element</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">has_basemap</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-W- Basemap must be installed to run plot_mag_map_basemap&#39;</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">cm</span>  <span class="c1"># matplotlib&#39;s color map module</span>
    <span class="n">lincr</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">date</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">date</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="p">)</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">fignum</span><span class="p">)</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">Basemap</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;hammer&#39;</span><span class="p">,</span> <span class="n">lon_0</span><span class="o">=</span><span class="n">lon_0</span><span class="p">)</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">m</span><span class="p">(</span><span class="o">*</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">lons</span><span class="p">,</span> <span class="n">lats</span><span class="p">))</span>
    <span class="n">m</span><span class="o">.</span><span class="n">drawcoastlines</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">element_type</span> <span class="o">==</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span>
        <span class="n">levmax</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">+</span><span class="n">lincr</span>
        <span class="n">levmin</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">-</span><span class="n">lincr</span><span class="p">)</span>
        <span class="n">levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">levmin</span><span class="p">,</span> <span class="n">levmax</span><span class="p">,</span> <span class="n">lincr</span><span class="p">)</span>
        <span class="n">cs</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">element</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Field strength ($\mu$T): &#39;</span><span class="o">+</span><span class="n">date</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">element_type</span> <span class="o">==</span> <span class="s1">&#39;Br&#39;</span><span class="p">:</span>
        <span class="n">levmax</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">+</span><span class="n">lincr</span>
        <span class="n">levmin</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">-</span><span class="n">lincr</span><span class="p">)</span>
        <span class="n">cs</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">element</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span>
            <span class="n">levmin</span><span class="p">,</span> <span class="n">levmax</span><span class="p">,</span> <span class="n">lincr</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Radial field strength ($\mu$T): &#39;</span><span class="o">+</span><span class="n">date</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">element_type</span> <span class="o">==</span> <span class="s1">&#39;I&#39;</span><span class="p">:</span>
        <span class="n">levmax</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">+</span><span class="n">lincr</span>
        <span class="n">levmin</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">-</span><span class="n">lincr</span><span class="p">)</span>
        <span class="n">cs</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">element</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>
        <span class="n">m</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">element</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">80</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Field inclination: &#39;</span><span class="o">+</span><span class="n">date</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">element_type</span> <span class="o">==</span> <span class="s1">&#39;D&#39;</span><span class="p">:</span>
        <span class="c1"># cs=m.contourf(x,y,element,levels=np.arange(-180,180,10),cmap=cmap)</span>
        <span class="n">cs</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">element</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>
        <span class="n">m</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">element</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Field declination: &#39;</span><span class="o">+</span><span class="n">date</span><span class="p">)</span>
    <span class="n">cbar</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="plot_mag_map"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmagplotlib.plot_mag_map">[docs]</a><span class="k">def</span> <span class="nf">plot_mag_map</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span> <span class="n">element</span><span class="p">,</span> <span class="n">lons</span><span class="p">,</span> <span class="n">lats</span><span class="p">,</span> <span class="n">element_type</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span> <span class="n">lon_0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">date</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">contours</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">proj</span><span class="o">=</span><span class="s1">&#39;PlateCarree&#39;</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="nb">max</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    makes a color contour map of geomagnetic field element</span>

<span class="sd">    Parameters</span>
<span class="sd">    ____________</span>
<span class="sd">    fignum : matplotlib figure number</span>
<span class="sd">    element : field element array from pmag.do_mag_map for plotting</span>
<span class="sd">    lons : longitude array from pmag.do_mag_map for plotting</span>
<span class="sd">    lats : latitude array from pmag.do_mag_map for plotting</span>
<span class="sd">    element_type : [B,Br,I,D] geomagnetic element type</span>
<span class="sd">        B : field intensity</span>
<span class="sd">        Br : radial field intensity</span>
<span class="sd">        I : inclinations</span>
<span class="sd">        D : declinations</span>
<span class="sd">    Optional</span>
<span class="sd">    _________</span>
<span class="sd">    contours : plot the contour lines on top of the heat map if True</span>
<span class="sd">    proj : cartopy projection [&#39;PlateCarree&#39;,&#39;Mollweide&#39;]</span>
<span class="sd">           NB: The Mollweide projection can only be reliably with cartopy=0.17.0; otherwise use lon_0=0.  Also, for declinations, PlateCarree is recommended.</span>
<span class="sd">    cmap : matplotlib color map - see https://matplotlib.org/examples/color/colormaps_reference.html for options</span>
<span class="sd">    lon_0 : central longitude of the Mollweide projection</span>
<span class="sd">    date : date used for field evaluation,</span>
<span class="sd">           if custom ghfile was used, supply filename</span>
<span class="sd">    min : int</span>
<span class="sd">        minimum value for color contour on intensity map : default is minimum value  - useful for making many maps with same scale</span>
<span class="sd">    max : int</span>
<span class="sd">        maximum value for color contour on intensity map : default is maximum value - useful for making many maps with same scale</span>

<span class="sd">    Effects</span>
<span class="sd">    ______________</span>
<span class="sd">    plots a color contour map with  the desired field element</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">has_cartopy</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;This function requires installation of cartopy&#39;</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">cm</span>
    <span class="k">if</span> <span class="n">lon_0</span> <span class="o">==</span> <span class="mi">180</span><span class="p">:</span>
        <span class="n">lon_0</span> <span class="o">=</span> <span class="mf">179.99</span>
    <span class="k">if</span> <span class="n">lon_0</span> <span class="o">&gt;</span> <span class="mi">180</span><span class="p">:</span>
        <span class="n">lon_0</span> <span class="o">=</span> <span class="n">lon_0</span><span class="o">-</span><span class="mf">360.</span>
    <span class="n">lincr</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">date</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">date</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">proj</span> <span class="o">==</span> <span class="s1">&#39;PlateCarree&#39;</span><span class="p">:</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">fignum</span><span class="p">)</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(</span><span class="n">central_longitude</span><span class="o">=</span><span class="n">lon_0</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">proj</span> <span class="o">==</span> <span class="s1">&#39;Mollweide&#39;</span><span class="p">:</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">fignum</span><span class="p">)</span>
        <span class="c1"># this issue is fixed in &gt;=0.17</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">LooseVersion</span><span class="p">(</span><span class="n">Cartopy</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">LooseVersion</span><span class="p">(</span><span class="s1">&#39;0.16.0&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">lon_0</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;This projection requires lon_0=0&#39;</span><span class="p">)</span>
                <span class="k">return</span>

        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">Mollweide</span><span class="p">(</span><span class="n">central_longitude</span><span class="o">=</span><span class="n">lon_0</span><span class="p">))</span>
    <span class="n">xx</span><span class="p">,</span> <span class="n">yy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">lons</span><span class="p">,</span> <span class="n">lats</span><span class="p">)</span>
    <span class="n">levmax</span> <span class="o">=</span> <span class="mi">5</span><span class="o">*</span><span class="nb">round</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="mi">5</span>
    <span class="n">levmin</span> <span class="o">=</span> <span class="mi">5</span><span class="o">*</span><span class="nb">round</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span><span class="o">-</span><span class="mi">5</span>
    <span class="k">if</span> <span class="n">element_type</span> <span class="o">==</span> <span class="s1">&#39;Br&#39;</span> <span class="ow">or</span> <span class="n">element_type</span> <span class="o">==</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span>
        <span class="n">v</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">min</span><span class="p">,</span><span class="nb">max</span><span class="o">+</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">min</span> <span class="ow">and</span> <span class="nb">max</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">element</span><span class="p">,</span><span class="n">v</span><span class="p">,</span>
                     <span class="n">vmin</span><span class="o">=</span><span class="nb">min</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="nb">max</span><span class="p">,</span>
                     <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">element</span><span class="p">,</span><span class="n">v</span><span class="p">,</span>
                     <span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">levmin</span><span class="p">,</span> <span class="n">levmax</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                     <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
        <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">contours</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">element</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">levmin</span><span class="p">,</span> <span class="n">levmax</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
                        <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>

        <span class="k">if</span> <span class="n">element_type</span> <span class="o">==</span> <span class="s1">&#39;Br&#39;</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Radial field strength ($\mu$T): &#39;</span><span class="o">+</span><span class="n">date</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Total field strength ($\mu$T): &#39;</span><span class="o">+</span><span class="n">date</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">element_type</span> <span class="o">==</span> <span class="s1">&#39;I&#39;</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">element</span><span class="p">,</span>
                     <span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="n">lincr</span><span class="p">),</span>
                     <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
        <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">contours</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">element</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">80</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
                        <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Field inclination: &#39;</span><span class="o">+</span><span class="n">date</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">element_type</span> <span class="o">==</span> <span class="s1">&#39;D&#39;</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">element</span><span class="p">,</span>
                     <span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
                     <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
        <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">contours</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">element</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
                        <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Field declination: &#39;</span><span class="o">+</span><span class="n">date</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_global</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">ax</span></div>


<div class="viewcode-block" id="plot_eq_cont"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmagplotlib.plot_eq_cont">[docs]</a><span class="k">def</span> <span class="nf">plot_eq_cont</span><span class="p">(</span><span class="n">fignum</span><span class="p">,</span> <span class="n">DIblock</span><span class="p">,</span> <span class="n">color_map</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    plots dec inc block as a color contour</span>
<span class="sd">    Parameters</span>
<span class="sd">    __________________</span>
<span class="sd">    Input:</span>
<span class="sd">        fignum :  figure number</span>
<span class="sd">        DIblock : nested pairs of [Declination, Inclination]</span>
<span class="sd">        color_map : matplotlib color map [default is coolwarm]</span>
<span class="sd">    Output:</span>
<span class="sd">        figure</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">random</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">fignum</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
    <span class="n">XY</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">centres</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">DIblock</span><span class="p">:</span>
        <span class="n">counter</span> <span class="o">=</span> <span class="n">counter</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">dir2cart</span><span class="p">([</span><span class="n">rec</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">rec</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mf">1.</span><span class="p">])</span>
        <span class="c1"># from Collinson 1983</span>
        <span class="n">R</span> <span class="o">=</span> <span class="n">old_div</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)))</span>
        <span class="n">XY</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">R</span><span class="p">,</span> <span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">R</span><span class="p">])</span>
    <span class="c1"># radius of the circle</span>
    <span class="n">radius</span> <span class="o">=</span> <span class="p">(</span><span class="n">old_div</span><span class="p">(</span><span class="mf">3.</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="mf">9.</span> <span class="o">+</span> <span class="nb">float</span><span class="p">(</span><span class="n">counter</span><span class="p">))))))</span> <span class="o">+</span> <span class="mf">0.01</span>
    <span class="n">num</span> <span class="o">=</span> <span class="mf">2.</span> <span class="o">*</span> <span class="p">(</span><span class="n">old_div</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="n">radius</span><span class="p">))</span>  <span class="c1"># number of circles</span>
    <span class="c1"># a,b are the extent of the grids over which the circles are equispaced</span>
    <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.</span> <span class="o">-</span> <span class="p">(</span><span class="n">radius</span> <span class="o">*</span> <span class="n">num</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">)),</span> <span class="p">(</span><span class="mf">0.</span> <span class="o">+</span> <span class="p">(</span><span class="n">radius</span> <span class="o">*</span> <span class="n">num</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">))</span>
    <span class="n">b1</span><span class="p">,</span> <span class="n">b2</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.</span> <span class="o">-</span> <span class="p">(</span><span class="n">radius</span> <span class="o">*</span> <span class="n">num</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">)),</span> <span class="p">(</span><span class="mf">0.</span> <span class="o">+</span> <span class="p">(</span><span class="n">radius</span> <span class="o">*</span> <span class="n">num</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">))</span>
    <span class="c1"># this is to get an array (a list of list wont do) of x,y values</span>
    <span class="n">xlist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">num</span><span class="p">)))</span>
    <span class="n">ylist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">b1</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">num</span><span class="p">)))</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">xlist</span><span class="p">,</span> <span class="n">ylist</span><span class="p">)</span>
    <span class="c1"># to put z in the array I just multiply both x,y with zero.  I will add to</span>
    <span class="c1"># the zero values later</span>
    <span class="n">Z</span> <span class="o">=</span> <span class="n">X</span> <span class="o">*</span> <span class="n">Y</span> <span class="o">*</span> <span class="mf">0.</span>
    <span class="c1"># keeping the centres of the circles as a separate list instead of in</span>
    <span class="c1"># array helps later</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ylist</span><span class="p">)):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xlist</span><span class="p">)):</span>
            <span class="n">centres</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">xlist</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">ylist</span><span class="p">[</span><span class="n">j</span><span class="p">]])</span>
    <span class="c1"># the following lines are to figure out what happens at the edges where part of a circle might lie outside</span>
    <span class="c1"># a thousand random numbers are generated within the x,y limit of the circles and tested whether it is contained in</span>
    <span class="c1"># the eq area net space....their ratio gives the fraction of circle</span>
    <span class="c1"># contained in the net</span>
    <span class="n">fraction</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">beta</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.001</span>  <span class="c1"># to avoid those &#39;division by float&#39; thingy</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">num</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(((</span><span class="n">centres</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="n">centres</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">-</span> <span class="mf">1.</span> <span class="o">&lt;</span> <span class="n">radius</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">):</span>
                <span class="n">rnd1</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span>
                    <span class="n">centres</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">centres</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">radius</span><span class="p">)</span>
                <span class="n">rnd2</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span>
                    <span class="n">centres</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">radius</span><span class="p">,</span> <span class="n">centres</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">radius</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">((</span><span class="n">centres</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">rnd1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">centres</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">rnd2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">radius</span><span class="o">**</span><span class="mi">2</span><span class="p">:</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">rnd1</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">rnd2</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1.</span><span class="p">:</span>
                        <span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span> <span class="o">+</span> <span class="mf">1.</span>
                        <span class="n">beta</span> <span class="o">=</span> <span class="n">beta</span> <span class="o">+</span> <span class="mf">1.</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span> <span class="o">+</span> <span class="mf">1.</span>
            <span class="n">fraction</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">old_div</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">))</span>
            <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span> <span class="o">=</span> <span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.001</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fraction</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">1.</span><span class="p">)</span>  <span class="c1"># if the whole circle lies in the net</span>

    <span class="c1"># for every circle count the number of points lying in it</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">dotspercircle</span> <span class="o">=</span> <span class="mf">0.</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">num</span><span class="p">))):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">num</span><span class="p">))):</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">counter</span><span class="p">):</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">XY</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">centres</span><span class="p">[</span><span class="n">count</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">XY</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">centres</span><span class="p">[</span><span class="n">count</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;=</span> <span class="n">radius</span><span class="o">**</span><span class="mi">2</span><span class="p">:</span>
                    <span class="n">dotspercircle</span> <span class="o">+=</span> <span class="mf">1.</span>
            <span class="n">Z</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">Z</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">dotspercircle</span> <span class="o">*</span> <span class="n">fraction</span><span class="p">[</span><span class="n">count</span><span class="p">])</span>
            <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">dotspercircle</span> <span class="o">=</span> <span class="mf">0.</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;bilinear&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span>
                    <span class="c1"># cmap=plt.color_map.hot, extent=(-1., 1., -1., 1.))</span>
                    <span class="n">cmap</span><span class="o">=</span><span class="n">color_map</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">shrink</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="c1"># Draws the border</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="p">):</span>
        <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.</span><span class="p">)</span> <span class="o">*</span> <span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span>
        <span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.</span><span class="p">)</span> <span class="o">*</span> <span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;w-&#39;</span><span class="p">)</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="c1"># the map will be a square of 1X1..this is how I erase the redundant area</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="p">):</span>
            <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.</span><span class="p">)</span> <span class="o">*</span> <span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
                     <span class="o">*</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="p">(</span><span class="n">old_div</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">j</span><span class="p">),</span> <span class="mf">10.</span><span class="p">))))</span>
            <span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.</span><span class="p">)</span> <span class="o">*</span> <span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
                     <span class="o">*</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="p">(</span><span class="n">old_div</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">j</span><span class="p">),</span> <span class="mf">10.</span><span class="p">))))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;w-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">26</span><span class="p">)</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="c1"># the axes</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="plot_ts"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmagplotlib.plot_ts">[docs]</a><span class="k">def</span> <span class="nf">plot_ts</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">agemin</span><span class="p">,</span> <span class="n">agemax</span><span class="p">,</span> <span class="n">timescale</span><span class="o">=</span><span class="s1">&#39;gts12&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;Age (Ma)&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Make a time scale plot between specified ages.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    ------------</span>
<span class="sd">    ax : figure object</span>
<span class="sd">    agemin : Minimum age for timescale</span>
<span class="sd">    agemax : Maximum age for timescale</span>
<span class="sd">    timescale : Time Scale [ default is Gradstein et al., (2012)]</span>
<span class="sd">       for other options see pmag.get_ts()</span>
<span class="sd">    ylabel : if set, plot as ylabel</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">timescale</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mf">.25</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="n">agemax</span><span class="p">,</span> <span class="n">agemin</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="c1"># get dates and chron names for timescale</span>
    <span class="n">TS</span><span class="p">,</span> <span class="n">Chrons</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">get_ts</span><span class="p">(</span><span class="n">timescale</span><span class="p">)</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Y2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">agemin</span> <span class="o">&lt;</span> <span class="n">TS</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>  <span class="c1"># in the Brunhes</span>
        <span class="n">Y</span> <span class="o">=</span> <span class="p">[</span><span class="n">agemin</span><span class="p">,</span> <span class="n">agemin</span><span class="p">]</span>  <span class="c1"># minimum age</span>
        <span class="n">Y1</span> <span class="o">=</span> <span class="p">[</span><span class="n">TS</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">TS</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>  <span class="c1"># age of the B/M boundary</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Y1</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>  <span class="c1"># color in Brunhes, black</span>
    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">TS</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
        <span class="n">pol</span> <span class="o">=</span> <span class="n">cnt</span> <span class="o">%</span> <span class="mi">2</span>
        <span class="n">cnt</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">d</span> <span class="o">&lt;=</span> <span class="n">agemax</span> <span class="ow">and</span> <span class="n">d</span> <span class="o">&gt;=</span> <span class="n">agemin</span><span class="p">:</span>
            <span class="n">ind</span> <span class="o">=</span> <span class="n">TS</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
            <span class="n">Y</span> <span class="o">=</span> <span class="p">[</span><span class="n">TS</span><span class="p">[</span><span class="n">ind</span><span class="p">],</span> <span class="n">TS</span><span class="p">[</span><span class="n">ind</span><span class="p">]]</span>
            <span class="n">Y1</span> <span class="o">=</span> <span class="p">[</span><span class="n">TS</span><span class="p">[</span><span class="n">ind</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">TS</span><span class="p">[</span><span class="n">ind</span><span class="o">+</span><span class="mi">1</span><span class="p">]]</span>
            <span class="k">if</span> <span class="n">pol</span><span class="p">:</span>
                <span class="c1"># fill in every other time</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Y1</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="n">agemin</span><span class="p">,</span> <span class="n">agemin</span><span class="p">,</span> <span class="n">agemax</span><span class="p">,</span> <span class="n">agemax</span><span class="p">,</span> <span class="n">agemin</span><span class="p">],</span> <span class="s1">&#39;k-&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">agemin</span><span class="p">,</span> <span class="n">agemax</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">ylabel</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">)</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Chrons</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">Chrons</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="n">cnext</span> <span class="o">=</span> <span class="n">Chrons</span><span class="p">[</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">cnext</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="n">cnext</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mf">3.</span>
        <span class="k">if</span> <span class="n">d</span> <span class="o">&gt;=</span> <span class="n">agemin</span> <span class="ow">and</span> <span class="n">d</span> <span class="o">&lt;</span> <span class="n">agemax</span><span class="p">:</span>
            <span class="c1"># make the Chron boundary tick</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span> <span class="p">[</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="s1">&#39;k-&#39;</span><span class="p">)</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mf">.25</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="n">agemax</span><span class="p">,</span> <span class="n">agemin</span><span class="p">])</span></div>


<span class="k">def</span> <span class="nf">save_or_quit</span><span class="p">(</span><span class="n">msg</span><span class="o">=</span><span class="s2">&quot;S[a]ve plots - &lt;q&gt; to quit, &lt;return&gt; to continue: &quot;</span><span class="p">):</span>
    <span class="n">ans</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">ans</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;q&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">]:</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">:</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="s1">&#39;q&#39;</span>
    <span class="k">if</span> <span class="n">ans</span> <span class="o">==</span> <span class="s1">&#39;a&#39;</span><span class="p">:</span>
        <span class="k">return</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ans</span> <span class="o">==</span> <span class="s1">&#39;q&#39;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> Good bye</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">ans</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
        <span class="k">return</span>

<div class="viewcode-block" id="label_tiepoints"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmagplotlib.label_tiepoints">[docs]</a><span class="k">def</span> <span class="nf">label_tiepoints</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">tiepoints</span><span class="p">,</span><span class="n">levels</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">lines</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Puts on labels for tiepoints in an age table on a stratigraphic plot.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    _______________________________</span>
<span class="sd">        ax : obj</span>
<span class="sd">            axis on which to plot the labels</span>
<span class="sd">        x : float or integer</span>
<span class="sd">            x value for the tiepoint labels</span>
<span class="sd">        levels : float</span>
<span class="sd">            stratigraphic positions of the tiepoints</span>
<span class="sd">        lines : bool</span>
<span class="sd">            put on horizontal lines at the tiepoint heights</span>
<span class="sd">    Returns</span>
<span class="sd">    _______________________________</span>
<span class="sd">        ax : obj</span>
<span class="sd">            axis  object</span>
<span class="sd">    &quot;&quot;&quot;</span> 
    <span class="k">if</span> <span class="n">color</span><span class="o">==</span><span class="s1">&#39;black&#39;</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tiepoints</span><span class="p">)):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">levels</span><span class="p">[</span><span class="n">c</span><span class="p">],</span><span class="s1">&#39;- &#39;</span><span class="o">+</span><span class="n">tiepoints</span><span class="p">[</span><span class="n">c</span><span class="p">],</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
               <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tiepoints</span><span class="p">)):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">levels</span><span class="p">[</span><span class="n">c</span><span class="p">],</span><span class="s1">&#39;(&#39;</span><span class="o">+</span><span class="n">tiepoints</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
               <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">lines</span><span class="p">:</span>
        <span class="k">for</span>  <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tiepoints</span><span class="p">)):</span>
            <span class="k">if</span> <span class="s1">&#39;(&#39;</span> <span class="ow">in</span> <span class="n">tiepoints</span><span class="p">[</span><span class="n">c</span><span class="p">]:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">levels</span><span class="p">[</span><span class="n">c</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">levels</span><span class="p">[</span><span class="n">c</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span></div>



<div class="viewcode-block" id="msp_magic"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmagplotlib.msp_magic">[docs]</a><span class="k">def</span> <span class="nf">msp_magic</span><span class="p">(</span><span class="n">spec_df</span><span class="p">,</span><span class="n">axa</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="n">axb</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="n">site</span><span class="o">=</span><span class="s1">&#39;site&#39;</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a)&#39;</span><span class="p">,</span><span class="s1">&#39;b)&#39;</span><span class="p">],</span><span class="n">save_plots</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">fmt</span> <span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;   </span>
<span class="sd">    makes plots and calculations for MSP method of Dekkers &amp; Boehnel (2006) (DB) and Fabian and Leonhardt (2010) method</span>
<span class="sd">    (DSC) of multi-specimen paleointensity technique. </span>
<span class="sd">    NB: this code requires seaborn and scipy to be installed</span>
<span class="sd">    </span>
<span class="sd">    Parameters: </span>
<span class="sd">    _____________</span>
<span class="sd">    spec_df : pandas dataframe</span>
<span class="sd">        data frame with MagIC measurement formatted data for one MSP experiment.</span>
<span class="sd">        measurements must have these MagIC method codes: </span>
<span class="sd">        Mo (NRM step): must contain &#39;LT-NO&#39; </span>
<span class="sd">        M1 (pTRM at T || NRM): must contain &#39;LT-NRM-PAR&#39; and not &#39;LT-PTRM-I&#39;</span>
<span class="sd">        M2 (pTRM \\ NRM: must contain &#39;LT-NRM-APAR&#39;</span>
<span class="sd">        M3 (heat to T, cool in lab field): must contain &#39;LT-T-Z-NRM-PAR&#39;</span>
<span class="sd">        M4 (repeat of M1): must contain &#39;LT-PTRM-I&#39;</span>
<span class="sd">        lab field must be in &#39;treat_dc_field&#39;</span>


<span class="sd">    axa : matplotlib figure subplot for DB plot, default is to create and return.</span>
<span class="sd">    axb : matplotlib figure subplot for DSC plot, default is to create and return.</span>
<span class="sd">    site : name of group of specimens for y-axis label, default is generic &#39;site&#39;</span>
<span class="sd">    labels : plot labels as specified. </span>
<span class="sd">    save_plots : bool, default False</span>
<span class="sd">        if True, creat and save plot</span>
<span class="sd">    fmt : str</span>
<span class="sd">        format of saved figure (default is &#39;pdf&#39;)</span>
<span class="sd">    </span>
<span class="sd">    Returns: </span>
<span class="sd">        B (in uT)</span>
<span class="sd">        standard error of slope</span>
<span class="sd">        axa, axb    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span> 
        <span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="s2">&quot; You must install seaborn to use this &quot;</span> 
        <span class="k">return</span> <span class="kc">False</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span> <span class="n">axa</span><span class="p">,</span> <span class="n">axb</span>
    <span class="k">try</span><span class="p">:</span> 
        <span class="kn">import</span> <span class="nn">scipy.stats</span> <span class="k">as</span> <span class="nn">stats</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="s2">&quot; You must install scipy &quot;</span> 
        <span class="k">return</span> <span class="kc">False</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span> <span class="n">axa</span><span class="p">,</span> <span class="n">axb</span>
    <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span>
    <span class="k">if</span> <span class="n">axa</span><span class="o">==</span><span class="s2">&quot;&quot;</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
        <span class="n">axa</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span> 
        <span class="n">axb</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span> 
    <span class="n">tinv</span><span class="o">=</span><span class="k">lambda</span> <span class="n">p</span><span class="p">,</span><span class="n">df</span><span class="p">:</span><span class="nb">abs</span><span class="p">(</span><span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">p</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">df</span><span class="p">))</span>
    <span class="n">M1s</span><span class="o">=</span><span class="n">spec_df</span><span class="p">[(</span><span class="n">spec_df</span><span class="p">[</span><span class="s1">&#39;method_codes&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;LT-NRM-PAR&#39;</span><span class="p">))</span><span class="o">&amp;</span>
        <span class="p">(</span><span class="n">spec_df</span><span class="p">[</span><span class="s1">&#39;method_codes&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;LT-PTRM-I&#39;</span><span class="p">)</span><span class="o">==</span><span class="kc">False</span><span class="p">)]</span>

    <span class="n">Mos</span><span class="o">=</span><span class="n">spec_df</span><span class="p">[</span><span class="n">spec_df</span><span class="p">[</span><span class="s1">&#39;method_codes&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;LT-NO&#39;</span><span class="p">)]</span>
    <span class="n">Mos</span><span class="o">=</span><span class="n">Mos</span><span class="p">[</span><span class="s1">&#39;magn_moment&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
    
    <span class="n">Bs_uT</span><span class="o">=</span><span class="n">M1s</span><span class="p">[</span><span class="s1">&#39;treat_dc_field&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">*</span><span class="mf">1e6</span>

    <span class="n">M1s</span><span class="o">=</span><span class="n">M1s</span><span class="p">[</span><span class="s1">&#39;magn_moment&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
    
    <span class="n">M2s</span><span class="o">=</span><span class="n">spec_df</span><span class="p">[</span><span class="n">spec_df</span><span class="p">[</span><span class="s1">&#39;method_codes&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;LT-NRM-APAR&#39;</span><span class="p">)]</span>
    <span class="n">M2s</span><span class="o">=</span><span class="n">M2s</span><span class="p">[</span><span class="s1">&#39;magn_moment&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

    <span class="n">M3s</span><span class="o">=</span><span class="n">spec_df</span><span class="p">[</span><span class="n">spec_df</span><span class="p">[</span><span class="s1">&#39;method_codes&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;LT-T-Z-NRM-PAR&#39;</span><span class="p">)]</span>
    <span class="n">M3s</span><span class="o">=</span><span class="n">M3s</span><span class="p">[</span><span class="s1">&#39;magn_moment&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

    <span class="n">M4s</span><span class="o">=</span><span class="n">spec_df</span><span class="p">[</span><span class="n">spec_df</span><span class="p">[</span><span class="s1">&#39;method_codes&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;LT-PTRM-I&#39;</span><span class="p">)]</span>
    <span class="n">M4s</span><span class="o">=</span><span class="n">M4s</span><span class="p">[</span><span class="s1">&#39;magn_moment&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
    
    <span class="n">Q_DB</span><span class="o">=</span><span class="p">(</span><span class="n">M1s</span><span class="o">-</span><span class="n">Mos</span><span class="p">)</span><span class="o">/</span><span class="n">Mos</span>
    <span class="c1">#coeffs=np.polyfit(Bs_uT,Q_DB,1)</span>
    <span class="c1">#newYs=np.polyval(coeffs,Bs_uT)</span>
    <span class="n">q_data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="n">q_data</span><span class="p">[</span><span class="s1">&#39;Bs_uT&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">Bs_uT</span>
    <span class="n">q_data</span><span class="p">[</span><span class="s1">&#39;Q_DB&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">Q_DB</span>

    <span class="c1">#axa.plot(Bs_uT,Q_DB,&#39;co&#39;)</span>
    <span class="n">axa</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;B$_</span><span class="si">{lab}</span><span class="s1"> (\mu$T)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span> 
    <span class="n">axa</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Q_$</span><span class="si">{DB}</span><span class="s1">$: &#39;</span><span class="o">+</span><span class="n">site</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>


    <span class="c1">#axa.plot(Bs_uT,newYs,&#39;k-&#39;)</span>
    <span class="n">axa</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dotted&#39;</span><span class="p">)</span>
    <span class="n">axa</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">70</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">q_data</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Bs_uT&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;Q_DB&#39;</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">axa</span><span class="p">)</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">.5</span> <span class="c1"># per Fabian and Leonhardt 2010</span>
    <span class="n">Q_DSC</span><span class="o">=</span><span class="mf">2.</span><span class="o">*</span><span class="p">((</span><span class="mf">1.</span><span class="o">+</span><span class="n">alpha</span><span class="p">)</span><span class="o">*</span><span class="n">M1s</span><span class="o">-</span><span class="n">Mos</span><span class="o">-</span><span class="n">alpha</span><span class="o">*</span><span class="n">M3s</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="n">Mos</span><span class="o">-</span><span class="n">M1s</span><span class="o">-</span><span class="n">M2s</span><span class="p">)</span>
<span class="c1">#    print (spec_df[&#39;specimen&#39;].unique())</span>
<span class="c1">#    print (Q_DSC)</span>
    <span class="n">q_data</span><span class="p">[</span><span class="s1">&#39;Q_DSC&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">Q_DSC</span>



    <span class="c1">#axb.plot(Bs_uT,Q_DSC,&#39;co&#39;)</span>
    <span class="n">axb</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;B$_</span><span class="si">{lab}</span><span class="s1"> (\mu$T)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
    <span class="n">axb</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Q_$</span><span class="si">{DSC}</span><span class="s1">$: &#39;</span><span class="o">+</span><span class="n">site</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>

    <span class="c1">#coeffs,cov=np.polyfit(Bs_uT,Q_DSC,1,cov=True)</span>
    
    <span class="n">Brange</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>
    <span class="c1">#newYs=np.polyval(coeffs,Brange)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">q_data</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Bs_uT&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;Q_DSC&#39;</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">axb</span><span class="p">)</span>
    <span class="c1">#axb.plot(Brange,newYs,&#39;k-&#39;)</span>
    <span class="n">axb</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dotted&#39;</span><span class="p">)</span>
    <span class="n">axb</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">70</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
    <span class="c1">#axb.text(.2,.9,&#39;B$_{msp}$=&#39;+str((-coeffs[1]/coeffs[0]).round(1))+&#39; $\mu$T&#39;,</span>
     <span class="c1">#        transform=axb.transAxes,fontsize=fontsize)</span>
    <span class="n">res</span><span class="o">=</span><span class="n">stats</span><span class="o">.</span><span class="n">linregress</span><span class="p">(</span><span class="n">Q_DSC</span><span class="p">,</span><span class="n">Bs_uT</span><span class="p">)</span>
    <span class="n">ts</span><span class="o">=</span><span class="n">tinv</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">Q_DSC</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">axb</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">.1</span><span class="p">,</span><span class="mf">.9</span><span class="p">,</span><span class="sa">f</span><span class="s1">&#39;Bmsp =: </span><span class="si">{</span><span class="n">res</span><span class="o">.</span><span class="n">intercept</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1"> $\pm$  </span><span class="si">{</span><span class="mf">.5</span><span class="o">*</span><span class="n">ts</span><span class="o">*</span><span class="n">res</span><span class="o">.</span><span class="n">intercept_stderr</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1"> $\mu$T&#39;</span><span class="p">,</span>
    <span class="c1">#axb.text(.1,.9,f&#39;Bmsp =: {res.intercept:.1f} $\pm$  {res.intercept_stderr:.1f} $\mu$T&#39;,</span>
            <span class="n">transform</span><span class="o">=</span><span class="n">axb</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;intercept (1 sigma): </span><span class="si">{</span><span class="n">res</span><span class="o">.</span><span class="n">intercept</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> +/- </span><span class="si">{</span><span class="n">res</span><span class="o">.</span><span class="n">intercept_stderr</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="c1">#axb.plot([res.intercept+.5*ts*res.intercept_stderr],[0],&#39;b+&#39;)</span>
    <span class="c1">#axb.plot([res.intercept-.5*ts*res.intercept_stderr],[0],&#39;b+&#39;)    </span>
    <span class="n">axa</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">.9</span><span class="p">,</span><span class="mf">.1</span><span class="p">,</span><span class="n">labels</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">axa</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
    <span class="n">axb</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">.9</span><span class="p">,</span><span class="mf">.1</span><span class="p">,</span><span class="n">labels</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">axb</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">save_plots</span><span class="p">:</span> 
        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;site.&#39;</span><span class="o">+</span><span class="n">fmt</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">res</span><span class="o">.</span><span class="n">intercept</span><span class="p">,</span><span class="mf">.5</span><span class="o">*</span><span class="n">ts</span><span class="o">*</span><span class="n">res</span><span class="o">.</span><span class="n">intercept_stderr</span><span class="p">,</span><span class="n">res</span><span class="o">.</span><span class="n">intercept_stderr</span><span class="p">,</span><span class="n">axa</span><span class="p">,</span><span class="n">axb</span></div>

</pre></div>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By PmagPy Contributors<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>