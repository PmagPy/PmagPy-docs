
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>pmagpy.pmag &#8212; PmagPy Documentation</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/pmagpy_logo_notext.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">PmagPy Documentation</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    PmagPy: An open source package for paleomagnetic data analysis
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Installation
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../installation/PmagPy_install.html">
   Installing
   <strong>
    PmagPy
   </strong>
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../installation/osx_pip.html">
     OSX pip install
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../installation/osx_developer.html">
     OSX developer install
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../installation/windows_pip.html">
     Windows pip install
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../installation/windows_developer.html">
     Windows developer install
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../installation/linux_pip.html">
     Linux pip install
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../installation/linux_developer.html">
     Linux developer install
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../installation/troubleshooting.html">
     Troubleshooting installation issues
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../programs/command_line_programs.html">
     Command line programs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../programs/pmag_gui.html">
   Installing and Getting Started with Pmag GUI
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../programs/demag_gui.html">
     Demag GUI
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../programs/thellier_gui.html">
     Thellier GUI
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../resources/survival_skills.html">
   Survival computer skills
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Documentation notebooks
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../documentation_notebooks/Jupyter.html">
   Jupyter Notebooks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../documentation_notebooks/PmagPy_introduction.html">
   Introduction to PmagPy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../documentation_notebooks/PmagPy_calculations.html">
   Calculations with PmagPy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../documentation_notebooks/PmagPy_plots_analysis.html">
   Visualizations and more analysis with PmagPy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../documentation_notebooks/PmagPy_MagIC.html">
   Working with the MagIC database using PmagPy
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Example notebooks
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../example_notebooks/example_notebooks.html">
   Example notebooks
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../example_notebooks/Tauxe_etal_2016.html">
     Tauxe et al. 2016 example notebook
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  MagIC
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../MagIC/MagIC.html">
   MagIC database and file formats
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Function docstrings
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../api/api.html">
   API Reference
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  References
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../references.html">
   References
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/pmagpy/pmagpy-docs"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/pmagpy/pmagpy-docs/issues/new?title=Issue%20on%20page%20%2F_modules/pmagpy/pmag.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1></h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <h1>Source code for pmagpy.pmag</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">codecs</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">string</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="kn">from</span> <span class="nn">past.utils</span> <span class="kn">import</span> <span class="n">old_div</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">random</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">linalg</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">.mapping</span> <span class="kn">import</span> <span class="n">map_magic</span>
<span class="kn">from</span> <span class="nn">pmagpy</span> <span class="kn">import</span> <span class="n">contribution_builder</span> <span class="k">as</span> <span class="n">cb</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">find_pmag_dir</span>
<span class="kn">from</span> <span class="nn">pmag_env</span> <span class="kn">import</span> <span class="n">set_env</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">SPD.lib.leastsq_jacobian</span> <span class="k">as</span> <span class="nn">lib_k</span>

<span class="n">WARNINGS</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;basemap&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;cartopy&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>


<div class="viewcode-block" id="get_version"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.get_version">[docs]</a><span class="k">def</span> <span class="nf">get_version</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Determines the version of PmagPy installed on your machine.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    version : string of pmagpy version, such as &quot;pmagpy-3.8.8&quot;</span>
<span class="sd">        </span>
<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; pmag.get_version()</span>
<span class="sd">    &#39;pmagpy-4.2.106&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">version</span> <span class="o">=</span> <span class="n">find_pmag_dir</span><span class="o">.</span><span class="n">get_version</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">version</span></div>


<div class="viewcode-block" id="sort_diclist"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.sort_diclist">[docs]</a><span class="k">def</span> <span class="nf">sort_diclist</span><span class="p">(</span><span class="n">undecorated</span><span class="p">,</span> <span class="n">sort_on</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sort a list of dictionaries by the value in each dictionary for the sorting key.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    undecorated : list of dicts</span>
<span class="sd">    sort_on : str, numeric</span>
<span class="sd">        key that is present in all dicts to sort on</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Ordered list of dicts</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; lst = [{&#39;key1&#39;: 10, &#39;key2&#39;: 2}, {&#39;key1&#39;: 1, &#39;key2&#39;: 20}]</span>
<span class="sd">    &gt;&gt;&gt; sort_diclist(lst, &#39;key1&#39;)</span>
<span class="sd">    [{&#39;key2&#39;: 20, &#39;key1&#39;: 1}, {&#39;key2&#39;: 2, &#39;key1&#39;: 10}]</span>
<span class="sd">    &gt;&gt;&gt; sort_diclist(lst, &#39;key2&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">decorated</span> <span class="o">=</span> <span class="p">[(</span><span class="nb">len</span><span class="p">(</span><span class="n">dict_</span><span class="p">[</span><span class="n">sort_on</span><span class="p">])</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">dict_</span><span class="p">[</span><span class="n">sort_on</span><span class="p">],</span> <span class="s1">&#39;__len__&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="n">dict_</span><span class="p">[</span>
                  <span class="n">sort_on</span><span class="p">],</span> <span class="n">index</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">dict_</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">undecorated</span><span class="p">)]</span>
    <span class="n">decorated</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="k">return</span><span class="p">[</span><span class="n">undecorated</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="k">for</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span> <span class="ow">in</span> <span class="n">decorated</span><span class="p">]</span></div>


<div class="viewcode-block" id="get_dictitem"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.get_dictitem">[docs]</a><span class="k">def</span> <span class="nf">get_dictitem</span><span class="p">(</span><span class="n">In</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">flag</span><span class="p">,</span> <span class="n">float_to_int</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; </span>
<span class="sd">    Returns a list of dictionaries from list In with key (k)  = value (v) . </span>
<span class="sd">    </span>
<span class="sd">    CASE INSENSITIVE # allowed keywords:</span>
<span class="sd">        requires that the value of k in the dictionaries contained in In be castable to string and requires that v be castable to a string if flag is T,F, </span>
<span class="sd">        has or not and requires they be castable to float if flag is eval, min, or max.</span>
<span class="sd">        float_to_int goes through the relvant values in In and truncates them,</span>
<span class="sd">        (like &quot;0.0&quot; to &quot;0&quot;) for evaluation, default is False</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    In : list of dictionaries</span>
<span class="sd">    k : key to test</span>
<span class="sd">    v : key value to test</span>
<span class="sd">    flag : [T,F,has, or not]</span>
<span class="sd">    float_to int : if True, truncates to integer</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    List of dictionaries that meet conditions</span>
<span class="sd">        </span>
<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; In=[{&#39;specimen&#39;:&#39;abc01b01&#39;,&#39;dec&#39;:&#39;10.3&#39;,&#39;inc&#39;:&#39;43&#39;,&#39;int&#39;:&#39;5.2e-6&#39;},  </span>
<span class="sd">         {&#39;specimen&#39;:&#39;abc01b02&#39;,&#39;dec&#39;:&#39;12.3&#39;,&#39;inc&#39;:&#39;42&#39;,&#39;int&#39;:&#39;4.9e-6&#39;}]</span>
<span class="sd">    &gt;&gt;&gt; k = &#39;specimen&#39;</span>
<span class="sd">    &gt;&gt;&gt; v = &#39;abc01b02&#39;</span>
<span class="sd">    &gt;&gt;&gt; flag=&#39;T&#39;</span>
<span class="sd">    &gt;&gt;&gt; get_dictitem(In,k,v,flag)</span>
<span class="sd">    [{&#39;specimen&#39;: &#39;abc01b02&#39;, &#39;dec&#39;: &#39;12.3&#39;, &#39;inc&#39;: &#39;42&#39;, &#39;int&#39;: &#39;4.9e-6&#39;}]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">float_to_int</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">v</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">trunc</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">v</span><span class="p">)))</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>  <span class="c1"># catches non floatable strings</span>
            <span class="k">pass</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>  <span class="c1"># catches None</span>
            <span class="k">pass</span>
        <span class="n">fixed_In</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">dictionary</span> <span class="ow">in</span> <span class="n">In</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">dictionary</span><span class="p">:</span>
                <span class="n">val</span> <span class="o">=</span> <span class="n">dictionary</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">val</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">trunc</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">val</span><span class="p">)))</span>
                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>  <span class="c1"># catches non floatable strings</span>
                    <span class="k">pass</span>
                <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>  <span class="c1"># catches None</span>
                    <span class="k">pass</span>
                <span class="n">dictionary</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
            <span class="n">fixed_In</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dictionary</span><span class="p">)</span>
        <span class="n">In</span> <span class="o">=</span> <span class="n">fixed_In</span>
    <span class="k">if</span> <span class="n">flag</span> <span class="o">==</span> <span class="s2">&quot;T&quot;</span><span class="p">:</span>
        <span class="c1"># return that which is</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">dictionary</span> <span class="k">for</span> <span class="n">dictionary</span> <span class="ow">in</span> <span class="n">In</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">dictionary</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="nb">str</span><span class="p">(</span><span class="n">dictionary</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span>
    <span class="k">if</span> <span class="n">flag</span> <span class="o">==</span> <span class="s2">&quot;F&quot;</span><span class="p">:</span>
        <span class="c1"># return that which is not</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">dictionary</span> <span class="k">for</span> <span class="n">dictionary</span> <span class="ow">in</span> <span class="n">In</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">dictionary</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="nb">str</span><span class="p">(</span><span class="n">dictionary</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">!=</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span>
    <span class="k">if</span> <span class="n">flag</span> <span class="o">==</span> <span class="s2">&quot;has&quot;</span><span class="p">:</span>
        <span class="c1"># return that which is contained</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">dictionary</span> <span class="k">for</span> <span class="n">dictionary</span> <span class="ow">in</span> <span class="n">In</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">dictionary</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">dictionary</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span>
    <span class="k">if</span> <span class="n">flag</span> <span class="o">==</span> <span class="s2">&quot;not&quot;</span><span class="p">:</span>
        <span class="c1"># return that which is not contained</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">dictionary</span> <span class="k">for</span> <span class="n">dictionary</span> <span class="ow">in</span> <span class="n">In</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">dictionary</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">dictionary</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span>
    <span class="k">if</span> <span class="n">flag</span> <span class="o">==</span> <span class="s2">&quot;eval&quot;</span><span class="p">:</span>
        <span class="n">A</span> <span class="o">=</span> <span class="p">[</span><span class="n">dictionary</span> <span class="k">for</span> <span class="n">dictionary</span> <span class="ow">in</span> <span class="n">In</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">dictionary</span><span class="o">.</span><span class="n">keys</span><span class="p">(</span>
        <span class="p">))</span> <span class="ow">and</span> <span class="n">dictionary</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">]</span>  <span class="c1"># find records with no blank values for key</span>
        <span class="c1"># return that which is</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">dictionary</span> <span class="k">for</span> <span class="n">dictionary</span> <span class="ow">in</span> <span class="n">A</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">dictionary</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="nb">float</span><span class="p">(</span><span class="n">dictionary</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">==</span> <span class="nb">float</span><span class="p">(</span><span class="n">v</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">flag</span> <span class="o">==</span> <span class="s2">&quot;min&quot;</span><span class="p">:</span>
        <span class="n">A</span> <span class="o">=</span> <span class="p">[</span><span class="n">dictionary</span> <span class="k">for</span> <span class="n">dictionary</span> <span class="ow">in</span> <span class="n">In</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">dictionary</span><span class="o">.</span><span class="n">keys</span><span class="p">(</span>
        <span class="p">))</span> <span class="ow">and</span> <span class="n">dictionary</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">]</span>  <span class="c1"># find records with no blank values for key</span>
        <span class="c1"># return that which is greater than</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">dictionary</span> <span class="k">for</span> <span class="n">dictionary</span> <span class="ow">in</span> <span class="n">A</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">dictionary</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="nb">float</span><span class="p">(</span><span class="n">dictionary</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="nb">float</span><span class="p">(</span><span class="n">v</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">flag</span> <span class="o">==</span> <span class="s2">&quot;max&quot;</span><span class="p">:</span>
        <span class="n">A</span> <span class="o">=</span> <span class="p">[</span><span class="n">dictionary</span> <span class="k">for</span> <span class="n">dictionary</span> <span class="ow">in</span> <span class="n">In</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">dictionary</span><span class="o">.</span><span class="n">keys</span><span class="p">(</span>
        <span class="p">))</span> <span class="ow">and</span> <span class="n">dictionary</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">]</span>  <span class="c1"># find records with no blank values for key</span>
        <span class="c1"># return that which is less than</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">dictionary</span> <span class="k">for</span> <span class="n">dictionary</span> <span class="ow">in</span> <span class="n">A</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">dictionary</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="nb">float</span><span class="p">(</span><span class="n">dictionary</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="nb">float</span><span class="p">(</span><span class="n">v</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">flag</span> <span class="o">==</span> <span class="s1">&#39;not_null&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">dictionary</span> <span class="k">for</span> <span class="n">dictionary</span> <span class="ow">in</span> <span class="n">In</span> <span class="k">if</span> <span class="n">dictionary</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span></div>


<div class="viewcode-block" id="get_dictkey"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.get_dictkey">[docs]</a><span class="k">def</span> <span class="nf">get_dictkey</span><span class="p">(</span><span class="n">In</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">dtype</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns list of given key (k) from input list of dictionaries (In) in data typed dtype.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    In : list of dictionaries to work on</span>
<span class="sd">    k : key to return</span>
<span class="sd">    dtype : str</span>
<span class="sd">        &quot;&quot; : returns string value</span>
<span class="sd">        &quot;f&quot; : returns float</span>
<span class="sd">        &quot;int&quot; : returns integer</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Out : List of values of the key specified to return</span>
<span class="sd">        </span>
<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; In=[{&#39;specimen&#39;:&#39;abc01b01&#39;,&#39;dec&#39;:&#39;10.3&#39;,&#39;inc&#39;:&#39;43&#39;,&#39;int&#39;:&#39;5.2e-6&#39;},  </span>
<span class="sd">         {&#39;specimen&#39;:&#39;abc01b02&#39;,&#39;dec&#39;:&#39;12.3&#39;,&#39;inc&#39;:&#39;42&#39;,&#39;int&#39;:&#39;4.9e-6&#39;}]</span>
<span class="sd">    &gt;&gt;&gt; k = &#39;specimen&#39;</span>
<span class="sd">    &gt;&gt;&gt; dtype = &#39;&#39;</span>
<span class="sd">    &gt;&gt;&gt; get_dictkey(In,k,dtype)</span>
<span class="sd">    [&#39;abc01b01&#39;, &#39;abc01b02&#39;]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Out</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">In</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">dtype</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="n">Out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">dtype</span> <span class="o">==</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">d</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">Out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">d</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">Out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">Out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span>
        <span class="k">if</span> <span class="n">dtype</span> <span class="o">==</span> <span class="s1">&#39;int&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">d</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">Out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">d</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">Out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">Out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span>
    <span class="k">return</span> <span class="n">Out</span></div>


<div class="viewcode-block" id="find"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.find">[docs]</a><span class="k">def</span> <span class="nf">find</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">seq</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns input value (f) if it is in the given array (seq). </span>
<span class="sd">    </span>
<span class="sd">    Parameters </span>
<span class="sd">    ----------</span>
<span class="sd">    f : string value</span>
<span class="sd">    seq : array of strings</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    String value &#39;f&#39; if it is found in seq.</span>
<span class="sd">        </span>
<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; A = [&#39;11&#39;, &#39;12&#39;, &#39;13&#39;, &#39;14&#39;]</span>
<span class="sd">    &gt;&gt;&gt; find(&#39;11&#39;,A)</span>
<span class="sd">    &#39;11&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">seq</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">item</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">item</span>
    <span class="k">return</span> <span class="s2">&quot;&quot;</span></div>


<div class="viewcode-block" id="get_orient"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.get_orient">[docs]</a><span class="k">def</span> <span class="nf">get_orient</span><span class="p">(</span><span class="n">samp_data</span><span class="p">,</span> <span class="n">er_sample_name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns orientation and orientation method of input sample (er_sample_name). </span>
<span class="sd">    </span>
<span class="sd">    Parameters </span>
<span class="sd">    ----------</span>
<span class="sd">    samp_data : PmagPy list of dicts or pandas DataFrame</span>
<span class="sd">    er_sample_name : string for the sample name</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Orientation data and corresponding orientation method of specified sample (er_sample_name).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">samp_data</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
        <span class="n">samp_data</span> <span class="o">=</span> <span class="p">(</span><span class="n">samp_data</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">dict</span><span class="p">))</span>
    <span class="c1"># set orientation priorities</span>
    <span class="n">EX</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;SO-ASC&quot;</span><span class="p">,</span> <span class="s2">&quot;SO-POM&quot;</span><span class="p">]</span>
    <span class="n">samp_key</span><span class="p">,</span> <span class="n">az_key</span><span class="p">,</span> <span class="n">dip_key</span> <span class="o">=</span> <span class="s1">&#39;er_sample_name&#39;</span><span class="p">,</span> <span class="s1">&#39;sample_azimuth&#39;</span><span class="p">,</span> <span class="s1">&#39;sample_dip&#39;</span>
    <span class="n">disc_key</span><span class="p">,</span> <span class="n">or_key</span><span class="p">,</span> <span class="n">meth_key</span> <span class="o">=</span> <span class="s1">&#39;sample_description&#39;</span><span class="p">,</span> <span class="s1">&#39;sample_orientation_flag&#39;</span><span class="p">,</span>\
        <span class="s1">&#39;magic_method_codes&#39;</span>
    <span class="k">if</span> <span class="s1">&#39;data_model&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;data_model&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">samp_key</span><span class="p">,</span> <span class="n">az_key</span><span class="p">,</span> <span class="n">dip_key</span> <span class="o">=</span> <span class="s1">&#39;sample&#39;</span><span class="p">,</span> <span class="s1">&#39;azimuth&#39;</span><span class="p">,</span> <span class="s1">&#39;dip&#39;</span>
        <span class="n">disc_key</span><span class="p">,</span> <span class="n">or_key</span><span class="p">,</span> <span class="n">meth_key</span> <span class="o">=</span> <span class="s1">&#39;description&#39;</span><span class="p">,</span> <span class="s1">&#39;orientation_quality&#39;</span><span class="p">,</span>\
            <span class="s1">&#39;method_codes&#39;</span>
    <span class="n">orient</span> <span class="o">=</span> <span class="p">{</span><span class="n">samp_key</span><span class="p">:</span> <span class="n">er_sample_name</span><span class="p">,</span> <span class="n">az_key</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
              <span class="n">dip_key</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">disc_key</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">}</span>
    <span class="c1"># get all the orientation data for this sample</span>
    <span class="n">orients</span> <span class="o">=</span> <span class="n">get_dictitem</span><span class="p">(</span><span class="n">samp_data</span><span class="p">,</span> <span class="n">samp_key</span><span class="p">,</span> <span class="n">er_sample_name</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">orients</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">or_key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">orients</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="c1"># exclude all samples with bad orientation flag</span>
        <span class="n">orients</span> <span class="o">=</span> <span class="n">get_dictitem</span><span class="p">(</span><span class="n">orients</span><span class="p">,</span> <span class="n">or_key</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">orients</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">orient</span> <span class="o">=</span> <span class="n">orients</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># re-initialize to first one</span>
    <span class="n">methods</span> <span class="o">=</span> <span class="n">get_dictitem</span><span class="p">(</span><span class="n">orients</span><span class="p">,</span> <span class="n">meth_key</span><span class="p">,</span> <span class="s1">&#39;SO-&#39;</span><span class="p">,</span> <span class="s1">&#39;has&#39;</span><span class="p">)</span>
    <span class="c1"># get a list of all orientation methods for this sample</span>
    <span class="n">methods</span> <span class="o">=</span> <span class="n">get_dictkey</span><span class="p">(</span><span class="n">methods</span><span class="p">,</span> <span class="n">meth_key</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">SO_methods</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">methcode</span> <span class="ow">in</span> <span class="n">methods</span><span class="p">:</span>
        <span class="n">meths</span> <span class="o">=</span> <span class="n">methcode</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">meth</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">meth</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">EX</span><span class="p">)</span> <span class="ow">and</span> <span class="n">meth</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;SO-&#39;</span><span class="p">):</span>
                <span class="n">SO_methods</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">meth</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
    <span class="c1"># find top priority orientation method</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">SO_methods</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;no orientation data for sample &quot;</span><span class="p">,</span> <span class="n">er_sample_name</span><span class="p">)</span>
        <span class="c1"># preserve meta-data anyway even though orientation is bad</span>
<span class="c1"># get all the orientation data for this sample</span>
        <span class="n">orig_data</span> <span class="o">=</span> <span class="n">get_dictitem</span><span class="p">(</span><span class="n">samp_data</span><span class="p">,</span> <span class="n">samp_key</span><span class="p">,</span> <span class="n">er_sample_name</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">orig_data</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">orig_data</span> <span class="o">=</span> <span class="n">orig_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">orig_data</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">az_type</span> <span class="o">=</span> <span class="s2">&quot;SO-NO&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">SO_priorities</span> <span class="o">=</span> <span class="n">set_priorities</span><span class="p">(</span><span class="n">SO_methods</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">az_type</span> <span class="o">=</span> <span class="n">SO_methods</span><span class="p">[</span><span class="n">SO_methods</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">SO_priorities</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
        <span class="n">orient</span> <span class="o">=</span> <span class="n">get_dictitem</span><span class="p">(</span><span class="n">orients</span><span class="p">,</span> <span class="n">meth_key</span><span class="p">,</span> <span class="n">az_type</span><span class="p">,</span> <span class="s1">&#39;has&#39;</span><span class="p">)[</span>
            <span class="mi">0</span><span class="p">]</span>  <span class="c1"># re-initialize to best one</span>
    <span class="k">return</span> <span class="n">orient</span><span class="p">,</span> <span class="n">az_type</span></div>


<div class="viewcode-block" id="EI"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.EI">[docs]</a><span class="k">def</span> <span class="nf">EI</span><span class="p">(</span><span class="n">inc</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a mean inclination value of a distribution of directions, this</span>
<span class="sd">    function calculates the expected elongation of this distribution using a</span>
<span class="sd">    best-fit polynomial of the TK03 GAD secular variation model (Tauxe and</span>
<span class="sd">    Kent, 2004).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    inc : Integer or float</span>
<span class="sd">        Inclination in degrees.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    elongation : float</span>

<span class="sd">    Examples</span>
<span class="sd">    ---------</span>
<span class="sd">    &gt;&gt;&gt; pmag.EI(20)</span>
<span class="sd">    2.4863973732</span>
<span class="sd">    &gt;&gt;&gt; pmag.EI(90)</span>
<span class="sd">    1.0241570135500004</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">poly_tk03</span> <span class="o">=</span> <span class="p">[</span><span class="mf">3.15976125e-06</span><span class="p">,</span>  <span class="o">-</span><span class="mf">3.52459817e-04</span><span class="p">,</span>  <span class="o">-</span>
                 <span class="mf">1.46641090e-02</span><span class="p">,</span>   <span class="mf">2.89538539e+00</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">poly_tk03</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">inc</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="n">poly_tk03</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">inc</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">poly_tk03</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">inc</span> <span class="o">+</span> <span class="n">poly_tk03</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span></div>


<div class="viewcode-block" id="find_f"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.find_f">[docs]</a><span class="k">def</span> <span class="nf">find_f</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a distribution of directions, this function determines parameters</span>
<span class="sd">    (elongation, inclination, flattening factor, and elongation direction) that</span>
<span class="sd">    are consistent with the TK03 secular variation model.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : array of declination, inclination pairs</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Es : list of elongation values</span>
<span class="sd">    Is : list of inclination values</span>
<span class="sd">    Fs : list of flattening factors</span>
<span class="sd">    V2s : list of elongation directions (relative to the distribution)</span>

<span class="sd">    The function will return a zero list ([0]) for each of these parameters if the directions constitute a pathological distribution.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; directions = np.array([[140,21],[127,23],[142,19],[136,22]])</span>
<span class="sd">    &gt;&gt;&gt; Es, Is, Fs, V2s = pmag.find_f(directions)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.</span>
    <span class="n">Es</span><span class="p">,</span> <span class="n">Is</span><span class="p">,</span> <span class="n">Fs</span><span class="p">,</span> <span class="n">V2s</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">ppars</span> <span class="o">=</span> <span class="n">doprinc</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">D</span> <span class="o">=</span> <span class="n">ppars</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">]</span>
    <span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">Decs</span><span class="p">,</span> <span class="n">Incs</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">transpose</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="n">data</span><span class="o">.</span><span class="n">transpose</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">Tan_Incs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">Incs</span> <span class="o">*</span> <span class="n">rad</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">.01</span><span class="p">):</span>
        <span class="n">U</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">((</span><span class="mf">1.</span><span class="o">/</span><span class="n">f</span><span class="p">)</span> <span class="o">*</span> <span class="n">Tan_Incs</span><span class="p">)</span><span class="o">/</span> <span class="n">rad</span>
        <span class="n">fdata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">Decs</span><span class="p">,</span> <span class="n">U</span><span class="p">])</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
        <span class="n">ppars</span> <span class="o">=</span> <span class="n">doprinc</span><span class="p">(</span><span class="n">fdata</span><span class="p">)</span>
        <span class="n">Fs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="n">Es</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ppars</span><span class="p">[</span><span class="s2">&quot;tau2&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">ppars</span><span class="p">[</span><span class="s2">&quot;tau3&quot;</span><span class="p">])</span>
        <span class="n">ang</span> <span class="o">=</span> <span class="n">angle</span><span class="p">([</span><span class="n">D</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="n">ppars</span><span class="p">[</span><span class="s2">&quot;V2dec&quot;</span><span class="p">],</span> <span class="mi">0</span><span class="p">])</span>
        <span class="k">if</span> <span class="mf">180.</span> <span class="o">-</span> <span class="n">ang</span> <span class="o">&lt;</span> <span class="n">ang</span><span class="p">:</span>
            <span class="n">ang</span> <span class="o">=</span> <span class="mf">180.</span> <span class="o">-</span> <span class="n">ang</span>
        <span class="n">V2s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ang</span><span class="p">)</span>
        <span class="n">Is</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">ppars</span><span class="p">[</span><span class="s2">&quot;inc&quot;</span><span class="p">]))</span>
        <span class="k">if</span> <span class="n">EI</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">ppars</span><span class="p">[</span><span class="s2">&quot;inc&quot;</span><span class="p">]))</span> <span class="o">&lt;=</span> <span class="n">Es</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">del</span> <span class="n">Es</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">del</span> <span class="n">Is</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">del</span> <span class="n">Fs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">del</span> <span class="n">V2s</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">Fs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">Fs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mf">.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">.005</span><span class="p">):</span>
                    <span class="n">U</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">((</span><span class="mf">1.</span><span class="o">/</span> <span class="n">f</span><span class="p">)</span> <span class="o">*</span> <span class="n">Tan_Incs</span><span class="p">)</span><span class="o">/</span> <span class="n">rad</span>
                    <span class="n">fdata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">Decs</span><span class="p">,</span> <span class="n">U</span><span class="p">])</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
                    <span class="n">ppars</span> <span class="o">=</span> <span class="n">doprinc</span><span class="p">(</span><span class="n">fdata</span><span class="p">)</span>
                    <span class="n">Fs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
                    <span class="n">Es</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ppars</span><span class="p">[</span><span class="s2">&quot;tau2&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">ppars</span><span class="p">[</span><span class="s2">&quot;tau3&quot;</span><span class="p">])</span>
                    <span class="n">Is</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">ppars</span><span class="p">[</span><span class="s2">&quot;inc&quot;</span><span class="p">]))</span>
                    <span class="n">ang</span> <span class="o">=</span> <span class="n">angle</span><span class="p">([</span><span class="n">D</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="n">ppars</span><span class="p">[</span><span class="s2">&quot;V2dec&quot;</span><span class="p">],</span> <span class="mi">0</span><span class="p">])</span>
                    <span class="k">if</span> <span class="mf">180.</span> <span class="o">-</span> <span class="n">ang</span> <span class="o">&lt;</span> <span class="n">ang</span><span class="p">:</span>
                        <span class="n">ang</span> <span class="o">=</span> <span class="mf">180.</span> <span class="o">-</span> <span class="n">ang</span>
                    <span class="n">V2s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ang</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">EI</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">ppars</span><span class="p">[</span><span class="s2">&quot;inc&quot;</span><span class="p">]))</span> <span class="o">&lt;=</span> <span class="n">Es</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                        <span class="k">return</span> <span class="n">Es</span><span class="p">,</span> <span class="n">Is</span><span class="p">,</span> <span class="n">Fs</span><span class="p">,</span> <span class="n">V2s</span>
    <span class="k">return</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span></div>


<span class="k">def</span> <span class="nf">cooling_rate</span><span class="p">(</span><span class="n">SpecRec</span><span class="p">,</span> <span class="n">SampRecs</span><span class="p">,</span> <span class="n">crfrac</span><span class="p">,</span> <span class="n">crtype</span><span class="p">):</span>
    <span class="n">CrSpecRec</span><span class="p">,</span> <span class="n">frac</span><span class="p">,</span> <span class="n">crmcd</span> <span class="o">=</span> <span class="p">{},</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;DA-CR&#39;</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">SpecRec</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="n">CrSpecRec</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">SpecRec</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">SampRecs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">frac</span> <span class="o">=</span> <span class="mf">.01</span> <span class="o">*</span> <span class="nb">float</span><span class="p">(</span><span class="n">SampRecs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;cooling_rate_corr&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="s1">&#39;DA-CR&#39;</span> <span class="ow">in</span> <span class="n">SampRecs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;cooling_rate_mcd&#39;</span><span class="p">]:</span>
            <span class="n">crmcd</span> <span class="o">=</span> <span class="n">SampRecs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;cooling_rate_mcd&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">crmcd</span> <span class="o">=</span> <span class="s1">&#39;DA-CR&#39;</span>
    <span class="k">elif</span> <span class="n">crfrac</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">frac</span> <span class="o">=</span> <span class="n">crfrac</span>
        <span class="n">crmcd</span> <span class="o">=</span> <span class="n">crtype</span>
    <span class="k">if</span> <span class="n">frac</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">inten</span> <span class="o">=</span> <span class="n">frac</span> <span class="o">*</span> <span class="nb">float</span><span class="p">(</span><span class="n">CrSpecRec</span><span class="p">[</span><span class="s1">&#39;specimen_int&#39;</span><span class="p">])</span>
        <span class="c1"># adjust specimen intensity by cooling rate correction</span>
        <span class="n">CrSpecRec</span><span class="p">[</span><span class="s2">&quot;specimen_int&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%9.4e</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">inten</span><span class="p">)</span>
        <span class="n">CrSpecRec</span><span class="p">[</span><span class="s1">&#39;magic_method_codes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">CrSpecRec</span><span class="p">[</span><span class="s1">&#39;magic_method_codes&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;:crmcd&#39;</span>
        <span class="n">CrSpecRec</span><span class="p">[</span><span class="s2">&quot;specimen_correction&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;c&#39;</span>
        <span class="k">return</span> <span class="n">CrSpecRec</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[]</span>


<div class="viewcode-block" id="convert_lat"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.convert_lat">[docs]</a><span class="k">def</span> <span class="nf">convert_lat</span><span class="p">(</span><span class="n">Recs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Uses lat, for age&lt;5Ma, model_lat if present, else tries to use average_inc to estimate plat.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Recs : list of dictionaries in data model by data_model</span>
<span class="sd">        This list of dictionaries must only include data with ages less than 5 Ma</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    New : list of dictionaries with plat estimate</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">New</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">Recs</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;model_lat&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="n">rec</span><span class="p">[</span><span class="s1">&#39;model_lat&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">New</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">)</span>
        <span class="k">elif</span> <span class="s1">&#39;average_age&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="n">rec</span><span class="p">[</span><span class="s1">&#39;average_age&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span> <span class="ow">and</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s1">&#39;average_age&#39;</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="mf">5.</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;site_lat&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="n">rec</span><span class="p">[</span><span class="s1">&#39;site_lat&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">rec</span><span class="p">[</span><span class="s1">&#39;model_lat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="s1">&#39;site_lat&#39;</span><span class="p">]</span>
                <span class="n">New</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">)</span>
        <span class="k">elif</span> <span class="s1">&#39;average_inc&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="n">rec</span><span class="p">[</span><span class="s1">&#39;average_inc&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">rec</span><span class="p">[</span><span class="s1">&#39;model_lat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%7.1f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">plat</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s1">&#39;average_inc&#39;</span><span class="p">])))</span>
            <span class="n">New</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">New</span></div>


<div class="viewcode-block" id="convert_ages"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.convert_ages">[docs]</a><span class="k">def</span> <span class="nf">convert_ages</span><span class="p">(</span><span class="n">Recs</span><span class="p">,</span> <span class="n">data_model</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts ages in a list of dictionaries to units of Millions of years ago, Ma. </span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Recs : list of dictionaries in data model by data_model</span>
<span class="sd">    data_model : MagIC data model (default is 3)</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    New : list of dictionaries with the converted ages</span>
<span class="sd">    </span>
<span class="sd">    Examples </span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; sites = pd.read_csv(&#39;data_files/convert_ages/sites.txt&#39;,sep=&#39;\t&#39;,header=1) # create a dataframe from example file</span>
<span class="sd">    &gt;&gt;&gt; sites_age = sites.dropna(subset=[&#39;age&#39;])     # drop all rows that have nan in the age column since our function does not work with nans</span>
<span class="sd">    &gt;&gt;&gt; sites_dict = sites_age.to_dict(&#39;records&#39;)    # &#39;records&#39; to return list like values within dict</span>
<span class="sd">    &gt;&gt;&gt; sites_ages_converted = pmag.convert_ages(sites_dict)</span>
<span class="sd">    &gt;&gt;&gt; sites_ages_converted_df = pd.DataFrame.from_dict(sites_ages_converted)   # convert new age converted list of dictionaries back to a dataframe</span>
<span class="sd">    &gt;&gt;&gt; print(&#39;ORIGINAL FILE: \n&#39;,sites_age[&#39;age&#39;].head())</span>
<span class="sd">    &gt;&gt;&gt; print(&#39;CONVERTED AGES FILE: \n&#39;,sites_ages_converted_df[&#39;age&#39;].head());   </span>
<span class="sd">    ORIGINAL FILE: </span>
<span class="sd">    1    100.0</span>
<span class="sd">    3    625.0</span>
<span class="sd">    5    625.0</span>
<span class="sd">    7    750.0</span>
<span class="sd">    9    800.0</span>
<span class="sd">    Name: age, dtype: float64</span>
<span class="sd">    CONVERTED AGES FILE: </span>
<span class="sd">     0    1.9110e-03</span>
<span class="sd">    1    1.3860e-03</span>
<span class="sd">    2    1.3860e-03</span>
<span class="sd">    3    1.2610e-03</span>
<span class="sd">    4    1.2110e-03</span>
<span class="sd">    Name: age, dtype: object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">data_model</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">site_key</span> <span class="o">=</span> <span class="s1">&#39;site&#39;</span>
        <span class="n">agekey</span> <span class="o">=</span> <span class="s2">&quot;age&quot;</span>
        <span class="n">keybase</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">site_key</span> <span class="o">=</span> <span class="s1">&#39;er_site_names&#39;</span>
        <span class="n">agekey</span> <span class="o">=</span> <span class="n">find</span><span class="p">(</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
        <span class="k">if</span> <span class="n">agekey</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">keybase</span> <span class="o">=</span> <span class="n">agekey</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span>

    <span class="n">New</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">Recs</span><span class="p">:</span>
        <span class="n">age</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="n">rec</span><span class="p">[</span><span class="n">keybase</span> <span class="o">+</span> <span class="s1">&#39;age&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">age</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="n">keybase</span> <span class="o">+</span> <span class="s2">&quot;age&quot;</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">rec</span><span class="p">[</span><span class="n">keybase</span> <span class="o">+</span> <span class="s1">&#39;age_low&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span> <span class="ow">and</span> <span class="n">rec</span><span class="p">[</span><span class="n">keybase</span> <span class="o">+</span> <span class="s1">&#39;age_high&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="n">age</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">rec</span><span class="p">[</span><span class="n">keybase</span> <span class="o">+</span> <span class="s1">&#39;age_high&#39;</span><span class="p">],</span>
                           <span class="n">rec</span><span class="p">[</span><span class="n">keybase</span> <span class="o">+</span> <span class="s2">&quot;age_low&quot;</span><span class="p">]])</span>
        <span class="k">if</span> <span class="n">age</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="n">rec</span><span class="p">[</span><span class="n">keybase</span> <span class="o">+</span> <span class="s1">&#39;age_unit&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">rec</span><span class="p">[</span><span class="n">keybase</span> <span class="o">+</span> <span class="s1">&#39;age_unit&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Ma&#39;</span><span class="p">:</span>
                <span class="n">rec</span><span class="p">[</span><span class="n">keybase</span> <span class="o">+</span> <span class="s1">&#39;age&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%10.4e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">age</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">rec</span><span class="p">[</span><span class="n">keybase</span> <span class="o">+</span> <span class="s1">&#39;age_unit&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;ka&#39;</span> <span class="ow">or</span> <span class="n">rec</span><span class="p">[</span><span class="n">keybase</span> <span class="o">+</span> <span class="s1">&#39;age_unit&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Ka&#39;</span><span class="p">:</span>
                <span class="n">rec</span><span class="p">[</span><span class="n">keybase</span> <span class="o">+</span> <span class="s1">&#39;age&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%10.4e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">age</span> <span class="o">*</span> <span class="mf">.001</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">rec</span><span class="p">[</span><span class="n">keybase</span> <span class="o">+</span> <span class="s1">&#39;age_unit&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Years AD (+/-)&#39;</span><span class="p">:</span>
                <span class="n">rec</span><span class="p">[</span><span class="n">keybase</span> <span class="o">+</span> <span class="s1">&#39;age&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%10.4e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">((</span><span class="mi">2011</span> <span class="o">-</span> <span class="n">age</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1e-6</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">rec</span><span class="p">[</span><span class="n">keybase</span> <span class="o">+</span> <span class="s1">&#39;age_unit&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Years BP&#39;</span><span class="p">:</span>
                <span class="n">rec</span><span class="p">[</span><span class="n">keybase</span> <span class="o">+</span> <span class="s1">&#39;age&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%10.4e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">((</span><span class="n">age</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1e-6</span><span class="p">)</span>
            <span class="n">rec</span><span class="p">[</span><span class="n">keybase</span> <span class="o">+</span> <span class="s1">&#39;age_unit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Ma&#39;</span>
            <span class="n">New</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;site_key&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;problem in convert_ages:&#39;</span><span class="p">,</span> <span class="n">rec</span><span class="p">[</span><span class="s1">&#39;site_key&#39;</span><span class="p">])</span>
            <span class="k">elif</span> <span class="s1">&#39;er_site_name&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;problem in convert_ages:&#39;</span><span class="p">,</span> <span class="n">rec</span><span class="p">[</span><span class="s1">&#39;site_key&#39;</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;problem in convert_ages:&#39;</span><span class="p">,</span> <span class="n">rec</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">New</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;no age key:&#39;</span><span class="p">,</span> <span class="n">rec</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">New</span></div>


<span class="c1"># Converting from 2.5 --&gt; 3.0</span>

<span class="k">def</span> <span class="nf">convert_meas_2_to_3</span><span class="p">(</span><span class="n">meas_data_2</span><span class="p">):</span>
    <span class="n">NewMeas</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># step through records</span>
    <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">meas_data_2</span><span class="p">:</span>
        <span class="n">NewMeas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">map_magic</span><span class="o">.</span><span class="n">convert_meas</span><span class="p">(</span><span class="s1">&#39;magic3&#39;</span><span class="p">,</span> <span class="n">rec</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">NewMeas</span>


<div class="viewcode-block" id="convert_items"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.convert_items">[docs]</a><span class="k">def</span> <span class="nf">convert_items</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">mapping</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function maps a given set of dictionsaries to the new given map and outputs an updated dictionary.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : list of dicts (each dict a record for one item)</span>
<span class="sd">    mapping : mapping with column names to swap into the records</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    new_recs : updated list of dicts</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">new_recs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="n">new_rec</span> <span class="o">=</span> <span class="n">map_magic</span><span class="o">.</span><span class="n">mapping</span><span class="p">(</span><span class="n">rec</span><span class="p">,</span> <span class="n">mapping</span><span class="p">)</span>
        <span class="n">new_recs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_rec</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">new_recs</span></div>


<div class="viewcode-block" id="convert_directory_2_to_3"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.convert_directory_2_to_3">[docs]</a><span class="k">def</span> <span class="nf">convert_directory_2_to_3</span><span class="p">(</span><span class="n">meas_fname</span><span class="o">=</span><span class="s2">&quot;magic_measurements.txt&quot;</span><span class="p">,</span> <span class="n">input_dir</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span>
                             <span class="n">output_dir</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">meas_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">data_model</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert 2.0 measurements file into 3.0 measurements file.</span>
<span class="sd">    Merge and convert specimen, sample, site, and location data.</span>
<span class="sd">    Also translates criteria data.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    meas_name : name of measurement file (do not include full path,</span>
<span class="sd">        default is &quot;magic_measurements.txt&quot;)</span>
<span class="sd">    input_dir : name of input directory (default is &quot;.&quot;)</span>
<span class="sd">    output_dir : name of output directory (default is &quot;.&quot;)</span>
<span class="sd">    meas_only : boolean, convert only measurement data (default is False)</span>
<span class="sd">    data_model : data_model3.DataModel object (default is None)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    NewMeas : 3.0 measurements data (output of pmag.convert_items)</span>
<span class="sd">    upgraded : list of files successfully upgraded to 3.0</span>
<span class="sd">    no_upgrade: list of 2.5 files not upgraded to 3.0</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">convert</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;specimens&#39;</span><span class="p">:</span> <span class="n">map_magic</span><span class="o">.</span><span class="n">spec_magic2_2_magic3_map</span><span class="p">,</span>
               <span class="s1">&#39;samples&#39;</span><span class="p">:</span> <span class="n">map_magic</span><span class="o">.</span><span class="n">samp_magic2_2_magic3_map</span><span class="p">,</span>
               <span class="s1">&#39;sites&#39;</span><span class="p">:</span> <span class="n">map_magic</span><span class="o">.</span><span class="n">site_magic2_2_magic3_map</span><span class="p">,</span>
               <span class="s1">&#39;locations&#39;</span><span class="p">:</span> <span class="n">map_magic</span><span class="o">.</span><span class="n">loc_magic2_2_magic3_map</span><span class="p">,</span>
               <span class="s1">&#39;ages&#39;</span><span class="p">:</span> <span class="n">map_magic</span><span class="o">.</span><span class="n">age_magic2_2_magic3_map</span><span class="p">}</span>
    <span class="n">full_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">input_dir</span><span class="p">,</span> <span class="n">meas_fname</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">full_name</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-W- </span><span class="si">{}</span><span class="s2"> is not a file&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">full_name</span><span class="p">))</span>
        <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span>
    <span class="c1"># read in data model 2.5 measurements file</span>
    <span class="n">data2</span><span class="p">,</span> <span class="n">filetype</span> <span class="o">=</span> <span class="n">magic_read</span><span class="p">(</span><span class="n">full_name</span><span class="p">)</span>
    <span class="c1"># convert list of dicts to 3.0</span>
    <span class="n">NewMeas</span> <span class="o">=</span> <span class="n">convert_items</span><span class="p">(</span><span class="n">data2</span><span class="p">,</span> <span class="n">map_magic</span><span class="o">.</span><span class="n">meas_magic2_2_magic3_map</span><span class="p">)</span>
    <span class="c1"># write 3.0 output to file</span>
    <span class="n">ofile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="s1">&#39;measurements.txt&#39;</span><span class="p">)</span>
    <span class="n">magic_write</span><span class="p">(</span><span class="n">ofile</span><span class="p">,</span> <span class="n">NewMeas</span><span class="p">,</span> <span class="s1">&#39;measurements&#39;</span><span class="p">)</span>
    <span class="n">upgraded</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">ofile</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-I- 3.0 format measurements file was successfully created: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ofile</span><span class="p">))</span>
        <span class="n">upgraded</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;measurements.txt&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-W- 3.0 format measurements file could not be created&quot;</span><span class="p">)</span>
    <span class="c1">#</span>
    <span class="n">no_upgrade</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">meas_only</span><span class="p">:</span>
        <span class="c1"># try to convert specimens, samples, sites, &amp; locations</span>
        <span class="k">for</span> <span class="n">dtype</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;specimens&#39;</span><span class="p">,</span> <span class="s1">&#39;samples&#39;</span><span class="p">,</span> <span class="s1">&#39;sites&#39;</span><span class="p">,</span> <span class="s1">&#39;locations&#39;</span><span class="p">,</span> <span class="s1">&#39;ages&#39;</span><span class="p">]:</span>
            <span class="n">mapping</span> <span class="o">=</span> <span class="n">convert</span><span class="p">[</span><span class="n">dtype</span><span class="p">]</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">convert_and_combine_2_to_3</span><span class="p">(</span>
                <span class="n">dtype</span><span class="p">,</span> <span class="n">mapping</span><span class="p">,</span> <span class="n">input_dir</span><span class="p">,</span> <span class="n">output_dir</span><span class="p">,</span> <span class="n">data_model</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">res</span><span class="p">:</span>
                <span class="n">upgraded</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
        <span class="c1"># try to upgrade criteria file</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">input_dir</span><span class="p">,</span> <span class="s1">&#39;pmag_criteria.txt&#39;</span><span class="p">)):</span>
            <span class="n">crit_file</span> <span class="o">=</span> <span class="n">convert_criteria_file_2_to_3</span><span class="p">(</span><span class="n">input_dir</span><span class="o">=</span><span class="n">input_dir</span><span class="p">,</span>
                                                     <span class="n">output_dir</span><span class="o">=</span><span class="n">output_dir</span><span class="p">,</span>
                                                     <span class="n">data_model</span><span class="o">=</span><span class="n">data_model</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">crit_file</span><span class="p">:</span>
                <span class="n">upgraded</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">crit_file</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">no_upgrade</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;pmag_criteria.txt&quot;</span><span class="p">)</span>
        <span class="c1"># create list of all un-upgradeable files</span>
        <span class="k">for</span> <span class="n">fname</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">input_dir</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">fname</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;measurements.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;specimens.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;samples.txt&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;sites.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;locations.txt&#39;</span><span class="p">]:</span>
                <span class="k">continue</span>
            <span class="k">elif</span> <span class="s1">&#39;rmag&#39;</span> <span class="ow">in</span> <span class="n">fname</span><span class="p">:</span>
                <span class="n">no_upgrade</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">fname</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;pmag_results.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;er_synthetics.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;er_images.txt&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;er_plots.txt&#39;</span><span class="p">]:</span>
                <span class="n">no_upgrade</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">NewMeas</span><span class="p">,</span> <span class="n">upgraded</span><span class="p">,</span> <span class="n">no_upgrade</span></div>


<div class="viewcode-block" id="convert_and_combine_2_to_3"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.convert_and_combine_2_to_3">[docs]</a><span class="k">def</span> <span class="nf">convert_and_combine_2_to_3</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="n">map_dict</span><span class="p">,</span> <span class="n">input_dir</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">output_dir</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">data_model</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Read in er_*.txt file and pmag_*.txt file in working directory.</span>
<span class="sd">    Combine the data, then translate headers from 2.5 --&gt; 3.0.</span>
<span class="sd">    Last, write out the data in 3.0.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dtype : string for input type (specimens, samples, sites, etc.)</span>
<span class="sd">    map_dict : dictionary with format {header2_format: header3_format, ...} (from mapping.map_magic module)</span>
<span class="sd">    input_dir : input directory, default &quot;.&quot;</span>
<span class="sd">    output_dir : output directory, default &quot;.&quot;</span>
<span class="sd">    data_model : data_model3.DataModel object, default None</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    output_file_name with 3.0 format data (or None if translation failed)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># read in er_ data &amp; make DataFrame</span>
    <span class="n">er_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">input_dir</span><span class="p">,</span> <span class="s1">&#39;er_</span><span class="si">{}</span><span class="s1">.txt&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dtype</span><span class="p">))</span>
    <span class="n">er_data</span><span class="p">,</span> <span class="n">er_dtype</span> <span class="o">=</span> <span class="n">magic_read</span><span class="p">(</span><span class="n">er_file</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">er_data</span><span class="p">):</span>
        <span class="n">er_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">er_data</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">dtype</span> <span class="o">==</span> <span class="s1">&#39;ages&#39;</span><span class="p">:</span>
            <span class="k">pass</span>
            <span class="c1"># remove records with blank ages</span>
            <span class="c1">#er_data = get_dictitem(er_data, &#39;age&#39;, &#39;&#39;, &quot;F&quot;)</span>
            <span class="c1">#er_df = pd.DataFrame(er_data)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">er_df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">er_df</span><span class="p">[</span><span class="s1">&#39;er_</span><span class="si">{}</span><span class="s1">_name&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dtype</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">er_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="c1">#</span>
    <span class="k">if</span> <span class="n">dtype</span> <span class="o">==</span> <span class="s1">&#39;ages&#39;</span><span class="p">:</span>
        <span class="n">full_df</span> <span class="o">=</span> <span class="n">er_df</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># read in pmag_ data &amp; make DataFrame</span>
        <span class="n">pmag_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">input_dir</span><span class="p">,</span> <span class="s1">&#39;pmag_</span><span class="si">{}</span><span class="s1">.txt&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dtype</span><span class="p">))</span>
        <span class="n">pmag_data</span><span class="p">,</span> <span class="n">pmag_dtype</span> <span class="o">=</span> <span class="n">magic_read</span><span class="p">(</span><span class="n">pmag_file</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pmag_data</span><span class="p">):</span>
            <span class="n">pmag_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pmag_data</span><span class="p">)</span>
            <span class="n">pmag_df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pmag_df</span><span class="p">[</span><span class="s1">&#39;er_</span><span class="si">{}</span><span class="s1">_name&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dtype</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pmag_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
        <span class="c1"># combine the two Dataframes</span>
        <span class="n">full_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">er_df</span><span class="p">,</span> <span class="n">pmag_df</span><span class="p">],</span> <span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># sort the DataFrame so that all records from one item are together</span>
        <span class="n">full_df</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># fix the column names to be 3.0</span>
    <span class="n">full_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">map_dict</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># create a MagicDataFrame object, providing the dataframe and the data type</span>
    <span class="n">new_df</span> <span class="o">=</span> <span class="n">cb</span><span class="o">.</span><span class="n">MagicDataFrame</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">full_df</span><span class="p">,</span> <span class="n">dmodel</span><span class="o">=</span><span class="n">data_model</span><span class="p">)</span>
    <span class="c1"># write out the data to file</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_df</span><span class="o">.</span><span class="n">df</span><span class="p">):</span>
        <span class="n">new_df</span><span class="o">.</span><span class="n">write_magic_file</span><span class="p">(</span><span class="n">dir_path</span><span class="o">=</span><span class="n">output_dir</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">dtype</span> <span class="o">+</span> <span class="s2">&quot;.txt&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-I- No </span><span class="si">{}</span><span class="s2"> data found.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dtype</span><span class="p">))</span>
        <span class="k">return</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="convert_criteria_file_2_to_3"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.convert_criteria_file_2_to_3">[docs]</a><span class="k">def</span> <span class="nf">convert_criteria_file_2_to_3</span><span class="p">(</span><span class="n">fname</span><span class="o">=</span><span class="s2">&quot;pmag_criteria.txt&quot;</span><span class="p">,</span> <span class="n">input_dir</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span>
                                 <span class="n">output_dir</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">data_model</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert a criteria file from 2.5 to 3.0 format and write it out to file</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    fname : string of filename (default &quot;pmag_criteria.txt&quot;)</span>
<span class="sd">    input_dir : string of input directory (default &quot;.&quot;)</span>
<span class="sd">    output_dir : string of output directory (default &quot;.&quot;)</span>
<span class="sd">    data_model : data_model.DataModel object (default None)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    outfile : string output criteria filename, or False</span>
<span class="sd">    crit_container : cb.MagicDataFrame with 3.0 criteria table</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># get criteria from infile</span>
    <span class="n">fname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">input_dir</span><span class="p">,</span> <span class="n">fname</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">fname</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">None</span>
    <span class="n">orig_crit</span><span class="p">,</span> <span class="n">warnings</span> <span class="o">=</span> <span class="n">read_criteria_from_file</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">initialize_acceptance_criteria</span><span class="p">(),</span>
                                                  <span class="n">data_model</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">return_warnings</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">converted_crit</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="c1"># get data model including criteria map</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">data_model</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">data_model3</span> <span class="k">as</span> <span class="n">dm3</span>
        <span class="n">DM</span> <span class="o">=</span> <span class="n">dm3</span><span class="o">.</span><span class="n">DataModel</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">DM</span> <span class="o">=</span> <span class="n">data_model</span>
    <span class="n">crit_map</span> <span class="o">=</span> <span class="n">DM</span><span class="o">.</span><span class="n">crit_map</span>
    <span class="c1"># drop all empty mappings</span>
    <span class="n">stripped_crit_map</span> <span class="o">=</span> <span class="n">crit_map</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;rows&#39;</span><span class="p">)</span>
    <span class="c1"># go through criteria and get 3.0 name and criterion_operation</span>
    <span class="k">for</span> <span class="n">crit</span> <span class="ow">in</span> <span class="n">orig_crit</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">orig_crit</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="o">-</span><span class="mi">999</span><span class="p">,</span> <span class="s1">&#39;-999&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">999.</span><span class="p">]:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">crit</span> <span class="ow">in</span> <span class="n">stripped_crit_map</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
            <span class="n">criterion_operation</span> <span class="o">=</span> <span class="n">stripped_crit_map</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;criteria_map&#39;</span><span class="p">][</span><span class="s1">&#39;criterion_operation&#39;</span><span class="p">]</span>
            <span class="n">table_col</span> <span class="o">=</span> <span class="n">stripped_crit_map</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;criteria_map&#39;</span><span class="p">][</span><span class="s1">&#39;table_column&#39;</span><span class="p">]</span>
            <span class="n">orig_crit</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;criterion_operation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">criterion_operation</span>
            <span class="n">converted_crit</span><span class="p">[</span><span class="n">table_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">orig_crit</span><span class="p">[</span><span class="n">crit</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-W- Could not convert </span><span class="si">{}</span><span class="s1"> to 3.0, skipping&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">crit</span><span class="p">))</span>
    <span class="c1"># switch axes</span>
    <span class="n">converted_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">converted_crit</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
    <span class="c1"># name the index</span>
    <span class="n">converted_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;table_column&quot;</span>
    <span class="c1"># rename columns to 3.0 values</span>
    <span class="c1"># &#39;category&#39; --&gt; criterion (uses defaults from initalize_default_criteria)</span>
    <span class="c1"># &#39;pmag_criteria_code&#39; --&gt; criterion (uses what&#39;s actually in the translated file)</span>
    <span class="n">converted_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;pmag_criteria_code&#39;</span><span class="p">:</span> <span class="s1">&#39;criterion&#39;</span><span class="p">,</span> <span class="s1">&#39;er_citation_names&#39;</span><span class="p">:</span> <span class="s1">&#39;citations&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;criteria_definition&#39;</span><span class="p">:</span> <span class="s1">&#39;description&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;criterion_value&#39;</span><span class="p">},</span>
                        <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># drop unused columns</span>
    <span class="n">valid_cols</span> <span class="o">=</span> <span class="n">DM</span><span class="o">.</span><span class="n">dm</span><span class="p">[</span><span class="s1">&#39;criteria&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
    <span class="n">drop_cols</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">converted_df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">valid_cols</span><span class="p">)</span>
    <span class="n">converted_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">drop_cols</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># move &#39;table_column&#39; from being the index to being a column</span>
    <span class="n">converted_df</span><span class="p">[</span><span class="s1">&#39;table_column&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">converted_df</span><span class="o">.</span><span class="n">index</span>
    <span class="n">crit_container</span> <span class="o">=</span> <span class="n">cb</span><span class="o">.</span><span class="n">MagicDataFrame</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;criteria&#39;</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">converted_df</span><span class="p">)</span>
    <span class="n">crit_container</span><span class="o">.</span><span class="n">write_magic_file</span><span class="p">(</span><span class="n">dir_path</span><span class="o">=</span><span class="n">output_dir</span><span class="p">)</span>
    <span class="k">return</span> <span class="s2">&quot;criteria.txt&quot;</span><span class="p">,</span> <span class="n">crit_container</span></div>


<span class="k">def</span> <span class="nf">getsampVGP</span><span class="p">(</span><span class="n">SampRec</span><span class="p">,</span> <span class="n">SiteNFO</span><span class="p">,</span> <span class="n">data_model</span><span class="o">=</span><span class="mf">2.5</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="n">data_model</span><span class="p">)</span> <span class="o">==</span> <span class="mf">3.0</span><span class="p">:</span>
        <span class="n">site</span> <span class="o">=</span> <span class="n">get_dictitem</span><span class="p">(</span><span class="n">SiteNFO</span><span class="p">,</span> <span class="s1">&#39;site&#39;</span><span class="p">,</span> <span class="n">SampRec</span><span class="p">[</span><span class="s1">&#39;site&#39;</span><span class="p">],</span> <span class="s1">&#39;T&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">site</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">0</span>
            <span class="k">while</span> <span class="n">lat</span> <span class="o">==</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">lon</span> <span class="o">==</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">site</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">site</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">lat</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">site</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;lat&#39;</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">site</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;lon&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">lon</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">site</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;lon&#39;</span><span class="p">])</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lat</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">site</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;lat&#39;</span><span class="p">])</span>
            <span class="n">lon</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">site</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;lon&#39;</span><span class="p">])</span>
        <span class="n">dec</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">SampRec</span><span class="p">[</span><span class="s1">&#39;dir_dec&#39;</span><span class="p">])</span>
        <span class="n">inc</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">SampRec</span><span class="p">[</span><span class="s1">&#39;dir_inc&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">SampRec</span><span class="p">[</span><span class="s1">&#39;dir_alpha95&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">a95</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">SampRec</span><span class="p">[</span><span class="s1">&#39;dir_alpha95&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">a95</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">plon</span><span class="p">,</span> <span class="n">plat</span><span class="p">,</span> <span class="n">dp</span><span class="p">,</span> <span class="n">dm</span> <span class="o">=</span> <span class="n">dia_vgp</span><span class="p">(</span><span class="n">dec</span><span class="p">,</span> <span class="n">inc</span><span class="p">,</span> <span class="n">a95</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">)</span>
        <span class="n">ResRec</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">ResRec</span><span class="p">[</span><span class="s1">&#39;result_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;VGP Sample: &#39;</span> <span class="o">+</span> <span class="n">SampRec</span><span class="p">[</span><span class="s1">&#39;sample&#39;</span><span class="p">]</span>
        <span class="n">ResRec</span><span class="p">[</span><span class="s1">&#39;location&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">SampRec</span><span class="p">[</span><span class="s1">&#39;location&#39;</span><span class="p">]</span>
        <span class="n">ResRec</span><span class="p">[</span><span class="s1">&#39;citations&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;This study&quot;</span>
        <span class="n">ResRec</span><span class="p">[</span><span class="s1">&#39;site&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">SampRec</span><span class="p">[</span><span class="s1">&#39;site&#39;</span><span class="p">]</span>
        <span class="n">ResRec</span><span class="p">[</span><span class="s1">&#39;dir_dec&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">SampRec</span><span class="p">[</span><span class="s1">&#39;dir_dec&#39;</span><span class="p">]</span>
        <span class="n">ResRec</span><span class="p">[</span><span class="s1">&#39;dir_inc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">SampRec</span><span class="p">[</span><span class="s1">&#39;dir_inc&#39;</span><span class="p">]</span>
        <span class="n">ResRec</span><span class="p">[</span><span class="s1">&#39;dir_alpha95&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">SampRec</span><span class="p">[</span><span class="s1">&#39;dir_alpha95&#39;</span><span class="p">]</span>
        <span class="n">ResRec</span><span class="p">[</span><span class="s1">&#39;dir_tilt_correction&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">SampRec</span><span class="p">[</span><span class="s1">&#39;dir_tilt_correction&#39;</span><span class="p">]</span>
        <span class="n">ResRec</span><span class="p">[</span><span class="s1">&#39;dir_comp_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">SampRec</span><span class="p">[</span><span class="s1">&#39;dir_comp_name&#39;</span><span class="p">]</span>
        <span class="n">ResRec</span><span class="p">[</span><span class="s1">&#39;vgp_lat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%7.1f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">plat</span><span class="p">)</span>
        <span class="n">ResRec</span><span class="p">[</span><span class="s1">&#39;vgp_lon&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%7.1f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">plon</span><span class="p">)</span>
        <span class="n">ResRec</span><span class="p">[</span><span class="s1">&#39;vgp_dp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%7.1f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">dp</span><span class="p">)</span>
        <span class="n">ResRec</span><span class="p">[</span><span class="s1">&#39;vgp_dm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%7.1f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">dm</span><span class="p">)</span>
        <span class="n">ResRec</span><span class="p">[</span><span class="s1">&#39;method_codes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">SampRec</span><span class="p">[</span><span class="s1">&#39;method_codes&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;:DE-DI&quot;</span>
        <span class="k">return</span> <span class="n">ResRec</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">site</span> <span class="o">=</span> <span class="n">get_dictitem</span><span class="p">(</span><span class="n">SiteNFO</span><span class="p">,</span> <span class="s1">&#39;er_site_name&#39;</span><span class="p">,</span>
                            <span class="n">SampRec</span><span class="p">[</span><span class="s1">&#39;er_site_name&#39;</span><span class="p">],</span> <span class="s1">&#39;T&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">site</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">0</span>
            <span class="k">while</span> <span class="n">lat</span> <span class="o">==</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">lon</span> <span class="o">==</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">site</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">site</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;site_lat&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">lat</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">site</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;site_lat&#39;</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">site</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;site_lon&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">lon</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">site</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;site_lon&#39;</span><span class="p">])</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lat</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">site</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;site_lat&#39;</span><span class="p">])</span>
            <span class="n">lon</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">site</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;site_lon&#39;</span><span class="p">])</span>
        <span class="n">dec</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">SampRec</span><span class="p">[</span><span class="s1">&#39;sample_dec&#39;</span><span class="p">])</span>
        <span class="n">inc</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">SampRec</span><span class="p">[</span><span class="s1">&#39;sample_inc&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">SampRec</span><span class="p">[</span><span class="s1">&#39;sample_alpha95&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">a95</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">SampRec</span><span class="p">[</span><span class="s1">&#39;sample_alpha95&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">a95</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">plon</span><span class="p">,</span> <span class="n">plat</span><span class="p">,</span> <span class="n">dp</span><span class="p">,</span> <span class="n">dm</span> <span class="o">=</span> <span class="n">dia_vgp</span><span class="p">(</span><span class="n">dec</span><span class="p">,</span> <span class="n">inc</span><span class="p">,</span> <span class="n">a95</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">)</span>
        <span class="n">ResRec</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">ResRec</span><span class="p">[</span><span class="s1">&#39;pmag_result_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;VGP Sample: &#39;</span> <span class="o">+</span> <span class="n">SampRec</span><span class="p">[</span><span class="s1">&#39;er_sample_name&#39;</span><span class="p">]</span>
        <span class="n">ResRec</span><span class="p">[</span><span class="s1">&#39;er_location_names&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">SampRec</span><span class="p">[</span><span class="s1">&#39;er_location_name&#39;</span><span class="p">]</span>
        <span class="n">ResRec</span><span class="p">[</span><span class="s1">&#39;er_citation_names&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;This study&quot;</span>
        <span class="n">ResRec</span><span class="p">[</span><span class="s1">&#39;er_site_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">SampRec</span><span class="p">[</span><span class="s1">&#39;er_site_name&#39;</span><span class="p">]</span>
        <span class="n">ResRec</span><span class="p">[</span><span class="s1">&#39;average_dec&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">SampRec</span><span class="p">[</span><span class="s1">&#39;sample_dec&#39;</span><span class="p">]</span>
        <span class="n">ResRec</span><span class="p">[</span><span class="s1">&#39;average_inc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">SampRec</span><span class="p">[</span><span class="s1">&#39;sample_inc&#39;</span><span class="p">]</span>
        <span class="n">ResRec</span><span class="p">[</span><span class="s1">&#39;average_alpha95&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">SampRec</span><span class="p">[</span><span class="s1">&#39;sample_alpha95&#39;</span><span class="p">]</span>
        <span class="n">ResRec</span><span class="p">[</span><span class="s1">&#39;tilt_correction&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">SampRec</span><span class="p">[</span><span class="s1">&#39;sample_tilt_correction&#39;</span><span class="p">]</span>
        <span class="n">ResRec</span><span class="p">[</span><span class="s1">&#39;pole_comp_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">SampRec</span><span class="p">[</span><span class="s1">&#39;sample_comp_name&#39;</span><span class="p">]</span>
        <span class="n">ResRec</span><span class="p">[</span><span class="s1">&#39;vgp_lat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%7.1f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">plat</span><span class="p">)</span>
        <span class="n">ResRec</span><span class="p">[</span><span class="s1">&#39;vgp_lon&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%7.1f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">plon</span><span class="p">)</span>
        <span class="n">ResRec</span><span class="p">[</span><span class="s1">&#39;vgp_dp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%7.1f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">dp</span><span class="p">)</span>
        <span class="n">ResRec</span><span class="p">[</span><span class="s1">&#39;vgp_dm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%7.1f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">dm</span><span class="p">)</span>
        <span class="n">ResRec</span><span class="p">[</span><span class="s1">&#39;magic_method_codes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">SampRec</span><span class="p">[</span><span class="s1">&#39;magic_method_codes&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;:DE-DI&quot;</span>
        <span class="k">return</span> <span class="n">ResRec</span>


<span class="k">def</span> <span class="nf">getsampVDM</span><span class="p">(</span><span class="n">SampRec</span><span class="p">,</span> <span class="n">SampNFO</span><span class="p">):</span>
    <span class="n">samps</span> <span class="o">=</span> <span class="n">get_dictitem</span><span class="p">(</span><span class="n">SampNFO</span><span class="p">,</span> <span class="s1">&#39;er_sample_name&#39;</span><span class="p">,</span>
                         <span class="n">SampRec</span><span class="p">[</span><span class="s1">&#39;er_sample_name&#39;</span><span class="p">],</span> <span class="s1">&#39;T&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">samps</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">samp</span> <span class="o">=</span> <span class="n">samps</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">lat</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">samp</span><span class="p">[</span><span class="s1">&#39;sample_lat&#39;</span><span class="p">])</span>
        <span class="nb">int</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">SampRec</span><span class="p">[</span><span class="s1">&#39;sample_int&#39;</span><span class="p">])</span>
        <span class="n">vdm</span> <span class="o">=</span> <span class="n">b_vdm</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">lat</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;sample_int_sigma&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">SampRec</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="n">SampRec</span><span class="p">[</span><span class="s1">&#39;sample_int_sigma&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">sig</span> <span class="o">=</span> <span class="n">b_vdm</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">SampRec</span><span class="p">[</span><span class="s1">&#39;sample_int_sigma&#39;</span><span class="p">]),</span> <span class="n">lat</span><span class="p">)</span>
            <span class="n">sig</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%8.3e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sig</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sig</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;could not find sample info for: &#39;</span><span class="p">,</span> <span class="n">SampRec</span><span class="p">[</span><span class="s1">&#39;er_sample_name&#39;</span><span class="p">])</span>
        <span class="k">return</span> <span class="p">{}</span>
    <span class="n">ResRec</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">ResRec</span><span class="p">[</span><span class="s1">&#39;pmag_result_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;V[A]DM Sample: &#39;</span> <span class="o">+</span> <span class="n">SampRec</span><span class="p">[</span><span class="s1">&#39;er_sample_name&#39;</span><span class="p">]</span>
    <span class="n">ResRec</span><span class="p">[</span><span class="s1">&#39;er_location_names&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">SampRec</span><span class="p">[</span><span class="s1">&#39;er_location_name&#39;</span><span class="p">]</span>
    <span class="n">ResRec</span><span class="p">[</span><span class="s1">&#39;er_citation_names&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;This study&quot;</span>
    <span class="n">ResRec</span><span class="p">[</span><span class="s1">&#39;er_site_names&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">SampRec</span><span class="p">[</span><span class="s1">&#39;er_site_name&#39;</span><span class="p">]</span>
    <span class="n">ResRec</span><span class="p">[</span><span class="s1">&#39;er_sample_names&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">SampRec</span><span class="p">[</span><span class="s1">&#39;er_sample_name&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="s1">&#39;sample_dec&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">SampRec</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="n">ResRec</span><span class="p">[</span><span class="s1">&#39;average_dec&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">SampRec</span><span class="p">[</span><span class="s1">&#39;sample_dec&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ResRec</span><span class="p">[</span><span class="s1">&#39;average_dec&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">if</span> <span class="s1">&#39;sample_inc&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">SampRec</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="n">ResRec</span><span class="p">[</span><span class="s1">&#39;average_inc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">SampRec</span><span class="p">[</span><span class="s1">&#39;sample_inc&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ResRec</span><span class="p">[</span><span class="s1">&#39;average_inc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">ResRec</span><span class="p">[</span><span class="s1">&#39;average_int&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">SampRec</span><span class="p">[</span><span class="s1">&#39;sample_int&#39;</span><span class="p">]</span>
    <span class="n">ResRec</span><span class="p">[</span><span class="s1">&#39;vadm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%8.3e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">vdm</span><span class="p">)</span>
    <span class="n">ResRec</span><span class="p">[</span><span class="s1">&#39;vadm_sigma&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sig</span>
    <span class="n">ResRec</span><span class="p">[</span><span class="s1">&#39;magic_method_codes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">SampRec</span><span class="p">[</span><span class="s1">&#39;magic_method_codes&#39;</span><span class="p">]</span>
    <span class="n">ResRec</span><span class="p">[</span><span class="s1">&#39;model_lat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">samp</span><span class="p">[</span><span class="s1">&#39;sample_lat&#39;</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">ResRec</span>


<span class="k">def</span> <span class="nf">getfield</span><span class="p">(</span><span class="n">irmunits</span><span class="p">,</span> <span class="n">coil</span><span class="p">,</span> <span class="n">treat</span><span class="p">):</span>
    
    <span class="c1"># calibration of ASC Impulse magnetizer</span>
    <span class="k">if</span> <span class="n">coil</span> <span class="o">==</span> <span class="s2">&quot;3&quot;</span><span class="p">:</span>
        <span class="n">m</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mf">0.0071</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.004</span>  <span class="c1"># B=mh+b where B is in T, treat is in Volts</span>
    <span class="k">if</span> <span class="n">coil</span> <span class="o">==</span> <span class="s2">&quot;2&quot;</span><span class="p">:</span>
        <span class="n">m</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mf">0.00329</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.002455</span>  <span class="c1"># B=mh+b where B is in T, treat is in Volts</span>
    <span class="k">if</span> <span class="n">coil</span> <span class="o">==</span> <span class="s2">&quot;1&quot;</span><span class="p">:</span>
        <span class="n">m</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mf">0.0002</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0002</span>  <span class="c1"># B=mh+b where B is in T, treat is in Volts</span>
    <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">treat</span><span class="p">)</span> <span class="o">*</span> <span class="n">m</span> <span class="o">+</span> <span class="n">b</span>


<span class="k">def</span> <span class="nf">sortbykeys</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">sort_list</span><span class="p">):</span>
    <span class="n">Output</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">List</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># get a list of what to be sorted by second key</span>
    <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="nb">input</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">rec</span><span class="p">[</span><span class="n">sort_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">List</span><span class="p">:</span>
            <span class="n">List</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="n">sort_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
    <span class="k">for</span> <span class="n">current</span> <span class="ow">in</span> <span class="n">List</span><span class="p">:</span>  <span class="c1"># step through input finding all records of current</span>
        <span class="n">Currents</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="nb">input</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">rec</span><span class="p">[</span><span class="n">sort_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">==</span> <span class="n">current</span><span class="p">:</span>
                <span class="n">Currents</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">)</span>
        <span class="n">Current_sorted</span> <span class="o">=</span> <span class="n">sort_diclist</span><span class="p">(</span><span class="n">Currents</span><span class="p">,</span> <span class="n">sort_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">Current_sorted</span><span class="p">:</span>
            <span class="n">Output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Output</span>


<span class="k">def</span> <span class="nf">get_list</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>  <span class="c1"># return a colon delimited list of unique key values</span>
    <span class="n">keylist</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">keylist</span><span class="p">:</span>
                <span class="n">keylist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
    <span class="n">keystring</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">keylist</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">keystring</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">keylist</span><span class="p">:</span>
        <span class="n">keystring</span> <span class="o">=</span> <span class="n">keystring</span> <span class="o">+</span> <span class="s1">&#39;:&#39;</span> <span class="o">+</span> <span class="n">k</span>
    <span class="k">return</span> <span class="n">keystring</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>


<span class="k">def</span> <span class="nf">ParseSiteFile</span><span class="p">(</span><span class="n">site_file</span><span class="p">):</span>
    <span class="n">Sites</span><span class="p">,</span> <span class="n">file_type</span> <span class="o">=</span> <span class="n">magic_read</span><span class="p">(</span><span class="n">site_file</span><span class="p">)</span>
    <span class="n">LocNames</span><span class="p">,</span> <span class="n">Locations</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">site</span> <span class="ow">in</span> <span class="n">Sites</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">site</span><span class="p">[</span><span class="s1">&#39;er_location_name&#39;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">LocNames</span><span class="p">:</span>  <span class="c1"># new location name</span>
            <span class="n">LocNames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">site</span><span class="p">[</span><span class="s1">&#39;er_location_name&#39;</span><span class="p">])</span>
            <span class="c1"># get all sites for this loc</span>
            <span class="n">sites_locs</span> <span class="o">=</span> <span class="n">get_dictitem</span><span class="p">(</span>
                <span class="n">Sites</span><span class="p">,</span> <span class="s1">&#39;er_location_name&#39;</span><span class="p">,</span> <span class="n">site</span><span class="p">[</span><span class="s1">&#39;er_location_name&#39;</span><span class="p">],</span> <span class="s1">&#39;T&#39;</span><span class="p">)</span>
            <span class="c1"># get all the latitudes as floats</span>
            <span class="n">lats</span> <span class="o">=</span> <span class="n">get_dictkey</span><span class="p">(</span><span class="n">sites_locs</span><span class="p">,</span> <span class="s1">&#39;site_lat&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">)</span>
            <span class="c1"># get all the longitudes as floats</span>
            <span class="n">lons</span> <span class="o">=</span> <span class="n">get_dictkey</span><span class="p">(</span><span class="n">sites_locs</span><span class="p">,</span> <span class="s1">&#39;site_lon&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">)</span>
            <span class="n">LocRec</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;er_citation_names&#39;</span><span class="p">:</span> <span class="s1">&#39;This study&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;er_location_name&#39;</span><span class="p">:</span> <span class="n">site</span><span class="p">[</span><span class="s1">&#39;er_location_name&#39;</span><span class="p">],</span> <span class="s1">&#39;location_type&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">}</span>
            <span class="n">LocRec</span><span class="p">[</span><span class="s1">&#39;location_begin_lat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">lats</span><span class="p">))</span>
            <span class="n">LocRec</span><span class="p">[</span><span class="s1">&#39;location_end_lat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">lats</span><span class="p">))</span>
            <span class="n">LocRec</span><span class="p">[</span><span class="s1">&#39;location_begin_lon&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">lons</span><span class="p">))</span>
            <span class="n">LocRec</span><span class="p">[</span><span class="s1">&#39;location_end_lon&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">lons</span><span class="p">))</span>
            <span class="n">Locations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">LocRec</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Locations</span>


<span class="k">def</span> <span class="nf">ParseMeasFile</span><span class="p">(</span><span class="n">measfile</span><span class="p">,</span> <span class="n">sitefile</span><span class="p">,</span> <span class="n">instout</span><span class="p">,</span> <span class="n">specout</span><span class="p">):</span>  <span class="c1"># fix up some stuff for uploading</span>
    <span class="c1">#</span>
    <span class="c1"># read in magic_measurements file to get specimen, and instrument names</span>
    <span class="c1">#</span>
    <span class="n">master_instlist</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">InstRecs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">meas_data</span><span class="p">,</span> <span class="n">file_type</span> <span class="o">=</span> <span class="n">magic_read</span><span class="p">(</span><span class="n">measfile</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">file_type</span> <span class="o">!=</span> <span class="s1">&#39;magic_measurements&#39;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">file_type</span><span class="p">,</span> <span class="s2">&quot;This is not a valid magic_measurements file &quot;</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="c1"># read in site data</span>
    <span class="k">if</span> <span class="n">sitefile</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
        <span class="n">SiteNFO</span><span class="p">,</span> <span class="n">file_type</span> <span class="o">=</span> <span class="n">magic_read</span><span class="p">(</span><span class="n">sitefile</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">file_type</span> <span class="o">==</span> <span class="s2">&quot;bad_file&quot;</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Bad  or no er_sites file - lithology, etc will not be imported&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">SiteNFO</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># define the Er_specimen records to create a new er_specimens.txt file</span>
    <span class="c1">#</span>
    <span class="n">suniq</span><span class="p">,</span> <span class="n">ErSpecs</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">meas_data</span><span class="p">:</span>
        <span class="c1"># fill in some potentially missing fields</span>
        <span class="k">if</span> <span class="s2">&quot;magic_instrument_codes&quot;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="n">lst</span> <span class="o">=</span> <span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;magic_instrument_codes&quot;</span><span class="p">])</span>
            <span class="n">lst</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="n">tmplist</span> <span class="o">=</span> <span class="n">lst</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">inst</span> <span class="ow">in</span> <span class="n">tmplist</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">inst</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">master_instlist</span><span class="p">:</span>
                    <span class="n">master_instlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inst</span><span class="p">)</span>
                    <span class="n">InstRec</span> <span class="o">=</span> <span class="p">{}</span>
                    <span class="n">InstRec</span><span class="p">[</span><span class="s2">&quot;magic_instrument_code&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">inst</span>
                    <span class="n">InstRecs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">InstRec</span><span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;measurement_standard&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="c1"># make this an unknown if not specified</span>
            <span class="n">rec</span><span class="p">[</span><span class="s1">&#39;measurement_standard&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;u&#39;</span>
        <span class="k">if</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;er_specimen_name&quot;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">suniq</span> <span class="ow">and</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;measurement_standard&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;s&#39;</span><span class="p">:</span>  <span class="c1"># exclude standards</span>
            <span class="n">suniq</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;er_specimen_name&quot;</span><span class="p">])</span>
            <span class="n">ErSpecRec</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">ErSpecRec</span><span class="p">[</span><span class="s2">&quot;er_citation_names&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;This study&quot;</span>
            <span class="n">ErSpecRec</span><span class="p">[</span><span class="s2">&quot;er_specimen_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;er_specimen_name&quot;</span><span class="p">]</span>
            <span class="n">ErSpecRec</span><span class="p">[</span><span class="s2">&quot;er_sample_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;er_sample_name&quot;</span><span class="p">]</span>
            <span class="n">ErSpecRec</span><span class="p">[</span><span class="s2">&quot;er_site_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;er_site_name&quot;</span><span class="p">]</span>
            <span class="n">ErSpecRec</span><span class="p">[</span><span class="s2">&quot;er_location_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;er_location_name&quot;</span><span class="p">]</span>
    <span class="c1">#</span>
    <span class="c1"># attach site litho, etc. to specimen if not already there</span>
            <span class="n">sites</span> <span class="o">=</span> <span class="n">get_dictitem</span><span class="p">(</span><span class="n">SiteNFO</span><span class="p">,</span> <span class="s1">&#39;er_site_name&#39;</span><span class="p">,</span>
                                 <span class="n">rec</span><span class="p">[</span><span class="s1">&#39;er_site_name&#39;</span><span class="p">],</span> <span class="s1">&#39;T&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sites</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">site</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;site record in er_sites table not found for: &#39;</span><span class="p">,</span>
                      <span class="n">rec</span><span class="p">[</span><span class="s1">&#39;er_site_name&#39;</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">site</span> <span class="o">=</span> <span class="n">sites</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="s1">&#39;site_class&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">site</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">or</span> <span class="s1">&#39;site_lithology&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">site</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">or</span> <span class="s1">&#39;site_type&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">site</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                <span class="n">site</span><span class="p">[</span><span class="s1">&#39;site_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Not Specified&#39;</span>
                <span class="n">site</span><span class="p">[</span><span class="s1">&#39;site_lithology&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Not Specified&#39;</span>
                <span class="n">site</span><span class="p">[</span><span class="s1">&#39;site_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Not Specified&#39;</span>
            <span class="k">if</span> <span class="s1">&#39;specimen_class&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">ErSpecRec</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                <span class="n">ErSpecRec</span><span class="p">[</span><span class="s2">&quot;specimen_class&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">site</span><span class="p">[</span><span class="s1">&#39;site_class&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="s1">&#39;specimen_lithology&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">ErSpecRec</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                <span class="n">ErSpecRec</span><span class="p">[</span><span class="s2">&quot;specimen_lithology&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">site</span><span class="p">[</span><span class="s1">&#39;site_lithology&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="s1">&#39;specimen_type&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">ErSpecRec</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                <span class="n">ErSpecRec</span><span class="p">[</span><span class="s2">&quot;specimen_type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">site</span><span class="p">[</span><span class="s1">&#39;site_type&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="s1">&#39;specimen_volume&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">ErSpecRec</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                <span class="n">ErSpecRec</span><span class="p">[</span><span class="s2">&quot;specimen_volume&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">if</span> <span class="s1">&#39;specimen_weight&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">ErSpecRec</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                <span class="n">ErSpecRec</span><span class="p">[</span><span class="s2">&quot;specimen_weight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="n">ErSpecs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ErSpecRec</span><span class="p">)</span>
    <span class="c1">#</span>
    <span class="c1">#</span>
    <span class="c1"># save the data</span>
    <span class="c1">#</span>
    <span class="n">magic_write</span><span class="p">(</span><span class="n">specout</span><span class="p">,</span> <span class="n">ErSpecs</span><span class="p">,</span> <span class="s2">&quot;er_specimens&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Er_Specimen data (with updated info from site if necessary)  saved in &quot;</span><span class="p">,</span> <span class="n">specout</span><span class="p">)</span>
    <span class="c1">#</span>
    <span class="c1"># write out the instrument list</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">InstRecs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">magic_write</span><span class="p">(</span><span class="n">instout</span><span class="p">,</span> <span class="n">InstRecs</span><span class="p">,</span> <span class="s2">&quot;magic_instruments&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Instruments data saved in &quot;</span><span class="p">,</span> <span class="n">instout</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No instruments found&quot;</span><span class="p">)</span>


<span class="c1"># take care of re-ordering sample table, putting used orientations first</span>
<span class="k">def</span> <span class="nf">ReorderSamples</span><span class="p">(</span><span class="n">specfile</span><span class="p">,</span> <span class="n">sampfile</span><span class="p">,</span> <span class="n">outfile</span><span class="p">):</span>
    <span class="n">UsedSamps</span><span class="p">,</span> <span class="n">RestSamps</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">Specs</span><span class="p">,</span> <span class="n">filetype</span> <span class="o">=</span> <span class="n">magic_read</span><span class="p">(</span><span class="n">specfile</span><span class="p">)</span>  <span class="c1"># read in specimen file</span>
    <span class="n">Samps</span><span class="p">,</span> <span class="n">filetype</span> <span class="o">=</span> <span class="n">magic_read</span><span class="p">(</span><span class="n">sampfile</span><span class="p">)</span>  <span class="c1"># read in sample file</span>
    <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">Specs</span><span class="p">:</span>  <span class="c1"># hunt through specimen by specimen</span>
        <span class="n">meths</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="s1">&#39;magic_method_codes&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">meth</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>
            <span class="n">methtype</span> <span class="o">=</span> <span class="n">meth</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;SO&#39;</span> <span class="ow">in</span> <span class="n">methtype</span><span class="p">:</span>
                <span class="n">SO_meth</span> <span class="o">=</span> <span class="n">meth</span>  <span class="c1"># find the orientation method code</span>
        <span class="n">samprecs</span> <span class="o">=</span> <span class="n">get_dictitem</span><span class="p">(</span><span class="n">Samps</span><span class="p">,</span> <span class="s1">&#39;er_sample_name&#39;</span><span class="p">,</span>
                                <span class="n">rec</span><span class="p">[</span><span class="s1">&#39;er_sample_name&#39;</span><span class="p">],</span> <span class="s1">&#39;T&#39;</span><span class="p">)</span>
        <span class="n">used</span> <span class="o">=</span> <span class="n">get_dictitem</span><span class="p">(</span><span class="n">samprecs</span><span class="p">,</span> <span class="s1">&#39;magic_method_codes&#39;</span><span class="p">,</span> <span class="n">SO_meth</span><span class="p">,</span> <span class="s1">&#39;has&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">used</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">UsedSamps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">used</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;orientation not found for: &#39;</span><span class="p">,</span> <span class="n">rec</span><span class="p">[</span><span class="s1">&#39;er_specimen_name&#39;</span><span class="p">])</span>
        <span class="n">rest</span> <span class="o">=</span> <span class="n">get_dictitem</span><span class="p">(</span><span class="n">samprecs</span><span class="p">,</span> <span class="s1">&#39;magic_method_codes&#39;</span><span class="p">,</span> <span class="n">SO_meth</span><span class="p">,</span> <span class="s1">&#39;not&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">rest</span><span class="p">:</span>
            <span class="n">RestSamps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">RestSamps</span><span class="p">:</span>
        <span class="n">UsedSamps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">)</span>  <span class="c1"># append the unused ones to the end of the file</span>
    <span class="n">magic_write</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="n">UsedSamps</span><span class="p">,</span> <span class="s1">&#39;er_samples&#39;</span><span class="p">)</span>


<div class="viewcode-block" id="orient"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.orient">[docs]</a><span class="k">def</span> <span class="nf">orient</span><span class="p">(</span><span class="n">mag_azimuth</span><span class="p">,</span> <span class="n">field_dip</span><span class="p">,</span> <span class="n">or_con</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Uses specified orientation convention to convert user supplied orientations</span>
<span class="sd">    to laboratory azimuth and plunge. </span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    -----------</span>
<span class="sd">    mag_azimuth: float</span>
<span class="sd">        orientation of the field orientation arrow with respect to north</span>
<span class="sd">    field_dip : float</span>
<span class="sd">        dip (or hade) or field arrow.</span>
<span class="sd">            if hade, with respect to vertical down</span>
<span class="sd">            if inclination, with respect to horizontal (positive down)</span>
<span class="sd">    or_con : int</span>
<span class="sd">        orientation convention : int</span>
<span class="sd">    </span>
<span class="sd">    Samples are oriented in the field with a &quot;field arrow&quot; and measured in the laboratory with a &quot;lab arrow&quot;. The lab arrow is the positive X direction of the right handed coordinate system of the specimen measurements. The lab and field arrows may  not be the same. In the MagIC database, we require the orientation (azimuth and plunge) of the X direction of the measurements (lab arrow). Here are some popular conventions that convert the field arrow azimuth (mag_azimuth in the orient.txt file) and dip (field_dip in orient.txt) to the azimuth and plunge  of the laboratory arrow (sample_azimuth and sample_dip in er_samples.txt). The two angles, mag_azimuth and field_dip are explained below.</span>

<span class="sd">        [1] Standard Pomeroy convention of azimuth and hade (degrees from vertical down)</span>
<span class="sd">            of the drill direction (field arrow).  lab arrow azimuth= sample_azimuth = mag_azimuth;</span>
<span class="sd">            lab arrow dip = sample_dip =-field_dip. i.e. the lab arrow dip is minus the hade.</span>
<span class="sd">        [2] Field arrow is the strike  of the plane orthogonal to the drill direction,</span>
<span class="sd">            Field dip is the hade of the drill direction.  Lab arrow azimuth = mag_azimuth-90</span>
<span class="sd">            Lab arrow dip = -field_dip</span>
<span class="sd">        [3] Lab arrow is the same as the drill direction;</span>
<span class="sd">            hade was measured in the field.</span>
<span class="sd">            Lab arrow azimuth = mag_azimuth; Lab arrow dip = 90-field_dip</span>
<span class="sd">        [4] lab azimuth and dip are same as mag_azimuth, field_dip : use this for unoriented samples too</span>
<span class="sd">        [5] Same as AZDIP convention explained below -</span>
<span class="sd">            azimuth and inclination of the drill direction are mag_azimuth and field_dip;</span>
<span class="sd">            lab arrow is as in [1] above.</span>
<span class="sd">            lab azimuth is same as mag_azimuth,lab arrow dip=field_dip-90</span>
<span class="sd">        [6] Lab arrow azimuth = mag_azimuth-90; Lab arrow dip = 90-field_dip</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    azimuth and dip of lab arrow</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">or_con</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">or_con</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">mag_azimuth</span> <span class="o">==</span> <span class="o">-</span><span class="mi">999</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span>
    <span class="k">if</span> <span class="n">or_con</span> <span class="o">==</span> <span class="s2">&quot;1&quot;</span><span class="p">:</span>  <span class="c1"># lab_mag_az=mag_az;  sample_dip = -dip</span>
        <span class="k">return</span> <span class="n">mag_azimuth</span><span class="p">,</span> <span class="o">-</span><span class="n">field_dip</span>
    <span class="k">if</span> <span class="n">or_con</span> <span class="o">==</span> <span class="s2">&quot;2&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">mag_azimuth</span> <span class="o">-</span> <span class="mf">90.</span><span class="p">,</span> <span class="o">-</span><span class="n">field_dip</span>
    <span class="k">if</span> <span class="n">or_con</span> <span class="o">==</span> <span class="s2">&quot;3&quot;</span><span class="p">:</span>  <span class="c1"># lab_mag_az=mag_az;  sample_dip = 90.-dip</span>
        <span class="k">return</span> <span class="n">mag_azimuth</span><span class="p">,</span> <span class="mf">90.</span> <span class="o">-</span> <span class="n">field_dip</span>
    <span class="k">if</span> <span class="n">or_con</span> <span class="o">==</span> <span class="s2">&quot;4&quot;</span><span class="p">:</span>  <span class="c1"># lab_mag_az=mag_az;  sample_dip = dip</span>
        <span class="k">return</span> <span class="n">mag_azimuth</span><span class="p">,</span> <span class="n">field_dip</span>
    <span class="k">if</span> <span class="n">or_con</span> <span class="o">==</span> <span class="s2">&quot;5&quot;</span><span class="p">:</span>  <span class="c1"># lab_mag_az=mag_az;  sample_dip = dip-90.</span>
        <span class="k">return</span> <span class="n">mag_azimuth</span><span class="p">,</span> <span class="n">field_dip</span> <span class="o">-</span> <span class="mf">90.</span>
    <span class="k">if</span> <span class="n">or_con</span> <span class="o">==</span> <span class="s2">&quot;6&quot;</span><span class="p">:</span>  <span class="c1"># lab_mag_az=mag_az-90.;  sample_dip = 90.-dip</span>
        <span class="k">return</span> <span class="n">mag_azimuth</span> <span class="o">-</span> <span class="mf">90.</span><span class="p">,</span> <span class="mf">90.</span> <span class="o">-</span> <span class="n">field_dip</span>
    <span class="k">if</span> <span class="n">or_con</span> <span class="o">==</span> <span class="s2">&quot;7&quot;</span><span class="p">:</span>  <span class="c1"># lab_mag_az=mag_az;  sample_dip = 90.-dip</span>
        <span class="k">return</span> <span class="n">mag_azimuth</span> <span class="o">-</span> <span class="mf">90.</span><span class="p">,</span> <span class="mf">90.</span> <span class="o">-</span> <span class="n">field_dip</span>
    <span class="k">if</span> <span class="n">or_con</span> <span class="o">==</span> <span class="s2">&quot;8&quot;</span><span class="p">:</span>  <span class="c1"># lab_mag_az=(mag_az-180)%360;  sample_dip = 90.-dip</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">mag_azimuth</span> <span class="o">-</span> <span class="mf">180.</span><span class="p">)</span><span class="o">%</span><span class="mi">360</span><span class="p">,</span> <span class="mf">90.</span> <span class="o">-</span> <span class="n">field_dip</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error in orientation convention&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="get_Sb"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.get_Sb">[docs]</a><span class="k">def</span> <span class="nf">get_Sb</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns vgp scatter for a data set.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : data set as a list or a pandas dataframe </span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    float value of the vgp scatter</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Sb</span><span class="p">,</span> <span class="n">N</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span>
    <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="n">delta</span> <span class="o">=</span> <span class="mf">90.</span> <span class="o">-</span> <span class="nb">abs</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s1">&#39;vgp_lat&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">rec</span><span class="p">[</span><span class="s1">&#39;average_k&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="s1">&#39;average_k&#39;</span><span class="p">]</span>
            <span class="n">L</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="s1">&#39;average_lat&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">180.</span>  <span class="c1"># latitude in radians</span>
            <span class="n">Nsi</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="s1">&#39;average_nn&#39;</span><span class="p">]</span>
            <span class="n">K</span> <span class="o">=</span> <span class="n">old_div</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="mf">2.</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="mf">3.</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">L</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span>
                            <span class="p">(</span><span class="mf">5.</span> <span class="o">-</span> <span class="mf">3.</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">L</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)))</span>
            <span class="n">Sw</span> <span class="o">=</span> <span class="mf">81.</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Sw</span><span class="p">,</span> <span class="n">Nsi</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.</span>
        <span class="n">Sb</span> <span class="o">+=</span> <span class="n">delta</span><span class="o">**</span><span class="mf">2.</span> <span class="o">-</span> <span class="p">(</span><span class="n">Sw</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">Nsi</span>
        <span class="n">N</span> <span class="o">+=</span> <span class="mf">1.</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Sb</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">))</span></div>


<div class="viewcode-block" id="get_sb_df"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.get_sb_df">[docs]</a><span class="k">def</span> <span class="nf">get_sb_df</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">mm97</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates Sf for a dataframe with VGP Lat., and optional Fisher&#39;s k, site latitude and N information can be used to correct for within site scatter (McElhinny &amp; McFadden, 1997)</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    df : Pandas Dataframe with columns</span>
<span class="sd">        REQUIRED:</span>
<span class="sd">            vgp_lat :  VGP latitude</span>
<span class="sd">        ONLY REQUIRED for MM97 correction:</span>
<span class="sd">            dir_k : Fisher kappa estimate</span>
<span class="sd">            dir_n : number of specimens (samples) per site</span>
<span class="sd">            lat : latitude of the site</span>
<span class="sd">    mm97 : if True, will do the correction for within site scatter</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Sf : float value for the Sf</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;delta&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">90.</span><span class="o">-</span><span class="n">df</span><span class="o">.</span><span class="n">vgp_lat</span>
    <span class="n">Sp2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">delta</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="s1">&#39;dir_k&#39;</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="ow">and</span> <span class="n">mm97</span><span class="p">:</span>
        <span class="n">ks</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dir_k</span>
        <span class="n">Ns</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dir_n</span>
        <span class="n">Ls</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">lat</span><span class="p">)</span>
        <span class="n">A95s</span> <span class="o">=</span> <span class="mf">140.</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">ks</span><span class="o">*</span><span class="n">Ns</span><span class="p">)</span>
        <span class="n">Sw2_n</span> <span class="o">=</span> <span class="mf">0.335</span><span class="o">*</span><span class="p">(</span><span class="n">A95s</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="mf">3.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">Ls</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span>
                                 <span class="p">(</span><span class="mf">5.</span><span class="o">-</span><span class="mf">3.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">Ls</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Sp2</span><span class="o">-</span><span class="n">Sw2_n</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Sp2</span><span class="p">)</span></div>


<span class="k">def</span> <span class="nf">default_criteria</span><span class="p">(</span><span class="n">nocrit</span><span class="p">):</span>
    <span class="n">Crits</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">critkeys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;magic_experiment_names&#39;</span><span class="p">,</span> <span class="s1">&#39;measurement_step_min&#39;</span><span class="p">,</span> <span class="s1">&#39;measurement_step_max&#39;</span><span class="p">,</span> <span class="s1">&#39;measurement_step_unit&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_polarity&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_nrm&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_direction_type&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_comp_nmb&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_mad&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_alpha95&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_n&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_int_sigma&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_int_sigma_perc&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_int_rel_sigma&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_int_rel_sigma_perc&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_int_mad&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_int_n&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_w&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_q&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_f&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_fvds&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_b_sigma&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_b_beta&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_g&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_dang&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_md&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_ptrm&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_drat&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_drats&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_rsc&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_viscosity_index&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_magn_moment&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_magn_volume&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_magn_mass&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_int_dang&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_int_ptrm_n&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_delta&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_theta&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_gamma&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_frac&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_gmax&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_scat&#39;</span><span class="p">,</span> <span class="s1">&#39;sample_polarity&#39;</span><span class="p">,</span> <span class="s1">&#39;sample_nrm&#39;</span><span class="p">,</span> <span class="s1">&#39;sample_direction_type&#39;</span><span class="p">,</span> <span class="s1">&#39;sample_comp_nmb&#39;</span><span class="p">,</span> <span class="s1">&#39;sample_sigma&#39;</span><span class="p">,</span> <span class="s1">&#39;sample_alpha95&#39;</span><span class="p">,</span> <span class="s1">&#39;sample_n&#39;</span><span class="p">,</span> <span class="s1">&#39;sample_n_lines&#39;</span><span class="p">,</span> <span class="s1">&#39;sample_n_planes&#39;</span><span class="p">,</span>
                <span class="s1">&#39;sample_k&#39;</span><span class="p">,</span> <span class="s1">&#39;sample_r&#39;</span><span class="p">,</span> <span class="s1">&#39;sample_tilt_correction&#39;</span><span class="p">,</span> <span class="s1">&#39;sample_int_sigma&#39;</span><span class="p">,</span> <span class="s1">&#39;sample_int_sigma_perc&#39;</span><span class="p">,</span> <span class="s1">&#39;sample_int_rel_sigma&#39;</span><span class="p">,</span> <span class="s1">&#39;sample_int_rel_sigma_perc&#39;</span><span class="p">,</span> <span class="s1">&#39;sample_int_n&#39;</span><span class="p">,</span> <span class="s1">&#39;sample_magn_moment&#39;</span><span class="p">,</span> <span class="s1">&#39;sample_magn_volume&#39;</span><span class="p">,</span> <span class="s1">&#39;sample_magn_mass&#39;</span><span class="p">,</span> <span class="s1">&#39;site_polarity&#39;</span><span class="p">,</span> <span class="s1">&#39;site_nrm&#39;</span><span class="p">,</span> <span class="s1">&#39;site_direction_type&#39;</span><span class="p">,</span> <span class="s1">&#39;site_comp_nmb&#39;</span><span class="p">,</span> <span class="s1">&#39;site_sigma&#39;</span><span class="p">,</span> <span class="s1">&#39;site_alpha95&#39;</span><span class="p">,</span> <span class="s1">&#39;site_n&#39;</span><span class="p">,</span> <span class="s1">&#39;site_n_lines&#39;</span><span class="p">,</span> <span class="s1">&#39;site_n_planes&#39;</span><span class="p">,</span> <span class="s1">&#39;site_k&#39;</span><span class="p">,</span> <span class="s1">&#39;site_r&#39;</span><span class="p">,</span> <span class="s1">&#39;site_tilt_correction&#39;</span><span class="p">,</span> <span class="s1">&#39;site_int_sigma&#39;</span><span class="p">,</span> <span class="s1">&#39;site_int_sigma_perc&#39;</span><span class="p">,</span> <span class="s1">&#39;site_int_rel_sigma&#39;</span><span class="p">,</span> <span class="s1">&#39;site_int_rel_sigma_perc&#39;</span><span class="p">,</span> <span class="s1">&#39;site_int_n&#39;</span><span class="p">,</span> <span class="s1">&#39;site_magn_moment&#39;</span><span class="p">,</span> <span class="s1">&#39;site_magn_volume&#39;</span><span class="p">,</span> <span class="s1">&#39;site_magn_mass&#39;</span><span class="p">,</span> <span class="s1">&#39;average_age_min&#39;</span><span class="p">,</span> <span class="s1">&#39;average_age_max&#39;</span><span class="p">,</span> <span class="s1">&#39;average_age_sigma&#39;</span><span class="p">,</span> <span class="s1">&#39;average_age_unit&#39;</span><span class="p">,</span> <span class="s1">&#39;average_sigma&#39;</span><span class="p">,</span> <span class="s1">&#39;average_alpha95&#39;</span><span class="p">,</span> <span class="s1">&#39;average_n&#39;</span><span class="p">,</span> <span class="s1">&#39;average_nn&#39;</span><span class="p">,</span> <span class="s1">&#39;average_k&#39;</span><span class="p">,</span> <span class="s1">&#39;average_r&#39;</span><span class="p">,</span> <span class="s1">&#39;average_int_sigma&#39;</span><span class="p">,</span> <span class="s1">&#39;average_int_rel_sigma&#39;</span><span class="p">,</span> <span class="s1">&#39;average_int_rel_sigma_perc&#39;</span><span class="p">,</span> <span class="s1">&#39;average_int_n&#39;</span><span class="p">,</span> <span class="s1">&#39;average_int_nn&#39;</span><span class="p">,</span> <span class="s1">&#39;vgp_dp&#39;</span><span class="p">,</span> <span class="s1">&#39;vgp_dm&#39;</span><span class="p">,</span> <span class="s1">&#39;vgp_sigma&#39;</span><span class="p">,</span> <span class="s1">&#39;vgp_alpha95&#39;</span><span class="p">,</span> <span class="s1">&#39;vgp_n&#39;</span><span class="p">,</span> <span class="s1">&#39;vdm_sigma&#39;</span><span class="p">,</span> <span class="s1">&#39;vdm_n&#39;</span><span class="p">,</span> <span class="s1">&#39;vadm_sigma&#39;</span><span class="p">,</span> <span class="s1">&#39;vadm_n&#39;</span><span class="p">,</span> <span class="s1">&#39;criteria_description&#39;</span><span class="p">,</span> <span class="s1">&#39;er_citation_names&#39;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">critkeys</span><span class="p">:</span>
        <span class="n">Crits</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>  <span class="c1"># set up dictionary with all possible</span>
    <span class="n">Crits</span><span class="p">[</span><span class="s1">&#39;pmag_criteria_code&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;ACCEPT&#39;</span>
    <span class="n">Crits</span><span class="p">[</span><span class="s1">&#39;criteria_definition&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;acceptance criteria for study&#39;</span>
    <span class="n">Crits</span><span class="p">[</span><span class="s1">&#39;er_citation_names&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;This study&#39;</span>
    <span class="k">if</span> <span class="n">nocrit</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># use default criteria</span>
        <span class="c1">#</span>
        <span class="c1"># set some sort of quasi-reasonable default criteria</span>
        <span class="c1">#</span>
        <span class="n">Crits</span><span class="p">[</span><span class="s1">&#39;specimen_mad&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;5&#39;</span>
        <span class="n">Crits</span><span class="p">[</span><span class="s1">&#39;specimen_dang&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;10&#39;</span>
        <span class="n">Crits</span><span class="p">[</span><span class="s1">&#39;specimen_int_n&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;4&#39;</span>
        <span class="n">Crits</span><span class="p">[</span><span class="s1">&#39;specimen_int_ptrm_n&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;2&#39;</span>
        <span class="n">Crits</span><span class="p">[</span><span class="s1">&#39;specimen_drats&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;20&#39;</span>
        <span class="n">Crits</span><span class="p">[</span><span class="s1">&#39;specimen_b_beta&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;0.1&#39;</span>
        <span class="n">Crits</span><span class="p">[</span><span class="s1">&#39;specimen_md&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;15&#39;</span>
        <span class="n">Crits</span><span class="p">[</span><span class="s1">&#39;specimen_fvds&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;0.7&#39;</span>
        <span class="n">Crits</span><span class="p">[</span><span class="s1">&#39;specimen_q&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;1.0&#39;</span>
        <span class="n">Crits</span><span class="p">[</span><span class="s1">&#39;specimen_int_dang&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;10&#39;</span>
        <span class="n">Crits</span><span class="p">[</span><span class="s1">&#39;specimen_int_mad&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;10&#39;</span>
        <span class="n">Crits</span><span class="p">[</span><span class="s1">&#39;sample_alpha95&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;5&#39;</span>
        <span class="n">Crits</span><span class="p">[</span><span class="s1">&#39;site_int_n&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;2&#39;</span>
        <span class="n">Crits</span><span class="p">[</span><span class="s1">&#39;site_int_sigma&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;5e-6&#39;</span>
        <span class="n">Crits</span><span class="p">[</span><span class="s1">&#39;site_int_sigma_perc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;15&#39;</span>
        <span class="n">Crits</span><span class="p">[</span><span class="s1">&#39;site_n&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;5&#39;</span>
        <span class="n">Crits</span><span class="p">[</span><span class="s1">&#39;site_n_lines&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;4&#39;</span>
        <span class="n">Crits</span><span class="p">[</span><span class="s1">&#39;site_k&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;50&#39;</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">Crits</span><span class="p">]</span>


<div class="viewcode-block" id="grade"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.grade">[docs]</a><span class="k">def</span> <span class="nf">grade</span><span class="p">(</span><span class="n">PmagRec</span><span class="p">,</span> <span class="n">ACCEPT</span><span class="p">,</span> <span class="nb">type</span><span class="p">,</span> <span class="n">data_model</span><span class="o">=</span><span class="mf">2.5</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Finds the &#39;grade&#39; (pass/fail; A/F) of a record (specimen,sample,site) given the acceptance criteria</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">GREATERTHAN</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;specimen_q&#39;</span><span class="p">,</span> <span class="s1">&#39;site_k&#39;</span><span class="p">,</span> <span class="s1">&#39;site_n&#39;</span><span class="p">,</span> <span class="s1">&#39;site_n_lines&#39;</span><span class="p">,</span> <span class="s1">&#39;site_int_n&#39;</span><span class="p">,</span> <span class="s1">&#39;measurement_step_min&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_int_ptrm_n&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_fvds&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_frac&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_f&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_n&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_int_n&#39;</span><span class="p">,</span> <span class="s1">&#39;sample_int_n&#39;</span><span class="p">,</span> <span class="s1">&#39;average_age_min&#39;</span><span class="p">,</span> <span class="s1">&#39;average_k&#39;</span><span class="p">,</span> <span class="s1">&#39;average_r&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_magn_moment&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;specimen_magn_volume&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_rsc&#39;</span><span class="p">,</span> <span class="s1">&#39;sample_n&#39;</span><span class="p">,</span> <span class="s1">&#39;sample_n_lines&#39;</span><span class="p">,</span> <span class="s1">&#39;sample_n_planes&#39;</span><span class="p">,</span> <span class="s1">&#39;sample_k&#39;</span><span class="p">,</span> <span class="s1">&#39;sample_r&#39;</span><span class="p">,</span> <span class="s1">&#39;site_magn_moment&#39;</span><span class="p">,</span> <span class="s1">&#39;site_magn_volume&#39;</span><span class="p">,</span> <span class="s1">&#39;site_magn_mass&#39;</span><span class="p">,</span> <span class="s1">&#39;site_r&#39;</span><span class="p">]</span>  <span class="c1"># these statistics must be exceede to pass, all others must be less than (except specimen_scat, which must be true)</span>
    <span class="n">ISTRUE</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;specimen_scat&#39;</span><span class="p">]</span>
    <span class="n">kill</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># criteria that kill the record</span>
    <span class="n">sigma_types</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;sample_int_sigma&#39;</span><span class="p">,</span> <span class="s1">&#39;sample_int_sigma_perc&#39;</span><span class="p">,</span> <span class="s1">&#39;site_int_sigma&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;site_int_sigma_perc&#39;</span><span class="p">,</span> <span class="s1">&#39;average_int_sigma&#39;</span><span class="p">,</span> <span class="s1">&#39;average_int_sigma_perc&#39;</span><span class="p">]</span>
    <span class="n">sigmas</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">accept</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s1">&#39;specimen_int&#39;</span><span class="p">:</span>
        <span class="n">USEKEYS</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;specimen_q&#39;</span><span class="p">,</span> <span class="s1">&#39;measurement_step_min&#39;</span><span class="p">,</span> <span class="s1">&#39;measurement_step_max&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_int_ptrm_n&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_fvds&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_frac&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_f&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_int_n&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_magn_moment&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;specimen_magn_volume&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_rsc&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_scat&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_drats&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_int_mad&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_int_dang&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_md&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_b_beta&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_w&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_gmax&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">data_model</span> <span class="o">==</span> <span class="mf">3.0</span><span class="p">:</span>
            <span class="n">USEKEYS</span> <span class="o">=</span> <span class="p">[</span><span class="n">map_magic</span><span class="o">.</span><span class="n">spec_magic2_2_magic3_map</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">USEKEYS</span><span class="p">]</span>
    <span class="k">elif</span> <span class="nb">type</span> <span class="o">==</span> <span class="s1">&#39;specimen_dir&#39;</span><span class="p">:</span>
        <span class="n">USEKEYS</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;measurement_step_min&#39;</span><span class="p">,</span> <span class="s1">&#39;measurement_step_max&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_mad&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;specimen_n&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_magn_moment&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_magn_volume&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">data_model</span> <span class="o">==</span> <span class="mf">3.0</span><span class="p">:</span>
            <span class="n">USEKEYS</span> <span class="o">=</span> <span class="p">[</span><span class="n">map_magic</span><span class="o">.</span><span class="n">spec_magic2_2_magic3_map</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">USEKEYS</span><span class="p">]</span>
    <span class="k">elif</span> <span class="nb">type</span> <span class="o">==</span> <span class="s1">&#39;sample_int&#39;</span><span class="p">:</span>
        <span class="n">USEKEYS</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;sample_int_n&#39;</span><span class="p">,</span> <span class="s1">&#39;sample_int_sigma&#39;</span><span class="p">,</span> <span class="s1">&#39;sample_int_sigma_perc&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">data_model</span> <span class="o">==</span> <span class="mf">3.0</span><span class="p">:</span>
            <span class="n">USEKEYS</span> <span class="o">=</span> <span class="p">[</span><span class="n">map_magic</span><span class="o">.</span><span class="n">samp_magic2_2_magic3_map</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">USEKEYS</span><span class="p">]</span>
    <span class="k">elif</span> <span class="nb">type</span> <span class="o">==</span> <span class="s1">&#39;sample_dir&#39;</span><span class="p">:</span>
        <span class="n">USEKEYS</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;sample_alpha95&#39;</span><span class="p">,</span> <span class="s1">&#39;sample_n&#39;</span><span class="p">,</span> <span class="s1">&#39;sample_n_lines&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;sample_n_planes&#39;</span><span class="p">,</span> <span class="s1">&#39;sample_k&#39;</span><span class="p">,</span> <span class="s1">&#39;sample_r&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">data_model</span> <span class="o">==</span> <span class="mf">3.0</span><span class="p">:</span>
            <span class="n">USEKEYS</span> <span class="o">=</span> <span class="p">[</span><span class="n">map_magic</span><span class="o">.</span><span class="n">samp_magic2_2_magic3_map</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">USEKEYS</span><span class="p">]</span>
    <span class="k">elif</span> <span class="nb">type</span> <span class="o">==</span> <span class="s1">&#39;site_int&#39;</span><span class="p">:</span>
        <span class="n">USEKEYS</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;site_int_sigma&#39;</span><span class="p">,</span> <span class="s1">&#39;site_int_sigma_perc&#39;</span><span class="p">,</span> <span class="s1">&#39;site_int_n&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">data_model</span> <span class="o">==</span> <span class="mf">3.0</span><span class="p">:</span>
            <span class="n">USEKEYS</span> <span class="o">=</span> <span class="p">[</span><span class="n">map_magic</span><span class="o">.</span><span class="n">site_magic2_2_magic3_map</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">USEKEYS</span><span class="p">]</span>
    <span class="k">elif</span> <span class="nb">type</span> <span class="o">==</span> <span class="s1">&#39;site_dir&#39;</span><span class="p">:</span>
        <span class="n">USEKEYS</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;site_alpha95&#39;</span><span class="p">,</span> <span class="s1">&#39;site_k&#39;</span><span class="p">,</span> <span class="s1">&#39;site_n&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;site_n_lines&#39;</span><span class="p">,</span> <span class="s1">&#39;site_n_planes&#39;</span><span class="p">,</span> <span class="s1">&#39;site_r&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">data_model</span> <span class="o">==</span> <span class="mf">3.0</span><span class="p">:</span>
            <span class="n">USEKEYS</span> <span class="o">=</span> <span class="p">[</span><span class="n">map_magic</span><span class="o">.</span><span class="n">site_magic2_2_magic3_map</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">USEKEYS</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">ACCEPT</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="k">if</span> <span class="n">ACCEPT</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span> <span class="ow">and</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">USEKEYS</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">ISTRUE</span> <span class="ow">and</span> <span class="n">ACCEPT</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;TRUE&#39;</span> <span class="ow">or</span> <span class="n">ACCEPT</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;True&#39;</span><span class="p">:</span>
                <span class="c1"># this is because Excel always capitalizes True to TRUE and</span>
                <span class="c1"># python doesn&#39;t recognize that as a boolean.  never mind</span>
                <span class="n">ACCEPT</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span>
            <span class="k">elif</span> <span class="n">ACCEPT</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;FALSE&#39;</span> <span class="ow">or</span> <span class="n">ACCEPT</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;False&#39;</span><span class="p">:</span>
                <span class="n">ACCEPT</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span>
            <span class="k">elif</span> <span class="nb">eval</span><span class="p">(</span><span class="n">ACCEPT</span><span class="p">[</span><span class="n">key</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">ACCEPT</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="n">accept</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ACCEPT</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">sigma_types</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">USEKEYS</span> <span class="ow">and</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">accept</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">PmagRec</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="n">sigmas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sigmas</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">PmagRec</span><span class="p">[</span><span class="n">sigmas</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="ow">or</span> <span class="n">PmagRec</span><span class="p">[</span><span class="n">sigmas</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">kill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sigmas</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">kill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sigmas</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">eval</span><span class="p">(</span><span class="n">PmagRec</span><span class="p">[</span><span class="n">sigmas</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span> <span class="o">&gt;</span> <span class="nb">eval</span><span class="p">(</span><span class="n">accept</span><span class="p">[</span><span class="n">sigmas</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span> <span class="ow">and</span> <span class="nb">eval</span><span class="p">(</span><span class="n">PmagRec</span><span class="p">[</span><span class="n">sigmas</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span> <span class="o">&gt;</span> <span class="nb">eval</span><span class="p">(</span><span class="n">accept</span><span class="p">[</span><span class="n">sigmas</span><span class="p">[</span><span class="mi">1</span><span class="p">]]):</span>
            <span class="n">kill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sigmas</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">kill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sigmas</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">sigmas</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">sigmas</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">accept</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="k">if</span> <span class="n">PmagRec</span><span class="p">[</span><span class="n">sigmas</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">&gt;</span> <span class="n">accept</span><span class="p">[</span><span class="n">sigmas</span><span class="p">[</span><span class="mi">0</span><span class="p">]]:</span>
            <span class="n">kill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sigmas</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">accept</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="k">if</span> <span class="n">accept</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">PmagRec</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">or</span> <span class="n">PmagRec</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                <span class="n">kill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sigma_types</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">ISTRUE</span><span class="p">:</span>  <span class="c1"># boolean must be true</span>
                    <span class="k">if</span> <span class="n">PmagRec</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;1&#39;</span><span class="p">:</span>
                        <span class="n">kill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">GREATERTHAN</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">eval</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">PmagRec</span><span class="p">[</span><span class="n">key</span><span class="p">]))</span> <span class="o">&lt;</span> <span class="nb">eval</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">accept</span><span class="p">[</span><span class="n">key</span><span class="p">])):</span>
                        <span class="n">kill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">eval</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">PmagRec</span><span class="p">[</span><span class="n">key</span><span class="p">]))</span> <span class="o">&gt;</span> <span class="nb">eval</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">accept</span><span class="p">[</span><span class="n">key</span><span class="p">])):</span>
                        <span class="n">kill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">kill</span></div>


<div class="viewcode-block" id="flip"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.flip">[docs]</a><span class="k">def</span> <span class="nf">flip</span><span class="p">(</span><span class="n">di_block</span><span class="p">,</span> <span class="n">combine</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Determines &#39;normal&#39; direction along the principle eigenvector, then flips </span>
<span class="sd">    the reverse mode to the antipode.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    di_block : nested list of directions</span>
<span class="sd">    combine : whether to return directions as one di_block (default is False)</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    D1 : normal mode</span>
<span class="sd">    D2 : flipped reverse mode as two DI blocks</span>
<span class="sd">    If combine=True one combined D1 + D2 di_block will be returned</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ppars</span> <span class="o">=</span> <span class="n">doprinc</span><span class="p">(</span><span class="n">di_block</span><span class="p">)</span>  <span class="c1"># get principle direction</span>
    <span class="k">if</span> <span class="n">combine</span><span class="p">:</span>
        <span class="n">D3</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">D1</span><span class="p">,</span> <span class="n">D2</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">di_block</span><span class="p">:</span>
        <span class="n">ang</span> <span class="o">=</span> <span class="n">angle</span><span class="p">([</span><span class="n">rec</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">rec</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[</span><span class="n">ppars</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">],</span> <span class="n">ppars</span><span class="p">[</span><span class="s1">&#39;inc&#39;</span><span class="p">]])</span>
        <span class="k">if</span> <span class="n">ang</span> <span class="o">&gt;</span> <span class="mf">90.</span><span class="p">:</span>
            <span class="n">d</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">180.</span><span class="p">)</span> <span class="o">%</span> <span class="mf">360.</span><span class="p">,</span> <span class="o">-</span><span class="n">rec</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">D2</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">d</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">combine</span><span class="p">:</span>
                <span class="n">D3</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">d</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">D1</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">rec</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">rec</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
            <span class="k">if</span> <span class="n">combine</span><span class="p">:</span>
                <span class="n">D3</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">rec</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">rec</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
    <span class="k">if</span> <span class="n">combine</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">D3</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">D1</span><span class="p">,</span> <span class="n">D2</span></div>


<div class="viewcode-block" id="dia_vgp"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.dia_vgp">[docs]</a><span class="k">def</span> <span class="nf">dia_vgp</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>  <span class="c1"># new function interface by J.Holmes, SIO, 6/1/2011</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts directional data (declination, inclination, alpha95) at a given</span>
<span class="sd">    location (Site latitude, Site longitude) to pole position (pole longitude,</span>
<span class="sd">    pole latitude, dp, dm).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Takes input as (Dec, Inc, a95, Site latitude, Site longitude)</span>
<span class="sd">    Input can be as individual values (5 parameters)</span>
<span class="sd">    or</span>
<span class="sd">    as a list of lists: [[Dec, Inc, a95, lat, lon],[Dec, Inc, a95, lat, lon]]</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    if input is individual values for one pole the return is:</span>
<span class="sd">    pole longitude, pole latitude, dp, dm</span>

<span class="sd">    if input is list of lists the return is:</span>
<span class="sd">    list of pole longitudes, list of pole latitudes, list of dp, list of dm</span>
<span class="sd">    </span>
<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; pmag.dia_vgp(4, 41, 0, 33, -117)</span>
<span class="sd">    (41.68629415047637, 79.86259998889103, 0.0, 0.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># test whether arguments are one 2-D list or 5 floats</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># args comes in as a tuple of multi-dim lists.</span>
        <span class="n">largs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">args</span><span class="p">)</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>  <span class="c1"># scrap the tuple.</span>
        <span class="c1"># reorganize the lists so that we get columns of data in each var.</span>
        <span class="p">(</span><span class="n">decs</span><span class="p">,</span> <span class="n">dips</span><span class="p">,</span> <span class="n">a95s</span><span class="p">,</span> <span class="n">slats</span><span class="p">,</span> <span class="n">slongs</span><span class="p">)</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">largs</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># When args &gt; 1, we are receiving five floats. This usually happens when the invoking script is</span>
        <span class="c1"># executed in interactive mode.</span>
        <span class="p">(</span><span class="n">decs</span><span class="p">,</span> <span class="n">dips</span><span class="p">,</span> <span class="n">a95s</span><span class="p">,</span> <span class="n">slats</span><span class="p">,</span> <span class="n">slongs</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">args</span><span class="p">)</span>

    <span class="c1"># We send all incoming data to numpy in an array form. Even if it means a</span>
    <span class="c1"># 1x1 matrix. That&#39;s OKAY. Really.</span>
    <span class="p">(</span><span class="n">dec</span><span class="p">,</span> <span class="n">dip</span><span class="p">,</span> <span class="n">a95</span><span class="p">,</span> <span class="n">slat</span><span class="p">,</span> <span class="n">slong</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">decs</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dips</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">a95s</span><span class="p">),</span>
                                    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">slats</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">slongs</span><span class="p">))</span>  <span class="c1"># package columns into arrays</span>
    <span class="n">rad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">180.</span>  <span class="c1"># convert to radians</span>
    <span class="n">dec</span><span class="p">,</span> <span class="n">dip</span><span class="p">,</span> <span class="n">a95</span><span class="p">,</span> <span class="n">slat</span><span class="p">,</span> <span class="n">slong</span> <span class="o">=</span> <span class="n">dec</span> <span class="o">*</span> <span class="n">rad</span><span class="p">,</span> <span class="n">dip</span> <span class="o">*</span> \
        <span class="n">rad</span><span class="p">,</span> <span class="n">a95</span> <span class="o">*</span> <span class="n">rad</span><span class="p">,</span> <span class="n">slat</span> <span class="o">*</span> <span class="n">rad</span><span class="p">,</span> <span class="n">slong</span> <span class="o">*</span> <span class="n">rad</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">dip</span><span class="p">))</span>
    <span class="n">plat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">slat</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">+</span>
                     <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">slat</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">dec</span><span class="p">))</span>
    <span class="n">beta</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">dec</span><span class="p">))</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">plat</span><span class="p">)</span>

    <span class="c1"># -------------------------------------------------------------------------</span>
    <span class="c1"># The deal with &quot;boolmask&quot;:</span>
    <span class="c1"># We needed a quick way to assign matrix values based on a logic decision, in this case setting boundaries</span>
    <span class="c1"># on out-of-bounds conditions. Creating a matrix of boolean values the size of the original matrix and using</span>
    <span class="c1"># it to &quot;mask&quot; the assignment solves this problem nicely. The downside to this is that Numpy complains if you</span>
    <span class="c1"># attempt to mask a non-matrix, so we have to check for array type and do a normal assignment if the type is</span>
    <span class="c1"># scalar. These checks are made before calculating for the rest of the function.</span>
    <span class="c1"># -------------------------------------------------------------------------</span>

    <span class="n">boolmask</span> <span class="o">=</span> <span class="n">beta</span> <span class="o">&gt;</span> <span class="mf">1.</span>  <span class="c1"># create a mask of boolean values</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="n">beta</span><span class="p">[</span><span class="n">boolmask</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>  <span class="c1"># assigns 1 only to elements that mask TRUE.</span>
    <span class="c1"># Numpy gets upset if you try our masking trick with a scalar or a 0-D</span>
    <span class="c1"># matrix.</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">boolmask</span><span class="p">:</span>
            <span class="n">beta</span> <span class="o">=</span> <span class="mf">1.</span>
    <span class="n">boolmask</span> <span class="o">=</span> <span class="n">beta</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mf">1.</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="n">beta</span><span class="p">[</span><span class="n">boolmask</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.</span>  <span class="c1"># assigns -1 only to elements that mask TRUE.</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">boolmask</span><span class="p">:</span>
            <span class="n">beta</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.</span>

    <span class="n">beta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span>
    <span class="n">plong</span> <span class="o">=</span> <span class="n">slong</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">-</span> <span class="n">beta</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">slat</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">plat</span><span class="p">))</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
        <span class="n">boolmask</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">slat</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">plat</span><span class="p">)))</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">plong</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="n">plong</span><span class="p">[</span><span class="n">boolmask</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">slong</span> <span class="o">+</span> <span class="n">beta</span><span class="p">)[</span><span class="n">boolmask</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">boolmask</span><span class="p">:</span>
                <span class="n">plong</span> <span class="o">=</span> <span class="n">slong</span> <span class="o">+</span> <span class="n">beta</span>

    <span class="n">boolmask</span> <span class="o">=</span> <span class="p">(</span><span class="n">plong</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">plong</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="n">plong</span><span class="p">[</span><span class="n">boolmask</span><span class="p">]</span> <span class="o">=</span> <span class="n">plong</span><span class="p">[</span><span class="n">boolmask</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">boolmask</span><span class="p">:</span>
            <span class="n">plong</span> <span class="o">=</span> <span class="n">plong</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>

    <span class="n">boolmask</span> <span class="o">=</span> <span class="p">(</span><span class="n">plong</span> <span class="o">&gt;</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">plong</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="n">plong</span><span class="p">[</span><span class="n">boolmask</span><span class="p">]</span> <span class="o">=</span> <span class="n">plong</span><span class="p">[</span><span class="n">boolmask</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">boolmask</span><span class="p">:</span>
            <span class="n">plong</span> <span class="o">=</span> <span class="n">plong</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>

    <span class="n">dm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rad2deg</span><span class="p">(</span><span class="n">a95</span> <span class="o">*</span> <span class="p">(</span><span class="n">old_div</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">p</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">dip</span><span class="p">))))</span>
    <span class="n">dp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rad2deg</span><span class="p">(</span><span class="n">a95</span> <span class="o">*</span> <span class="p">(</span><span class="n">old_div</span><span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)),</span> <span class="mi">2</span><span class="p">)))</span>
    <span class="n">plat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rad2deg</span><span class="p">(</span><span class="n">plat</span><span class="p">)</span>
    <span class="n">plong</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rad2deg</span><span class="p">(</span><span class="n">plong</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">plong</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">plat</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">dp</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">dm</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span></div>


<div class="viewcode-block" id="int_pars"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.int_pars">[docs]</a><span class="k">def</span> <span class="nf">int_pars</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">vds</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Depreciated 9/7/2022 </span>
<span class="sd">    </span>
<span class="sd">    Calculates York regression and paleointensity parameters (with Tauxe Fvds).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># first do linear regression a la York</span>
    <span class="c1"># do Data Model 3 way:</span>
    <span class="k">if</span> <span class="s1">&#39;version&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;version&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">n_key</span> <span class="o">=</span> <span class="s1">&#39;int_n_measurements&#39;</span>
        <span class="n">b_key</span> <span class="o">=</span> <span class="s1">&#39;int_b&#39;</span>
        <span class="n">sigma_key</span> <span class="o">=</span> <span class="s1">&#39;int_b_sigma&#39;</span>
        <span class="n">f_key</span> <span class="o">=</span> <span class="s1">&#39;int_f&#39;</span>
        <span class="n">fvds_key</span> <span class="o">=</span> <span class="s1">&#39;int_fvds&#39;</span>
        <span class="n">g_key</span> <span class="o">=</span> <span class="s1">&#39;int_g&#39;</span>
        <span class="n">q_key</span> <span class="o">=</span> <span class="s1">&#39;int_q&#39;</span>
        <span class="n">b_beta_key</span> <span class="o">=</span> <span class="s1">&#39;int_b_beta&#39;</span>

    <span class="k">else</span><span class="p">:</span>  <span class="c1"># version 2</span>
        <span class="n">n_key</span> <span class="o">=</span> <span class="s1">&#39;specimen_int_n&#39;</span>
        <span class="n">b_key</span> <span class="o">=</span> <span class="s1">&#39;specimen_b&#39;</span>
        <span class="n">sigma_key</span> <span class="o">=</span> <span class="s1">&#39;specimen_b_sigma&#39;</span>
        <span class="n">f_key</span> <span class="o">=</span> <span class="s1">&#39;specimen_f&#39;</span>
        <span class="n">fvds_key</span> <span class="o">=</span> <span class="s1">&#39;specimen_fvds&#39;</span>
        <span class="n">g_key</span> <span class="o">=</span> <span class="s1">&#39;specimen_g&#39;</span>
        <span class="n">q_key</span> <span class="o">=</span> <span class="s1">&#39;specimen_q&#39;</span>
        <span class="n">b_beta_key</span> <span class="o">=</span> <span class="s1">&#39;specimen_b_beta&#39;</span>

    <span class="n">xx</span><span class="p">,</span> <span class="n">yer</span><span class="p">,</span> <span class="n">xer</span><span class="p">,</span> <span class="n">xyer</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">xsum</span><span class="p">,</span> <span class="n">ysum</span><span class="p">,</span> <span class="n">xy</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span>
    <span class="n">xprime</span><span class="p">,</span> <span class="n">yprime</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">pars</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">pars</span><span class="p">[</span><span class="n">n_key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;shouldn&#39;t be here at all!&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">pars</span><span class="p">,</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
        <span class="n">xx</span> <span class="o">+=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mf">2.</span>
        <span class="n">yy</span> <span class="o">+=</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mf">2.</span>
        <span class="n">xy</span> <span class="o">+=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">xsum</span> <span class="o">+=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">ysum</span> <span class="o">+=</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">xsig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">old_div</span><span class="p">((</span><span class="n">xx</span> <span class="o">-</span> <span class="p">(</span><span class="n">old_div</span><span class="p">(</span><span class="n">xsum</span><span class="o">**</span><span class="mf">2.</span><span class="p">,</span> <span class="n">n</span><span class="p">))),</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">)))</span>
    <span class="n">ysig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">old_div</span><span class="p">((</span><span class="n">yy</span> <span class="o">-</span> <span class="p">(</span><span class="n">old_div</span><span class="p">(</span><span class="n">ysum</span><span class="o">**</span><span class="mf">2.</span><span class="p">,</span> <span class="n">n</span><span class="p">))),</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">)))</span>
    <span class="nb">sum</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)):</span>
        <span class="n">yer</span> <span class="o">+=</span> <span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">old_div</span><span class="p">(</span><span class="n">ysum</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span><span class="o">**</span><span class="mf">2.</span>
        <span class="n">xer</span> <span class="o">+=</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">old_div</span><span class="p">(</span><span class="n">xsum</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span><span class="o">**</span><span class="mf">2.</span>
        <span class="n">xyer</span> <span class="o">+=</span> <span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">old_div</span><span class="p">(</span><span class="n">ysum</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">old_div</span><span class="p">(</span><span class="n">xsum</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
    <span class="n">slop</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">old_div</span><span class="p">(</span><span class="n">yer</span><span class="p">,</span> <span class="n">xer</span><span class="p">))</span>
    <span class="n">pars</span><span class="p">[</span><span class="n">b_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">slop</span>
    <span class="n">s1</span> <span class="o">=</span> <span class="mf">2.</span> <span class="o">*</span> <span class="n">yer</span> <span class="o">-</span> <span class="mf">2.</span> <span class="o">*</span> <span class="n">slop</span> <span class="o">*</span> <span class="n">xyer</span>
    <span class="n">s2</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mf">2.</span><span class="p">)</span> <span class="o">*</span> <span class="n">xer</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">old_div</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">))</span>
    <span class="n">pars</span><span class="p">[</span><span class="n">sigma_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">sigma</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">old_div</span><span class="p">((</span><span class="n">xy</span> <span class="o">-</span> <span class="p">(</span><span class="n">xsum</span> <span class="o">*</span> <span class="n">ysum</span> <span class="o">/</span> <span class="n">n</span><span class="p">)),</span> <span class="p">(</span><span class="n">xx</span> <span class="o">-</span> <span class="n">old_div</span><span class="p">((</span><span class="n">xsum</span><span class="o">**</span><span class="mf">2.</span><span class="p">),</span> <span class="n">n</span><span class="p">)))</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">old_div</span><span class="p">((</span><span class="n">s</span> <span class="o">*</span> <span class="n">xsig</span><span class="p">),</span> <span class="n">ysig</span><span class="p">)</span>
    <span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_rsc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span><span class="o">**</span><span class="mf">2.</span>
    <span class="n">ytot</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">ysum</span> <span class="o">/</span> <span class="n">n</span> <span class="o">-</span> <span class="n">slop</span> <span class="o">*</span> <span class="n">xsum</span> <span class="o">/</span> <span class="n">n</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)):</span>
        <span class="n">xprime</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">old_div</span><span class="p">((</span><span class="n">slop</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">ytot</span><span class="p">),</span> <span class="p">(</span><span class="mf">2.</span> <span class="o">*</span> <span class="n">slop</span><span class="p">)))</span>
        <span class="n">yprime</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">old_div</span><span class="p">((</span><span class="n">slop</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">ytot</span><span class="p">),</span> <span class="mf">2.</span><span class="p">))</span> <span class="o">+</span> <span class="n">ytot</span><span class="p">)</span>
    <span class="n">sumdy</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="p">[]</span>
    <span class="n">dyt</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">yprime</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">yprime</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)):</span>
        <span class="n">dy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">yprime</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">yprime</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
        <span class="n">sumdy</span> <span class="o">+=</span> <span class="n">dy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mf">2.</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">dyt</span> <span class="o">/</span> <span class="n">ytot</span>
    <span class="n">pars</span><span class="p">[</span><span class="n">f_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span>
    <span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_ytot&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ytot</span>
    <span class="n">ff</span> <span class="o">=</span> <span class="n">dyt</span> <span class="o">/</span> <span class="n">vds</span>
    <span class="n">pars</span><span class="p">[</span><span class="n">fvds_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ff</span>
    <span class="n">ddy</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">/</span> <span class="n">dyt</span><span class="p">)</span> <span class="o">*</span> <span class="n">sumdy</span>
    <span class="n">g</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">ddy</span> <span class="o">/</span> <span class="n">dyt</span>
    <span class="n">pars</span><span class="p">[</span><span class="n">g_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">g</span>
    <span class="n">q</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">slop</span><span class="p">)</span> <span class="o">*</span> <span class="n">f</span> <span class="o">*</span> <span class="n">g</span> <span class="o">/</span> <span class="n">sigma</span>
    <span class="n">pars</span><span class="p">[</span><span class="n">q_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">q</span>
    <span class="n">pars</span><span class="p">[</span><span class="n">b_beta_key</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">sigma</span> <span class="o">/</span> <span class="n">slop</span>
    <span class="k">return</span> <span class="n">pars</span><span class="p">,</span> <span class="mi">0</span></div>

<span class="k">def</span> <span class="nf">get_curve</span><span class="p">(</span><span class="n">araiblock</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="c1">#   curvature stuff</span>
    <span class="n">pars</span><span class="o">=</span><span class="p">{}</span>
    <span class="n">first_Z</span><span class="p">,</span><span class="n">first_I</span><span class="o">=</span><span class="n">araiblock</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">araiblock</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">first_Z</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">first_Z</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
    <span class="n">first_I</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">first_I</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
    <span class="n">x_Arai</span><span class="o">=</span><span class="n">first_I</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">/</span><span class="n">first_Z</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">y_Arai</span><span class="o">=</span><span class="n">first_Z</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">/</span><span class="n">first_Z</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">krv_data</span><span class="o">=</span><span class="n">lib_k</span><span class="o">.</span><span class="n">AraiCurvature</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x_Arai</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">y_Arai</span><span class="p">)</span>
    <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;int_k&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">krv_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;int_k_sse&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">krv_data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="c1"># segment</span>
    <span class="k">if</span> <span class="s1">&#39;start&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="s1">&#39;end&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">start</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;start&#39;</span><span class="p">]</span>
        <span class="n">end</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;end&#39;</span><span class="p">]</span>
        <span class="n">x_Arai_segment</span> <span class="o">=</span> <span class="n">x_Arai</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">end</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>  <span class="c1"># chosen segent in the Arai plot</span>
        <span class="n">y_Arai_segment</span> <span class="o">=</span> <span class="n">y_Arai</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">end</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>  <span class="c1"># chosen segent in the Arai plot</span>
        <span class="n">krv_data</span><span class="o">=</span><span class="n">lib_k</span><span class="o">.</span><span class="n">AraiCurvature</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x_Arai_segment</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">y_Arai_segment</span><span class="p">)</span>
        <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;int_k_prime&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">krv_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;int_k_prime_sse&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">krv_data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">pars</span>

<div class="viewcode-block" id="dovds"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.dovds">[docs]</a><span class="k">def</span> <span class="nf">dovds</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates vector difference sum for demagnetization data.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : nested array of data </span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    vds : vector difference of data as a float</span>
<span class="sd">    </span>
<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; data = np.array([  [16.0,    43.0, 21620.33],</span>
<span class="sd">           [30.5,    53.6, 12922.58],</span>
<span class="sd">            [6.9,    33.2, 15780.08],</span>
<span class="sd">          [352.5,    40.2, 33947.52], </span>
<span class="sd">          [354.2,    45.1, 19725.45]])</span>
<span class="sd">    &gt;&gt;&gt; pmag.dovds(data)</span>
<span class="sd">    69849.6597634</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">vds</span><span class="p">,</span> <span class="n">X</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dir2cart</span><span class="p">(</span><span class="n">rec</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">xdif</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">X</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">ydif</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">X</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">zdif</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">X</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">vds</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">xdif</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">ydif</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">zdif</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">vds</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">X</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">X</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">vds</span></div>


<div class="viewcode-block" id="vspec_magic"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.vspec_magic">[docs]</a><span class="k">def</span> <span class="nf">vspec_magic</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Takes average vector of replicate measurements.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">vdata</span><span class="p">,</span> <span class="n">Dirdata</span><span class="p">,</span> <span class="n">step_meth</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="s2">&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">vdata</span>
    <span class="n">treat_init</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;treatment_temp&quot;</span><span class="p">,</span> <span class="s2">&quot;treatment_temp_decay_rate&quot;</span><span class="p">,</span> <span class="s2">&quot;treatment_temp_dc_on&quot;</span><span class="p">,</span> <span class="s2">&quot;treatment_temp_dc_off&quot;</span><span class="p">,</span> <span class="s2">&quot;treatment_ac_field&quot;</span><span class="p">,</span> <span class="s2">&quot;treatment_ac_field_decay_rate&quot;</span><span class="p">,</span> <span class="s2">&quot;treatment_ac_field_dc_on&quot;</span><span class="p">,</span>
                  <span class="s2">&quot;treatment_ac_field_dc_off&quot;</span><span class="p">,</span> <span class="s2">&quot;treatment_dc_field&quot;</span><span class="p">,</span> <span class="s2">&quot;treatment_dc_field_decay_rate&quot;</span><span class="p">,</span> <span class="s2">&quot;treatment_dc_field_ac_on&quot;</span><span class="p">,</span> <span class="s2">&quot;treatment_dc_field_ac_off&quot;</span><span class="p">,</span> <span class="s2">&quot;treatment_dc_field_phi&quot;</span><span class="p">,</span> <span class="s2">&quot;treatment_dc_field_theta&quot;</span><span class="p">]</span>
    <span class="n">treats</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1">#</span>
<span class="c1"># find keys that are used</span>
<span class="c1">#</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">treat_init</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="n">treats</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>  <span class="c1"># get a list of keys</span>
    <span class="n">stop</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">stop</span><span class="p">[</span><span class="s2">&quot;er_specimen_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;stop&quot;</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">treats</span><span class="p">:</span>
        <span class="n">stop</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>  <span class="c1"># tells program when to quit and go home</span>
    <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">stop</span><span class="p">)</span>
<span class="c1">#</span>
<span class="c1"># set initial states</span>
<span class="c1">#</span>
    <span class="n">DataState0</span><span class="p">,</span> <span class="n">newstate</span> <span class="o">=</span> <span class="p">{},</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">treats</span><span class="p">:</span>
        <span class="n">DataState0</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">key</span><span class="p">]</span>  <span class="c1"># set beginning treatment</span>
    <span class="n">k</span><span class="p">,</span> <span class="n">R</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>
        <span class="n">FDirdata</span><span class="p">,</span> <span class="n">Dirdata</span><span class="p">,</span> <span class="n">DataStateCurr</span><span class="p">,</span> <span class="n">newstate</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">{},</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">treats</span><span class="p">:</span>  <span class="c1"># check if anything changed</span>
            <span class="n">DataStateCurr</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">key</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">DataStateCurr</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">!=</span> <span class="n">DataState0</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">():</span>
                <span class="n">newstate</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># something changed</span>
        <span class="k">if</span> <span class="n">newstate</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">k</span><span class="p">:</span>  <span class="c1"># sample is unique</span>
                <span class="n">vdata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1"># measurement is not unique</span>
                <span class="c1"># print &quot;averaging: records &quot; ,k,i</span>
                <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
                    <span class="k">if</span> <span class="s1">&#39;orientation&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="n">l</span><span class="p">][</span><span class="s1">&#39;measurement_description&#39;</span><span class="p">]:</span>
                        <span class="n">data</span><span class="p">[</span><span class="n">l</span><span class="p">][</span><span class="s1">&#39;measurement_description&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                    <span class="n">Dirdata</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">l</span><span class="p">][</span><span class="s1">&#39;measurement_dec&#39;</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span>
                        <span class="n">data</span><span class="p">[</span><span class="n">l</span><span class="p">][</span><span class="s1">&#39;measurement_inc&#39;</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">l</span><span class="p">][</span><span class="s1">&#39;measurement_magn_moment&#39;</span><span class="p">])])</span>
                    <span class="n">FDirdata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">l</span><span class="p">][</span><span class="s1">&#39;measurement_dec&#39;</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">l</span><span class="p">][</span><span class="s1">&#39;measurement_inc&#39;</span><span class="p">])])</span>
                <span class="nb">dir</span><span class="p">,</span> <span class="n">R</span> <span class="o">=</span> <span class="n">vector_mean</span><span class="p">(</span><span class="n">Dirdata</span><span class="p">)</span>
                <span class="n">Fpars</span> <span class="o">=</span> <span class="n">fisher_mean</span><span class="p">(</span><span class="n">FDirdata</span><span class="p">)</span>
                <span class="n">vrec</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
                <span class="n">vrec</span><span class="p">[</span><span class="s1">&#39;measurement_dec&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%7.1f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">dir</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">vrec</span><span class="p">[</span><span class="s1">&#39;measurement_inc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%7.1f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">dir</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">vrec</span><span class="p">[</span><span class="s1">&#39;measurement_magn_moment&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%8.3e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                    <span class="n">old_div</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)))</span>
                <span class="n">vrec</span><span class="p">[</span><span class="s1">&#39;measurement_csd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%7.1f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Fpars</span><span class="p">[</span><span class="s1">&#39;csd&#39;</span><span class="p">])</span>
                <span class="n">vrec</span><span class="p">[</span><span class="s1">&#39;measurement_positions&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%7.1f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Fpars</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">])</span>
                <span class="n">vrec</span><span class="p">[</span><span class="s1">&#39;measurement_description&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;average of multiple measurements&#39;</span>
                <span class="k">if</span> <span class="s2">&quot;magic_method_codes&quot;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">vrec</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                    <span class="n">meths</span> <span class="o">=</span> <span class="n">vrec</span><span class="p">[</span><span class="s2">&quot;magic_method_codes&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="s2">&quot;DE-VM&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>
                        <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;DE-VM&quot;</span><span class="p">)</span>
                    <span class="n">methods</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                    <span class="k">for</span> <span class="n">meth</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>
                        <span class="n">methods</span> <span class="o">=</span> <span class="n">methods</span> <span class="o">+</span> <span class="n">meth</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span>
                    <span class="n">vrec</span><span class="p">[</span><span class="s2">&quot;magic_method_codes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">methods</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">vrec</span><span class="p">[</span><span class="s2">&quot;magic_method_codes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;DE-VM&quot;</span>
                <span class="n">vdata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vrec</span><span class="p">)</span>
<span class="c1"># reset state to new one</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">treats</span><span class="p">:</span>
                <span class="n">DataState0</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">key</span><span class="p">]</span>  <span class="c1"># set beginning treatment</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;er_specimen_name&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;stop&quot;</span><span class="p">:</span>
                <span class="k">del</span> <span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># get rid of dummy stop sign</span>
                <span class="k">return</span> <span class="n">vdata</span><span class="p">,</span> <span class="n">treats</span>  <span class="c1"># bye-bye</span></div>


<div class="viewcode-block" id="vspec_magic3"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.vspec_magic3">[docs]</a><span class="k">def</span> <span class="nf">vspec_magic3</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Takes average vector of replicate measurements.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">vdata</span><span class="p">,</span> <span class="n">Dirdata</span><span class="p">,</span> <span class="n">step_meth</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="s2">&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">vdata</span>
    <span class="n">treat_init</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;treat_temp&quot;</span><span class="p">,</span> <span class="s2">&quot;treat_temp_decay_rate&quot;</span><span class="p">,</span> <span class="s2">&quot;treat_temp_dc_on&quot;</span><span class="p">,</span> <span class="s2">&quot;treat_temp_dc_off&quot;</span><span class="p">,</span> <span class="s2">&quot;treat_ac_field&quot;</span><span class="p">,</span> <span class="s2">&quot;treat_ac_field_decay_rate&quot;</span><span class="p">,</span> <span class="s2">&quot;treat_ac_field_dc_on&quot;</span><span class="p">,</span>
                  <span class="s2">&quot;treat_ac_field_dc_off&quot;</span><span class="p">,</span> <span class="s2">&quot;treat_dc_field&quot;</span><span class="p">,</span> <span class="s2">&quot;treat_dc_field_decay_rate&quot;</span><span class="p">,</span> <span class="s2">&quot;treat_dc_field_ac_on&quot;</span><span class="p">,</span> <span class="s2">&quot;treat_dc_field_ac_off&quot;</span><span class="p">,</span> <span class="s2">&quot;treat_dc_field_phi&quot;</span><span class="p">,</span> <span class="s2">&quot;treat_dc_field_theta&quot;</span><span class="p">,</span><span class="s1">&#39;description&#39;</span><span class="p">]</span>
    <span class="n">treats</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1">#</span>
<span class="c1"># find keys that are used</span>
<span class="c1">#</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">treat_init</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="n">treats</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>  <span class="c1"># get a list of keys</span>
    <span class="n">stop</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">stop</span><span class="p">[</span><span class="s2">&quot;specimen&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;stop&quot;</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">treats</span><span class="p">:</span>
        <span class="n">stop</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>  <span class="c1"># tells program when to quit and go home</span>
    <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">stop</span><span class="p">)</span>
<span class="c1">#</span>
<span class="c1"># set initial states</span>
<span class="c1">#</span>
    <span class="n">DataState0</span><span class="p">,</span> <span class="n">newstate</span> <span class="o">=</span> <span class="p">{},</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">treats</span><span class="p">:</span>
        <span class="n">DataState0</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">key</span><span class="p">]</span>  <span class="c1"># set beginning treatment</span>
    <span class="n">k</span><span class="p">,</span> <span class="n">R</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>
        <span class="n">FDirdata</span><span class="p">,</span> <span class="n">Dirdata</span><span class="p">,</span> <span class="n">DataStateCurr</span><span class="p">,</span> <span class="n">newstate</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">{},</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">treats</span><span class="p">:</span>  <span class="c1"># check if anything changed</span>
            <span class="n">DataStateCurr</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">key</span><span class="p">]</span>
            <span class="n">DataStateCurr</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">DataStateCurr</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            <span class="n">DataState0</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">DataState0</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">DataStateCurr</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">!=</span> <span class="n">DataState0</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">():</span>
                <span class="n">newstate</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># something changed</span>
        <span class="k">if</span> <span class="n">newstate</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">k</span><span class="p">:</span>  <span class="c1"># sample is unique</span>
                <span class="n">vdata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1"># measurement is not unique</span>
                <span class="c1"># print &quot;averaging: records &quot; ,k,i</span>
                <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
                    <span class="k">if</span> <span class="s1">&#39;orientation&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="n">l</span><span class="p">][</span><span class="s1">&#39;description&#39;</span><span class="p">]:</span>
                        <span class="n">data</span><span class="p">[</span><span class="n">l</span><span class="p">][</span><span class="s1">&#39;description&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                    <span class="n">Dirdata</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">l</span><span class="p">][</span><span class="s1">&#39;dir_dec&#39;</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span>
                        <span class="n">data</span><span class="p">[</span><span class="n">l</span><span class="p">][</span><span class="s1">&#39;dir_inc&#39;</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">l</span><span class="p">][</span><span class="s1">&#39;magn_moment&#39;</span><span class="p">])])</span>
                    <span class="n">FDirdata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">l</span><span class="p">][</span><span class="s1">&#39;dir_dec&#39;</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">l</span><span class="p">][</span><span class="s1">&#39;dir_inc&#39;</span><span class="p">])])</span>
                <span class="nb">dir</span><span class="p">,</span> <span class="n">R</span> <span class="o">=</span> <span class="n">vector_mean</span><span class="p">(</span><span class="n">Dirdata</span><span class="p">)</span>
                <span class="n">Fpars</span> <span class="o">=</span> <span class="n">fisher_mean</span><span class="p">(</span><span class="n">FDirdata</span><span class="p">)</span>
                <span class="n">vrec</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
                <span class="n">vrec</span><span class="p">[</span><span class="s1">&#39;dir_dec&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%7.1f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">dir</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">vrec</span><span class="p">[</span><span class="s1">&#39;dir_inc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%7.1f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">dir</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">vrec</span><span class="p">[</span><span class="s1">&#39;magn_moment&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%8.3e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">old_div</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)))</span>
                <span class="n">vrec</span><span class="p">[</span><span class="s1">&#39;dir_csd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%7.1f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Fpars</span><span class="p">[</span><span class="s1">&#39;csd&#39;</span><span class="p">])</span>
                <span class="n">vrec</span><span class="p">[</span><span class="s1">&#39;meas_n_orient&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%7.1f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Fpars</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">])</span>
                <span class="n">descr</span><span class="o">=</span><span class="n">vrec</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;: average of multiple measurements&#39;</span>
                <span class="n">descr</span><span class="o">=</span><span class="n">descr</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
                <span class="n">vrec</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span> <span class="o">=</span><span class="n">descr</span>

                <span class="k">if</span> <span class="s2">&quot;method_codes&quot;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">vrec</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                    <span class="n">meths</span> <span class="o">=</span> <span class="n">vrec</span><span class="p">[</span><span class="s2">&quot;method_codes&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="s2">&quot;DE-VM&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>
                        <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;DE-VM&quot;</span><span class="p">)</span>
                    <span class="n">methods</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                    <span class="k">for</span> <span class="n">meth</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>
                        <span class="n">methods</span> <span class="o">=</span> <span class="n">methods</span> <span class="o">+</span> <span class="n">meth</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span>
                    <span class="n">vrec</span><span class="p">[</span><span class="s2">&quot;method_codes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">methods</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">vrec</span><span class="p">[</span><span class="s2">&quot;method_codes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;DE-VM&quot;</span>
                <span class="n">vdata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vrec</span><span class="p">)</span>
<span class="c1"># reset state to new one</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">treats</span><span class="p">:</span>
                <span class="n">DataState0</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">key</span><span class="p">]</span>  <span class="c1"># set beginning treatment</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;specimen&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;stop&quot;</span><span class="p">:</span>
                <span class="k">del</span> <span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># get rid of dummy stop sign</span>
                <span class="k">return</span> <span class="n">vdata</span><span class="p">,</span> <span class="n">treats</span>  <span class="c1"># bye-bye</span></div>


<div class="viewcode-block" id="get_specs"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.get_specs">[docs]</a><span class="k">def</span> <span class="nf">get_specs</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Takes a magic format file and returns a list of unique specimen names.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># sort the specimen names</span>
    <span class="n">speclist</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">spec</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;er_specimen_name&quot;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">spec</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;specimen&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">spec</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">speclist</span><span class="p">:</span>
            <span class="n">speclist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
    <span class="n">speclist</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">speclist</span></div>


<div class="viewcode-block" id="vector_mean"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.vector_mean">[docs]</a><span class="k">def</span> <span class="nf">vector_mean</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the vector mean of a given set of vectors.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data :  nested array of [dec,inc,intensity]</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dir : array of [dec, inc, 1]</span>
<span class="sd">    R : resultant vector length</span>
<span class="sd">    </span>
<span class="sd">    Examples </span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; data=np.loadtxt(&#39;data_files/vector_mean/vector_mean_example.dat&#39;)</span>
<span class="sd">    &gt;&gt;&gt; Dir,R=pmag.vector_mean(data)</span>
<span class="sd">    &gt;&gt;&gt; data.shape[0],Dir[0],Dir[1],R  </span>
<span class="sd">    (100, 1.2702459152657795, 49.62123008281823, 2289431.9813831896)</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; data = np.array([[16.0,    43.0, 21620.33],</span>
<span class="sd">           [30.5,    53.6, 12922.58],</span>
<span class="sd">            [6.9,    33.2, 15780.08],</span>
<span class="sd">          [352.5,    40.2, 33947.52], </span>
<span class="sd">          [354.2,    45.1, 19725.45]])</span>
<span class="sd">    &gt;&gt;&gt; pmag.vector_mean(data)</span>
<span class="sd">    (array([ 3.875568482416763, 43.02570375878505 ,  1.]),</span>
<span class="sd">     102107.93048882612)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Xbar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">))</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">dir2cart</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">Xbar</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Xbar</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">Xbar</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">Xbar</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">Xbar</span> <span class="o">=</span> <span class="n">Xbar</span><span class="o">/</span><span class="n">R</span>
    <span class="nb">dir</span> <span class="o">=</span> <span class="n">cart2dir</span><span class="p">(</span><span class="n">Xbar</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">dir</span><span class="p">,</span> <span class="n">R</span></div>


<div class="viewcode-block" id="mark_dmag_rec"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.mark_dmag_rec">[docs]</a><span class="k">def</span> <span class="nf">mark_dmag_rec</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">ind</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Depreciated 9/14/2022</span>
<span class="sd">    </span>
<span class="sd">    Edits demagnetization data to mark &quot;bad&quot; points with measurement_flag.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">datablock</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">rec</span><span class="p">[</span><span class="s1">&#39;er_specimen_name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">s</span><span class="p">:</span>
            <span class="n">meths</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="s1">&#39;magic_method_codes&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;LT-NO&#39;</span> <span class="ow">in</span> <span class="n">meths</span> <span class="ow">or</span> <span class="s1">&#39;LT-AF-Z&#39;</span> <span class="ow">in</span> <span class="n">meths</span> <span class="ow">or</span> <span class="s1">&#39;LT-T-Z&#39;</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>
                <span class="n">datablock</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">)</span>
    <span class="n">dmagrec</span> <span class="o">=</span> <span class="n">datablock</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>
        <span class="n">meths</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;magic_method_codes&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;LT-NO&#39;</span> <span class="ow">in</span> <span class="n">meths</span> <span class="ow">or</span> <span class="s1">&#39;LT-AF-Z&#39;</span> <span class="ow">in</span> <span class="n">meths</span> <span class="ow">or</span> <span class="s1">&#39;LT-T-Z&#39;</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;er_specimen_name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">s</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;treatment_temp&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">dmagrec</span><span class="p">[</span><span class="s1">&#39;treatment_temp&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;treatment_ac_field&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">dmagrec</span><span class="p">[</span><span class="s1">&#39;treatment_ac_field&#39;</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;measurement_dec&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">dmagrec</span><span class="p">[</span><span class="s1">&#39;measurement_dec&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;measurement_inc&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">dmagrec</span><span class="p">[</span><span class="s1">&#39;measurement_inc&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;measurement_magn_moment&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">dmagrec</span><span class="p">[</span><span class="s1">&#39;measurement_magn_moment&#39;</span><span class="p">]:</span>
                        <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;measurement_flag&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;g&#39;</span><span class="p">:</span>
                            <span class="n">flag</span> <span class="o">=</span> <span class="s1">&#39;b&#39;</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">flag</span> <span class="o">=</span> <span class="s1">&#39;g&#39;</span>
                        <span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;measurement_flag&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">flag</span>
                        <span class="k">break</span>
    <span class="k">return</span> <span class="n">data</span></div>


<span class="k">def</span> <span class="nf">mark_samp</span><span class="p">(</span><span class="n">Samps</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">crd</span><span class="p">):</span>

    <span class="k">return</span> <span class="n">Samps</span>


<div class="viewcode-block" id="find_dmag_rec"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.find_dmag_rec">[docs]</a><span class="k">def</span> <span class="nf">find_dmag_rec</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns demagnetization data for specimen s from the data. Excludes other</span>
<span class="sd">    kinds of experiments and &quot;bad&quot; measurements.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    s : specimen name</span>
<span class="sd">    data : DataFrame with measurement data</span>
<span class="sd">    **kwargs :</span>
<span class="sd">        version : if not 3, assume data model = 2.5</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    datablock : nested list of data for zijderveld plotting</span>
<span class="sd">        [[tr, dec, inc, int, ZI, flag],...]</span>
<span class="sd">        tr : treatment step</span>
<span class="sd">        dec : declination</span>
<span class="sd">        inc : inclination</span>
<span class="sd">        int : intensity</span>
<span class="sd">        ZI : whether zero-field first or infield-first step</span>
<span class="sd">        flag : g or b , default is set to &#39;g&#39;</span>
<span class="sd">    units : list of units found [&#39;T&#39;,&#39;K&#39;,&#39;J&#39;] for tesla, kelvin or joules</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="s1">&#39;version&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;version&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="c1"># convert dataframe to list of dictionaries</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="s1">&#39;records&#39;</span><span class="p">)</span>
        <span class="n">spec_key</span><span class="p">,</span> <span class="n">dec_key</span><span class="p">,</span> <span class="n">inc_key</span> <span class="o">=</span> <span class="s1">&#39;specimen&#39;</span><span class="p">,</span> <span class="s1">&#39;dir_dec&#39;</span><span class="p">,</span> <span class="s1">&#39;dir_inc&#39;</span>
        <span class="n">flag_key</span><span class="p">,</span> <span class="n">temp_key</span><span class="p">,</span> <span class="n">ac_key</span> <span class="o">=</span> <span class="s1">&#39;flag&#39;</span><span class="p">,</span> <span class="s1">&#39;treat_temp&#39;</span><span class="p">,</span> <span class="s1">&#39;treat_ac_field&#39;</span>
        <span class="n">meth_key</span> <span class="o">=</span> <span class="s1">&#39;method_codes&#39;</span>
        <span class="n">power_key</span><span class="p">,</span> <span class="n">time_key</span> <span class="o">=</span> <span class="s1">&#39;treat_mw_power&#39;</span><span class="p">,</span> <span class="s1">&#39;treat_mw_time&#39;</span>
        <span class="n">Mkeys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;magn_moment&#39;</span><span class="p">,</span> <span class="s1">&#39;magn_volume&#39;</span><span class="p">,</span> <span class="s1">&#39;magn_mass&#39;</span><span class="p">,</span> <span class="s1">&#39;magnitude&#39;</span><span class="p">]</span>
        <span class="c1"># just look in the intensity column</span>
        <span class="n">inst_key</span> <span class="o">=</span> <span class="s1">&#39;instrument_codes&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">spec_key</span><span class="p">,</span> <span class="n">dec_key</span><span class="p">,</span> <span class="n">inc_key</span> <span class="o">=</span> <span class="s1">&#39;er_specimen_name&#39;</span><span class="p">,</span> <span class="s1">&#39;measurement_dec&#39;</span><span class="p">,</span> <span class="s1">&#39;measurement_inc&#39;</span>
        <span class="n">flag_key</span> <span class="o">=</span> <span class="s1">&#39;measurement_flag&#39;</span>
        <span class="n">flag_key</span><span class="p">,</span> <span class="n">temp_key</span><span class="p">,</span> <span class="n">ac_key</span> <span class="o">=</span> <span class="s1">&#39;measurement_flag&#39;</span><span class="p">,</span> <span class="s1">&#39;treatment_temp&#39;</span><span class="p">,</span> <span class="s1">&#39;treatment_ac_field&#39;</span>
        <span class="n">meth_key</span> <span class="o">=</span> <span class="s1">&#39;magic_method_codes&#39;</span>
        <span class="n">power_key</span><span class="p">,</span> <span class="n">time_key</span> <span class="o">=</span> <span class="s1">&#39;treatment_mw_power&#39;</span><span class="p">,</span> <span class="s1">&#39;treatment_mw_time&#39;</span>
        <span class="n">Mkeys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;measurement_magn_moment&#39;</span><span class="p">,</span> <span class="s1">&#39;measurement_magn_volume&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;measurement_magn_mass&#39;</span><span class="p">,</span> <span class="s1">&#39;measurement_magnitude&#39;</span><span class="p">]</span>
        <span class="n">inst_key</span> <span class="o">=</span> <span class="s1">&#39;magic_instrument_codes&#39;</span>

    <span class="n">EX</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;LP-AN-ARM&quot;</span><span class="p">,</span> <span class="s2">&quot;LP-AN-TRM&quot;</span><span class="p">,</span> <span class="s2">&quot;LP-ARM-AFD&quot;</span><span class="p">,</span> <span class="s2">&quot;LP-ARM2-AFD&quot;</span><span class="p">,</span> <span class="s2">&quot;LP-TRM-AFD&quot;</span><span class="p">,</span>
          <span class="s2">&quot;LP-TRM&quot;</span><span class="p">,</span> <span class="s2">&quot;LP-TRM-TD&quot;</span><span class="p">,</span> <span class="s2">&quot;LP-X&quot;</span><span class="p">]</span>  <span class="c1"># list of excluded lab protocols</span>
    <span class="n">INC</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;LT-NO&quot;</span><span class="p">,</span> <span class="s2">&quot;LT-AF-Z&quot;</span><span class="p">,</span> <span class="s2">&quot;LT-T-Z&quot;</span><span class="p">,</span>
           <span class="s2">&quot;LT-M-Z&quot;</span><span class="p">,</span> <span class="s2">&quot;LP-PI-TRM-IZ&quot;</span><span class="p">,</span> <span class="s2">&quot;LP-PI-M-IZ&quot;</span><span class="p">]</span>
    <span class="n">datablock</span><span class="p">,</span> <span class="n">tr</span> <span class="o">=</span> <span class="p">[],</span> <span class="s2">&quot;&quot;</span>
    <span class="n">therm_flag</span><span class="p">,</span> <span class="n">af_flag</span><span class="p">,</span> <span class="n">mw_flag</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
    <span class="n">units</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">spec_meas</span> <span class="o">=</span> <span class="n">get_dictitem</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">spec_key</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">spec_meas</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">flag_key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="n">rec</span><span class="p">[</span><span class="n">flag_key</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;g&#39;</span>
        <span class="n">skip</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">tr</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">meths</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="n">meth_key</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
        <span class="n">methods</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>
            <span class="n">methods</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>  <span class="c1"># get rid of the stupid spaces!</span>
        <span class="k">for</span> <span class="n">meth</span> <span class="ow">in</span> <span class="n">methods</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">meth</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="ow">in</span> <span class="n">INC</span><span class="p">:</span>
                <span class="n">skip</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">meth</span> <span class="ow">in</span> <span class="n">EX</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">meth</span> <span class="ow">in</span> <span class="n">methods</span><span class="p">:</span>
                <span class="n">skip</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">skip</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;LT-NO&quot;</span> <span class="ow">in</span> <span class="n">methods</span><span class="p">:</span>
                <span class="n">tr</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="n">temp_key</span><span class="p">])</span>
            <span class="k">if</span> <span class="s2">&quot;LT-AF-Z&quot;</span> <span class="ow">in</span> <span class="n">methods</span><span class="p">:</span>
                <span class="n">af_flag</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">tr</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="n">ac_key</span><span class="p">])</span>
                <span class="k">except</span> <span class="p">(</span><span class="ne">KeyError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
                    <span class="n">tr</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">if</span> <span class="s2">&quot;T&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">units</span><span class="p">:</span>
                    <span class="n">units</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;T&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="s2">&quot;LT-T-Z&quot;</span> <span class="ow">in</span> <span class="n">methods</span><span class="p">:</span>
                <span class="n">therm_flag</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">tr</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="n">temp_key</span><span class="p">])</span>
                <span class="k">if</span> <span class="s2">&quot;K&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">units</span><span class="p">:</span>
                    <span class="n">units</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;K&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="s2">&quot;LT-M-Z&quot;</span> <span class="ow">in</span> <span class="n">methods</span><span class="p">:</span>
                <span class="n">mw_flag</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">tr</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="n">power_key</span><span class="p">])</span> <span class="o">*</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="n">time_key</span><span class="p">])</span>
                <span class="k">if</span> <span class="s2">&quot;J&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">units</span><span class="p">:</span>
                    <span class="n">units</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;J&quot;</span><span class="p">)</span>
            <span class="c1"># looking for in-field first thellier or microwave data -</span>
            <span class="c1"># otherwise, just ignore this</span>
            <span class="k">if</span> <span class="s2">&quot;LP-PI-TRM-IZ&quot;</span> <span class="ow">in</span> <span class="n">methods</span> <span class="ow">or</span> <span class="s2">&quot;LP-PI-M-IZ&quot;</span> <span class="ow">in</span> <span class="n">methods</span><span class="p">:</span>
                <span class="n">ZI</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ZI</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">tr</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">dec</span><span class="p">,</span> <span class="n">inc</span><span class="p">,</span> <span class="nb">int</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span>
                <span class="k">if</span> <span class="n">dec_key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="n">cb</span><span class="o">.</span><span class="n">not_null</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="n">dec_key</span><span class="p">],</span> <span class="kc">False</span><span class="p">):</span>
                    <span class="n">dec</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="n">dec_key</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">inc_key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="n">cb</span><span class="o">.</span><span class="n">not_null</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="n">inc_key</span><span class="p">],</span> <span class="kc">False</span><span class="p">):</span>
                    <span class="n">inc</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="n">inc_key</span><span class="p">])</span>
                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">Mkeys</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="n">cb</span><span class="o">.</span><span class="n">not_null</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="kc">False</span><span class="p">):</span>
                        <span class="nb">int</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">inst_key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                    <span class="n">rec</span><span class="p">[</span><span class="n">inst_key</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                <span class="n">datablock</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="p">[</span><span class="n">tr</span><span class="p">,</span> <span class="n">dec</span><span class="p">,</span> <span class="n">inc</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">ZI</span><span class="p">,</span> <span class="n">rec</span><span class="p">[</span><span class="n">flag_key</span><span class="p">],</span> <span class="n">rec</span><span class="p">[</span><span class="n">inst_key</span><span class="p">]])</span>
    <span class="k">if</span> <span class="n">therm_flag</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">datablock</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">datablock</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0.</span><span class="p">:</span>
                <span class="n">datablock</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">273.</span>
    <span class="k">if</span> <span class="n">af_flag</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">datablock</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">datablock</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">273</span> <span class="ow">and</span> <span class="n">datablock</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">323</span><span class="p">:</span>
                <span class="n">datablock</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>
    <span class="n">meas_units</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">units</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">units</span><span class="p">:</span>
            <span class="n">meas_units</span> <span class="o">=</span> <span class="n">meas_units</span> <span class="o">+</span> <span class="n">u</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span>
        <span class="n">meas_units</span> <span class="o">=</span> <span class="n">meas_units</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">datablock</span><span class="p">,</span> <span class="n">meas_units</span></div>


<div class="viewcode-block" id="open_file"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.open_file">[docs]</a><span class="k">def</span> <span class="nf">open_file</span><span class="p">(</span><span class="n">infile</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Open file and return a list of the file&#39;s lines.</span>
<span class="sd">    Try to use utf-8 encoding, and if that fails use Latin-1.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    infile : str</span>
<span class="sd">        full path to file</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    data: list</span>
<span class="sd">        all lines in the file</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">codecs</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">infile</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">lines</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">())</span>
    <span class="c1"># file might not exist</span>
    <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="s1">&#39;-W- You are trying to open a file: </span><span class="si">{}</span><span class="s1"> that does not exist&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">infile</span><span class="p">))</span>
        <span class="k">return</span> <span class="p">[]</span>
    <span class="c1"># encoding might be wrong</span>
    <span class="k">except</span> <span class="ne">UnicodeDecodeError</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">codecs</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">infile</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="s2">&quot;Latin-1&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span>
                    <span class="s1">&#39;-I- Using less strict decoding for </span><span class="si">{}</span><span class="s1">, output may have formatting errors&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">infile</span><span class="p">))</span>
                <span class="n">lines</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">())</span>
        <span class="c1"># if file exists, and encoding is correct, who knows what the problem is</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-W- &quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">ex</span><span class="p">),</span> <span class="n">ex</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">[]</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-W- &quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">ex</span><span class="p">),</span> <span class="n">ex</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[]</span>
    <span class="c1"># don&#39;t leave a blank line at the end</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)):</span>
            <span class="n">lines</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="k">return</span> <span class="n">lines</span></div>


<div class="viewcode-block" id="magic_read"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.magic_read">[docs]</a><span class="k">def</span> <span class="nf">magic_read</span><span class="p">(</span><span class="n">infile</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_keys</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Reads a Magic template file, returns data in a list of dictionaries.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Required:</span>
<span class="sd">        infile : the MagIC formatted tab delimited data file</span>
<span class="sd">            first line contains &#39;tab&#39; in the first column and the data file type in the second (e.g., measurements, specimen, sample, etc.)</span>
<span class="sd">    Optional:</span>
<span class="sd">        data : data read in with, e.g., file.readlines()</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">        list of dictionaries, file type</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">infile</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">infile</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">return_keys</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">[],</span> <span class="s1">&#39;empty_file&#39;</span><span class="p">,</span> <span class="p">[]</span>
            <span class="k">return</span> <span class="p">[],</span> <span class="s1">&#39;empty_file&#39;</span>
    <span class="n">hold</span><span class="p">,</span> <span class="n">magic_data</span><span class="p">,</span> <span class="n">magic_record</span><span class="p">,</span> <span class="n">magic_keys</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">{},</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">data</span><span class="p">:</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">elif</span> <span class="p">(</span><span class="ow">not</span> <span class="n">data</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">infile</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">return_keys</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[],</span> <span class="s1">&#39;empty_file&#39;</span><span class="p">,</span> <span class="p">[]</span>
        <span class="k">return</span> <span class="p">[],</span> <span class="s1">&#39;empty_file&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># if the file doesn&#39;t exist, end here</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">infile</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">return_keys</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">[],</span> <span class="s1">&#39;bad_file&#39;</span><span class="p">,</span> <span class="p">[]</span>
            <span class="k">return</span> <span class="p">[],</span> <span class="s1">&#39;bad_file&#39;</span>
        <span class="c1"># use custom pmagpy open_file</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="n">open_file</span><span class="p">(</span><span class="n">infile</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">lines</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">return_keys</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[],</span> <span class="s1">&#39;bad_file&#39;</span><span class="p">,</span> <span class="p">[]</span>
        <span class="k">return</span> <span class="p">[],</span> <span class="s1">&#39;bad_file&#39;</span>
    <span class="n">d_line</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\r</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">d_line</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">return_keys</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[],</span> <span class="s1">&#39;empty_file&#39;</span><span class="p">,</span> <span class="p">[]</span>
        <span class="k">return</span> <span class="p">[],</span> <span class="s1">&#39;empty_file&#39;</span>
    <span class="k">if</span> <span class="n">d_line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;s&quot;</span> <span class="ow">or</span> <span class="n">d_line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;s&quot;</span><span class="p">:</span>
        <span class="n">delim</span> <span class="o">=</span> <span class="s1">&#39;space&#39;</span>
    <span class="k">elif</span> <span class="n">d_line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;t&quot;</span> <span class="ow">or</span> <span class="n">d_line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;t&quot;</span><span class="p">:</span>
        <span class="n">delim</span> <span class="o">=</span> <span class="s1">&#39;tab&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-W- error reading </span><span class="si">{}</span><span class="s1">. Check that this is a MagIC-format file&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">infile</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">return_keys</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[],</span> <span class="s1">&#39;bad_file&#39;</span><span class="p">,</span> <span class="p">[]</span>
        <span class="k">return</span> <span class="p">[],</span> <span class="s1">&#39;bad_file&#39;</span>
    <span class="k">if</span> <span class="n">delim</span> <span class="o">==</span> <span class="s1">&#39;space&#39;</span><span class="p">:</span>
        <span class="n">file_type</span> <span class="o">=</span> <span class="n">d_line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">delim</span> <span class="o">==</span> <span class="s1">&#39;tab&#39;</span><span class="p">:</span>
        <span class="n">file_type</span> <span class="o">=</span> <span class="n">d_line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">file_type</span> <span class="o">==</span> <span class="s1">&#39;delimited&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">delim</span> <span class="o">==</span> <span class="s1">&#39;space&#39;</span><span class="p">:</span>
            <span class="n">file_type</span> <span class="o">=</span> <span class="n">d_line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">delim</span> <span class="o">==</span> <span class="s1">&#39;tab&#39;</span><span class="p">:</span>
            <span class="n">file_type</span> <span class="o">=</span> <span class="n">d_line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\r</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">delim</span> <span class="o">==</span> <span class="s1">&#39;space&#39;</span><span class="p">:</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>  <span class="c1"># lines[1][:-1].split()</span>
    <span class="k">if</span> <span class="n">delim</span> <span class="o">==</span> <span class="s1">&#39;tab&#39;</span><span class="p">:</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>  <span class="c1"># lines[1][:-1].split(&#39;\t&#39;)</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
        <span class="n">magic_keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">return_keys</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[],</span> <span class="s1">&#39;empty_file&#39;</span><span class="p">,</span> <span class="p">[]</span>
        <span class="k">return</span> <span class="p">[],</span> <span class="s1">&#39;empty_file&#39;</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
        <span class="n">line</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">delim</span> <span class="o">==</span> <span class="s1">&#39;space&#39;</span><span class="p">:</span>
            <span class="n">rec</span> <span class="o">=</span> <span class="n">line</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">delim</span> <span class="o">==</span> <span class="s1">&#39;tab&#39;</span><span class="p">:</span>
            <span class="n">rec</span> <span class="o">=</span> <span class="n">line</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">hold</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">)</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\r</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">delim</span> <span class="o">==</span> <span class="s1">&#39;space&#39;</span><span class="p">:</span>
        <span class="n">rec</span> <span class="o">=</span> <span class="n">line</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">delim</span> <span class="o">==</span> <span class="s1">&#39;tab&#39;</span><span class="p">:</span>
        <span class="n">rec</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">hold</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">hold</span><span class="p">:</span>
        <span class="n">magic_record</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">magic_keys</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">rec</span><span class="p">):</span>
            <span class="c1"># pad rec with empty strings if needed</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">magic_keys</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">rec</span><span class="p">)):</span>
                <span class="n">rec</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">magic_keys</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rec</span><span class="p">):</span>
            <span class="c1"># ignores this warning when reading the dividers in an upload.txt</span>
            <span class="c1"># composite file</span>
            <span class="k">if</span> <span class="n">rec</span> <span class="o">!=</span> <span class="p">[</span><span class="s1">&#39;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="s1">&#39;delimited&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">rec</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning: Uneven record lengths detected in </span><span class="si">{}</span><span class="s2">: &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">infile</span><span class="p">))</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;keys:&#39;</span><span class="p">,</span> <span class="n">magic_keys</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;record:&#39;</span><span class="p">,</span> <span class="n">rec</span><span class="p">)</span>
        <span class="c1"># modified by Ron Shaar:</span>
        <span class="c1"># add a health check:</span>
        <span class="c1"># if len(magic_keys) &gt; len(rec): take rec</span>
        <span class="c1"># if len(magic_keys) &lt; len(rec): take magic_keys</span>
        <span class="c1"># original code: for k in range(len(rec)):</span>
        <span class="c1"># channged to: for k in range(min(len(magic_keys),len(rec))):</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">magic_keys</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">rec</span><span class="p">))):</span>
            <span class="n">magic_record</span><span class="p">[</span><span class="n">magic_keys</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\r</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">magic_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">magic_record</span><span class="p">)</span>
    <span class="n">magictype</span> <span class="o">=</span> <span class="n">file_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)</span>
    <span class="n">Types</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;er&#39;</span><span class="p">,</span> <span class="s1">&#39;magic&#39;</span><span class="p">,</span> <span class="s1">&#39;pmag&#39;</span><span class="p">,</span> <span class="s1">&#39;rmag&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">magictype</span> <span class="ow">in</span> <span class="n">Types</span><span class="p">:</span>
        <span class="n">file_type</span> <span class="o">=</span> <span class="n">file_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">return_keys</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">magic_data</span><span class="p">,</span> <span class="n">file_type</span><span class="p">,</span> <span class="n">magic_keys</span>
    <span class="k">return</span> <span class="n">magic_data</span><span class="p">,</span> <span class="n">file_type</span></div>


<div class="viewcode-block" id="magic_read_dict"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.magic_read_dict">[docs]</a><span class="k">def</span> <span class="nf">magic_read_dict</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sort_by_this_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_keys</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Read a magic-formatted tab-delimited file and returns a dictionary of dictionaries, with this format:</span>
<span class="sd">    </span>
<span class="sd">    {&#39;Z35.5a&#39;: {&#39;specimen_weight&#39;: &#39;1.000e-03&#39;, &#39;er_citation_names&#39;: &#39;This study&#39;, &#39;specimen_volume&#39;: &#39;&#39;, &#39;er_location_name&#39;: &#39;&#39;, &#39;er_site_name&#39;: &#39;Z35.&#39;, &#39;er_sample_name&#39;: &#39;Z35.5&#39;, &#39;specimen_class&#39;: &#39;&#39;, &#39;er_specimen_name&#39;: &#39;Z35.5a&#39;, &#39;specimen_lithology&#39;: &#39;&#39;, &#39;specimen_type&#39;: &#39;&#39;}, ....}</span>
<span class="sd">    return data, file_type, and keys (if return_keys is true)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">DATA</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="c1">#fin = open(path, &#39;r&#39;)</span>
    <span class="c1">#first_line = fin.readline()</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="n">open_file</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">lines</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">return_keys</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{},</span> <span class="s1">&#39;empty_file&#39;</span><span class="p">,</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{},</span> <span class="s1">&#39;empty_file&#39;</span>
    <span class="n">first_line</span> <span class="o">=</span> <span class="n">lines</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">first_line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;s&quot;</span> <span class="ow">or</span> <span class="n">first_line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;s&quot;</span><span class="p">:</span>
        <span class="n">delim</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>
    <span class="k">elif</span> <span class="n">first_line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;t&quot;</span> <span class="ow">or</span> <span class="n">first_line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;t&quot;</span><span class="p">:</span>
        <span class="n">delim</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-W- error reading &#39;</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">return_keys</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{},</span> <span class="s1">&#39;bad_file&#39;</span><span class="p">,</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{},</span> <span class="s1">&#39;bad_file&#39;</span>

    <span class="n">file_type</span> <span class="o">=</span> <span class="n">first_line</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\r</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">delim</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">item_type</span> <span class="o">=</span> <span class="n">file_type</span>
    <span class="c1">#item_type = file_type.split(&#39;_&#39;)[1][:-1]</span>
    <span class="k">if</span> <span class="n">sort_by_this_name</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">elif</span> <span class="n">item_type</span> <span class="o">==</span> <span class="s1">&#39;age&#39;</span><span class="p">:</span>
        <span class="n">sort_by_this_name</span> <span class="o">=</span> <span class="s2">&quot;by_line_number&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">sort_by_this_name</span> <span class="o">=</span> <span class="n">item_type</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">lines</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">header</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\r</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">delim</span><span class="p">)</span>
    <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
        <span class="n">tmp_data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">tmp_line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\r</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">delim</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">header</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">tmp_line</span><span class="p">):</span>
                <span class="n">tmp_data</span><span class="p">[</span><span class="n">header</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">tmp_line</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">tmp_data</span><span class="p">[</span><span class="n">header</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="n">sort_by_this_name</span> <span class="o">==</span> <span class="s2">&quot;by_line_number&quot;</span><span class="p">:</span>
            <span class="n">DATA</span><span class="p">[</span><span class="n">counter</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp_data</span>
            <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">tmp_data</span><span class="p">[</span><span class="n">sort_by_this_name</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">DATA</span><span class="p">[</span><span class="n">tmp_data</span><span class="p">[</span><span class="n">sort_by_this_name</span><span class="p">]]</span> <span class="o">=</span> <span class="n">tmp_data</span>
    <span class="k">if</span> <span class="n">return_keys</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">DATA</span><span class="p">,</span> <span class="n">file_type</span><span class="p">,</span> <span class="n">header</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">DATA</span><span class="p">,</span> <span class="n">file_type</span></div>


<div class="viewcode-block" id="sort_magic_data"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.sort_magic_data">[docs]</a><span class="k">def</span> <span class="nf">sort_magic_data</span><span class="p">(</span><span class="n">magic_data</span><span class="p">,</span> <span class="n">sort_name</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sort magic_data by header.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    magic_data : table from a MagIC upload (or downloaded) txt file</span>
<span class="sd">    sort_name : str</span>
<span class="sd">        name of header to sort by, (&#39;er_specimen_name&#39; for example)</span>
<span class="sd">    </span>
<span class="sd">    Returns </span>
<span class="sd">    -------</span>
<span class="sd">    magic_data : sorted table by indicated sort_name</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">magic_data_sorted</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">magic_data</span><span class="p">:</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="n">sort_name</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">magic_data_sorted</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="n">magic_data_sorted</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">magic_data_sorted</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">magic_data_sorted</span></div>


<div class="viewcode-block" id="upload_read"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.upload_read">[docs]</a><span class="k">def</span> <span class="nf">upload_read</span><span class="p">(</span><span class="n">infile</span><span class="p">,</span> <span class="n">table</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Depreciated 9/14/2022</span>
<span class="sd">    </span>
<span class="sd">    Reads a table from a MagIC upload (or downloaded) txt file and puts data in a</span>
<span class="sd">    list of dictionaries.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">delim</span> <span class="o">=</span> <span class="s1">&#39;tab&#39;</span>
    <span class="n">hold</span><span class="p">,</span> <span class="n">magic_data</span><span class="p">,</span> <span class="n">magic_record</span><span class="p">,</span> <span class="n">magic_keys</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">{},</span> <span class="p">[]</span>
    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">infile</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="c1">#</span>
<span class="c1"># look for right table</span>
<span class="c1">#</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">file_type</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">file_type</span> <span class="o">==</span> <span class="s1">&#39;delimited&#39;</span><span class="p">:</span>
        <span class="n">file_type</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">delim</span> <span class="o">==</span> <span class="s1">&#39;tab&#39;</span><span class="p">:</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;only tab delimitted files are supported now&quot;</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="k">while</span> <span class="n">file_type</span> <span class="o">!=</span> <span class="n">table</span><span class="p">:</span>
        <span class="k">while</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span> <span class="o">!=</span> <span class="s2">&quot;&gt;&gt;&gt;&gt;&gt;&quot;</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">file_type</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">file_type</span> <span class="o">==</span> <span class="s1">&#39;delimited&#39;</span><span class="p">:</span>
            <span class="n">file_type</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">ine</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span> <span class="o">!=</span> <span class="s2">&quot;&gt;&gt;&gt;&gt;&gt;&quot;</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
            <span class="n">magic_keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">():</span>
            <span class="n">rec</span> <span class="o">=</span> <span class="n">line</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">hold</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">hold</span><span class="p">:</span>
            <span class="n">magic_record</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">magic_keys</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rec</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Uneven record lengths detected: &quot;</span><span class="p">,</span> <span class="n">rec</span><span class="p">)</span>
                <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Return to continue.... &quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">magic_keys</span><span class="p">)):</span>
                <span class="n">magic_record</span><span class="p">[</span><span class="n">magic_keys</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="n">magic_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">magic_record</span><span class="p">)</span>
    <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">magic_data</span></div>


<div class="viewcode-block" id="putout"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.putout">[docs]</a><span class="k">def</span> <span class="nf">putout</span><span class="p">(</span><span class="n">ofile</span><span class="p">,</span> <span class="n">keylist</span><span class="p">,</span> <span class="n">Rec</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Writes out a magic format record to ofile.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pmag_out</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">ofile</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
    <span class="n">outstring</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keylist</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">outstring</span> <span class="o">=</span> <span class="n">outstring</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Rec</span><span class="p">[</span><span class="n">key</span><span class="p">])</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">Rec</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            <span class="c1"># raw_input()</span>
    <span class="n">outstring</span> <span class="o">=</span> <span class="n">outstring</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">pmag_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">outstring</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
    <span class="n">pmag_out</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


<div class="viewcode-block" id="first_rec"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.first_rec">[docs]</a><span class="k">def</span> <span class="nf">first_rec</span><span class="p">(</span><span class="n">ofile</span><span class="p">,</span> <span class="n">Rec</span><span class="p">,</span> <span class="n">file_type</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Opens the file ofile as a magic template file with headers as the keys to Rec.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ofile : string with the path of the input file</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">keylist</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">opened</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="c1"># sometimes Windows needs a little extra time to open a file</span>
    <span class="c1"># or else it throws an error</span>
    <span class="k">while</span> <span class="ow">not</span> <span class="n">opened</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">pmag_out</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">ofile</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
            <span class="n">opened</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">outstring</span> <span class="o">=</span> <span class="s2">&quot;tab </span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">file_type</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="n">pmag_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">outstring</span><span class="p">)</span>
    <span class="n">keystring</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Rec</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="n">keystring</span> <span class="o">=</span> <span class="n">keystring</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">key</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">keylist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">keystring</span> <span class="o">=</span> <span class="n">keystring</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">pmag_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">keystring</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
    <span class="n">pmag_out</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">keylist</span></div>


<div class="viewcode-block" id="magic_write_old"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.magic_write_old">[docs]</a><span class="k">def</span> <span class="nf">magic_write_old</span><span class="p">(</span><span class="n">ofile</span><span class="p">,</span> <span class="n">Recs</span><span class="p">,</span> <span class="n">file_type</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Writes out a magic format list of dictionaries to ofile.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ofile : path to output file</span>
<span class="sd">    Recs : list of dictionaries in MagIC format, or Pandas Dataframe</span>
<span class="sd">    file_type : MagIC table type (e.g., specimens)</span>

<span class="sd">    Effects</span>
<span class="sd">    -------</span>
<span class="sd">    writes a MagIC formatted file from Recs</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">Recs</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;nothing to write&#39;</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="n">pmag_out</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">ofile</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
    <span class="n">outstring</span> <span class="o">=</span> <span class="s2">&quot;tab </span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">file_type</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="n">pmag_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">outstring</span><span class="p">)</span>
    <span class="n">keystring</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">keylist</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Recs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="n">keylist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">keylist</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keylist</span><span class="p">:</span>
        <span class="n">keystring</span> <span class="o">=</span> <span class="n">keystring</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">key</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="n">keystring</span> <span class="o">=</span> <span class="n">keystring</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">pmag_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">keystring</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
    <span class="k">for</span> <span class="n">Rec</span> <span class="ow">in</span> <span class="n">Recs</span><span class="p">:</span>
        <span class="n">outstring</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keylist</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">outstring</span> <span class="o">=</span> <span class="n">outstring</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Rec</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">if</span> <span class="s1">&#39;er_specimen_name&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Rec</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">Rec</span><span class="p">[</span><span class="s1">&#39;er_specimen_name&#39;</span><span class="p">])</span>
                <span class="k">elif</span> <span class="s1">&#39;er_specimen_names&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Rec</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">Rec</span><span class="p">[</span><span class="s1">&#39;er_specimen_names&#39;</span><span class="p">])</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">Rec</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
                <span class="c1"># raw_input()</span>
        <span class="n">outstring</span> <span class="o">=</span> <span class="n">outstring</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">pmag_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">outstring</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
    <span class="n">pmag_out</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


<div class="viewcode-block" id="magic_write"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.magic_write">[docs]</a><span class="k">def</span> <span class="nf">magic_write</span><span class="p">(</span><span class="n">ofile</span><span class="p">,</span> <span class="n">Recs</span><span class="p">,</span> <span class="n">file_type</span><span class="p">,</span> <span class="n">dataframe</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">append</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Writes out a magic format list of dictionaries to ofile.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ofile : path to output file</span>
<span class="sd">    Recs : list of dictionaries in MagIC format OR pandas dataframe</span>
<span class="sd">    file_type : MagIC table type (e.g., specimens)</span>
<span class="sd">    dataframe : boolean</span>
<span class="sd">        if True, Recs is a pandas dataframe which must be converted</span>
<span class="sd">            to a list of dictionaries</span>
<span class="sd">    append : boolean</span>
<span class="sd">        if True, file will be appended to named file</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    [True,False] : True if successful</span>
<span class="sd">    ofile : same as input</span>

<span class="sd">    Effects</span>
<span class="sd">    -------</span>
<span class="sd">    writes a MagIC formatted file from Recs</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">Recs</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No records to write to file </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ofile</span><span class="p">))</span>
        <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;&quot;</span>
    <span class="k">if</span> <span class="n">dataframe</span><span class="p">:</span> <span class="c1"># convert to traditional list of dictionaries</span>
        <span class="n">Recs</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> 
        <span class="n">Recs</span><span class="o">=</span><span class="n">Recs</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="s1">&#39;records&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">ofile</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">ofile</span><span class="p">)[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">ofile</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">append</span><span class="p">:</span>
        <span class="n">pmag_out</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">ofile</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;backslashreplace&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">pmag_out</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">ofile</span><span class="p">,</span> <span class="s1">&#39;w+&#39;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;backslashreplace&quot;</span><span class="p">)</span>
    <span class="n">outstring</span> <span class="o">=</span> <span class="s2">&quot;tab </span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">file_type</span>
    <span class="n">outstring</span> <span class="o">=</span> <span class="n">outstring</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span>
        <span class="s2">&quot;</span><span class="se">\r</span><span class="s2">&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>  <span class="c1"># make sure it&#39;s clean for Windows</span>
    <span class="n">pmag_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">outstring</span><span class="p">)</span>
    <span class="n">keystring</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">keylist</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Recs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="n">keylist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">keylist</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keylist</span><span class="p">:</span>
        <span class="n">keystring</span> <span class="o">=</span> <span class="n">keystring</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">key</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="n">keystring</span> <span class="o">=</span> <span class="n">keystring</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">pmag_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">keystring</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
    <span class="k">for</span> <span class="n">Rec</span> <span class="ow">in</span> <span class="n">Recs</span><span class="p">:</span>
        <span class="n">outstring</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keylist</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">outstring</span> <span class="o">=</span> <span class="n">outstring</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Rec</span><span class="p">[</span><span class="n">key</span><span class="p">])</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">if</span> <span class="s1">&#39;er_specimen_name&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Rec</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">Rec</span><span class="p">[</span><span class="s1">&#39;er_specimen_name&#39;</span><span class="p">])</span>
                <span class="k">elif</span> <span class="s1">&#39;specimen&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Rec</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">Rec</span><span class="p">[</span><span class="s1">&#39;specimen&#39;</span><span class="p">])</span>
                <span class="k">elif</span> <span class="s1">&#39;er_specimen_names&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Rec</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;specimen names:&#39;</span><span class="p">,</span> <span class="n">Rec</span><span class="p">[</span><span class="s1">&#39;er_specimen_names&#39;</span><span class="p">])</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No data for </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">key</span><span class="p">)</span>
                <span class="c1"># just skip it:</span>
                <span class="n">outstring</span> <span class="o">=</span> <span class="n">outstring</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
                <span class="c1"># raw_input()</span>
        <span class="n">outstring</span> <span class="o">=</span> <span class="n">outstring</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">pmag_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">outstring</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
    <span class="n">pmag_out</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Recs</span><span class="p">),</span> <span class="s1">&#39; records written to file &#39;</span><span class="p">,</span> <span class="n">ofile</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="n">ofile</span></div>


<div class="viewcode-block" id="dotilt"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.dotilt">[docs]</a><span class="k">def</span> <span class="nf">dotilt</span><span class="p">(</span><span class="n">dec</span><span class="p">,</span> <span class="n">inc</span><span class="p">,</span> <span class="n">bed_az</span><span class="p">,</span> <span class="n">bed_dip</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Does a tilt correction on a direction (dec,inc) using bedding dip direction</span>
<span class="sd">    and bedding dip.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dec : declination directions in degrees</span>
<span class="sd">    inc : inclination direction in degrees</span>
<span class="sd">    bed_az : bedding dip direction</span>
<span class="sd">    bed_dip : bedding dip</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dec,inc : a tuple of rotated dec, inc values</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; pmag.dotilt(91.2,43.1,90.0,20.0)</span>
<span class="sd">    (90.952568837153436, 23.103411670066617)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">180.</span>  <span class="c1"># converts from degrees to radians</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">dir2cart</span><span class="p">([</span><span class="n">dec</span><span class="p">,</span> <span class="n">inc</span><span class="p">,</span> <span class="mf">1.</span><span class="p">])</span>  <span class="c1"># get cartesian coordinates of dec,inc</span>
<span class="c1"># get some sines and cosines of new coordinate system</span>
    <span class="n">sa</span><span class="p">,</span> <span class="n">ca</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">bed_az</span> <span class="o">*</span> <span class="n">rad</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">bed_az</span> <span class="o">*</span> <span class="n">rad</span><span class="p">)</span>
    <span class="n">cdp</span><span class="p">,</span> <span class="n">sdp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">bed_dip</span> <span class="o">*</span> <span class="n">rad</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">bed_dip</span> <span class="o">*</span> <span class="n">rad</span><span class="p">)</span>
<span class="c1"># do the rotation</span>
    <span class="n">xc</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">sa</span> <span class="o">*</span> <span class="n">sa</span> <span class="o">+</span> <span class="n">ca</span> <span class="o">*</span> <span class="n">ca</span> <span class="o">*</span> <span class="n">cdp</span><span class="p">)</span> <span class="o">+</span> <span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> \
        <span class="p">(</span><span class="n">ca</span> <span class="o">*</span> <span class="n">sa</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">cdp</span><span class="p">))</span> <span class="o">+</span> <span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">sdp</span> <span class="o">*</span> <span class="n">ca</span>
    <span class="n">yc</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">ca</span> <span class="o">*</span> <span class="n">sa</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">cdp</span><span class="p">)</span> <span class="o">+</span> <span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> \
        <span class="p">(</span><span class="n">ca</span> <span class="o">*</span> <span class="n">ca</span> <span class="o">+</span> <span class="n">sa</span> <span class="o">*</span> <span class="n">sa</span> <span class="o">*</span> <span class="n">cdp</span><span class="p">)</span> <span class="o">-</span> <span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">sa</span> <span class="o">*</span> <span class="n">sdp</span>
    <span class="n">zc</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">ca</span> <span class="o">*</span> <span class="n">sdp</span> <span class="o">-</span> <span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">sdp</span> <span class="o">*</span> <span class="n">sa</span> <span class="o">-</span> <span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">cdp</span>
<span class="c1"># convert back to direction:</span>
    <span class="n">Dir</span> <span class="o">=</span> <span class="n">cart2dir</span><span class="p">([</span><span class="n">xc</span><span class="p">,</span> <span class="n">yc</span><span class="p">,</span> <span class="o">-</span><span class="n">zc</span><span class="p">])</span>
    <span class="c1"># return declination, inclination of rotated direction</span>
    <span class="k">return</span> <span class="n">Dir</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Dir</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span></div>


<div class="viewcode-block" id="dotilt_V"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.dotilt_V">[docs]</a><span class="k">def</span> <span class="nf">dotilt_V</span><span class="p">(</span><span class="n">indat</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Does a tilt correction on an array with rows of dec,inc bedding dip direction and dip.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    indat : nested array of [[dec1, inc1, bed_az1, bed_dip1],[dec2,inc2,bed_az2,bed_dip2]...]</span>
<span class="sd">        declination, inclination, bedding dip direction and bedding dip</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dec, inc : arrays of rotated declination, inclination</span>
<span class="sd">        </span>
<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; pmag.dotilt_V(np.array([[91.2,43.1,90.0,20.0],[92.0,40.4,90.5,21.3]]))</span>
<span class="sd">    (array([90.95256883715344, 91.70884991139725]),</span>
<span class="sd">     array([23.103411670066613, 19.105747819853423]))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">indat</span> <span class="o">=</span> <span class="n">indat</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
    <span class="c1"># unpack input array into separate arrays</span>
    <span class="n">dec</span><span class="p">,</span> <span class="n">inc</span><span class="p">,</span> <span class="n">bed_az</span><span class="p">,</span> <span class="n">bed_dip</span> <span class="o">=</span> <span class="n">indat</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">indat</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">indat</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">indat</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">rad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.</span>  <span class="c1"># convert to radians</span>
    <span class="n">Dir</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">dec</span><span class="p">,</span> <span class="n">inc</span><span class="p">])</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">dir2cart</span><span class="p">(</span><span class="n">Dir</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>  <span class="c1"># get cartesian coordinates</span>
    <span class="n">N</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">dec</span><span class="p">)</span>

<span class="c1"># get some sines and cosines of new coordinate system</span>
    <span class="n">sa</span><span class="p">,</span> <span class="n">ca</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">bed_az</span> <span class="o">*</span> <span class="n">rad</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">bed_az</span> <span class="o">*</span> <span class="n">rad</span><span class="p">)</span>
    <span class="n">cdp</span><span class="p">,</span> <span class="n">sdp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">bed_dip</span> <span class="o">*</span> <span class="n">rad</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">bed_dip</span> <span class="o">*</span> <span class="n">rad</span><span class="p">)</span>
<span class="c1"># do the rotation</span>
    <span class="n">xc</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">sa</span> <span class="o">*</span> <span class="n">sa</span> <span class="o">+</span> <span class="n">ca</span> <span class="o">*</span> <span class="n">ca</span> <span class="o">*</span> <span class="n">cdp</span><span class="p">)</span> <span class="o">+</span> <span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> \
        <span class="p">(</span><span class="n">ca</span> <span class="o">*</span> <span class="n">sa</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">cdp</span><span class="p">))</span> <span class="o">+</span> <span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">sdp</span> <span class="o">*</span> <span class="n">ca</span>
    <span class="n">yc</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">ca</span> <span class="o">*</span> <span class="n">sa</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">cdp</span><span class="p">)</span> <span class="o">+</span> <span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> \
        <span class="p">(</span><span class="n">ca</span> <span class="o">*</span> <span class="n">ca</span> <span class="o">+</span> <span class="n">sa</span> <span class="o">*</span> <span class="n">sa</span> <span class="o">*</span> <span class="n">cdp</span><span class="p">)</span> <span class="o">-</span> <span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">sa</span> <span class="o">*</span> <span class="n">sdp</span>
    <span class="n">zc</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">ca</span> <span class="o">*</span> <span class="n">sdp</span> <span class="o">-</span> <span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">sdp</span> <span class="o">*</span> <span class="n">sa</span> <span class="o">-</span> <span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">cdp</span>
<span class="c1"># convert back to direction:</span>
    <span class="n">cart</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">xc</span><span class="p">,</span> <span class="n">yc</span><span class="p">,</span> <span class="o">-</span><span class="n">zc</span><span class="p">])</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
    <span class="n">Dir</span> <span class="o">=</span> <span class="n">cart2dir</span><span class="p">(</span><span class="n">cart</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
    <span class="c1"># return declination, inclination arrays of rotated direction</span>
    <span class="k">return</span> <span class="n">Dir</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Dir</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span></div>


<div class="viewcode-block" id="dogeo"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.dogeo">[docs]</a><span class="k">def</span> <span class="nf">dogeo</span><span class="p">(</span><span class="n">dec</span><span class="p">,</span> <span class="n">inc</span><span class="p">,</span> <span class="n">az</span><span class="p">,</span> <span class="n">pl</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Rotates declination and inclination into geographic coordinates using the</span>
<span class="sd">    azimuth and plunge of the X direction (lab arrow) of a specimen.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dec : declination in specimen coordinates</span>
<span class="sd">    inc : inclination in specimen coordinates</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    rotated_direction : tuple of declination, inclination in geographic coordinates</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; pmag.dogeo(0.0,90.0,0.0,45.5)</span>
<span class="sd">    (180.0, 44.5)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">A1</span><span class="p">,</span> <span class="n">A2</span><span class="p">,</span> <span class="n">A3</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>  <span class="c1"># set up lists for rotation vector</span>
    <span class="c1"># put dec inc in direction list and set  length to unity</span>
    <span class="n">Dir</span> <span class="o">=</span> <span class="p">[</span><span class="n">dec</span><span class="p">,</span> <span class="n">inc</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">dir2cart</span><span class="p">(</span><span class="n">Dir</span><span class="p">)</span>  <span class="c1"># get cartesian coordinates</span>
<span class="c1">#</span>
<span class="c1">#   set up rotation matrix</span>
<span class="c1">#</span>
    <span class="n">A1</span> <span class="o">=</span> <span class="n">dir2cart</span><span class="p">([</span><span class="n">az</span><span class="p">,</span> <span class="n">pl</span><span class="p">,</span> <span class="mf">1.</span><span class="p">])</span>
    <span class="n">A2</span> <span class="o">=</span> <span class="n">dir2cart</span><span class="p">([</span><span class="n">az</span> <span class="o">+</span> <span class="mf">90.</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.</span><span class="p">])</span>
    <span class="n">A3</span> <span class="o">=</span> <span class="n">dir2cart</span><span class="p">([</span><span class="n">az</span> <span class="o">-</span> <span class="mf">180.</span><span class="p">,</span> <span class="mf">90.</span> <span class="o">-</span> <span class="n">pl</span><span class="p">,</span> <span class="mf">1.</span><span class="p">])</span>
<span class="c1">#</span>
<span class="c1"># do rotation</span>
<span class="c1">#</span>
    <span class="n">xp</span> <span class="o">=</span> <span class="n">A1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">A2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">A3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">yp</span> <span class="o">=</span> <span class="n">A1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">A2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">A3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">zp</span> <span class="o">=</span> <span class="n">A1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">A2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">A3</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="c1">#</span>
<span class="c1"># transform back to dec,inc</span>
<span class="c1">#</span>
    <span class="n">Dir_geo</span> <span class="o">=</span> <span class="n">cart2dir</span><span class="p">([</span><span class="n">xp</span><span class="p">,</span> <span class="n">yp</span><span class="p">,</span> <span class="n">zp</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">Dir_geo</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Dir_geo</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>    <span class="c1"># send back declination and inclination</span></div>


<div class="viewcode-block" id="dogeo_V"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.dogeo_V">[docs]</a><span class="k">def</span> <span class="nf">dogeo_V</span><span class="p">(</span><span class="n">indat</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Rotates declination and inclination into geographic coordinates using the</span>
<span class="sd">    azimuth and plunge of the X direction (lab arrow) of a specimen.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    indat : array of lists </span>
<span class="sd">        data format: [dec, inc, az, pl] </span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    two arrays : </span>
<span class="sd">        an array of declinations</span>
<span class="sd">        an array of inclinations</span>
<span class="sd">        </span>
<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; pmag.dogeo_V(np.array([[0.0,90.0,0.0,45.5],[0.0,90.0,0.0,45.5]]))</span>
<span class="sd">    (array([180., 180.]), array([44.5, 44.5]))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">indat</span> <span class="o">=</span> <span class="n">indat</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
    <span class="c1"># unpack input array into separate arrays</span>
    <span class="n">dec</span><span class="p">,</span> <span class="n">inc</span><span class="p">,</span> <span class="n">az</span><span class="p">,</span> <span class="n">pl</span> <span class="o">=</span> <span class="n">indat</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">indat</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">indat</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">indat</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">Dir</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">dec</span><span class="p">,</span> <span class="n">inc</span><span class="p">])</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">dir2cart</span><span class="p">(</span><span class="n">Dir</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>  <span class="c1"># get cartesian coordinates</span>
    <span class="n">N</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">dec</span><span class="p">)</span>
    <span class="n">A1</span> <span class="o">=</span> <span class="n">dir2cart</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">az</span><span class="p">,</span> <span class="n">pl</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span><span class="p">)])</span><span class="o">.</span><span class="n">transpose</span><span class="p">())</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
    <span class="n">A2</span> <span class="o">=</span> <span class="n">dir2cart</span><span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">az</span> <span class="o">+</span> <span class="mf">90.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span><span class="p">)])</span><span class="o">.</span><span class="n">transpose</span><span class="p">())</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
    <span class="n">A3</span> <span class="o">=</span> <span class="n">dir2cart</span><span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">az</span> <span class="o">-</span> <span class="mf">180.</span><span class="p">,</span> <span class="mf">90.</span> <span class="o">-</span> <span class="n">pl</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span><span class="p">)])</span><span class="o">.</span><span class="n">transpose</span><span class="p">())</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>

<span class="c1"># do rotation</span>
<span class="c1">#</span>
    <span class="n">xp</span> <span class="o">=</span> <span class="n">A1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">A2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">A3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">yp</span> <span class="o">=</span> <span class="n">A1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">A2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">A3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">zp</span> <span class="o">=</span> <span class="n">A1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">A2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">A3</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">cart</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">xp</span><span class="p">,</span> <span class="n">yp</span><span class="p">,</span> <span class="n">zp</span><span class="p">])</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="c1">#</span>
<span class="c1"># transform back to dec,inc</span>
<span class="c1">#</span>
    <span class="n">Dir_geo</span> <span class="o">=</span> <span class="n">cart2dir</span><span class="p">(</span><span class="n">cart</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
    <span class="c1"># send back declination and inclination arrays</span>
    <span class="k">return</span> <span class="n">Dir_geo</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Dir_geo</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span></div>


<div class="viewcode-block" id="dodirot"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.dodirot">[docs]</a><span class="k">def</span> <span class="nf">dodirot</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">Dbar</span><span class="p">,</span> <span class="n">Ibar</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Rotate a direction (declination, inclination) by the difference between</span>
<span class="sd">    dec = 0 and inc = 90 and the provided desired mean direction.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    D : declination to be rotated</span>
<span class="sd">    I : inclination to be rotated</span>
<span class="sd">    Dbar : declination of desired mean</span>
<span class="sd">    Ibar : inclination of desired mean</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    drot, irot : rotated declination and inclination</span>
<span class="sd">        </span>
<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; pmag.dodirot(0,90,5,85)</span>
<span class="sd">    (5.0, 85.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">d</span><span class="p">,</span> <span class="n">irot</span> <span class="o">=</span> <span class="n">dogeo</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">Dbar</span><span class="p">,</span> <span class="mf">90.</span> <span class="o">-</span> <span class="n">Ibar</span><span class="p">)</span>
    <span class="n">drot</span> <span class="o">=</span> <span class="n">d</span> <span class="o">-</span> <span class="mf">180.</span>
    <span class="k">if</span> <span class="n">drot</span> <span class="o">&lt;</span> <span class="mf">360.</span><span class="p">:</span>
        <span class="n">drot</span> <span class="o">=</span> <span class="n">drot</span> <span class="o">+</span> <span class="mf">360.</span>
    <span class="k">if</span> <span class="n">drot</span> <span class="o">&gt;</span> <span class="mf">360.</span><span class="p">:</span>
        <span class="n">drot</span> <span class="o">=</span> <span class="n">drot</span> <span class="o">-</span> <span class="mf">360.</span>
    <span class="k">return</span> <span class="n">drot</span><span class="p">,</span> <span class="n">irot</span></div>


<div class="viewcode-block" id="dodirot_V"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.dodirot_V">[docs]</a><span class="k">def</span> <span class="nf">dodirot_V</span><span class="p">(</span><span class="n">di_block</span><span class="p">,</span> <span class="n">Dbar</span><span class="p">,</span> <span class="n">Ibar</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Rotate an array of dec/inc pairs to coordinate system with Dec, Inc as 0, 90.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    di_block : array of [[Dec1,Inc1],[Dec2,Inc2],....]</span>
<span class="sd">    Dbar : Declination of desired center</span>
<span class="sd">    Ibar : Inclination of desired center</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    array </span>
<span class="sd">        Rotated decs and incs: [[rot_Dec1,rot_Inc1],[rot_Dec2,rot_Inc2],....]</span>
<span class="sd">    </span>
<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; di_block = np.array([[0,90],[0,92],[0,92]])</span>
<span class="sd">    &gt;&gt;&gt; pmag.dodirot_V(di_block,5,93)</span>
<span class="sd">    array([[185.              ,  87.00000000000009],</span>
<span class="sd">       [194.81338201697608,  88.97743662195866],</span>
<span class="sd">       [194.81338201697608,  88.97743662195866]])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">N</span> <span class="o">=</span> <span class="n">di_block</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">DipDir</span><span class="p">,</span> <span class="n">Dip</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span>
    <span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Dbar</span><span class="o">-</span><span class="mf">180.</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">*</span><span class="p">(</span><span class="mf">90.</span><span class="o">-</span><span class="n">Ibar</span><span class="p">)</span>
    <span class="n">di_block</span> <span class="o">=</span> <span class="n">di_block</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">di_block</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">di_block</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">DipDir</span><span class="p">,</span> <span class="n">Dip</span><span class="p">])</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
    <span class="n">drot</span><span class="p">,</span> <span class="n">irot</span> <span class="o">=</span> <span class="n">dotilt_V</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="c1">#drot = (drot-180.) % 360.  #</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">drot</span><span class="p">,</span> <span class="n">irot</span><span class="p">))</span></div>


<div class="viewcode-block" id="find_samp_rec"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.find_samp_rec">[docs]</a><span class="k">def</span> <span class="nf">find_samp_rec</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">az_type</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Find the orientation info for samp s</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">datablock</span><span class="p">,</span> <span class="n">or_error</span><span class="p">,</span> <span class="n">bed_error</span> <span class="o">=</span> <span class="p">[],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
    <span class="n">orient</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">orient</span><span class="p">[</span><span class="s2">&quot;sample_dip&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">orient</span><span class="p">[</span><span class="s2">&quot;sample_azimuth&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">orient</span><span class="p">[</span><span class="s1">&#39;sample_description&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;er_sample_name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="n">s</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
            <span class="k">if</span> <span class="s1">&#39;sample_orientation_flag&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="n">rec</span><span class="p">[</span><span class="s1">&#39;sample_orientation_flag&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span>
                <span class="n">orient</span><span class="p">[</span><span class="s1">&#39;sample_orientation_flag&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;b&#39;</span>
                <span class="k">return</span> <span class="n">orient</span>
            <span class="k">if</span> <span class="s2">&quot;magic_method_codes&quot;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="n">az_type</span> <span class="o">!=</span> <span class="s2">&quot;0&quot;</span><span class="p">:</span>
                <span class="n">methods</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;magic_method_codes&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">az_type</span> <span class="ow">in</span> <span class="n">methods</span> <span class="ow">and</span> <span class="s2">&quot;sample_azimuth&quot;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;sample_azimuth&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                    <span class="n">orient</span><span class="p">[</span><span class="s2">&quot;sample_azimuth&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;sample_azimuth&quot;</span><span class="p">])</span>
                <span class="k">if</span> <span class="s2">&quot;sample_dip&quot;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;sample_dip&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                    <span class="n">orient</span><span class="p">[</span><span class="s2">&quot;sample_dip&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;sample_dip&quot;</span><span class="p">])</span>
                <span class="k">if</span> <span class="s2">&quot;sample_bed_dip_direction&quot;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;sample_bed_dip_direction&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                    <span class="n">orient</span><span class="p">[</span><span class="s2">&quot;sample_bed_dip_direction&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span>
                        <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;sample_bed_dip_direction&quot;</span><span class="p">])</span>
                <span class="k">if</span> <span class="s2">&quot;sample_bed_dip&quot;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;sample_bed_dip&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                    <span class="n">orient</span><span class="p">[</span><span class="s2">&quot;sample_bed_dip&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;sample_bed_dip&quot;</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;sample_azimuth&quot;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                    <span class="n">orient</span><span class="p">[</span><span class="s2">&quot;sample_azimuth&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;sample_azimuth&quot;</span><span class="p">])</span>
                <span class="k">if</span> <span class="s2">&quot;sample_dip&quot;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                    <span class="n">orient</span><span class="p">[</span><span class="s2">&quot;sample_dip&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;sample_dip&quot;</span><span class="p">])</span>
                <span class="k">if</span> <span class="s2">&quot;sample_bed_dip_direction&quot;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                    <span class="n">orient</span><span class="p">[</span><span class="s2">&quot;sample_bed_dip_direction&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span>
                        <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;sample_bed_dip_direction&quot;</span><span class="p">])</span>
                <span class="k">if</span> <span class="s2">&quot;sample_bed_dip&quot;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                    <span class="n">orient</span><span class="p">[</span><span class="s2">&quot;sample_bed_dip&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;sample_bed_dip&quot;</span><span class="p">])</span>
                <span class="k">if</span> <span class="s1">&#39;sample_description&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                    <span class="n">orient</span><span class="p">[</span><span class="s1">&#39;sample_description&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="s1">&#39;sample_description&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">orient</span><span class="p">[</span><span class="s2">&quot;sample_azimuth&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="k">break</span>
    <span class="k">return</span> <span class="n">orient</span></div>


<div class="viewcode-block" id="vspec"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.vspec">[docs]</a><span class="k">def</span> <span class="nf">vspec</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Depreciated 9/14/2022</span>
<span class="sd">    </span>
<span class="sd">    Takes the vector mean of replicate measurements at a given step.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">vdata</span><span class="p">,</span> <span class="n">Dirdata</span><span class="p">,</span> <span class="n">step_meth</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">tr0</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># set beginning treatment</span>
    <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Stop&quot;</span><span class="p">)</span>
    <span class="n">k</span><span class="p">,</span> <span class="n">R</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>
        <span class="n">Dirdata</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">tr0</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">k</span><span class="p">:</span>  <span class="c1"># sample is unique</span>
                <span class="n">vdata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
                <span class="n">step_meth</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1"># sample is not unique</span>
                <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
                    <span class="n">Dirdata</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">data</span><span class="p">[</span><span class="n">l</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="n">l</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="n">l</span><span class="p">][</span><span class="mi">3</span><span class="p">]])</span>
                <span class="nb">dir</span><span class="p">,</span> <span class="n">R</span> <span class="o">=</span> <span class="n">vector_mean</span><span class="p">(</span><span class="n">Dirdata</span><span class="p">)</span>
                <span class="n">vdata</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">data</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="nb">dir</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">dir</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                              <span class="n">old_div</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)),</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">])</span>
                <span class="n">step_meth</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;DE-VM&quot;</span><span class="p">)</span>
            <span class="n">tr0</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">tr0</span> <span class="o">==</span> <span class="s2">&quot;stop&quot;</span><span class="p">:</span>
                <span class="k">break</span>
    <span class="k">del</span> <span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">step_meth</span><span class="p">,</span> <span class="n">vdata</span></div>


<div class="viewcode-block" id="Vdiff"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.Vdiff">[docs]</a><span class="k">def</span> <span class="nf">Vdiff</span><span class="p">(</span><span class="n">D1</span><span class="p">,</span> <span class="n">D2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the vector difference between two directions D1, D2.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    D1 : Direction 1 as an array of [declination, inclination] pair or pairs</span>
<span class="sd">    D2 : Direction 2 as an array of [declination, inclination] pair or pairs</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    ------</span>
<span class="sd">    array </span>
<span class="sd">        The vector difference between D1 and D2</span>
<span class="sd">        </span>
<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; pmag.Vdiff([350.0,10.0],[320.0,20.0])</span>
<span class="sd">    array([ 60.00000000000001 , -18.61064009110688 ,   0.527588019973717])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">dir2cart</span><span class="p">([</span><span class="n">D1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">D1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mf">1.</span><span class="p">])</span>
    <span class="n">B</span> <span class="o">=</span> <span class="n">dir2cart</span><span class="p">([</span><span class="n">D2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">D2</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mf">1.</span><span class="p">])</span>
    <span class="n">C</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">C</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">cart2dir</span><span class="p">(</span><span class="n">C</span><span class="p">)</span></div>


<div class="viewcode-block" id="angle"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.angle">[docs]</a><span class="k">def</span> <span class="nf">angle</span><span class="p">(</span><span class="n">D1</span><span class="p">,</span> <span class="n">D2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the angle between two directions.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    D1 : Direction 1 as an array of [declination, inclination] pair or pairs</span>
<span class="sd">    D2 : Direction 2 as an array of [declination, inclination] pair or pairs</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    angle : single-element array </span>
<span class="sd">        angle between the input directions</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; pmag.angle([350.0,10.0],[320.0,20.0])</span>
<span class="sd">    array([ 30.59060998])</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; pmag.angle([[350.0,10.0],[320.0,20.0]],[[345,13],[340,14]])</span>
<span class="sd">    array([ 5.744522410794302, 20.026413431433475])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">D1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">D1</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">D1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">D1</span> <span class="o">=</span> <span class="n">D1</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>  <span class="c1"># strip off intensity</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">D1</span> <span class="o">=</span> <span class="n">D1</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">D2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">D2</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">D2</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">D2</span> <span class="o">=</span> <span class="n">D2</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>  <span class="c1"># strip off intensity</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">D2</span> <span class="o">=</span> <span class="n">D2</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">X1</span> <span class="o">=</span> <span class="n">dir2cart</span><span class="p">(</span><span class="n">D1</span><span class="p">)</span>  <span class="c1"># convert to cartesian from polar</span>
    <span class="n">X2</span> <span class="o">=</span> <span class="n">dir2cart</span><span class="p">(</span><span class="n">D2</span><span class="p">)</span>
    <span class="n">angles</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># set up a list for angles</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>  <span class="c1"># single vector</span>
        <span class="n">angle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X1</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">X2</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span> <span class="o">*</span> \
            <span class="mf">180.</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>  <span class="c1"># take the dot product</span>
        <span class="n">angle</span> <span class="o">=</span> <span class="n">angle</span> <span class="o">%</span> <span class="mf">360.</span>
        <span class="n">angles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">angles</span><span class="p">)</span></div>


<div class="viewcode-block" id="cart2dir"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.cart2dir">[docs]</a><span class="k">def</span> <span class="nf">cart2dir</span><span class="p">(</span><span class="n">cart</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts a direction in cartesian coordinates into declinations and inclination.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    cart : list of [x,y,z] or list of lists [[x1,y1,z1],[x2,y2,z2]...]</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    direction_array : array of [declination, inclination, intensity]</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; pmag.cart2dir([0,1,0])</span>
<span class="sd">    array([ 90.,   0.,   1.])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cart</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">cart</span><span class="p">)</span>
    <span class="n">rad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.</span>  <span class="c1"># constant to convert degrees to radians</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cart</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">Xs</span><span class="p">,</span> <span class="n">Ys</span><span class="p">,</span> <span class="n">Zs</span> <span class="o">=</span> <span class="n">cart</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">cart</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">cart</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># single vector</span>
        <span class="n">Xs</span><span class="p">,</span> <span class="n">Ys</span><span class="p">,</span> <span class="n">Zs</span> <span class="o">=</span> <span class="n">cart</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cart</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">cart</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">iscomplexobj</span><span class="p">(</span><span class="n">Xs</span><span class="p">):</span>
        <span class="n">Xs</span> <span class="o">=</span> <span class="n">Xs</span><span class="o">.</span><span class="n">real</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">iscomplexobj</span><span class="p">(</span><span class="n">Ys</span><span class="p">):</span>
        <span class="n">Ys</span> <span class="o">=</span> <span class="n">Ys</span><span class="o">.</span><span class="n">real</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">iscomplexobj</span><span class="p">(</span><span class="n">Zs</span><span class="p">):</span>
        <span class="n">Zs</span> <span class="o">=</span> <span class="n">Zs</span><span class="o">.</span><span class="n">real</span>
    <span class="n">Rs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Xs</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Ys</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Zs</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># calculate resultant vector length</span>
    <span class="c1"># calculate declination taking care of correct quadrants (arctan2) and</span>
    <span class="c1"># making modulo 360.</span>
    <span class="n">Decs</span> <span class="o">=</span> <span class="p">(</span><span class="n">old_div</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">Ys</span><span class="p">,</span> <span class="n">Xs</span><span class="p">),</span> <span class="n">rad</span><span class="p">))</span> <span class="o">%</span> <span class="mf">360.</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># calculate inclination (converting to degrees) #</span>
        <span class="n">Incs</span> <span class="o">=</span> <span class="n">old_div</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="n">old_div</span><span class="p">(</span><span class="n">Zs</span><span class="p">,</span> <span class="n">Rs</span><span class="p">)),</span> <span class="n">rad</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;trouble in cart2dir&#39;</span><span class="p">)</span>  <span class="c1"># most likely division by zero somewhere</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    
    <span class="n">direction_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">Decs</span><span class="p">,</span> <span class="n">Incs</span><span class="p">,</span> <span class="n">Rs</span><span class="p">])</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>  <span class="c1"># directions list</span>
    
    <span class="k">return</span> <span class="n">direction_array</span>  <span class="c1"># return the directions list</span></div>


<div class="viewcode-block" id="tauV"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.tauV">[docs]</a><span class="k">def</span> <span class="nf">tauV</span><span class="p">(</span><span class="n">T</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Gets the eigenvalues (tau) and eigenvectors (V) from 3x3 matrix T.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    T : 3x3 matrix </span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    t : eigenvalues for the given matrix (T)</span>
<span class="sd">    V : eigenvectors for the given matrix (T)</span>
<span class="sd">        </span>
<span class="sd">    Examples </span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; T = [[2,4,6],</span>
<span class="sd">             [10,2,5],</span>
<span class="sd">             [1,7,8]]</span>
<span class="sd">    &gt;&gt;&gt; pmag.tauV(T)</span>
<span class="sd">    ([(1.2709559412652764+0j),</span>
<span class="sd">      (-0.13547797063263817+0.11627030078868397j),</span>
<span class="sd">      (-0.13547797063263817-0.11627030078868397j)],</span>
<span class="sd">     [array([0.473150982577391+0.j, 0.600336609447566+0.j,</span>
<span class="sd">         0.644766704353637+0.j]),</span>
<span class="sd">      array([-0.006695867252108+0.161305398937403j,</span>
<span class="sd">          0.801217123829199+0.j               ,</span>
<span class="sd">         -0.567608562961462-0.09903218351161j ]),</span>
<span class="sd">      array([-0.006695867252108-0.161305398937403j,</span>
<span class="sd">          0.801217123829199-0.j               ,</span>
<span class="sd">         -0.567608562961462+0.09903218351161j ])])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">t</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">tr</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="mf">0.</span>
    <span class="n">ind1</span><span class="p">,</span> <span class="n">ind2</span><span class="p">,</span> <span class="n">ind3</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
    <span class="n">evalues</span><span class="p">,</span> <span class="n">evectmps</span> <span class="o">=</span> <span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="c1"># to make compatible with Numeric convention</span>
    <span class="n">evectors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">evectmps</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">tau</span> <span class="ow">in</span> <span class="n">evalues</span><span class="p">:</span>
        <span class="n">tr</span> <span class="o">+=</span> <span class="n">tau</span>
    <span class="k">if</span> <span class="n">tr</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="n">evalues</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">old_div</span><span class="p">(</span><span class="n">evalues</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">tr</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">t</span><span class="p">,</span> <span class="n">V</span>
<span class="c1"># sort evalues,evectors</span>
    <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">t3</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">evalues</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">t1</span><span class="p">:</span>
            <span class="n">t1</span><span class="p">,</span> <span class="n">ind1</span> <span class="o">=</span> <span class="n">evalues</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">k</span>
        <span class="k">if</span> <span class="n">evalues</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">t3</span><span class="p">:</span>
            <span class="n">t3</span><span class="p">,</span> <span class="n">ind3</span> <span class="o">=</span> <span class="n">evalues</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">k</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">evalues</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">!=</span> <span class="n">t1</span> <span class="ow">and</span> <span class="n">evalues</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">!=</span> <span class="n">t3</span><span class="p">:</span>
            <span class="n">t2</span><span class="p">,</span> <span class="n">ind2</span> <span class="o">=</span> <span class="n">evalues</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">k</span>
    <span class="n">V</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">evectors</span><span class="p">[</span><span class="n">ind1</span><span class="p">])</span>
    <span class="n">V</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">evectors</span><span class="p">[</span><span class="n">ind2</span><span class="p">])</span>
    <span class="n">V</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">evectors</span><span class="p">[</span><span class="n">ind3</span><span class="p">])</span>
    <span class="n">t</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t1</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t2</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t3</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">t</span><span class="p">,</span> <span class="n">V</span></div>


<div class="viewcode-block" id="Tmatrix"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.Tmatrix">[docs]</a><span class="k">def</span> <span class="nf">Tmatrix</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Gets the orientation matrix (T) from data in X.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    X : nested lists of input data </span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    T : orientation matrix as a nested list</span>
<span class="sd">    </span>
<span class="sd">    Examples </span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; X = [[1., 0.8, 5.], [0.5, 0.2, 2.], [1.4, 0.6, 0.1]]</span>
<span class="sd">    &gt;&gt;&gt; pmag.Tmatrix(X)</span>
<span class="sd">    [[3.21, 1.74, 6.14], [1.74, 1.04, 4.46], [6.14, 4.46, 29.01]]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">T</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]]</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">X</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
                <span class="n">T</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">l</span><span class="p">]</span> <span class="o">+=</span> <span class="n">row</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="n">l</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">T</span></div>


<div class="viewcode-block" id="dir2cart"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.dir2cart">[docs]</a><span class="k">def</span> <span class="nf">dir2cart</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts a list or array of vector directions in degrees (declination,</span>
<span class="sd">    inclination) to an array of the direction in cartesian coordinates (x,y,z).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    d : list or array of [dec,inc] or [dec,inc,intensity]</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    cart : array of [x,y,z]</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; pmag.dir2cart([200,40,1])</span>
<span class="sd">    array([-0.71984631, -0.26200263,  0.64278761])</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; pmag.dir2cart([200,40])</span>
<span class="sd">    array([[-0.719846310392954, -0.262002630229385,  0.642787609686539]])</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; data = np.array([  [16.0,    43.0, 21620.33],</span>
<span class="sd">           [30.5,    53.6, 12922.58],</span>
<span class="sd">            [6.9,    33.2, 15780.08],</span>
<span class="sd">          [352.5,    40.2, 33947.52], </span>
<span class="sd">          [354.2,    45.1, 19725.45]])</span>
<span class="sd">    &gt;&gt;&gt; pmag.dir2cart(data)</span>
<span class="sd">    array([[15199.574113612794 ,  4358.407742577491 , 14745.029604010038 ],</span>
<span class="sd">       [ 6607.405832448041 ,  3892.0594770716   , 10401.304487835589 ],</span>
<span class="sd">       [13108.574245285025 ,  1586.3117853121191,  8640.591471770322 ],</span>
<span class="sd">       [25707.154931463603 , -3384.411152593326 , 21911.687763162565 ],</span>
<span class="sd">       [13852.355235322588 , -1407.0709331498472, 13972.322052043308 ]])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.</span>
    <span class="n">ints</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">))</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>  <span class="c1"># get an array of ones to plug into dec,inc pairs</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># array of vectors</span>
        <span class="n">decs</span><span class="p">,</span> <span class="n">incs</span> <span class="o">=</span> <span class="n">d</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">rad</span><span class="p">,</span> <span class="n">d</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">rad</span>
        <span class="k">if</span> <span class="n">d</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">ints</span> <span class="o">=</span> <span class="n">d</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>  <span class="c1"># take the given lengths</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># single vector</span>
        <span class="n">decs</span><span class="p">,</span> <span class="n">incs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">*</span> <span class="n">rad</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="o">*</span> <span class="n">rad</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">ints</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ints</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">])</span>
    <span class="n">cart</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ints</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">decs</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">incs</span><span class="p">),</span> <span class="n">ints</span> <span class="o">*</span>
                     <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">decs</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">incs</span><span class="p">),</span> <span class="n">ints</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">incs</span><span class="p">)])</span>
    <span class="n">cart</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ints</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">decs</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">incs</span><span class="p">),</span> <span class="n">ints</span> <span class="o">*</span>
                     <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">decs</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">incs</span><span class="p">),</span> <span class="n">ints</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">incs</span><span class="p">)])</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">cart</span></div>


<div class="viewcode-block" id="dms2dd"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.dms2dd">[docs]</a><span class="k">def</span> <span class="nf">dms2dd</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts a list or array of degree, minute, second locations to an array of decimal degrees. </span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    d : list or array of [deg, min, sec]</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    d : input list or array </span>
<span class="sd">    dd : int </span>
<span class="sd">        decimal degree corresponding to d</span>
<span class="sd">        </span>
<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; pmag.dms2dd([60,35,15])</span>
<span class="sd">    60 35 15</span>
<span class="sd">    array(60.587500000000006)</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; data = np.array([  [16.0,    43.0, 33],</span>
<span class="sd">           [30.5,    53.6, 58],</span>
<span class="sd">            [6.9,    33.2, 8],</span>
<span class="sd">          [352.5,    40.2, 52], </span>
<span class="sd">          [354.2,    45.1, 45]])</span>
<span class="sd">    &gt;&gt;&gt; pmag.dms2dd(data)</span>
<span class="sd">    [ 16.   30.5   6.9 352.5 354.2] [43.  53.6 33.2 40.2 45.1] [33. 58.  8. 52. 45.]</span>
<span class="sd">array([ 16.72583333333333 ,  31.409444444444446,   7.455555555555557,</span>
<span class="sd">       353.18444444444447 , 354.96416666666664 ])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># converts list or array of degree, minute, second locations to array of</span>
    <span class="c1"># decimal degrees</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># array of angles</span>
        <span class="n">degs</span><span class="p">,</span> <span class="n">mins</span><span class="p">,</span> <span class="n">secs</span> <span class="o">=</span> <span class="n">d</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">d</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">d</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">degs</span><span class="p">,</span> <span class="n">mins</span><span class="p">,</span> <span class="n">secs</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># single vector</span>
        <span class="n">degs</span><span class="p">,</span> <span class="n">mins</span><span class="p">,</span> <span class="n">secs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="c1">#print(degs, mins, secs)</span>
    <span class="n">dd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">degs</span> <span class="o">+</span> <span class="n">old_div</span><span class="p">(</span><span class="n">mins</span><span class="p">,</span> <span class="mf">60.</span><span class="p">)</span> <span class="o">+</span> <span class="n">old_div</span><span class="p">(</span><span class="n">secs</span><span class="p">,</span> <span class="mf">3600.</span><span class="p">))</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">dd</span></div>


<div class="viewcode-block" id="findrec"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.findrec">[docs]</a><span class="k">def</span> <span class="nf">findrec</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Finds all the records belonging to s in data.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    s : str</span>
<span class="sd">        data value of interest</span>
<span class="sd">    data : nested list of data </span>
<span class="sd">        eg. [[treatment,dec,inc,int,quality],...]</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    datablock : nested list of data relating to s</span>
<span class="sd">    </span>
<span class="sd">    Examples </span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; data = [[&#39;treatment&#39;,&#39;dec&#39;,&#39;inc&#39;,&#39;int&#39;,&#39;quality&#39;],[&#39;treatment1&#39;,&#39;dec1&#39;,&#39;inc1&#39;,&#39;int1&#39;,&#39;quality1&#39;]]</span>
<span class="sd">    &gt;&gt;&gt; pmag.findrec(&#39;treatment&#39;, data)</span>
<span class="sd">    [[&#39;dec&#39;, &#39;inc&#39;, &#39;int&#39;, &#39;quality&#39;]]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">datablock</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">s</span> <span class="o">==</span> <span class="n">rec</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="n">datablock</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">rec</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">rec</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">rec</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">rec</span><span class="p">[</span><span class="mi">4</span><span class="p">]])</span>
    <span class="k">return</span> <span class="n">datablock</span></div>


<div class="viewcode-block" id="domean"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.domean">[docs]</a><span class="k">def</span> <span class="nf">domean</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">calculation_type</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Gets average direction using Fisher or principal component analysis (line or plane) methods.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : nest list of data</span>
<span class="sd">        eg. [[treatment,dec,inc,int,quality],...]</span>
<span class="sd">    start : step being used as start of fit (often temperature minimum)</span>
<span class="sd">    end : step being used as end of fit (often temperature maximum)</span>
<span class="sd">    calculation_type : string describing type of calculation to be made</span>
<span class="sd">    &#39;DE-BFL&#39; (line), &#39;DE-BFL-A&#39; (line-anchored), &#39;DE-BFL-O&#39; (line-with-origin),</span>
<span class="sd">    &#39;DE-BFP&#39; (plane), &#39;DE-FM&#39; (Fisher mean)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    mpars : dictionary </span>
<span class="sd">        The keys within are &quot;specimen_n&quot;,&quot;measurement_step_min&quot;, &quot;measurement_step_max&quot;,&quot;specimen_mad&quot;,&quot;specimen_dec&quot;,&quot;specimen_inc&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mpars</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">datablock</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">start0</span><span class="p">,</span> <span class="n">end0</span> <span class="o">=</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span>
    <span class="c1"># indata = [rec.append(&#39;g&#39;) if len(rec)&lt;6 else rec for rec in indata] #</span>
    <span class="c1"># this statement doesn&#39;t work!</span>
    <span class="n">indata</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rec</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">6</span><span class="p">:</span>
            <span class="n">rec</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
        <span class="n">indata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">indata</span><span class="p">[</span><span class="n">start0</span><span class="p">][</span><span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Can&#39;t select &#39;bad&#39; point as start for PCA&quot;</span><span class="p">)</span>
    <span class="n">flags</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">indata</span><span class="p">]</span>
    <span class="n">bad_before_start</span> <span class="o">=</span> <span class="n">flags</span><span class="p">[:</span><span class="n">start0</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
    <span class="n">bad_in_mean</span> <span class="o">=</span> <span class="n">flags</span><span class="p">[</span><span class="n">start0</span><span class="p">:</span><span class="n">end0</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">start0</span> <span class="o">-</span> <span class="n">bad_before_start</span>
    <span class="n">end</span> <span class="o">=</span> <span class="n">end0</span> <span class="o">-</span> <span class="n">bad_before_start</span> <span class="o">-</span> <span class="n">bad_in_mean</span>
    <span class="n">datablock</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">indata</span> <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;g&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">indata</span><span class="p">[</span><span class="n">start0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">datablock</span><span class="p">[</span><span class="n">start</span><span class="p">]:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;problem removing bad data in pmag.domean start of datablock shifted:</span><span class="se">\n</span><span class="s1">original: </span><span class="si">%d</span><span class="se">\n</span><span class="s1">after removal: </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
            <span class="n">start0</span><span class="p">,</span> <span class="n">indata</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">datablock</span><span class="p">[</span><span class="n">start</span><span class="p">])))</span>
    <span class="k">if</span> <span class="n">indata</span><span class="p">[</span><span class="n">end0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">datablock</span><span class="p">[</span><span class="n">end</span><span class="p">]:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;problem removing bad data in pmag.domean end of datablock shifted:</span><span class="se">\n</span><span class="s1">original: </span><span class="si">%d</span><span class="se">\n</span><span class="s1">after removal: </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
            <span class="n">end0</span><span class="p">,</span> <span class="n">indata</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">datablock</span><span class="p">[</span><span class="n">end</span><span class="p">])))</span>
    <span class="n">mpars</span><span class="p">[</span><span class="s2">&quot;calculation_type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">calculation_type</span>
    <span class="n">rad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.</span>
    <span class="k">if</span> <span class="n">end</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">datablock</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">end</span> <span class="o">&lt;</span> <span class="n">start</span><span class="p">:</span>
        <span class="n">end</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">datablock</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">control</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Nrec</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="nb">float</span><span class="p">(</span><span class="n">end</span> <span class="o">-</span> <span class="n">start</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">cm</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]</span>
<span class="c1">#</span>
<span class="c1">#  get cartesian coordinates</span>
<span class="c1">#</span>
    <span class="n">fdata</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">calculation_type</span> <span class="o">==</span> <span class="s1">&#39;DE-BFL&#39;</span> <span class="ow">or</span> <span class="n">calculation_type</span> <span class="o">==</span> <span class="s1">&#39;DE-BFL-A&#39;</span> <span class="ow">or</span> <span class="n">calculation_type</span> <span class="o">==</span> <span class="s1">&#39;DE-BFL-O&#39;</span><span class="p">:</span>  <span class="c1"># best-fit line</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">datablock</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">datablock</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="n">datablock</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">3</span><span class="p">]]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">datablock</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">datablock</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="mf">1.0</span><span class="p">]</span>  <span class="c1"># unit weight</span>
        <span class="n">fdata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">cart</span> <span class="o">=</span> <span class="n">dir2cart</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cart</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">calculation_type</span> <span class="o">==</span> <span class="s1">&#39;DE-BFL-O&#39;</span><span class="p">:</span>  <span class="c1"># include origin as point</span>
        <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">])</span>
        <span class="c1"># pass</span>
    <span class="k">if</span> <span class="n">calculation_type</span> <span class="o">==</span> <span class="s1">&#39;DE-FM&#39;</span><span class="p">:</span>  <span class="c1"># for fisher means</span>
        <span class="n">fpars</span> <span class="o">=</span> <span class="n">fisher_mean</span><span class="p">(</span><span class="n">fdata</span><span class="p">)</span>
        <span class="n">mpars</span><span class="p">[</span><span class="s2">&quot;specimen_direction_type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;l&#39;</span>
        <span class="n">mpars</span><span class="p">[</span><span class="s2">&quot;specimen_dec&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fpars</span><span class="p">[</span><span class="s2">&quot;dec&quot;</span><span class="p">]</span>
        <span class="n">mpars</span><span class="p">[</span><span class="s2">&quot;specimen_inc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fpars</span><span class="p">[</span><span class="s2">&quot;inc&quot;</span><span class="p">]</span>
        <span class="n">mpars</span><span class="p">[</span><span class="s2">&quot;specimen_alpha95&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fpars</span><span class="p">[</span><span class="s2">&quot;alpha95&quot;</span><span class="p">]</span>
        <span class="n">mpars</span><span class="p">[</span><span class="s2">&quot;specimen_n&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fpars</span><span class="p">[</span><span class="s2">&quot;n&quot;</span><span class="p">]</span>
        <span class="n">mpars</span><span class="p">[</span><span class="s2">&quot;specimen_r&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fpars</span><span class="p">[</span><span class="s2">&quot;r&quot;</span><span class="p">]</span>
        <span class="n">mpars</span><span class="p">[</span><span class="s2">&quot;measurement_step_min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">indata</span><span class="p">[</span><span class="n">start0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">mpars</span><span class="p">[</span><span class="s2">&quot;measurement_step_max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">indata</span><span class="p">[</span><span class="n">end0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">mpars</span><span class="p">[</span><span class="s2">&quot;center_of_mass&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cm</span>
        <span class="n">mpars</span><span class="p">[</span><span class="s2">&quot;specimen_dang&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">return</span> <span class="n">mpars</span>
<span class="c1">#</span>
<span class="c1">#   get center of mass for principal components (DE-BFL or DE-BFP)</span>
<span class="c1">#</span>
    <span class="k">for</span> <span class="n">cart</span> <span class="ow">in</span> <span class="n">X</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="n">cm</span><span class="p">[</span><span class="n">l</span><span class="p">]</span> <span class="o">+=</span> <span class="n">old_div</span><span class="p">(</span><span class="n">cart</span><span class="p">[</span><span class="n">l</span><span class="p">],</span> <span class="n">Nrec</span><span class="p">)</span>
    <span class="n">mpars</span><span class="p">[</span><span class="s2">&quot;center_of_mass&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cm</span>

<span class="c1">#</span>
<span class="c1">#   transform to center of mass (if best-fit line)</span>
<span class="c1">#</span>
    <span class="k">if</span> <span class="n">calculation_type</span> <span class="o">!=</span> <span class="s1">&#39;DE-BFP&#39;</span><span class="p">:</span>
        <span class="n">mpars</span><span class="p">[</span><span class="s2">&quot;specimen_direction_type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;l&#39;</span>
    <span class="k">if</span> <span class="n">calculation_type</span> <span class="o">==</span> <span class="s1">&#39;DE-BFL&#39;</span> <span class="ow">or</span> <span class="n">calculation_type</span> <span class="o">==</span> <span class="s1">&#39;DE-BFL-O&#39;</span><span class="p">:</span>  <span class="c1"># not for planes or anchored lines</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)):</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
                <span class="n">X</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">l</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">l</span><span class="p">]</span> <span class="o">-</span> <span class="n">cm</span><span class="p">[</span><span class="n">l</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">mpars</span><span class="p">[</span><span class="s2">&quot;specimen_direction_type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;p&#39;</span>

<span class="c1">#</span>
<span class="c1">#   put in T matrix</span>
<span class="c1">#</span>
    <span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Tmatrix</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
<span class="c1">#</span>
<span class="c1">#   get sorted evals/evects</span>
<span class="c1">#</span>
    <span class="n">t</span><span class="p">,</span> <span class="n">V</span> <span class="o">=</span> <span class="n">tauV</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">t</span> <span class="o">==</span> <span class="p">[]:</span>
        <span class="n">mpars</span><span class="p">[</span><span class="s2">&quot;specimen_direction_type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Error&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error in calculation&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mpars</span>
    <span class="n">v1</span><span class="p">,</span> <span class="n">v3</span> <span class="o">=</span> <span class="n">V</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">t</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">t</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># make positive</span>
    <span class="k">if</span> <span class="n">calculation_type</span> <span class="o">==</span> <span class="s1">&#39;DE-BFL-A&#39;</span><span class="p">:</span>
        <span class="n">Dir</span><span class="p">,</span> <span class="n">R</span> <span class="o">=</span> <span class="n">vector_mean</span><span class="p">(</span><span class="n">fdata</span><span class="p">)</span>
        <span class="n">mpars</span><span class="p">[</span><span class="s2">&quot;specimen_direction_type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;l&#39;</span>
        <span class="n">mpars</span><span class="p">[</span><span class="s2">&quot;specimen_dec&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Dir</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">mpars</span><span class="p">[</span><span class="s2">&quot;specimen_inc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Dir</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">mpars</span><span class="p">[</span><span class="s2">&quot;specimen_n&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fdata</span><span class="p">)</span>
        <span class="n">mpars</span><span class="p">[</span><span class="s2">&quot;measurement_step_min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">indata</span><span class="p">[</span><span class="n">start0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">mpars</span><span class="p">[</span><span class="s2">&quot;measurement_step_max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">indata</span><span class="p">[</span><span class="n">end0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">mpars</span><span class="p">[</span><span class="s2">&quot;center_of_mass&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cm</span>
        <span class="n">s1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">MAD</span> <span class="o">=</span> <span class="n">old_div</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span><span class="n">old_div</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">t</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="n">s1</span><span class="p">)),</span> <span class="n">rad</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">iscomplexobj</span><span class="p">(</span><span class="n">MAD</span><span class="p">):</span>
            <span class="n">MAD</span> <span class="o">=</span> <span class="n">MAD</span><span class="o">.</span><span class="n">real</span>
        <span class="c1"># I think this is how it is done - i never anchor the &quot;PCA&quot; - check</span>
        <span class="n">mpars</span><span class="p">[</span><span class="s2">&quot;specimen_mad&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">MAD</span>
        <span class="k">return</span> <span class="n">mpars</span>
    <span class="k">if</span> <span class="n">calculation_type</span> <span class="o">!=</span> <span class="s1">&#39;DE-BFP&#39;</span><span class="p">:</span>
        <span class="c1">#</span>
        <span class="c1">#   get control vector for principal component direction</span>
        <span class="c1">#</span>
        <span class="n">rec</span> <span class="o">=</span> <span class="p">[</span><span class="n">datablock</span><span class="p">[</span><span class="n">start</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">datablock</span><span class="p">[</span><span class="n">start</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="n">datablock</span><span class="p">[</span><span class="n">start</span><span class="p">][</span><span class="mi">3</span><span class="p">]]</span>
        <span class="n">P1</span> <span class="o">=</span> <span class="n">dir2cart</span><span class="p">(</span><span class="n">rec</span><span class="p">)</span>
        <span class="n">rec</span> <span class="o">=</span> <span class="p">[</span><span class="n">datablock</span><span class="p">[</span><span class="n">end</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">datablock</span><span class="p">[</span><span class="n">end</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="n">datablock</span><span class="p">[</span><span class="n">end</span><span class="p">][</span><span class="mi">3</span><span class="p">]]</span>
        <span class="n">P2</span> <span class="o">=</span> <span class="n">dir2cart</span><span class="p">(</span><span class="n">rec</span><span class="p">)</span>
<span class="c1">#</span>
<span class="c1">#   get right direction along principal component</span>
<span class="c1">##</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="n">control</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">P1</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">P2</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="c1"># changed by rshaar</span>
        <span class="c1"># control is taken as the center of mass</span>
        <span class="c1"># control=cm</span>

        <span class="n">dot</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="n">dot</span> <span class="o">+=</span> <span class="n">v1</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">control</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">dot</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">dot</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">if</span> <span class="n">dot</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">dot</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">dot</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">old_div</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mf">2.</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
                <span class="n">v1</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">v1</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
<span class="c1">#   get right direction along principal component</span>
<span class="c1">#</span>
        <span class="n">s1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">Dir</span> <span class="o">=</span> <span class="n">cart2dir</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span>
        <span class="n">MAD</span> <span class="o">=</span> <span class="n">old_div</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span><span class="n">old_div</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">t</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="n">s1</span><span class="p">)),</span> <span class="n">rad</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">iscomplexobj</span><span class="p">(</span><span class="n">MAD</span><span class="p">):</span>
            <span class="n">MAD</span> <span class="o">=</span> <span class="n">MAD</span><span class="o">.</span><span class="n">real</span>
    <span class="k">if</span> <span class="n">calculation_type</span> <span class="o">==</span> <span class="s2">&quot;DE-BFP&quot;</span><span class="p">:</span>
        <span class="n">Dir</span> <span class="o">=</span> <span class="n">cart2dir</span><span class="p">(</span><span class="n">v3</span><span class="p">)</span>
        <span class="n">MAD</span> <span class="o">=</span> <span class="n">old_div</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">old_div</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">old_div</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]))),</span> <span class="n">rad</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">iscomplexobj</span><span class="p">(</span><span class="n">MAD</span><span class="p">):</span>
            <span class="n">MAD</span> <span class="o">=</span> <span class="n">MAD</span><span class="o">.</span><span class="n">real</span>
<span class="c1">#</span>
<span class="c1">#   get angle with  center of mass</span>
<span class="c1">#</span>
    <span class="n">CMdir</span> <span class="o">=</span> <span class="n">cart2dir</span><span class="p">(</span><span class="n">cm</span><span class="p">)</span>
    <span class="n">Dirp</span> <span class="o">=</span> <span class="p">[</span><span class="n">Dir</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Dir</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mf">1.</span><span class="p">]</span>
    <span class="n">dang</span> <span class="o">=</span> <span class="n">angle</span><span class="p">(</span><span class="n">CMdir</span><span class="p">,</span> <span class="n">Dirp</span><span class="p">)</span>
    <span class="n">mpars</span><span class="p">[</span><span class="s2">&quot;specimen_dec&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Dir</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">mpars</span><span class="p">[</span><span class="s2">&quot;specimen_inc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Dir</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">mpars</span><span class="p">[</span><span class="s2">&quot;specimen_mad&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">MAD</span>
    <span class="c1"># mpars[&quot;specimen_n&quot;]=int(Nrec)</span>
    <span class="n">mpars</span><span class="p">[</span><span class="s2">&quot;specimen_n&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">mpars</span><span class="p">[</span><span class="s2">&quot;specimen_dang&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dang</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">mpars</span><span class="p">[</span><span class="s2">&quot;measurement_step_min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">indata</span><span class="p">[</span><span class="n">start0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">mpars</span><span class="p">[</span><span class="s2">&quot;measurement_step_max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">indata</span><span class="p">[</span><span class="n">end0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">mpars</span></div>


<div class="viewcode-block" id="circ"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.circ">[docs]</a><span class="k">def</span> <span class="nf">circ</span><span class="p">(</span><span class="n">dec</span><span class="p">,</span> <span class="n">dip</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span><span class="n">npts</span><span class="o">=</span><span class="mi">201</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates points on an circle about dec and dip with angle alpha.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dec : float</span>
<span class="sd">        declination of vector</span>
<span class="sd">    dip : float</span>
<span class="sd">        dip of vector</span>
<span class="sd">    alpha : float</span>
<span class="sd">        angle of small circle - 90 if vector is pole to great circle</span>
<span class="sd">    npts : int</span>
<span class="sd">        number of points on the circle, default 201</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    D_out, I_out : list</span>
<span class="sd">        declinations and inclinations along small (great) circle about dec, dip</span>
<span class="sd">            </span>
<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; pmag.circ(50,10,10,5)</span>
<span class="sd">    ([60.15108171104812,</span>
<span class="sd">      50.0,</span>
<span class="sd">      39.848918288951864,</span>
<span class="sd">      49.99999999999999,</span>
<span class="sd">      60.15108171104812],</span>
<span class="sd">     [9.846551939834077, 0.0, 9.846551939834077, 20.0, 9.846551939834079])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">D_out</span><span class="p">,</span> <span class="n">I_out</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">dec</span><span class="p">,</span> <span class="n">dip</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">dec</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">dip</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
    <span class="n">dec1</span> <span class="o">=</span> <span class="n">dec</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">2.</span>
    <span class="n">isign</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">dip</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">isign</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dip</span><span class="p">)</span><span class="o">/</span> <span class="n">dip</span>
    <span class="n">dip1</span> <span class="o">=</span> <span class="n">dip</span> <span class="o">-</span> <span class="n">isign</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span> <span class="mf">2.</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
    <span class="n">v</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">dec</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">dip</span><span class="p">)</span>
    <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">dec</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">dip</span><span class="p">)</span>
    <span class="n">t</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">dip</span><span class="p">)</span>
    <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">dec</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">dip1</span><span class="p">)</span>
    <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">dec</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">dip1</span><span class="p">)</span>
    <span class="n">t</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">dip1</span><span class="p">)</span>
    <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">dec1</span><span class="p">)</span>
    <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">dec1</span><span class="p">)</span>
    <span class="n">t</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">npts</span><span class="p">):</span>
        <span class="n">psi</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="p">((</span><span class="n">npts</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">psi</span><span class="p">)</span>
        <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">psi</span><span class="p">)</span>
        <span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">elli</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
                <span class="n">elli</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">elli</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">t</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="n">Dir</span> <span class="o">=</span> <span class="n">cart2dir</span><span class="p">(</span><span class="n">elli</span><span class="p">)</span>
        <span class="n">D_out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Dir</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">I_out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Dir</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">D_out</span><span class="p">,</span> <span class="n">I_out</span></div>


<div class="viewcode-block" id="PintPars"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.PintPars">[docs]</a><span class="k">def</span> <span class="nf">PintPars</span><span class="p">(</span><span class="n">datablock</span><span class="p">,</span> <span class="n">araiblock</span><span class="p">,</span> <span class="n">zijdblock</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">accept</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the paleointensity with magic parameters and make some definitions.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="s1">&#39;version&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;version&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">meth_key</span> <span class="o">=</span> <span class="s1">&#39;method_codes&#39;</span>
        <span class="n">beta_key</span> <span class="o">=</span> <span class="s1">&#39;int_b_beta&#39;</span>
        <span class="n">temp_key</span><span class="p">,</span> <span class="n">min_key</span><span class="p">,</span> <span class="n">max_key</span> <span class="o">=</span> <span class="s1">&#39;treat_temp&#39;</span><span class="p">,</span> <span class="s1">&#39;meas_step_min&#39;</span><span class="p">,</span> <span class="s1">&#39;meas_step_max&#39;</span>
        <span class="n">dc_theta_key</span><span class="p">,</span> <span class="n">dc_phi_key</span> <span class="o">=</span> <span class="s1">&#39;treat_dc_field_theta&#39;</span><span class="p">,</span> <span class="s1">&#39;treat_dc_field_phi&#39;</span>
        <span class="c1"># convert dataframe to list of dictionaries</span>
        <span class="n">datablock</span> <span class="o">=</span> <span class="n">datablock</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="s1">&#39;records&#39;</span><span class="p">)</span>
        <span class="n">z_key</span> <span class="o">=</span> <span class="s1">&#39;int_z&#39;</span>
        <span class="n">drats_key</span> <span class="o">=</span> <span class="s1">&#39;int_drats&#39;</span>
        <span class="n">drat_key</span> <span class="o">=</span> <span class="s1">&#39;int_drat&#39;</span>
        <span class="n">md_key</span> <span class="o">=</span> <span class="s1">&#39;int_md&#39;</span>
        <span class="n">dec_key</span> <span class="o">=</span> <span class="s1">&#39;dir_dec&#39;</span>
        <span class="n">inc_key</span> <span class="o">=</span> <span class="s1">&#39;dir_inc&#39;</span>
        <span class="n">mad_key</span> <span class="o">=</span> <span class="s1">&#39;int_mad_free&#39;</span>
        <span class="n">dang_key</span> <span class="o">=</span> <span class="s1">&#39;int_dang&#39;</span>
        <span class="n">ptrm_key</span> <span class="o">=</span> <span class="s1">&#39;int_n_ptrm&#39;</span>
        <span class="n">theta_key</span> <span class="o">=</span> <span class="s1">&#39;int_theta&#39;</span>
        <span class="n">gamma_key</span> <span class="o">=</span> <span class="s1">&#39;int_gamma&#39;</span>
        <span class="n">delta_key</span> <span class="o">=</span> <span class="s1">&#39;int_delta&#39;</span>
        <span class="n">frac_key</span> <span class="o">=</span> <span class="s1">&#39;int_frac&#39;</span>
        <span class="n">gmax_key</span> <span class="o">=</span> <span class="s1">&#39;int_gmax&#39;</span>
        <span class="n">scat_key</span> <span class="o">=</span> <span class="s1">&#39;int_scat&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">beta_key</span> <span class="o">=</span> <span class="s1">&#39;specimen_b_beta&#39;</span>
        <span class="n">meth_key</span> <span class="o">=</span> <span class="s1">&#39;magic_method_codes&#39;</span>
        <span class="n">temp_key</span><span class="p">,</span> <span class="n">min_key</span><span class="p">,</span> <span class="n">max_key</span> <span class="o">=</span> <span class="s1">&#39;treatment_temp&#39;</span><span class="p">,</span> <span class="s1">&#39;measurement_step_min&#39;</span><span class="p">,</span> <span class="s1">&#39;measurement_step_max&#39;</span>
        <span class="n">z_key</span> <span class="o">=</span> <span class="s1">&#39;specimen_z&#39;</span>
        <span class="n">drats_key</span> <span class="o">=</span> <span class="s1">&#39;specimen_drats&#39;</span>
        <span class="n">drat_key</span> <span class="o">=</span> <span class="s1">&#39;specimen_drat&#39;</span>
        <span class="n">md_key</span> <span class="o">=</span> <span class="s1">&#39;specimen_md&#39;</span>
        <span class="n">dec_key</span> <span class="o">=</span> <span class="s1">&#39;specimen_dec&#39;</span>
        <span class="n">inc_key</span> <span class="o">=</span> <span class="s1">&#39;specimen_inc&#39;</span>
        <span class="n">mad_key</span> <span class="o">=</span> <span class="s1">&#39;specimen_int_mad&#39;</span>
        <span class="n">dang_key</span> <span class="o">=</span> <span class="s1">&#39;specimen_dang&#39;</span>
        <span class="n">ptrm_key</span> <span class="o">=</span> <span class="s1">&#39;specimen_int_ptrm_n&#39;</span>
        <span class="n">theta_key</span> <span class="o">=</span> <span class="s1">&#39;specimen_theta&#39;</span>
        <span class="n">gamma_key</span> <span class="o">=</span> <span class="s1">&#39;specimen_gamma&#39;</span>
        <span class="n">delta_key</span> <span class="o">=</span> <span class="s1">&#39;specimen_delta&#39;</span>
        <span class="n">frac_key</span> <span class="o">=</span> <span class="s1">&#39;specimen_frac&#39;</span>
        <span class="n">gmax_key</span> <span class="o">=</span> <span class="s1">&#39;specimen_gmax&#39;</span>
        <span class="n">scat_key</span> <span class="o">=</span> <span class="s1">&#39;specimen_scat&#39;</span>

    <span class="n">first_Z</span><span class="p">,</span> <span class="n">first_I</span><span class="p">,</span> <span class="n">zptrm_check</span><span class="p">,</span> <span class="n">ptrm_check</span><span class="p">,</span> <span class="n">ptrm_tail</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">methcode</span><span class="p">,</span> <span class="n">ThetaChecks</span><span class="p">,</span> <span class="n">DeltaChecks</span><span class="p">,</span> <span class="n">GammaChecks</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span>
    <span class="n">zptrm_check</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">first_Z</span><span class="p">,</span> <span class="n">first_I</span><span class="p">,</span> <span class="n">ptrm_check</span><span class="p">,</span> <span class="n">ptrm_tail</span><span class="p">,</span> <span class="n">zptrm_check</span><span class="p">,</span> <span class="n">GammaChecks</span> <span class="o">=</span> <span class="n">araiblock</span><span class="p">[</span>
        <span class="mi">0</span><span class="p">],</span> <span class="n">araiblock</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">araiblock</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">araiblock</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">araiblock</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">araiblock</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">araiblock</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">6</span><span class="p">:</span>
        <span class="c1"># used only for perpendicular method of paleointensity</span>
        <span class="n">ThetaChecks</span> <span class="o">=</span> <span class="n">araiblock</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
        <span class="c1"># used only for perpendicular  method of paleointensity</span>
        <span class="n">DeltaChecks</span> <span class="o">=</span> <span class="n">araiblock</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span>
    <span class="n">xi</span><span class="p">,</span> <span class="n">yi</span><span class="p">,</span> <span class="n">diffcum</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="mi">0</span>
    <span class="n">xiz</span><span class="p">,</span> <span class="n">xzi</span><span class="p">,</span> <span class="n">yiz</span><span class="p">,</span> <span class="n">yzi</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">Nptrm</span><span class="p">,</span> <span class="n">dmax</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1e-22</span>
<span class="c1"># check if even zero and infield steps</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">first_Z</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">first_I</span><span class="p">):</span>
        <span class="n">maxe</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">first_I</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">maxe</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">first_Z</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">end</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">end</span> <span class="o">&gt;</span> <span class="n">maxe</span><span class="p">:</span>
        <span class="n">end</span> <span class="o">=</span> <span class="n">maxe</span>
<span class="c1"># get the MAD, DANG, etc. for directional data</span>
    <span class="n">bstep</span> <span class="o">=</span> <span class="n">araiblock</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">start</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">estep</span> <span class="o">=</span> <span class="n">araiblock</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">end</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">zstart</span><span class="p">,</span> <span class="n">zend</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">zijdblock</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">zijdblock</span><span class="p">)):</span>
        <span class="n">zrec</span> <span class="o">=</span> <span class="n">zijdblock</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">zrec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">bstep</span><span class="p">:</span>
            <span class="n">zstart</span> <span class="o">=</span> <span class="n">k</span>
        <span class="k">if</span> <span class="n">zrec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">estep</span><span class="p">:</span>
            <span class="n">zend</span> <span class="o">=</span> <span class="n">k</span>
    <span class="n">PCA</span> <span class="o">=</span> <span class="n">domean</span><span class="p">(</span><span class="n">zijdblock</span><span class="p">,</span> <span class="n">zstart</span><span class="p">,</span> <span class="n">zend</span><span class="p">,</span> <span class="s1">&#39;DE-BFL&#39;</span><span class="p">)</span>
    <span class="n">D</span><span class="p">,</span> <span class="n">Diz</span><span class="p">,</span> <span class="n">Dzi</span><span class="p">,</span> <span class="n">Du</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>  <span class="c1"># list of NRM vectors, and separated by zi and iz</span>
    <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">zijdblock</span><span class="p">:</span>
        <span class="n">D</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">rec</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">rec</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">rec</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>
        <span class="n">Du</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">rec</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">rec</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
        <span class="k">if</span> <span class="n">rec</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">Dzi</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">rec</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">rec</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>  <span class="c1"># if this is ZI step</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Diz</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">rec</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">rec</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>  <span class="c1"># if this is IZ step</span>
<span class="c1"># calculate the vector difference sum</span>
    <span class="n">vds</span> <span class="o">=</span> <span class="n">dovds</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
    <span class="n">b_zi</span><span class="p">,</span> <span class="n">b_iz</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="c1"># collect data included in ZigZag calculation</span>
    <span class="k">if</span> <span class="n">end</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">first_Z</span><span class="p">):</span>
        <span class="n">stop</span> <span class="o">=</span> <span class="n">end</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">stop</span> <span class="o">=</span> <span class="n">end</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">first_I</span><span class="p">)):</span>
            <span class="n">irec</span> <span class="o">=</span> <span class="n">first_I</span><span class="p">[</span><span class="n">l</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">irec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">first_Z</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
                <span class="n">xi</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">irec</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
                <span class="n">yi</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">first_Z</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;start&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">start</span>
    <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;end&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">end</span>
    <span class="n">pars</span><span class="p">,</span> <span class="n">errcode</span> <span class="o">=</span> <span class="n">int_pars</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">yi</span><span class="p">,</span> <span class="n">vds</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">errcode</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">pars</span><span class="p">,</span> <span class="n">errcode</span>
<span class="c1">#    for k in range(start,end+1):</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">first_Z</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
            <span class="c1"># only go down to 10% of NRM.....</span>
            <span class="k">if</span> <span class="n">old_div</span><span class="p">(</span><span class="n">first_Z</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span> <span class="n">vds</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.1</span><span class="p">:</span>
                <span class="n">irec</span> <span class="o">=</span> <span class="n">first_I</span><span class="p">[</span><span class="n">l</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">irec</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">first_I</span><span class="p">[</span><span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># a ZI step</span>
                    <span class="n">xzi</span> <span class="o">=</span> <span class="n">irec</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
                    <span class="n">yzi</span> <span class="o">=</span> <span class="n">first_Z</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
                    <span class="n">xiz</span> <span class="o">=</span> <span class="n">first_I</span><span class="p">[</span><span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
                    <span class="n">yiz</span> <span class="o">=</span> <span class="n">first_Z</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
                    <span class="n">slope</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">((</span><span class="n">yzi</span> <span class="o">-</span> <span class="n">yiz</span><span class="p">),</span> <span class="p">(</span><span class="n">xiz</span> <span class="o">-</span> <span class="n">xzi</span><span class="p">))</span>
                    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">yzi</span> <span class="o">-</span> <span class="n">yiz</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">xiz</span> <span class="o">-</span> <span class="n">xzi</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">r</span> <span class="o">&gt;</span> <span class="mf">.1</span> <span class="o">*</span> <span class="n">vds</span><span class="p">:</span>
                        <span class="n">b_zi</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">slope</span><span class="p">)</span>  <span class="c1"># suppress noise</span>
                <span class="k">elif</span> <span class="n">irec</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">first_I</span><span class="p">[</span><span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># an IZ step</span>
                    <span class="n">xiz</span> <span class="o">=</span> <span class="n">irec</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
                    <span class="n">yiz</span> <span class="o">=</span> <span class="n">first_Z</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
                    <span class="n">xzi</span> <span class="o">=</span> <span class="n">first_I</span><span class="p">[</span><span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
                    <span class="n">yzi</span> <span class="o">=</span> <span class="n">first_Z</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
                    <span class="n">slope</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">((</span><span class="n">yiz</span> <span class="o">-</span> <span class="n">yzi</span><span class="p">),</span> <span class="p">(</span><span class="n">xzi</span> <span class="o">-</span> <span class="n">xiz</span><span class="p">))</span>
                    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">yiz</span> <span class="o">-</span> <span class="n">yzi</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">xzi</span> <span class="o">-</span> <span class="n">xiz</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">r</span> <span class="o">&gt;</span> <span class="mf">.1</span> <span class="o">*</span> <span class="n">vds</span><span class="p">:</span>
                        <span class="n">b_iz</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">slope</span><span class="p">)</span>  <span class="c1"># suppress noise</span>
<span class="c1">#</span>
    <span class="n">ZigZag</span><span class="p">,</span> <span class="n">Frat</span><span class="p">,</span> <span class="n">Trat</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">Diz</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">Dzi</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">ZigZag</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">dizp</span> <span class="o">=</span> <span class="n">fisher_mean</span><span class="p">(</span><span class="n">Diz</span><span class="p">)</span>  <span class="c1"># get Fisher stats on IZ steps</span>
        <span class="n">dzip</span> <span class="o">=</span> <span class="n">fisher_mean</span><span class="p">(</span><span class="n">Dzi</span><span class="p">)</span>  <span class="c1"># get Fisher stats on ZI steps</span>
        <span class="n">dup</span> <span class="o">=</span> <span class="n">fisher_mean</span><span class="p">(</span><span class="n">Du</span><span class="p">)</span>  <span class="c1"># get Fisher stats on all steps</span>
<span class="c1">#</span>
<span class="c1"># if directions are TOO well grouped, can get false positive for ftest, so</span>
<span class="c1"># angles must be &gt; 3 degrees apart.</span>
<span class="c1">#</span>
        <span class="k">if</span> <span class="n">angle</span><span class="p">([</span><span class="n">dizp</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">],</span> <span class="n">dizp</span><span class="p">[</span><span class="s1">&#39;inc&#39;</span><span class="p">]],</span> <span class="p">[</span><span class="n">dzip</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">],</span> <span class="n">dzip</span><span class="p">[</span><span class="s1">&#39;inc&#39;</span><span class="p">]])</span> <span class="o">&gt;</span> <span class="mf">3.</span><span class="p">:</span>
            <span class="n">F</span> <span class="o">=</span> <span class="p">(</span><span class="n">dup</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="mf">2.</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">dzip</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">dizp</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">dup</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">])</span> <span class="o">/</span> \
                <span class="p">(</span><span class="n">dup</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">dzip</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">dizp</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">]</span>
                 <span class="p">)</span>  <span class="c1"># Watson test for common mean</span>
            <span class="n">nf</span> <span class="o">=</span> <span class="mf">2.</span> <span class="o">*</span> <span class="p">(</span><span class="n">dup</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="mf">2.</span><span class="p">)</span>  <span class="c1"># number of degees of freedom</span>
            <span class="n">ftest</span> <span class="o">=</span> <span class="n">fcalc</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">nf</span><span class="p">)</span>
            <span class="n">Frat</span> <span class="o">=</span> <span class="n">old_div</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">ftest</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">Frat</span> <span class="o">&gt;</span> <span class="mf">1.</span><span class="p">:</span>
                <span class="n">ZigZag</span> <span class="o">=</span> <span class="n">Frat</span>  <span class="c1"># fails zigzag on directions</span>
                <span class="n">methcode</span> <span class="o">=</span> <span class="s2">&quot;SM-FTEST&quot;</span>
<span class="c1"># now do slopes</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">b_zi</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">b_iz</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">bzi_m</span><span class="p">,</span> <span class="n">bzi_sig</span> <span class="o">=</span> <span class="n">gausspars</span><span class="p">(</span><span class="n">b_zi</span><span class="p">)</span>  <span class="c1"># mean, std dev</span>
        <span class="n">biz_m</span><span class="p">,</span> <span class="n">biz_sig</span> <span class="o">=</span> <span class="n">gausspars</span><span class="p">(</span><span class="n">b_iz</span><span class="p">)</span>
        <span class="n">n_zi</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">b_zi</span><span class="p">))</span>
        <span class="n">n_iz</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">b_iz</span><span class="p">))</span>
        <span class="n">b_diff</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">bzi_m</span> <span class="o">-</span> <span class="n">biz_m</span><span class="p">)</span>  <span class="c1"># difference in means</span>
<span class="c1">#</span>
<span class="c1"># avoid false positives - set 3 degree slope difference here too</span>
        <span class="k">if</span> <span class="n">b_diff</span> <span class="o">&gt;</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">180.</span><span class="p">:</span>
            <span class="n">nf</span> <span class="o">=</span> <span class="n">n_zi</span> <span class="o">+</span> <span class="n">n_iz</span> <span class="o">-</span> <span class="mf">2.</span>  <span class="c1"># degrees of freedom</span>
            <span class="n">svar</span> <span class="o">=</span> <span class="n">old_div</span><span class="p">(((</span><span class="n">n_zi</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">)</span> <span class="o">*</span> <span class="n">bzi_sig</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
                            <span class="p">(</span><span class="n">n_iz</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">)</span> <span class="o">*</span> <span class="n">biz_sig</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="n">nf</span><span class="p">)</span>
            <span class="n">T</span> <span class="o">=</span> <span class="n">old_div</span><span class="p">((</span><span class="n">b_diff</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span>
                <span class="n">svar</span> <span class="o">*</span> <span class="p">(</span><span class="n">old_div</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">n_zi</span><span class="p">)</span> <span class="o">+</span> <span class="n">old_div</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">n_iz</span><span class="p">))))</span>  <span class="c1"># student&#39;s t</span>
            <span class="n">ttest</span> <span class="o">=</span> <span class="n">tcalc</span><span class="p">(</span><span class="n">nf</span><span class="p">,</span> <span class="mf">.05</span><span class="p">)</span>  <span class="c1"># t-test at 95% conf.</span>
            <span class="n">Trat</span> <span class="o">=</span> <span class="n">old_div</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">ttest</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">Trat</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">Trat</span> <span class="o">&gt;</span> <span class="n">Frat</span><span class="p">:</span>
                <span class="n">ZigZag</span> <span class="o">=</span> <span class="n">Trat</span>  <span class="c1"># fails zigzag on directions</span>
                <span class="n">methcode</span> <span class="o">=</span> <span class="s2">&quot;SM-TTEST&quot;</span>
    <span class="n">pars</span><span class="p">[</span><span class="n">z_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ZigZag</span>
    <span class="n">pars</span><span class="p">[</span><span class="n">meth_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">methcode</span>
<span class="c1"># do drats</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ptrm_check</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">diffcum</span><span class="p">,</span> <span class="n">drat_max</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">prec</span> <span class="ow">in</span> <span class="n">ptrm_check</span><span class="p">:</span>
            <span class="n">step</span> <span class="o">=</span> <span class="n">prec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">endbak</span> <span class="o">=</span> <span class="n">end</span>
            <span class="n">zend</span> <span class="o">=</span> <span class="n">end</span>
            <span class="k">while</span> <span class="n">zend</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">zijdblock</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">zend</span> <span class="o">=</span> <span class="n">zend</span> <span class="o">-</span> <span class="mi">2</span>  <span class="c1"># don&#39;t count alteration that happens after this step</span>
            <span class="k">if</span> <span class="n">step</span> <span class="o">&lt;</span> <span class="n">zijdblock</span><span class="p">[</span><span class="n">zend</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
                <span class="n">Nptrm</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">for</span> <span class="n">irec</span> <span class="ow">in</span> <span class="n">first_I</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">irec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">step</span><span class="p">:</span>
                        <span class="k">break</span>
                <span class="n">diffcum</span> <span class="o">+=</span> <span class="n">prec</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">irec</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">prec</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">irec</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">drat_max</span><span class="p">:</span>
                    <span class="n">drat_max</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">prec</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">irec</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        <span class="n">pars</span><span class="p">[</span><span class="n">drats_key</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="nb">abs</span><span class="p">(</span><span class="n">diffcum</span><span class="p">)</span> <span class="o">/</span> <span class="n">first_I</span><span class="p">[</span><span class="n">zend</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span>
        <span class="n">pars</span><span class="p">[</span><span class="n">drat_key</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="nb">abs</span><span class="p">(</span><span class="n">drat_max</span><span class="p">)</span> <span class="o">/</span> <span class="n">first_I</span><span class="p">[</span><span class="n">zend</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">zptrm_check</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">diffcum</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">prec</span> <span class="ow">in</span> <span class="n">zptrm_check</span><span class="p">:</span>
            <span class="n">step</span> <span class="o">=</span> <span class="n">prec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">endbak</span> <span class="o">=</span> <span class="n">end</span>
            <span class="n">zend</span> <span class="o">=</span> <span class="n">end</span>
            <span class="k">while</span> <span class="n">zend</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">zijdblock</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">zend</span> <span class="o">=</span> <span class="n">zend</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">step</span> <span class="o">&lt;</span> <span class="n">zijdblock</span><span class="p">[</span><span class="n">zend</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
                <span class="n">Nptrm</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">for</span> <span class="n">irec</span> <span class="ow">in</span> <span class="n">first_I</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">irec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">step</span><span class="p">:</span>
                        <span class="k">break</span>
                <span class="n">diffcum</span> <span class="o">+=</span> <span class="n">prec</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">irec</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">pars</span><span class="p">[</span><span class="n">drats_key</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="nb">abs</span><span class="p">(</span><span class="n">diffcum</span><span class="p">)</span> <span class="o">/</span> <span class="n">first_I</span><span class="p">[</span><span class="n">zend</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">pars</span><span class="p">[</span><span class="n">drats_key</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">pars</span><span class="p">[</span><span class="n">drat_key</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="c1"># and the pTRM tails</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ptrm_tail</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">trec</span> <span class="ow">in</span> <span class="n">ptrm_tail</span><span class="p">:</span>
            <span class="n">step</span> <span class="o">=</span> <span class="n">trec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">irec</span> <span class="ow">in</span> <span class="n">first_I</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">irec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">step</span><span class="p">:</span>
                    <span class="k">break</span>
            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">trec</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">dmax</span><span class="p">:</span>
                <span class="n">dmax</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">trec</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        <span class="n">pars</span><span class="p">[</span><span class="n">md_key</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">dmax</span> <span class="o">/</span> <span class="n">vds</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">pars</span><span class="p">[</span><span class="n">md_key</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">pars</span><span class="p">[</span><span class="n">min_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">bstep</span>
    <span class="n">pars</span><span class="p">[</span><span class="n">max_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">estep</span>
    <span class="n">pars</span><span class="p">[</span><span class="n">dec_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">[</span><span class="s2">&quot;specimen_dec&quot;</span><span class="p">]</span>
    <span class="n">pars</span><span class="p">[</span><span class="n">inc_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">[</span><span class="s2">&quot;specimen_inc&quot;</span><span class="p">]</span>
    <span class="n">pars</span><span class="p">[</span><span class="n">mad_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">[</span><span class="s2">&quot;specimen_mad&quot;</span><span class="p">]</span>
    <span class="n">pars</span><span class="p">[</span><span class="n">dang_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">[</span><span class="s2">&quot;specimen_dang&quot;</span><span class="p">]</span>
    <span class="n">pars</span><span class="p">[</span><span class="n">ptrm_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">Nptrm</span>
<span class="c1"># and the ThetaChecks</span>
    <span class="k">if</span> <span class="n">ThetaChecks</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
        <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">theta</span> <span class="ow">in</span> <span class="n">ThetaChecks</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">theta</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">bstep</span> <span class="ow">and</span> <span class="n">theta</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">estep</span> <span class="ow">and</span> <span class="n">theta</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">t</span><span class="p">:</span>
                <span class="n">t</span> <span class="o">=</span> <span class="n">theta</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">pars</span><span class="p">[</span><span class="n">theta_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">pars</span><span class="p">[</span><span class="n">theta_key</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="c1"># and the DeltaChecks</span>
    <span class="k">if</span> <span class="n">DeltaChecks</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">delta</span> <span class="ow">in</span> <span class="n">DeltaChecks</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">delta</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">bstep</span> <span class="ow">and</span> <span class="n">delta</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">estep</span> <span class="ow">and</span> <span class="n">delta</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">d</span><span class="p">:</span>
                <span class="n">d</span> <span class="o">=</span> <span class="n">delta</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">pars</span><span class="p">[</span><span class="n">delta_key</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">pars</span><span class="p">[</span><span class="n">delta_key</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">pars</span><span class="p">[</span><span class="n">gamma_key</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">if</span> <span class="n">GammaChecks</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">gamma</span> <span class="ow">in</span> <span class="n">GammaChecks</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">gamma</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">estep</span><span class="p">:</span>
                <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;specimen_gamma&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gamma</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># --------------------------------------------------------------</span>
    <span class="c1"># From here added By Ron Shaar 11-Dec 2012</span>
    <span class="c1"># New parameters defined in Shaar and Tauxe (2012):</span>
    <span class="c1"># FRAC (specimen_frac) - ranges from 0. to 1.</span>
    <span class="c1"># SCAT (specimen_scat) - takes 1/0</span>
    <span class="c1"># gap_max (specimen_gmax) - ranges from 0. to 1.</span>
    <span class="c1"># --------------------------------------------------------------</span>

    <span class="c1"># --------------------------------------------------------------</span>
    <span class="c1"># FRAC is similar to Fvds, but the numerator is the vds fraction:</span>
    <span class="c1"># FRAC= [ vds (start,end)] / total vds ]</span>
    <span class="c1"># gap_max= max [ (vector difference) /  vds (start,end)]</span>
    <span class="c1"># --------------------------------------------------------------</span>

    <span class="c1"># collect all zijderveld data to arrays and calculate VDS</span>

    <span class="n">z_temperatures</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">zijdblock</span><span class="p">]</span>
    <span class="n">zdata</span> <span class="o">=</span> <span class="p">[]</span>                <span class="c1"># array of zero-fields measurements in Cartezian coordinates</span>
    <span class="c1"># array of vector differences (for vds calculation)</span>
    <span class="n">vector_diffs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">NRM</span> <span class="o">=</span> <span class="n">zijdblock</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>     <span class="c1"># NRM</span>

    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">zijdblock</span><span class="p">)):</span>
        <span class="n">DIR</span> <span class="o">=</span> <span class="p">[</span><span class="n">zijdblock</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">zijdblock</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="n">old_div</span><span class="p">(</span><span class="n">zijdblock</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span> <span class="n">NRM</span><span class="p">)]</span>
        <span class="n">cart</span> <span class="o">=</span> <span class="n">dir2cart</span><span class="p">(</span><span class="n">DIR</span><span class="p">)</span>
        <span class="n">zdata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">cart</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cart</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">cart</span><span class="p">[</span><span class="mi">2</span><span class="p">]]))</span>
        <span class="k">if</span> <span class="n">k</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">vector_diffs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">zdata</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">zdata</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span><span class="o">**</span><span class="mi">2</span><span class="p">)))</span>
    <span class="c1"># last vector difference: from the last point to the origin.</span>
    <span class="n">vector_diffs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">zdata</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)))</span>
    <span class="n">vds</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">vector_diffs</span><span class="p">)</span>  <span class="c1"># vds calculation</span>
    <span class="n">zdata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">zdata</span><span class="p">)</span>
    <span class="n">vector_diffs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vector_diffs</span><span class="p">)</span>

    <span class="c1"># calculate the vds within the chosen segment</span>
    <span class="n">vector_diffs_segment</span> <span class="o">=</span> <span class="n">vector_diffs</span><span class="p">[</span><span class="n">zstart</span><span class="p">:</span><span class="n">zend</span><span class="p">]</span>
    <span class="c1"># FRAC calculation</span>
    <span class="n">FRAC</span> <span class="o">=</span> <span class="n">old_div</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">vector_diffs_segment</span><span class="p">),</span> <span class="n">vds</span><span class="p">)</span>
    <span class="n">pars</span><span class="p">[</span><span class="n">frac_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">FRAC</span>

    <span class="c1"># gap_max calculation</span>
    <span class="n">max_FRAC_gap</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span>
        <span class="n">old_div</span><span class="p">(</span><span class="n">vector_diffs_segment</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="n">vector_diffs_segment</span><span class="p">)))</span>
    <span class="n">pars</span><span class="p">[</span><span class="n">gmax_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">max_FRAC_gap</span>

    <span class="c1"># ---------------------------------------------------------------------</span>
    <span class="c1"># Calculate the &quot;scat box&quot;</span>
    <span class="c1"># all data-points, pTRM checks, and tail-checks, should be inside a &quot;scat box&quot;</span>
    <span class="c1"># ---------------------------------------------------------------------</span>

    <span class="c1"># initialization</span>
    <span class="c1"># fail scat due to arai plot data points</span>
    <span class="n">pars</span><span class="p">[</span><span class="s2">&quot;fail_arai_beta_box_scatter&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">pars</span><span class="p">[</span><span class="s2">&quot;fail_ptrm_beta_box_scatter&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># fail scat due to pTRM checks</span>
    <span class="n">pars</span><span class="p">[</span><span class="s2">&quot;fail_tail_beta_box_scatter&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># fail scat due to tail checks</span>
    <span class="n">pars</span><span class="p">[</span><span class="n">scat_key</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;t&quot;</span>  <span class="c1"># Pass by default</span>

    <span class="c1"># --------------------------------------------------------------</span>
    <span class="c1"># collect all Arai plot data points in arrays</span>

    <span class="n">x_Arai</span><span class="p">,</span> <span class="n">y_Arai</span><span class="p">,</span> <span class="n">t_Arai</span><span class="p">,</span> <span class="n">steps_Arai</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">NRMs</span> <span class="o">=</span> <span class="n">araiblock</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">PTRMs</span> <span class="o">=</span> <span class="n">araiblock</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">ptrm_checks</span> <span class="o">=</span> <span class="n">araiblock</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">ptrm_tail</span> <span class="o">=</span> <span class="n">araiblock</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>

    <span class="n">PTRMs_temperatures</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">PTRMs</span><span class="p">]</span>
    <span class="n">NRMs_temperatures</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">NRMs</span><span class="p">]</span>
    <span class="n">NRM</span> <span class="o">=</span> <span class="n">NRMs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">NRMs</span><span class="p">)):</span>
        <span class="n">index_pTRMs</span> <span class="o">=</span> <span class="n">PTRMs_temperatures</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">NRMs</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">x_Arai</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">old_div</span><span class="p">(</span><span class="n">PTRMs</span><span class="p">[</span><span class="n">index_pTRMs</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span> <span class="n">NRM</span><span class="p">))</span>
        <span class="n">y_Arai</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">old_div</span><span class="p">(</span><span class="n">NRMs</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span> <span class="n">NRM</span><span class="p">))</span>
        <span class="n">t_Arai</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">NRMs</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">NRMs</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">steps_Arai</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;ZI&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">steps_Arai</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;IZ&#39;</span><span class="p">)</span>
    <span class="n">x_Arai</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x_Arai</span><span class="p">)</span>
    <span class="n">y_Arai</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_Arai</span><span class="p">)</span>

    <span class="c1"># --------------------------------------------------------------</span>
    <span class="c1"># collect all pTRM check to arrays</span>

    <span class="n">x_ptrm_check</span><span class="p">,</span> <span class="n">y_ptrm_check</span><span class="p">,</span> <span class="n">ptrm_checks_temperatures</span><span class="p">,</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">x_ptrm_check_starting_point</span><span class="p">,</span> <span class="n">y_ptrm_check_starting_point</span><span class="p">,</span> <span class="n">ptrm_checks_starting_temperatures</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ptrm_checks</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">ptrm_checks</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">NRMs_temperatures</span><span class="p">:</span>
            <span class="c1"># find the starting point of the pTRM check:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">datablock</span><span class="p">)):</span>
                <span class="n">rec</span> <span class="o">=</span> <span class="n">datablock</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="k">if</span> <span class="s2">&quot;LT-PTRM-I&quot;</span> <span class="ow">in</span> <span class="n">rec</span><span class="p">[</span><span class="n">meth_key</span><span class="p">]</span> <span class="ow">and</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="n">temp_key</span><span class="p">])</span> <span class="o">==</span> <span class="n">ptrm_checks</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
                    <span class="n">starting_temperature</span> <span class="o">=</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">datablock</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">temp_key</span><span class="p">]))</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">index</span> <span class="o">=</span> <span class="n">t_Arai</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">starting_temperature</span><span class="p">)</span>
                        <span class="n">x_ptrm_check_starting_point</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_Arai</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
                        <span class="n">y_ptrm_check_starting_point</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_Arai</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
                        <span class="n">ptrm_checks_starting_temperatures</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                            <span class="n">starting_temperature</span><span class="p">)</span>

                        <span class="n">index_zerofield</span> <span class="o">=</span> <span class="n">zerofield_temperatures</span><span class="o">.</span><span class="n">index</span><span class="p">(</span>
                            <span class="n">ptrm_checks</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                        <span class="n">x_ptrm_check</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">old_div</span><span class="p">(</span><span class="n">ptrm_checks</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span> <span class="n">NRM</span><span class="p">))</span>
                        <span class="n">y_ptrm_check</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                            <span class="n">old_div</span><span class="p">(</span><span class="n">zerofields</span><span class="p">[</span><span class="n">index_zerofield</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span> <span class="n">NRM</span><span class="p">))</span>
                        <span class="n">ptrm_checks_temperatures</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ptrm_checks</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

                        <span class="k">break</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="k">pass</span>

    <span class="n">x_ptrm_check_starting_point</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x_ptrm_check_starting_point</span><span class="p">)</span>
    <span class="n">y_ptrm_check_starting_point</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_ptrm_check_starting_point</span><span class="p">)</span>
    <span class="n">ptrm_checks_starting_temperatures</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
        <span class="n">ptrm_checks_starting_temperatures</span><span class="p">)</span>
    <span class="n">x_ptrm_check</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x_ptrm_check</span><span class="p">)</span>
    <span class="n">y_ptrm_check</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_ptrm_check</span><span class="p">)</span>
    <span class="n">ptrm_checks_temperatures</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ptrm_checks_temperatures</span><span class="p">)</span>

    <span class="c1"># --------------------------------------------------------------</span>
    <span class="c1"># collect tail checks to arrays</span>

    <span class="n">x_tail_check</span><span class="p">,</span> <span class="n">y_tail_check</span><span class="p">,</span> <span class="n">tail_check_temperatures</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">x_tail_check_starting_point</span><span class="p">,</span> <span class="n">y_tail_check_starting_point</span><span class="p">,</span> <span class="n">tail_checks_starting_temperatures</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ptrm_tail</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">ptrm_tail</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">NRMs_temperatures</span><span class="p">:</span>

            <span class="c1"># find the starting point of the pTRM check:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">datablock</span><span class="p">)):</span>
                <span class="n">rec</span> <span class="o">=</span> <span class="n">datablock</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="k">if</span> <span class="s2">&quot;LT-PTRM-MD&quot;</span> <span class="ow">in</span> <span class="n">rec</span><span class="p">[</span><span class="n">meth_key</span><span class="p">]</span> <span class="ow">and</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="n">temp_key</span><span class="p">])</span> <span class="o">==</span> <span class="n">ptrm_tail</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
                    <span class="n">starting_temperature</span> <span class="o">=</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">datablock</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">temp_key</span><span class="p">]))</span>
                    <span class="k">try</span><span class="p">:</span>

                        <span class="n">index</span> <span class="o">=</span> <span class="n">t_Arai</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">starting_temperature</span><span class="p">)</span>
                        <span class="n">x_tail_check_starting_point</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_Arai</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
                        <span class="n">y_tail_check_starting_point</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_Arai</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
                        <span class="n">tail_checks_starting_temperatures</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                            <span class="n">starting_temperature</span><span class="p">)</span>

                        <span class="n">index_infield</span> <span class="o">=</span> <span class="n">infield_temperatures</span><span class="o">.</span><span class="n">index</span><span class="p">(</span>
                            <span class="n">ptrm_tail</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                        <span class="n">x_tail_check</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                            <span class="n">old_div</span><span class="p">(</span><span class="n">infields</span><span class="p">[</span><span class="n">index_infield</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span> <span class="n">NRM</span><span class="p">))</span>
                        <span class="n">y_tail_check</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                            <span class="n">old_div</span><span class="p">(</span><span class="n">ptrm_tail</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span> <span class="n">NRM</span><span class="p">)</span> <span class="o">+</span> <span class="n">old_div</span><span class="p">(</span><span class="n">zerofields</span><span class="p">[</span><span class="n">index_infield</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span> <span class="n">NRM</span><span class="p">))</span>
                        <span class="n">tail_check_temperatures</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ptrm_tail</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

                        <span class="k">break</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="k">pass</span>

    <span class="n">x_tail_check</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x_tail_check</span><span class="p">)</span>
    <span class="n">y_tail_check</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_tail_check</span><span class="p">)</span>
    <span class="n">tail_check_temperatures</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">tail_check_temperatures</span><span class="p">)</span>
    <span class="n">x_tail_check_starting_point</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x_tail_check_starting_point</span><span class="p">)</span>
    <span class="n">y_tail_check_starting_point</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_tail_check_starting_point</span><span class="p">)</span>
    <span class="n">tail_checks_starting_temperatures</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
        <span class="n">tail_checks_starting_temperatures</span><span class="p">)</span>

    <span class="c1"># --------------------------------------------------------------</span>
    <span class="c1"># collect the chosen segment in the Arai plot to arrays</span>

    <span class="n">x_Arai_segment</span> <span class="o">=</span> <span class="n">x_Arai</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">end</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>  <span class="c1"># chosen segent in the Arai plot</span>
    <span class="n">y_Arai_segment</span> <span class="o">=</span> <span class="n">y_Arai</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">end</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>  <span class="c1"># chosen segent in the Arai plot</span>

    <span class="c1"># --------------------------------------------------------------</span>
    <span class="c1"># collect pTRM checks in segment to arrays</span>
    <span class="c1"># notice, this is different than the conventional DRATS.</span>
    <span class="c1"># for scat calculation we take only the pTRM checks which were carried out</span>
    <span class="c1"># before reaching the highest temperature in the chosen segment</span>

    <span class="n">x_ptrm_check_for_SCAT</span><span class="p">,</span> <span class="n">y_ptrm_check_for_SCAT</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ptrm_checks_temperatures</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">ptrm_checks_temperatures</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">pars</span><span class="p">[</span><span class="n">min_key</span><span class="p">]</span> <span class="ow">and</span> <span class="n">ptrm_checks_starting_temperatures</span> <span class="o">&lt;=</span> <span class="n">pars</span><span class="p">[</span><span class="n">max_key</span><span class="p">]:</span>
            <span class="n">x_ptrm_check_for_SCAT</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_ptrm_check</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
            <span class="n">y_ptrm_check_for_SCAT</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_ptrm_check</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>

    <span class="n">x_ptrm_check_for_SCAT</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x_ptrm_check_for_SCAT</span><span class="p">)</span>
    <span class="n">y_ptrm_check_for_SCAT</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_ptrm_check_for_SCAT</span><span class="p">)</span>

    <span class="c1"># --------------------------------------------------------------</span>
    <span class="c1"># collect Tail checks in segment to arrays</span>
    <span class="c1"># for scat calculation we take only the tail checks which were carried out</span>
    <span class="c1"># before reaching the highest temperature in the chosen segment</span>

    <span class="n">x_tail_check_for_SCAT</span><span class="p">,</span> <span class="n">y_tail_check_for_SCAT</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tail_check_temperatures</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">tail_check_temperatures</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">pars</span><span class="p">[</span><span class="n">min_key</span><span class="p">]</span> <span class="ow">and</span> <span class="n">tail_checks_starting_temperatures</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">pars</span><span class="p">[</span><span class="n">max_key</span><span class="p">]:</span>
            <span class="n">x_tail_check_for_SCAT</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_tail_check</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
            <span class="n">y_tail_check_for_SCAT</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_tail_check</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>

    <span class="n">x_tail_check_for_SCAT</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x_tail_check_for_SCAT</span><span class="p">)</span>
    <span class="n">y_tail_check_for_SCAT</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_tail_check_for_SCAT</span><span class="p">)</span>

    <span class="c1"># --------------------------------------------------------------</span>
    <span class="c1"># calculate the lines that define the scat box:</span>

    <span class="c1"># if threshold value for beta is not defined, then scat cannot be calculated (pass)</span>
    <span class="c1"># in this case, scat pass</span>
    <span class="k">if</span> <span class="n">beta_key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">accept</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="n">accept</span><span class="p">[</span><span class="n">beta_key</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
        <span class="n">b_beta_threshold</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">accept</span><span class="p">[</span><span class="n">beta_key</span><span class="p">])</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="n">b_key</span><span class="p">]</span>             <span class="c1"># best fit line</span>
        <span class="n">cm_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x_Arai_segment</span><span class="p">))</span>  <span class="c1"># x center of mass</span>
        <span class="n">cm_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_Arai_segment</span><span class="p">))</span>  <span class="c1"># y center of mass</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">cm_y</span> <span class="o">-</span> <span class="n">b</span> <span class="o">*</span> <span class="n">cm_x</span>

        <span class="c1"># lines with slope = slope +/- 2*(specimen_b_beta)</span>

        <span class="n">two_sigma_beta_threshold</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">b_beta_threshold</span>
        <span class="n">two_sigma_slope_threshold</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">two_sigma_beta_threshold</span> <span class="o">*</span> <span class="n">b</span><span class="p">)</span>

        <span class="c1"># a line with a  shallower  slope  (b + 2*beta*b) passing through the center of mass</span>
        <span class="c1"># y=a1+b1x</span>
        <span class="n">b1</span> <span class="o">=</span> <span class="n">b</span> <span class="o">+</span> <span class="n">two_sigma_slope_threshold</span>
        <span class="n">a1</span> <span class="o">=</span> <span class="n">cm_y</span> <span class="o">-</span> <span class="n">b1</span> <span class="o">*</span> <span class="n">cm_x</span>

        <span class="c1"># bounding line with steeper  slope (b - 2*beta*b) passing through the center of mass</span>
        <span class="c1"># y=a2+b2x</span>
        <span class="n">b2</span> <span class="o">=</span> <span class="n">b</span> <span class="o">-</span> <span class="n">two_sigma_slope_threshold</span>
        <span class="n">a2</span> <span class="o">=</span> <span class="n">cm_y</span> <span class="o">-</span> <span class="n">b2</span> <span class="o">*</span> <span class="n">cm_x</span>

        <span class="c1"># lower bounding line of the &#39;beta box&#39;</span>
        <span class="c1"># y=intercept1+slop1x</span>
        <span class="n">slop1</span> <span class="o">=</span> <span class="n">old_div</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="p">((</span><span class="n">old_div</span><span class="p">(</span><span class="n">a2</span><span class="p">,</span> <span class="n">b2</span><span class="p">))))</span>
        <span class="n">intercept1</span> <span class="o">=</span> <span class="n">a1</span>

        <span class="c1"># higher bounding line of the &#39;beta box&#39;</span>
        <span class="c1"># y=intercept2+slop2x</span>

        <span class="n">slop2</span> <span class="o">=</span> <span class="n">old_div</span><span class="p">(</span><span class="n">a2</span><span class="p">,</span> <span class="p">((</span><span class="n">old_div</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">b1</span><span class="p">))))</span>
        <span class="n">intercept2</span> <span class="o">=</span> <span class="n">a2</span>

        <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;specimen_scat_bounding_line_high&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">intercept2</span><span class="p">,</span> <span class="n">slop2</span><span class="p">]</span>
        <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;specimen_scat_bounding_line_low&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">intercept1</span><span class="p">,</span> <span class="n">slop1</span><span class="p">]</span>

        <span class="c1"># --------------------------------------------------------------</span>
        <span class="c1"># check if the Arai data points are in the &#39;box&#39;</span>

        <span class="c1"># the two bounding lines</span>
        <span class="n">ymin</span> <span class="o">=</span> <span class="n">intercept1</span> <span class="o">+</span> <span class="n">x_Arai_segment</span> <span class="o">*</span> <span class="n">slop1</span>
        <span class="n">ymax</span> <span class="o">=</span> <span class="n">intercept2</span> <span class="o">+</span> <span class="n">x_Arai_segment</span> <span class="o">*</span> <span class="n">slop2</span>

        <span class="c1"># arrays of &quot;True&quot; or &quot;False&quot;</span>
        <span class="n">check_1</span> <span class="o">=</span> <span class="n">y_Arai_segment</span> <span class="o">&gt;</span> <span class="n">ymax</span>
        <span class="n">check_2</span> <span class="o">=</span> <span class="n">y_Arai_segment</span> <span class="o">&lt;</span> <span class="n">ymin</span>

        <span class="c1"># check if at least one &quot;True&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">check_1</span><span class="p">)</span> <span class="o">+</span> <span class="nb">sum</span><span class="p">(</span><span class="n">check_2</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">pars</span><span class="p">[</span><span class="s2">&quot;fail_arai_beta_box_scatter&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="c1"># --------------------------------------------------------------</span>
        <span class="c1"># check if the pTRM checks data points are in the &#39;box&#39;</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_ptrm_check_for_SCAT</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>

            <span class="c1"># the two bounding lines</span>
            <span class="n">ymin</span> <span class="o">=</span> <span class="n">intercept1</span> <span class="o">+</span> <span class="n">x_ptrm_check_for_SCAT</span> <span class="o">*</span> <span class="n">slop1</span>
            <span class="n">ymax</span> <span class="o">=</span> <span class="n">intercept2</span> <span class="o">+</span> <span class="n">x_ptrm_check_for_SCAT</span> <span class="o">*</span> <span class="n">slop2</span>

            <span class="c1"># arrays of &quot;True&quot; or &quot;False&quot;</span>
            <span class="n">check_1</span> <span class="o">=</span> <span class="n">y_ptrm_check_for_SCAT</span> <span class="o">&gt;</span> <span class="n">ymax</span>
            <span class="n">check_2</span> <span class="o">=</span> <span class="n">y_ptrm_check_for_SCAT</span> <span class="o">&lt;</span> <span class="n">ymin</span>

            <span class="c1"># check if at least one &quot;True&quot;</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">check_1</span><span class="p">)</span> <span class="o">+</span> <span class="nb">sum</span><span class="p">(</span><span class="n">check_2</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">pars</span><span class="p">[</span><span class="s2">&quot;fail_ptrm_beta_box_scatter&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="c1"># --------------------------------------------------------------</span>
        <span class="c1"># check if the tail checks data points are in the &#39;box&#39;</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_tail_check_for_SCAT</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>

            <span class="c1"># the two bounding lines</span>
            <span class="n">ymin</span> <span class="o">=</span> <span class="n">intercept1</span> <span class="o">+</span> <span class="n">x_tail_check_for_SCAT</span> <span class="o">*</span> <span class="n">slop1</span>
            <span class="n">ymax</span> <span class="o">=</span> <span class="n">intercept2</span> <span class="o">+</span> <span class="n">x_tail_check_for_SCAT</span> <span class="o">*</span> <span class="n">slop2</span>

            <span class="c1"># arrays of &quot;True&quot; or &quot;False&quot;</span>
            <span class="n">check_1</span> <span class="o">=</span> <span class="n">y_tail_check_for_SCAT</span> <span class="o">&gt;</span> <span class="n">ymax</span>
            <span class="n">check_2</span> <span class="o">=</span> <span class="n">y_tail_check_for_SCAT</span> <span class="o">&lt;</span> <span class="n">ymin</span>

            <span class="c1"># check if at least one &quot;True&quot;</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">check_1</span><span class="p">)</span> <span class="o">+</span> <span class="nb">sum</span><span class="p">(</span><span class="n">check_2</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">pars</span><span class="p">[</span><span class="s2">&quot;fail_tail_beta_box_scatter&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="c1"># --------------------------------------------------------------</span>
        <span class="c1"># check if specimen_scat is PASS or FAIL:</span>

        <span class="k">if</span> <span class="n">pars</span><span class="p">[</span><span class="s2">&quot;fail_tail_beta_box_scatter&quot;</span><span class="p">]</span> <span class="ow">or</span> <span class="n">pars</span><span class="p">[</span><span class="s2">&quot;fail_ptrm_beta_box_scatter&quot;</span><span class="p">]</span> <span class="ow">or</span> <span class="n">pars</span><span class="p">[</span><span class="s2">&quot;fail_arai_beta_box_scatter&quot;</span><span class="p">]:</span>
            <span class="n">pars</span><span class="p">[</span><span class="n">scat_key</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;f&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pars</span><span class="p">[</span><span class="n">scat_key</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;t&#39;</span>
    <span class="n">krv_pars</span><span class="o">=</span><span class="n">get_curve</span><span class="p">(</span><span class="n">araiblock</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">krv_pars</span><span class="p">:</span>
        <span class="n">pars</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">=</span><span class="n">krv_pars</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">pars</span><span class="p">,</span> <span class="mi">0</span></div>


<div class="viewcode-block" id="getkeys"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.getkeys">[docs]</a><span class="k">def</span> <span class="nf">getkeys</span><span class="p">(</span><span class="n">table</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Customize by commenting out unwanted keys.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">keys</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">table</span> <span class="o">==</span> <span class="s2">&quot;ER_expedition&quot;</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">if</span> <span class="n">table</span> <span class="o">==</span> <span class="s2">&quot;ER_citations&quot;</span><span class="p">:</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;er_citation_name&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;long_authors&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;year&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;citation_type&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;doi&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;journal&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;volume&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;pages&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;book_title&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;book_editors&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;publisher&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;city&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">table</span> <span class="o">==</span> <span class="s2">&quot;ER_locations&quot;</span><span class="p">:</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;er_location_name&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;er_scientist_mail_names&quot;</span><span class="p">)</span>
<span class="c1">#        keys.append(&quot;er_location_alternatives&quot; )</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;location_type&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;location_begin_lat&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;location_begin_lon&quot;</span><span class="p">)</span>
<span class="c1">#        keys.append(&quot;location_begin_elevation&quot; )</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;location_end_lat&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;location_end_lon&quot;</span><span class="p">)</span>
<span class="c1">#        keys.append(&quot;location_end_elevation&quot; )</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;continent_ocean&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;country&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;region&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;plate_block&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;terrane&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;tectonic_setting&quot;</span><span class="p">)</span>
<span class="c1">#        keys.append(&quot;er_citation_names&quot;)</span>
    <span class="k">if</span> <span class="n">table</span> <span class="o">==</span> <span class="s2">&quot;ER_Formations&quot;</span><span class="p">:</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;er_formation_name&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;formation_class&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;formation_lithology&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;formation_paleo_environment&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;formation_thickness&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;formation_description&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">table</span> <span class="o">==</span> <span class="s2">&quot;ER_sections&quot;</span><span class="p">:</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;er_section_name&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;er_section_alternatives&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;er_expedition_name&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;er_location_name&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;er_formation_name&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;er_member_name&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;section_definition&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;section_class&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;section_lithology&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;section_type&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;section_n&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;section_begin_lat&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;section_begin_lon&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;section_begin_elevation&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;section_begin_height&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;section_begin_drill_depth&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;section_begin_composite_depth&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;section_end_lat&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;section_end_lon&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;section_end_elevation&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;section_end_height&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;section_end_drill_depth&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;section_end_composite_depth&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;section_azimuth&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;section_dip&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;section_description&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;er_scientist_mail_names&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;er_citation_names&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">table</span> <span class="o">==</span> <span class="s2">&quot;ER_sites&quot;</span><span class="p">:</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;er_location_name&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;er_site_name&quot;</span><span class="p">)</span>
<span class="c1">#        keys.append(&quot;er_site_alternatives&quot;)</span>
<span class="c1">#        keys.append(&quot;er_formation_name&quot;)</span>
<span class="c1">#        keys.append(&quot;er_member_name&quot;)</span>
<span class="c1">#        keys.append(&quot;er_section_name&quot;)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;er_scientist_mail_names&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;site_class&quot;</span><span class="p">)</span>
<span class="c1">#        keys.append(&quot;site_type&quot;)</span>
<span class="c1">#        keys.append(&quot;site_lithology&quot;)</span>
<span class="c1">#        keys.append(&quot;site_height&quot;)</span>
<span class="c1">#        keys.append(&quot;site_drill_depth&quot;)</span>
<span class="c1">#        keys.append(&quot;site_composite_depth&quot;)</span>
<span class="c1">#        keys.append(&quot;site_lithology&quot;)</span>
<span class="c1">#        keys.append(&quot;site_description&quot;)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;site_lat&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;site_lon&quot;</span><span class="p">)</span>
<span class="c1">#        keys.append(&quot;site_location_precision&quot;)</span>
<span class="c1">#        keys.append(&quot;site_elevation&quot;)</span>
    <span class="k">if</span> <span class="n">table</span> <span class="o">==</span> <span class="s2">&quot;ER_samples&quot;</span><span class="p">:</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;er_location_name&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;er_site_name&quot;</span><span class="p">)</span>
<span class="c1">#       keys.append(&quot;er_sample_alternatives&quot;)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;sample_azimuth&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;sample_dip&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;sample_bed_dip&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;sample_bed_dip_direction&quot;</span><span class="p">)</span>
<span class="c1">#       keys.append(&quot;sample_cooling_rate&quot;)</span>
<span class="c1">#       keys.append(&quot;sample_type&quot;)</span>
<span class="c1">#       keys.append(&quot;sample_lat&quot;)</span>
<span class="c1">#       keys.append(&quot;sample_lon&quot;)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;magic_method_codes&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">table</span> <span class="o">==</span> <span class="s2">&quot;ER_ages&quot;</span><span class="p">:</span>
        <span class="c1">#       keys.append(&quot;er_location_name&quot;)</span>
        <span class="c1">#       keys.append(&quot;er_site_name&quot;)</span>
        <span class="c1">#       keys.append(&quot;er_section_name&quot;)</span>
        <span class="c1">#       keys.append(&quot;er_formation_name&quot;)</span>
        <span class="c1">#       keys.append(&quot;er_member_name&quot;)</span>
        <span class="c1">#       keys.append(&quot;er_site_name&quot;)</span>
        <span class="c1">#       keys.append(&quot;er_sample_name&quot;)</span>
        <span class="c1">#       keys.append(&quot;er_specimen_name&quot;)</span>
        <span class="c1">#       keys.append(&quot;er_fossil_name&quot;)</span>
        <span class="c1">#       keys.append(&quot;er_mineral_name&quot;)</span>
        <span class="c1">#       keys.append(&quot;tiepoint_name&quot;)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;age&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;age_sigma&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;age_unit&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;age_range_low&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;age_range_hi&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;timescale_eon&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;timescale_era&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;timescale_period&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;timescale_epoch&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;timescale_stage&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;biostrat_zone&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;conodont_zone&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;magnetic_reversal_chron&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;astronomical_stage&quot;</span><span class="p">)</span>
<span class="c1">#       keys.append(&quot;age_description&quot;)</span>
<span class="c1">#       keys.append(&quot;magic_method_codes&quot;)</span>
<span class="c1">#       keys.append(&quot;er_timescale_citation_names&quot;)</span>
<span class="c1">#       keys.append(&quot;er_citation_names&quot;)</span>
    <span class="k">if</span> <span class="n">table</span> <span class="o">==</span> <span class="s2">&quot;MAGIC_measurements&quot;</span><span class="p">:</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;er_location_name&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;er_site_name&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;er_sample_name&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;er_specimen_name&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;measurement_positions&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;treatment_temp&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;treatment_ac_field&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;treatment_dc_field&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;treatment_dc_field_phi&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;treatment_dc_field_theta&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;magic_experiment_name&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;magic_instrument_codes&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;measurement_temp&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;magic_method_codes&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;measurement_inc&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;measurement_dec&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;measurement_magn_moment&quot;</span><span class="p">)</span>
        <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;measurement_csd&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">keys</span></div>

<span class="c1"># commented out as of 8/18/22</span>
<span class="c1">#def getnames():</span>
<span class="c1">#    &quot;&quot;&quot;</span>
<span class="c1">#    get mail names</span>
<span class="c1">#    &quot;&quot;&quot;</span>
<span class="c1">#    namestring = &quot;&quot;</span>
<span class="c1">#    addmore = 1</span>
<span class="c1">#    while addmore:</span>
<span class="c1">#        scientist = input(&quot;Enter  name  - &lt;Return&gt; when done &quot;)</span>
<span class="c1">#        if scientist != &quot;&quot;:</span>
<span class="c1">#            namestring = namestring + &quot;:&quot; + scientist</span>
<span class="c1">#        else:</span>
<span class="c1">#            namestring = namestring[1:]</span>
<span class="c1">#            addmore = 0</span>
<span class="c1">#    return namestring</span>


<div class="viewcode-block" id="magic_help"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.magic_help">[docs]</a><span class="k">def</span> <span class="nf">magic_help</span><span class="p">(</span><span class="n">keyhelp</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a help message for a given magic key.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    keyhelp : str</span>
<span class="sd">        key name that the user seeks more information about</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    str </span>
<span class="sd">        Information about the input key</span>
<span class="sd">    </span>
<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; pmag.magic_help(&#39;location_url&#39;)</span>
<span class="sd">    &#39;Website URL for the location explicitly&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">helpme</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;er_location_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Name for location or drill site&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;er_location_alternatives&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Colon-delimited list of alternative names and abbreviations&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;location_type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Location type&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;location_begin_lat&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Begin of section or core or outcrop -- latitude&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;location_begin_lon&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Begin of section or core or outcrop -- longitude&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;location_begin_elevation&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Begin of section or core or outcrop -- elevation relative to sealevel&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;location_end_lat&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Ending of section or core -- latitude &quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;location_end_lon&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Ending of section or core -- longitude &quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;location_end_elevation&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Ending of section or core -- elevation relative to sealevel&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;location_geoid&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Geoid used in determination of latitude and longitude:  WGS84, GEOID03, USGG2003, GEOID99, G99SSS , G99BM, DEFLEC99 &quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;continent_ocean&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Name for continent or ocean island region&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;ocean_sea&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Name for location in an ocean or sea&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;country&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Country name&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Region name&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;plate_block&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Plate or tectonic block name&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;terrane&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Terrane name&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;tectonic_setting&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Tectonic setting&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;location_description&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Detailed description&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;location_url&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Website URL for the location explicitly&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;er_scientist_mail_names&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Colon-delimited list of names for scientists who described location&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;er_citation_names&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Colon-delimited list of citations&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;er_formation_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Name for formation&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;er_formation_alternatives&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Colon-delimited list of alternative names and abbreviations&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;formation_class&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;General lithology class: igneous, metamorphic or sedimentary&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;formation_lithology&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Lithology: e.g., basalt, sandstone, etc.&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;formation_paleo_enviroment&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Depositional environment&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;formation_thickness&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Formation thickness&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;er_member_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Name for member&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;er_member_alternatives&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Colon-delimited list of alternative names and abbreviations&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;er_formation_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Name for formation&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;member_class&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;General lithology type&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;member_lithology&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Lithology&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;member_paleo_environment&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Depositional environment&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;member_thickness&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Member thickness&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;member_description&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Detailed description&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;er_section_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Name for section or core&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;er_section_alternatives&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Colon-delimited list of alternative names and abbreviations&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;er_expedition_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Name for seagoing or land expedition&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;er_location_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Name for location or drill site&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;er_formation_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Name for formation&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;er_member_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Name for member&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;section_definition&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;General definition of section&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;section_class&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;General lithology type&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;section_lithology&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Section lithology or archeological classification&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;section_type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Section type&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;section_n&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Number of subsections included composite (stacked) section&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;section_begin_lat&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Begin of section or core -- latitude&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;section_begin_lon&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Begin of section or core -- longitude&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;section_begin_elevation&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Begin of section or core -- elevation relative to sealevel&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;section_begin_height&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Begin of section or core -- stratigraphic height&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;section_begin_drill_depth&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Begin of section or core -- depth in MBSF as used by ODP&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;section_begin_composite_depth&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Begin of section or core -- composite depth in MBSF as used by ODP&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;section_end_lat&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;End of section or core -- latitude &quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;section_end_lon&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;End of section or core -- longitude &quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;section_end_elevation&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;End of section or core -- elevation relative to sealevel&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;section_end_height&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;End of section or core -- stratigraphic height&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;section_end_drill_depth&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;End of section or core -- depth in MBSF as used by ODP&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;section_end_composite_depth&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;End of section or core -- composite depth in MBSF as used by ODP&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;section_azimuth&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Section azimuth as measured clockwise from the north&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;section_dip&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Section dip as measured into the outcrop&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;section_description&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Detailed description&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;er_site_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Name for site&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;er_site_alternatives&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Colon-delimited list of alternative names and abbreviations&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;er_expedition_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Name for seagoing or land expedition&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;er_location_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Name for location or drill site&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;er_section_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Name for section or core&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;er_formation_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Name for formation&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;er_member_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Name for member&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;site_definition&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;General definition of site&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;site_class&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;[A]rchaeologic,[E]xtrusive,[I]ntrusive,[M]etamorphic,[S]edimentary&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;site_lithology&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Site lithology or archeological classification&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;site_type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Site type: slag, lava flow, sediment layer, etc.&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;site_lat&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Site location -- latitude&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;site_lon&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Site location -- longitude&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;site_location_precision&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Site location -- precision in latitude and longitude&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;site_elevation&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Site location -- elevation relative to sealevel&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;site_height&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Site location -- stratigraphic height&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;site_drill_depth&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Site location -- depth in MBSF as used by ODP&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;site_composite_depth&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Site location -- composite depth in MBSF as used by ODP&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;site_description&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Detailed description&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;magic_method_codes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Colon-delimited list of method codes&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;er_sample_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Name for sample&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;er_sample_alternatives&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Colon-delimited list of alternative names and abbreviations&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;er_expedition_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Name for seagoing or land expedition&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;er_location_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Name for location or drill site&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;er_section_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Name for section or core&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;er_formation_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Name for formation&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;er_member_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Name for member&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;er_site_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Name for site&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;sample_class&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;General lithology type&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;sample_lithology&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Sample lithology or archeological classification&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;sample_type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Sample type&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;sample_texture&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Sample texture&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;sample_alteration&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Sample alteration grade&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;sample_alteration_type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Sample alteration type&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;sample_lat&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Sample location -- latitude&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;sample_lon&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Sample location -- longitude&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;sample_location_precision&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Sample location -- precision in latitude and longitude&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;sample_elevation&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Sample location -- elevation relative to sealevel&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;sample_height&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Sample location -- stratigraphic height&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;sample_drill_depth&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Sample location -- depth in MBSF as used by ODP&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;sample_composite_depth&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Sample location -- composite depth in MBSF as used by ODP&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;sample_date&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Sampling date&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;sample_time_zone&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Sampling time zone&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;sample_azimuth&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Sample azimuth as measured clockwise from the north&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;sample_dip&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Sample dip as measured into the outcrop&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;sample_bed_dip_direction&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Direction of the dip of a paleo-horizontal plane in the bedding&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;sample_bed_dip&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Dip of the bedding as measured to the right of strike direction&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;sample_cooling_rate&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Estimated ancient in-situ cooling rate per Ma&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;er_specimen_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Name for specimen&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;er_specimen_alternatives&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Colon-delimited list of alternative names and abbreviations&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;er_expedition_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Name for seagoing or land expedition&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;er_location_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Name for location or drill site&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;er_section_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Name for section or core&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;er_formation_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Name for formation&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;er_member_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Name for member&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;er_site_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Name for site&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;er_sample_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Name for sample&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;specimen_class&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;General lithology type&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;specimen_lithology&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Specimen lithology or archeological classification&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;specimen_type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Specimen type&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;specimen_texture&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Specimen texture&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;specimen_alteration&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Specimen alteration grade&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;specimen_alteration_type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Specimen alteration type&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;specimen_elevation&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Specimen location -- elevation relative to sealevel&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;specimen_height&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Specimen location -- stratigraphic height&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;specimen_drill_depth&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Specimen location -- depth in MBSF as used by ODP&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;specimen_composite_depth&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Specimen location -- composite depth in MBSF as used by ODP&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;specimen_azimuth&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Specimen azimuth as measured clockwise from the north&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;specimen_dip&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Specimen dip as measured into the outcrop&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;specimen_volume&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Specimen volume&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;specimen_weight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Specimen weight&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;specimen_density&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Specimen density&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;specimen_size&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Specimen grain size fraction&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;er_expedition_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Name for seagoing or land expedition&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;er_location_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Name for location or drill site&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;er_formation_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Name for formation&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;er_member_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Name for member&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;er_site_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Name for site&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;er_sample_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Name for sample&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;er_specimen_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Name for specimen&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;er_fossil_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Name for fossil&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;er_mineral_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Name for mineral&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-ALPHA&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Age determination by using alpha counting&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-ARAR&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;40Ar/39Ar age determination&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-ARAR-AP&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;40Ar/39Ar age determination: Age plateau&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-ARAR-II&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;40Ar/39Ar age determination: Inverse isochron&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-ARAR-NI&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;40Ar/39Ar age determination: Normal isochron&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-ARAR-TF&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;40Ar/39Ar age determination: Total fusion or recombined age&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-C14&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Radiocarbon age determination&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-C14-AMS&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Radiocarbon age determination: AMS&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-C14-BETA&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Radiocarbon age determination: Beta decay counting&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-C14-CAL&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Radiocarbon age determination: Calibrated&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-CC&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Correlation chronology&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-CC-ARCH&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Correlation chronology: Archeology&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-CC-ARM&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Correlation chronology: ARM&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-CC-ASTRO&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Correlation chronology: Astronomical&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-CC-CACO3&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Correlation chronology: Calcium carbonate&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-CC-COLOR&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Correlation chronology: Color or reflectance&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-CC-GRAPE&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Correlation chronology: Gamma Ray Polarimeter Experiment&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-CC-IRM&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Correlation chronology: IRM&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-CC-ISO&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Correlation chronology: Stable isotopes&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-CC-REL&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Correlation chronology: Relative chronology other than stratigraphic successions&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-CC-STRAT&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Correlation chronology: Stratigraphic succession&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-CC-TECT&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Correlation chronology: Tectites and microtectites&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-CC-TEPH&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Correlation chronology: Tephrochronology&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-CC-X&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Correlation chronology: Susceptibility&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-CHEM&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Chemical chronology&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-CHEM-AAR&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Chemical chronology: Amino acid racemization&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-CHEM-OH&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Chemical chronology: Obsidian hydration&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-CHEM-SC&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Chemical chronology: Stoan coatings CaCO3&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-CHEM-TH&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Chemical chronology: Tephra hydration&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-COSMO&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Cosmogenic age determination&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-COSMO-AL26&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Cosmogenic age determination: 26Al&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-COSMO-AR39&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Cosmogenic age determination: 39Ar&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-COSMO-BE10&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Cosmogenic age determination: 10Be&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-COSMO-C14&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Cosmogenic age determination: 14C&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-COSMO-CL36&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Cosmogenic age determination: 36Cl&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-COSMO-HE3&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Cosmogenic age determination: 3He&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-COSMO-KR81&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Cosmogenic age determination: 81Kr&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-COSMO-NE21&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Cosmogenic age determination: 21Ne&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-COSMO-NI59&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Cosmogenic age determination: 59Ni&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-COSMO-SI32&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Cosmogenic age determination: 32Si&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-DENDRO&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Dendrochronology&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-ESR&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Electron Spin Resonance&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-FOSSIL&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Age determined from fossil record&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-FT&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Fission track age determination&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-HIST&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Historically recorded geological event&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-INT&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Age determination through interpolation between at least two geological units of known age&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-INT-L&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Age determination through interpolation between at least two geological units of known age: Linear&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-INT-S&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Age determination through interpolation between at least two geological units of known age: Cubic spline&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-ISO&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Age determined by isotopic dating, but no further details available&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-KAR&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;40K-40Ar age determination&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-KAR-I&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;40K-40Ar age determination: Isochron&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-KAR-MA&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;40K-40Ar age determination: Model age&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-KCA&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;40K-40Ca age determination&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-KCA-I&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;40K-40Ca age determination: Isochron&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-KCA-MA&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;40K-40Ca age determination: Model age&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-LABA&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;138La-138Ba age determination&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-LABA-I&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;138La-138Ba age determination: Isochron&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-LABA-MA&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;138La-138Ba age determination: Model age&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-LACE&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;138La-138Ce age determination&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-LACE-I&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;138La-138Ce age determination: Isochron&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-LACE-MA&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;138La-138Ce age determination: Model age&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-LICHE&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Lichenometry&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-LUHF&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;176Lu-176Hf age determination&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-LUHF-I&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;176Lu-176Hf age determination: Isochron&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-LUHF-MA&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;176Lu-176Hf age determination: Model age&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-LUM&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Luminescence&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-LUM-IRS&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Luminescence: Infrared stimulated luminescence&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-LUM-OS&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Luminescence: Optically stimulated luminescence&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-LUM-TH&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Luminescence: Thermoluminescence&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-MOD&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Model curve fit to available age dates&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-MOD-L&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Model curve fit to available age dates: Linear&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-MOD-S&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Model curve fit to available age dates: Cubic spline&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-MORPH&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Geomorphic chronology&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-MORPH-DEF&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Geomorphic chronology: Rate of deformation&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-MORPH-DEP&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Geomorphic chronology: Rate of deposition&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-MORPH-POS&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Geomorphic chronology: Geomorphology position&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-MORPH-WEATH&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Geomorphic chronology: Rock and mineral weathering&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-NO&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Unknown geochronology method&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-O18&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Oxygen isotope dating&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-PBPB&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;207Pb-206Pb age determination&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-PBPB-C&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;207Pb-206Pb age determination: Common Pb&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-PBPB-I&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;207Pb-206Pb age determination: Isochron&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-PLEO&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Pleochroic haloes&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-PMAG-ANOM&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Paleomagnetic age determination: Magnetic anomaly identification&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-PMAG-APWP&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Paleomagnetic age determination: Comparing paleomagnetic data to APWP&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-PMAG-ARCH&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Paleomagnetic age determination: Archeomagnetism&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-PMAG-DIR&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Paleomagnetic age determination: Directions&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-PMAG-POL&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Paleomagnetic age determination: Polarities&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-PMAG-REGSV&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Paleomagnetic age determination: Correlation to a regional secular variation curve&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-PMAG-RPI&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Paleomagnetic age determination: Relative paleointensity&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-PMAG-VEC&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Paleomagnetic age determination: Full vector&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-RATH&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;226Ra-230Th age determination&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-RBSR&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;87Rb-87Sr age determination&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-RBSR-I&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;87Rb-87Sr age determination: Isochron&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-RBSR-MA&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;87Rb-87Sr age determination: Model age&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-REOS&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;187Re-187Os age determination&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-REOS-I&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;187Re-187Os age determination: Isochron&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-REOS-MA&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;187Re-187Os age determination: Model age&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-REOS-PT&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;187Re-187Os age determination: Pt normalization of 186Os&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-SCLERO&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Screlochronology&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-SHRIMP&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;SHRIMP age dating&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-SMND&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;147Sm-143Nd age determination&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-SMND-I&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;147Sm-143Nd age determination: Isochron&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-SMND-MA&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;147Sm-143Nd age determination: Model age&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-THPB&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;232Th-208Pb age determination&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-THPB-I&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;232Th-208Pb age determination: Isochron&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-THPB-MA&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;232Th-208Pb age determination: Model age&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-UPA&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;235U-231Pa age determination&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-UPB&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;U-Pb age determination&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-UPB-CC-T0&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;U-Pb age determination: Concordia diagram age, upper intersection&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-UPB-CC-T1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;U-Pb age determination: Concordia diagram age, lower intersection&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-UPB-I-206&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;U-Pb age determination: 238U-206Pb isochron&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-UPB-I-207&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;U-Pb age determination: 235U-207Pb isochron&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-UPB-MA-206&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;U-Pb age determination: 238U-206Pb model age&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-UPB-MA-207&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;U-Pb age determination: 235U-207Pb model age&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-USD&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Uranium series disequilibrium age determination&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-USD-PA231-TH230&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Uranium series disequilibrium age determination: 231Pa-230Th&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-USD-PA231-U235&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Uranium series disequilibrium age determination: 231Pa-235U&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-USD-PB210&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Uranium series disequilibrium age determination: 210Pb&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-USD-RA226-TH230&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Uranium series disequilibrium age determination: 226Ra-230Th&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-USD-RA228-TH232&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Uranium series disequilibrium age determination: 228Ra-232Th&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-USD-TH228-TH232&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Uranium series disequilibrium age determination: 228Th-232Th&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-USD-TH230&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Uranium series disequilibrium age determination: 230Th&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-USD-TH230-TH232&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Uranium series disequilibrium age determination: 230Th-232Th&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-USD-TH230-U234&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Uranium series disequilibrium age determination: 230Th-234U&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-USD-TH230-U238&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Uranium series disequilibrium age determination: 230Th-238U&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-USD-U234-U238&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Uranium series disequilibrium age determination: 234U-238U&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-UTH&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;238U-230Th age determination&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-UTHHE&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;U-Th-He age determination&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-UTHPB&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;U-Th-Pb age determination&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-UTHPB-CC-T0&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;U-Th-Pb age determination: Concordia diagram intersection age, upper intercept&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-UTHPB-CC-T1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;U-Th-Pb age determination: Concordia diagram intersection age, lower intercept&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;GM-VARVE&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Age determined by varve counting&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;tiepoint_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Name for tiepoint horizon&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;tiepoint_alternatives&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Colon-delimited list of alternative names and abbreviations&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;tiepoint_height&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Tiepoint stratigraphic height relative to reference tiepoint&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;tiepoint_height_sigma&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Tiepoint stratigraphic height uncertainty&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;tiepoint_elevation&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Tiepoint elevation relative to sealevel&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;tiepoint_type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Tiepoint type&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;age&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Age&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;age_sigma&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Age -- uncertainty&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;age_range_low&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Age -- low range&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;age_range_high&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Age -- high range&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;age_unit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Age -- unit&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;timescale_eon&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Timescale eon&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;timescale_era&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Timescale era&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;timescale_period&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Timescale period&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;timescale_epoch&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Timescale epoch&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;timescale_stage&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Timescale stage&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;biostrat_zone&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Biostratigraphic zone&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;conodont_zone&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Conodont zone&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;magnetic_reversal_chron&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Magnetic reversal chron&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;astronomical_stage&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Astronomical stage name&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;oxygen_stage&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Oxygen stage name&quot;</span>
    <span class="n">helpme</span><span class="p">[</span><span class="s2">&quot;age_culture_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Age culture name&quot;</span>
    <span class="k">return</span> <span class="n">helpme</span><span class="p">[</span><span class="n">keyhelp</span><span class="p">]</span></div>


<div class="viewcode-block" id="dosundec"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.dosundec">[docs]</a><span class="k">def</span> <span class="nf">dosundec</span><span class="p">(</span><span class="n">sundata</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the declination for a given set of suncompass data.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    sundata : dictionary with these keys:</span>
<span class="sd">        date: time string with the format &#39;yyyy:mm:dd:hr:min&#39;</span>
<span class="sd">        delta_u: time to SUBTRACT from local time for Universal time</span>
<span class="sd">        lat: latitude of location (negative for south)</span>
<span class="sd">        lon: longitude of location (negative for west)</span>
<span class="sd">        shadow_angle: shadow angle of the desired direction with respect to the sun.</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    sunaz : the declination of the desired direction with respect to true north</span>
<span class="sd">    </span>
<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; sundata={&#39;date&#39;:&#39;1994:05:23:16:9&#39;,&#39;delta_u&#39;:3,&#39;lat&#39;:35,&#39;lon&#39;:33,&#39;shadow_angle&#39;:68}</span>
<span class="sd">    &gt;&gt;&gt; pmag.dosundec(sundata)</span>
<span class="sd">    154.24420046668928</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">iday</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">timedate</span> <span class="o">=</span> <span class="n">sundata</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">]</span>
    <span class="n">timedate</span> <span class="o">=</span> <span class="n">timedate</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
    <span class="n">year</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">timedate</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">mon</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">timedate</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">day</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">timedate</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">hours</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">timedate</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
    <span class="nb">min</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">timedate</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
    <span class="n">du</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sundata</span><span class="p">[</span><span class="s2">&quot;delta_u&quot;</span><span class="p">])</span>
    <span class="n">hrs</span> <span class="o">=</span> <span class="n">hours</span> <span class="o">-</span> <span class="n">du</span>
    <span class="k">if</span> <span class="n">hrs</span> <span class="o">&gt;</span> <span class="mi">24</span><span class="p">:</span>
        <span class="n">day</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">hrs</span> <span class="o">=</span> <span class="n">hrs</span> <span class="o">-</span> <span class="mi">24</span>
    <span class="k">if</span> <span class="n">hrs</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">day</span> <span class="o">=</span> <span class="n">day</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">hrs</span> <span class="o">=</span> <span class="n">hrs</span> <span class="o">+</span> <span class="mi">24</span>
    <span class="n">julian_day</span> <span class="o">=</span> <span class="n">julian</span><span class="p">(</span><span class="n">mon</span><span class="p">,</span> <span class="n">day</span><span class="p">,</span> <span class="n">year</span><span class="p">)</span>
    <span class="n">utd</span> <span class="o">=</span> <span class="n">old_div</span><span class="p">((</span><span class="n">hrs</span> <span class="o">+</span> <span class="n">old_div</span><span class="p">(</span><span class="nb">min</span><span class="p">,</span> <span class="mf">60.</span><span class="p">)),</span> <span class="mf">24.</span><span class="p">)</span>
    <span class="n">greenwich_hour_angle</span><span class="p">,</span> <span class="n">delta</span> <span class="o">=</span> <span class="n">gha</span><span class="p">(</span><span class="n">julian_day</span><span class="p">,</span> <span class="n">utd</span><span class="p">)</span>
    <span class="n">H</span> <span class="o">=</span> <span class="n">greenwich_hour_angle</span> <span class="o">+</span> <span class="nb">float</span><span class="p">(</span><span class="n">sundata</span><span class="p">[</span><span class="s2">&quot;lon&quot;</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">H</span> <span class="o">&gt;</span> <span class="mi">360</span><span class="p">:</span>
        <span class="n">H</span> <span class="o">=</span> <span class="n">H</span> <span class="o">-</span> <span class="mi">360</span>
    <span class="n">lat</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">sundata</span><span class="p">[</span><span class="s2">&quot;lat&quot;</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">H</span> <span class="o">&gt;</span> <span class="mi">90</span> <span class="ow">and</span> <span class="n">H</span> <span class="o">&lt;</span> <span class="mi">270</span><span class="p">:</span>
        <span class="n">lat</span> <span class="o">=</span> <span class="o">-</span><span class="n">lat</span>
<span class="c1"># now do spherical trig to get azimuth to sun</span>
    <span class="n">lat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">lat</span><span class="p">)</span>
    <span class="n">delta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">delta</span><span class="p">)</span>
    <span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
    <span class="n">ctheta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">lat</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">delta</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">lat</span><span class="p">)</span> <span class="o">*</span> \
        <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">delta</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">ctheta</span><span class="p">)</span>
    <span class="n">beta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">delta</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">H</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
<span class="c1">#</span>
<span class="c1">#       check which beta</span>
<span class="c1">#</span>
    <span class="n">beta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="n">beta</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">delta</span> <span class="o">&lt;</span> <span class="n">lat</span><span class="p">:</span>
        <span class="n">beta</span> <span class="o">=</span> <span class="mi">180</span> <span class="o">-</span> <span class="n">beta</span>
    <span class="n">sunaz</span> <span class="o">=</span> <span class="mi">180</span> <span class="o">-</span> <span class="n">beta</span>
    <span class="n">sunaz</span> <span class="o">=</span> <span class="p">(</span><span class="n">sunaz</span> <span class="o">+</span> <span class="nb">float</span><span class="p">(</span><span class="n">sundata</span><span class="p">[</span><span class="s2">&quot;shadow_angle&quot;</span><span class="p">]))</span> <span class="o">%</span> <span class="mf">360.</span>  <span class="c1"># mod 360</span>
    <span class="k">return</span> <span class="n">sunaz</span></div>


<div class="viewcode-block" id="gha"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.gha">[docs]</a><span class="k">def</span> <span class="nf">gha</span><span class="p">(</span><span class="n">julian_day</span><span class="p">,</span> <span class="n">f</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns greenwich hour angle.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    julian_day : int, julian day</span>
<span class="sd">    f : int </span>
<span class="sd">        fraction of the day in Universal Time, (hrs + (min/60))/24</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    H: int, hour</span>
<span class="sd">    delta: int, angle</span>
<span class="sd">    </span>
<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; julianday = pmag.julian(10,20,2000)</span>
<span class="sd">    &gt;&gt;&gt; pmag.gha(julianday, 33)</span>
<span class="sd">    (183.440612472039, -20.255315389871825)</span>
<span class="sd">    &gt;&gt;&gt; pmag.gha(2451838, 33)</span>
<span class="sd">    (183.440612472039, -20.255315389871825)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">julian_day</span> <span class="o">-</span> <span class="mf">2451545.0</span> <span class="o">+</span> <span class="n">f</span>
    <span class="n">L</span> <span class="o">=</span> <span class="mf">280.460</span> <span class="o">+</span> <span class="mf">0.9856474</span> <span class="o">*</span> <span class="n">d</span>
    <span class="n">g</span> <span class="o">=</span> <span class="mf">357.528</span> <span class="o">+</span> <span class="mf">0.9856003</span> <span class="o">*</span> <span class="n">d</span>
    <span class="n">L</span> <span class="o">=</span> <span class="n">L</span> <span class="o">%</span> <span class="mf">360.</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">g</span> <span class="o">%</span> <span class="mf">360.</span>
<span class="c1"># ecliptic longitude</span>
    <span class="n">lamb</span> <span class="o">=</span> <span class="n">L</span> <span class="o">+</span> <span class="mf">1.915</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">g</span> <span class="o">*</span> <span class="n">rad</span><span class="p">)</span> <span class="o">+</span> <span class="mf">.02</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">g</span> <span class="o">*</span> <span class="n">rad</span><span class="p">)</span>
<span class="c1"># obliquity of ecliptic</span>
    <span class="n">epsilon</span> <span class="o">=</span> <span class="mf">23.439</span> <span class="o">-</span> <span class="mf">0.0000004</span> <span class="o">*</span> <span class="n">d</span>
<span class="c1"># right ascension (in same quadrant as lambda)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">old_div</span><span class="p">((</span><span class="n">epsilon</span> <span class="o">*</span> <span class="n">rad</span><span class="p">),</span> <span class="mi">2</span><span class="p">)))</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">old_div</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">rad</span><span class="p">)</span>
    <span class="n">rl</span> <span class="o">=</span> <span class="n">lamb</span> <span class="o">*</span> <span class="n">rad</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="n">lamb</span> <span class="o">-</span> <span class="n">r</span> <span class="o">*</span> <span class="n">t</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">rl</span><span class="p">)</span> <span class="o">+</span> \
        <span class="p">(</span><span class="n">old_div</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="o">*</span> <span class="n">t</span> <span class="o">*</span> <span class="n">t</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">rl</span><span class="p">)</span>
<span class="c1">#       alpha=mod(alpha,360.0)</span>
<span class="c1"># declination</span>
    <span class="n">delta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">epsilon</span> <span class="o">*</span> <span class="n">rad</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">lamb</span> <span class="o">*</span> <span class="n">rad</span><span class="p">)</span>
    <span class="n">delta</span> <span class="o">=</span> <span class="n">old_div</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="n">delta</span><span class="p">),</span> <span class="n">rad</span><span class="p">)</span>
<span class="c1"># equation of time</span>
    <span class="n">eqt</span> <span class="o">=</span> <span class="p">(</span><span class="n">L</span> <span class="o">-</span> <span class="n">alpha</span><span class="p">)</span>
<span class="c1">#</span>
    <span class="n">utm</span> <span class="o">=</span> <span class="n">f</span> <span class="o">*</span> <span class="mi">24</span> <span class="o">*</span> <span class="mi">60</span>
    <span class="n">H</span> <span class="o">=</span> <span class="n">old_div</span><span class="p">(</span><span class="n">utm</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">eqt</span> <span class="o">+</span> <span class="mi">180</span>
    <span class="n">H</span> <span class="o">=</span> <span class="n">H</span> <span class="o">%</span> <span class="mf">360.0</span>
    <span class="k">return</span> <span class="n">H</span><span class="p">,</span> <span class="n">delta</span></div>


<div class="viewcode-block" id="julian"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.julian">[docs]</a><span class="k">def</span> <span class="nf">julian</span><span class="p">(</span><span class="n">mon</span><span class="p">,</span> <span class="n">day</span><span class="p">,</span> <span class="n">year</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns julian day.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mon : int, month</span>
<span class="sd">    day : int, day</span>
<span class="sd">    year : int, year</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    julian_day : Julian day as a flt</span>
<span class="sd">    </span>
<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; pmag.julian(10,20,2000)</span>
<span class="sd">    2451838</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ig</span> <span class="o">=</span> <span class="mi">15</span> <span class="o">+</span> <span class="mi">31</span> <span class="o">*</span> <span class="p">(</span><span class="mi">10</span> <span class="o">+</span> <span class="mi">12</span> <span class="o">*</span> <span class="mi">1582</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">year</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Julian no can do&quot;</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="k">if</span> <span class="n">year</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">year</span> <span class="o">=</span> <span class="n">year</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">mon</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">julian_year</span> <span class="o">=</span> <span class="n">year</span>
        <span class="n">julian_month</span> <span class="o">=</span> <span class="n">mon</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">julian_year</span> <span class="o">=</span> <span class="n">year</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">julian_month</span> <span class="o">=</span> <span class="n">mon</span> <span class="o">+</span> <span class="mi">13</span>
    <span class="n">j1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">365.25</span> <span class="o">*</span> <span class="n">julian_year</span><span class="p">)</span>
    <span class="n">j2</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">30.6001</span> <span class="o">*</span> <span class="n">julian_month</span><span class="p">)</span>
    <span class="n">j3</span> <span class="o">=</span> <span class="n">day</span> <span class="o">+</span> <span class="mi">1720995</span>
    <span class="n">julian_day</span> <span class="o">=</span> <span class="n">j1</span> <span class="o">+</span> <span class="n">j2</span> <span class="o">+</span> <span class="n">j3</span>
    <span class="k">if</span> <span class="n">day</span> <span class="o">+</span> <span class="mi">31</span> <span class="o">*</span> <span class="p">(</span><span class="n">mon</span> <span class="o">+</span> <span class="mi">12</span> <span class="o">*</span> <span class="n">year</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">ig</span><span class="p">:</span>
        <span class="n">jadj</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">0.01</span> <span class="o">*</span> <span class="n">julian_year</span><span class="p">)</span>
        <span class="n">julian_day</span> <span class="o">=</span> <span class="n">julian_day</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">jadj</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="mf">0.25</span> <span class="o">*</span> <span class="n">jadj</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">julian_day</span></div>


<div class="viewcode-block" id="fillkeys"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.fillkeys">[docs]</a><span class="k">def</span> <span class="nf">fillkeys</span><span class="p">(</span><span class="n">Recs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Reconciles keys of dictionaries within Recs.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Recs : list of dictionaries in MagIC format OR pandas dataframe</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    input Recs </span>
<span class="sd">    keylist : list of keys found in Recs</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">keylist</span><span class="p">,</span> <span class="n">OutRecs</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">Recs</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">keylist</span><span class="p">:</span>
                <span class="n">keylist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">Recs</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keylist</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                <span class="n">rec</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">OutRecs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">OutRecs</span><span class="p">,</span> <span class="n">keylist</span></div>


<div class="viewcode-block" id="fisher_mean"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.fisher_mean">[docs]</a><span class="k">def</span> <span class="nf">fisher_mean</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the Fisher mean and associated parameter from a di_block.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : nested list of [dec,inc] or [dec,inc,intensity]</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fpars : dictionary containing the Fisher mean and statistics with keys</span>
<span class="sd">        dec : mean declination</span>
<span class="sd">        inc : mean inclination</span>
<span class="sd">        r : resultant vector length</span>
<span class="sd">        n : number of data points</span>
<span class="sd">        k : Fisher k value</span>
<span class="sd">        csd : Fisher circular standard deviation</span>
<span class="sd">        alpha95 : Fisher circle of 95% confidence</span>
<span class="sd">        </span>
<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; data = [[-45,150],[-40,150],[-38,145]]</span>
<span class="sd">    &gt;&gt;&gt; pmag.fisher_mean(data)</span>
<span class="sd">    {&#39;dec&#39;: 138.94545436727873,</span>
<span class="sd">     &#39;inc&#39;: 31.699974714611297,</span>
<span class="sd">     &#39;n&#39;: 3,</span>
<span class="sd">     &#39;r&#39;: 2.9946002939178036,</span>
<span class="sd">     &#39;k&#39;: 370.39053043910616,</span>
<span class="sd">     &#39;alpha95&#39;: 6.414731246264079,</span>
<span class="sd">     &#39;csd&#39;: 4.20876891770567}    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">N</span><span class="p">,</span> <span class="n">fpars</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="p">{}</span>
    
    <span class="k">if</span> <span class="n">N</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span> 
        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;dec&#39;</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> 
                <span class="s1">&#39;inc&#39;</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]}</span>
    
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dir2cart</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
    <span class="n">Xbar</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">Xbar</span><span class="p">)</span>
    <span class="n">Xbar</span> <span class="o">=</span> <span class="n">Xbar</span><span class="o">/</span><span class="n">R</span>
    <span class="nb">dir</span> <span class="o">=</span> <span class="n">cart2dir</span><span class="p">(</span><span class="n">Xbar</span><span class="p">)</span>

    <span class="n">fpars</span><span class="p">[</span><span class="s2">&quot;dec&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dir</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">fpars</span><span class="p">[</span><span class="s2">&quot;inc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dir</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">fpars</span><span class="p">[</span><span class="s2">&quot;n&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">N</span>
    <span class="n">fpars</span><span class="p">[</span><span class="s2">&quot;r&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">R</span>
    
    <span class="k">if</span> <span class="n">N</span> <span class="o">!=</span> <span class="n">R</span><span class="p">:</span>
        <span class="n">k</span> <span class="o">=</span> <span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="n">R</span><span class="p">)</span>
        <span class="n">fpars</span><span class="p">[</span><span class="s2">&quot;k&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">k</span>
        <span class="n">csd</span> <span class="o">=</span> <span class="mf">81.</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">fpars</span><span class="p">[</span><span class="s1">&#39;k&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;inf&#39;</span>
        <span class="n">csd</span> <span class="o">=</span> <span class="mf">0.</span>
    <span class="n">b</span> <span class="o">=</span> <span class="mf">20.</span><span class="o">**</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">b</span> <span class="o">*</span> <span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="n">R</span><span class="p">)</span> <span class="o">/</span> <span class="n">R</span>
    <span class="k">if</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">a95</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
    <span class="n">fpars</span><span class="p">[</span><span class="s2">&quot;alpha95&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">a95</span>
    <span class="n">fpars</span><span class="p">[</span><span class="s2">&quot;csd&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">csd</span>
    <span class="k">if</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">fpars</span><span class="p">[</span><span class="s2">&quot;alpha95&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">180.0</span>
    <span class="k">return</span> <span class="n">fpars</span></div>


<div class="viewcode-block" id="gausspars"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.gausspars">[docs]</a><span class="k">def</span> <span class="nf">gausspars</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates gaussian statistics for data. </span>
<span class="sd">    </span>
<span class="sd">    Parmeters</span>
<span class="sd">    ---------</span>
<span class="sd">    data : array of data </span>
<span class="sd">    </span>
<span class="sd">    Returns </span>
<span class="sd">    -------</span>
<span class="sd">    mean : array the length of the data array  </span>
<span class="sd">    stdev : second array the length of the data array</span>
<span class="sd">    </span>
<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; data=np.loadtxt(&#39;data_files/vector_mean/vector_mean_example.dat&#39;)</span>
<span class="sd">    &gt;&gt;&gt; pmag.gausspars(data)</span>
<span class="sd">    (array([  154.72699999999995,    44.43599999999999, 23709.242399999992  ]),</span>
<span class="sd">     array([  166.93766686153165 ,    19.578257988354988,</span>
<span class="sd">        11563.604723319804   ]))</span>
<span class="sd">          </span>
<span class="sd">    &gt;&gt;&gt; data = np.array([  [16.0,    43.0, 21620.33],</span>
<span class="sd">           [30.5,    53.6, 12922.58],</span>
<span class="sd">            [6.9,    33.2, 15780.08],</span>
<span class="sd">          [352.5,    40.2, 33947.52], </span>
<span class="sd">          [354.2,    45.1, 19725.45]])</span>
<span class="sd">    &gt;&gt;&gt; pmag.gausspars(data)</span>
<span class="sd">    (array([  152.02, 43.019999999999996, 20799.192]),</span>
<span class="sd">     array([1.839818931308187e+02, 7.427112494098901e+00, 8.092252785230450e+03]))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">N</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span>
    <span class="k">if</span> <span class="n">N</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span>
    <span class="k">if</span> <span class="n">N</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="n">mean</span> <span class="o">+=</span> <span class="n">old_div</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="nb">float</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="n">d</span> <span class="o">+=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">mean</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">stdev</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">d</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))))</span>
    <span class="k">return</span> <span class="n">mean</span><span class="p">,</span> <span class="n">stdev</span></div>


<div class="viewcode-block" id="calculate_k"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.calculate_k">[docs]</a><span class="k">def</span> <span class="nf">calculate_k</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">N</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the the Fisher concentration parameter (k) based on the number of</span>
<span class="sd">    vectors and the resultant vector length. This calculation occurs within the</span>
<span class="sd">    fisher_mean() function. Use of this function can be helpful when R and N</span>
<span class="sd">    are available, but the vectors themselves are not.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    R : Resultant vector length</span>
<span class="sd">    N : Number of vectors</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    k : Fisher concentration parameter</span>
<span class="sd">    </span>
<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; n,r = 3, 4.335</span>
<span class="sd">    &gt;&gt;&gt; pmag.calculate_k(r,n)</span>
<span class="sd">    -1.4981273408</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">N</span> <span class="o">!=</span> <span class="n">R</span><span class="p">:</span>
        <span class="n">k</span> <span class="o">=</span> <span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="n">R</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">k</span> <span class="o">=</span> <span class="s1">&#39;inf&#39;</span>
    <span class="k">return</span> <span class="n">k</span></div>


<div class="viewcode-block" id="calculate_r"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.calculate_r">[docs]</a><span class="k">def</span> <span class="nf">calculate_r</span><span class="p">(</span><span class="n">alpha95</span><span class="p">,</span><span class="n">N</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the resultant vector length (R) based on the number of vectors</span>
<span class="sd">    and provided Fisher alpha95. Doing so can be useful for conducting</span>
<span class="sd">    statistical tests that require R when it is not provided.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    alpha95 : Fisher alpha_95 value</span>
<span class="sd">    N : number of vectors</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    R : resultant vector length</span>
<span class="sd">    </span>
<span class="sd">    Examples </span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; alpha95, N = 6.41, 3</span>
<span class="sd">    &gt;&gt;&gt; pmag.calculate_r(alpha95,N)</span>
<span class="sd">    2.994608233588127</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">R</span> <span class="o">=</span> <span class="p">((</span><span class="mi">20</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">N</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="mi">20</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)))</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">alpha95</span><span class="p">)))</span>
    <span class="k">return</span> <span class="n">R</span></div>


<div class="viewcode-block" id="weighted_mean"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.weighted_mean">[docs]</a><span class="k">def</span> <span class="nf">weighted_mean</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the weighted mean of data.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : array of data </span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    mean : mean of the data as a float</span>
<span class="sd">    stdev : standard deviation of the data as a float</span>
<span class="sd">    </span>
<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; data = np.array([  [16.0,    43.0, 33],</span>
<span class="sd">           [30.5,    53.6, 58],</span>
<span class="sd">            [6.9,    33.2, 8],</span>
<span class="sd">          [352.5,    40.2, 52], </span>
<span class="sd">          [354.2,    45.1, 45]])</span>
<span class="sd">    &gt;&gt;&gt; pmag.weighted_mean(data)</span>
<span class="sd">    (152.00743840074387, 81.7174866362813)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">W</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">N</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span>
    <span class="k">if</span> <span class="n">N</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="n">W</span> <span class="o">+=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># sum of the weights</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="n">mean</span> <span class="o">+=</span> <span class="n">old_div</span><span class="p">((</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])),</span> <span class="nb">float</span><span class="p">(</span><span class="n">W</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">+=</span> <span class="p">(</span><span class="n">old_div</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">W</span><span class="p">)))</span> <span class="o">*</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="n">mean</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">stdev</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">d</span> <span class="o">*</span> <span class="p">(</span><span class="n">old_div</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)))))</span>
    <span class="k">return</span> <span class="n">mean</span><span class="p">,</span> <span class="n">stdev</span></div>


<span class="k">def</span> <span class="nf">lnpbykey</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">key0</span><span class="p">,</span> <span class="n">key1</span><span class="p">):</span>  <span class="c1"># calculate a fisher mean of key1 data for a group of key0</span>
    <span class="n">PmagRec</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="n">rec</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="n">key1</span> <span class="o">+</span> <span class="s1">&#39;_dec&#39;</span><span class="p">])</span>
            <span class="n">rec</span><span class="p">[</span><span class="s1">&#39;inc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="n">key1</span> <span class="o">+</span> <span class="s1">&#39;_inc&#39;</span><span class="p">])</span>
        <span class="n">fpars</span> <span class="o">=</span> <span class="n">dolnp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">key1</span> <span class="o">+</span> <span class="s1">&#39;_direction_type&#39;</span><span class="p">)</span>
        <span class="n">PmagRec</span><span class="p">[</span><span class="n">key0</span> <span class="o">+</span> <span class="s2">&quot;_dec&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fpars</span><span class="p">[</span><span class="s2">&quot;dec&quot;</span><span class="p">]</span>
        <span class="n">PmagRec</span><span class="p">[</span><span class="n">key0</span> <span class="o">+</span> <span class="s2">&quot;_inc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fpars</span><span class="p">[</span><span class="s2">&quot;inc&quot;</span><span class="p">]</span>
        <span class="n">PmagRec</span><span class="p">[</span><span class="n">key0</span> <span class="o">+</span> <span class="s2">&quot;_n&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">fpars</span><span class="p">[</span><span class="s2">&quot;n_total&quot;</span><span class="p">])</span>
        <span class="n">PmagRec</span><span class="p">[</span><span class="n">key0</span> <span class="o">+</span> <span class="s2">&quot;_n_lines&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fpars</span><span class="p">[</span><span class="s2">&quot;n_lines&quot;</span><span class="p">]</span>
        <span class="n">PmagRec</span><span class="p">[</span><span class="n">key0</span> <span class="o">+</span> <span class="s2">&quot;_n_planes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fpars</span><span class="p">[</span><span class="s2">&quot;n_planes&quot;</span><span class="p">]</span>
        <span class="n">PmagRec</span><span class="p">[</span><span class="n">key0</span> <span class="o">+</span> <span class="s2">&quot;_r&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fpars</span><span class="p">[</span><span class="s2">&quot;R&quot;</span><span class="p">]</span>
        <span class="n">PmagRec</span><span class="p">[</span><span class="n">key0</span> <span class="o">+</span> <span class="s2">&quot;_k&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fpars</span><span class="p">[</span><span class="s2">&quot;K&quot;</span><span class="p">]</span>
        <span class="n">PmagRec</span><span class="p">[</span><span class="n">key0</span> <span class="o">+</span> <span class="s2">&quot;_alpha95&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fpars</span><span class="p">[</span><span class="s2">&quot;alpha95&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">PmagRec</span><span class="p">[</span><span class="n">key0</span> <span class="o">+</span> <span class="s2">&quot;_n_planes&quot;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">PmagRec</span><span class="p">[</span><span class="s2">&quot;magic_method_codes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;DE-FM-LP&quot;</span>
        <span class="k">elif</span> <span class="nb">int</span><span class="p">(</span><span class="n">PmagRec</span><span class="p">[</span><span class="n">key0</span> <span class="o">+</span> <span class="s2">&quot;_n_lines&quot;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">PmagRec</span><span class="p">[</span><span class="s2">&quot;magic_method_codes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;DE-FM&quot;</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">PmagRec</span><span class="p">[</span><span class="n">key0</span> <span class="o">+</span> <span class="s2">&quot;_dec&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">key1</span> <span class="o">+</span> <span class="s1">&#39;_dec&#39;</span><span class="p">]</span>
        <span class="n">PmagRec</span><span class="p">[</span><span class="n">key0</span> <span class="o">+</span> <span class="s2">&quot;_inc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">key1</span> <span class="o">+</span> <span class="s1">&#39;_inc&#39;</span><span class="p">]</span>
        <span class="n">PmagRec</span><span class="p">[</span><span class="n">key0</span> <span class="o">+</span> <span class="s2">&quot;_n&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span>
        <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">key1</span> <span class="o">+</span> <span class="s1">&#39;_direction_type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;l&#39;</span><span class="p">:</span>
            <span class="n">PmagRec</span><span class="p">[</span><span class="n">key0</span> <span class="o">+</span> <span class="s2">&quot;_n_lines&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span>
            <span class="n">PmagRec</span><span class="p">[</span><span class="n">key0</span> <span class="o">+</span> <span class="s2">&quot;_n_planes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span>
        <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">key1</span> <span class="o">+</span> <span class="s1">&#39;_direction_type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;p&#39;</span><span class="p">:</span>
            <span class="n">PmagRec</span><span class="p">[</span><span class="n">key0</span> <span class="o">+</span> <span class="s2">&quot;_n_planes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span>
            <span class="n">PmagRec</span><span class="p">[</span><span class="n">key0</span> <span class="o">+</span> <span class="s2">&quot;_n_lines&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span>
        <span class="n">PmagRec</span><span class="p">[</span><span class="n">key0</span> <span class="o">+</span> <span class="s2">&quot;_alpha95&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">PmagRec</span><span class="p">[</span><span class="n">key0</span> <span class="o">+</span> <span class="s2">&quot;_r&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">PmagRec</span><span class="p">[</span><span class="n">key0</span> <span class="o">+</span> <span class="s2">&quot;_k&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">PmagRec</span><span class="p">[</span><span class="n">key0</span> <span class="o">+</span> <span class="s2">&quot;_direction_type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;l&quot;</span>
    <span class="k">return</span> <span class="n">PmagRec</span>


<div class="viewcode-block" id="fisher_by_pol"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.fisher_by_pol">[docs]</a><span class="k">def</span> <span class="nf">fisher_by_pol</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Do fisher mean after splitting data into two polarity domains.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data: list of dictionaries with &#39;dec&#39; and &#39;inc&#39;</span>
<span class="sd">    </span>
<span class="sd">    Returns </span>
<span class="sd">    -------</span>
<span class="sd">    three dictionaries:</span>
<span class="sd">        &#39;A&#39;= polarity &#39;A&#39;</span>
<span class="sd">        &#39;B = polarity &#39;B&#39;</span>
<span class="sd">        &#39;ALL&#39;= switching polarity of &#39;B&#39; directions, and calculate fisher mean of all data</span>
<span class="sd">        </span>
<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; data = [{&#39;dec&#39;:-45,&#39;inc&#39;:150}, {&#39;dec&#39;:-44,&#39;inc&#39;:150},{&#39;dec&#39;:-45.3,&#39;inc&#39;:149}]</span>
<span class="sd">    &gt;&gt;&gt; pmag.fisher_by_pol(data)</span>
<span class="sd">    {&#39;B&#39;: {&#39;dec&#39;: 135.23515314555496,</span>
<span class="sd">      &#39;inc&#39;: 30.334504880687444,</span>
<span class="sd">      &#39;n&#39;: 3,</span>
<span class="sd">      &#39;r&#39;: 2.9997932987279383,</span>
<span class="sd">      &#39;k&#39;: 9675.799186195498,</span>
<span class="sd">      &#39;alpha95&#39;: 1.2533447889568254,</span>
<span class="sd">      &#39;csd&#39;: 0.8234582703442529,</span>
<span class="sd">      &#39;sites&#39;: &#39;&#39;,</span>
<span class="sd">      &#39;locs&#39;: &#39;&#39;},</span>
<span class="sd">     &#39;All&#39;: {&#39;dec&#39;: 315.23515314555493,</span>
<span class="sd">      &#39;inc&#39;: -30.334504880687444,</span>
<span class="sd">      &#39;n&#39;: 3,</span>
<span class="sd">      &#39;r&#39;: 2.999793298727938,</span>
<span class="sd">      &#39;k&#39;: 9675.79918617471,</span>
<span class="sd">      &#39;alpha95&#39;: 1.2533447889582796,</span>
<span class="sd">      &#39;csd&#39;: 0.8234582703451375,</span>
<span class="sd">      &#39;sites&#39;: &#39;&#39;,</span>
<span class="sd">      &#39;locs&#39;: &#39;&#39;}}</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># code modified from eqarea_ell.py b rshaar 1/23/2014</span>
    <span class="n">FisherByPoles</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">DIblock</span><span class="p">,</span> <span class="n">nameblock</span><span class="p">,</span> <span class="n">locblock</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;dec&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="s1">&#39;inc&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="c1"># collect data for fisher calculation</span>
            <span class="n">DIblock</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;dec&quot;</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;inc&quot;</span><span class="p">])])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="s1">&#39;name&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="n">nameblock</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">nameblock</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;loc&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="n">locblock</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s1">&#39;loc&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">locblock</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="n">ppars</span> <span class="o">=</span> <span class="n">doprinc</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">DIblock</span><span class="p">))</span>  <span class="c1"># get principal directions</span>
    <span class="c1"># choose the northerly declination principe component (&quot;normal&quot;)</span>
    <span class="n">reference_DI</span> <span class="o">=</span> <span class="p">[</span><span class="n">ppars</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">],</span> <span class="n">ppars</span><span class="p">[</span><span class="s1">&#39;inc&#39;</span><span class="p">]]</span>
    <span class="c1"># make reference direction in northern hemisphere</span>
    <span class="k">if</span> <span class="n">reference_DI</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">90</span> <span class="ow">and</span> <span class="n">reference_DI</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">270</span><span class="p">:</span>
        <span class="n">reference_DI</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">reference_DI</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mf">180.</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span>
        <span class="n">reference_DI</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">reference_DI</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="o">-</span><span class="mf">1.</span>
    <span class="n">nDIs</span><span class="p">,</span> <span class="n">rDIs</span><span class="p">,</span> <span class="n">all_DI</span><span class="p">,</span> <span class="n">npars</span><span class="p">,</span> <span class="n">rpars</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">nlist</span><span class="p">,</span> <span class="n">rlist</span><span class="p">,</span> <span class="n">alllist</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span>
    <span class="n">nloclist</span><span class="p">,</span> <span class="n">rloclist</span><span class="p">,</span> <span class="n">allloclist</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">DIblock</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">angle</span><span class="p">([</span><span class="n">DIblock</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">DIblock</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">1</span><span class="p">]],</span> <span class="n">reference_DI</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">90.</span><span class="p">:</span>
            <span class="n">rDIs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DIblock</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
            <span class="n">rlist</span> <span class="o">=</span> <span class="n">rlist</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">nameblock</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">locblock</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">rloclist</span><span class="p">:</span>
                <span class="n">rloclist</span> <span class="o">=</span> <span class="n">rloclist</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">locblock</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="n">all_DI</span><span class="o">.</span><span class="n">append</span><span class="p">([(</span><span class="n">DIblock</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mf">180.</span><span class="p">)</span> <span class="o">%</span> <span class="mf">360.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span> <span class="o">*</span> <span class="n">DIblock</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">1</span><span class="p">]])</span>
            <span class="n">alllist</span> <span class="o">=</span> <span class="n">alllist</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">nameblock</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">locblock</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allloclist</span><span class="p">:</span>
                <span class="n">allloclist</span> <span class="o">=</span> <span class="n">allloclist</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">locblock</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">nDIs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DIblock</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
            <span class="n">nlist</span> <span class="o">=</span> <span class="n">nlist</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">nameblock</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">locblock</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">nloclist</span><span class="p">:</span>
                <span class="n">nloclist</span> <span class="o">=</span> <span class="n">nloclist</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">locblock</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="n">all_DI</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DIblock</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
            <span class="n">alllist</span> <span class="o">=</span> <span class="n">alllist</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">nameblock</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">locblock</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allloclist</span><span class="p">:</span>
                <span class="n">allloclist</span> <span class="o">=</span> <span class="n">allloclist</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">locblock</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">mode</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;All&#39;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;A&#39;</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">nDIs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">fpars</span> <span class="o">=</span> <span class="n">fisher_mean</span><span class="p">(</span><span class="n">nDIs</span><span class="p">)</span>
            <span class="n">fpars</span><span class="p">[</span><span class="s1">&#39;sites&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">nlist</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
            <span class="n">fpars</span><span class="p">[</span><span class="s1">&#39;locs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">nloclist</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
            <span class="n">FisherByPoles</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span> <span class="o">=</span> <span class="n">fpars</span>
        <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;B&#39;</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">rDIs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">fpars</span> <span class="o">=</span> <span class="n">fisher_mean</span><span class="p">(</span><span class="n">rDIs</span><span class="p">)</span>
            <span class="n">fpars</span><span class="p">[</span><span class="s1">&#39;sites&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rlist</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
            <span class="n">fpars</span><span class="p">[</span><span class="s1">&#39;locs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rloclist</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
            <span class="n">FisherByPoles</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span> <span class="o">=</span> <span class="n">fpars</span>
        <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;All&#39;</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_DI</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">fpars</span> <span class="o">=</span> <span class="n">fisher_mean</span><span class="p">(</span><span class="n">all_DI</span><span class="p">)</span>
            <span class="n">fpars</span><span class="p">[</span><span class="s1">&#39;sites&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alllist</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
            <span class="n">fpars</span><span class="p">[</span><span class="s1">&#39;locs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">allloclist</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
            <span class="n">FisherByPoles</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span> <span class="o">=</span> <span class="n">fpars</span>
    <span class="k">return</span> <span class="n">FisherByPoles</span></div>


<div class="viewcode-block" id="dolnp3_0"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.dolnp3_0">[docs]</a><span class="k">def</span> <span class="nf">dolnp3_0</span><span class="p">(</span><span class="n">Data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    DEPRECATED!!  USE dolnp()</span>
<span class="sd">    Description: takes a list of dicts with the controlled vocabulary of 3_0 and calls dolnp on them after reformating for compatibility.</span>
<span class="sd">    Parameters</span>
<span class="sd">    ---------------_</span>
<span class="sd">    Data : nested list of dictionaries with keys</span>
<span class="sd">        dir_dec</span>
<span class="sd">        dir_inc</span>
<span class="sd">        dir_tilt_correction</span>
<span class="sd">        method_codes</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">        ReturnData : dictionary with keys</span>
<span class="sd">            dec : fisher mean dec of data in Data</span>
<span class="sd">            inc : fisher mean inc of data in Data</span>
<span class="sd">            n_lines : number of directed lines [method_code = DE-BFL or DE-FM]</span>
<span class="sd">            n_planes : number of best fit planes [method_code = DE-BFP]</span>
<span class="sd">            alpha95  : fisher confidence circle from Data</span>
<span class="sd">            R : fisher R value of Data</span>
<span class="sd">            K : fisher k value of Data</span>
<span class="sd">    Effects</span>
<span class="sd">        prints to screen in case of no data</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">Data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;This function requires input Data have at least 1 entry&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">Data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">ReturnData</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">ReturnData</span><span class="p">[</span><span class="s2">&quot;dec&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;dir_dec&#39;</span><span class="p">]</span>
        <span class="n">ReturnData</span><span class="p">[</span><span class="s2">&quot;inc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;dir_inc&#39;</span><span class="p">]</span>
        <span class="n">ReturnData</span><span class="p">[</span><span class="s2">&quot;n_total&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span>
        <span class="k">if</span> <span class="s2">&quot;DE-BFP&quot;</span> <span class="ow">in</span> <span class="n">Data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;method_codes&#39;</span><span class="p">]:</span>
            <span class="n">ReturnData</span><span class="p">[</span><span class="s2">&quot;n_lines&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span>
            <span class="n">ReturnData</span><span class="p">[</span><span class="s2">&quot;n_planes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ReturnData</span><span class="p">[</span><span class="s2">&quot;n_planes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span>
            <span class="n">ReturnData</span><span class="p">[</span><span class="s2">&quot;n_lines&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span>
        <span class="n">ReturnData</span><span class="p">[</span><span class="s2">&quot;alpha95&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">ReturnData</span><span class="p">[</span><span class="s2">&quot;R&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">ReturnData</span><span class="p">[</span><span class="s2">&quot;K&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">return</span> <span class="n">ReturnData</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">LnpData</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">Data</span><span class="p">):</span>
            <span class="n">LnpData</span><span class="o">.</span><span class="n">append</span><span class="p">({})</span>
            <span class="n">LnpData</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s1">&#39;dec&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;dir_dec&#39;</span><span class="p">]</span>
            <span class="n">LnpData</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s1">&#39;inc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;dir_inc&#39;</span><span class="p">]</span>
            <span class="n">LnpData</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s1">&#39;tilt_correction&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;dir_tilt_correction&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="s1">&#39;method_codes&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                <span class="k">if</span> <span class="s2">&quot;DE-BFP&quot;</span> <span class="ow">in</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;method_codes&#39;</span><span class="p">]:</span>
                    <span class="n">LnpData</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s1">&#39;dir_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;p&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">LnpData</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s1">&#39;dir_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;l&#39;</span>
        <span class="c1"># get a sample average from all specimens</span>
        <span class="n">ReturnData</span> <span class="o">=</span> <span class="n">dolnp</span><span class="p">(</span><span class="n">LnpData</span><span class="p">,</span> <span class="s1">&#39;dir_type&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ReturnData</span></div>


<div class="viewcode-block" id="dolnp"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.dolnp">[docs]</a><span class="k">def</span> <span class="nf">dolnp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">direction_type_key</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns fisher mean, a95 for data using the method of McFadden and McElhinny 1988 for lines and planes.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Data : nested list of dictionaries with keys</span>
<span class="sd">        Data model 3.0:</span>
<span class="sd">            dir_dec</span>
<span class="sd">            dir_inc</span>
<span class="sd">            dir_tilt_correction</span>
<span class="sd">            method_codes</span>
<span class="sd">        Data model 2.5:</span>
<span class="sd">            dec</span>
<span class="sd">            inc</span>
<span class="sd">            tilt_correction</span>
<span class="sd">            magic_method_codes</span>
<span class="sd">    direction_type_key :  [&#39;specimen_direction_type&#39;]</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ReturnData : dictionary with keys</span>
<span class="sd">        dec : fisher mean dec of data in Data</span>
<span class="sd">        inc : fisher mean inc of data in Data</span>
<span class="sd">        n_lines : number of directed lines [method_code = DE-BFL or DE-FM]</span>
<span class="sd">        n_planes : number of best fit planes [method_code = DE-BFP]</span>
<span class="sd">        alpha95  : fisher confidence circle from Data</span>
<span class="sd">        R : fisher R value of Data</span>
<span class="sd">        K : fisher k value of Data</span>
<span class="sd">        </span>
<span class="sd">    Effects</span>
<span class="sd">    -------</span>
<span class="sd">    prints to screen in case of no data</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="s1">&#39;dir_dec&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">tilt_key</span> <span class="o">=</span> <span class="s1">&#39;dir_tilt_correction&#39;</span>  <span class="c1"># this is data model 3.0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">tilt_key</span> <span class="o">=</span> <span class="s1">&#39;tilt_correction&#39;</span>  <span class="c1"># this is data model 3.0</span>
    <span class="k">if</span> <span class="n">tilt_key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="n">tc</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">tilt_key</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">tc</span> <span class="o">=</span> <span class="s1">&#39;-1&#39;</span>
    <span class="n">dirV</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">fpars</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c1"># sort data  into lines and planes and collect cartesian coordinates</span>
    <span class="n">fdata</span><span class="p">,</span> <span class="n">n_lines</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">n_planes</span><span class="p">,</span> <span class="n">E</span> <span class="o">=</span> <span class="n">process_data_for_mean</span><span class="p">(</span>
        <span class="n">data</span><span class="p">,</span> <span class="n">direction_type_key</span><span class="p">)</span>
<span class="c1"># set up initial points on the great circles</span>
    <span class="n">V</span><span class="p">,</span> <span class="n">XV</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">n_planes</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">n_lines</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># set the initial direction arbitrarily</span>
            <span class="n">V</span> <span class="o">=</span> <span class="n">dir2cart</span><span class="p">([</span><span class="mf">180.</span><span class="p">,</span> <span class="o">-</span><span class="mf">45.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">E</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">E</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">E</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">E</span><span class="p">:</span>
                <span class="c1"># set initial direction as mean of lines</span>
                <span class="n">V</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">old_div</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">R</span><span class="p">))</span>
        <span class="n">XV</span> <span class="o">=</span> <span class="n">calculate_best_fit_vectors</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">n_planes</span><span class="p">)</span>
<span class="c1"># calculating overall mean direction and R</span>
        <span class="n">U</span> <span class="o">=</span> <span class="n">E</span><span class="p">[:]</span>
        <span class="k">for</span> <span class="nb">dir</span> <span class="ow">in</span> <span class="n">XV</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
                <span class="n">U</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">U</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">+</span> <span class="nb">dir</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
        <span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">U</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">U</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">U</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="n">U</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">old_div</span><span class="p">(</span><span class="n">U</span><span class="p">[</span><span class="n">c</span><span class="p">],</span> <span class="n">R</span><span class="p">)</span>
<span class="c1"># get dec and inc of solution points on gt circles</span>
        <span class="n">dirV</span> <span class="o">=</span> <span class="n">cart2dir</span><span class="p">(</span><span class="n">U</span><span class="p">)</span>
<span class="c1"># calculate modified Fisher stats fo fit</span>
        <span class="n">n_total</span> <span class="o">=</span> <span class="n">n_lines</span> <span class="o">+</span> <span class="n">n_planes</span>
        <span class="n">NP</span> <span class="o">=</span> <span class="n">n_lines</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">n_planes</span>
        <span class="k">if</span> <span class="n">NP</span> <span class="o">&lt;</span> <span class="mf">1.1</span><span class="p">:</span>
            <span class="n">NP</span> <span class="o">=</span> <span class="mf">1.1</span>
        <span class="k">if</span> <span class="n">n_total</span> <span class="o">-</span> <span class="n">R</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">K</span> <span class="o">=</span> <span class="n">old_div</span><span class="p">((</span><span class="n">NP</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">),</span> <span class="p">(</span><span class="n">n_total</span> <span class="o">-</span> <span class="n">R</span><span class="p">))</span>
            <span class="n">fac</span> <span class="o">=</span> <span class="p">(</span><span class="mf">20.</span><span class="o">**</span><span class="p">(</span><span class="n">old_div</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="p">(</span><span class="n">NP</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">)))</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">)</span>
            <span class="n">fac</span> <span class="o">=</span> <span class="n">fac</span> <span class="o">*</span> <span class="p">(</span><span class="n">NP</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">)</span> <span class="o">/</span> <span class="n">K</span>
            <span class="n">a</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">old_div</span><span class="p">(</span><span class="n">fac</span><span class="p">,</span> <span class="n">R</span><span class="p">)</span>
            <span class="n">a95</span> <span class="o">=</span> <span class="n">a</span>
            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.0</span><span class="p">:</span>
                <span class="n">a95</span> <span class="o">=</span> <span class="mf">1.</span>
            <span class="k">if</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">a95</span> <span class="o">=</span> <span class="o">-</span><span class="n">a95</span>
            <span class="n">a95</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">a95</span><span class="p">)</span> <span class="o">*</span> <span class="mf">180.</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">a95</span> <span class="o">=</span> <span class="mf">0.</span>
            <span class="n">K</span> <span class="o">=</span> <span class="s1">&#39;inf&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">fdir</span> <span class="o">=</span> <span class="n">fisher_mean</span><span class="p">(</span><span class="n">fdata</span><span class="p">)</span>
        <span class="n">n_total</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">a95</span> <span class="o">=</span> <span class="n">fdir</span><span class="p">[</span><span class="s2">&quot;n&quot;</span><span class="p">],</span> <span class="n">fdir</span><span class="p">[</span><span class="s2">&quot;r&quot;</span><span class="p">],</span> <span class="n">fdir</span><span class="p">[</span><span class="s2">&quot;k&quot;</span><span class="p">],</span> <span class="n">fdir</span><span class="p">[</span><span class="s2">&quot;alpha95&quot;</span><span class="p">]</span>
        <span class="n">dirV</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dirV</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">fdir</span><span class="p">[</span><span class="s2">&quot;dec&quot;</span><span class="p">],</span> <span class="n">fdir</span><span class="p">[</span><span class="s2">&quot;inc&quot;</span><span class="p">]</span>
    <span class="n">fpars</span><span class="p">[</span><span class="s2">&quot;tilt_correction&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tc</span>
    <span class="n">fpars</span><span class="p">[</span><span class="s2">&quot;n_total&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%i</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">n_total</span><span class="p">)</span>
    <span class="n">fpars</span><span class="p">[</span><span class="s2">&quot;n_lines&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%i</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">n_lines</span><span class="p">)</span>
    <span class="n">fpars</span><span class="p">[</span><span class="s2">&quot;n_planes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%i</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">n_planes</span><span class="p">)</span>
    <span class="n">fpars</span><span class="p">[</span><span class="s2">&quot;R&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%5.4f</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">R</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">K</span> <span class="o">!=</span> <span class="s1">&#39;inf&#39;</span><span class="p">:</span>
        <span class="n">fpars</span><span class="p">[</span><span class="s2">&quot;K&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%6.0f</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">K</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">fpars</span><span class="p">[</span><span class="s2">&quot;K&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">K</span>
    <span class="n">fpars</span><span class="p">[</span><span class="s2">&quot;alpha95&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%7.1f</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">a95</span><span class="p">)</span>
    <span class="n">fpars</span><span class="p">[</span><span class="s2">&quot;dec&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%7.1f</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">dirV</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">fpars</span><span class="p">[</span><span class="s2">&quot;inc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%7.1f</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">dirV</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">fpars</span></div>


<div class="viewcode-block" id="vclose"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.vclose">[docs]</a><span class="k">def</span> <span class="nf">vclose</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">V</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the closest vector.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lam</span><span class="p">,</span> <span class="n">X</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">lam</span> <span class="o">=</span> <span class="n">lam</span> <span class="o">+</span> <span class="n">V</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">L</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
    <span class="n">beta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">lam</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">old_div</span><span class="p">((</span><span class="n">V</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">lam</span> <span class="o">*</span> <span class="n">L</span><span class="p">[</span><span class="n">k</span><span class="p">]),</span> <span class="n">beta</span><span class="p">)))</span>
    <span class="k">return</span> <span class="n">X</span></div>


<div class="viewcode-block" id="calculate_best_fit_vectors"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.calculate_best_fit_vectors">[docs]</a><span class="k">def</span> <span class="nf">calculate_best_fit_vectors</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">n_planes</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the best fit vectors for a set of plane interpretations used in fisher mean calculations.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    L : a list of the &quot;EL, EM, EN&quot; array of MM88 or the cartisian form of dec and inc of the plane interpretation</span>
<span class="sd">    E : the sum of the cartisian coordinates of all the line fits to be used in the mean</span>
<span class="sd">    V : initial direction to start iterating from to get plane best fits</span>
<span class="sd">    n_planes : number of planes</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    XV : nested list of n_plane by 3 dimension where the 3 are the cartisian dimension of the best fit vector</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">U</span><span class="p">,</span> <span class="n">XV</span> <span class="o">=</span> <span class="n">E</span><span class="p">[:],</span> <span class="p">[]</span>  <span class="c1"># make a copy of E to prevent mutation</span>
    <span class="k">for</span> <span class="n">pole</span> <span class="ow">in</span> <span class="n">L</span><span class="p">:</span>
        <span class="n">XV</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vclose</span><span class="p">(</span><span class="n">pole</span><span class="p">,</span> <span class="n">V</span><span class="p">))</span>  <span class="c1"># get some points on the great circle</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="n">U</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">U</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">+</span> <span class="n">XV</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">c</span><span class="p">]</span>
<span class="c1"># iterate to find best agreement</span>
    <span class="n">angle_tol</span> <span class="o">=</span> <span class="mf">1.</span>
    <span class="k">while</span> <span class="n">angle_tol</span> <span class="o">&gt;</span> <span class="mf">0.1</span><span class="p">:</span>
        <span class="n">angles</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_planes</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
                <span class="n">U</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">U</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">-</span> <span class="n">XV</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">c</span><span class="p">]</span>
            <span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">U</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">U</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">U</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
                <span class="n">V</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">old_div</span><span class="p">(</span><span class="n">U</span><span class="p">[</span><span class="n">c</span><span class="p">],</span> <span class="n">R</span><span class="p">)</span>
            <span class="n">XX</span> <span class="o">=</span> <span class="n">vclose</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">V</span><span class="p">)</span>
            <span class="n">ang</span> <span class="o">=</span> <span class="n">XX</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">XV</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">XX</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">XV</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">XX</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">XV</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">angles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">ang</span><span class="p">)</span> <span class="o">*</span> <span class="mf">180.</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
                <span class="n">XV</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">XX</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
                <span class="n">U</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">U</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">+</span> <span class="n">XX</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
            <span class="n">amax</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="k">for</span> <span class="n">ang</span> <span class="ow">in</span> <span class="n">angles</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">ang</span> <span class="o">&gt;</span> <span class="n">amax</span><span class="p">:</span>
                    <span class="n">amax</span> <span class="o">=</span> <span class="n">ang</span>
            <span class="n">angle_tol</span> <span class="o">=</span> <span class="n">amax</span>

    <span class="k">return</span> <span class="n">XV</span></div>


<div class="viewcode-block" id="process_data_for_mean"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.process_data_for_mean">[docs]</a><span class="k">def</span> <span class="nf">process_data_for_mean</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">direction_type_key</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Takes a list of dicts with dec and inc as well as direction_type if possible or method_codes and sorts the data into lines and planes and process it for fisher means</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : list of dicts with dec inc and some manner of PCA type info</span>
<span class="sd">    direction_type_key : key that indicates the direction type variable in the dictionaries of data</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    tuple with values: list of lists with [dec, inc, 1.] for all lines</span>
<span class="sd">                       number of line</span>
<span class="sd">                       list of lists with [EL,EM,EN] of all planes</span>
<span class="sd">                       number of planes</span>
<span class="sd">                       list of sum of the cartezian components of all lines</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dec_key</span><span class="p">,</span> <span class="n">inc_key</span><span class="p">,</span> <span class="n">meth_key</span> <span class="o">=</span> <span class="s1">&#39;dec&#39;</span><span class="p">,</span> <span class="s1">&#39;inc&#39;</span><span class="p">,</span> <span class="s1">&#39;magic_method_codes&#39;</span>  <span class="c1"># data model 2.5</span>
    <span class="k">if</span> <span class="s1">&#39;dir_dec&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>  <span class="c1"># this is data model 3.0</span>
        <span class="n">dec_key</span><span class="p">,</span> <span class="n">inc_key</span><span class="p">,</span> <span class="n">meth_key</span> <span class="o">=</span> <span class="s1">&#39;dir_dec&#39;</span><span class="p">,</span> <span class="s1">&#39;dir_inc&#39;</span><span class="p">,</span> <span class="s1">&#39;method_codes&#39;</span>

    <span class="n">n_lines</span><span class="p">,</span> <span class="n">n_planes</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
    <span class="n">L</span><span class="p">,</span> <span class="n">fdata</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">E</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

    <span class="c1"># sort data  into lines and planes and collect cartesian coordinates</span>
    <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="n">cart</span> <span class="o">=</span> <span class="n">dir2cart</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="n">dec_key</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="n">inc_key</span><span class="p">])])[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">direction_type_key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="k">if</span> <span class="n">rec</span><span class="p">[</span><span class="n">direction_type_key</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;p&#39;</span><span class="p">:</span>  <span class="c1"># this is a pole to a plane</span>
                <span class="n">n_planes</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">L</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cart</span><span class="p">)</span>  <span class="c1"># this is the &quot;EL, EM, EN&quot; array of MM88</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1"># this is a line</span>
                <span class="n">n_lines</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="c1"># collect data for fisher calculation</span>
                <span class="n">fdata</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="n">dec_key</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="n">inc_key</span><span class="p">]),</span> <span class="mf">1.</span><span class="p">])</span>
                <span class="n">E</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">cart</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">E</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">cart</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">E</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+=</span> <span class="n">cart</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">elif</span> <span class="s1">&#39;method_codes&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="k">if</span> <span class="s2">&quot;DE-BFP&quot;</span> <span class="ow">in</span> <span class="n">rec</span><span class="p">[</span><span class="n">meth_key</span><span class="p">]:</span>  <span class="c1"># this is a pole to a plane</span>
                <span class="n">n_planes</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">L</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cart</span><span class="p">)</span>  <span class="c1"># this is the &quot;EL, EM, EN&quot; array of MM88</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1"># this is a line</span>
                <span class="n">n_lines</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="c1"># collect data for fisher calculation</span>
                <span class="n">fdata</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">rec</span><span class="p">[</span><span class="n">dec_key</span><span class="p">],</span> <span class="n">rec</span><span class="p">[</span><span class="n">inc_key</span><span class="p">],</span> <span class="mf">1.</span><span class="p">])</span>
                <span class="n">E</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">cart</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">E</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">cart</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">E</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+=</span> <span class="n">cart</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">meth_key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="k">if</span> <span class="s2">&quot;DE-BFP&quot;</span> <span class="ow">in</span> <span class="n">rec</span><span class="p">[</span><span class="n">meth_key</span><span class="p">]:</span>  <span class="c1"># this is a pole to a plane</span>
                <span class="n">n_planes</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">L</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cart</span><span class="p">)</span>  <span class="c1"># this is the &quot;EL, EM, EN&quot; array of MM88</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1"># this is a line</span>
                <span class="n">n_lines</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="c1"># collect data for fisher calculation</span>
                <span class="n">fdata</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">rec</span><span class="p">[</span><span class="n">dec_key</span><span class="p">],</span> <span class="n">rec</span><span class="p">[</span><span class="n">inc_key</span><span class="p">],</span> <span class="mf">1.</span><span class="p">])</span>
                <span class="n">E</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">cart</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">E</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">cart</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">E</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+=</span> <span class="n">cart</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
                <span class="c1"># EVERYTHING IS A LINE!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span>
            <span class="n">n_lines</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="c1"># collect data for fisher calculation</span>
            <span class="n">fdata</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">rec</span><span class="p">[</span><span class="n">dec_key</span><span class="p">],</span> <span class="n">rec</span><span class="p">[</span><span class="n">inc_key</span><span class="p">],</span> <span class="mf">1.</span><span class="p">])</span>
            <span class="n">E</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">cart</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">E</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">cart</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">E</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+=</span> <span class="n">cart</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">fdata</span><span class="p">,</span> <span class="n">n_lines</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">n_planes</span><span class="p">,</span> <span class="n">E</span></div>


<div class="viewcode-block" id="scoreit"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.scoreit">[docs]</a><span class="k">def</span> <span class="nf">scoreit</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">PmagSpecRec</span><span class="p">,</span> <span class="n">accept</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">verbose</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Depreciated 9/14/2022</span>
<span class="sd">    </span>
<span class="sd">    Gets a grade for a given set of data, spits out stuff.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">PmagSpecRec</span><span class="p">[</span><span class="s2">&quot;er_specimen_name&quot;</span><span class="p">]</span>
    <span class="n">PmagSpecRec</span><span class="p">[</span><span class="s2">&quot;measurement_step_min&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%8.3e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
        <span class="n">pars</span><span class="p">[</span><span class="s2">&quot;measurement_step_min&quot;</span><span class="p">])</span>
    <span class="n">PmagSpecRec</span><span class="p">[</span><span class="s2">&quot;measurement_step_max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%8.3e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
        <span class="n">pars</span><span class="p">[</span><span class="s2">&quot;measurement_step_max&quot;</span><span class="p">])</span>
    <span class="n">PmagSpecRec</span><span class="p">[</span><span class="s2">&quot;measurement_step_unit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s2">&quot;measurement_step_unit&quot;</span><span class="p">]</span>
    <span class="n">PmagSpecRec</span><span class="p">[</span><span class="s2">&quot;specimen_int_n&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%i</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_int_n&quot;</span><span class="p">])</span>
    <span class="n">PmagSpecRec</span><span class="p">[</span><span class="s2">&quot;specimen_lab_field_dc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%8.3e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
        <span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_lab_field_dc&quot;</span><span class="p">])</span>
    <span class="n">PmagSpecRec</span><span class="p">[</span><span class="s2">&quot;specimen_int&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%8.3e</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_int&quot;</span><span class="p">])</span>
    <span class="n">PmagSpecRec</span><span class="p">[</span><span class="s2">&quot;specimen_b&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%5.3f</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_b&quot;</span><span class="p">])</span>
    <span class="n">PmagSpecRec</span><span class="p">[</span><span class="s2">&quot;specimen_q&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%5.1f</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_q&quot;</span><span class="p">])</span>
    <span class="n">PmagSpecRec</span><span class="p">[</span><span class="s2">&quot;specimen_f&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%5.3f</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_f&quot;</span><span class="p">])</span>
    <span class="n">PmagSpecRec</span><span class="p">[</span><span class="s2">&quot;specimen_fvds&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%5.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_fvds&quot;</span><span class="p">])</span>
    <span class="n">PmagSpecRec</span><span class="p">[</span><span class="s2">&quot;specimen_b_beta&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%5.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_b_beta&quot;</span><span class="p">])</span>
    <span class="n">PmagSpecRec</span><span class="p">[</span><span class="s2">&quot;specimen_int_mad&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%7.1f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_int_mad&quot;</span><span class="p">])</span>
    <span class="n">PmagSpecRec</span><span class="p">[</span><span class="s2">&quot;specimen_dec&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%7.1f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_dec&quot;</span><span class="p">])</span>
    <span class="n">PmagSpecRec</span><span class="p">[</span><span class="s2">&quot;specimen_inc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%7.1f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_inc&quot;</span><span class="p">])</span>
    <span class="n">PmagSpecRec</span><span class="p">[</span><span class="s2">&quot;specimen_int_dang&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%7.1f</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_int_dang&quot;</span><span class="p">])</span>
    <span class="n">PmagSpecRec</span><span class="p">[</span><span class="s2">&quot;specimen_drats&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%7.1f</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_drats&quot;</span><span class="p">])</span>
    <span class="n">PmagSpecRec</span><span class="p">[</span><span class="s2">&quot;specimen_int_ptrm_n&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%i</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_int_ptrm_n&quot;</span><span class="p">])</span>
    <span class="n">PmagSpecRec</span><span class="p">[</span><span class="s2">&quot;specimen_rsc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%6.4f</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_rsc&quot;</span><span class="p">])</span>
    <span class="n">PmagSpecRec</span><span class="p">[</span><span class="s2">&quot;specimen_md&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%i</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_md&quot;</span><span class="p">]))</span>
    <span class="n">PmagSpecRec</span><span class="p">[</span><span class="s2">&quot;specimen_b_sigma&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%5.3f</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_b_sigma&quot;</span><span class="p">])</span>
    <span class="k">if</span> <span class="s1">&#39;specimen_scat&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">pars</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="n">PmagSpecRec</span><span class="p">[</span><span class="s1">&#39;specimen_scat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;specimen_scat&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="s1">&#39;specimen_gmax&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">pars</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="n">PmagSpecRec</span><span class="p">[</span><span class="s1">&#39;specimen_gmax&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%5.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">&#39;specimen_gmax&#39;</span><span class="p">])</span>
    <span class="k">if</span> <span class="s1">&#39;specimen_frac&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">pars</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="n">PmagSpecRec</span><span class="p">[</span><span class="s1">&#39;specimen_frac&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%5.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">&#39;specimen_frac&#39;</span><span class="p">])</span>
    <span class="c1"># PmagSpecRec[&quot;specimen_Z&quot;]=&#39;%7.1f&#39;%(pars[&quot;specimen_Z&quot;])</span>
  <span class="c1"># check score</span>
    <span class="c1">#</span>
    <span class="n">kill</span> <span class="o">=</span> <span class="n">grade</span><span class="p">(</span><span class="n">PmagSpecRec</span><span class="p">,</span> <span class="n">accept</span><span class="p">,</span> <span class="s1">&#39;specimen_int&#39;</span><span class="p">)</span>
    <span class="n">Grade</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">kill</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">Grade</span> <span class="o">=</span> <span class="s1">&#39;A&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">Grade</span> <span class="o">=</span> <span class="s1">&#39;F&#39;</span>
    <span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_grade&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Grade</span>
    <span class="k">if</span> <span class="n">verbose</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">pars</span><span class="p">,</span> <span class="n">kill</span>
    <span class="n">diffcum</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;measurement_step_unit&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;K&#39;</span><span class="p">:</span>
        <span class="n">outstr</span> <span class="o">=</span> <span class="s2">&quot;specimen     Tmin  Tmax  N  lab_field  B_anc  b  q  f(coe)  Fvds  beta  MAD  Dang  Drats  Nptrm  Grade  R  MD</span><span class="si">%  s</span><span class="s2">igma  Gamma_max </span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">pars_out</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s2">&quot;measurement_step_min&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="mi">273</span><span class="p">),</span> <span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s2">&quot;measurement_step_max&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="mi">273</span><span class="p">),</span> <span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_int_n&quot;</span><span class="p">]),</span> <span class="mf">1e6</span> <span class="o">*</span> <span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_lab_field_dc&quot;</span><span class="p">]),</span> <span class="mf">1e6</span> <span class="o">*</span> <span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_int&quot;</span><span class="p">]),</span> <span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_b&quot;</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_q&quot;</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_f&quot;</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_fvds&quot;</span><span class="p">],</span>
                    <span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_b_beta&quot;</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_int_mad&quot;</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_int_dang&quot;</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_drats&quot;</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_int_ptrm_n&quot;</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_grade&quot;</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_rsc&quot;</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_md&quot;</span><span class="p">]),</span> <span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_b_sigma&quot;</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;specimen_gamma&#39;</span><span class="p">])</span>
        <span class="n">outstring</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> </span><span class="si">%4.0f</span><span class="s1"> </span><span class="si">%4.0f</span><span class="s1"> </span><span class="si">%i</span><span class="s1"> </span><span class="si">%4.1f</span><span class="s1"> </span><span class="si">%4.1f</span><span class="s1"> </span><span class="si">%5.3f</span><span class="s1"> </span><span class="si">%5.1f</span><span class="s1"> </span><span class="si">%5.3f</span><span class="s1"> </span><span class="si">%5.3f</span><span class="s1"> </span><span class="si">%5.3f</span><span class="s1">  </span><span class="si">%7.1f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1"> </span><span class="si">%s</span><span class="s1"> </span><span class="si">%s</span><span class="s1"> </span><span class="si">%6.3f</span><span class="s1"> </span><span class="si">%i</span><span class="s1"> </span><span class="si">%5.3f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">pars_out</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="k">elif</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;measurement_step_unit&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;J&#39;</span><span class="p">:</span>
        <span class="n">outstr</span> <span class="o">=</span> <span class="s2">&quot;specimen     Wmin  Wmax  N  lab_field  B_anc  b  q  f(coe)  Fvds  beta  MAD  Dang  Drats  Nptrm  Grade  R  MD</span><span class="si">%  s</span><span class="s2">igma  ThetaMax DeltaMax GammaMax</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">pars_out</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s2">&quot;measurement_step_min&quot;</span><span class="p">]),</span> <span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s2">&quot;measurement_step_max&quot;</span><span class="p">]),</span> <span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_int_n&quot;</span><span class="p">]),</span> <span class="mf">1e6</span> <span class="o">*</span> <span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_lab_field_dc&quot;</span><span class="p">]),</span> <span class="mf">1e6</span> <span class="o">*</span> <span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_int&quot;</span><span class="p">]),</span> <span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_b&quot;</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_q&quot;</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_f&quot;</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_fvds&quot;</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_b_beta&quot;</span><span class="p">],</span>
                    <span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_int_mad&quot;</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_int_dang&quot;</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_drats&quot;</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_int_ptrm_n&quot;</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_grade&quot;</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_rsc&quot;</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_md&quot;</span><span class="p">]),</span> <span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_b_sigma&quot;</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_theta&quot;</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_delta&quot;</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_gamma&quot;</span><span class="p">])</span>
        <span class="n">outstring</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> </span><span class="si">%4.0f</span><span class="s1"> </span><span class="si">%4.0f</span><span class="s1"> </span><span class="si">%i</span><span class="s1"> </span><span class="si">%4.1f</span><span class="s1"> </span><span class="si">%4.1f</span><span class="s1"> </span><span class="si">%5.3f</span><span class="s1"> </span><span class="si">%5.1f</span><span class="s1"> </span><span class="si">%5.3f</span><span class="s1"> </span><span class="si">%5.3f</span><span class="s1"> </span><span class="si">%5.3f</span><span class="s1">  </span><span class="si">%7.1f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1"> </span><span class="si">%s</span><span class="s1"> </span><span class="si">%s</span><span class="s1"> </span><span class="si">%6.3f</span><span class="s1"> </span><span class="si">%i</span><span class="s1"> </span><span class="si">%5.3f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">pars_out</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="k">if</span> <span class="n">pars</span><span class="p">[</span><span class="s2">&quot;specimen_grade&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;A&quot;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> killed by:&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">kill</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="s1">&#39;:, criterion set to: &#39;</span><span class="p">,</span>
                  <span class="n">accept</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="s1">&#39;, specimen value: &#39;</span><span class="p">,</span> <span class="n">pars</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">outstr</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">outstring</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">pars</span><span class="p">,</span> <span class="n">kill</span></div>


<div class="viewcode-block" id="b_vdm"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.b_vdm">[docs]</a><span class="k">def</span> <span class="nf">b_vdm</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">lat</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts a magnetic field value of list of values to  virtual dipole moment (VDM)</span>
<span class="sd">    or a virtual axial dipole moment (VADM).</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    B: local magnetic field strength in tesla, as a value or list of values</span>
<span class="sd">    lat: latitude of site in degrees</span>

<span class="sd">    Returns</span>
<span class="sd">    VDM or V(A)DM in units of Am^2</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; pmag.b_vdm(33e-6,22)*1e-21</span>
<span class="sd">    71.58815974511788</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># changed radius of the earth from 3.367e6 3/12/2010</span>
    <span class="n">fact</span> <span class="o">=</span> <span class="p">((</span><span class="mf">6.371e6</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1e7</span>
    <span class="n">colat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mf">90.</span> <span class="o">-</span> <span class="n">lat</span><span class="p">)</span>
    <span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">B</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float&#39;</span><span class="p">)</span>
    <span class="n">Vs</span><span class="o">=</span> <span class="n">fact</span> <span class="o">*</span> <span class="n">B</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">colat</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)))</span>
    <span class="k">return</span> <span class="n">Vs</span></div>


<div class="viewcode-block" id="vdm_b"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.vdm_b">[docs]</a><span class="k">def</span> <span class="nf">vdm_b</span><span class="p">(</span><span class="n">vdm</span><span class="p">,</span> <span class="n">lat</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts a virtual dipole moment (VDM) or a virtual axial dipole moment</span>
<span class="sd">    (VADM) to a local magnetic field value </span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    vdm : V(A)DM in units of Am^2</span>
<span class="sd">    lat: latitude of site in degrees</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    B: local magnetic field strength in tesla</span>
<span class="sd">    </span>
<span class="sd">    Examples </span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; pmag.vdm_b(65, 20)</span>
<span class="sd">    2.9215108300460446e-26</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.</span>
    <span class="c1"># changed radius of the earth from 3.367e6 3/12/2010</span>
    <span class="n">fact</span> <span class="o">=</span> <span class="p">((</span><span class="mf">6.371e6</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1e7</span>
    <span class="n">colat</span> <span class="o">=</span> <span class="p">(</span><span class="mf">90.</span> <span class="o">-</span> <span class="n">lat</span><span class="p">)</span> <span class="o">*</span> <span class="n">rad</span>
    <span class="k">return</span> <span class="n">vdm</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">colat</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)))</span> <span class="o">/</span> <span class="n">fact</span></div>

<div class="viewcode-block" id="binglookup"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.binglookup">[docs]</a><span class="k">def</span> <span class="nf">binglookup</span><span class="p">(</span><span class="n">w1i</span><span class="p">,</span><span class="n">w2i</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Bingham statistics lookup table.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    w1i,w2i : initial values for w1 and w2</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    k1,k2 : k1 and k2 for Bingham distribution</span>
<span class="sd">    </span>
<span class="sd">    Examples </span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; pmag.binglookup(0.12,0.15)</span>
<span class="sd">    (-4.868, -3.7289999999999996)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">## find PYTHONPATH</span>
    <span class="c1">#pdirs=os.environ[&#39;PYTHONPATH&#39;].split(os.pathsep)</span>
    <span class="c1">#pdir=&quot;&quot;</span>
    <span class="c1">#for d in pdirs:</span>
    <span class="c1">#    if pdir==&quot;&quot; and  &#39;PmagPy&#39; in d and &#39;programs&#39; not in d:</span>
    <span class="c1">#        pdir=d</span>
    <span class="c1">#bingtab=pd.read_csv(pdir+&#39;/pmagpy/bingtab.txt&#39;,sep=&#39;\t&#39;,header=0)</span>
    <span class="c1">#k1_df=bingtab.drop_duplicates(subset=[&#39;w2&#39;],keep=&#39;first&#39;)</span>
    <span class="c1">#k2_df=bingtab.drop_duplicates(subset=[&#39;w2&#39;],keep=&#39;last&#39;)</span>
    <span class="n">k1_dict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;w2&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mf">0.02</span><span class="p">,</span>
  <span class="mi">2</span><span class="p">:</span> <span class="mf">0.04</span><span class="p">,</span>
  <span class="mi">4</span><span class="p">:</span> <span class="mf">0.06</span><span class="p">,</span>
  <span class="mi">6</span><span class="p">:</span> <span class="mf">0.08</span><span class="p">,</span>
  <span class="mi">8</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
  <span class="mi">10</span><span class="p">:</span> <span class="mf">0.12</span><span class="p">,</span>
  <span class="mi">12</span><span class="p">:</span> <span class="mf">0.14</span><span class="p">,</span>
  <span class="mi">14</span><span class="p">:</span> <span class="mf">0.16</span><span class="p">,</span>
  <span class="mi">16</span><span class="p">:</span> <span class="mf">0.18</span><span class="p">,</span>
  <span class="mi">18</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span>
  <span class="mi">20</span><span class="p">:</span> <span class="mf">0.22</span><span class="p">,</span>
  <span class="mi">22</span><span class="p">:</span> <span class="mf">0.24</span><span class="p">,</span>
  <span class="mi">24</span><span class="p">:</span> <span class="mf">0.26</span><span class="p">,</span>
  <span class="mi">26</span><span class="p">:</span> <span class="mf">0.28</span><span class="p">,</span>
  <span class="mi">28</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span>
  <span class="mi">30</span><span class="p">:</span> <span class="mf">0.32</span><span class="p">,</span>
  <span class="mi">32</span><span class="p">:</span> <span class="mf">0.34</span><span class="p">,</span>
  <span class="mi">34</span><span class="p">:</span> <span class="mf">0.36</span><span class="p">,</span>
  <span class="mi">36</span><span class="p">:</span> <span class="mf">0.38</span><span class="p">,</span>
  <span class="mi">38</span><span class="p">:</span> <span class="mf">0.4</span><span class="p">,</span>
  <span class="mi">40</span><span class="p">:</span> <span class="mf">0.42</span><span class="p">,</span>
  <span class="mi">42</span><span class="p">:</span> <span class="mf">0.44</span><span class="p">,</span>
  <span class="mi">44</span><span class="p">:</span> <span class="mf">0.46</span><span class="p">},</span>
 <span class="s1">&#39;0.02&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="o">-</span><span class="mf">25.55</span><span class="p">,</span>
  <span class="mi">2</span><span class="p">:</span> <span class="o">-</span><span class="mf">25.56</span><span class="p">,</span>
  <span class="mi">4</span><span class="p">:</span> <span class="o">-</span><span class="mf">25.58</span><span class="p">,</span>
  <span class="mi">6</span><span class="p">:</span> <span class="o">-</span><span class="mf">25.6</span><span class="p">,</span>
  <span class="mi">8</span><span class="p">:</span> <span class="o">-</span><span class="mf">25.62</span><span class="p">,</span>
  <span class="mi">10</span><span class="p">:</span> <span class="o">-</span><span class="mf">25.63</span><span class="p">,</span>
  <span class="mi">12</span><span class="p">:</span> <span class="o">-</span><span class="mf">25.64</span><span class="p">,</span>
  <span class="mi">14</span><span class="p">:</span> <span class="o">-</span><span class="mf">25.65</span><span class="p">,</span>
  <span class="mi">16</span><span class="p">:</span> <span class="o">-</span><span class="mf">25.65</span><span class="p">,</span>
  <span class="mi">18</span><span class="p">:</span> <span class="o">-</span><span class="mf">25.64</span><span class="p">,</span>
  <span class="mi">20</span><span class="p">:</span> <span class="o">-</span><span class="mf">25.63</span><span class="p">,</span>
  <span class="mi">22</span><span class="p">:</span> <span class="o">-</span><span class="mf">25.61</span><span class="p">,</span>
  <span class="mi">24</span><span class="p">:</span> <span class="o">-</span><span class="mf">25.59</span><span class="p">,</span>
  <span class="mi">26</span><span class="p">:</span> <span class="o">-</span><span class="mf">25.57</span><span class="p">,</span>
  <span class="mi">28</span><span class="p">:</span> <span class="o">-</span><span class="mf">25.54</span><span class="p">,</span>
  <span class="mi">30</span><span class="p">:</span> <span class="o">-</span><span class="mf">25.5</span><span class="p">,</span>
  <span class="mi">32</span><span class="p">:</span> <span class="o">-</span><span class="mf">25.46</span><span class="p">,</span>
  <span class="mi">34</span><span class="p">:</span> <span class="o">-</span><span class="mf">25.42</span><span class="p">,</span>
  <span class="mi">36</span><span class="p">:</span> <span class="o">-</span><span class="mf">25.37</span><span class="p">,</span>
  <span class="mi">38</span><span class="p">:</span> <span class="o">-</span><span class="mf">25.31</span><span class="p">,</span>
  <span class="mi">40</span><span class="p">:</span> <span class="o">-</span><span class="mf">25.5</span><span class="p">,</span>
  <span class="mi">42</span><span class="p">:</span> <span class="o">-</span><span class="mf">25.19</span><span class="p">,</span>
  <span class="mi">44</span><span class="p">:</span> <span class="o">-</span><span class="mf">25.12</span><span class="p">},</span>
 <span class="s1">&#39;0.04&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">2</span><span class="p">:</span> <span class="o">-</span><span class="mf">13.11</span><span class="p">,</span>
  <span class="mi">4</span><span class="p">:</span> <span class="o">-</span><span class="mf">13.14</span><span class="p">,</span>
  <span class="mi">6</span><span class="p">:</span> <span class="o">-</span><span class="mf">13.16</span><span class="p">,</span>
  <span class="mi">8</span><span class="p">:</span> <span class="o">-</span><span class="mf">13.18</span><span class="p">,</span>
  <span class="mi">10</span><span class="p">:</span> <span class="o">-</span><span class="mf">13.19</span><span class="p">,</span>
  <span class="mi">12</span><span class="p">:</span> <span class="o">-</span><span class="mf">13.2</span><span class="p">,</span>
  <span class="mi">14</span><span class="p">:</span> <span class="o">-</span><span class="mf">13.2</span><span class="p">,</span>
  <span class="mi">16</span><span class="p">:</span> <span class="o">-</span><span class="mf">13.19</span><span class="p">,</span>
  <span class="mi">18</span><span class="p">:</span> <span class="o">-</span><span class="mf">13.18</span><span class="p">,</span>
  <span class="mi">20</span><span class="p">:</span> <span class="o">-</span><span class="mf">13.17</span><span class="p">,</span>
  <span class="mi">22</span><span class="p">:</span> <span class="o">-</span><span class="mf">23.14</span><span class="p">,</span>
  <span class="mi">24</span><span class="p">:</span> <span class="o">-</span><span class="mf">13.12</span><span class="p">,</span>
  <span class="mi">26</span><span class="p">:</span> <span class="o">-</span><span class="mf">13.09</span><span class="p">,</span>
  <span class="mi">28</span><span class="p">:</span> <span class="o">-</span><span class="mf">13.05</span><span class="p">,</span>
  <span class="mi">30</span><span class="p">:</span> <span class="o">-</span><span class="mf">13.01</span><span class="p">,</span>
  <span class="mi">32</span><span class="p">:</span> <span class="o">-</span><span class="mf">12.96</span><span class="p">,</span>
  <span class="mi">34</span><span class="p">:</span> <span class="o">-</span><span class="mf">12.91</span><span class="p">,</span>
  <span class="mi">36</span><span class="p">:</span> <span class="o">-</span><span class="mf">12.86</span><span class="p">,</span>
  <span class="mi">38</span><span class="p">:</span> <span class="o">-</span><span class="mf">12.8</span><span class="p">,</span>
  <span class="mi">40</span><span class="p">:</span> <span class="o">-</span><span class="mf">12.73</span><span class="p">,</span>
  <span class="mi">42</span><span class="p">:</span> <span class="o">-</span><span class="mf">12.66</span><span class="p">,</span>
  <span class="mi">44</span><span class="p">:</span> <span class="o">-</span><span class="mf">12.58</span><span class="p">},</span>
 <span class="s1">&#39;0.06&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">4</span><span class="p">:</span> <span class="o">-</span><span class="mf">9.043</span><span class="p">,</span>
  <span class="mi">6</span><span class="p">:</span> <span class="o">-</span><span class="mf">9.065</span><span class="p">,</span>
  <span class="mi">8</span><span class="p">:</span> <span class="o">-</span><span class="mf">9.08</span><span class="p">,</span>
  <span class="mi">10</span><span class="p">:</span> <span class="o">-</span><span class="mf">9.087</span><span class="p">,</span>
  <span class="mi">12</span><span class="p">:</span> <span class="o">-</span><span class="mf">9.087</span><span class="p">,</span>
  <span class="mi">14</span><span class="p">:</span> <span class="o">-</span><span class="mf">9.081</span><span class="p">,</span>
  <span class="mi">16</span><span class="p">:</span> <span class="o">-</span><span class="mf">9.068</span><span class="p">,</span>
  <span class="mi">18</span><span class="p">:</span> <span class="o">-</span><span class="mf">9.05</span><span class="p">,</span>
  <span class="mi">20</span><span class="p">:</span> <span class="o">-</span><span class="mf">9.027000000000001</span><span class="p">,</span>
  <span class="mi">22</span><span class="p">:</span> <span class="o">-</span><span class="mf">8.999</span><span class="p">,</span>
  <span class="mi">24</span><span class="p">:</span> <span class="o">-</span><span class="mf">8.966000000000001</span><span class="p">,</span>
  <span class="mi">26</span><span class="p">:</span> <span class="o">-</span><span class="mf">8.927999999999999</span><span class="p">,</span>
  <span class="mi">28</span><span class="p">:</span> <span class="o">-</span><span class="mf">8.886000000000001</span><span class="p">,</span>
  <span class="mi">30</span><span class="p">:</span> <span class="o">-</span><span class="mf">8.839</span><span class="p">,</span>
  <span class="mi">32</span><span class="p">:</span> <span class="o">-</span><span class="mf">8.788</span><span class="p">,</span>
  <span class="mi">34</span><span class="p">:</span> <span class="o">-</span><span class="mf">8.731</span><span class="p">,</span>
  <span class="mi">36</span><span class="p">:</span> <span class="o">-</span><span class="mf">8.67</span><span class="p">,</span>
  <span class="mi">38</span><span class="p">:</span> <span class="o">-</span><span class="mf">8.604</span><span class="p">,</span>
  <span class="mi">40</span><span class="p">:</span> <span class="o">-</span><span class="mf">8.532</span><span class="p">,</span>
  <span class="mi">42</span><span class="p">:</span> <span class="o">-</span><span class="mf">8.454</span><span class="p">,</span>
  <span class="mi">44</span><span class="p">:</span> <span class="o">-</span><span class="mf">8.371</span><span class="p">},</span>
 <span class="s1">&#39;0.08&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">4</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">6</span><span class="p">:</span> <span class="o">-</span><span class="mf">7.035</span><span class="p">,</span>
  <span class="mi">8</span><span class="p">:</span> <span class="o">-</span><span class="mf">7.042000000000001</span><span class="p">,</span>
  <span class="mi">10</span><span class="p">:</span> <span class="o">-</span><span class="mf">7.041</span><span class="p">,</span>
  <span class="mi">12</span><span class="p">:</span> <span class="o">-</span><span class="mf">7.0329999999999995</span><span class="p">,</span>
  <span class="mi">14</span><span class="p">:</span> <span class="o">-</span><span class="mf">7.019</span><span class="p">,</span>
  <span class="mi">16</span><span class="p">:</span> <span class="o">-</span><span class="mf">6.999</span><span class="p">,</span>
  <span class="mi">18</span><span class="p">:</span> <span class="o">-</span><span class="mf">6.974</span><span class="p">,</span>
  <span class="mi">20</span><span class="p">:</span> <span class="o">-</span><span class="mf">6.944</span><span class="p">,</span>
  <span class="mi">22</span><span class="p">:</span> <span class="o">-</span><span class="mf">6.91</span><span class="p">,</span>
  <span class="mi">24</span><span class="p">:</span> <span class="o">-</span><span class="mf">6.87</span><span class="p">,</span>
  <span class="mi">26</span><span class="p">:</span> <span class="o">-</span><span class="mf">6.827000000000001</span><span class="p">,</span>
  <span class="mi">28</span><span class="p">:</span> <span class="o">-</span><span class="mf">6.778</span><span class="p">,</span>
  <span class="mi">30</span><span class="p">:</span> <span class="o">-</span><span class="mf">6.725</span><span class="p">,</span>
  <span class="mi">32</span><span class="p">:</span> <span class="o">-</span><span class="mf">6.667999999999999</span><span class="p">,</span>
  <span class="mi">34</span><span class="p">:</span> <span class="o">-</span><span class="mf">6.606</span><span class="p">,</span>
  <span class="mi">36</span><span class="p">:</span> <span class="o">-</span><span class="mf">6.539</span><span class="p">,</span>
  <span class="mi">38</span><span class="p">:</span> <span class="o">-</span><span class="mf">6.466</span><span class="p">,</span>
  <span class="mi">40</span><span class="p">:</span> <span class="o">-</span><span class="mf">6.388</span><span class="p">,</span>
  <span class="mi">42</span><span class="p">:</span> <span class="o">-</span><span class="mf">6.305</span><span class="p">,</span>
  <span class="mi">44</span><span class="p">:</span> <span class="o">-</span><span class="mf">6.215</span><span class="p">},</span>
 <span class="s1">&#39;0.10&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">4</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">6</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">8</span><span class="p">:</span> <span class="o">-</span><span class="mf">5.797000000000001</span><span class="p">,</span>
  <span class="mi">10</span><span class="p">:</span> <span class="o">-</span><span class="mf">5.789</span><span class="p">,</span>
  <span class="mi">12</span><span class="p">:</span> <span class="o">-</span><span class="mf">5.773</span><span class="p">,</span>
  <span class="mi">14</span><span class="p">:</span> <span class="o">-</span><span class="mf">5.752000000000001</span><span class="p">,</span>
  <span class="mi">16</span><span class="p">:</span> <span class="o">-</span><span class="mf">5.726</span><span class="p">,</span>
  <span class="mi">18</span><span class="p">:</span> <span class="o">-</span><span class="mf">5.694</span><span class="p">,</span>
  <span class="mi">20</span><span class="p">:</span> <span class="o">-</span><span class="mf">5.6579999999999995</span><span class="p">,</span>
  <span class="mi">22</span><span class="p">:</span> <span class="o">-</span><span class="mf">5.617999999999999</span><span class="p">,</span>
  <span class="mi">24</span><span class="p">:</span> <span class="o">-</span><span class="mf">5.5729999999999995</span><span class="p">,</span>
  <span class="mi">26</span><span class="p">:</span> <span class="o">-</span><span class="mf">5.523</span><span class="p">,</span>
  <span class="mi">28</span><span class="p">:</span> <span class="o">-</span><span class="mf">5.468999999999999</span><span class="p">,</span>
  <span class="mi">30</span><span class="p">:</span> <span class="o">-</span><span class="mf">5.4110000000000005</span><span class="p">,</span>
  <span class="mi">32</span><span class="p">:</span> <span class="o">-</span><span class="mf">5.348</span><span class="p">,</span>
  <span class="mi">34</span><span class="p">:</span> <span class="o">-</span><span class="mf">5.28</span><span class="p">,</span>
  <span class="mi">36</span><span class="p">:</span> <span class="o">-</span><span class="mf">5.207000000000001</span><span class="p">,</span>
  <span class="mi">38</span><span class="p">:</span> <span class="o">-</span><span class="mf">5.126</span><span class="p">,</span>
  <span class="mi">40</span><span class="p">:</span> <span class="o">-</span><span class="mf">5.045</span><span class="p">,</span>
  <span class="mi">42</span><span class="p">:</span> <span class="o">-</span><span class="mf">4.955</span><span class="p">,</span>
  <span class="mi">44</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">},</span>
 <span class="s1">&#39;0.12&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">4</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">6</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">8</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">10</span><span class="p">:</span> <span class="o">-</span><span class="mf">4.917</span><span class="p">,</span>
  <span class="mi">12</span><span class="p">:</span> <span class="o">-</span><span class="mf">4.896</span><span class="p">,</span>
  <span class="mi">14</span><span class="p">:</span> <span class="o">-</span><span class="mf">4.868</span><span class="p">,</span>
  <span class="mi">16</span><span class="p">:</span> <span class="o">-</span><span class="mf">4.836</span><span class="p">,</span>
  <span class="mi">18</span><span class="p">:</span> <span class="o">-</span><span class="mf">4.7989999999999995</span><span class="p">,</span>
  <span class="mi">20</span><span class="p">:</span> <span class="o">-</span><span class="mf">4.757</span><span class="p">,</span>
  <span class="mi">22</span><span class="p">:</span> <span class="o">-</span><span class="mf">4.711</span><span class="p">,</span>
  <span class="mi">24</span><span class="p">:</span> <span class="o">-</span><span class="mf">4.6610000000000005</span><span class="p">,</span>
  <span class="mi">26</span><span class="p">:</span> <span class="o">-</span><span class="mf">4.606</span><span class="p">,</span>
  <span class="mi">28</span><span class="p">:</span> <span class="o">-</span><span class="mf">4.547</span><span class="p">,</span>
  <span class="mi">30</span><span class="p">:</span> <span class="o">-</span><span class="mf">4.484</span><span class="p">,</span>
  <span class="mi">32</span><span class="p">:</span> <span class="o">-</span><span class="mf">4.415</span><span class="p">,</span>
  <span class="mi">34</span><span class="p">:</span> <span class="o">-</span><span class="mf">4.342</span><span class="p">,</span>
  <span class="mi">36</span><span class="p">:</span> <span class="o">-</span><span class="mf">4.263</span><span class="p">,</span>
  <span class="mi">38</span><span class="p">:</span> <span class="o">-</span><span class="mf">4.178999999999999</span><span class="p">,</span>
  <span class="mi">40</span><span class="p">:</span> <span class="o">-</span><span class="mf">4.0889999999999995</span><span class="p">,</span>
  <span class="mi">42</span><span class="p">:</span> <span class="o">-</span><span class="mf">3.992</span><span class="p">,</span>
  <span class="mi">44</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">},</span>
 <span class="s1">&#39;0.14&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">4</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">6</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">8</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">10</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">12</span><span class="p">:</span> <span class="o">-</span><span class="mf">4.231</span><span class="p">,</span>
  <span class="mi">14</span><span class="p">:</span> <span class="o">-</span><span class="mf">4.198</span><span class="p">,</span>
  <span class="mi">16</span><span class="p">:</span> <span class="o">-</span><span class="mf">4.16</span><span class="p">,</span>
  <span class="mi">18</span><span class="p">:</span> <span class="o">-</span><span class="mf">4.118</span><span class="p">,</span>
  <span class="mi">20</span><span class="p">:</span> <span class="o">-</span><span class="mf">4.071000000000001</span><span class="p">,</span>
  <span class="mi">22</span><span class="p">:</span> <span class="o">-</span><span class="mf">4.021</span><span class="p">,</span>
  <span class="mi">24</span><span class="p">:</span> <span class="o">-</span><span class="mf">3.965</span><span class="p">,</span>
  <span class="mi">26</span><span class="p">:</span> <span class="o">-</span><span class="mf">3.906</span><span class="p">,</span>
  <span class="mi">28</span><span class="p">:</span> <span class="o">-</span><span class="mf">3.842</span><span class="p">,</span>
  <span class="mi">30</span><span class="p">:</span> <span class="o">-</span><span class="mf">3.773</span><span class="p">,</span>
  <span class="mi">32</span><span class="p">:</span> <span class="o">-</span><span class="mf">3.699</span><span class="p">,</span>
  <span class="mi">34</span><span class="p">:</span> <span class="o">-</span><span class="mf">3.62</span><span class="p">,</span>
  <span class="mi">36</span><span class="p">:</span> <span class="o">-</span><span class="mf">3.536</span><span class="p">,</span>
  <span class="mi">38</span><span class="p">:</span> <span class="o">-</span><span class="mf">3.446</span><span class="p">,</span>
  <span class="mi">40</span><span class="p">:</span> <span class="o">-</span><span class="mf">3.3489999999999998</span><span class="p">,</span>
  <span class="mi">42</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">44</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">},</span>
 <span class="s1">&#39;0.16&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">4</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">6</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">8</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">10</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">12</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">14</span><span class="p">:</span> <span class="o">-</span><span class="mf">3.659</span><span class="p">,</span>
  <span class="mi">16</span><span class="p">:</span> <span class="o">-</span><span class="mf">3.616</span><span class="p">,</span>
  <span class="mi">18</span><span class="p">:</span> <span class="o">-</span><span class="mf">3.57</span><span class="p">,</span>
  <span class="mi">20</span><span class="p">:</span> <span class="o">-</span><span class="mf">3.5180000000000002</span><span class="p">,</span>
  <span class="mi">22</span><span class="p">:</span> <span class="o">-</span><span class="mf">3.463</span><span class="p">,</span>
  <span class="mi">24</span><span class="p">:</span> <span class="o">-</span><span class="mf">3.403</span><span class="p">,</span>
  <span class="mi">26</span><span class="p">:</span> <span class="o">-</span><span class="mf">3.338</span><span class="p">,</span>
  <span class="mi">28</span><span class="p">:</span> <span class="o">-</span><span class="mf">3.2689999999999997</span><span class="p">,</span>
  <span class="mi">30</span><span class="p">:</span> <span class="o">-</span><span class="mf">3.195</span><span class="p">,</span>
  <span class="mi">32</span><span class="p">:</span> <span class="o">-</span><span class="mf">3.116</span><span class="p">,</span>
  <span class="mi">34</span><span class="p">:</span> <span class="o">-</span><span class="mf">3.032</span><span class="p">,</span>
  <span class="mi">36</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.9410000000000003</span><span class="p">,</span>
  <span class="mi">38</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.845</span><span class="p">,</span>
  <span class="mi">40</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.741</span><span class="p">,</span>
  <span class="mi">42</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">44</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">},</span>
 <span class="s1">&#39;0.18&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">4</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">6</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">8</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">10</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">12</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">14</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">16</span><span class="p">:</span> <span class="o">-</span><span class="mf">3.16</span><span class="p">,</span>
  <span class="mi">18</span><span class="p">:</span> <span class="o">-</span><span class="mf">3.109</span><span class="p">,</span>
  <span class="mi">20</span><span class="p">:</span> <span class="o">-</span><span class="mf">3.053</span><span class="p">,</span>
  <span class="mi">22</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.9930000000000003</span><span class="p">,</span>
  <span class="mi">24</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.928</span><span class="p">,</span>
  <span class="mi">26</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.859</span><span class="p">,</span>
  <span class="mi">28</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.785</span><span class="p">,</span>
  <span class="mi">30</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.7060000000000004</span><span class="p">,</span>
  <span class="mi">32</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.6210000000000004</span><span class="p">,</span>
  <span class="mi">34</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.531</span><span class="p">,</span>
  <span class="mi">36</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.434</span><span class="p">,</span>
  <span class="mi">38</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.33</span><span class="p">,</span>
  <span class="mi">40</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">42</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">44</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">},</span>
 <span class="s1">&#39;0.20&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">4</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">6</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">8</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">10</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">12</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">14</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">16</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">18</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.7089999999999996</span><span class="p">,</span>
  <span class="mi">20</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.6489999999999996</span><span class="p">,</span>
  <span class="mi">22</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.5839999999999996</span><span class="p">,</span>
  <span class="mi">24</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.515</span><span class="p">,</span>
  <span class="mi">26</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.441</span><span class="p">,</span>
  <span class="mi">28</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.3609999999999998</span><span class="p">,</span>
  <span class="mi">30</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.2769999999999997</span><span class="p">,</span>
  <span class="mi">32</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.186</span><span class="p">,</span>
  <span class="mi">34</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.089</span><span class="p">,</span>
  <span class="mi">36</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.986</span><span class="p">,</span>
  <span class="mi">38</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.874</span><span class="p">,</span>
  <span class="mi">40</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">42</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">44</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">},</span>
 <span class="s1">&#39;0.22&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">4</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">6</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">8</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">10</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">12</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">14</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">16</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">18</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">20</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.289</span><span class="p">,</span>
  <span class="mi">22</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.22</span><span class="p">,</span>
  <span class="mi">24</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.146</span><span class="p">,</span>
  <span class="mi">26</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.066</span><span class="p">,</span>
  <span class="mi">28</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.9809999999999999</span><span class="p">,</span>
  <span class="mi">30</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.891</span><span class="p">,</span>
  <span class="mi">32</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.794</span><span class="p">,</span>
  <span class="mi">34</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.69</span><span class="p">,</span>
  <span class="mi">36</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.579</span><span class="p">,</span>
  <span class="mi">38</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">40</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">42</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">44</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">},</span>
 <span class="s1">&#39;0.24&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">4</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">6</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">8</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">10</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">12</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">14</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">16</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">18</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">20</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">22</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.8880000000000001</span><span class="p">,</span>
  <span class="mi">24</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.8090000000000002</span><span class="p">,</span>
  <span class="mi">26</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.724</span><span class="p">,</span>
  <span class="mi">28</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.6340000000000001</span><span class="p">,</span>
  <span class="mi">30</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.537</span><span class="p">,</span>
  <span class="mi">32</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.433</span><span class="p">,</span>
  <span class="mi">34</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.3219999999999998</span><span class="p">,</span>
  <span class="mi">36</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.202</span><span class="p">,</span>
  <span class="mi">38</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">40</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">42</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">44</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">},</span>
 <span class="s1">&#39;0.26&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">4</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">6</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">8</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">10</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">12</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">14</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">16</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">18</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">20</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">22</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">24</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.4969999999999999</span><span class="p">,</span>
  <span class="mi">26</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.406</span><span class="p">,</span>
  <span class="mi">28</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.3090000000000002</span><span class="p">,</span>
  <span class="mi">30</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.206</span><span class="p">,</span>
  <span class="mi">32</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.094</span><span class="p">,</span>
  <span class="mi">34</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.9740000000000001</span><span class="p">,</span>
  <span class="mi">36</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">38</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">40</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">42</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">44</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">},</span>
 <span class="s1">&#39;0.28&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">4</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">6</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">8</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">10</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">12</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">14</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">16</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">18</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">20</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">22</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">24</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">26</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.1059999999999999</span><span class="p">,</span>
  <span class="mi">28</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.002</span><span class="p">,</span>
  <span class="mi">30</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.8909999999999999</span><span class="p">,</span>
  <span class="mi">32</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.7709999999999999</span><span class="p">,</span>
  <span class="mi">34</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.642</span><span class="p">,</span>
  <span class="mi">36</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">38</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">40</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">42</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">44</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">},</span>
 <span class="s1">&#39;0.30&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">4</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">6</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">8</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">10</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">12</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">14</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">16</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">18</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">20</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">22</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">24</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">26</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">28</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.708</span><span class="p">,</span>
  <span class="mi">30</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.588</span><span class="p">,</span>
  <span class="mi">32</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.45899999999999996</span><span class="p">,</span>
  <span class="mi">34</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">36</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">38</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">40</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">42</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">44</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">},</span>
 <span class="s1">&#39;0.32&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">4</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">6</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">8</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">10</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">12</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">14</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">16</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">18</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">20</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">22</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">24</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">26</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">28</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">30</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.292</span><span class="p">,</span>
  <span class="mi">32</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.152</span><span class="p">,</span>
  <span class="mi">34</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">36</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">38</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">40</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">42</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">44</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">}}</span>
    <span class="n">k2_dict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;w2&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="mf">0.02</span><span class="p">,</span>
  <span class="mi">3</span><span class="p">:</span> <span class="mf">0.04</span><span class="p">,</span>
  <span class="mi">5</span><span class="p">:</span> <span class="mf">0.06</span><span class="p">,</span>
  <span class="mi">7</span><span class="p">:</span> <span class="mf">0.08</span><span class="p">,</span>
  <span class="mi">9</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
  <span class="mi">11</span><span class="p">:</span> <span class="mf">0.12</span><span class="p">,</span>
  <span class="mi">13</span><span class="p">:</span> <span class="mf">0.14</span><span class="p">,</span>
  <span class="mi">15</span><span class="p">:</span> <span class="mf">0.16</span><span class="p">,</span>
  <span class="mi">17</span><span class="p">:</span> <span class="mf">0.18</span><span class="p">,</span>
  <span class="mi">19</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span>
  <span class="mi">21</span><span class="p">:</span> <span class="mf">0.22</span><span class="p">,</span>
  <span class="mi">23</span><span class="p">:</span> <span class="mf">0.24</span><span class="p">,</span>
  <span class="mi">25</span><span class="p">:</span> <span class="mf">0.26</span><span class="p">,</span>
  <span class="mi">27</span><span class="p">:</span> <span class="mf">0.28</span><span class="p">,</span>
  <span class="mi">29</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span>
  <span class="mi">31</span><span class="p">:</span> <span class="mf">0.32</span><span class="p">,</span>
  <span class="mi">33</span><span class="p">:</span> <span class="mf">0.34</span><span class="p">,</span>
  <span class="mi">35</span><span class="p">:</span> <span class="mf">0.36</span><span class="p">,</span>
  <span class="mi">37</span><span class="p">:</span> <span class="mf">0.38</span><span class="p">,</span>
  <span class="mi">39</span><span class="p">:</span> <span class="mf">0.4</span><span class="p">,</span>
  <span class="mi">41</span><span class="p">:</span> <span class="mf">0.42</span><span class="p">,</span>
  <span class="mi">43</span><span class="p">:</span> <span class="mf">0.44</span><span class="p">,</span>
  <span class="mi">45</span><span class="p">:</span> <span class="mf">0.46</span><span class="p">},</span>
 <span class="s1">&#39;0.02&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="o">-</span><span class="mf">25.55</span><span class="p">,</span>
  <span class="mi">3</span><span class="p">:</span> <span class="o">-</span><span class="mf">13.09</span><span class="p">,</span>
  <span class="mi">5</span><span class="p">:</span> <span class="o">-</span><span class="mf">8.996</span><span class="p">,</span>
  <span class="mi">7</span><span class="p">:</span> <span class="o">-</span><span class="mf">6.977</span><span class="p">,</span>
  <span class="mi">9</span><span class="p">:</span> <span class="o">-</span><span class="mf">5.76</span><span class="p">,</span>
  <span class="mi">11</span><span class="p">:</span> <span class="o">-</span><span class="mf">4.923</span><span class="p">,</span>
  <span class="mi">13</span><span class="p">:</span> <span class="o">-</span><span class="mf">4.295</span><span class="p">,</span>
  <span class="mi">15</span><span class="p">:</span> <span class="o">-</span><span class="mf">3.7960000000000003</span><span class="p">,</span>
  <span class="mi">17</span><span class="p">:</span> <span class="o">-</span><span class="mf">3.3810000000000002</span><span class="p">,</span>
  <span class="mi">19</span><span class="p">:</span> <span class="o">-</span><span class="mf">3.025</span><span class="p">,</span>
  <span class="mi">21</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.7119999999999997</span><span class="p">,</span>
  <span class="mi">23</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.431</span><span class="p">,</span>
  <span class="mi">25</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.175</span><span class="p">,</span>
  <span class="mi">27</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.939</span><span class="p">,</span>
  <span class="mi">29</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.7180000000000002</span><span class="p">,</span>
  <span class="mi">31</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.51</span><span class="p">,</span>
  <span class="mi">33</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.3119999999999998</span><span class="p">,</span>
  <span class="mi">35</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.123</span><span class="p">,</span>
  <span class="mi">37</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.94</span><span class="p">,</span>
  <span class="mi">39</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.762</span><span class="p">,</span>
  <span class="mi">41</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.589</span><span class="p">,</span>
  <span class="mi">43</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.418</span><span class="p">,</span>
  <span class="mi">45</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.25</span><span class="p">},</span>
 <span class="s1">&#39;0.04&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">3</span><span class="p">:</span> <span class="o">-</span><span class="mf">13.11</span><span class="p">,</span>
  <span class="mi">5</span><span class="p">:</span> <span class="o">-</span><span class="mf">9.019</span><span class="p">,</span>
  <span class="mi">7</span><span class="p">:</span> <span class="o">-</span><span class="mf">6.999</span><span class="p">,</span>
  <span class="mi">9</span><span class="p">:</span> <span class="o">-</span><span class="mf">5.777</span><span class="p">,</span>
  <span class="mi">11</span><span class="p">:</span> <span class="o">-</span><span class="mf">4.934</span><span class="p">,</span>
  <span class="mi">13</span><span class="p">:</span> <span class="o">-</span><span class="mf">4.301</span><span class="p">,</span>
  <span class="mi">15</span><span class="p">:</span> <span class="o">-</span><span class="mf">3.7960000000000003</span><span class="p">,</span>
  <span class="mi">17</span><span class="p">:</span> <span class="o">-</span><span class="mf">3.375</span><span class="p">,</span>
  <span class="mi">19</span><span class="p">:</span> <span class="o">-</span><span class="mf">3.014</span><span class="p">,</span>
  <span class="mi">21</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.695</span><span class="p">,</span>
  <span class="mi">23</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.41</span><span class="p">,</span>
  <span class="mi">25</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.149</span><span class="p">,</span>
  <span class="mi">27</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.9080000000000001</span><span class="p">,</span>
  <span class="mi">29</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.682</span><span class="p">,</span>
  <span class="mi">31</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.47</span><span class="p">,</span>
  <span class="mi">33</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.2670000000000001</span><span class="p">,</span>
  <span class="mi">35</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.073</span><span class="p">,</span>
  <span class="mi">37</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.885</span><span class="p">,</span>
  <span class="mi">39</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.7020000000000001</span><span class="p">,</span>
  <span class="mi">41</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.523</span><span class="p">,</span>
  <span class="mi">43</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.34700000000000003</span><span class="p">,</span>
  <span class="mi">45</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.17300000000000001</span><span class="p">},</span>
 <span class="s1">&#39;0.06&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">5</span><span class="p">:</span> <span class="o">-</span><span class="mf">9.043</span><span class="p">,</span>
  <span class="mi">7</span><span class="p">:</span> <span class="o">-</span><span class="mf">7.02</span><span class="p">,</span>
  <span class="mi">9</span><span class="p">:</span> <span class="o">-</span><span class="mf">5.791</span><span class="p">,</span>
  <span class="mi">11</span><span class="p">:</span> <span class="o">-</span><span class="mf">4.941</span><span class="p">,</span>
  <span class="mi">13</span><span class="p">:</span> <span class="o">-</span><span class="mf">4.301</span><span class="p">,</span>
  <span class="mi">15</span><span class="p">:</span> <span class="o">-</span><span class="mf">3.79</span><span class="p">,</span>
  <span class="mi">17</span><span class="p">:</span> <span class="o">-</span><span class="mf">3.363</span><span class="p">,</span>
  <span class="mi">19</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.997</span><span class="p">,</span>
  <span class="mi">21</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.673</span><span class="p">,</span>
  <span class="mi">23</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.3819999999999997</span><span class="p">,</span>
  <span class="mi">25</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.117</span><span class="p">,</span>
  <span class="mi">27</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.871</span><span class="p">,</span>
  <span class="mi">29</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.641</span><span class="p">,</span>
  <span class="mi">31</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.423</span><span class="p">,</span>
  <span class="mi">33</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.216</span><span class="p">,</span>
  <span class="mi">35</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.0170000000000001</span><span class="p">,</span>
  <span class="mi">37</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.8240000000000001</span><span class="p">,</span>
  <span class="mi">39</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.636</span><span class="p">,</span>
  <span class="mi">41</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.452</span><span class="p">,</span>
  <span class="mi">43</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.27</span><span class="p">,</span>
  <span class="mi">45</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.09</span><span class="p">},</span>
 <span class="s1">&#39;0.08&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">5</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">7</span><span class="p">:</span> <span class="o">-</span><span class="mf">7.035</span><span class="p">,</span>
  <span class="mi">9</span><span class="p">:</span> <span class="o">-</span><span class="mf">5.797999999999999</span><span class="p">,</span>
  <span class="mi">11</span><span class="p">:</span> <span class="o">-</span><span class="mf">4.941</span><span class="p">,</span>
  <span class="mi">13</span><span class="p">:</span> <span class="o">-</span><span class="mf">4.294</span><span class="p">,</span>
  <span class="mi">15</span><span class="p">:</span> <span class="o">-</span><span class="mf">3.7769999999999997</span><span class="p">,</span>
  <span class="mi">17</span><span class="p">:</span> <span class="o">-</span><span class="mf">3.345</span><span class="p">,</span>
  <span class="mi">19</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.9730000000000003</span><span class="p">,</span>
  <span class="mi">21</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.6439999999999997</span><span class="p">,</span>
  <span class="mi">23</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.349</span><span class="p">,</span>
  <span class="mi">25</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.0780000000000003</span><span class="p">,</span>
  <span class="mi">27</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.828</span><span class="p">,</span>
  <span class="mi">29</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.5959999999999999</span><span class="p">,</span>
  <span class="mi">31</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.371</span><span class="p">,</span>
  <span class="mi">33</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.159</span><span class="p">,</span>
  <span class="mi">35</span><span class="p">:</span> <span class="o">-</span><span class="mf">9.555</span><span class="p">,</span>
  <span class="mi">37</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.757</span><span class="p">,</span>
  <span class="mi">39</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.564</span><span class="p">,</span>
  <span class="mi">41</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.374</span><span class="p">,</span>
  <span class="mi">43</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.18600000000000003</span><span class="p">,</span>
  <span class="mi">45</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">},</span>
 <span class="s1">&#39;0.10&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">5</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">7</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">9</span><span class="p">:</span> <span class="o">-</span><span class="mf">5.797000000000001</span><span class="p">,</span>
  <span class="mi">11</span><span class="p">:</span> <span class="o">-</span><span class="mf">4.933</span><span class="p">,</span>
  <span class="mi">13</span><span class="p">:</span> <span class="o">-</span><span class="mf">4.279</span><span class="p">,</span>
  <span class="mi">15</span><span class="p">:</span> <span class="o">-</span><span class="mf">3.7560000000000002</span><span class="p">,</span>
  <span class="mi">17</span><span class="p">:</span> <span class="o">-</span><span class="mf">3.319</span><span class="p">,</span>
  <span class="mi">19</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.9419999999999997</span><span class="p">,</span>
  <span class="mi">21</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.609</span><span class="p">,</span>
  <span class="mi">23</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.309</span><span class="p">,</span>
  <span class="mi">25</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.0340000000000003</span><span class="p">,</span>
  <span class="mi">27</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.7790000000000001</span><span class="p">,</span>
  <span class="mi">29</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.54</span><span class="p">,</span>
  <span class="mi">31</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.3130000000000002</span><span class="p">,</span>
  <span class="mi">33</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.0959999999999999</span><span class="p">,</span>
  <span class="mi">35</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.887</span><span class="p">,</span>
  <span class="mi">37</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.684</span><span class="p">,</span>
  <span class="mi">39</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.486</span><span class="p">,</span>
  <span class="mi">41</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.29</span><span class="p">,</span>
  <span class="mi">43</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.09699999999999999</span><span class="p">,</span>
  <span class="mi">45</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">},</span>
 <span class="s1">&#39;0.12&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">5</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">7</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">9</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">11</span><span class="p">:</span> <span class="o">-</span><span class="mf">4.917</span><span class="p">,</span>
  <span class="mi">13</span><span class="p">:</span> <span class="o">-</span><span class="mf">4.258</span><span class="p">,</span>
  <span class="mi">15</span><span class="p">:</span> <span class="o">-</span><span class="mf">3.7289999999999996</span><span class="p">,</span>
  <span class="mi">17</span><span class="p">:</span> <span class="o">-</span><span class="mf">3.287</span><span class="p">,</span>
  <span class="mi">19</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.905</span><span class="p">,</span>
  <span class="mi">21</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.568</span><span class="p">,</span>
  <span class="mi">23</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.263</span><span class="p">,</span>
  <span class="mi">25</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.984</span><span class="p">,</span>
  <span class="mi">27</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.725</span><span class="p">,</span>
  <span class="mi">29</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.4809999999999999</span><span class="p">,</span>
  <span class="mi">31</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.25</span><span class="p">,</span>
  <span class="mi">33</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.028</span><span class="p">,</span>
  <span class="mi">35</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.8140000000000001</span><span class="p">,</span>
  <span class="mi">37</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.606</span><span class="p">,</span>
  <span class="mi">39</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.402</span><span class="p">,</span>
  <span class="mi">41</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span>
  <span class="mi">43</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
  <span class="mi">45</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">},</span>
 <span class="s1">&#39;0.14&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">5</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">7</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">9</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">11</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">13</span><span class="p">:</span> <span class="o">-</span><span class="mf">4.231</span><span class="p">,</span>
  <span class="mi">15</span><span class="p">:</span> <span class="o">-</span><span class="mf">3.697</span><span class="p">,</span>
  <span class="mi">17</span><span class="p">:</span> <span class="o">-</span><span class="mf">3.2489999999999997</span><span class="p">,</span>
  <span class="mi">19</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.863</span><span class="p">,</span>
  <span class="mi">21</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.521</span><span class="p">,</span>
  <span class="mi">23</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.2119999999999997</span><span class="p">,</span>
  <span class="mi">25</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.929</span><span class="p">,</span>
  <span class="mi">27</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.665</span><span class="p">,</span>
  <span class="mi">29</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.4169999999999998</span><span class="p">,</span>
  <span class="mi">31</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.181</span><span class="p">,</span>
  <span class="mi">33</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.955</span><span class="p">,</span>
  <span class="mi">35</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.736</span><span class="p">,</span>
  <span class="mi">37</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.522</span><span class="p">,</span>
  <span class="mi">39</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.312</span><span class="p">,</span>
  <span class="mi">41</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.10400000000000001</span><span class="p">,</span>
  <span class="mi">43</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">45</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">},</span>
 <span class="s1">&#39;0.16&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">5</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">7</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">9</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">11</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">13</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">15</span><span class="p">:</span> <span class="o">-</span><span class="mf">3.659</span><span class="p">,</span>
  <span class="mi">17</span><span class="p">:</span> <span class="o">-</span><span class="mf">3.207</span><span class="p">,</span>
  <span class="mi">19</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.8160000000000003</span><span class="p">,</span>
  <span class="mi">21</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.47</span><span class="p">,</span>
  <span class="mi">23</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.157</span><span class="p">,</span>
  <span class="mi">25</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.869</span><span class="p">,</span>
  <span class="mi">27</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.601</span><span class="p">,</span>
  <span class="mi">29</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.348</span><span class="p">,</span>
  <span class="mi">31</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.1079999999999999</span><span class="p">,</span>
  <span class="mi">33</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.8759999999999999</span><span class="p">,</span>
  <span class="mi">35</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.6509999999999999</span><span class="p">,</span>
  <span class="mi">37</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.43200000000000005</span><span class="p">,</span>
  <span class="mi">39</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.215</span><span class="p">,</span>
  <span class="mi">41</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
  <span class="mi">43</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">45</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">},</span>
 <span class="s1">&#39;0.18&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">5</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">7</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">9</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">11</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">13</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">15</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">17</span><span class="p">:</span> <span class="o">-</span><span class="mf">3.16</span><span class="p">,</span>
  <span class="mi">19</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.765</span><span class="p">,</span>
  <span class="mi">21</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.414</span><span class="p">,</span>
  <span class="mi">23</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.097</span><span class="p">,</span>
  <span class="mi">25</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.805</span><span class="p">,</span>
  <span class="mi">27</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.5319999999999998</span><span class="p">,</span>
  <span class="mi">29</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.274</span><span class="p">,</span>
  <span class="mi">31</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.028</span><span class="p">,</span>
  <span class="mi">33</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.7909999999999999</span><span class="p">,</span>
  <span class="mi">35</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.561</span><span class="p">,</span>
  <span class="mi">37</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.335</span><span class="p">,</span>
  <span class="mi">39</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.111</span><span class="p">,</span>
  <span class="mi">41</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">43</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">45</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">},</span>
 <span class="s1">&#39;0.20&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">5</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">7</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">9</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">11</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">13</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">15</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">17</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">19</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.7089999999999996</span><span class="p">,</span>
  <span class="mi">21</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.354</span><span class="p">,</span>
  <span class="mi">23</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.032</span><span class="p">,</span>
  <span class="mi">25</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.735</span><span class="p">,</span>
  <span class="mi">27</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.4580000000000002</span><span class="p">,</span>
  <span class="mi">29</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.195</span><span class="p">,</span>
  <span class="mi">31</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.9440000000000001</span><span class="p">,</span>
  <span class="mi">33</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.701</span><span class="p">,</span>
  <span class="mi">35</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.46399999999999997</span><span class="p">,</span>
  <span class="mi">37</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.231</span><span class="p">,</span>
  <span class="mi">39</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.0</span><span class="p">,</span>
  <span class="mi">41</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">43</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">45</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">},</span>
 <span class="s1">&#39;0.22&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">5</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">7</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">9</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">11</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">13</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">15</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">17</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">19</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">21</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.289</span><span class="p">,</span>
  <span class="mi">23</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.963</span><span class="p">,</span>
  <span class="mi">25</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.661</span><span class="p">,</span>
  <span class="mi">27</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.3780000000000001</span><span class="p">,</span>
  <span class="mi">29</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.11</span><span class="p">,</span>
  <span class="mi">31</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.853</span><span class="p">,</span>
  <span class="mi">33</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.604</span><span class="p">,</span>
  <span class="mi">35</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.36</span><span class="p">,</span>
  <span class="mi">37</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.12</span><span class="p">,</span>
  <span class="mi">39</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">41</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">43</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">45</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">},</span>
 <span class="s1">&#39;0.24&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">5</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">7</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">9</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">11</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">13</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">15</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">17</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">19</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">21</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">23</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.8880000000000001</span><span class="p">,</span>
  <span class="mi">25</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.5819999999999999</span><span class="p">,</span>
  <span class="mi">27</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.294</span><span class="p">,</span>
  <span class="mi">29</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.02</span><span class="p">,</span>
  <span class="mi">31</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.7559999999999999</span><span class="p">,</span>
  <span class="mi">33</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span>
  <span class="mi">35</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.249</span><span class="p">,</span>
  <span class="mi">37</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
  <span class="mi">39</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">41</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">43</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">45</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">},</span>
 <span class="s1">&#39;0.26&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">5</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">7</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">9</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">11</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">13</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">15</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">17</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">19</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">21</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">23</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">25</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.4969999999999999</span><span class="p">,</span>
  <span class="mi">27</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.203</span><span class="p">,</span>
  <span class="mi">29</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.9229999999999999</span><span class="p">,</span>
  <span class="mi">31</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.653</span><span class="p">,</span>
  <span class="mi">33</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.389</span><span class="p">,</span>
  <span class="mi">35</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.129</span><span class="p">,</span>
  <span class="mi">37</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">39</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">41</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">43</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">45</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">},</span>
 <span class="s1">&#39;0.28&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">5</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">7</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">9</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">11</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">13</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">15</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">17</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">19</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">21</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">23</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">25</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">27</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.1059999999999999</span><span class="p">,</span>
  <span class="mi">29</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.8190000000000001</span><span class="p">,</span>
  <span class="mi">31</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.541</span><span class="p">,</span>
  <span class="mi">33</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.26899999999999996</span><span class="p">,</span>
  <span class="mi">35</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
  <span class="mi">37</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">39</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">41</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">43</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">45</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">},</span>
 <span class="s1">&#39;0.30&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">5</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">7</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">9</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">11</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">13</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">15</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">17</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">19</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">21</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">23</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">25</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">27</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">29</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.708</span><span class="p">,</span>
  <span class="mi">31</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.42100000000000004</span><span class="p">,</span>
  <span class="mi">33</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.14</span><span class="p">,</span>
  <span class="mi">35</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">37</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">39</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">41</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">43</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">45</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">},</span>
 <span class="s1">&#39;0.32&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">5</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">7</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">9</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">11</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">13</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">15</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">17</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">19</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">21</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">23</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">25</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">27</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">29</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">31</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.292</span><span class="p">,</span>
  <span class="mi">33</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
  <span class="mi">35</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">37</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">39</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">41</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">43</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="mi">45</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">}}</span>
    <span class="n">k1_df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">k1_dict</span><span class="p">)</span>
    <span class="n">k2_df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">k2_dict</span><span class="p">)</span>
    <span class="n">w1</span><span class="p">,</span> <span class="n">w2</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span>
    <span class="n">wstart</span><span class="p">,</span> <span class="n">incr</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.02</span>
    <span class="k">if</span> <span class="n">w1i</span> <span class="o">&lt;</span> <span class="n">wstart</span><span class="p">:</span>
        <span class="n">w1</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%4.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">wstart</span> <span class="o">+</span> <span class="n">incr</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span>
        <span class="n">w1</span> <span class="o">=</span> <span class="nb">round</span><span class="p">((</span><span class="n">wstart</span> <span class="o">+</span> <span class="n">incr</span><span class="o">/</span><span class="mf">2.</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">w2i</span> <span class="o">&lt;</span> <span class="n">wstart</span><span class="p">:</span>
        <span class="n">w2</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%4.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">wstart</span> <span class="o">+</span> <span class="n">incr</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span>
        <span class="n">w2</span> <span class="o">=</span> <span class="nb">round</span><span class="p">((</span><span class="n">wstart</span> <span class="o">+</span> <span class="n">incr</span><span class="o">/</span><span class="mf">2.</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">wnext</span> <span class="o">=</span> <span class="n">wstart</span> <span class="o">+</span> <span class="n">incr</span>
    <span class="k">while</span> <span class="n">wstart</span> <span class="o">&lt;</span> <span class="mf">0.5</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">w1i</span> <span class="o">&gt;=</span> <span class="n">wstart</span> <span class="ow">and</span> <span class="n">w1i</span> <span class="o">&lt;</span> <span class="n">wnext</span><span class="p">:</span>
            <span class="n">w1</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%4.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">wstart</span> <span class="o">+</span> <span class="n">incr</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span>
            <span class="n">w1</span> <span class="o">=</span> <span class="nb">round</span><span class="p">((</span><span class="n">wstart</span> <span class="o">+</span> <span class="n">incr</span><span class="o">/</span><span class="mf">2.</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">w2i</span> <span class="o">&gt;=</span> <span class="n">wstart</span> <span class="ow">and</span> <span class="n">w2i</span> <span class="o">&lt;</span> <span class="n">wnext</span><span class="p">:</span>
            <span class="n">w2</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%4.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">wstart</span> <span class="o">+</span> <span class="n">incr</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span>
            <span class="n">w2</span> <span class="o">=</span> <span class="nb">round</span><span class="p">((</span><span class="n">wstart</span> <span class="o">+</span> <span class="n">incr</span><span class="o">/</span><span class="mf">2.</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">wstart</span> <span class="o">+=</span> <span class="n">incr</span>
        <span class="n">wnext</span> <span class="o">+=</span> <span class="n">incr</span>
    <span class="n">wnext</span> <span class="o">=</span> <span class="n">wstart</span> <span class="o">+</span> <span class="n">incr</span>
    <span class="n">k1</span><span class="o">=</span><span class="n">k1_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">k1_df</span><span class="p">[</span><span class="s1">&#39;w2&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">w2</span><span class="p">][</span><span class="nb">str</span><span class="p">(</span><span class="n">w1</span><span class="p">)]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">k2</span><span class="o">=</span><span class="n">k2_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">k2_df</span><span class="p">[</span><span class="s1">&#39;w2&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">w2</span><span class="p">][</span><span class="nb">str</span><span class="p">(</span><span class="n">w1</span><span class="p">)]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">k1</span><span class="p">,</span><span class="n">k2</span></div>

<div class="viewcode-block" id="binglookup_old"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.binglookup_old">[docs]</a><span class="k">def</span> <span class="nf">binglookup_old</span><span class="p">(</span><span class="n">w1i</span><span class="p">,</span> <span class="n">w2i</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Bingham statistics lookup table.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">K</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;0.06&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;0i.02&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-25.58&#39;</span><span class="p">,</span> <span class="s1">&#39;-8.996&#39;</span><span class="p">],</span> <span class="s1">&#39;0.06&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-9.043&#39;</span><span class="p">,</span> <span class="s1">&#39;-9.043&#39;</span><span class="p">],</span> <span class="s1">&#39;0.04&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-13.14&#39;</span><span class="p">,</span> <span class="s1">&#39;-9.019&#39;</span><span class="p">]},</span> <span class="s1">&#39;0.22&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;0.08&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-6.944&#39;</span><span class="p">,</span> <span class="s1">&#39;-2.644&#39;</span><span class="p">],</span> <span class="s1">&#39;0.02&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-25.63&#39;</span><span class="p">,</span> <span class="s1">&#39;-2.712&#39;</span><span class="p">],</span> <span class="s1">&#39;0.20&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-2.649&#39;</span><span class="p">,</span> <span class="s1">&#39;-2.354&#39;</span><span class="p">],</span> <span class="s1">&#39;0.06&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-9.027&#39;</span><span class="p">,</span> <span class="s1">&#39;-2.673&#39;</span><span class="p">],</span> <span class="s1">&#39;0.04&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-13.17&#39;</span><span class="p">,</span> <span class="s1">&#39;-2.695&#39;</span><span class="p">],</span> <span class="s1">&#39;0.14&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-4.071&#39;</span><span class="p">,</span> <span class="s1">&#39;-2.521&#39;</span><span class="p">],</span> <span class="s1">&#39;0.16&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-3.518&#39;</span><span class="p">,</span> <span class="s1">&#39;-2.470&#39;</span><span class="p">],</span> <span class="s1">&#39;0.10&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-5.658&#39;</span><span class="p">,</span> <span class="s1">&#39;-2.609&#39;</span><span class="p">],</span> <span class="s1">&#39;0.12&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-4.757&#39;</span><span class="p">,</span> <span class="s1">&#39;-2.568&#39;</span><span class="p">],</span> <span class="s1">&#39;0.18&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-3.053&#39;</span><span class="p">,</span> <span class="s1">&#39;-2.414&#39;</span><span class="p">],</span> <span class="s1">&#39;0.22&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-2.289&#39;</span><span class="p">,</span> <span class="s1">&#39;-2.289&#39;</span><span class="p">]},</span> <span class="s1">&#39;0.46&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;0.02&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-25.12&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.250&#39;</span><span class="p">],</span> <span class="s1">&#39;0.08&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-6.215&#39;</span><span class="p">,</span> <span class="s1">&#39;0.000&#39;</span><span class="p">],</span> <span class="s1">&#39;0.06&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-8.371&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.090&#39;</span><span class="p">],</span> <span class="s1">&#39;0.04&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-12.58&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.173&#39;</span><span class="p">]},</span> <span class="s1">&#39;0.44&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;0.08&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-6.305&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.186&#39;</span><span class="p">],</span> <span class="s1">&#39;0.02&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-25.19&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.418&#39;</span><span class="p">],</span> <span class="s1">&#39;0.06&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-8.454&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.270&#39;</span><span class="p">],</span> <span class="s1">&#39;0.04&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-12.66&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.347&#39;</span><span class="p">],</span> <span class="s1">&#39;0.10&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-4.955&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.097&#39;</span><span class="p">],</span> <span class="s1">&#39;0.12&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-3.992&#39;</span><span class="p">,</span> <span class="s1">&#39;0.000&#39;</span><span class="p">]},</span> <span class="s1">&#39;0.42&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;0.08&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-6.388&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.374&#39;</span><span class="p">],</span> <span class="s1">&#39;0.02&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-25.5&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.589&#39;</span><span class="p">],</span> <span class="s1">&#39;0.06&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-8.532&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.452&#39;</span><span class="p">],</span> <span class="s1">&#39;0.04&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-12.73&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.523&#39;</span><span class="p">],</span> <span class="s1">&#39;0.14&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-3.349&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.104&#39;</span><span class="p">],</span> <span class="s1">&#39;0.16&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-2.741&#39;</span><span class="p">,</span> <span class="s1">&#39;0.000&#39;</span><span class="p">],</span> <span class="s1">&#39;0.10&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-5.045&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.290&#39;</span><span class="p">],</span> <span class="s1">&#39;0.12&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-4.089&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.200&#39;</span><span class="p">]},</span> <span class="s1">&#39;0.40&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;0.08&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-6.466&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.564&#39;</span><span class="p">],</span> <span class="s1">&#39;0.02&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-25.31&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.762&#39;</span><span class="p">],</span> <span class="s1">&#39;0.20&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-1.874&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.000&#39;</span><span class="p">],</span> <span class="s1">&#39;0.06&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-8.604&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.636&#39;</span><span class="p">],</span> <span class="s1">&#39;0.04&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-12.80&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.702&#39;</span><span class="p">],</span> <span class="s1">&#39;0.14&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-3.446&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.312&#39;</span><span class="p">],</span> <span class="s1">&#39;0.16&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-2.845&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.215&#39;</span><span class="p">],</span> <span class="s1">&#39;0.10&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-5.126&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.486&#39;</span><span class="p">],</span> <span class="s1">&#39;0.12&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-4.179&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.402&#39;</span><span class="p">],</span> <span class="s1">&#39;0.18&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-2.330&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.111&#39;</span><span class="p">]},</span> <span class="s1">&#39;0.08&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;0.02&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-25.6&#39;</span><span class="p">,</span> <span class="s1">&#39;-6.977&#39;</span><span class="p">],</span> <span class="s1">&#39;0.08&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-7.035&#39;</span><span class="p">,</span> <span class="s1">&#39;-7.035&#39;</span><span class="p">],</span> <span class="s1">&#39;0.06&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-9.065&#39;</span><span class="p">,</span> <span class="s1">&#39;-7.020&#39;</span><span class="p">],</span> <span class="s1">&#39;0.04&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-13.16&#39;</span><span class="p">,</span> <span class="s1">&#39;-6.999&#39;</span><span class="p">]},</span> <span class="s1">&#39;0.28&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;0.08&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-6.827&#39;</span><span class="p">,</span> <span class="s1">&#39;-1.828&#39;</span><span class="p">],</span> <span class="s1">&#39;0.28&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-1.106&#39;</span><span class="p">,</span> <span class="s1">&#39;-1.106&#39;</span><span class="p">],</span> <span class="s1">&#39;0.02&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-25.57&#39;</span><span class="p">,</span> <span class="s1">&#39;-1.939&#39;</span><span class="p">],</span> <span class="s1">&#39;0.20&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-2.441&#39;</span><span class="p">,</span> <span class="s1">&#39;-1.458&#39;</span><span class="p">],</span> <span class="s1">&#39;0.26&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-1.406&#39;</span><span class="p">,</span> <span class="s1">&#39;-1.203&#39;</span><span class="p">],</span> <span class="s1">&#39;0.24&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-1.724&#39;</span><span class="p">,</span> <span class="s1">&#39;-1.294&#39;</span><span class="p">],</span> <span class="s1">&#39;0.06&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-8.928&#39;</span><span class="p">,</span> <span class="s1">&#39;-1.871&#39;</span><span class="p">],</span> <span class="s1">&#39;0.04&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-13.09&#39;</span><span class="p">,</span> <span class="s1">&#39;-1.908&#39;</span><span class="p">],</span> <span class="s1">&#39;0.14&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-3.906&#39;</span><span class="p">,</span> <span class="s1">&#39;-1.665&#39;</span><span class="p">],</span> <span class="s1">&#39;0.16&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-3.338&#39;</span><span class="p">,</span> <span class="s1">&#39;-1.601&#39;</span><span class="p">],</span> <span class="s1">&#39;0.10&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-5.523&#39;</span><span class="p">,</span> <span class="s1">&#39;-1.779&#39;</span><span class="p">],</span> <span class="s1">&#39;0.12&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-4.606&#39;</span><span class="p">,</span> <span class="s1">&#39;-1.725&#39;</span><span class="p">],</span> <span class="s1">&#39;0.18&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-2.859&#39;</span><span class="p">,</span> <span class="s1">&#39;-1.532&#39;</span><span class="p">],</span> <span class="s1">&#39;0.22&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-2.066&#39;</span><span class="p">,</span> <span class="s1">&#39;-1.378&#39;</span><span class="p">]},</span> <span class="s1">&#39;0.02&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;0.02&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-25.55&#39;</span><span class="p">,</span> <span class="s1">&#39;-25.55&#39;</span><span class="p">]},</span> <span class="s1">&#39;0.26&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;0.08&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-6.870&#39;</span><span class="p">,</span> <span class="s1">&#39;-2.078&#39;</span><span class="p">],</span> <span class="s1">&#39;0.02&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-25.59&#39;</span><span class="p">,</span> <span class="s1">&#39;-2.175&#39;</span><span class="p">],</span> <span class="s1">&#39;0.20&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-2.515&#39;</span><span class="p">,</span> <span class="s1">&#39;-1.735&#39;</span><span class="p">],</span> <span class="s1">&#39;0.26&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-1.497&#39;</span><span class="p">,</span> <span class="s1">&#39;-1.497&#39;</span><span class="p">],</span> <span class="s1">&#39;0.24&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-1.809&#39;</span><span class="p">,</span> <span class="s1">&#39;-1.582&#39;</span><span class="p">],</span> <span class="s1">&#39;0.06&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-8.96 6&#39;</span><span class="p">,</span> <span class="s1">&#39;-2.117&#39;</span><span class="p">],</span> <span class="s1">&#39;0.04&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-13.12&#39;</span><span class="p">,</span> <span class="s1">&#39;-2.149&#39;</span><span class="p">],</span> <span class="s1">&#39;0.14&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-3.965&#39;</span><span class="p">,</span> <span class="s1">&#39;-1.929&#39;</span><span class="p">],</span> <span class="s1">&#39;0.16&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-3.403&#39;</span><span class="p">,</span> <span class="s1">&#39;-1.869&#39;</span><span class="p">],</span> <span class="s1">&#39;0.10&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-5.573&#39;</span><span class="p">,</span> <span class="s1">&#39;-2.034&#39;</span><span class="p">],</span> <span class="s1">&#39;0.12&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-4.661&#39;</span><span class="p">,</span> <span class="s1">&#39;-1.984&#39;</span><span class="p">],</span> <span class="s1">&#39;0.18&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-2.928&#39;</span><span class="p">,</span> <span class="s1">&#39;-1.805&#39;</span><span class="p">],</span> <span class="s1">&#39;0.22&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-2.1 46&#39;</span><span class="p">,</span> <span class="s1">&#39;-1.661&#39;</span><span class="p">]},</span> <span class="s1">&#39;0.20&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;0.08&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-6.974&#39;</span><span class="p">,</span> <span class="s1">&#39;-2.973&#39;</span><span class="p">],</span> <span class="s1">&#39;0.02&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-25.64&#39;</span><span class="p">,</span> <span class="s1">&#39;-3.025&#39;</span><span class="p">],</span> <span class="s1">&#39;0.20&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-2.709&#39;</span><span class="p">,</span> <span class="s1">&#39;-2.709&#39;</span><span class="p">],</span> <span class="s1">&#39;0.06&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-9.05&#39;</span><span class="p">,</span> <span class="s1">&#39;-2.997&#39;</span><span class="p">],</span> <span class="s1">&#39;0.04&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-13.18&#39;</span><span class="p">,</span> <span class="s1">&#39;-3.014&#39;</span><span class="p">],</span> <span class="s1">&#39;0.14&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-4.118&#39;</span><span class="p">,</span> <span class="s1">&#39;-2.863&#39;</span><span class="p">],</span> <span class="s1">&#39;0.1 6&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-3.570&#39;</span><span class="p">,</span> <span class="s1">&#39;-2.816&#39;</span><span class="p">],</span> <span class="s1">&#39;0.10&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-5.694&#39;</span><span class="p">,</span> <span class="s1">&#39;-2.942&#39;</span><span class="p">],</span> <span class="s1">&#39;0.12&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-4.799&#39;</span><span class="p">,</span> <span class="s1">&#39;-2.905&#39;</span><span class="p">],</span> <span class="s1">&#39;0.18&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-3.109&#39;</span><span class="p">,</span> <span class="s1">&#39;-2.765&#39;</span><span class="p">]},</span> <span class="s1">&#39;0.04&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;0.02&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-25.56&#39;</span><span class="p">,</span> <span class="s1">&#39;-13.09&#39;</span><span class="p">],</span> <span class="s1">&#39;0.04&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-13.11&#39;</span><span class="p">,</span> <span class="s1">&#39;-13.11&#39;</span><span class="p">]},</span> <span class="s1">&#39;0.14&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;0.08&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-7.  033&#39;</span><span class="p">,</span> <span class="s1">&#39;-4.294&#39;</span><span class="p">],</span> <span class="s1">&#39;0.02&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-25.64&#39;</span><span class="p">,</span> <span class="s1">&#39;-4.295&#39;</span><span class="p">],</span> <span class="s1">&#39;0.06&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-9.087&#39;</span><span class="p">,</span> <span class="s1">&#39;-4.301&#39;</span><span class="p">],</span> <span class="s1">&#39;0.04&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-13.20&#39;</span><span class="p">,</span> <span class="s1">&#39;-4.301&#39;</span><span class="p">],</span> <span class="s1">&#39;0.14&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-4.231&#39;</span><span class="p">,</span> <span class="s1">&#39;-4.231&#39;</span><span class="p">],</span> <span class="s1">&#39;0.10&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-5.773&#39;</span><span class="p">,</span> <span class="s1">&#39;-4.279&#39;</span><span class="p">],</span> <span class="s1">&#39;0.12&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-4.896&#39;</span><span class="p">,</span> <span class="s1">&#39;-4.258&#39;</span><span class="p">]},</span> <span class="s1">&#39;0.16&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;0 .08&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-7.019&#39;</span><span class="p">,</span> <span class="s1">&#39;-3.777&#39;</span><span class="p">],</span> <span class="s1">&#39;0.02&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-25.65&#39;</span><span class="p">,</span> <span class="s1">&#39;-3.796&#39;</span><span class="p">],</span> <span class="s1">&#39;0.06&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-9.081&#39;</span><span class="p">,</span> <span class="s1">&#39;-3.790&#39;</span><span class="p">],</span> <span class="s1">&#39;0.04&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-13.20&#39;</span><span class="p">,</span> <span class="s1">&#39;-3.796&#39;</span><span class="p">],</span> <span class="s1">&#39;0.14&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-4.198&#39;</span><span class="p">,</span> <span class="s1">&#39;-3.697&#39;</span><span class="p">],</span> <span class="s1">&#39;0.16&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-3.659&#39;</span><span class="p">,</span> <span class="s1">&#39;-3.659&#39;</span><span class="p">],</span> <span class="s1">&#39;0.10&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-5.752&#39;</span><span class="p">,</span> <span class="s1">&#39;-3.756&#39;</span><span class="p">],</span> <span class="s1">&#39; 0.12&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-4.868&#39;</span><span class="p">,</span> <span class="s1">&#39;-3.729&#39;</span><span class="p">]},</span> <span class="s1">&#39;0.10&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;0.02&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-25.62&#39;</span><span class="p">,</span> <span class="s1">&#39;-5.760&#39;</span><span class="p">],</span>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     <span class="s1">&#39;0.08&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-7.042&#39;</span><span class="p">,</span> <span class="s1">&#39;-5.798&#39;</span><span class="p">],</span> <span class="s1">&#39;0.06&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-9.080&#39;</span><span class="p">,</span> <span class="s1">&#39;-5.791&#39;</span><span class="p">],</span> <span class="s1">&#39;0.10&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-5.797&#39;</span><span class="p">,</span> <span class="s1">&#39;-5.797&#39;</span><span class="p">],</span> <span class="s1">&#39;0.04&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-13.18&#39;</span><span class="p">,</span> <span class="s1">&#39;-5.777&#39;</span><span class="p">]},</span> <span class="s1">&#39;0.12&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;0.08&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39; -7.041&#39;</span><span class="p">,</span> <span class="s1">&#39;-4.941&#39;</span><span class="p">],</span> <span class="s1">&#39;0.02&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-25.63&#39;</span><span class="p">,</span> <span class="s1">&#39;-4.923&#39;</span><span class="p">],</span> <span class="s1">&#39;0.06&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-9.087&#39;</span><span class="p">,</span> <span class="s1">&#39;-4.941&#39;</span><span class="p">],</span> <span class="s1">&#39;0.04&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-13.19&#39;</span><span class="p">,</span> <span class="s1">&#39;-4.934&#39;</span><span class="p">],</span> <span class="s1">&#39;0.10&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-5.789&#39;</span><span class="p">,</span> <span class="s1">&#39;-4.933&#39;</span><span class="p">],</span> <span class="s1">&#39;0.12&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-4.917&#39;</span><span class="p">,</span> <span class="s1">&#39;-4.917&#39;</span><span class="p">]},</span> <span class="s1">&#39;0.18&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;0.08&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-6.999&#39;</span><span class="p">,</span> <span class="s1">&#39;-3.345&#39;</span><span class="p">],</span> <span class="s1">&#39;0.02&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-25.65&#39;</span><span class="p">,</span> <span class="s1">&#39;-3.381&#39;</span><span class="p">],</span> <span class="s1">&#39;0.06&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-9.068&#39;</span><span class="p">,</span> <span class="s1">&#39;-3.363&#39;</span><span class="p">],</span> <span class="s1">&#39;0.04&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-13.19&#39;</span><span class="p">,</span> <span class="s1">&#39;-3.375&#39;</span><span class="p">],</span> <span class="s1">&#39;0.14&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-4.160&#39;</span><span class="p">,</span> <span class="s1">&#39;-3.249&#39;</span><span class="p">],</span> <span class="s1">&#39;0.16&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-3.616&#39;</span><span class="p">,</span> <span class="s1">&#39;-3.207&#39;</span><span class="p">],</span> <span class="s1">&#39;0.10&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-5.726&#39;</span><span class="p">,</span> <span class="s1">&#39;-3.319&#39;</span><span class="p">],</span> <span class="s1">&#39;0.12&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-4.836&#39;</span><span class="p">,</span> <span class="s1">&#39;-3.287&#39;</span><span class="p">],</span> <span class="s1">&#39;0.18&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-3.160&#39;</span><span class="p">,</span> <span class="s1">&#39;-3.160&#39;</span><span class="p">]},</span> <span class="s1">&#39;0.38&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;0.08&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-6.539&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.757&#39;</span><span class="p">],</span> <span class="s1">&#39;0.02&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-25.37&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.940&#39;</span><span class="p">],</span> <span class="s1">&#39;0.20&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-1.986&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.231&#39;</span><span class="p">],</span> <span class="s1">&#39;0.24&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-1.202&#39;</span><span class="p">,</span> <span class="s1">&#39;0.000&#39;</span><span class="p">],</span> <span class="s1">&#39;0.06&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-8.670&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.824&#39;</span><span class="p">],</span> <span class="s1">&#39;0.04&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-12.86&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.885&#39;</span><span class="p">],</span> <span class="s1">&#39;0.14&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-3.536&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.522&#39;</span><span class="p">],</span> <span class="s1">&#39;0.16&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-2.941&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.432&#39;</span><span class="p">],</span> <span class="s1">&#39;0.10&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-5.207&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.684&#39;</span><span class="p">],</span> <span class="s1">&#39;0.12&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-4.263&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.606&#39;</span><span class="p">],</span> <span class="s1">&#39;0.18&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-2.434&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.335&#39;</span><span class="p">],</span> <span class="s1">&#39;0.22&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-1.579&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.120&#39;</span><span class="p">]},</span> <span class="s1">&#39;0.36&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;0.08&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-6.606&#39;</span><span class="p">,</span> <span class="s1">&#39;-9.555&#39;</span><span class="p">],</span> <span class="s1">&#39;0.28&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-0.642&#39;</span><span class="p">,</span> <span class="s1">&#39;0.000&#39;</span><span class="p">],</span> <span class="s1">&#39;0.02&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-25.42&#39;</span><span class="p">,</span> <span class="s1">&#39;-1.123&#39;</span><span class="p">],</span> <span class="s1">&#39;0.20&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-2.089&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.464&#39;</span><span class="p">],</span> <span class="s1">&#39;0.26&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-0.974&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.129&#39;</span><span class="p">],</span> <span class="s1">&#39;0.24&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-1.322&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.249&#39;</span><span class="p">],</span> <span class="s1">&#39;0.06&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-8.731&#39;</span><span class="p">,</span> <span class="s1">&#39;-1.017&#39;</span><span class="p">],</span> <span class="s1">&#39;0.04&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-12.91&#39;</span><span class="p">,</span> <span class="s1">&#39;-1.073&#39;</span><span class="p">],</span> <span class="s1">&#39;0.14&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-3.620&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.736&#39;</span><span class="p">],</span> <span class="s1">&#39;0.16&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-3.032&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.651&#39;</span><span class="p">],</span> <span class="s1">&#39;0.10&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-5.280&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.887&#39;</span><span class="p">],</span> <span class="s1">&#39;0.12&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-4.342&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.814&#39;</span><span class="p">],</span> <span class="s1">&#39;0.18&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-2.531&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.561&#39;</span><span class="p">],</span> <span class="s1">&#39;0.22&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-1.690&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.360&#39;</span><span class="p">]},</span> <span class="s1">&#39;0.34 &#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;0.08&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-6.668&#39;</span><span class="p">,</span> <span class="s1">&#39;-1.159&#39;</span><span class="p">],</span> <span class="s1">&#39;0.28&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-0.771&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.269&#39;</span><span class="p">],</span> <span class="s1">&#39;0.02&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-25.46&#39;</span><span class="p">,</span> <span class="s1">&#39;-1.312&#39;</span><span class="p">],</span> <span class="s1">&#39;0.20&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-2.186&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.701&#39;</span><span class="p">],</span> <span class="s1">&#39;0.26&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-1.094&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.389&#39;</span><span class="p">],</span> <span class="s1">&#39;0.24&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-1.433&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.500&#39;</span><span class="p">],</span> <span class="s1">&#39;0.06&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-8.788&#39;</span><span class="p">,</span> <span class="s1">&#39;-1.21 6&#39;</span><span class="p">],</span> <span class="s1">&#39;0.32&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-0.152&#39;</span><span class="p">,</span> <span class="s1">&#39;0.000&#39;</span><span class="p">],</span> <span class="s1">&#39;0.04&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-12.96&#39;</span><span class="p">,</span> <span class="s1">&#39;-1.267&#39;</span><span class="p">],</span> <span class="s1">&#39;0.30&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-0.459&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.140&#39;</span><span class="p">],</span> <span class="s1">&#39;0.14&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-3.699&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.955&#39;</span><span class="p">],</span> <span class="s1">&#39;0.16&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-3.116&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.876&#39;</span><span class="p">],</span> <span class="s1">&#39;0.10&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-5.348&#39;</span><span class="p">,</span> <span class="s1">&#39;-1.096&#39;</span><span class="p">],</span> <span class="s1">&#39;0.12&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-4.415&#39;</span><span class="p">,</span> <span class="s1">&#39;-1.02 8&#39;</span><span class="p">],</span> <span class="s1">&#39;0.18&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-2.621&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.791&#39;</span><span class="p">],</span> <span class="s1">&#39;0.22&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-1.794&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.604&#39;</span><span class="p">]},</span> <span class="s1">&#39;0.32&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;0.08&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-6.725&#39;</span><span class="p">,</span> <span class="s1">&#39;-1.371&#39;</span><span class="p">],</span> <span class="s1">&#39;0.28&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-0.891&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.541&#39;</span><span class="p">],</span> <span class="s1">&#39;0.02&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-25.50&#39;</span><span class="p">,</span> <span class="s1">&#39;-1.510&#39;</span><span class="p">],</span> <span class="s1">&#39;0.20&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-2.277&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.944&#39;</span><span class="p">],</span> <span class="s1">&#39;0.26&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-1.2 06&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.653&#39;</span><span class="p">],</span> <span class="s1">&#39;0.24&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-1.537&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.756&#39;</span><span class="p">],</span> <span class="s1">&#39;0.06&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-8.839&#39;</span><span class="p">,</span> <span class="s1">&#39;-1.423&#39;</span><span class="p">],</span> <span class="s1">&#39;0.32&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-0.292&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.292&#39;</span><span class="p">],</span> <span class="s1">&#39;0.04&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-13.01&#39;</span><span class="p">,</span> <span class="s1">&#39;-1.470&#39;</span><span class="p">],</span> <span class="s1">&#39;0.30&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-0.588&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.421&#39;</span><span class="p">],</span> <span class="s1">&#39;0.14&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-3.773&#39;</span><span class="p">,</span> <span class="s1">&#39;-1.181&#39;</span><span class="p">],</span> <span class="s1">&#39;0.16&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-3.  195&#39;</span><span class="p">,</span> <span class="s1">&#39;-1.108&#39;</span><span class="p">],</span> <span class="s1">&#39;0.10&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-5.411&#39;</span><span class="p">,</span> <span class="s1">&#39;-1.313&#39;</span><span class="p">],</span> <span class="s1">&#39;0.12&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-4.484&#39;</span><span class="p">,</span> <span class="s1">&#39;-1.250&#39;</span><span class="p">],</span> <span class="s1">&#39;0.18&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-2.706&#39;</span><span class="p">,</span> <span class="s1">&#39;-1.028&#39;</span><span class="p">],</span> <span class="s1">&#39;0.22&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-1.891&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.853&#39;</span><span class="p">]},</span> <span class="s1">&#39;0.30&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;0.08&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-6.778&#39;</span><span class="p">,</span> <span class="s1">&#39;-1.596&#39;</span><span class="p">],</span> <span class="s1">&#39;0.28&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-1.002&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.819&#39;</span><span class="p">],</span> <span class="s1">&#39;0 .02&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-25.54&#39;</span><span class="p">,</span> <span class="s1">&#39;-1.718&#39;</span><span class="p">],</span> <span class="s1">&#39;0.20&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-2.361&#39;</span><span class="p">,</span> <span class="s1">&#39;-1.195&#39;</span><span class="p">],</span> <span class="s1">&#39;0.26&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-1.309&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.923&#39;</span><span class="p">],</span> <span class="s1">&#39;0.24&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-1.634&#39;</span><span class="p">,</span> <span class="s1">&#39;-1.020&#39;</span><span class="p">],</span> <span class="s1">&#39;0.06&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-8.886&#39;</span><span class="p">,</span> <span class="s1">&#39;-1.641&#39;</span><span class="p">],</span> <span class="s1">&#39;0.04&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-13.05&#39;</span><span class="p">,</span> <span class="s1">&#39;-1.682&#39;</span><span class="p">],</span> <span class="s1">&#39;0.30&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-0.708&#39;</span><span class="p">,</span> <span class="s1">&#39;-0.708&#39;</span><span class="p">],</span> <span class="s1">&#39; 0.14&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-3.842&#39;</span><span class="p">,</span> <span class="s1">&#39;-1.417&#39;</span><span class="p">],</span> <span class="s1">&#39;0.16&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-3.269&#39;</span><span class="p">,</span> <span class="s1">&#39;-1.348&#39;</span><span class="p">],</span> <span class="s1">&#39;0.10&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-5.469&#39;</span><span class="p">,</span> <span class="s1">&#39;-1.540&#39;</span><span class="p">],</span> <span class="s1">&#39;0.12&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-4.547&#39;</span><span class="p">,</span> <span class="s1">&#39;-1.481&#39;</span><span class="p">],</span> <span class="s1">&#39;0.18&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-2.785&#39;</span><span class="p">,</span> <span class="s1">&#39;-1.274&#39;</span><span class="p">],</span> <span class="s1">&#39;0.22&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-1.981&#39;</span><span class="p">,</span> <span class="s1">&#39;-1.110&#39;</span><span class="p">]},</span> <span class="s1">&#39;0.24&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;0.08&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-6.910&#39;</span><span class="p">,</span> <span class="s1">&#39; -2.349&#39;</span><span class="p">],</span> <span class="s1">&#39;0.02&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-25.61&#39;</span><span class="p">,</span> <span class="s1">&#39;-2.431&#39;</span><span class="p">],</span> <span class="s1">&#39;0.20&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-2.584&#39;</span><span class="p">,</span> <span class="s1">&#39;-2.032&#39;</span><span class="p">],</span> <span class="s1">&#39;0.24&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-1.888&#39;</span><span class="p">,</span> <span class="s1">&#39;-1.888&#39;</span><span class="p">],</span> <span class="s1">&#39;0.06&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-8.999&#39;</span><span class="p">,</span> <span class="s1">&#39;-2.382&#39;</span><span class="p">],</span> <span class="s1">&#39;0.04&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-23.14&#39;</span><span class="p">,</span> <span class="s1">&#39;-2.410&#39;</span><span class="p">],</span> <span class="s1">&#39;0.14&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-4.021&#39;</span><span class="p">,</span> <span class="s1">&#39;-2.212&#39;</span><span class="p">],</span> <span class="s1">&#39;0.16&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-3.463&#39;</span><span class="p">,</span> <span class="s1">&#39;-2.157&#39;</span><span class="p">],</span> <span class="s1">&#39;0.10&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-5.618&#39;</span><span class="p">,</span> <span class="s1">&#39;-2.309&#39;</span><span class="p">],</span> <span class="s1">&#39;0.12&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-4.711&#39;</span><span class="p">,</span> <span class="s1">&#39;-2.263&#39;</span><span class="p">],</span> <span class="s1">&#39;0.18&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-2.993&#39;</span><span class="p">,</span> <span class="s1">&#39;-2.097&#39;</span><span class="p">],</span> <span class="s1">&#39;0.22&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;-2.220&#39;</span><span class="p">,</span> <span class="s1">&#39;-1.963&#39;</span><span class="p">]}}</span>
    <span class="n">w1</span><span class="p">,</span> <span class="n">w2</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">w1i</span><span class="p">,</span><span class="n">w2i</span><span class="p">)</span>
    <span class="n">wstart</span><span class="p">,</span> <span class="n">incr</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.02</span>
    <span class="k">if</span> <span class="n">w1i</span> <span class="o">&lt;</span> <span class="n">wstart</span><span class="p">:</span>
        <span class="n">w1</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%4.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">wstart</span> <span class="o">+</span> <span class="n">incr</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">w2i</span> <span class="o">&lt;</span> <span class="n">wstart</span><span class="p">:</span>
        <span class="n">w2</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%4.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">wstart</span> <span class="o">+</span> <span class="n">old_div</span><span class="p">(</span><span class="n">incr</span><span class="p">,</span> <span class="mf">2.</span><span class="p">))</span>
    <span class="n">wnext</span> <span class="o">=</span> <span class="n">wstart</span> <span class="o">+</span> <span class="n">incr</span>
    <span class="k">while</span> <span class="n">wstart</span> <span class="o">&lt;</span> <span class="mf">0.5</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">w1i</span> <span class="o">&gt;=</span> <span class="n">wstart</span> <span class="ow">and</span> <span class="n">w1i</span> <span class="o">&lt;</span> <span class="n">wnext</span><span class="p">:</span>
            <span class="n">w1</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%4.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">wstart</span> <span class="o">+</span> <span class="n">old_div</span><span class="p">(</span><span class="n">incr</span><span class="p">,</span> <span class="mf">2.</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">w2i</span> <span class="o">&gt;=</span> <span class="n">wstart</span> <span class="ow">and</span> <span class="n">w2i</span> <span class="o">&lt;</span> <span class="n">wnext</span><span class="p">:</span>
            <span class="n">w2</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%4.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">wstart</span> <span class="o">+</span> <span class="n">old_div</span><span class="p">(</span><span class="n">incr</span><span class="p">,</span> <span class="mf">2.</span><span class="p">))</span>
        <span class="n">wstart</span> <span class="o">+=</span> <span class="n">incr</span>
        <span class="n">wnext</span> <span class="o">+=</span> <span class="n">incr</span>
    <span class="n">wnext</span> <span class="o">=</span> <span class="n">wstart</span> <span class="o">+</span> <span class="n">incr</span>
    <span class="n">k1</span><span class="p">,</span> <span class="n">k2</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">K</span><span class="p">[</span><span class="n">w2</span><span class="p">][</span><span class="n">w1</span><span class="p">][</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">K</span><span class="p">[</span><span class="n">w2</span><span class="p">][</span><span class="n">w1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">k1</span><span class="p">,</span> <span class="n">k2</span></div>


<div class="viewcode-block" id="cdfout"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.cdfout">[docs]</a><span class="k">def</span> <span class="nf">cdfout</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">file</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    spits out the cdf for data to file</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
    <span class="n">data</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">old_div</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">j</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)))</span>
        <span class="n">out</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
    <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


<div class="viewcode-block" id="dobingham"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.dobingham">[docs]</a><span class="k">def</span> <span class="nf">dobingham</span><span class="p">(</span><span class="n">di_block</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the Bingham mean and associated statistical parameters from</span>
<span class="sd">    directions that are input as a di_block.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    di_block : a nested list of [dec,inc] or [dec,inc,intensity]</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    bpars : dictionary containing the Bingham mean and associated statistics</span>
<span class="sd">    dictionary keys</span>
<span class="sd">        dec : mean declination</span>
<span class="sd">        inc : mean inclination</span>
<span class="sd">        n : number of datapoints</span>
<span class="sd">        Eta : major ellipse</span>
<span class="sd">        Edec : declination of major ellipse axis</span>
<span class="sd">        Einc : inclination of major ellipse axis</span>
<span class="sd">        Zeta : minor ellipse</span>
<span class="sd">        Zdec : declination of minor ellipse axis</span>
<span class="sd">        Zinc : inclination of minor ellipse axis</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">control</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">bpars</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">{}</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">di_block</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">N</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">bpars</span>
<span class="c1">#</span>
<span class="c1">#  get cartesian coordinates</span>
<span class="c1">#</span>
    <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">di_block</span><span class="p">:</span>
        <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dir2cart</span><span class="p">([</span><span class="n">rec</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">rec</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mf">1.</span><span class="p">]))</span>
<span class="c1">#</span>
<span class="c1">#   put in T matrix</span>
<span class="c1">#</span>
    <span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Tmatrix</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
    <span class="n">t</span><span class="p">,</span> <span class="n">V</span> <span class="o">=</span> <span class="n">tauV</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">w1</span><span class="p">,</span> <span class="n">w2</span><span class="p">,</span> <span class="n">w3</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">k1</span><span class="p">,</span> <span class="n">k2</span> <span class="o">=</span> <span class="n">binglookup</span><span class="p">(</span><span class="n">w1</span><span class="p">,</span> <span class="n">w2</span><span class="p">)</span>
    <span class="n">PDir</span> <span class="o">=</span> <span class="n">cart2dir</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">EDir</span> <span class="o">=</span> <span class="n">cart2dir</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">ZDir</span> <span class="o">=</span> <span class="n">cart2dir</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">PDir</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">PDir</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">180.</span>
        <span class="n">PDir</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">PDir</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">PDir</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">PDir</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">%</span> <span class="mf">360.</span>
    <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;dec&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PDir</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;inc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PDir</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;Edec&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">EDir</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;Einc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">EDir</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;Zdec&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ZDir</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;Zinc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ZDir</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;n&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">N</span>
<span class="c1">#</span>
<span class="c1">#  now for Bingham ellipses.</span>
<span class="c1">#</span>
    <span class="n">fac1</span><span class="p">,</span> <span class="n">fac2</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">N</span> <span class="o">*</span> <span class="p">(</span><span class="n">k1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">w3</span> <span class="o">-</span> <span class="n">w1</span><span class="p">),</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">N</span> <span class="o">*</span> <span class="p">(</span><span class="n">k2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">w3</span> <span class="o">-</span> <span class="n">w2</span><span class="p">)</span>
    <span class="n">sig31</span><span class="p">,</span> <span class="n">sig32</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">old_div</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="n">fac1</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">old_div</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="n">fac2</span><span class="p">))</span>
    <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;Zeta&quot;</span><span class="p">],</span> <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;Eta&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.45</span> <span class="o">*</span> <span class="n">sig31</span> <span class="o">*</span> \
        <span class="mf">180.</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mf">2.45</span> <span class="o">*</span> <span class="n">sig32</span> <span class="o">*</span> <span class="mf">180.</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
    <span class="k">return</span> <span class="n">bpars</span></div>


<div class="viewcode-block" id="doflip"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.doflip">[docs]</a><span class="k">def</span> <span class="nf">doflip</span><span class="p">(</span><span class="n">dec</span><span class="p">,</span> <span class="n">inc</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Flips upper hemisphere data to lower hemisphere.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dec : float</span>
<span class="sd">        declination</span>
<span class="sd">    inc : float</span>
<span class="sd">        inclination</span>
<span class="sd">    </span>
<span class="sd">    Returns </span>
<span class="sd">    -------</span>
<span class="sd">    tuple</span>
<span class="sd">        containing the flipped declination and inclination </span>
<span class="sd">        </span>
<span class="sd">    Examples</span>
<span class="sd">    -------</span>
<span class="sd">    &gt;&gt;&gt; pmag.doflip(30,-45)</span>
<span class="sd">    (210.0, 45)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">inc</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">inc</span> <span class="o">=</span> <span class="o">-</span><span class="n">inc</span>
        <span class="n">dec</span> <span class="o">=</span> <span class="p">(</span><span class="n">dec</span> <span class="o">+</span> <span class="mf">180.</span><span class="p">)</span> <span class="o">%</span> <span class="mf">360.</span>
    <span class="k">return</span> <span class="n">dec</span><span class="p">,</span> <span class="n">inc</span></div>


<div class="viewcode-block" id="doreverse"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.doreverse">[docs]</a><span class="k">def</span> <span class="nf">doreverse</span><span class="p">(</span><span class="n">dec</span><span class="p">,</span> <span class="n">inc</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the antipode of a direction.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dec: float</span>
<span class="sd">        declination</span>
<span class="sd">    inc: float </span>
<span class="sd">        inclination</span>
<span class="sd">        </span>
<span class="sd">    Returns </span>
<span class="sd">    -------</span>
<span class="sd">    dec: float</span>
<span class="sd">        antipode of the declination</span>
<span class="sd">    inc: float </span>
<span class="sd">        antipode of the inclination</span>
<span class="sd">    </span>
<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; pmag.doreverse(30,45)</span>
<span class="sd">    (210.0, -45)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">inc</span> <span class="o">=</span> <span class="o">-</span><span class="n">inc</span>
    <span class="n">dec</span> <span class="o">=</span> <span class="p">(</span><span class="n">dec</span> <span class="o">+</span> <span class="mf">180.</span><span class="p">)</span> <span class="o">%</span> <span class="mf">360.</span>
    <span class="k">return</span> <span class="n">dec</span><span class="p">,</span> <span class="n">inc</span></div>


<div class="viewcode-block" id="doreverse_list"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.doreverse_list">[docs]</a><span class="k">def</span> <span class="nf">doreverse_list</span><span class="p">(</span><span class="n">decs</span><span class="p">,</span> <span class="n">incs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the antipode of list of directions.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    decs : list of declinations</span>
<span class="sd">    incs : list of inclinations</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    decs_flipped : antipode list of declinations</span>
<span class="sd">    incs_flipped : antipode list of inclinations</span>
<span class="sd">    </span>
<span class="sd">    Examples </span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; pmag.doreverse_list([30,32,70,54],[60,62,0,10])</span>
<span class="sd">    ([210.0, 212.0, 250.0, 234.0], [-60, -62, 0, -10])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">incs_flipped</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">incs</span><span class="p">]</span>
    <span class="n">decs_flipped</span> <span class="o">=</span> <span class="p">[(</span><span class="n">dec</span> <span class="o">+</span> <span class="mf">180.</span><span class="p">)</span> <span class="o">%</span> <span class="mf">360.</span> <span class="k">for</span> <span class="n">dec</span> <span class="ow">in</span> <span class="n">decs</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">decs_flipped</span><span class="p">,</span> <span class="n">incs_flipped</span></div>


<div class="viewcode-block" id="doincfish"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.doincfish">[docs]</a><span class="k">def</span> <span class="nf">doincfish</span><span class="p">(</span><span class="n">inc</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates Fisher mean inclination from inclination-only data.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    inc: list of inclination values</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dict</span>
<span class="sd">        &#39;n&#39; : number of inclination values supplied</span>
<span class="sd">        &#39;ginc&#39; : gaussian mean of inclinations</span>
<span class="sd">        &#39;inc&#39; : estimated Fisher mean</span>
<span class="sd">        &#39;r&#39; : estimated Fisher R value</span>
<span class="sd">        &#39;k&#39; : estimated Fisher kappa</span>
<span class="sd">        &#39;alpha95&#39; : estimated fisher alpha_95</span>
<span class="sd">        &#39;csd&#39; : estimated circular standard deviation</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; pmag.doincfish([60,62,0,10])</span>
<span class="sd">    {&#39;n&#39;: 4,</span>
<span class="sd">     &#39;ginc&#39;: 33.0,</span>
<span class="sd">     &#39;inc&#39;: 39.85999999999957,</span>
<span class="sd">     &#39;r&#39;: 2.9999543668915347,</span>
<span class="sd">     &#39;k&#39;: 2.999863106921461,</span>
<span class="sd">     &#39;alpha95&#39;: 57.453002724988956,</span>
<span class="sd">     &#39;csd&#39;: 46.76643881682904}</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">abinc</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">inc</span><span class="p">:</span>
        <span class="n">abinc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
    <span class="n">MI</span><span class="p">,</span> <span class="n">std</span> <span class="o">=</span> <span class="n">gausspars</span><span class="p">(</span><span class="n">abinc</span><span class="p">)</span>  <span class="c1"># get mean inc and standard deviation</span>
    <span class="n">fpars</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">inc</span><span class="p">)</span>  <span class="c1"># number of data</span>
    <span class="n">fpars</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">N</span>
    <span class="n">fpars</span><span class="p">[</span><span class="s1">&#39;ginc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">MI</span>
    <span class="k">if</span> <span class="n">MI</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">:</span>
        <span class="n">fpars</span><span class="p">[</span><span class="s1">&#39;inc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">MI</span>
        <span class="n">fpars</span><span class="p">[</span><span class="s1">&#39;k&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">fpars</span><span class="p">[</span><span class="s1">&#39;alpha95&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">fpars</span><span class="p">[</span><span class="s1">&#39;csd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">fpars</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;WARNING: mean inc &lt; 30, returning gaussian mean&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">fpars</span>
    <span class="n">inc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">inc</span><span class="p">)</span>
    <span class="n">coinc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="mf">90.</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">inc</span><span class="p">))</span> <span class="c1"># sum over all incs (but take only positive inc)</span>
    <span class="n">SCOi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">coinc</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">SSOi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">coinc</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">min_misfit</span><span class="p">,</span><span class="n">min_curvature</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span><span class="mf">0.</span>
    <span class="n">Oo</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mf">0.01</span><span class="p">))</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="n">N</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">Oo</span><span class="p">)</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">Oo</span><span class="p">)</span><span class="o">**</span><span class="mf">2.</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">Oo</span><span class="p">)</span><span class="o">**</span><span class="mf">2.</span><span class="p">)</span> <span class="o">*</span> <span class="n">SCOi</span>
    <span class="n">t3</span> <span class="o">=</span> <span class="mf">2.</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">Oo</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">Oo</span><span class="p">)</span> <span class="o">*</span> <span class="n">SSOi</span>
    <span class="n">misfit</span> <span class="o">=</span> <span class="n">t1</span><span class="o">+</span><span class="n">t2</span><span class="o">-</span><span class="n">t3</span>
    <span class="n">idx_zeros</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">misfit</span><span class="p">)))</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">idx_zeros</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">idx_zeros</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">misfit</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No zeros found to fitness function of McFadden and Reed 1982, returning absolute minimum which is at </span><span class="si">%.3f</span><span class="s2"> instead.</span><span class="se">\n</span><span class="s2">This likely indicates that your inclinations are too steep for this method you may wish to consider an alternate technique.&quot;</span><span class="o">%</span><span class="n">misfit</span><span class="p">[</span><span class="n">idx_zeros</span><span class="p">])</span>
    <span class="n">ML_zeros</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Oo</span><span class="p">[[</span><span class="n">idx_zeros</span><span class="p">]])</span>
    <span class="n">ML_matrix</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">coinc</span><span class="p">),</span><span class="mi">1</span><span class="p">])</span> <span class="o">@</span> <span class="n">ML_zeros</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ML_zeros</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span><span class="o">.</span><span class="n">T</span>
<span class="c1">#    print(coinc.shape,ML_zeros.shape,ML_matrix.shape)</span>
    <span class="n">U</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">N</span><span class="o">*</span><span class="p">((</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">ML_zeros</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">-</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">ML_matrix</span><span class="o">-</span><span class="n">coinc</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">ML_matrix</span><span class="o">-</span><span class="n">coinc</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))))</span>
<span class="c1">#    print(&quot;Found Zeros: &quot;, ML_zeros, &quot;Second Derivative: &quot;, U)</span>
    <span class="n">Oo</span> <span class="o">=</span> <span class="n">ML_zeros</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">U</span><span class="p">)]</span>
    <span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">Oo</span><span class="o">-</span><span class="n">coinc</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">Oo</span><span class="o">-</span><span class="n">coinc</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">old_div</span><span class="p">((</span><span class="n">N</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">),</span> <span class="p">(</span><span class="mf">2.</span> <span class="o">*</span> <span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="n">C</span><span class="p">)))</span>
    <span class="n">Imle</span> <span class="o">=</span> <span class="mf">90.</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">rad2deg</span><span class="p">(</span><span class="n">Oo</span><span class="p">)</span>
    <span class="n">fpars</span><span class="p">[</span><span class="s2">&quot;inc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Imle</span>
    <span class="n">fpars</span><span class="p">[</span><span class="s2">&quot;r&quot;</span><span class="p">],</span> <span class="n">R</span> <span class="o">=</span> <span class="mf">2.</span> <span class="o">*</span> <span class="n">C</span> <span class="o">-</span> <span class="n">N</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">C</span> <span class="o">-</span> <span class="n">N</span>
    <span class="n">fpars</span><span class="p">[</span><span class="s2">&quot;k&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">k</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">fcalc</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">a95</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">-</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">old_div</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">C</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="p">(</span><span class="n">old_div</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="mf">2.</span> <span class="o">*</span> <span class="n">C</span> <span class="o">*</span> <span class="n">k</span><span class="p">)))</span>
<span class="c1">#    b=20.**(1./(N-1.)) -1.</span>
<span class="c1">#    a=1.-b*(N-R)/R</span>
    <span class="n">a95</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">rad2deg</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">a95</span><span class="p">))</span>
    <span class="n">csd</span> <span class="o">=</span> <span class="n">old_div</span><span class="p">(</span><span class="mf">81.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">k</span><span class="p">))</span>
    <span class="n">fpars</span><span class="p">[</span><span class="s2">&quot;alpha95&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">a95</span>
    <span class="n">fpars</span><span class="p">[</span><span class="s2">&quot;csd&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">csd</span>
    <span class="k">return</span> <span class="n">fpars</span></div>


<div class="viewcode-block" id="dokent"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.dokent">[docs]</a><span class="k">def</span> <span class="nf">dokent</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">NN</span><span class="p">,</span> <span class="n">distribution_95</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Gets Kent parameters for data.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data :  nested pairs of [Dec,Inc]</span>
<span class="sd">    NN  : normalization</span>
<span class="sd">        Number of data for Kent ellipse</span>
<span class="sd">        NN is 1 for Kent ellipses of bootstrapped mean directions</span>
<span class="sd">    distribution_95 : the default behavior (distribution_95=False) is for</span>
<span class="sd">        the function to return the confidence region for the mean direction.</span>
<span class="sd">        if distribution_95=True what instead will be returned is the parameters</span>
<span class="sd">        associated with the region containing 95% of the directions.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    kpars dictionary keys</span>
<span class="sd">        dec : mean declination</span>
<span class="sd">        inc : mean inclination</span>
<span class="sd">        n : number of datapoints</span>
<span class="sd">        Zeta : major ellipse</span>
<span class="sd">        Zdec : declination of major ellipse axis</span>
<span class="sd">        Zinc : inclination of major ellipse axis</span>
<span class="sd">        Eta : minor ellipse</span>
<span class="sd">        Edec : declination of minor ellipse axis</span>
<span class="sd">        Einc : inclination of minor ellipse axis</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">kpars</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">{}</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">N</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">kpars</span>
<span class="c1">#</span>
<span class="c1">#  get fisher mean and convert to co-inclination (theta)/dec (phi) in radians</span>
<span class="c1">#</span>
    <span class="n">fpars</span> <span class="o">=</span> <span class="n">fisher_mean</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">pbar</span> <span class="o">=</span> <span class="n">fpars</span><span class="p">[</span><span class="s2">&quot;dec&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">180.</span>
    <span class="n">tbar</span> <span class="o">=</span> <span class="p">(</span><span class="mf">90.</span> <span class="o">-</span> <span class="n">fpars</span><span class="p">[</span><span class="s2">&quot;inc&quot;</span><span class="p">])</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">180.</span>
<span class="c1">#</span>
<span class="c1">#   initialize matrices</span>
<span class="c1">#</span>
    <span class="n">H</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]]</span>
    <span class="n">w</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]]</span>
    <span class="n">b</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]]</span>
    <span class="n">gam</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]]</span>
    <span class="n">xg</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1">#</span>
<span class="c1">#  set up rotation matrix H</span>
<span class="c1">#</span>
    <span class="n">H</span> <span class="o">=</span> <span class="p">[[</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">tbar</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">pbar</span><span class="p">),</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">pbar</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">tbar</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">pbar</span><span class="p">)],</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">tbar</span><span class="p">)</span>
                                                                                     <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">pbar</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">pbar</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">pbar</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">tbar</span><span class="p">)],</span> <span class="p">[</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">tbar</span><span class="p">),</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">tbar</span><span class="p">)]]</span>
<span class="c1">#</span>
<span class="c1">#  get cartesian coordinates of data</span>
<span class="c1">#</span>
    <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dir2cart</span><span class="p">([</span><span class="n">rec</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">rec</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mf">1.</span><span class="p">]))</span>
<span class="c1">#</span>
<span class="c1">#   put in T matrix</span>
<span class="c1">#</span>
    <span class="n">T</span> <span class="o">=</span> <span class="n">Tmatrix</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">old_div</span><span class="p">(</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">],</span> <span class="nb">float</span><span class="p">(</span><span class="n">NN</span><span class="p">))</span>
<span class="c1">#</span>
<span class="c1"># compute B=H&#39;TH</span>
<span class="c1">#</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
                <span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">H</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
                <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="n">H</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">w</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>

<span class="c1"># get the upper 2x2 matrix of B as BL</span>
    <span class="n">BL</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">b</span><span class="p">)[</span><span class="n">np</span><span class="o">.</span><span class="n">ix_</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])]</span>
<span class="c1"># compute the eigenvalues of BL</span>
    <span class="n">BL_ei</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">BL</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="c1">#</span>
<span class="c1"># choose a rotation w about North pole to diagonalize upper part of B</span>
<span class="c1">#</span>
    <span class="n">psi</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span><span class="mf">2.</span> <span class="o">*</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]))</span>
    <span class="n">w</span> <span class="o">=</span> <span class="p">[[</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">psi</span><span class="p">),</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">psi</span><span class="p">),</span> <span class="mi">0</span><span class="p">],</span>
         <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">psi</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">psi</span><span class="p">),</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="n">gamtmp</span> <span class="o">=</span> <span class="mf">0.</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
                <span class="n">gamtmp</span> <span class="o">+=</span> <span class="n">H</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">w</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
            <span class="n">gam</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">gamtmp</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="n">xg</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="n">xgtmp</span> <span class="o">=</span> <span class="mf">0.</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
                <span class="n">xgtmp</span> <span class="o">+=</span> <span class="n">gam</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
            <span class="n">xg</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">xgtmp</span>
<span class="c1"># compute asymptotic ellipse parameters</span>
<span class="c1">#</span>
    <span class="n">xmu</span><span class="p">,</span> <span class="n">sigma1</span><span class="p">,</span> <span class="n">sigma2</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="n">xmu</span> <span class="o">+=</span> <span class="n">xg</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">sigma1</span> <span class="o">=</span> <span class="n">sigma1</span> <span class="o">+</span> <span class="n">xg</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">sigma2</span> <span class="o">=</span> <span class="n">sigma2</span> <span class="o">+</span> <span class="n">xg</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">xmu</span> <span class="o">=</span> <span class="n">old_div</span><span class="p">(</span><span class="n">xmu</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>
    <span class="n">sigma1</span> <span class="o">=</span> <span class="n">sigma1</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">sigma2</span> <span class="o">=</span> <span class="n">sigma2</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">distribution_95</span><span class="o">==</span><span class="kc">False</span><span class="p">:</span>
        <span class="n">g</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">0.05</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">NN</span><span class="p">)</span> <span class="o">*</span> <span class="n">xmu</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">distribution_95</span><span class="o">==</span><span class="kc">True</span><span class="p">:</span>
        <span class="n">g</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">0.05</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">xmu</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sigma1</span> <span class="o">*</span> <span class="n">g</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">eta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sigma1</span> <span class="o">*</span> <span class="n">g</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sigma2</span> <span class="o">*</span> <span class="n">g</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">zeta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sigma2</span> <span class="o">*</span> <span class="n">g</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sigma1</span> <span class="o">*</span> <span class="n">g</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mf">1.</span><span class="p">:</span>
        <span class="n">eta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">2.0</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sigma2</span> <span class="o">*</span> <span class="n">g</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mf">1.</span><span class="p">:</span>
        <span class="n">zeta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">2.0</span>
<span class="c1">#</span>
<span class="c1">#  convert Kent parameters to directions,angles</span>
<span class="c1">#</span>
    <span class="n">kpars</span><span class="p">[</span><span class="s2">&quot;dec&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fpars</span><span class="p">[</span><span class="s2">&quot;dec&quot;</span><span class="p">]</span>
    <span class="n">kpars</span><span class="p">[</span><span class="s2">&quot;inc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fpars</span><span class="p">[</span><span class="s2">&quot;inc&quot;</span><span class="p">]</span>
    <span class="n">kpars</span><span class="p">[</span><span class="s2">&quot;n&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">NN</span>
    <span class="k">if</span> <span class="n">eta</span> <span class="o">&gt;</span> <span class="n">zeta</span><span class="p">:</span>
        <span class="n">eta</span><span class="p">,</span> <span class="n">zeta</span> <span class="o">=</span> <span class="n">zeta</span><span class="p">,</span> <span class="n">eta</span>
        <span class="n">EDir</span> <span class="o">=</span> <span class="n">cart2dir</span><span class="p">([</span><span class="n">gam</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">gam</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">gam</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]])</span>
        <span class="n">ZDir</span> <span class="o">=</span> <span class="n">cart2dir</span><span class="p">([</span><span class="n">gam</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">gam</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">gam</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ZDir</span> <span class="o">=</span> <span class="n">cart2dir</span><span class="p">([</span><span class="n">gam</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">gam</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">gam</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]])</span>
        <span class="n">EDir</span> <span class="o">=</span> <span class="n">cart2dir</span><span class="p">([</span><span class="n">gam</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">gam</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">gam</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]])</span>
    <span class="n">kpars</span><span class="p">[</span><span class="s2">&quot;Zdec&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ZDir</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">kpars</span><span class="p">[</span><span class="s2">&quot;Zinc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ZDir</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">kpars</span><span class="p">[</span><span class="s2">&quot;Edec&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">EDir</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">kpars</span><span class="p">[</span><span class="s2">&quot;Einc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">EDir</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">kpars</span><span class="p">[</span><span class="s2">&quot;Zinc&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">kpars</span><span class="p">[</span><span class="s2">&quot;Zinc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">kpars</span><span class="p">[</span><span class="s2">&quot;Zinc&quot;</span><span class="p">]</span>
        <span class="n">kpars</span><span class="p">[</span><span class="s2">&quot;Zdec&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">kpars</span><span class="p">[</span><span class="s2">&quot;Zdec&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="mf">180.</span><span class="p">)</span> <span class="o">%</span> <span class="mf">360.</span>
    <span class="k">if</span> <span class="n">kpars</span><span class="p">[</span><span class="s2">&quot;Einc&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">kpars</span><span class="p">[</span><span class="s2">&quot;Einc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">kpars</span><span class="p">[</span><span class="s2">&quot;Einc&quot;</span><span class="p">]</span>
        <span class="n">kpars</span><span class="p">[</span><span class="s2">&quot;Edec&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">kpars</span><span class="p">[</span><span class="s2">&quot;Edec&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="mf">180.</span><span class="p">)</span> <span class="o">%</span> <span class="mf">360.</span>
    <span class="n">kpars</span><span class="p">[</span><span class="s2">&quot;Zeta&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">zeta</span> <span class="o">*</span> <span class="mf">180.</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
    <span class="n">kpars</span><span class="p">[</span><span class="s2">&quot;Eta&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">eta</span> <span class="o">*</span> <span class="mf">180.</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
    <span class="n">kpars</span><span class="p">[</span><span class="s1">&#39;R1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fpars</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">N</span>        
    <span class="n">kpars</span><span class="p">[</span><span class="s1">&#39;R2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">BL_ei</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">BL_ei</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">kpars</span></div>


<div class="viewcode-block" id="doprinc"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.doprinc">[docs]</a><span class="k">def</span> <span class="nf">doprinc</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Gets principal components from data in form of a list of [dec,inc,int] data.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : nested list of dec, inc and optionally intensity vectors</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ppars : dictionary with the principal components</span>
<span class="sd">        dec : principal direction declination</span>
<span class="sd">        inc : principal direction inclination</span>
<span class="sd">        V2dec : intermediate eigenvector declination</span>
<span class="sd">        V2inc : intermediate eigenvector inclination</span>
<span class="sd">        V3dec : minor eigenvector declination</span>
<span class="sd">        V3inc : minor eigenvector inclination</span>
<span class="sd">        tau1 : major eigenvalue</span>
<span class="sd">        tau2 : intermediate eigenvalue</span>
<span class="sd">        tau3 : minor eigenvalue</span>
<span class="sd">        N  : number of points</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ppars</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">rad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">dir2cart</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="c1"># for rec in data:</span>
    <span class="c1">#    dir=[]</span>
    <span class="c1">#    for c in rec: dir.append(c)</span>
    <span class="c1">#    cart= (dir2cart(dir))</span>
    <span class="c1">#    X.append(cart)</span>
<span class="c1">#   put in T matrix</span>
<span class="c1">#</span>
    <span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Tmatrix</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
<span class="c1">#</span>
<span class="c1">#   get sorted evals/evects</span>
<span class="c1">#</span>
    <span class="n">t</span><span class="p">,</span> <span class="n">V</span> <span class="o">=</span> <span class="n">tauV</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">Pdir</span> <span class="o">=</span> <span class="n">cart2dir</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="c1">#ppars[&#39;Edir&#39;] = cart2dir(V[1])  # elongation direction - this is V2dec!</span>
    <span class="n">dec</span><span class="p">,</span> <span class="n">inc</span> <span class="o">=</span> <span class="n">doflip</span><span class="p">(</span><span class="n">Pdir</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Pdir</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">ppars</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dec</span>
    <span class="n">ppars</span><span class="p">[</span><span class="s1">&#39;inc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">inc</span>
    <span class="n">ppars</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">ppars</span><span class="p">[</span><span class="s1">&#39;tau1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ppars</span><span class="p">[</span><span class="s1">&#39;tau2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">ppars</span><span class="p">[</span><span class="s1">&#39;tau3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">Pdir</span> <span class="o">=</span> <span class="n">cart2dir</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">dec</span><span class="p">,</span> <span class="n">inc</span> <span class="o">=</span> <span class="n">doflip</span><span class="p">(</span><span class="n">Pdir</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Pdir</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">ppars</span><span class="p">[</span><span class="s1">&#39;V2dec&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dec</span>
    <span class="n">ppars</span><span class="p">[</span><span class="s1">&#39;V2inc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">inc</span>
    <span class="n">Pdir</span> <span class="o">=</span> <span class="n">cart2dir</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">dec</span><span class="p">,</span> <span class="n">inc</span> <span class="o">=</span> <span class="n">doflip</span><span class="p">(</span><span class="n">Pdir</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Pdir</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">ppars</span><span class="p">[</span><span class="s1">&#39;V3dec&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dec</span>
    <span class="n">ppars</span><span class="p">[</span><span class="s1">&#39;V3inc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">inc</span>
    <span class="k">return</span> <span class="n">ppars</span></div>


<div class="viewcode-block" id="pt_rot"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.pt_rot">[docs]</a><span class="k">def</span> <span class="nf">pt_rot</span><span class="p">(</span><span class="n">EP</span><span class="p">,</span> <span class="n">Lats</span><span class="p">,</span> <span class="n">Lons</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Rotates points on a globe by an Euler pole rotation using method of</span>
<span class="sd">    Cox and Hart 1986, box 7-3.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    EP : Euler pole list [lat,lon,angle] specifying the location of the pole;</span>
<span class="sd">    the angle is for a counterclockwise rotation about the pole</span>
<span class="sd">    Lats : list of latitudes of points to be rotated</span>
<span class="sd">    Lons : list of longitudes of points to be rotated</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    RLats : list of rotated latitudes</span>
<span class="sd">    RLons : list of rotated longitudes</span>
<span class="sd">    &quot;&quot;&quot;</span>
<span class="c1"># gets user input of Rotation pole lat,long, omega for plate and converts</span>
<span class="c1"># to radians</span>
    <span class="n">E</span> <span class="o">=</span> <span class="n">dir2cart</span><span class="p">([</span><span class="n">EP</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">EP</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mf">1.</span><span class="p">])</span>  <span class="c1"># EP is pole lat,lon omega</span>
    <span class="n">omega</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">EP</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>  <span class="c1"># convert to radians</span>
    <span class="n">RLats</span><span class="p">,</span> <span class="n">RLons</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Lats</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">Lats</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mf">90.</span><span class="p">:</span>  <span class="c1"># peel off delimiters</span>
            <span class="c1"># converts to rotation pole to cartesian coordinates</span>
            <span class="n">A</span> <span class="o">=</span> <span class="n">dir2cart</span><span class="p">([</span><span class="n">Lons</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">Lats</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="mf">1.</span><span class="p">])</span>
<span class="c1"># defines cartesian coordinates of the pole A</span>
            <span class="n">R</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]]</span>
            <span class="n">R</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">E</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">E</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="p">))</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span>
            <span class="n">R</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">E</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">E</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="p">))</span> <span class="o">-</span> <span class="n">E</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span>
            <span class="n">R</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">E</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">E</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="p">))</span> <span class="o">+</span> <span class="n">E</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span>
            <span class="n">R</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">E</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">E</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="p">))</span> <span class="o">+</span> <span class="n">E</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span>
            <span class="n">R</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">E</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">E</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="p">))</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span>
            <span class="n">R</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">E</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">E</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="p">))</span> <span class="o">-</span> <span class="n">E</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span>
            <span class="n">R</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">E</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">E</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="p">))</span> <span class="o">-</span> <span class="n">E</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span>
            <span class="n">R</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">E</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">E</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="p">))</span> <span class="o">+</span> <span class="n">E</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span>
            <span class="n">R</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">E</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">E</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="p">))</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span>
<span class="c1"># sets up rotation matrix</span>
            <span class="n">Ap</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
                    <span class="n">Ap</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">R</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">A</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
<span class="c1"># does the rotation</span>
            <span class="n">Prot</span> <span class="o">=</span> <span class="n">cart2dir</span><span class="p">(</span><span class="n">Ap</span><span class="p">)</span>
            <span class="n">RLats</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Prot</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">RLons</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Prot</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># preserve delimiters</span>
            <span class="n">RLats</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Lats</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
            <span class="n">RLons</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Lons</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">RLats</span><span class="p">,</span> <span class="n">RLons</span></div>


<div class="viewcode-block" id="dread"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.dread">[docs]</a><span class="k">def</span> <span class="nf">dread</span><span class="p">(</span><span class="n">infile</span><span class="p">,</span> <span class="n">cols</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Depreciated 9/14/2022 </span>
<span class="sd">    </span>
<span class="sd">    Reads in specimen, tr, dec, inc int into data[].  position of</span>
<span class="sd">    tr, dec, inc, int determined by cols[]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">infile</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">():</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="n">rec</span> <span class="o">=</span> <span class="p">(</span><span class="n">tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">float</span><span class="p">(</span><span class="n">tmp</span><span class="p">[</span><span class="n">cols</span><span class="p">[</span><span class="mi">0</span><span class="p">]]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">tmp</span><span class="p">[</span><span class="n">cols</span><span class="p">[</span><span class="mi">1</span><span class="p">]]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">tmp</span><span class="p">[</span><span class="n">cols</span><span class="p">[</span><span class="mi">2</span><span class="p">]]),</span>
               <span class="nb">float</span><span class="p">(</span><span class="n">tmp</span><span class="p">[</span><span class="n">cols</span><span class="p">[</span><span class="mi">3</span><span class="p">]]))</span>
        <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">)</span>
    <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">data</span></div>


<div class="viewcode-block" id="fshdev"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.fshdev">[docs]</a><span class="k">def</span> <span class="nf">fshdev</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate a random draw from a Fisher distribution with mean declination</span>
<span class="sd">    of 0 and inclination of 90 with a specified kappa.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    k : single number or an array of values</span>
<span class="sd">        kappa (precision parameter) of the distribution</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dec, inc : declination and inclination of random Fisher distribution draw</span>
<span class="sd">               if k is an array, dec, inc are returned as arrays, otherwise, single values</span>
<span class="sd">    </span>
<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; pmag.fshdev(8)</span>
<span class="sd">    (334.3434290469283, 61.06963783415771)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">R1</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
    <span class="n">R2</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
    <span class="n">L</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">k</span><span class="p">)</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">R1</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">L</span><span class="p">)</span> <span class="o">+</span> <span class="n">L</span>
    <span class="n">fac</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">k</span><span class="p">))</span>
    <span class="n">inc</span> <span class="o">=</span> <span class="mf">90.</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="n">fac</span><span class="p">))</span>
    <span class="n">dec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">R2</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">dec</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">inc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># preserve backward compatibility</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">dec</span><span class="p">,</span> <span class="n">inc</span></div>

<div class="viewcode-block" id="kentdev"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.kentdev">[docs]</a><span class="k">def</span> <span class="nf">kentdev</span><span class="p">(</span><span class="n">kappa</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate a random draw from a Kent distribution with mean declination</span>
<span class="sd">    of 0 and inclination of 90, elongated along -90 to 90 longitude </span>
<span class="sd">    with a specified kappa and beta.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    kappa : kappa (precision parameter) of the distribution</span>
<span class="sd">    beta : beta ellipticity of the contours of equal probability of the distribution</span>
<span class="sd">    n : number of samples to redraw</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dec, inc : declination and inclination of random Kent distribution draw</span>
<span class="sd">    </span>
<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; pmag.kentdev(30,0.2,3)</span>
<span class="sd">    ([249.6338265814872, 243.60784772662754, 273.37935292238103],</span>
<span class="sd">     [74.05222965175194, 80.43784483273899, 82.34979130960458])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># initialize dec, inc lists to be reported</span>
    <span class="n">decs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">incs</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="c1"># Normalization constant given kappa and beta</span>
    <span class="n">normalization</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="o">+</span><span class="n">kappa</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">kappa</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">beta</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">kappa</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">beta</span><span class="p">)))</span>

    <span class="c1"># Variables for the sampler</span>
    <span class="n">a</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">kappa</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">beta</span><span class="p">)</span>
    <span class="n">b</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">kappa</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">beta</span><span class="p">)</span>
    <span class="n">gamma</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>

    <span class="k">if</span><span class="p">(</span><span class="n">b</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">):</span>
        <span class="n">c2</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">b</span><span class="o">/</span><span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">gamma</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">c2</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">lam1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">gamma</span><span class="p">))</span>
    <span class="n">lam2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
    
    <span class="c1"># effective samples</span>
    <span class="n">N</span><span class="o">=</span><span class="mi">0</span>
    
    <span class="k">while</span> <span class="n">N</span><span class="o">&lt;</span><span class="n">n</span><span class="p">:</span>
        <span class="n">v1</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
        <span class="n">v2</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
        <span class="n">u1</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
        <span class="n">u2</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">x1</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">v1</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">lam1</span><span class="p">)))</span><span class="o">/</span><span class="n">lam1</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">x1</span> <span class="o">=</span> <span class="n">v1</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">x2</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">v2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">lam2</span><span class="p">)))</span><span class="o">/</span><span class="n">lam2</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">x2</span><span class="o">=</span><span class="n">v2</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">x1</span><span class="o">*</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="o">*</span><span class="n">x2</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="n">ratio1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">x1</span><span class="o">*</span><span class="n">x1</span><span class="o">+</span><span class="n">gamma</span><span class="o">*</span><span class="n">x1</span><span class="o">*</span><span class="n">x1</span><span class="o">*</span><span class="n">x1</span><span class="o">*</span><span class="n">x1</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">lam1</span><span class="o">*</span><span class="n">x1</span><span class="p">);</span>

        <span class="k">if</span> <span class="n">u1</span> <span class="o">&gt;</span> <span class="n">ratio1</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="n">ratio2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">b</span><span class="o">*</span><span class="n">x2</span><span class="o">*</span><span class="n">x2</span><span class="o">-</span><span class="n">gamma</span><span class="o">*</span><span class="n">x2</span><span class="o">*</span><span class="n">x2</span><span class="o">*</span><span class="n">x2</span><span class="o">*</span><span class="n">x2</span><span class="p">)</span><span class="o">-</span><span class="n">c2</span><span class="o">+</span><span class="n">lam2</span><span class="o">*</span><span class="n">x2</span><span class="p">);</span>

        <span class="k">if</span> <span class="n">u2</span> <span class="o">&gt;</span> <span class="n">ratio2</span><span class="p">:</span>
            <span class="k">continue</span>
        
        <span class="n">sign1</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span><span class="o">-</span><span class="mf">0.5</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">sign2</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span><span class="o">-</span><span class="mf">0.5</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">x1</span><span class="o">=</span><span class="n">x1</span><span class="o">*</span><span class="n">sign1</span>
        <span class="n">x2</span><span class="o">=</span><span class="n">x2</span><span class="o">*</span><span class="n">sign2</span>

        <span class="n">theta</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">x1</span><span class="o">*</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="o">*</span><span class="n">x2</span><span class="p">))</span>
        <span class="n">phi</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">x1</span><span class="p">)</span>
        <span class="n">ct</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
        <span class="n">st</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
        <span class="n">cp</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
        <span class="n">sp</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
        <span class="n">x</span><span class="o">=</span><span class="n">ct</span>
        <span class="n">y</span><span class="o">=</span><span class="n">st</span><span class="o">*</span><span class="n">cp</span>
        <span class="n">z</span><span class="o">=</span><span class="n">st</span><span class="o">*</span><span class="n">sp</span>
    
        <span class="n">d</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="n">cart2dir</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">])</span>
        <span class="n">drot</span><span class="p">,</span> <span class="n">irot</span> <span class="o">=</span> <span class="n">dodirot</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        
        <span class="n">decs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">drot</span><span class="p">)</span>
        <span class="n">incs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">irot</span><span class="p">)</span>
        <span class="n">N</span> <span class="o">=</span> <span class="n">N</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">decs</span><span class="p">,</span> <span class="n">incs</span></div>

<div class="viewcode-block" id="lowes"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.lowes">[docs]</a><span class="k">def</span> <span class="nf">lowes</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Gets Lowe&#39;s power spectrum from gauss coefficients.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : nested list of [[l,m,g,h],...] as from pmag.unpack()</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Ls : list of degrees l</span>
<span class="sd">    Rs : power at degree l</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lmax</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">Ls</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">lmax</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">Rs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">recno</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">Ls</span><span class="p">:</span>
        <span class="nb">pow</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="nb">pow</span> <span class="o">+=</span> <span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="mf">1e-3</span> <span class="o">*</span> <span class="n">data</span><span class="p">[</span><span class="n">recno</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
                              <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1e-3</span> <span class="o">*</span> <span class="n">data</span><span class="p">[</span><span class="n">recno</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">recno</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">Rs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">pow</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Ls</span><span class="p">,</span> <span class="n">Rs</span></div>


<div class="viewcode-block" id="magnetic_lat"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.magnetic_lat">[docs]</a><span class="k">def</span> <span class="nf">magnetic_lat</span><span class="p">(</span><span class="n">inc</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the magnetic latitude from inclination.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    inc : single float or array </span>
<span class="sd">        inclination value(s)</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    paleo_lat : single float or array</span>
<span class="sd">        magnetic latitude from the given inclination(s) </span>
<span class="sd">    </span>
<span class="sd">    Examples </span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; pmag.magnetic_lat(35)</span>
<span class="sd">    19.29534273533122</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; pmag.magnetic_lat([35,60,20])</span>
<span class="sd">    array([19.29534273533122 , 40.8933946491309  , 10.314104815618196])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">paleo_lat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">inc</span><span class="p">))))</span>
    <span class="k">return</span> <span class="n">paleo_lat</span></div>


<span class="k">def</span> <span class="nf">check_F</span><span class="p">(</span><span class="n">AniSpec</span><span class="p">):</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">6</span><span class="p">),</span> <span class="s1">&#39;f&#39;</span><span class="p">)</span>
    <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">AniSpec</span><span class="p">[</span><span class="s2">&quot;anisotropy_s1&quot;</span><span class="p">])</span>
    <span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">AniSpec</span><span class="p">[</span><span class="s2">&quot;anisotropy_s2&quot;</span><span class="p">])</span>
    <span class="n">s</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">AniSpec</span><span class="p">[</span><span class="s2">&quot;anisotropy_s3&quot;</span><span class="p">])</span>
    <span class="n">s</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">AniSpec</span><span class="p">[</span><span class="s2">&quot;anisotropy_s4&quot;</span><span class="p">])</span>
    <span class="n">s</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">AniSpec</span><span class="p">[</span><span class="s2">&quot;anisotropy_s5&quot;</span><span class="p">])</span>
    <span class="n">s</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">AniSpec</span><span class="p">[</span><span class="s2">&quot;anisotropy_s6&quot;</span><span class="p">])</span>
    <span class="n">chibar</span> <span class="o">=</span> <span class="n">old_div</span><span class="p">((</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">s</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="mf">3.</span><span class="p">)</span>
    <span class="n">tau</span><span class="p">,</span> <span class="n">Vdir</span> <span class="o">=</span> <span class="n">doseigs</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="n">t2sum</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">t2sum</span> <span class="o">+=</span> <span class="n">tau</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">if</span> <span class="s1">&#39;anisotropy_sigma&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">AniSpec</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="s1">&#39;anisotropy_n&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">AniSpec</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="k">if</span> <span class="n">AniSpec</span><span class="p">[</span><span class="s1">&#39;anisotropy_type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;AMS&#39;</span><span class="p">:</span>
            <span class="n">nf</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">AniSpec</span><span class="p">[</span><span class="s2">&quot;anisotropy_n&quot;</span><span class="p">])</span> <span class="o">-</span> <span class="mi">6</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">nf</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">*</span> <span class="nb">int</span><span class="p">(</span><span class="n">AniSpec</span><span class="p">[</span><span class="s2">&quot;anisotropy_n&quot;</span><span class="p">])</span> <span class="o">-</span> <span class="mi">6</span>
        <span class="n">sigma</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">AniSpec</span><span class="p">[</span><span class="s2">&quot;anisotropy_sigma&quot;</span><span class="p">])</span>
        <span class="n">F</span> <span class="o">=</span> <span class="mf">0.4</span> <span class="o">*</span> <span class="p">(</span><span class="n">t2sum</span> <span class="o">-</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">chibar</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">sigma</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">Fcrit</span> <span class="o">=</span> <span class="n">fcalc</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">nf</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">F</span> <span class="o">&gt;</span> <span class="n">Fcrit</span><span class="p">:</span>  <span class="c1"># anisotropic</span>
            <span class="n">chi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="p">[[</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">s</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">s</span><span class="p">[</span><span class="mi">5</span><span class="p">]],</span> <span class="p">[</span><span class="n">s</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">s</span><span class="p">[</span><span class="mi">4</span><span class="p">]],</span> <span class="p">[</span><span class="n">s</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="n">s</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">s</span><span class="p">[</span><span class="mi">2</span><span class="p">]]])</span>
            <span class="n">chi_inv</span> <span class="o">=</span> <span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">chi</span><span class="p">)</span>
            <span class="c1"># trace=chi_inv[0][0]+chi_inv[1][1]+chi_inv[2][2] # don&#39;t normalize twice</span>
            <span class="c1"># chi_inv=3.*chi_inv/trace</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># isotropic</span>
            <span class="c1"># make anisotropy tensor identity tensor</span>
            <span class="n">chi_inv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]])</span>
            <span class="n">chi</span> <span class="o">=</span> <span class="n">chi_inv</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># no sigma key available - just do the correction</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;WARNING: NO FTEST ON ANISOTROPY PERFORMED BECAUSE OF MISSING SIGMA - DOING CORRECTION ANYWAY&#39;</span><span class="p">)</span>
        <span class="n">chi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[[</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">s</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">s</span><span class="p">[</span><span class="mi">5</span><span class="p">]],</span> <span class="p">[</span><span class="n">s</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">s</span><span class="p">[</span><span class="mi">4</span><span class="p">]],</span> <span class="p">[</span><span class="n">s</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="n">s</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">s</span><span class="p">[</span><span class="mi">2</span><span class="p">]]])</span>
        <span class="n">chi_inv</span> <span class="o">=</span> <span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">chi</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">chi</span><span class="p">,</span> <span class="n">chi_inv</span>


<div class="viewcode-block" id="Dir_anis_corr"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.Dir_anis_corr">[docs]</a><span class="k">def</span> <span class="nf">Dir_anis_corr</span><span class="p">(</span><span class="n">InDir</span><span class="p">,</span> <span class="n">AniSpec</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Depreciated 9/14/2022</span>
<span class="sd">    </span>
<span class="sd">    Takes the 6 element &#39;s&#39; vector and the Dec,Inc &#39;InDir&#39; data,</span>
<span class="sd">    performs simple anisotropy correction. returns corrected Dec, Inc</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Dir</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;f&#39;</span><span class="p">)</span>
    <span class="n">Dir</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">InDir</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">Dir</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">InDir</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">Dir</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>
    <span class="n">chi</span><span class="p">,</span> <span class="n">chi_inv</span> <span class="o">=</span> <span class="n">check_F</span><span class="p">(</span><span class="n">AniSpec</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">chi</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mf">1.</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Dir</span>  <span class="c1"># isotropic</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">dir2cart</span><span class="p">(</span><span class="n">Dir</span><span class="p">)</span>
    <span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">chi_inv</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cart2dir</span><span class="p">(</span><span class="n">H</span><span class="p">)</span></div>


<div class="viewcode-block" id="doaniscorr"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.doaniscorr">[docs]</a><span class="k">def</span> <span class="nf">doaniscorr</span><span class="p">(</span><span class="n">PmagSpecRec</span><span class="p">,</span> <span class="n">AniSpec</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Depreciated 9/14/2022</span>
<span class="sd">    </span>
<span class="sd">    Takes the 6 element &#39;s&#39; vector and the Dec,Inc, Int &#39;Dir&#39; data,</span>
<span class="sd">    performs simple anisotropy correction. returns corrected Dec, Inc, Int</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">AniSpecRec</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">PmagSpecRec</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="n">AniSpecRec</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">PmagSpecRec</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
    <span class="n">Dir</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;f&#39;</span><span class="p">)</span>
    <span class="n">Dir</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">PmagSpecRec</span><span class="p">[</span><span class="s2">&quot;specimen_dec&quot;</span><span class="p">])</span>
    <span class="n">Dir</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">PmagSpecRec</span><span class="p">[</span><span class="s2">&quot;specimen_inc&quot;</span><span class="p">])</span>
    <span class="n">Dir</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">PmagSpecRec</span><span class="p">[</span><span class="s2">&quot;specimen_int&quot;</span><span class="p">])</span>
<span class="c1"># check if F test passes!  if anisotropy_sigma available</span>
    <span class="n">chi</span><span class="p">,</span> <span class="n">chi_inv</span> <span class="o">=</span> <span class="n">check_F</span><span class="p">(</span><span class="n">AniSpec</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">chi</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mf">1.</span><span class="p">:</span>  <span class="c1"># isotropic</span>
        <span class="n">cDir</span> <span class="o">=</span> <span class="p">[</span><span class="n">Dir</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Dir</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>  <span class="c1"># no change</span>
        <span class="n">newint</span> <span class="o">=</span> <span class="n">Dir</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">dir2cart</span><span class="p">(</span><span class="n">Dir</span><span class="p">)</span>
        <span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
        <span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">chi_inv</span><span class="p">)</span>
        <span class="n">cDir</span> <span class="o">=</span> <span class="n">cart2dir</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
        <span class="n">Hunit</span> <span class="o">=</span> <span class="p">[</span><span class="n">old_div</span><span class="p">(</span><span class="n">H</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cDir</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="n">old_div</span><span class="p">(</span><span class="n">H</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">cDir</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="n">old_div</span><span class="p">(</span>
            <span class="n">H</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">cDir</span><span class="p">[</span><span class="mi">2</span><span class="p">])]</span>  <span class="c1"># unit vector parallel to Banc</span>
        <span class="n">Zunit</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">]</span>  <span class="c1"># unit vector parallel to lab field</span>
        <span class="n">Hpar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">chi</span><span class="p">,</span> <span class="n">Hunit</span><span class="p">)</span>  <span class="c1"># unit vector applied along ancient field</span>
        <span class="n">Zpar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">chi</span><span class="p">,</span> <span class="n">Zunit</span><span class="p">)</span>  <span class="c1"># unit vector applied along lab field</span>
        <span class="c1"># intensity of resultant vector from ancient field</span>
        <span class="n">HparInt</span> <span class="o">=</span> <span class="n">cart2dir</span><span class="p">(</span><span class="n">Hpar</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span>
        <span class="c1"># intensity of resultant vector from lab field</span>
        <span class="n">ZparInt</span> <span class="o">=</span> <span class="n">cart2dir</span><span class="p">(</span><span class="n">Zpar</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">newint</span> <span class="o">=</span> <span class="n">Dir</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">ZparInt</span> <span class="o">/</span> <span class="n">HparInt</span>
        <span class="k">if</span> <span class="n">cDir</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">Dir</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">90</span><span class="p">:</span>
            <span class="n">cDir</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">cDir</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">cDir</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">cDir</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">180.</span><span class="p">)</span> <span class="o">%</span> <span class="mf">360.</span>
    <span class="n">AniSpecRec</span><span class="p">[</span><span class="s2">&quot;specimen_dec&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%7.1f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cDir</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">AniSpecRec</span><span class="p">[</span><span class="s2">&quot;specimen_inc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%7.1f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cDir</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">AniSpecRec</span><span class="p">[</span><span class="s2">&quot;specimen_int&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%9.4e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">newint</span><span class="p">)</span>
    <span class="n">AniSpecRec</span><span class="p">[</span><span class="s2">&quot;specimen_correction&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;c&#39;</span>
    <span class="k">if</span> <span class="s1">&#39;magic_method_codes&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">AniSpecRec</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="n">methcodes</span> <span class="o">=</span> <span class="n">AniSpecRec</span><span class="p">[</span><span class="s2">&quot;magic_method_codes&quot;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">methcodes</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">if</span> <span class="n">methcodes</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
        <span class="n">methcodes</span> <span class="o">=</span> <span class="s2">&quot;DA-AC-&quot;</span> <span class="o">+</span> <span class="n">AniSpec</span><span class="p">[</span><span class="s1">&#39;anisotropy_type&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">methcodes</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
        <span class="n">methcodes</span> <span class="o">=</span> <span class="n">methcodes</span> <span class="o">+</span> <span class="s2">&quot;:DA-AC-&quot;</span> <span class="o">+</span> <span class="n">AniSpec</span><span class="p">[</span><span class="s1">&#39;anisotropy_type&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">chi</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mf">1.</span><span class="p">:</span>  <span class="c1"># isotropic</span>
        <span class="c1"># indicates anisotropy was checked and no change necessary</span>
        <span class="n">methcodes</span> <span class="o">=</span> <span class="n">methcodes</span> <span class="o">+</span> <span class="s1">&#39;:DA-AC-ISO&#39;</span>
    <span class="n">AniSpecRec</span><span class="p">[</span><span class="s2">&quot;magic_method_codes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">methcodes</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">AniSpecRec</span></div>


<div class="viewcode-block" id="vfunc"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.vfunc">[docs]</a><span class="k">def</span> <span class="nf">vfunc</span><span class="p">(</span><span class="n">pars_1</span><span class="p">,</span> <span class="n">pars_2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the Watson Vw test statistic. Calculated as 2*(Sw-Rw)</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    pars_1 : dictionary of Fisher statistics from population 1</span>
<span class="sd">    pars_2 : dictionary of Fisher statistics from population 2</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Vw : Watson&#39;s Vw statistic</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cart_1</span> <span class="o">=</span> <span class="n">dir2cart</span><span class="p">([</span><span class="n">pars_1</span><span class="p">[</span><span class="s2">&quot;dec&quot;</span><span class="p">],</span> <span class="n">pars_1</span><span class="p">[</span><span class="s2">&quot;inc&quot;</span><span class="p">],</span> <span class="n">pars_1</span><span class="p">[</span><span class="s2">&quot;r&quot;</span><span class="p">]])</span>
    <span class="n">cart_2</span> <span class="o">=</span> <span class="n">dir2cart</span><span class="p">([</span><span class="n">pars_2</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">],</span> <span class="n">pars_2</span><span class="p">[</span><span class="s1">&#39;inc&#39;</span><span class="p">],</span> <span class="n">pars_2</span><span class="p">[</span><span class="s2">&quot;r&quot;</span><span class="p">]])</span>
    <span class="n">Sw</span> <span class="o">=</span> <span class="n">pars_1</span><span class="p">[</span><span class="s1">&#39;k&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">pars_1</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">pars_2</span><span class="p">[</span><span class="s1">&#39;k&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">pars_2</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">]</span>  <span class="c1"># k1*r1+k2*r2</span>
    <span class="n">xhat_1</span> <span class="o">=</span> <span class="n">pars_1</span><span class="p">[</span><span class="s1">&#39;k&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">cart_1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">pars_2</span><span class="p">[</span><span class="s1">&#39;k&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">cart_2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># k1*x1+k2*x2</span>
    <span class="n">xhat_2</span> <span class="o">=</span> <span class="n">pars_1</span><span class="p">[</span><span class="s1">&#39;k&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">cart_1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">pars_2</span><span class="p">[</span><span class="s1">&#39;k&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">cart_2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># k1*y1+k2*y2</span>
    <span class="n">xhat_3</span> <span class="o">=</span> <span class="n">pars_1</span><span class="p">[</span><span class="s1">&#39;k&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">cart_1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">pars_2</span><span class="p">[</span><span class="s1">&#39;k&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">cart_2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>  <span class="c1"># k1*z1+k2*z2</span>
    <span class="n">Rw</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">xhat_1</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">xhat_2</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">xhat_3</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">Sw</span> <span class="o">-</span> <span class="n">Rw</span><span class="p">)</span></div>


<div class="viewcode-block" id="vgp_di"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.vgp_di">[docs]</a><span class="k">def</span> <span class="nf">vgp_di</span><span class="p">(</span><span class="n">plat</span><span class="p">,</span> <span class="n">plong</span><span class="p">,</span> <span class="n">slat</span><span class="p">,</span> <span class="n">slong</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts a pole position (pole latitude, pole longitude) to a direction</span>
<span class="sd">    (declination, inclination) at a given location (slat, slong) assuming a</span>
<span class="sd">    dipolar field.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    plat : latitude of pole (vgp latitude)</span>
<span class="sd">    plong : longitude of pole (vgp longitude)</span>
<span class="sd">    slat : latitude of site</span>
<span class="sd">    slong : longitude of site</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dec,inc : tuple of declination and inclination</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">plong</span> <span class="o">=</span> <span class="n">plong</span> <span class="o">%</span> <span class="mi">360</span>
    <span class="n">slong</span> <span class="o">=</span> <span class="n">slong</span> <span class="o">%</span> <span class="mi">360</span>
    <span class="n">signdec</span> <span class="o">=</span> <span class="mf">1.</span>
    <span class="n">delphi</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">plong</span> <span class="o">-</span> <span class="n">slong</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">delphi</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">signdec</span> <span class="o">=</span> <span class="p">(</span><span class="n">plong</span> <span class="o">-</span> <span class="n">slong</span><span class="p">)</span> <span class="o">/</span> <span class="n">delphi</span>
    <span class="k">if</span> <span class="n">slat</span> <span class="o">==</span> <span class="mf">90.</span><span class="p">:</span>
        <span class="n">slat</span> <span class="o">=</span> <span class="mf">89.99</span>
    <span class="n">thetaS</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mf">90.</span> <span class="o">-</span> <span class="n">slat</span><span class="p">)</span>
    <span class="n">thetaP</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mf">90.</span> <span class="o">-</span> <span class="n">plat</span><span class="p">)</span>
    <span class="n">delphi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">delphi</span><span class="p">)</span>
    <span class="n">cosp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">thetaS</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">thetaP</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">thetaS</span><span class="p">)</span> <span class="o">*</span> \
        <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">thetaP</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">delphi</span><span class="p">)</span>
    <span class="n">thetaM</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">cosp</span><span class="p">)</span>
    <span class="n">cosd</span> <span class="o">=</span> <span class="n">old_div</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">thetaP</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">thetaM</span><span class="p">)</span> <span class="o">*</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">thetaS</span><span class="p">)),</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">thetaM</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">thetaS</span><span class="p">)))</span>
    <span class="n">C</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">cosd</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">C</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">dec</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span><span class="n">cosd</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">C</span><span class="p">)))</span> <span class="o">+</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">cosd</span><span class="p">)</span>
    <span class="k">if</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">&lt;</span> <span class="n">signdec</span> <span class="o">*</span> <span class="n">delphi</span> <span class="ow">and</span> <span class="n">signdec</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">dec</span> <span class="o">=</span> <span class="mf">2.</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">-</span> <span class="n">dec</span>  <span class="c1"># checking quadrant</span>
    <span class="k">if</span> <span class="n">signdec</span> <span class="o">*</span> <span class="n">delphi</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">:</span>
        <span class="n">dec</span> <span class="o">=</span> <span class="mf">2.</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">-</span> <span class="n">dec</span>
    <span class="n">dec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">dec</span><span class="p">)</span> <span class="o">%</span> <span class="mf">360.</span>
    <span class="n">inc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="mf">2.</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">thetaM</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">thetaM</span><span class="p">)))</span>
    <span class="k">return</span> <span class="n">dec</span><span class="p">,</span> <span class="n">inc</span></div>


<div class="viewcode-block" id="watsonsV"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.watsonsV">[docs]</a><span class="k">def</span> <span class="nf">watsonsV</span><span class="p">(</span><span class="n">Dir1</span><span class="p">,</span> <span class="n">Dir2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates Watson&#39;s V statistic for two sets of directions</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">counter</span><span class="p">,</span> <span class="n">NumSims</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">500</span>
<span class="c1">#</span>
<span class="c1"># first calculate the fisher means and cartesian coordinates of each set of Directions</span>
<span class="c1">#</span>
    <span class="n">pars_1</span> <span class="o">=</span> <span class="n">fisher_mean</span><span class="p">(</span><span class="n">Dir1</span><span class="p">)</span>
    <span class="n">pars_2</span> <span class="o">=</span> <span class="n">fisher_mean</span><span class="p">(</span><span class="n">Dir2</span><span class="p">)</span>
<span class="c1">#</span>
<span class="c1"># get V statistic for these</span>
<span class="c1">#</span>
    <span class="n">V</span> <span class="o">=</span> <span class="n">vfunc</span><span class="p">(</span><span class="n">pars_1</span><span class="p">,</span> <span class="n">pars_2</span><span class="p">)</span>
<span class="c1">#</span>
<span class="c1"># do monte carlo simulation of datasets with same kappas, but common mean</span>
<span class="c1">#</span>
    <span class="n">Vp</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># set of Vs from simulations</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Doing &quot;</span><span class="p">,</span> <span class="n">NumSims</span><span class="p">,</span> <span class="s2">&quot; simulations&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NumSims</span><span class="p">):</span>
        <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">counter</span> <span class="o">==</span> <span class="mi">50</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">Dirp</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># get a set of N1 fisher distributed vectors with k1, calculate fisher stats</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">pars_1</span><span class="p">[</span><span class="s2">&quot;n&quot;</span><span class="p">]):</span>
            <span class="n">Dirp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fshdev</span><span class="p">(</span><span class="n">pars_1</span><span class="p">[</span><span class="s2">&quot;k&quot;</span><span class="p">]))</span>
        <span class="n">pars_p1</span> <span class="o">=</span> <span class="n">fisher_mean</span><span class="p">(</span><span class="n">Dirp</span><span class="p">)</span>
<span class="c1"># get a set of N2 fisher distributed vectors with k2, calculate fisher stats</span>
        <span class="n">Dirp</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">pars_2</span><span class="p">[</span><span class="s2">&quot;n&quot;</span><span class="p">]):</span>
            <span class="n">Dirp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fshdev</span><span class="p">(</span><span class="n">pars_2</span><span class="p">[</span><span class="s2">&quot;k&quot;</span><span class="p">]))</span>
        <span class="n">pars_p2</span> <span class="o">=</span> <span class="n">fisher_mean</span><span class="p">(</span><span class="n">Dirp</span><span class="p">)</span>
<span class="c1"># get the V for these</span>
        <span class="n">Vk</span> <span class="o">=</span> <span class="n">vfunc</span><span class="p">(</span><span class="n">pars_p1</span><span class="p">,</span> <span class="n">pars_p2</span><span class="p">)</span>
        <span class="n">Vp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Vk</span><span class="p">)</span>
<span class="c1">#</span>
<span class="c1"># sort the Vs, get Vcrit (95th one)</span>
<span class="c1">#</span>
    <span class="n">Vp</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="n">k</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">.95</span> <span class="o">*</span> <span class="n">NumSims</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">V</span><span class="p">,</span> <span class="n">Vp</span><span class="p">[</span><span class="n">k</span><span class="p">]</span></div>


<div class="viewcode-block" id="dimap"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.dimap">[docs]</a><span class="k">def</span> <span class="nf">dimap</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">I</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to map directions  to x,y pairs in equal area projection.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    D : list or array of declinations (as float)</span>
<span class="sd">    I : list or array or inclinations (as float)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    XY : x, y values of directions for equal area projection [x,y]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">D</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
        <span class="n">I</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>  <span class="c1"># is an array</span>
        <span class="k">return</span> <span class="n">dimap_V</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">I</span><span class="p">)</span>
<span class="c1"># DEFINE FUNCTION VARIABLES</span>
    <span class="c1"># initialize equal area projection x,y</span>
    <span class="n">XY</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]</span>

<span class="c1"># GET CARTESIAN COMPONENTS OF INPUT DIRECTION</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">dir2cart</span><span class="p">([</span><span class="n">D</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="mf">1.</span><span class="p">])</span>

<span class="c1"># CHECK IF Z = 1 AND ABORT</span>
    <span class="k">if</span> <span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">XY</span>                       <span class="c1"># return [0,0]</span>

<span class="c1"># TAKE THE ABSOLUTE VALUE OF Z</span>
    <span class="k">if</span> <span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># this only works on lower hemisphere projections</span>
        <span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

<span class="c1"># CALCULATE THE X,Y COORDINATES FOR THE EQUAL AREA PROJECTION</span>
    <span class="c1"># from Collinson 1983</span>
    <span class="n">R</span> <span class="o">=</span> <span class="n">old_div</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)))</span>
    <span class="n">XY</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">XY</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">R</span><span class="p">,</span> <span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">R</span>

<span class="c1"># RETURN XY[X,Y]</span>
    <span class="k">return</span> <span class="n">XY</span></div>


<div class="viewcode-block" id="dimap_V"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.dimap_V">[docs]</a><span class="k">def</span> <span class="nf">dimap_V</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">I</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Maps declinations and inclinations into equal area projections.</span>

<span class="sd">    Parameters </span>
<span class="sd">    ----------</span>
<span class="sd">    D, I : numpy arrays</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    XY : array of equal area projections</span>
<span class="sd">    </span>
<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; pmag.dimap_V([35,60,20],[70,80,-10])</span>
<span class="sd">    array([[0.140856382055789, 0.20116376126988 ],</span>
<span class="sd">       [0.106743548942519, 0.061628416716219],</span>
<span class="sd">       [0.310909633795401, 0.85421719834377 ]])</span>
<span class="sd">    &quot;&quot;&quot;</span>
<span class="c1"># GET CARTESIAN COMPONENTS OF INPUT DIRECTION</span>
    <span class="n">DI</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">D</span><span class="p">,</span> <span class="n">I</span><span class="p">])</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">dir2cart</span><span class="p">(</span><span class="n">DI</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="c1"># CALCULATE THE X,Y COORDINATES FOR THE EQUAL AREA PROJECTION</span>
    <span class="c1"># from Collinson 1983</span>
    <span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="nb">abs</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">XY</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">R</span><span class="p">,</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">R</span><span class="p">])</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>

<span class="c1"># RETURN XY[X,Y]</span>
    <span class="k">return</span> <span class="n">XY</span></div>


<div class="viewcode-block" id="getmeths"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.getmeths">[docs]</a><span class="k">def</span> <span class="nf">getmeths</span><span class="p">(</span><span class="n">method_type</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns MagIC method codes available for a given type.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    method_type : str</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    meths : specified methods codes for the given type </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">meths</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">method_type</span> <span class="o">==</span> <span class="s1">&#39;GM&#39;</span><span class="p">:</span>
        <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;GM-PMAG-APWP&#39;</span><span class="p">)</span>
        <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;GM-ARAR&#39;</span><span class="p">)</span>
        <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;GM-ARAR-AP&#39;</span><span class="p">)</span>
        <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;GM-ARAR-II&#39;</span><span class="p">)</span>
        <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;GM-ARAR-NI&#39;</span><span class="p">)</span>
        <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;GM-ARAR-TF&#39;</span><span class="p">)</span>
        <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;GM-CC-ARCH&#39;</span><span class="p">)</span>
        <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;GM-CC-ARCHMAG&#39;</span><span class="p">)</span>
        <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;GM-C14&#39;</span><span class="p">)</span>
        <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;GM-FOSSIL&#39;</span><span class="p">)</span>
        <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;GM-FT&#39;</span><span class="p">)</span>
        <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;GM-INT-L&#39;</span><span class="p">)</span>
        <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;GM-INT-S&#39;</span><span class="p">)</span>
        <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;GM-ISO&#39;</span><span class="p">)</span>
        <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;GM-KAR&#39;</span><span class="p">)</span>
        <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;GM-PMAG-ANOM&#39;</span><span class="p">)</span>
        <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;GM-PMAG-POL&#39;</span><span class="p">)</span>
        <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;GM-PBPB&#39;</span><span class="p">)</span>
        <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;GM-RATH&#39;</span><span class="p">)</span>
        <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;GM-RBSR&#39;</span><span class="p">)</span>
        <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;GM-RBSR-I&#39;</span><span class="p">)</span>
        <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;GM-RBSR-MA&#39;</span><span class="p">)</span>
        <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;GM-SMND&#39;</span><span class="p">)</span>
        <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;GM-SMND-I&#39;</span><span class="p">)</span>
        <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;GM-SMND-MA&#39;</span><span class="p">)</span>
        <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;GM-CC-STRAT&#39;</span><span class="p">)</span>
        <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;GM-LUM-TH&#39;</span><span class="p">)</span>
        <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;GM-UPA&#39;</span><span class="p">)</span>
        <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;GM-UPB&#39;</span><span class="p">)</span>
        <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;GM-UTH&#39;</span><span class="p">)</span>
        <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;GM-UTHHE&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">return</span> <span class="n">meths</span></div>


<div class="viewcode-block" id="first_up"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.first_up">[docs]</a><span class="k">def</span> <span class="nf">first_up</span><span class="p">(</span><span class="n">ofile</span><span class="p">,</span> <span class="n">Rec</span><span class="p">,</span> <span class="n">file_type</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Writes the header for a MagIC template file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">keylist</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">pmag_out</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">ofile</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
    <span class="n">outstring</span> <span class="o">=</span> <span class="s2">&quot;tab </span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">file_type</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="n">pmag_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">outstring</span><span class="p">)</span>
    <span class="n">keystring</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Rec</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="n">keystring</span> <span class="o">=</span> <span class="n">keystring</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">key</span>
        <span class="n">keylist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">keystring</span> <span class="o">=</span> <span class="n">keystring</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">pmag_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">keystring</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
    <span class="n">pmag_out</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">keylist</span></div>


<span class="c1"># returns dictionary with average intensities from list of arbitrary</span>
<span class="c1"># dictinaries.</span>
<span class="k">def</span> <span class="nf">average_int</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">keybase</span><span class="p">,</span> <span class="n">outkey</span><span class="p">):</span>
    <span class="n">Ints</span><span class="p">,</span> <span class="n">DataRec</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="n">Ints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">keybase</span> <span class="o">+</span> <span class="s1">&#39;_int&#39;</span><span class="p">]))</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">Ints</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">b</span><span class="p">,</span> <span class="n">sig</span> <span class="o">=</span> <span class="n">gausspars</span><span class="p">(</span><span class="n">Ints</span><span class="p">)</span>
        <span class="n">sigperc</span> <span class="o">=</span> <span class="mf">100.</span> <span class="o">*</span> <span class="n">sig</span> <span class="o">/</span> <span class="n">b</span>
        <span class="n">DataRec</span><span class="p">[</span><span class="n">outkey</span> <span class="o">+</span> <span class="s2">&quot;_int_sigma&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%8.3e</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sig</span><span class="p">)</span>
        <span class="n">DataRec</span><span class="p">[</span><span class="n">outkey</span> <span class="o">+</span> <span class="s2">&quot;_int_sigma_perc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%5.1f</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sigperc</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># if only one, just copy over specimen data</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">Ints</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">DataRec</span><span class="p">[</span><span class="n">outkey</span> <span class="o">+</span> <span class="s2">&quot;_int_sigma&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">DataRec</span><span class="p">[</span><span class="n">outkey</span> <span class="o">+</span> <span class="s2">&quot;_int_sigma_perc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">DataRec</span><span class="p">[</span><span class="n">outkey</span> <span class="o">+</span> <span class="s2">&quot;_int&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%8.3e</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">b</span><span class="p">)</span>
    <span class="n">DataRec</span><span class="p">[</span><span class="n">outkey</span> <span class="o">+</span> <span class="s2">&quot;_int_n&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%i</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">DataRec</span>


<div class="viewcode-block" id="get_age"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.get_age">[docs]</a><span class="k">def</span> <span class="nf">get_age</span><span class="p">(</span><span class="n">Rec</span><span class="p">,</span> <span class="n">sitekey</span><span class="p">,</span> <span class="n">keybase</span><span class="p">,</span> <span class="n">Ages</span><span class="p">,</span> <span class="n">DefaultAge</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Finds the age record for a given site.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">site</span> <span class="o">=</span> <span class="n">Rec</span><span class="p">[</span><span class="n">sitekey</span><span class="p">]</span>
    <span class="n">gotone</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">Ages</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">agerec</span> <span class="ow">in</span> <span class="n">Ages</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">agerec</span><span class="p">[</span><span class="s2">&quot;er_site_name&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">site</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;age&quot;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">agerec</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="n">agerec</span><span class="p">[</span><span class="s2">&quot;age&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                    <span class="n">Rec</span><span class="p">[</span><span class="n">keybase</span> <span class="o">+</span> <span class="s2">&quot;age&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">agerec</span><span class="p">[</span><span class="s2">&quot;age&quot;</span><span class="p">]</span>
                    <span class="n">gotone</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="s2">&quot;age_unit&quot;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">agerec</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                    <span class="n">Rec</span><span class="p">[</span><span class="n">keybase</span> <span class="o">+</span> <span class="s2">&quot;age_unit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">agerec</span><span class="p">[</span><span class="s2">&quot;age_unit&quot;</span><span class="p">]</span>
                <span class="k">if</span> <span class="s2">&quot;age_sigma&quot;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">agerec</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                    <span class="n">Rec</span><span class="p">[</span><span class="n">keybase</span> <span class="o">+</span> <span class="s2">&quot;age_sigma&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">agerec</span><span class="p">[</span><span class="s2">&quot;age_sigma&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">gotone</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">DefaultAge</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">sigma</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">DefaultAge</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="nb">float</span><span class="p">(</span><span class="n">DefaultAge</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="n">age</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">DefaultAge</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="n">sigma</span>
        <span class="n">Rec</span><span class="p">[</span><span class="n">keybase</span> <span class="o">+</span> <span class="s2">&quot;age&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%10.4e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">age</span><span class="p">)</span>
        <span class="n">Rec</span><span class="p">[</span><span class="n">keybase</span> <span class="o">+</span> <span class="s2">&quot;age_sigma&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%10.4e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sigma</span><span class="p">)</span>
        <span class="n">Rec</span><span class="p">[</span><span class="n">keybase</span> <span class="o">+</span> <span class="s2">&quot;age_unit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">DefaultAge</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">Rec</span></div>
<span class="c1">#</span>


<div class="viewcode-block" id="adjust_ages"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.adjust_ages">[docs]</a><span class="k">def</span> <span class="nf">adjust_ages</span><span class="p">(</span><span class="n">AgesIn</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to adjust ages to a common age_unit.</span>
<span class="sd">    &quot;&quot;&quot;</span>
<span class="c1"># get a list of age_units first</span>
    <span class="n">age_units</span><span class="p">,</span> <span class="n">AgesOut</span><span class="p">,</span> <span class="n">factors</span><span class="p">,</span> <span class="n">factor</span><span class="p">,</span> <span class="n">maxunit</span><span class="p">,</span> <span class="n">age_unit</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Ma&quot;</span>
    <span class="k">for</span> <span class="n">agerec</span> <span class="ow">in</span> <span class="n">AgesIn</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">agerec</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">age_units</span><span class="p">:</span>
            <span class="n">age_units</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">agerec</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">agerec</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Ga&quot;</span><span class="p">:</span>
                <span class="n">factors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">1e9</span><span class="p">)</span>
                <span class="n">maxunit</span><span class="p">,</span> <span class="n">age_unit</span><span class="p">,</span> <span class="n">factor</span> <span class="o">=</span> <span class="mf">1e9</span><span class="p">,</span> <span class="s2">&quot;Ga&quot;</span><span class="p">,</span> <span class="mf">1e9</span>
            <span class="k">if</span> <span class="n">agerec</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Ma&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">maxunit</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">maxunit</span><span class="p">,</span> <span class="n">age_unt</span><span class="p">,</span> <span class="n">factor</span> <span class="o">=</span> <span class="mf">1e6</span><span class="p">,</span> <span class="s2">&quot;Ma&quot;</span><span class="p">,</span> <span class="mf">1e6</span>
                <span class="n">factors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">1e6</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">agerec</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Ka&quot;</span><span class="p">:</span>
                <span class="n">factors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">1e3</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">maxunit</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">maxunit</span><span class="p">,</span> <span class="n">age_unit</span><span class="p">,</span> <span class="n">factor</span> <span class="o">=</span> <span class="mf">1e3</span><span class="p">,</span> <span class="s2">&quot;Ka&quot;</span><span class="p">,</span> <span class="mf">1e3</span>
            <span class="k">if</span> <span class="s2">&quot;Years&quot;</span> <span class="ow">in</span> <span class="n">agerec</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">():</span>
                <span class="n">factors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">age_units</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># all ages are of same type</span>
        <span class="k">for</span> <span class="n">agerec</span> <span class="ow">in</span> <span class="n">AgesIn</span><span class="p">:</span>
            <span class="n">AgesOut</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">agerec</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">age_units</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">agerec</span> <span class="ow">in</span> <span class="n">AgesIn</span><span class="p">:</span>  <span class="c1"># normalize all to largest age unit</span>
            <span class="k">if</span> <span class="n">agerec</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Ga&quot;</span><span class="p">:</span>
                <span class="n">AgesOut</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">agerec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e9</span> <span class="o">/</span> <span class="n">factor</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">agerec</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Ma&quot;</span><span class="p">:</span>
                <span class="n">AgesOut</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">agerec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e6</span> <span class="o">/</span> <span class="n">factor</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">agerec</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Ka&quot;</span><span class="p">:</span>
                <span class="n">AgesOut</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">agerec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e3</span> <span class="o">/</span> <span class="n">factor</span><span class="p">)</span>
            <span class="k">if</span> <span class="s2">&quot;Years&quot;</span> <span class="ow">in</span> <span class="n">agerec</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">agerec</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Years BP&quot;</span><span class="p">:</span>
                    <span class="n">AgesOut</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">old_div</span><span class="p">(</span><span class="n">agerec</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">factor</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">agerec</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Years Cal BP&quot;</span><span class="p">:</span>
                    <span class="n">AgesOut</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">old_div</span><span class="p">(</span><span class="n">agerec</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">factor</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">agerec</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Years AD (+/-)&quot;</span><span class="p">:</span>
                    <span class="c1"># convert to years BP first</span>
                    <span class="n">AgesOut</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">old_div</span><span class="p">((</span><span class="mi">1950</span> <span class="o">-</span> <span class="n">agerec</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">factor</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">agerec</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Years Cal AD (+/-)&quot;</span><span class="p">:</span>
                    <span class="n">AgesOut</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">old_div</span><span class="p">((</span><span class="mi">1950</span> <span class="o">-</span> <span class="n">agerec</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">factor</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">AgesOut</span><span class="p">,</span> <span class="n">age_unit</span></div>
<span class="c1">#</span>


<div class="viewcode-block" id="gaussdev"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.gaussdev">[docs]</a><span class="k">def</span> <span class="nf">gaussdev</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a number randomly drawn from a gaussian distribution with the given mean, sigma</span>
<span class="sd">    </span>
<span class="sd">    Parmeters</span>
<span class="sd">    ---------</span>
<span class="sd">    mean : mean of the gaussian distribution from which to draw deviates</span>
<span class="sd">    sigma : standard deviation of same</span>
<span class="sd">    N : number of deviates desired</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    N deviates from the normal distribution</span>
<span class="sd">    </span>
<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; pmag.gaussdev(5.5,1.2,6)</span>
<span class="sd">    array([5.090856280215007, 3.305193918953536, 7.313490558588299,</span>
<span class="sd">           5.412029315803913, 6.819820301799303, 7.632257251681613])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>  <span class="c1"># return gaussian deviate</span></div>
<span class="c1">#</span>


<div class="viewcode-block" id="get_unf"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.get_unf">[docs]</a><span class="k">def</span> <span class="nf">get_unf</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates N uniformly distributed directions</span>
<span class="sd">    using the way described in Fisher et al. (1987).</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    N : number of directions, default is 100</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    array of nested dec, inc pairs</span>
<span class="sd">    </span>
<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; pmag.get_unf(5)</span>
<span class="sd">    array([[ 62.916547703466684, -30.751721919151798],</span>
<span class="sd">       [145.94851610484855 ,  76.45636268514875 ],</span>
<span class="sd">       [312.61910867788174 , -67.24338629811932 ],</span>
<span class="sd">       [ 61.71574344812653 ,  -4.005335509042522],</span>
<span class="sd">       [ 15.867001505749716,  -1.404412703673322]])</span>
<span class="sd">    &quot;&quot;&quot;</span>
<span class="c1">#</span>
<span class="c1"># get uniform directions  [dec,inc]</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">N</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">360.</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">N</span><span class="p">)</span>  <span class="c1"># decs</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">*</span> <span class="mf">180.</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>  <span class="c1"># incs</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">t</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>

<span class="c1"># def get_unf(N): #Jeff&#39;s way</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">     subroutine to retrieve N uniformly distributed directions</span>
<span class="sd">    &quot;&quot;&quot;</span></div>
<span class="c1">#    nmax,k=5550,66   # initialize stuff for uniform distribution</span>
<span class="c1">#    di,xn,yn,zn=[],[],[],[]</span>
<span class="c1">##</span>
<span class="c1"># get uniform direcctions (x,y,z)</span>
<span class="c1">#    for  i in range(1,k):</span>
<span class="c1">#        m = int(2*float(k)*np.sin(np.pi*float(i)/float(k)))</span>
<span class="c1">#        for j in range(m):</span>
<span class="c1">#            x=np.sin(np.pi*float(i)/float(k))*np.cos(2.*np.pi*float(j)/float(m))</span>
<span class="c1">#            y=np.sin(np.pi*float(i)/float(k))*np.sin(2.*np.pi*float(j)/float(m))</span>
<span class="c1">#            z=np.cos(np.pi*float(i)/float(k))</span>
<span class="c1">#            r=np.sqrt(x**2+y**2+z**2)</span>
<span class="c1">#            xn.append(x/r)</span>
<span class="c1">#            yn.append(y/r)</span>
<span class="c1">#            zn.append(z/r)</span>
<span class="c1">##</span>
<span class="c1"># select N random phi/theta from unf dist.</span>
<span class="c1">#</span>
<span class="c1">#    while len(di)&lt;N:</span>
<span class="c1">#        ind=random.randint(0,len(xn)-1)</span>
<span class="c1">#        dir=cart2dir((xn[ind],yn[ind],zn[ind]))</span>
<span class="c1">#        di.append([dir[0],dir[1]])</span>
<span class="c1">#    return di</span>
<span class="c1">##</span>


<div class="viewcode-block" id="s2a"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.s2a">[docs]</a><span class="k">def</span> <span class="nf">s2a</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert 6 element &quot;s&quot; list to 3x3 a matrix (see Tauxe 1998). </span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    s : six element list of floats</span>
<span class="sd">    </span>
<span class="sd">    Returns </span>
<span class="sd">    -------</span>
<span class="sd">    a : 3x3 matrix as an array</span>
<span class="sd">    </span>
<span class="sd">    Examples </span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; pmag.s2a([1,2,3,4,5,6])</span>
<span class="sd">    array([[1., 4., 6.],</span>
<span class="sd">       [4., 2., 5.],</span>
<span class="sd">       [6., 5., 3.]], dtype=float32)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,),</span> <span class="s1">&#39;f&#39;</span><span class="p">)</span>  <span class="c1"># make the a matrix</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">s</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">s</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
    <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="n">s</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">a</span></div>
<span class="c1">#</span>


<div class="viewcode-block" id="a2s"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.a2s">[docs]</a><span class="k">def</span> <span class="nf">a2s</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert 3x3 a matrix to 6 element &quot;s&quot; list  (see Tauxe 1998).</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : 3x3 matrix as an array</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    s : list of six elements based on a</span>
<span class="sd">    </span>
<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; pmag.a2s([[1, 4, 6],</span>
<span class="sd">                  [4, 2, 5],</span>
<span class="sd">                  [6, 5, 3]])</span>
<span class="sd">    array([1., 2., 3., 4., 5., 6.], dtype=float32)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">6</span><span class="p">,),</span> <span class="s1">&#39;f&#39;</span><span class="p">)</span>  <span class="c1"># make the a matrix</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
    <span class="n">s</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">s</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">s</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">s</span></div>


<div class="viewcode-block" id="doseigs"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.doseigs">[docs]</a><span class="k">def</span> <span class="nf">doseigs</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert s format for eigenvalues and eigenvectors.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    s : the six tensor elements as a list </span>
<span class="sd">        (s=[x11,x22,x33,x12,x23,x13])</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    A three element array and a nested list of dec, inc pairs</span>
<span class="sd">    tau : three element array ([t1,t2,t3])</span>
<span class="sd">        tau is an list of eigenvalues in decreasing order:</span>
<span class="sd">    V : second array ([[V1_dec,V1_inc],[V2_dec,V2_inc],[V3_dec,V3_inc]])</span>
<span class="sd">        is an list of the eigenvector directions</span>
<span class="sd">        </span>
<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; pmag.doseigs([1,2,3,4,5,6])</span>
<span class="sd">    ([2.021399, -0.33896524, -0.6824337],</span>
<span class="sd">     [[44.59696385583322, 40.45122920806129],</span>
<span class="sd">      [295.4500678147439, 21.04129013670037],</span>
<span class="sd">      [185.0807541485627, 42.138918019674385]])</span>
<span class="sd">    &quot;&quot;&quot;</span>
<span class="c1">#</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">s2a</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>  <span class="c1"># convert s to a (see Tauxe 1998)</span>
    <span class="n">tau</span><span class="p">,</span> <span class="n">V</span> <span class="o">=</span> <span class="n">tauV</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>  <span class="c1"># convert to eigenvalues (t), eigenvectors (V)</span>
    <span class="n">Vdirs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">V</span><span class="p">:</span>  <span class="c1"># convert from cartesian to direction</span>
        <span class="n">Vdir</span> <span class="o">=</span> <span class="n">cart2dir</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Vdir</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">Vdir</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">Vdir</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">Vdir</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">Vdir</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mf">180.</span><span class="p">)</span> <span class="o">%</span> <span class="mf">360.</span>
        <span class="n">Vdirs</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">Vdir</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Vdir</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
    <span class="k">return</span> <span class="n">tau</span><span class="p">,</span> <span class="n">Vdirs</span></div>
<span class="c1">#</span>
<span class="c1">#</span>


<div class="viewcode-block" id="doeigs_s"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.doeigs_s">[docs]</a><span class="k">def</span> <span class="nf">doeigs_s</span><span class="p">(</span><span class="n">tau</span><span class="p">,</span> <span class="n">Vdirs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Gets elements of s from eigenvaulues - note that this is very unstable.</span>
<span class="sd">     </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    tau : 3 element array</span>
<span class="sd">        list of eigenvalues in decreasing order: [t1,t2,t3]</span>
<span class="sd">    V : list of the eigenvector directions</span>
<span class="sd">        [[V1_dec,V1_inc],[V2_dec,V2_inc],[V3_dec,V3_inc]]</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    The six tensor elements as a list:</span>
<span class="sd">        s = [x11,x22,x33,x12,x23,x13]</span>
<span class="sd">    </span>
<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; pmag.doeigs_s([2.2, -0.33, -0.68],</span>
<span class="sd">         [[44.59, 40.45],</span>
<span class="sd">          [295.45, 21.04],</span>
<span class="sd">          [185.08, 42.13]])</span>
<span class="sd">    array([0.22194667, 0.3905577 , 0.57749563, 0.7154779 , 0.8923144 ,</span>
<span class="sd">       1.0629525 ], dtype=float32)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,),</span> <span class="s1">&#39;f&#39;</span><span class="p">)</span>  <span class="c1"># initialize the tau diagonal matrix</span>
    <span class="n">V</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">t</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">tau</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>  <span class="c1"># diagonalize tau</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">V</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dir2cart</span><span class="p">([</span><span class="n">Vdirs</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">Vdirs</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="mf">1.0</span><span class="p">]))</span>
    <span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
    <span class="n">chi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">V</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">a2s</span><span class="p">(</span><span class="n">chi</span><span class="p">)</span></div>

<span class="c1">#</span>
<span class="c1">#</span>


<div class="viewcode-block" id="fcalc"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.fcalc">[docs]</a><span class="k">def</span> <span class="nf">fcalc</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">row</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Looks up an F-test stastic from F tables F(col,row), where row is number of degrees of freedom - this is 95% confidence (p=0.05).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    col : degrees of freedom column</span>
<span class="sd">    row : degrees of freedom row</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    F : value for 95% confidence from the F-table</span>
<span class="sd">    </span>
<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; pmag.fcalc(3,4.8)</span>
<span class="sd">    6.5915</span>
<span class="sd">    &quot;&quot;&quot;</span>
<span class="c1">#</span>
    <span class="k">if</span> <span class="n">row</span> <span class="o">&gt;</span> <span class="mi">200</span><span class="p">:</span>
        <span class="n">row</span> <span class="o">=</span> <span class="mi">200</span>
    <span class="k">if</span> <span class="n">col</span> <span class="o">&gt;</span> <span class="mi">20</span><span class="p">:</span>
        <span class="n">col</span> <span class="o">=</span> <span class="mi">20</span>
    <span class="n">ftest</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">161.469</span><span class="p">,</span> <span class="mf">199.493</span><span class="p">,</span> <span class="mf">215.737</span><span class="p">,</span> <span class="mf">224.5</span><span class="p">,</span> <span class="mf">230.066</span><span class="p">,</span> <span class="mf">234.001</span><span class="p">,</span> <span class="mf">236.772</span><span class="p">,</span> <span class="mf">238.949</span><span class="p">,</span> <span class="mf">240.496</span><span class="p">,</span> <span class="mf">241.838</span><span class="p">,</span>
                       <span class="mf">242.968</span><span class="p">,</span> <span class="mf">243.88</span><span class="p">,</span> <span class="mf">244.798</span><span class="p">,</span> <span class="mf">245.26</span><span class="p">,</span> <span class="mf">245.956</span><span class="p">,</span> <span class="mf">246.422</span><span class="p">,</span> <span class="mf">246.89</span><span class="p">,</span> <span class="mf">247.36</span><span class="p">,</span> <span class="mf">247.596</span><span class="p">,</span> <span class="mf">248.068</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mf">18.5128</span><span class="p">,</span> <span class="mf">18.9995</span><span class="p">,</span> <span class="mf">19.1642</span><span class="p">,</span> <span class="mf">19.2467</span><span class="p">,</span> <span class="mf">19.2969</span><span class="p">,</span> <span class="mf">19.3299</span><span class="p">,</span> <span class="mf">19.3536</span><span class="p">,</span> <span class="mf">19.371</span><span class="p">,</span> <span class="mf">19.3852</span><span class="p">,</span> <span class="mf">19.3963</span><span class="p">,</span>
                       <span class="mf">19.4043</span><span class="p">,</span> <span class="mf">19.4122</span><span class="p">,</span> <span class="mf">19.4186</span><span class="p">,</span> <span class="mf">19.425</span><span class="p">,</span> <span class="mf">19.4297</span><span class="p">,</span> <span class="mf">19.4329</span><span class="p">,</span> <span class="mf">19.4377</span><span class="p">,</span> <span class="mf">19.4409</span><span class="p">,</span> <span class="mf">19.4425</span><span class="p">,</span> <span class="mf">19.4457</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mf">10.1278</span><span class="p">,</span> <span class="mf">9.5522</span><span class="p">,</span> <span class="mf">9.2767</span><span class="p">,</span> <span class="mf">9.1173</span><span class="p">,</span> <span class="mf">9.0133</span><span class="p">,</span> <span class="mf">8.9408</span><span class="p">,</span> <span class="mf">8.8868</span><span class="p">,</span> <span class="mf">8.8452</span><span class="p">,</span> <span class="mf">8.8124</span><span class="p">,</span> <span class="mf">8.7857</span><span class="p">,</span>
                       <span class="mf">8.7635</span><span class="p">,</span> <span class="mf">8.7446</span><span class="p">,</span> <span class="mf">8.7287</span><span class="p">,</span> <span class="mf">8.715</span><span class="p">,</span> <span class="mf">8.7028</span><span class="p">,</span> <span class="mf">8.6923</span><span class="p">,</span> <span class="mf">8.683</span><span class="p">,</span> <span class="mf">8.6745</span><span class="p">,</span> <span class="mf">8.667</span><span class="p">,</span> <span class="mf">8.6602</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mf">7.7087</span><span class="p">,</span> <span class="mf">6.9444</span><span class="p">,</span> <span class="mf">6.5915</span><span class="p">,</span> <span class="mf">6.3882</span><span class="p">,</span> <span class="mf">6.2561</span><span class="p">,</span> <span class="mf">6.1631</span><span class="p">,</span> <span class="mf">6.0943</span><span class="p">,</span> <span class="mf">6.0411</span><span class="p">,</span> <span class="mf">5.9988</span><span class="p">,</span> <span class="mf">5.9644</span><span class="p">,</span>
                       <span class="mf">5.9359</span><span class="p">,</span> <span class="mf">5.9117</span><span class="p">,</span> <span class="mf">5.8912</span><span class="p">,</span> <span class="mf">5.8733</span><span class="p">,</span> <span class="mf">5.8578</span><span class="p">,</span> <span class="mf">5.844</span><span class="p">,</span> <span class="mf">5.8319</span><span class="p">,</span> <span class="mf">5.8211</span><span class="p">,</span> <span class="mf">5.8113</span><span class="p">,</span> <span class="mf">5.8025</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mf">6.608</span><span class="p">,</span> <span class="mf">5.7861</span><span class="p">,</span> <span class="mf">5.4095</span><span class="p">,</span> <span class="mf">5.1922</span><span class="p">,</span> <span class="mf">5.0503</span><span class="p">,</span> <span class="mf">4.9503</span><span class="p">,</span> <span class="mf">4.8759</span><span class="p">,</span> <span class="mf">4.8184</span><span class="p">,</span> <span class="mf">4.7725</span><span class="p">,</span> <span class="mf">4.735</span><span class="p">,</span>
                       <span class="mf">4.7039</span><span class="p">,</span> <span class="mf">4.6777</span><span class="p">,</span> <span class="mf">4.6552</span><span class="p">,</span> <span class="mf">4.6358</span><span class="p">,</span> <span class="mf">4.6187</span><span class="p">,</span> <span class="mf">4.6038</span><span class="p">,</span> <span class="mf">4.5904</span><span class="p">,</span> <span class="mf">4.5785</span><span class="p">,</span> <span class="mf">4.5679</span><span class="p">,</span> <span class="mf">4.5581</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mf">5.9874</span><span class="p">,</span> <span class="mf">5.1433</span><span class="p">,</span> <span class="mf">4.757</span><span class="p">,</span> <span class="mf">4.5337</span><span class="p">,</span> <span class="mf">4.3874</span><span class="p">,</span> <span class="mf">4.2838</span><span class="p">,</span> <span class="mf">4.2067</span><span class="p">,</span> <span class="mf">4.1468</span><span class="p">,</span> <span class="mf">4.099</span><span class="p">,</span> <span class="mf">4.06</span><span class="p">,</span>
                       <span class="mf">4.0275</span><span class="p">,</span> <span class="mf">3.9999</span><span class="p">,</span> <span class="mf">3.9764</span><span class="p">,</span> <span class="mf">3.956</span><span class="p">,</span> <span class="mf">3.9381</span><span class="p">,</span> <span class="mf">3.9223</span><span class="p">,</span> <span class="mf">3.9083</span><span class="p">,</span> <span class="mf">3.8957</span><span class="p">,</span> <span class="mf">3.8844</span><span class="p">,</span> <span class="mf">3.8742</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mf">5.5914</span><span class="p">,</span> <span class="mf">4.7374</span><span class="p">,</span> <span class="mf">4.3469</span><span class="p">,</span> <span class="mf">4.1204</span><span class="p">,</span> <span class="mf">3.9715</span><span class="p">,</span> <span class="mf">3.866</span><span class="p">,</span> <span class="mf">3.787</span><span class="p">,</span> <span class="mf">3.7257</span><span class="p">,</span> <span class="mf">3.6767</span><span class="p">,</span> <span class="mf">3.6366</span><span class="p">,</span>
                       <span class="mf">3.603</span><span class="p">,</span> <span class="mf">3.5747</span><span class="p">,</span> <span class="mf">3.5504</span><span class="p">,</span> <span class="mf">3.5292</span><span class="p">,</span> <span class="mf">3.5107</span><span class="p">,</span> <span class="mf">3.4944</span><span class="p">,</span> <span class="mf">3.4799</span><span class="p">,</span> <span class="mf">3.4669</span><span class="p">,</span> <span class="mf">3.4552</span><span class="p">,</span> <span class="mf">3.4445</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mf">5.3177</span><span class="p">,</span> <span class="mf">4.459</span><span class="p">,</span> <span class="mf">4.0662</span><span class="p">,</span> <span class="mf">3.8378</span><span class="p">,</span> <span class="mf">3.6875</span><span class="p">,</span> <span class="mf">3.5806</span><span class="p">,</span> <span class="mf">3.5004</span><span class="p">,</span> <span class="mf">3.4381</span><span class="p">,</span> <span class="mf">3.3881</span><span class="p">,</span> <span class="mf">3.3472</span><span class="p">,</span>
                       <span class="mf">3.313</span><span class="p">,</span> <span class="mf">3.2839</span><span class="p">,</span> <span class="mf">3.259</span><span class="p">,</span> <span class="mf">3.2374</span><span class="p">,</span> <span class="mf">3.2184</span><span class="p">,</span> <span class="mf">3.2017</span><span class="p">,</span> <span class="mf">3.1867</span><span class="p">,</span> <span class="mf">3.1733</span><span class="p">,</span> <span class="mf">3.1613</span><span class="p">,</span> <span class="mf">3.1503</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mf">5.1174</span><span class="p">,</span> <span class="mf">4.2565</span><span class="p">,</span> <span class="mf">3.8626</span><span class="p">,</span> <span class="mf">3.6331</span><span class="p">,</span> <span class="mf">3.4817</span><span class="p">,</span> <span class="mf">3.3738</span><span class="p">,</span> <span class="mf">3.2928</span><span class="p">,</span> <span class="mf">3.2296</span><span class="p">,</span> <span class="mf">3.1789</span><span class="p">,</span> <span class="mf">3.1373</span><span class="p">,</span>
                       <span class="mf">3.1025</span><span class="p">,</span> <span class="mf">3.0729</span><span class="p">,</span> <span class="mf">3.0475</span><span class="p">,</span> <span class="mf">3.0255</span><span class="p">,</span> <span class="mf">3.0061</span><span class="p">,</span> <span class="mf">2.989</span><span class="p">,</span> <span class="mf">2.9737</span><span class="p">,</span> <span class="mf">2.96</span><span class="p">,</span> <span class="mf">2.9476</span><span class="p">,</span> <span class="mf">2.9365</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mf">4.9647</span><span class="p">,</span> <span class="mf">4.1028</span><span class="p">,</span> <span class="mf">3.7083</span><span class="p">,</span> <span class="mf">3.4781</span><span class="p">,</span> <span class="mf">3.3258</span><span class="p">,</span> <span class="mf">3.2171</span><span class="p">,</span> <span class="mf">3.1355</span><span class="p">,</span> <span class="mf">3.0717</span><span class="p">,</span> <span class="mf">3.0204</span><span class="p">,</span> <span class="mf">2.9782</span><span class="p">,</span>
                       <span class="mf">2.9429</span><span class="p">,</span> <span class="mf">2.913</span><span class="p">,</span> <span class="mf">2.8872</span><span class="p">,</span> <span class="mf">2.8648</span><span class="p">,</span> <span class="mf">2.845</span><span class="p">,</span> <span class="mf">2.8276</span><span class="p">,</span> <span class="mf">2.812</span><span class="p">,</span> <span class="mf">2.7981</span><span class="p">,</span> <span class="mf">2.7855</span><span class="p">,</span> <span class="mf">2.774</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mf">4.8443</span><span class="p">,</span> <span class="mf">3.9823</span><span class="p">,</span> <span class="mf">3.5875</span><span class="p">,</span> <span class="mf">3.3567</span><span class="p">,</span> <span class="mf">3.2039</span><span class="p">,</span> <span class="mf">3.0946</span><span class="p">,</span> <span class="mf">3.0123</span><span class="p">,</span> <span class="mf">2.948</span><span class="p">,</span> <span class="mf">2.8962</span><span class="p">,</span> <span class="mf">2.8536</span><span class="p">,</span>
                       <span class="mf">2.8179</span><span class="p">,</span> <span class="mf">2.7876</span><span class="p">,</span> <span class="mf">2.7614</span><span class="p">,</span> <span class="mf">2.7386</span><span class="p">,</span> <span class="mf">2.7186</span><span class="p">,</span> <span class="mf">2.7009</span><span class="p">,</span> <span class="mf">2.6851</span><span class="p">,</span> <span class="mf">2.6709</span><span class="p">,</span> <span class="mf">2.6581</span><span class="p">,</span> <span class="mf">2.6464</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mf">4.7472</span><span class="p">,</span> <span class="mf">3.8853</span><span class="p">,</span> <span class="mf">3.4903</span><span class="p">,</span> <span class="mf">3.2592</span><span class="p">,</span> <span class="mf">3.1059</span><span class="p">,</span> <span class="mf">2.9961</span><span class="p">,</span> <span class="mf">2.9134</span><span class="p">,</span> <span class="mf">2.8486</span><span class="p">,</span> <span class="mf">2.7964</span><span class="p">,</span> <span class="mf">2.7534</span><span class="p">,</span>
                       <span class="mf">2.7173</span><span class="p">,</span> <span class="mf">2.6866</span><span class="p">,</span> <span class="mf">2.6602</span><span class="p">,</span> <span class="mf">2.6371</span><span class="p">,</span> <span class="mf">2.6169</span><span class="p">,</span> <span class="mf">2.5989</span><span class="p">,</span> <span class="mf">2.5828</span><span class="p">,</span> <span class="mf">2.5684</span><span class="p">,</span> <span class="mf">2.5554</span><span class="p">,</span> <span class="mf">2.5436</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">13</span><span class="p">,</span> <span class="mf">4.6672</span><span class="p">,</span> <span class="mf">3.8055</span><span class="p">,</span> <span class="mf">3.4106</span><span class="p">,</span> <span class="mf">3.1791</span><span class="p">,</span> <span class="mf">3.0255</span><span class="p">,</span> <span class="mf">2.9153</span><span class="p">,</span> <span class="mf">2.8321</span><span class="p">,</span> <span class="mf">2.7669</span><span class="p">,</span> <span class="mf">2.7144</span><span class="p">,</span> <span class="mf">2.6711</span><span class="p">,</span>
                       <span class="mf">2.6347</span><span class="p">,</span> <span class="mf">2.6037</span><span class="p">,</span> <span class="mf">2.5769</span><span class="p">,</span> <span class="mf">2.5536</span><span class="p">,</span> <span class="mf">2.5331</span><span class="p">,</span> <span class="mf">2.5149</span><span class="p">,</span> <span class="mf">2.4987</span><span class="p">,</span> <span class="mf">2.4841</span><span class="p">,</span> <span class="mf">2.4709</span><span class="p">,</span> <span class="mf">2.4589</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">14</span><span class="p">,</span> <span class="mf">4.6001</span><span class="p">,</span> <span class="mf">3.7389</span><span class="p">,</span> <span class="mf">3.3439</span><span class="p">,</span> <span class="mf">3.1122</span><span class="p">,</span> <span class="mf">2.9582</span><span class="p">,</span> <span class="mf">2.8477</span><span class="p">,</span> <span class="mf">2.7642</span><span class="p">,</span> <span class="mf">2.6987</span><span class="p">,</span> <span class="mf">2.6458</span><span class="p">,</span> <span class="mf">2.6021</span><span class="p">,</span>
                       <span class="mf">2.5655</span><span class="p">,</span> <span class="mf">2.5343</span><span class="p">,</span> <span class="mf">2.5073</span><span class="p">,</span> <span class="mf">2.4837</span><span class="p">,</span> <span class="mf">2.463</span><span class="p">,</span> <span class="mf">2.4446</span><span class="p">,</span> <span class="mf">2.4282</span><span class="p">,</span> <span class="mf">2.4134</span><span class="p">,</span> <span class="mf">2.4</span><span class="p">,</span> <span class="mf">2.3879</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mf">4.543</span><span class="p">,</span> <span class="mf">3.6824</span><span class="p">,</span> <span class="mf">3.2874</span><span class="p">,</span> <span class="mf">3.0555</span><span class="p">,</span> <span class="mf">2.9013</span><span class="p">,</span> <span class="mf">2.7905</span><span class="p">,</span> <span class="mf">2.7066</span><span class="p">,</span> <span class="mf">2.6408</span><span class="p">,</span> <span class="mf">2.5877</span><span class="p">,</span> <span class="mf">2.5437</span><span class="p">,</span>
                       <span class="mf">2.5068</span><span class="p">,</span> <span class="mf">2.4753</span><span class="p">,</span> <span class="mf">2.4481</span><span class="p">,</span> <span class="mf">2.4244</span><span class="p">,</span> <span class="mf">2.4034</span><span class="p">,</span> <span class="mf">2.3849</span><span class="p">,</span> <span class="mf">2.3683</span><span class="p">,</span> <span class="mf">2.3533</span><span class="p">,</span> <span class="mf">2.3398</span><span class="p">,</span> <span class="mf">2.3275</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mf">4.494</span><span class="p">,</span> <span class="mf">3.6337</span><span class="p">,</span> <span class="mf">3.2389</span><span class="p">,</span> <span class="mf">3.0069</span><span class="p">,</span> <span class="mf">2.8524</span><span class="p">,</span> <span class="mf">2.7413</span><span class="p">,</span> <span class="mf">2.6572</span><span class="p">,</span> <span class="mf">2.5911</span><span class="p">,</span> <span class="mf">2.5377</span><span class="p">,</span> <span class="mf">2.4935</span><span class="p">,</span>
                       <span class="mf">2.4564</span><span class="p">,</span> <span class="mf">2.4247</span><span class="p">,</span> <span class="mf">2.3973</span><span class="p">,</span> <span class="mf">2.3733</span><span class="p">,</span> <span class="mf">2.3522</span><span class="p">,</span> <span class="mf">2.3335</span><span class="p">,</span> <span class="mf">2.3167</span><span class="p">,</span> <span class="mf">2.3016</span><span class="p">,</span> <span class="mf">2.288</span><span class="p">,</span> <span class="mf">2.2756</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="mf">4.4513</span><span class="p">,</span> <span class="mf">3.5916</span><span class="p">,</span> <span class="mf">3.1968</span><span class="p">,</span> <span class="mf">2.9647</span><span class="p">,</span> <span class="mf">2.81</span><span class="p">,</span> <span class="mf">2.6987</span><span class="p">,</span> <span class="mf">2.6143</span><span class="p">,</span> <span class="mf">2.548</span><span class="p">,</span> <span class="mf">2.4943</span><span class="p">,</span> <span class="mf">2.4499</span><span class="p">,</span>
                       <span class="mf">2.4126</span><span class="p">,</span> <span class="mf">2.3807</span><span class="p">,</span> <span class="mf">2.3531</span><span class="p">,</span> <span class="mf">2.329</span><span class="p">,</span> <span class="mf">2.3077</span><span class="p">,</span> <span class="mf">2.2888</span><span class="p">,</span> <span class="mf">2.2719</span><span class="p">,</span> <span class="mf">2.2567</span><span class="p">,</span> <span class="mf">2.2429</span><span class="p">,</span> <span class="mf">2.2303</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">18</span><span class="p">,</span> <span class="mf">4.4139</span><span class="p">,</span> <span class="mf">3.5546</span><span class="p">,</span> <span class="mf">3.1599</span><span class="p">,</span> <span class="mf">2.9278</span><span class="p">,</span> <span class="mf">2.7729</span><span class="p">,</span> <span class="mf">2.6613</span><span class="p">,</span> <span class="mf">2.5767</span><span class="p">,</span> <span class="mf">2.5102</span><span class="p">,</span> <span class="mf">2.4563</span><span class="p">,</span> <span class="mf">2.4117</span><span class="p">,</span>
                       <span class="mf">2.3742</span><span class="p">,</span> <span class="mf">2.3421</span><span class="p">,</span> <span class="mf">2.3143</span><span class="p">,</span> <span class="mf">2.29</span><span class="p">,</span> <span class="mf">2.2686</span><span class="p">,</span> <span class="mf">2.2496</span><span class="p">,</span> <span class="mf">2.2325</span><span class="p">,</span> <span class="mf">2.2172</span><span class="p">,</span> <span class="mf">2.2033</span><span class="p">,</span> <span class="mf">2.1906</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">19</span><span class="p">,</span> <span class="mf">4.3808</span><span class="p">,</span> <span class="mf">3.5219</span><span class="p">,</span> <span class="mf">3.1274</span><span class="p">,</span> <span class="mf">2.8951</span><span class="p">,</span> <span class="mf">2.7401</span><span class="p">,</span> <span class="mf">2.6283</span><span class="p">,</span> <span class="mf">2.5435</span><span class="p">,</span> <span class="mf">2.4768</span><span class="p">,</span> <span class="mf">2.4227</span><span class="p">,</span> <span class="mf">2.378</span><span class="p">,</span>
                       <span class="mf">2.3402</span><span class="p">,</span> <span class="mf">2.308</span><span class="p">,</span> <span class="mf">2.28</span><span class="p">,</span> <span class="mf">2.2556</span><span class="p">,</span> <span class="mf">2.2341</span><span class="p">,</span> <span class="mf">2.2149</span><span class="p">,</span> <span class="mf">2.1977</span><span class="p">,</span> <span class="mf">2.1823</span><span class="p">,</span> <span class="mf">2.1683</span><span class="p">,</span> <span class="mf">2.1555</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mf">4.3512</span><span class="p">,</span> <span class="mf">3.4928</span><span class="p">,</span> <span class="mf">3.0984</span><span class="p">,</span> <span class="mf">2.8661</span><span class="p">,</span> <span class="mf">2.7109</span><span class="p">,</span> <span class="mf">2.599</span><span class="p">,</span> <span class="mf">2.514</span><span class="p">,</span> <span class="mf">2.4471</span><span class="p">,</span> <span class="mf">2.3928</span><span class="p">,</span> <span class="mf">2.3479</span><span class="p">,</span>
                       <span class="mf">2.31</span><span class="p">,</span> <span class="mf">2.2776</span><span class="p">,</span> <span class="mf">2.2495</span><span class="p">,</span> <span class="mf">2.2249</span><span class="p">,</span> <span class="mf">2.2033</span><span class="p">,</span> <span class="mf">2.184</span><span class="p">,</span> <span class="mf">2.1667</span><span class="p">,</span> <span class="mf">2.1511</span><span class="p">,</span> <span class="mf">2.137</span><span class="p">,</span> <span class="mf">2.1242</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">21</span><span class="p">,</span> <span class="mf">4.3248</span><span class="p">,</span> <span class="mf">3.4668</span><span class="p">,</span> <span class="mf">3.0725</span><span class="p">,</span> <span class="mf">2.8401</span><span class="p">,</span> <span class="mf">2.6848</span><span class="p">,</span> <span class="mf">2.5727</span><span class="p">,</span> <span class="mf">2.4876</span><span class="p">,</span> <span class="mf">2.4205</span><span class="p">,</span> <span class="mf">2.3661</span><span class="p">,</span> <span class="mf">2.3209</span><span class="p">,</span>
                       <span class="mf">2.2829</span><span class="p">,</span> <span class="mf">2.2504</span><span class="p">,</span> <span class="mf">2.2222</span><span class="p">,</span> <span class="mf">2.1975</span><span class="p">,</span> <span class="mf">2.1757</span><span class="p">,</span> <span class="mf">2.1563</span><span class="p">,</span> <span class="mf">2.1389</span><span class="p">,</span> <span class="mf">2.1232</span><span class="p">,</span> <span class="mf">2.109</span><span class="p">,</span> <span class="mf">2.096</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">22</span><span class="p">,</span> <span class="mf">4.3009</span><span class="p">,</span> <span class="mf">3.4434</span><span class="p">,</span> <span class="mf">3.0492</span><span class="p">,</span> <span class="mf">2.8167</span><span class="p">,</span> <span class="mf">2.6613</span><span class="p">,</span> <span class="mf">2.5491</span><span class="p">,</span> <span class="mf">2.4638</span><span class="p">,</span> <span class="mf">2.3965</span><span class="p">,</span> <span class="mf">2.3419</span><span class="p">,</span> <span class="mf">2.2967</span><span class="p">,</span>
                       <span class="mf">2.2585</span><span class="p">,</span> <span class="mf">2.2258</span><span class="p">,</span> <span class="mf">2.1975</span><span class="p">,</span> <span class="mf">2.1727</span><span class="p">,</span> <span class="mf">2.1508</span><span class="p">,</span> <span class="mf">2.1313</span><span class="p">,</span> <span class="mf">2.1138</span><span class="p">,</span> <span class="mf">2.098</span><span class="p">,</span> <span class="mf">2.0837</span><span class="p">,</span> <span class="mf">2.0707</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">23</span><span class="p">,</span> <span class="mf">4.2794</span><span class="p">,</span> <span class="mf">3.4221</span><span class="p">,</span> <span class="mf">3.028</span><span class="p">,</span> <span class="mf">2.7955</span><span class="p">,</span> <span class="mf">2.64</span><span class="p">,</span> <span class="mf">2.5276</span><span class="p">,</span> <span class="mf">2.4422</span><span class="p">,</span> <span class="mf">2.3748</span><span class="p">,</span> <span class="mf">2.3201</span><span class="p">,</span> <span class="mf">2.2747</span><span class="p">,</span>
                       <span class="mf">2.2364</span><span class="p">,</span> <span class="mf">2.2036</span><span class="p">,</span> <span class="mf">2.1752</span><span class="p">,</span> <span class="mf">2.1503</span><span class="p">,</span> <span class="mf">2.1282</span><span class="p">,</span> <span class="mf">2.1086</span><span class="p">,</span> <span class="mf">2.091</span><span class="p">,</span> <span class="mf">2.0751</span><span class="p">,</span> <span class="mf">2.0608</span><span class="p">,</span> <span class="mf">2.0476</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">24</span><span class="p">,</span> <span class="mf">4.2597</span><span class="p">,</span> <span class="mf">3.4029</span><span class="p">,</span> <span class="mf">3.0088</span><span class="p">,</span> <span class="mf">2.7763</span><span class="p">,</span> <span class="mf">2.6206</span><span class="p">,</span> <span class="mf">2.5082</span><span class="p">,</span> <span class="mf">2.4226</span><span class="p">,</span> <span class="mf">2.3551</span><span class="p">,</span> <span class="mf">2.3003</span><span class="p">,</span> <span class="mf">2.2547</span><span class="p">,</span>
                       <span class="mf">2.2163</span><span class="p">,</span> <span class="mf">2.1834</span><span class="p">,</span> <span class="mf">2.1548</span><span class="p">,</span> <span class="mf">2.1298</span><span class="p">,</span> <span class="mf">2.1077</span><span class="p">,</span> <span class="mf">2.088</span><span class="p">,</span> <span class="mf">2.0703</span><span class="p">,</span> <span class="mf">2.0543</span><span class="p">,</span> <span class="mf">2.0399</span><span class="p">,</span> <span class="mf">2.0267</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mf">4.2417</span><span class="p">,</span> <span class="mf">3.3852</span><span class="p">,</span> <span class="mf">2.9913</span><span class="p">,</span> <span class="mf">2.7587</span><span class="p">,</span> <span class="mf">2.603</span><span class="p">,</span> <span class="mf">2.4904</span><span class="p">,</span> <span class="mf">2.4047</span><span class="p">,</span> <span class="mf">2.3371</span><span class="p">,</span> <span class="mf">2.2821</span><span class="p">,</span> <span class="mf">2.2365</span><span class="p">,</span>
                       <span class="mf">2.1979</span><span class="p">,</span> <span class="mf">2.1649</span><span class="p">,</span> <span class="mf">2.1362</span><span class="p">,</span> <span class="mf">2.1111</span><span class="p">,</span> <span class="mf">2.0889</span><span class="p">,</span> <span class="mf">2.0691</span><span class="p">,</span> <span class="mf">2.0513</span><span class="p">,</span> <span class="mf">2.0353</span><span class="p">,</span> <span class="mf">2.0207</span><span class="p">,</span> <span class="mf">2.0075</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">26</span><span class="p">,</span> <span class="mf">4.2252</span><span class="p">,</span> <span class="mf">3.369</span><span class="p">,</span> <span class="mf">2.9752</span><span class="p">,</span> <span class="mf">2.7426</span><span class="p">,</span> <span class="mf">2.5868</span><span class="p">,</span> <span class="mf">2.4741</span><span class="p">,</span> <span class="mf">2.3883</span><span class="p">,</span> <span class="mf">2.3205</span><span class="p">,</span> <span class="mf">2.2655</span><span class="p">,</span> <span class="mf">2.2197</span><span class="p">,</span>
                       <span class="mf">2.1811</span><span class="p">,</span> <span class="mf">2.1479</span><span class="p">,</span> <span class="mf">2.1192</span><span class="p">,</span> <span class="mf">2.094</span><span class="p">,</span> <span class="mf">2.0716</span><span class="p">,</span> <span class="mf">2.0518</span><span class="p">,</span> <span class="mf">2.0339</span><span class="p">,</span> <span class="mf">2.0178</span><span class="p">,</span> <span class="mf">2.0032</span><span class="p">,</span> <span class="mf">1.9898</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">27</span><span class="p">,</span> <span class="mf">4.21</span><span class="p">,</span> <span class="mf">3.3542</span><span class="p">,</span> <span class="mf">2.9603</span><span class="p">,</span> <span class="mf">2.7277</span><span class="p">,</span> <span class="mf">2.5719</span><span class="p">,</span> <span class="mf">2.4591</span><span class="p">,</span> <span class="mf">2.3732</span><span class="p">,</span> <span class="mf">2.3053</span><span class="p">,</span> <span class="mf">2.2501</span><span class="p">,</span> <span class="mf">2.2043</span><span class="p">,</span>
                       <span class="mf">2.1656</span><span class="p">,</span> <span class="mf">2.1323</span><span class="p">,</span> <span class="mf">2.1035</span><span class="p">,</span> <span class="mf">2.0782</span><span class="p">,</span> <span class="mf">2.0558</span><span class="p">,</span> <span class="mf">2.0358</span><span class="p">,</span> <span class="mf">2.0179</span><span class="p">,</span> <span class="mf">2.0017</span><span class="p">,</span> <span class="mf">1.987</span><span class="p">,</span> <span class="mf">1.9736</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">28</span><span class="p">,</span> <span class="mf">4.196</span><span class="p">,</span> <span class="mf">3.3404</span><span class="p">,</span> <span class="mf">2.9467</span><span class="p">,</span> <span class="mf">2.7141</span><span class="p">,</span> <span class="mf">2.5581</span><span class="p">,</span> <span class="mf">2.4453</span><span class="p">,</span> <span class="mf">2.3592</span><span class="p">,</span> <span class="mf">2.2913</span><span class="p">,</span> <span class="mf">2.236</span><span class="p">,</span> <span class="mf">2.1901</span><span class="p">,</span>
                       <span class="mf">2.1512</span><span class="p">,</span> <span class="mf">2.1179</span><span class="p">,</span> <span class="mf">2.0889</span><span class="p">,</span> <span class="mf">2.0636</span><span class="p">,</span> <span class="mf">2.0411</span><span class="p">,</span> <span class="mf">2.021</span><span class="p">,</span> <span class="mf">2.0031</span><span class="p">,</span> <span class="mf">1.9868</span><span class="p">,</span> <span class="mf">1.972</span><span class="p">,</span> <span class="mf">1.9586</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">29</span><span class="p">,</span> <span class="mf">4.1829</span><span class="p">,</span> <span class="mf">3.3276</span><span class="p">,</span> <span class="mf">2.9341</span><span class="p">,</span> <span class="mf">2.7014</span><span class="p">,</span> <span class="mf">2.5454</span><span class="p">,</span> <span class="mf">2.4324</span><span class="p">,</span> <span class="mf">2.3463</span><span class="p">,</span> <span class="mf">2.2783</span><span class="p">,</span> <span class="mf">2.2229</span><span class="p">,</span> <span class="mf">2.1768</span><span class="p">,</span>
                       <span class="mf">2.1379</span><span class="p">,</span> <span class="mf">2.1045</span><span class="p">,</span> <span class="mf">2.0755</span><span class="p">,</span> <span class="mf">2.05</span><span class="p">,</span> <span class="mf">2.0275</span><span class="p">,</span> <span class="mf">2.0074</span><span class="p">,</span> <span class="mf">1.9893</span><span class="p">,</span> <span class="mf">1.973</span><span class="p">,</span> <span class="mf">1.9582</span><span class="p">,</span> <span class="mf">1.9446</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mf">4.1709</span><span class="p">,</span> <span class="mf">3.3158</span><span class="p">,</span> <span class="mf">2.9223</span><span class="p">,</span> <span class="mf">2.6896</span><span class="p">,</span> <span class="mf">2.5335</span><span class="p">,</span> <span class="mf">2.4205</span><span class="p">,</span> <span class="mf">2.3343</span><span class="p">,</span> <span class="mf">2.2662</span><span class="p">,</span> <span class="mf">2.2107</span><span class="p">,</span> <span class="mf">2.1646</span><span class="p">,</span>
                       <span class="mf">2.1255</span><span class="p">,</span> <span class="mf">2.0921</span><span class="p">,</span> <span class="mf">2.0629</span><span class="p">,</span> <span class="mf">2.0374</span><span class="p">,</span> <span class="mf">2.0148</span><span class="p">,</span> <span class="mf">1.9946</span><span class="p">,</span> <span class="mf">1.9765</span><span class="p">,</span> <span class="mf">1.9601</span><span class="p">,</span> <span class="mf">1.9452</span><span class="p">,</span> <span class="mf">1.9317</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">31</span><span class="p">,</span> <span class="mf">4.1597</span><span class="p">,</span> <span class="mf">3.3048</span><span class="p">,</span> <span class="mf">2.9113</span><span class="p">,</span> <span class="mf">2.6787</span><span class="p">,</span> <span class="mf">2.5225</span><span class="p">,</span> <span class="mf">2.4094</span><span class="p">,</span> <span class="mf">2.3232</span><span class="p">,</span> <span class="mf">2.2549</span><span class="p">,</span> <span class="mf">2.1994</span><span class="p">,</span> <span class="mf">2.1531</span><span class="p">,</span>
                       <span class="mf">2.1141</span><span class="p">,</span> <span class="mf">2.0805</span><span class="p">,</span> <span class="mf">2.0513</span><span class="p">,</span> <span class="mf">2.0257</span><span class="p">,</span> <span class="mf">2.003</span><span class="p">,</span> <span class="mf">1.9828</span><span class="p">,</span> <span class="mf">1.9646</span><span class="p">,</span> <span class="mf">1.9481</span><span class="p">,</span> <span class="mf">1.9332</span><span class="p">,</span> <span class="mf">1.9196</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">32</span><span class="p">,</span> <span class="mf">4.1491</span><span class="p">,</span> <span class="mf">3.2945</span><span class="p">,</span> <span class="mf">2.9011</span><span class="p">,</span> <span class="mf">2.6684</span><span class="p">,</span> <span class="mf">2.5123</span><span class="p">,</span> <span class="mf">2.3991</span><span class="p">,</span> <span class="mf">2.3127</span><span class="p">,</span> <span class="mf">2.2444</span><span class="p">,</span> <span class="mf">2.1888</span><span class="p">,</span> <span class="mf">2.1425</span><span class="p">,</span>
                       <span class="mf">2.1033</span><span class="p">,</span> <span class="mf">2.0697</span><span class="p">,</span> <span class="mf">2.0404</span><span class="p">,</span> <span class="mf">2.0147</span><span class="p">,</span> <span class="mf">1.992</span><span class="p">,</span> <span class="mf">1.9717</span><span class="p">,</span> <span class="mf">1.9534</span><span class="p">,</span> <span class="mf">1.9369</span><span class="p">,</span> <span class="mf">1.9219</span><span class="p">,</span> <span class="mf">1.9083</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">33</span><span class="p">,</span> <span class="mf">4.1392</span><span class="p">,</span> <span class="mf">3.2849</span><span class="p">,</span> <span class="mf">2.8915</span><span class="p">,</span> <span class="mf">2.6589</span><span class="p">,</span> <span class="mf">2.5027</span><span class="p">,</span> <span class="mf">2.3894</span><span class="p">,</span> <span class="mf">2.303</span><span class="p">,</span> <span class="mf">2.2346</span><span class="p">,</span> <span class="mf">2.1789</span><span class="p">,</span> <span class="mf">2.1325</span><span class="p">,</span>
                       <span class="mf">2.0933</span><span class="p">,</span> <span class="mf">2.0596</span><span class="p">,</span> <span class="mf">2.0302</span><span class="p">,</span> <span class="mf">2.0045</span><span class="p">,</span> <span class="mf">1.9817</span><span class="p">,</span> <span class="mf">1.9613</span><span class="p">,</span> <span class="mf">1.943</span><span class="p">,</span> <span class="mf">1.9264</span><span class="p">,</span> <span class="mf">1.9114</span><span class="p">,</span> <span class="mf">1.8977</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">34</span><span class="p">,</span> <span class="mf">4.13</span><span class="p">,</span> <span class="mf">3.2759</span><span class="p">,</span> <span class="mf">2.8826</span><span class="p">,</span> <span class="mf">2.6499</span><span class="p">,</span> <span class="mf">2.4936</span><span class="p">,</span> <span class="mf">2.3803</span><span class="p">,</span> <span class="mf">2.2938</span><span class="p">,</span> <span class="mf">2.2253</span><span class="p">,</span> <span class="mf">2.1696</span><span class="p">,</span> <span class="mf">2.1231</span><span class="p">,</span>
                       <span class="mf">2.0838</span><span class="p">,</span> <span class="mf">2.05</span><span class="p">,</span> <span class="mf">2.0207</span><span class="p">,</span> <span class="mf">1.9949</span><span class="p">,</span> <span class="mf">1.972</span><span class="p">,</span> <span class="mf">1.9516</span><span class="p">,</span> <span class="mf">1.9332</span><span class="p">,</span> <span class="mf">1.9166</span><span class="p">,</span> <span class="mf">1.9015</span><span class="p">,</span> <span class="mf">1.8877</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">35</span><span class="p">,</span> <span class="mf">4.1214</span><span class="p">,</span> <span class="mf">3.2674</span><span class="p">,</span> <span class="mf">2.8742</span><span class="p">,</span> <span class="mf">2.6415</span><span class="p">,</span> <span class="mf">2.4851</span><span class="p">,</span> <span class="mf">2.3718</span><span class="p">,</span> <span class="mf">2.2852</span><span class="p">,</span> <span class="mf">2.2167</span><span class="p">,</span> <span class="mf">2.1608</span><span class="p">,</span> <span class="mf">2.1143</span><span class="p">,</span>
                       <span class="mf">2.0749</span><span class="p">,</span> <span class="mf">2.0411</span><span class="p">,</span> <span class="mf">2.0117</span><span class="p">,</span> <span class="mf">1.9858</span><span class="p">,</span> <span class="mf">1.9629</span><span class="p">,</span> <span class="mf">1.9424</span><span class="p">,</span> <span class="mf">1.924</span><span class="p">,</span> <span class="mf">1.9073</span><span class="p">,</span> <span class="mf">1.8922</span><span class="p">,</span> <span class="mf">1.8784</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">36</span><span class="p">,</span> <span class="mf">4.1132</span><span class="p">,</span> <span class="mf">3.2594</span><span class="p">,</span> <span class="mf">2.8663</span><span class="p">,</span> <span class="mf">2.6335</span><span class="p">,</span> <span class="mf">2.4771</span><span class="p">,</span> <span class="mf">2.3637</span><span class="p">,</span> <span class="mf">2.2771</span><span class="p">,</span> <span class="mf">2.2085</span><span class="p">,</span> <span class="mf">2.1526</span><span class="p">,</span> <span class="mf">2.1061</span><span class="p">,</span>
                       <span class="mf">2.0666</span><span class="p">,</span> <span class="mf">2.0327</span><span class="p">,</span> <span class="mf">2.0032</span><span class="p">,</span> <span class="mf">1.9773</span><span class="p">,</span> <span class="mf">1.9543</span><span class="p">,</span> <span class="mf">1.9338</span><span class="p">,</span> <span class="mf">1.9153</span><span class="p">,</span> <span class="mf">1.8986</span><span class="p">,</span> <span class="mf">1.8834</span><span class="p">,</span> <span class="mf">1.8696</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">37</span><span class="p">,</span> <span class="mf">4.1055</span><span class="p">,</span> <span class="mf">3.2519</span><span class="p">,</span> <span class="mf">2.8588</span><span class="p">,</span> <span class="mf">2.6261</span><span class="p">,</span> <span class="mf">2.4696</span><span class="p">,</span> <span class="mf">2.3562</span><span class="p">,</span> <span class="mf">2.2695</span><span class="p">,</span> <span class="mf">2.2008</span><span class="p">,</span> <span class="mf">2.1449</span><span class="p">,</span> <span class="mf">2.0982</span><span class="p">,</span>
                       <span class="mf">2.0587</span><span class="p">,</span> <span class="mf">2.0248</span><span class="p">,</span> <span class="mf">1.9952</span><span class="p">,</span> <span class="mf">1.9692</span><span class="p">,</span> <span class="mf">1.9462</span><span class="p">,</span> <span class="mf">1.9256</span><span class="p">,</span> <span class="mf">1.9071</span><span class="p">,</span> <span class="mf">1.8904</span><span class="p">,</span> <span class="mf">1.8752</span><span class="p">,</span> <span class="mf">1.8613</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">38</span><span class="p">,</span> <span class="mf">4.0981</span><span class="p">,</span> <span class="mf">3.2448</span><span class="p">,</span> <span class="mf">2.8517</span><span class="p">,</span> <span class="mf">2.619</span><span class="p">,</span> <span class="mf">2.4625</span><span class="p">,</span> <span class="mf">2.349</span><span class="p">,</span> <span class="mf">2.2623</span><span class="p">,</span> <span class="mf">2.1935</span><span class="p">,</span> <span class="mf">2.1375</span><span class="p">,</span> <span class="mf">2.0909</span><span class="p">,</span>
                       <span class="mf">2.0513</span><span class="p">,</span> <span class="mf">2.0173</span><span class="p">,</span> <span class="mf">1.9877</span><span class="p">,</span> <span class="mf">1.9617</span><span class="p">,</span> <span class="mf">1.9386</span><span class="p">,</span> <span class="mf">1.9179</span><span class="p">,</span> <span class="mf">1.8994</span><span class="p">,</span> <span class="mf">1.8826</span><span class="p">,</span> <span class="mf">1.8673</span><span class="p">,</span> <span class="mf">1.8534</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">39</span><span class="p">,</span> <span class="mf">4.0913</span><span class="p">,</span> <span class="mf">3.2381</span><span class="p">,</span> <span class="mf">2.8451</span><span class="p">,</span> <span class="mf">2.6123</span><span class="p">,</span> <span class="mf">2.4558</span><span class="p">,</span> <span class="mf">2.3422</span><span class="p">,</span> <span class="mf">2.2555</span><span class="p">,</span> <span class="mf">2.1867</span><span class="p">,</span> <span class="mf">2.1306</span><span class="p">,</span> <span class="mf">2.0839</span><span class="p">,</span>
                       <span class="mf">2.0442</span><span class="p">,</span> <span class="mf">2.0102</span><span class="p">,</span> <span class="mf">1.9805</span><span class="p">,</span> <span class="mf">1.9545</span><span class="p">,</span> <span class="mf">1.9313</span><span class="p">,</span> <span class="mf">1.9107</span><span class="p">,</span> <span class="mf">1.8921</span><span class="p">,</span> <span class="mf">1.8752</span><span class="p">,</span> <span class="mf">1.8599</span><span class="p">,</span> <span class="mf">1.8459</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">40</span><span class="p">,</span> <span class="mf">4.0848</span><span class="p">,</span> <span class="mf">3.2317</span><span class="p">,</span> <span class="mf">2.8388</span><span class="p">,</span> <span class="mf">2.606</span><span class="p">,</span> <span class="mf">2.4495</span><span class="p">,</span> <span class="mf">2.3359</span><span class="p">,</span> <span class="mf">2.249</span><span class="p">,</span> <span class="mf">2.1802</span><span class="p">,</span> <span class="mf">2.124</span><span class="p">,</span> <span class="mf">2.0773</span><span class="p">,</span>
                       <span class="mf">2.0376</span><span class="p">,</span> <span class="mf">2.0035</span><span class="p">,</span> <span class="mf">1.9738</span><span class="p">,</span> <span class="mf">1.9476</span><span class="p">,</span> <span class="mf">1.9245</span><span class="p">,</span> <span class="mf">1.9038</span><span class="p">,</span> <span class="mf">1.8851</span><span class="p">,</span> <span class="mf">1.8682</span><span class="p">,</span> <span class="mf">1.8529</span><span class="p">,</span> <span class="mf">1.8389</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">41</span><span class="p">,</span> <span class="mf">4.0786</span><span class="p">,</span> <span class="mf">3.2257</span><span class="p">,</span> <span class="mf">2.8328</span><span class="p">,</span> <span class="mf">2.6</span><span class="p">,</span> <span class="mf">2.4434</span><span class="p">,</span> <span class="mf">2.3298</span><span class="p">,</span> <span class="mf">2.2429</span><span class="p">,</span> <span class="mf">2.174</span><span class="p">,</span> <span class="mf">2.1178</span><span class="p">,</span> <span class="mf">2.071</span><span class="p">,</span>
                       <span class="mf">2.0312</span><span class="p">,</span> <span class="mf">1.9971</span><span class="p">,</span> <span class="mf">1.9673</span><span class="p">,</span> <span class="mf">1.9412</span><span class="p">,</span> <span class="mf">1.9179</span><span class="p">,</span> <span class="mf">1.8972</span><span class="p">,</span> <span class="mf">1.8785</span><span class="p">,</span> <span class="mf">1.8616</span><span class="p">,</span> <span class="mf">1.8462</span><span class="p">,</span> <span class="mf">1.8321</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">42</span><span class="p">,</span> <span class="mf">4.0727</span><span class="p">,</span> <span class="mf">3.2199</span><span class="p">,</span> <span class="mf">2.8271</span><span class="p">,</span> <span class="mf">2.5943</span><span class="p">,</span> <span class="mf">2.4377</span><span class="p">,</span> <span class="mf">2.324</span><span class="p">,</span> <span class="mf">2.2371</span><span class="p">,</span> <span class="mf">2.1681</span><span class="p">,</span> <span class="mf">2.1119</span><span class="p">,</span> <span class="mf">2.065</span><span class="p">,</span>
                       <span class="mf">2.0252</span><span class="p">,</span> <span class="mf">1.991</span><span class="p">,</span> <span class="mf">1.9612</span><span class="p">,</span> <span class="mf">1.935</span><span class="p">,</span> <span class="mf">1.9118</span><span class="p">,</span> <span class="mf">1.8909</span><span class="p">,</span> <span class="mf">1.8722</span><span class="p">,</span> <span class="mf">1.8553</span><span class="p">,</span> <span class="mf">1.8399</span><span class="p">,</span> <span class="mf">1.8258</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">43</span><span class="p">,</span> <span class="mf">4.067</span><span class="p">,</span> <span class="mf">3.2145</span><span class="p">,</span> <span class="mf">2.8216</span><span class="p">,</span> <span class="mf">2.5888</span><span class="p">,</span> <span class="mf">2.4322</span><span class="p">,</span> <span class="mf">2.3185</span><span class="p">,</span> <span class="mf">2.2315</span><span class="p">,</span> <span class="mf">2.1625</span><span class="p">,</span> <span class="mf">2.1062</span><span class="p">,</span> <span class="mf">2.0593</span><span class="p">,</span>
                       <span class="mf">2.0195</span><span class="p">,</span> <span class="mf">1.9852</span><span class="p">,</span> <span class="mf">1.9554</span><span class="p">,</span> <span class="mf">1.9292</span><span class="p">,</span> <span class="mf">1.9059</span><span class="p">,</span> <span class="mf">1.885</span><span class="p">,</span> <span class="mf">1.8663</span><span class="p">,</span> <span class="mf">1.8493</span><span class="p">,</span> <span class="mf">1.8338</span><span class="p">,</span> <span class="mf">1.8197</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">44</span><span class="p">,</span> <span class="mf">4.0617</span><span class="p">,</span> <span class="mf">3.2093</span><span class="p">,</span> <span class="mf">2.8165</span><span class="p">,</span> <span class="mf">2.5837</span><span class="p">,</span> <span class="mf">2.4271</span><span class="p">,</span> <span class="mf">2.3133</span><span class="p">,</span> <span class="mf">2.2262</span><span class="p">,</span> <span class="mf">2.1572</span><span class="p">,</span> <span class="mf">2.1009</span><span class="p">,</span> <span class="mf">2.0539</span><span class="p">,</span>
                       <span class="mf">2.014</span><span class="p">,</span> <span class="mf">1.9797</span><span class="p">,</span> <span class="mf">1.9499</span><span class="p">,</span> <span class="mf">1.9236</span><span class="p">,</span> <span class="mf">1.9002</span><span class="p">,</span> <span class="mf">1.8794</span><span class="p">,</span> <span class="mf">1.8606</span><span class="p">,</span> <span class="mf">1.8436</span><span class="p">,</span> <span class="mf">1.8281</span><span class="p">,</span> <span class="mf">1.8139</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">45</span><span class="p">,</span> <span class="mf">4.0566</span><span class="p">,</span> <span class="mf">3.2043</span><span class="p">,</span> <span class="mf">2.8115</span><span class="p">,</span> <span class="mf">2.5787</span><span class="p">,</span> <span class="mf">2.4221</span><span class="p">,</span> <span class="mf">2.3083</span><span class="p">,</span> <span class="mf">2.2212</span><span class="p">,</span> <span class="mf">2.1521</span><span class="p">,</span> <span class="mf">2.0958</span><span class="p">,</span> <span class="mf">2.0487</span><span class="p">,</span>
                       <span class="mf">2.0088</span><span class="p">,</span> <span class="mf">1.9745</span><span class="p">,</span> <span class="mf">1.9446</span><span class="p">,</span> <span class="mf">1.9182</span><span class="p">,</span> <span class="mf">1.8949</span><span class="p">,</span> <span class="mf">1.874</span><span class="p">,</span> <span class="mf">1.8551</span><span class="p">,</span> <span class="mf">1.8381</span><span class="p">,</span> <span class="mf">1.8226</span><span class="p">,</span> <span class="mf">1.8084</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">46</span><span class="p">,</span> <span class="mf">4.0518</span><span class="p">,</span> <span class="mf">3.1996</span><span class="p">,</span> <span class="mf">2.8068</span><span class="p">,</span> <span class="mf">2.574</span><span class="p">,</span> <span class="mf">2.4174</span><span class="p">,</span> <span class="mf">2.3035</span><span class="p">,</span> <span class="mf">2.2164</span><span class="p">,</span> <span class="mf">2.1473</span><span class="p">,</span> <span class="mf">2.0909</span><span class="p">,</span> <span class="mf">2.0438</span><span class="p">,</span>
                       <span class="mf">2.0039</span><span class="p">,</span> <span class="mf">1.9695</span><span class="p">,</span> <span class="mf">1.9395</span><span class="p">,</span> <span class="mf">1.9132</span><span class="p">,</span> <span class="mf">1.8898</span><span class="p">,</span> <span class="mf">1.8688</span><span class="p">,</span> <span class="mf">1.85</span><span class="p">,</span> <span class="mf">1.8329</span><span class="p">,</span> <span class="mf">1.8173</span><span class="p">,</span> <span class="mf">1.8031</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">47</span><span class="p">,</span> <span class="mf">4.0471</span><span class="p">,</span> <span class="mf">3.1951</span><span class="p">,</span> <span class="mf">2.8024</span><span class="p">,</span> <span class="mf">2.5695</span><span class="p">,</span> <span class="mf">2.4128</span><span class="p">,</span> <span class="mf">2.299</span><span class="p">,</span> <span class="mf">2.2118</span><span class="p">,</span> <span class="mf">2.1427</span><span class="p">,</span> <span class="mf">2.0862</span><span class="p">,</span> <span class="mf">2.0391</span><span class="p">,</span>
                       <span class="mf">1.9991</span><span class="p">,</span> <span class="mf">1.9647</span><span class="p">,</span> <span class="mf">1.9347</span><span class="p">,</span> <span class="mf">1.9083</span><span class="p">,</span> <span class="mf">1.8849</span><span class="p">,</span> <span class="mf">1.8639</span><span class="p">,</span> <span class="mf">1.845</span><span class="p">,</span> <span class="mf">1.8279</span><span class="p">,</span> <span class="mf">1.8123</span><span class="p">,</span> <span class="mf">1.798</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">48</span><span class="p">,</span> <span class="mf">4.0426</span><span class="p">,</span> <span class="mf">3.1907</span><span class="p">,</span> <span class="mf">2.7981</span><span class="p">,</span> <span class="mf">2.5653</span><span class="p">,</span> <span class="mf">2.4085</span><span class="p">,</span> <span class="mf">2.2946</span><span class="p">,</span> <span class="mf">2.2074</span><span class="p">,</span> <span class="mf">2.1382</span><span class="p">,</span> <span class="mf">2.0817</span><span class="p">,</span> <span class="mf">2.0346</span><span class="p">,</span>
                       <span class="mf">1.9946</span><span class="p">,</span> <span class="mf">1.9601</span><span class="p">,</span> <span class="mf">1.9301</span><span class="p">,</span> <span class="mf">1.9037</span><span class="p">,</span> <span class="mf">1.8802</span><span class="p">,</span> <span class="mf">1.8592</span><span class="p">,</span> <span class="mf">1.8402</span><span class="p">,</span> <span class="mf">1.8231</span><span class="p">,</span> <span class="mf">1.8075</span><span class="p">,</span> <span class="mf">1.7932</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">49</span><span class="p">,</span> <span class="mf">4.0384</span><span class="p">,</span> <span class="mf">3.1866</span><span class="p">,</span> <span class="mf">2.7939</span><span class="p">,</span> <span class="mf">2.5611</span><span class="p">,</span> <span class="mf">2.4044</span><span class="p">,</span> <span class="mf">2.2904</span><span class="p">,</span> <span class="mf">2.2032</span><span class="p">,</span> <span class="mf">2.134</span><span class="p">,</span> <span class="mf">2.0774</span><span class="p">,</span> <span class="mf">2.0303</span><span class="p">,</span>
                       <span class="mf">1.9902</span><span class="p">,</span> <span class="mf">1.9558</span><span class="p">,</span> <span class="mf">1.9257</span><span class="p">,</span> <span class="mf">1.8992</span><span class="p">,</span> <span class="mf">1.8757</span><span class="p">,</span> <span class="mf">1.8547</span><span class="p">,</span> <span class="mf">1.8357</span><span class="p">,</span> <span class="mf">1.8185</span><span class="p">,</span> <span class="mf">1.8029</span><span class="p">,</span> <span class="mf">1.7886</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mf">4.0343</span><span class="p">,</span> <span class="mf">3.1826</span><span class="p">,</span> <span class="mf">2.79</span><span class="p">,</span> <span class="mf">2.5572</span><span class="p">,</span> <span class="mf">2.4004</span><span class="p">,</span> <span class="mf">2.2864</span><span class="p">,</span> <span class="mf">2.1992</span><span class="p">,</span> <span class="mf">2.1299</span><span class="p">,</span> <span class="mf">2.0734</span><span class="p">,</span> <span class="mf">2.0261</span><span class="p">,</span>
                       <span class="mf">1.9861</span><span class="p">,</span> <span class="mf">1.9515</span><span class="p">,</span> <span class="mf">1.9214</span><span class="p">,</span> <span class="mf">1.8949</span><span class="p">,</span> <span class="mf">1.8714</span><span class="p">,</span> <span class="mf">1.8503</span><span class="p">,</span> <span class="mf">1.8313</span><span class="p">,</span> <span class="mf">1.8141</span><span class="p">,</span> <span class="mf">1.7985</span><span class="p">,</span> <span class="mf">1.7841</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">51</span><span class="p">,</span> <span class="mf">4.0303</span><span class="p">,</span> <span class="mf">3.1788</span><span class="p">,</span> <span class="mf">2.7862</span><span class="p">,</span> <span class="mf">2.5534</span><span class="p">,</span> <span class="mf">2.3966</span><span class="p">,</span> <span class="mf">2.2826</span><span class="p">,</span> <span class="mf">2.1953</span><span class="p">,</span> <span class="mf">2.126</span><span class="p">,</span> <span class="mf">2.0694</span><span class="p">,</span> <span class="mf">2.0222</span><span class="p">,</span>
                       <span class="mf">1.982</span><span class="p">,</span> <span class="mf">1.9475</span><span class="p">,</span> <span class="mf">1.9174</span><span class="p">,</span> <span class="mf">1.8908</span><span class="p">,</span> <span class="mf">1.8673</span><span class="p">,</span> <span class="mf">1.8462</span><span class="p">,</span> <span class="mf">1.8272</span><span class="p">,</span> <span class="mf">1.8099</span><span class="p">,</span> <span class="mf">1.7942</span><span class="p">,</span> <span class="mf">1.7798</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">52</span><span class="p">,</span> <span class="mf">4.0266</span><span class="p">,</span> <span class="mf">3.1752</span><span class="p">,</span> <span class="mf">2.7826</span><span class="p">,</span> <span class="mf">2.5498</span><span class="p">,</span> <span class="mf">2.3929</span><span class="p">,</span> <span class="mf">2.2789</span><span class="p">,</span> <span class="mf">2.1916</span><span class="p">,</span> <span class="mf">2.1223</span><span class="p">,</span> <span class="mf">2.0656</span><span class="p">,</span> <span class="mf">2.0184</span><span class="p">,</span>
                       <span class="mf">1.9782</span><span class="p">,</span> <span class="mf">1.9436</span><span class="p">,</span> <span class="mf">1.9134</span><span class="p">,</span> <span class="mf">1.8869</span><span class="p">,</span> <span class="mf">1.8633</span><span class="p">,</span> <span class="mf">1.8422</span><span class="p">,</span> <span class="mf">1.8231</span><span class="p">,</span> <span class="mf">1.8059</span><span class="p">,</span> <span class="mf">1.7901</span><span class="p">,</span> <span class="mf">1.7758</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">53</span><span class="p">,</span> <span class="mf">4.023</span><span class="p">,</span> <span class="mf">3.1716</span><span class="p">,</span> <span class="mf">2.7791</span><span class="p">,</span> <span class="mf">2.5463</span><span class="p">,</span> <span class="mf">2.3894</span><span class="p">,</span> <span class="mf">2.2754</span><span class="p">,</span> <span class="mf">2.1881</span><span class="p">,</span> <span class="mf">2.1187</span><span class="p">,</span> <span class="mf">2.062</span><span class="p">,</span> <span class="mf">2.0147</span><span class="p">,</span>
                       <span class="mf">1.9745</span><span class="p">,</span> <span class="mf">1.9399</span><span class="p">,</span> <span class="mf">1.9097</span><span class="p">,</span> <span class="mf">1.8831</span><span class="p">,</span> <span class="mf">1.8595</span><span class="p">,</span> <span class="mf">1.8383</span><span class="p">,</span> <span class="mf">1.8193</span><span class="p">,</span> <span class="mf">1.802</span><span class="p">,</span> <span class="mf">1.7862</span><span class="p">,</span> <span class="mf">1.7718</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">54</span><span class="p">,</span> <span class="mf">4.0196</span><span class="p">,</span> <span class="mf">3.1683</span><span class="p">,</span> <span class="mf">2.7757</span><span class="p">,</span> <span class="mf">2.5429</span><span class="p">,</span> <span class="mf">2.3861</span><span class="p">,</span> <span class="mf">2.272</span><span class="p">,</span> <span class="mf">2.1846</span><span class="p">,</span> <span class="mf">2.1152</span><span class="p">,</span> <span class="mf">2.0585</span><span class="p">,</span> <span class="mf">2.0112</span><span class="p">,</span>
                       <span class="mf">1.971</span><span class="p">,</span> <span class="mf">1.9363</span><span class="p">,</span> <span class="mf">1.9061</span><span class="p">,</span> <span class="mf">1.8795</span><span class="p">,</span> <span class="mf">1.8558</span><span class="p">,</span> <span class="mf">1.8346</span><span class="p">,</span> <span class="mf">1.8155</span><span class="p">,</span> <span class="mf">1.7982</span><span class="p">,</span> <span class="mf">1.7825</span><span class="p">,</span> <span class="mf">1.768</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">55</span><span class="p">,</span> <span class="mf">4.0162</span><span class="p">,</span> <span class="mf">3.165</span><span class="p">,</span> <span class="mf">2.7725</span><span class="p">,</span> <span class="mf">2.5397</span><span class="p">,</span> <span class="mf">2.3828</span><span class="p">,</span> <span class="mf">2.2687</span><span class="p">,</span> <span class="mf">2.1813</span><span class="p">,</span> <span class="mf">2.1119</span><span class="p">,</span> <span class="mf">2.0552</span><span class="p">,</span> <span class="mf">2.0078</span><span class="p">,</span>
                       <span class="mf">1.9676</span><span class="p">,</span> <span class="mf">1.9329</span><span class="p">,</span> <span class="mf">1.9026</span><span class="p">,</span> <span class="mf">1.876</span><span class="p">,</span> <span class="mf">1.8523</span><span class="p">,</span> <span class="mf">1.8311</span><span class="p">,</span> <span class="mf">1.812</span><span class="p">,</span> <span class="mf">1.7946</span><span class="p">,</span> <span class="mf">1.7788</span><span class="p">,</span> <span class="mf">1.7644</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">56</span><span class="p">,</span> <span class="mf">4.0129</span><span class="p">,</span> <span class="mf">3.1618</span><span class="p">,</span> <span class="mf">2.7694</span><span class="p">,</span> <span class="mf">2.5366</span><span class="p">,</span> <span class="mf">2.3797</span><span class="p">,</span> <span class="mf">2.2656</span><span class="p">,</span> <span class="mf">2.1781</span><span class="p">,</span> <span class="mf">2.1087</span><span class="p">,</span> <span class="mf">2.0519</span><span class="p">,</span> <span class="mf">2.0045</span><span class="p">,</span>
                       <span class="mf">1.9642</span><span class="p">,</span> <span class="mf">1.9296</span><span class="p">,</span> <span class="mf">1.8993</span><span class="p">,</span> <span class="mf">1.8726</span><span class="p">,</span> <span class="mf">1.8489</span><span class="p">,</span> <span class="mf">1.8276</span><span class="p">,</span> <span class="mf">1.8085</span><span class="p">,</span> <span class="mf">1.7912</span><span class="p">,</span> <span class="mf">1.7753</span><span class="p">,</span> <span class="mf">1.7608</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">57</span><span class="p">,</span> <span class="mf">4.0099</span><span class="p">,</span> <span class="mf">3.1589</span><span class="p">,</span> <span class="mf">2.7665</span><span class="p">,</span> <span class="mf">2.5336</span><span class="p">,</span> <span class="mf">2.3767</span><span class="p">,</span> <span class="mf">2.2625</span><span class="p">,</span> <span class="mf">2.1751</span><span class="p">,</span> <span class="mf">2.1056</span><span class="p">,</span> <span class="mf">2.0488</span><span class="p">,</span> <span class="mf">2.0014</span><span class="p">,</span>
                       <span class="mf">1.9611</span><span class="p">,</span> <span class="mf">1.9264</span><span class="p">,</span> <span class="mf">1.896</span><span class="p">,</span> <span class="mf">1.8693</span><span class="p">,</span> <span class="mf">1.8456</span><span class="p">,</span> <span class="mf">1.8244</span><span class="p">,</span> <span class="mf">1.8052</span><span class="p">,</span> <span class="mf">1.7878</span><span class="p">,</span> <span class="mf">1.772</span><span class="p">,</span> <span class="mf">1.7575</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">58</span><span class="p">,</span> <span class="mf">4.0069</span><span class="p">,</span> <span class="mf">3.1559</span><span class="p">,</span> <span class="mf">2.7635</span><span class="p">,</span> <span class="mf">2.5307</span><span class="p">,</span> <span class="mf">2.3738</span><span class="p">,</span> <span class="mf">2.2596</span><span class="p">,</span> <span class="mf">2.1721</span><span class="p">,</span> <span class="mf">2.1026</span><span class="p">,</span> <span class="mf">2.0458</span><span class="p">,</span> <span class="mf">1.9983</span><span class="p">,</span>
                       <span class="mf">1.958</span><span class="p">,</span> <span class="mf">1.9233</span><span class="p">,</span> <span class="mf">1.8929</span><span class="p">,</span> <span class="mf">1.8662</span><span class="p">,</span> <span class="mf">1.8424</span><span class="p">,</span> <span class="mf">1.8212</span><span class="p">,</span> <span class="mf">1.802</span><span class="p">,</span> <span class="mf">1.7846</span><span class="p">,</span> <span class="mf">1.7687</span><span class="p">,</span> <span class="mf">1.7542</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">59</span><span class="p">,</span> <span class="mf">4.0039</span><span class="p">,</span> <span class="mf">3.1531</span><span class="p">,</span> <span class="mf">2.7608</span><span class="p">,</span> <span class="mf">2.5279</span><span class="p">,</span> <span class="mf">2.371</span><span class="p">,</span> <span class="mf">2.2568</span><span class="p">,</span> <span class="mf">2.1693</span><span class="p">,</span> <span class="mf">2.0997</span><span class="p">,</span> <span class="mf">2.0429</span><span class="p">,</span> <span class="mf">1.9954</span><span class="p">,</span>
                       <span class="mf">1.9551</span><span class="p">,</span> <span class="mf">1.9203</span><span class="p">,</span> <span class="mf">1.8899</span><span class="p">,</span> <span class="mf">1.8632</span><span class="p">,</span> <span class="mf">1.8394</span><span class="p">,</span> <span class="mf">1.8181</span><span class="p">,</span> <span class="mf">1.7989</span><span class="p">,</span> <span class="mf">1.7815</span><span class="p">,</span> <span class="mf">1.7656</span><span class="p">,</span> <span class="mf">1.751</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">60</span><span class="p">,</span> <span class="mf">4.0012</span><span class="p">,</span> <span class="mf">3.1504</span><span class="p">,</span> <span class="mf">2.7581</span><span class="p">,</span> <span class="mf">2.5252</span><span class="p">,</span> <span class="mf">2.3683</span><span class="p">,</span> <span class="mf">2.254</span><span class="p">,</span> <span class="mf">2.1665</span><span class="p">,</span> <span class="mf">2.097</span><span class="p">,</span> <span class="mf">2.0401</span><span class="p">,</span> <span class="mf">1.9926</span><span class="p">,</span>
                       <span class="mf">1.9522</span><span class="p">,</span> <span class="mf">1.9174</span><span class="p">,</span> <span class="mf">1.887</span><span class="p">,</span> <span class="mf">1.8603</span><span class="p">,</span> <span class="mf">1.8364</span><span class="p">,</span> <span class="mf">1.8151</span><span class="p">,</span> <span class="mf">1.7959</span><span class="p">,</span> <span class="mf">1.7784</span><span class="p">,</span> <span class="mf">1.7625</span><span class="p">,</span> <span class="mf">1.748</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">61</span><span class="p">,</span> <span class="mf">3.9985</span><span class="p">,</span> <span class="mf">3.1478</span><span class="p">,</span> <span class="mf">2.7555</span><span class="p">,</span> <span class="mf">2.5226</span><span class="p">,</span> <span class="mf">2.3657</span><span class="p">,</span> <span class="mf">2.2514</span><span class="p">,</span> <span class="mf">2.1639</span><span class="p">,</span> <span class="mf">2.0943</span><span class="p">,</span> <span class="mf">2.0374</span><span class="p">,</span> <span class="mf">1.9899</span><span class="p">,</span>
                       <span class="mf">1.9495</span><span class="p">,</span> <span class="mf">1.9146</span><span class="p">,</span> <span class="mf">1.8842</span><span class="p">,</span> <span class="mf">1.8574</span><span class="p">,</span> <span class="mf">1.8336</span><span class="p">,</span> <span class="mf">1.8122</span><span class="p">,</span> <span class="mf">1.793</span><span class="p">,</span> <span class="mf">1.7755</span><span class="p">,</span> <span class="mf">1.7596</span><span class="p">,</span> <span class="mf">1.745</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">62</span><span class="p">,</span> <span class="mf">3.9959</span><span class="p">,</span> <span class="mf">3.1453</span><span class="p">,</span> <span class="mf">2.753</span><span class="p">,</span> <span class="mf">2.5201</span><span class="p">,</span> <span class="mf">2.3631</span><span class="p">,</span> <span class="mf">2.2489</span><span class="p">,</span> <span class="mf">2.1613</span><span class="p">,</span> <span class="mf">2.0917</span><span class="p">,</span> <span class="mf">2.0348</span><span class="p">,</span> <span class="mf">1.9872</span><span class="p">,</span>
                       <span class="mf">1.9468</span><span class="p">,</span> <span class="mf">1.9119</span><span class="p">,</span> <span class="mf">1.8815</span><span class="p">,</span> <span class="mf">1.8547</span><span class="p">,</span> <span class="mf">1.8308</span><span class="p">,</span> <span class="mf">1.8095</span><span class="p">,</span> <span class="mf">1.7902</span><span class="p">,</span> <span class="mf">1.7727</span><span class="p">,</span> <span class="mf">1.7568</span><span class="p">,</span> <span class="mf">1.7422</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">63</span><span class="p">,</span> <span class="mf">3.9934</span><span class="p">,</span> <span class="mf">3.1428</span><span class="p">,</span> <span class="mf">2.7506</span><span class="p">,</span> <span class="mf">2.5176</span><span class="p">,</span> <span class="mf">2.3607</span><span class="p">,</span> <span class="mf">2.2464</span><span class="p">,</span> <span class="mf">2.1588</span><span class="p">,</span> <span class="mf">2.0892</span><span class="p">,</span> <span class="mf">2.0322</span><span class="p">,</span> <span class="mf">1.9847</span><span class="p">,</span>
                       <span class="mf">1.9442</span><span class="p">,</span> <span class="mf">1.9093</span><span class="p">,</span> <span class="mf">1.8789</span><span class="p">,</span> <span class="mf">1.852</span><span class="p">,</span> <span class="mf">1.8282</span><span class="p">,</span> <span class="mf">1.8068</span><span class="p">,</span> <span class="mf">1.7875</span><span class="p">,</span> <span class="mf">1.77</span><span class="p">,</span> <span class="mf">1.754</span><span class="p">,</span> <span class="mf">1.7394</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">64</span><span class="p">,</span> <span class="mf">3.9909</span><span class="p">,</span> <span class="mf">3.1404</span><span class="p">,</span> <span class="mf">2.7482</span><span class="p">,</span> <span class="mf">2.5153</span><span class="p">,</span> <span class="mf">2.3583</span><span class="p">,</span> <span class="mf">2.244</span><span class="p">,</span> <span class="mf">2.1564</span><span class="p">,</span> <span class="mf">2.0868</span><span class="p">,</span> <span class="mf">2.0298</span><span class="p">,</span> <span class="mf">1.9822</span><span class="p">,</span>
                       <span class="mf">1.9417</span><span class="p">,</span> <span class="mf">1.9068</span><span class="p">,</span> <span class="mf">1.8763</span><span class="p">,</span> <span class="mf">1.8495</span><span class="p">,</span> <span class="mf">1.8256</span><span class="p">,</span> <span class="mf">1.8042</span><span class="p">,</span> <span class="mf">1.7849</span><span class="p">,</span> <span class="mf">1.7673</span><span class="p">,</span> <span class="mf">1.7514</span><span class="p">,</span> <span class="mf">1.7368</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">65</span><span class="p">,</span> <span class="mf">3.9885</span><span class="p">,</span> <span class="mf">3.1381</span><span class="p">,</span> <span class="mf">2.7459</span><span class="p">,</span> <span class="mf">2.513</span><span class="p">,</span> <span class="mf">2.356</span><span class="p">,</span> <span class="mf">2.2417</span><span class="p">,</span> <span class="mf">2.1541</span><span class="p">,</span> <span class="mf">2.0844</span><span class="p">,</span> <span class="mf">2.0274</span><span class="p">,</span> <span class="mf">1.9798</span><span class="p">,</span>
                       <span class="mf">1.9393</span><span class="p">,</span> <span class="mf">1.9044</span><span class="p">,</span> <span class="mf">1.8739</span><span class="p">,</span> <span class="mf">1.847</span><span class="p">,</span> <span class="mf">1.8231</span><span class="p">,</span> <span class="mf">1.8017</span><span class="p">,</span> <span class="mf">1.7823</span><span class="p">,</span> <span class="mf">1.7648</span><span class="p">,</span> <span class="mf">1.7488</span><span class="p">,</span> <span class="mf">1.7342</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">66</span><span class="p">,</span> <span class="mf">3.9862</span><span class="p">,</span> <span class="mf">3.1359</span><span class="p">,</span> <span class="mf">2.7437</span><span class="p">,</span> <span class="mf">2.5108</span><span class="p">,</span> <span class="mf">2.3538</span><span class="p">,</span> <span class="mf">2.2395</span><span class="p">,</span> <span class="mf">2.1518</span><span class="p">,</span> <span class="mf">2.0821</span><span class="p">,</span> <span class="mf">2.0251</span><span class="p">,</span> <span class="mf">1.9775</span><span class="p">,</span>
                       <span class="mf">1.937</span><span class="p">,</span> <span class="mf">1.902</span><span class="p">,</span> <span class="mf">1.8715</span><span class="p">,</span> <span class="mf">1.8446</span><span class="p">,</span> <span class="mf">1.8207</span><span class="p">,</span> <span class="mf">1.7992</span><span class="p">,</span> <span class="mf">1.7799</span><span class="p">,</span> <span class="mf">1.7623</span><span class="p">,</span> <span class="mf">1.7463</span><span class="p">,</span> <span class="mf">1.7316</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">67</span><span class="p">,</span> <span class="mf">3.9841</span><span class="p">,</span> <span class="mf">3.1338</span><span class="p">,</span> <span class="mf">2.7416</span><span class="p">,</span> <span class="mf">2.5087</span><span class="p">,</span> <span class="mf">2.3516</span><span class="p">,</span> <span class="mf">2.2373</span><span class="p">,</span> <span class="mf">2.1497</span><span class="p">,</span> <span class="mf">2.0799</span><span class="p">,</span> <span class="mf">2.0229</span><span class="p">,</span> <span class="mf">1.9752</span><span class="p">,</span>
                       <span class="mf">1.9347</span><span class="p">,</span> <span class="mf">1.8997</span><span class="p">,</span> <span class="mf">1.8692</span><span class="p">,</span> <span class="mf">1.8423</span><span class="p">,</span> <span class="mf">1.8183</span><span class="p">,</span> <span class="mf">1.7968</span><span class="p">,</span> <span class="mf">1.7775</span><span class="p">,</span> <span class="mf">1.7599</span><span class="p">,</span> <span class="mf">1.7439</span><span class="p">,</span> <span class="mf">1.7292</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">68</span><span class="p">,</span> <span class="mf">3.9819</span><span class="p">,</span> <span class="mf">3.1317</span><span class="p">,</span> <span class="mf">2.7395</span><span class="p">,</span> <span class="mf">2.5066</span><span class="p">,</span> <span class="mf">2.3496</span><span class="p">,</span> <span class="mf">2.2352</span><span class="p">,</span> <span class="mf">2.1475</span><span class="p">,</span> <span class="mf">2.0778</span><span class="p">,</span> <span class="mf">2.0207</span><span class="p">,</span> <span class="mf">1.973</span><span class="p">,</span>
                       <span class="mf">1.9325</span><span class="p">,</span> <span class="mf">1.8975</span><span class="p">,</span> <span class="mf">1.867</span><span class="p">,</span> <span class="mf">1.84</span><span class="p">,</span> <span class="mf">1.816</span><span class="p">,</span> <span class="mf">1.7945</span><span class="p">,</span> <span class="mf">1.7752</span><span class="p">,</span> <span class="mf">1.7576</span><span class="p">,</span> <span class="mf">1.7415</span><span class="p">,</span> <span class="mf">1.7268</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">69</span><span class="p">,</span> <span class="mf">3.9798</span><span class="p">,</span> <span class="mf">3.1297</span><span class="p">,</span> <span class="mf">2.7375</span><span class="p">,</span> <span class="mf">2.5046</span><span class="p">,</span> <span class="mf">2.3475</span><span class="p">,</span> <span class="mf">2.2332</span><span class="p">,</span> <span class="mf">2.1455</span><span class="p">,</span> <span class="mf">2.0757</span><span class="p">,</span> <span class="mf">2.0186</span><span class="p">,</span> <span class="mf">1.9709</span><span class="p">,</span>
                       <span class="mf">1.9303</span><span class="p">,</span> <span class="mf">1.8954</span><span class="p">,</span> <span class="mf">1.8648</span><span class="p">,</span> <span class="mf">1.8378</span><span class="p">,</span> <span class="mf">1.8138</span><span class="p">,</span> <span class="mf">1.7923</span><span class="p">,</span> <span class="mf">1.7729</span><span class="p">,</span> <span class="mf">1.7553</span><span class="p">,</span> <span class="mf">1.7393</span><span class="p">,</span> <span class="mf">1.7246</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">70</span><span class="p">,</span> <span class="mf">3.9778</span><span class="p">,</span> <span class="mf">3.1277</span><span class="p">,</span> <span class="mf">2.7355</span><span class="p">,</span> <span class="mf">2.5027</span><span class="p">,</span> <span class="mf">2.3456</span><span class="p">,</span> <span class="mf">2.2312</span><span class="p">,</span> <span class="mf">2.1435</span><span class="p">,</span> <span class="mf">2.0737</span><span class="p">,</span> <span class="mf">2.0166</span><span class="p">,</span> <span class="mf">1.9689</span><span class="p">,</span>
                       <span class="mf">1.9283</span><span class="p">,</span> <span class="mf">1.8932</span><span class="p">,</span> <span class="mf">1.8627</span><span class="p">,</span> <span class="mf">1.8357</span><span class="p">,</span> <span class="mf">1.8117</span><span class="p">,</span> <span class="mf">1.7902</span><span class="p">,</span> <span class="mf">1.7707</span><span class="p">,</span> <span class="mf">1.7531</span><span class="p">,</span> <span class="mf">1.7371</span><span class="p">,</span> <span class="mf">1.7223</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">71</span><span class="p">,</span> <span class="mf">3.9758</span><span class="p">,</span> <span class="mf">3.1258</span><span class="p">,</span> <span class="mf">2.7336</span><span class="p">,</span> <span class="mf">2.5007</span><span class="p">,</span> <span class="mf">2.3437</span><span class="p">,</span> <span class="mf">2.2293</span><span class="p">,</span> <span class="mf">2.1415</span><span class="p">,</span> <span class="mf">2.0717</span><span class="p">,</span> <span class="mf">2.0146</span><span class="p">,</span> <span class="mf">1.9669</span><span class="p">,</span>
                       <span class="mf">1.9263</span><span class="p">,</span> <span class="mf">1.8912</span><span class="p">,</span> <span class="mf">1.8606</span><span class="p">,</span> <span class="mf">1.8336</span><span class="p">,</span> <span class="mf">1.8096</span><span class="p">,</span> <span class="mf">1.7881</span><span class="p">,</span> <span class="mf">1.7686</span><span class="p">,</span> <span class="mf">1.751</span><span class="p">,</span> <span class="mf">1.7349</span><span class="p">,</span> <span class="mf">1.7202</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">72</span><span class="p">,</span> <span class="mf">3.9739</span><span class="p">,</span> <span class="mf">3.1239</span><span class="p">,</span> <span class="mf">2.7318</span><span class="p">,</span> <span class="mf">2.4989</span><span class="p">,</span> <span class="mf">2.3418</span><span class="p">,</span> <span class="mf">2.2274</span><span class="p">,</span> <span class="mf">2.1397</span><span class="p">,</span> <span class="mf">2.0698</span><span class="p">,</span> <span class="mf">2.0127</span><span class="p">,</span> <span class="mf">1.9649</span><span class="p">,</span>
                       <span class="mf">1.9243</span><span class="p">,</span> <span class="mf">1.8892</span><span class="p">,</span> <span class="mf">1.8586</span><span class="p">,</span> <span class="mf">1.8316</span><span class="p">,</span> <span class="mf">1.8076</span><span class="p">,</span> <span class="mf">1.786</span><span class="p">,</span> <span class="mf">1.7666</span><span class="p">,</span> <span class="mf">1.7489</span><span class="p">,</span> <span class="mf">1.7328</span><span class="p">,</span> <span class="mf">1.7181</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">73</span><span class="p">,</span> <span class="mf">3.9721</span><span class="p">,</span> <span class="mf">3.1221</span><span class="p">,</span> <span class="mf">2.73</span><span class="p">,</span> <span class="mf">2.4971</span><span class="p">,</span> <span class="mf">2.34</span><span class="p">,</span> <span class="mf">2.2256</span><span class="p">,</span> <span class="mf">2.1378</span><span class="p">,</span> <span class="mf">2.068</span><span class="p">,</span> <span class="mf">2.0108</span><span class="p">,</span> <span class="mf">1.9631</span><span class="p">,</span>
                       <span class="mf">1.9224</span><span class="p">,</span> <span class="mf">1.8873</span><span class="p">,</span> <span class="mf">1.8567</span><span class="p">,</span> <span class="mf">1.8297</span><span class="p">,</span> <span class="mf">1.8056</span><span class="p">,</span> <span class="mf">1.784</span><span class="p">,</span> <span class="mf">1.7646</span><span class="p">,</span> <span class="mf">1.7469</span><span class="p">,</span> <span class="mf">1.7308</span><span class="p">,</span> <span class="mf">1.716</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">74</span><span class="p">,</span> <span class="mf">3.9703</span><span class="p">,</span> <span class="mf">3.1204</span><span class="p">,</span> <span class="mf">2.7283</span><span class="p">,</span> <span class="mf">2.4954</span><span class="p">,</span> <span class="mf">2.3383</span><span class="p">,</span> <span class="mf">2.2238</span><span class="p">,</span> <span class="mf">2.1361</span><span class="p">,</span> <span class="mf">2.0662</span><span class="p">,</span> <span class="mf">2.009</span><span class="p">,</span> <span class="mf">1.9612</span><span class="p">,</span>
                       <span class="mf">1.9205</span><span class="p">,</span> <span class="mf">1.8854</span><span class="p">,</span> <span class="mf">1.8548</span><span class="p">,</span> <span class="mf">1.8278</span><span class="p">,</span> <span class="mf">1.8037</span><span class="p">,</span> <span class="mf">1.7821</span><span class="p">,</span> <span class="mf">1.7626</span><span class="p">,</span> <span class="mf">1.7449</span><span class="p">,</span> <span class="mf">1.7288</span><span class="p">,</span> <span class="mf">1.714</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">75</span><span class="p">,</span> <span class="mf">3.9685</span><span class="p">,</span> <span class="mf">3.1186</span><span class="p">,</span> <span class="mf">2.7266</span><span class="p">,</span> <span class="mf">2.4937</span><span class="p">,</span> <span class="mf">2.3366</span><span class="p">,</span> <span class="mf">2.2221</span><span class="p">,</span> <span class="mf">2.1343</span><span class="p">,</span> <span class="mf">2.0645</span><span class="p">,</span> <span class="mf">2.0073</span><span class="p">,</span> <span class="mf">1.9595</span><span class="p">,</span>
                       <span class="mf">1.9188</span><span class="p">,</span> <span class="mf">1.8836</span><span class="p">,</span> <span class="mf">1.853</span><span class="p">,</span> <span class="mf">1.8259</span><span class="p">,</span> <span class="mf">1.8018</span><span class="p">,</span> <span class="mf">1.7802</span><span class="p">,</span> <span class="mf">1.7607</span><span class="p">,</span> <span class="mf">1.7431</span><span class="p">,</span> <span class="mf">1.7269</span><span class="p">,</span> <span class="mf">1.7121</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">76</span><span class="p">,</span> <span class="mf">3.9668</span><span class="p">,</span> <span class="mf">3.117</span><span class="p">,</span> <span class="mf">2.7249</span><span class="p">,</span> <span class="mf">2.4921</span><span class="p">,</span> <span class="mf">2.3349</span><span class="p">,</span> <span class="mf">2.2204</span><span class="p">,</span> <span class="mf">2.1326</span><span class="p">,</span> <span class="mf">2.0627</span><span class="p">,</span> <span class="mf">2.0055</span><span class="p">,</span> <span class="mf">1.9577</span><span class="p">,</span>
                       <span class="mf">1.917</span><span class="p">,</span> <span class="mf">1.8819</span><span class="p">,</span> <span class="mf">1.8512</span><span class="p">,</span> <span class="mf">1.8241</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">,</span> <span class="mf">1.7784</span><span class="p">,</span> <span class="mf">1.7589</span><span class="p">,</span> <span class="mf">1.7412</span><span class="p">,</span> <span class="mf">1.725</span><span class="p">,</span> <span class="mf">1.7102</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">77</span><span class="p">,</span> <span class="mf">3.9651</span><span class="p">,</span> <span class="mf">3.1154</span><span class="p">,</span> <span class="mf">2.7233</span><span class="p">,</span> <span class="mf">2.4904</span><span class="p">,</span> <span class="mf">2.3333</span><span class="p">,</span> <span class="mf">2.2188</span><span class="p">,</span> <span class="mf">2.131</span><span class="p">,</span> <span class="mf">2.0611</span><span class="p">,</span> <span class="mf">2.0039</span><span class="p">,</span> <span class="mf">1.956</span><span class="p">,</span>
                       <span class="mf">1.9153</span><span class="p">,</span> <span class="mf">1.8801</span><span class="p">,</span> <span class="mf">1.8494</span><span class="p">,</span> <span class="mf">1.8223</span><span class="p">,</span> <span class="mf">1.7982</span><span class="p">,</span> <span class="mf">1.7766</span><span class="p">,</span> <span class="mf">1.7571</span><span class="p">,</span> <span class="mf">1.7394</span><span class="p">,</span> <span class="mf">1.7232</span><span class="p">,</span> <span class="mf">1.7084</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">78</span><span class="p">,</span> <span class="mf">3.9635</span><span class="p">,</span> <span class="mf">3.1138</span><span class="p">,</span> <span class="mf">2.7218</span><span class="p">,</span> <span class="mf">2.4889</span><span class="p">,</span> <span class="mf">2.3318</span><span class="p">,</span> <span class="mf">2.2172</span><span class="p">,</span> <span class="mf">2.1294</span><span class="p">,</span> <span class="mf">2.0595</span><span class="p">,</span> <span class="mf">2.0022</span><span class="p">,</span> <span class="mf">1.9544</span><span class="p">,</span>
                       <span class="mf">1.9136</span><span class="p">,</span> <span class="mf">1.8785</span><span class="p">,</span> <span class="mf">1.8478</span><span class="p">,</span> <span class="mf">1.8206</span><span class="p">,</span> <span class="mf">1.7965</span><span class="p">,</span> <span class="mf">1.7749</span><span class="p">,</span> <span class="mf">1.7554</span><span class="p">,</span> <span class="mf">1.7376</span><span class="p">,</span> <span class="mf">1.7214</span><span class="p">,</span> <span class="mf">1.7066</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">79</span><span class="p">,</span> <span class="mf">3.9619</span><span class="p">,</span> <span class="mf">3.1123</span><span class="p">,</span> <span class="mf">2.7203</span><span class="p">,</span> <span class="mf">2.4874</span><span class="p">,</span> <span class="mf">2.3302</span><span class="p">,</span> <span class="mf">2.2157</span><span class="p">,</span> <span class="mf">2.1279</span><span class="p">,</span> <span class="mf">2.0579</span><span class="p">,</span> <span class="mf">2.0006</span><span class="p">,</span> <span class="mf">1.9528</span><span class="p">,</span>
                       <span class="mf">1.912</span><span class="p">,</span> <span class="mf">1.8769</span><span class="p">,</span> <span class="mf">1.8461</span><span class="p">,</span> <span class="mf">1.819</span><span class="p">,</span> <span class="mf">1.7948</span><span class="p">,</span> <span class="mf">1.7732</span><span class="p">,</span> <span class="mf">1.7537</span><span class="p">,</span> <span class="mf">1.7359</span><span class="p">,</span> <span class="mf">1.7197</span><span class="p">,</span> <span class="mf">1.7048</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">80</span><span class="p">,</span> <span class="mf">3.9604</span><span class="p">,</span> <span class="mf">3.1107</span><span class="p">,</span> <span class="mf">2.7188</span><span class="p">,</span> <span class="mf">2.4859</span><span class="p">,</span> <span class="mf">2.3287</span><span class="p">,</span> <span class="mf">2.2142</span><span class="p">,</span> <span class="mf">2.1263</span><span class="p">,</span> <span class="mf">2.0564</span><span class="p">,</span> <span class="mf">1.9991</span><span class="p">,</span> <span class="mf">1.9512</span><span class="p">,</span>
                       <span class="mf">1.9105</span><span class="p">,</span> <span class="mf">1.8753</span><span class="p">,</span> <span class="mf">1.8445</span><span class="p">,</span> <span class="mf">1.8174</span><span class="p">,</span> <span class="mf">1.7932</span><span class="p">,</span> <span class="mf">1.7716</span><span class="p">,</span> <span class="mf">1.752</span><span class="p">,</span> <span class="mf">1.7342</span><span class="p">,</span> <span class="mf">1.718</span><span class="p">,</span> <span class="mf">1.7032</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">81</span><span class="p">,</span> <span class="mf">3.9589</span><span class="p">,</span> <span class="mf">3.1093</span><span class="p">,</span> <span class="mf">2.7173</span><span class="p">,</span> <span class="mf">2.4845</span><span class="p">,</span> <span class="mf">2.3273</span><span class="p">,</span> <span class="mf">2.2127</span><span class="p">,</span> <span class="mf">2.1248</span><span class="p">,</span> <span class="mf">2.0549</span><span class="p">,</span> <span class="mf">1.9976</span><span class="p">,</span> <span class="mf">1.9497</span><span class="p">,</span>
                       <span class="mf">1.9089</span><span class="p">,</span> <span class="mf">1.8737</span><span class="p">,</span> <span class="mf">1.8429</span><span class="p">,</span> <span class="mf">1.8158</span><span class="p">,</span> <span class="mf">1.7916</span><span class="p">,</span> <span class="mf">1.77</span><span class="p">,</span> <span class="mf">1.7504</span><span class="p">,</span> <span class="mf">1.7326</span><span class="p">,</span> <span class="mf">1.7164</span><span class="p">,</span> <span class="mf">1.7015</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">82</span><span class="p">,</span> <span class="mf">3.9574</span><span class="p">,</span> <span class="mf">3.1079</span><span class="p">,</span> <span class="mf">2.716</span><span class="p">,</span> <span class="mf">2.483</span><span class="p">,</span> <span class="mf">2.3258</span><span class="p">,</span> <span class="mf">2.2113</span><span class="p">,</span> <span class="mf">2.1234</span><span class="p">,</span> <span class="mf">2.0534</span><span class="p">,</span> <span class="mf">1.9962</span><span class="p">,</span> <span class="mf">1.9482</span><span class="p">,</span>
                       <span class="mf">1.9074</span><span class="p">,</span> <span class="mf">1.8722</span><span class="p">,</span> <span class="mf">1.8414</span><span class="p">,</span> <span class="mf">1.8143</span><span class="p">,</span> <span class="mf">1.7901</span><span class="p">,</span> <span class="mf">1.7684</span><span class="p">,</span> <span class="mf">1.7488</span><span class="p">,</span> <span class="mf">1.731</span><span class="p">,</span> <span class="mf">1.7148</span><span class="p">,</span> <span class="mf">1.6999</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">83</span><span class="p">,</span> <span class="mf">3.956</span><span class="p">,</span> <span class="mf">3.1065</span><span class="p">,</span> <span class="mf">2.7146</span><span class="p">,</span> <span class="mf">2.4817</span><span class="p">,</span> <span class="mf">2.3245</span><span class="p">,</span> <span class="mf">2.2099</span><span class="p">,</span> <span class="mf">2.122</span><span class="p">,</span> <span class="mf">2.052</span><span class="p">,</span> <span class="mf">1.9947</span><span class="p">,</span> <span class="mf">1.9468</span><span class="p">,</span>
                       <span class="mf">1.906</span><span class="p">,</span> <span class="mf">1.8707</span><span class="p">,</span> <span class="mf">1.8399</span><span class="p">,</span> <span class="mf">1.8127</span><span class="p">,</span> <span class="mf">1.7886</span><span class="p">,</span> <span class="mf">1.7669</span><span class="p">,</span> <span class="mf">1.7473</span><span class="p">,</span> <span class="mf">1.7295</span><span class="p">,</span> <span class="mf">1.7132</span><span class="p">,</span> <span class="mf">1.6983</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">84</span><span class="p">,</span> <span class="mf">3.9546</span><span class="p">,</span> <span class="mf">3.1051</span><span class="p">,</span> <span class="mf">2.7132</span><span class="p">,</span> <span class="mf">2.4803</span><span class="p">,</span> <span class="mf">2.3231</span><span class="p">,</span> <span class="mf">2.2086</span><span class="p">,</span> <span class="mf">2.1206</span><span class="p">,</span> <span class="mf">2.0506</span><span class="p">,</span> <span class="mf">1.9933</span><span class="p">,</span> <span class="mf">1.9454</span><span class="p">,</span>
                       <span class="mf">1.9045</span><span class="p">,</span> <span class="mf">1.8693</span><span class="p">,</span> <span class="mf">1.8385</span><span class="p">,</span> <span class="mf">1.8113</span><span class="p">,</span> <span class="mf">1.7871</span><span class="p">,</span> <span class="mf">1.7654</span><span class="p">,</span> <span class="mf">1.7458</span><span class="p">,</span> <span class="mf">1.728</span><span class="p">,</span> <span class="mf">1.7117</span><span class="p">,</span> <span class="mf">1.6968</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">85</span><span class="p">,</span> <span class="mf">3.9532</span><span class="p">,</span> <span class="mf">3.1039</span><span class="p">,</span> <span class="mf">2.7119</span><span class="p">,</span> <span class="mf">2.479</span><span class="p">,</span> <span class="mf">2.3218</span><span class="p">,</span> <span class="mf">2.2072</span><span class="p">,</span> <span class="mf">2.1193</span><span class="p">,</span> <span class="mf">2.0493</span><span class="p">,</span> <span class="mf">1.9919</span><span class="p">,</span> <span class="mf">1.944</span><span class="p">,</span>
                       <span class="mf">1.9031</span><span class="p">,</span> <span class="mf">1.8679</span><span class="p">,</span> <span class="mf">1.8371</span><span class="p">,</span> <span class="mf">1.8099</span><span class="p">,</span> <span class="mf">1.7856</span><span class="p">,</span> <span class="mf">1.7639</span><span class="p">,</span> <span class="mf">1.7443</span><span class="p">,</span> <span class="mf">1.7265</span><span class="p">,</span> <span class="mf">1.7102</span><span class="p">,</span> <span class="mf">1.6953</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">86</span><span class="p">,</span> <span class="mf">3.9519</span><span class="p">,</span> <span class="mf">3.1026</span><span class="p">,</span> <span class="mf">2.7106</span><span class="p">,</span> <span class="mf">2.4777</span><span class="p">,</span> <span class="mf">2.3205</span><span class="p">,</span> <span class="mf">2.2059</span><span class="p">,</span> <span class="mf">2.118</span><span class="p">,</span> <span class="mf">2.048</span><span class="p">,</span> <span class="mf">1.9906</span><span class="p">,</span> <span class="mf">1.9426</span><span class="p">,</span>
                       <span class="mf">1.9018</span><span class="p">,</span> <span class="mf">1.8665</span><span class="p">,</span> <span class="mf">1.8357</span><span class="p">,</span> <span class="mf">1.8085</span><span class="p">,</span> <span class="mf">1.7842</span><span class="p">,</span> <span class="mf">1.7625</span><span class="p">,</span> <span class="mf">1.7429</span><span class="p">,</span> <span class="mf">1.725</span><span class="p">,</span> <span class="mf">1.7088</span><span class="p">,</span> <span class="mf">1.6938</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">87</span><span class="p">,</span> <span class="mf">3.9506</span><span class="p">,</span> <span class="mf">3.1013</span><span class="p">,</span> <span class="mf">2.7094</span><span class="p">,</span> <span class="mf">2.4765</span><span class="p">,</span> <span class="mf">2.3193</span><span class="p">,</span> <span class="mf">2.2047</span><span class="p">,</span> <span class="mf">2.1167</span><span class="p">,</span> <span class="mf">2.0467</span><span class="p">,</span> <span class="mf">1.9893</span><span class="p">,</span> <span class="mf">1.9413</span><span class="p">,</span>
                       <span class="mf">1.9005</span><span class="p">,</span> <span class="mf">1.8652</span><span class="p">,</span> <span class="mf">1.8343</span><span class="p">,</span> <span class="mf">1.8071</span><span class="p">,</span> <span class="mf">1.7829</span><span class="p">,</span> <span class="mf">1.7611</span><span class="p">,</span> <span class="mf">1.7415</span><span class="p">,</span> <span class="mf">1.7236</span><span class="p">,</span> <span class="mf">1.7073</span><span class="p">,</span> <span class="mf">1.6924</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">88</span><span class="p">,</span> <span class="mf">3.9493</span><span class="p">,</span> <span class="mf">3.1001</span><span class="p">,</span> <span class="mf">2.7082</span><span class="p">,</span> <span class="mf">2.4753</span><span class="p">,</span> <span class="mf">2.318</span><span class="p">,</span> <span class="mf">2.2034</span><span class="p">,</span> <span class="mf">2.1155</span><span class="p">,</span> <span class="mf">2.0454</span><span class="p">,</span> <span class="mf">1.9881</span><span class="p">,</span> <span class="mf">1.94</span><span class="p">,</span>
                       <span class="mf">1.8992</span><span class="p">,</span> <span class="mf">1.8639</span><span class="p">,</span> <span class="mf">1.833</span><span class="p">,</span> <span class="mf">1.8058</span><span class="p">,</span> <span class="mf">1.7815</span><span class="p">,</span> <span class="mf">1.7598</span><span class="p">,</span> <span class="mf">1.7401</span><span class="p">,</span> <span class="mf">1.7223</span><span class="p">,</span> <span class="mf">1.706</span><span class="p">,</span> <span class="mf">1.691</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">89</span><span class="p">,</span> <span class="mf">3.9481</span><span class="p">,</span> <span class="mf">3.0988</span><span class="p">,</span> <span class="mf">2.707</span><span class="p">,</span> <span class="mf">2.4741</span><span class="p">,</span> <span class="mf">2.3169</span><span class="p">,</span> <span class="mf">2.2022</span><span class="p">,</span> <span class="mf">2.1143</span><span class="p">,</span> <span class="mf">2.0442</span><span class="p">,</span> <span class="mf">1.9868</span><span class="p">,</span> <span class="mf">1.9388</span><span class="p">,</span>
                       <span class="mf">1.8979</span><span class="p">,</span> <span class="mf">1.8626</span><span class="p">,</span> <span class="mf">1.8317</span><span class="p">,</span> <span class="mf">1.8045</span><span class="p">,</span> <span class="mf">1.7802</span><span class="p">,</span> <span class="mf">1.7584</span><span class="p">,</span> <span class="mf">1.7388</span><span class="p">,</span> <span class="mf">1.7209</span><span class="p">,</span> <span class="mf">1.7046</span><span class="p">,</span> <span class="mf">1.6896</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">90</span><span class="p">,</span> <span class="mf">3.9469</span><span class="p">,</span> <span class="mf">3.0977</span><span class="p">,</span> <span class="mf">2.7058</span><span class="p">,</span> <span class="mf">2.4729</span><span class="p">,</span> <span class="mf">2.3157</span><span class="p">,</span> <span class="mf">2.2011</span><span class="p">,</span> <span class="mf">2.1131</span><span class="p">,</span> <span class="mf">2.043</span><span class="p">,</span> <span class="mf">1.9856</span><span class="p">,</span> <span class="mf">1.9376</span><span class="p">,</span>
                       <span class="mf">1.8967</span><span class="p">,</span> <span class="mf">1.8613</span><span class="p">,</span> <span class="mf">1.8305</span><span class="p">,</span> <span class="mf">1.8032</span><span class="p">,</span> <span class="mf">1.7789</span><span class="p">,</span> <span class="mf">1.7571</span><span class="p">,</span> <span class="mf">1.7375</span><span class="p">,</span> <span class="mf">1.7196</span><span class="p">,</span> <span class="mf">1.7033</span><span class="p">,</span> <span class="mf">1.6883</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">91</span><span class="p">,</span> <span class="mf">3.9457</span><span class="p">,</span> <span class="mf">3.0965</span><span class="p">,</span> <span class="mf">2.7047</span><span class="p">,</span> <span class="mf">2.4718</span><span class="p">,</span> <span class="mf">2.3146</span><span class="p">,</span> <span class="mf">2.1999</span><span class="p">,</span> <span class="mf">2.1119</span><span class="p">,</span> <span class="mf">2.0418</span><span class="p">,</span> <span class="mf">1.9844</span><span class="p">,</span> <span class="mf">1.9364</span><span class="p">,</span>
                       <span class="mf">1.8955</span><span class="p">,</span> <span class="mf">1.8601</span><span class="p">,</span> <span class="mf">1.8292</span><span class="p">,</span> <span class="mf">1.802</span><span class="p">,</span> <span class="mf">1.7777</span><span class="p">,</span> <span class="mf">1.7559</span><span class="p">,</span> <span class="mf">1.7362</span><span class="p">,</span> <span class="mf">1.7183</span><span class="p">,</span> <span class="mf">1.702</span><span class="p">,</span> <span class="mf">1.687</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">92</span><span class="p">,</span> <span class="mf">3.9446</span><span class="p">,</span> <span class="mf">3.0955</span><span class="p">,</span> <span class="mf">2.7036</span><span class="p">,</span> <span class="mf">2.4707</span><span class="p">,</span> <span class="mf">2.3134</span><span class="p">,</span> <span class="mf">2.1988</span><span class="p">,</span> <span class="mf">2.1108</span><span class="p">,</span> <span class="mf">2.0407</span><span class="p">,</span> <span class="mf">1.9833</span><span class="p">,</span> <span class="mf">1.9352</span><span class="p">,</span>
                       <span class="mf">1.8943</span><span class="p">,</span> <span class="mf">1.8589</span><span class="p">,</span> <span class="mf">1.828</span><span class="p">,</span> <span class="mf">1.8008</span><span class="p">,</span> <span class="mf">1.7764</span><span class="p">,</span> <span class="mf">1.7546</span><span class="p">,</span> <span class="mf">1.735</span><span class="p">,</span> <span class="mf">1.717</span><span class="p">,</span> <span class="mf">1.7007</span><span class="p">,</span> <span class="mf">1.6857</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">93</span><span class="p">,</span> <span class="mf">3.9435</span><span class="p">,</span> <span class="mf">3.0944</span><span class="p">,</span> <span class="mf">2.7025</span><span class="p">,</span> <span class="mf">2.4696</span><span class="p">,</span> <span class="mf">2.3123</span><span class="p">,</span> <span class="mf">2.1977</span><span class="p">,</span> <span class="mf">2.1097</span><span class="p">,</span> <span class="mf">2.0395</span><span class="p">,</span> <span class="mf">1.9821</span><span class="p">,</span> <span class="mf">1.934</span><span class="p">,</span>
                       <span class="mf">1.8931</span><span class="p">,</span> <span class="mf">1.8578</span><span class="p">,</span> <span class="mf">1.8269</span><span class="p">,</span> <span class="mf">1.7996</span><span class="p">,</span> <span class="mf">1.7753</span><span class="p">,</span> <span class="mf">1.7534</span><span class="p">,</span> <span class="mf">1.7337</span><span class="p">,</span> <span class="mf">1.7158</span><span class="p">,</span> <span class="mf">1.6995</span><span class="p">,</span> <span class="mf">1.6845</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">94</span><span class="p">,</span> <span class="mf">3.9423</span><span class="p">,</span> <span class="mf">3.0933</span><span class="p">,</span> <span class="mf">2.7014</span><span class="p">,</span> <span class="mf">2.4685</span><span class="p">,</span> <span class="mf">2.3113</span><span class="p">,</span> <span class="mf">2.1966</span><span class="p">,</span> <span class="mf">2.1086</span><span class="p">,</span> <span class="mf">2.0385</span><span class="p">,</span> <span class="mf">1.981</span><span class="p">,</span> <span class="mf">1.9329</span><span class="p">,</span>
                       <span class="mf">1.892</span><span class="p">,</span> <span class="mf">1.8566</span><span class="p">,</span> <span class="mf">1.8257</span><span class="p">,</span> <span class="mf">1.7984</span><span class="p">,</span> <span class="mf">1.7741</span><span class="p">,</span> <span class="mf">1.7522</span><span class="p">,</span> <span class="mf">1.7325</span><span class="p">,</span> <span class="mf">1.7146</span><span class="p">,</span> <span class="mf">1.6982</span><span class="p">,</span> <span class="mf">1.6832</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">95</span><span class="p">,</span> <span class="mf">3.9412</span><span class="p">,</span> <span class="mf">3.0922</span><span class="p">,</span> <span class="mf">2.7004</span><span class="p">,</span> <span class="mf">2.4675</span><span class="p">,</span> <span class="mf">2.3102</span><span class="p">,</span> <span class="mf">2.1955</span><span class="p">,</span> <span class="mf">2.1075</span><span class="p">,</span> <span class="mf">2.0374</span><span class="p">,</span> <span class="mf">1.9799</span><span class="p">,</span> <span class="mf">1.9318</span><span class="p">,</span>
                       <span class="mf">1.8909</span><span class="p">,</span> <span class="mf">1.8555</span><span class="p">,</span> <span class="mf">1.8246</span><span class="p">,</span> <span class="mf">1.7973</span><span class="p">,</span> <span class="mf">1.7729</span><span class="p">,</span> <span class="mf">1.7511</span><span class="p">,</span> <span class="mf">1.7314</span><span class="p">,</span> <span class="mf">1.7134</span><span class="p">,</span> <span class="mf">1.6971</span><span class="p">,</span> <span class="mf">1.682</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">96</span><span class="p">,</span> <span class="mf">3.9402</span><span class="p">,</span> <span class="mf">3.0912</span><span class="p">,</span> <span class="mf">2.6994</span><span class="p">,</span> <span class="mf">2.4665</span><span class="p">,</span> <span class="mf">2.3092</span><span class="p">,</span> <span class="mf">2.1945</span><span class="p">,</span> <span class="mf">2.1065</span><span class="p">,</span> <span class="mf">2.0363</span><span class="p">,</span> <span class="mf">1.9789</span><span class="p">,</span> <span class="mf">1.9308</span><span class="p">,</span>
                       <span class="mf">1.8898</span><span class="p">,</span> <span class="mf">1.8544</span><span class="p">,</span> <span class="mf">1.8235</span><span class="p">,</span> <span class="mf">1.7961</span><span class="p">,</span> <span class="mf">1.7718</span><span class="p">,</span> <span class="mf">1.75</span><span class="p">,</span> <span class="mf">1.7302</span><span class="p">,</span> <span class="mf">1.7123</span><span class="p">,</span> <span class="mf">1.6959</span><span class="p">,</span> <span class="mf">1.6809</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">97</span><span class="p">,</span> <span class="mf">3.9392</span><span class="p">,</span> <span class="mf">3.0902</span><span class="p">,</span> <span class="mf">2.6984</span><span class="p">,</span> <span class="mf">2.4655</span><span class="p">,</span> <span class="mf">2.3082</span><span class="p">,</span> <span class="mf">2.1935</span><span class="p">,</span> <span class="mf">2.1054</span><span class="p">,</span> <span class="mf">2.0353</span><span class="p">,</span> <span class="mf">1.9778</span><span class="p">,</span> <span class="mf">1.9297</span><span class="p">,</span>
                       <span class="mf">1.8888</span><span class="p">,</span> <span class="mf">1.8533</span><span class="p">,</span> <span class="mf">1.8224</span><span class="p">,</span> <span class="mf">1.7951</span><span class="p">,</span> <span class="mf">1.7707</span><span class="p">,</span> <span class="mf">1.7488</span><span class="p">,</span> <span class="mf">1.7291</span><span class="p">,</span> <span class="mf">1.7112</span><span class="p">,</span> <span class="mf">1.6948</span><span class="p">,</span> <span class="mf">1.6797</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">98</span><span class="p">,</span> <span class="mf">3.9381</span><span class="p">,</span> <span class="mf">3.0892</span><span class="p">,</span> <span class="mf">2.6974</span><span class="p">,</span> <span class="mf">2.4645</span><span class="p">,</span> <span class="mf">2.3072</span><span class="p">,</span> <span class="mf">2.1925</span><span class="p">,</span> <span class="mf">2.1044</span><span class="p">,</span> <span class="mf">2.0343</span><span class="p">,</span> <span class="mf">1.9768</span><span class="p">,</span> <span class="mf">1.9287</span><span class="p">,</span>
                       <span class="mf">1.8877</span><span class="p">,</span> <span class="mf">1.8523</span><span class="p">,</span> <span class="mf">1.8213</span><span class="p">,</span> <span class="mf">1.794</span><span class="p">,</span> <span class="mf">1.7696</span><span class="p">,</span> <span class="mf">1.7478</span><span class="p">,</span> <span class="mf">1.728</span><span class="p">,</span> <span class="mf">1.71</span><span class="p">,</span> <span class="mf">1.6936</span><span class="p">,</span> <span class="mf">1.6786</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">99</span><span class="p">,</span> <span class="mf">3.9371</span><span class="p">,</span> <span class="mf">3.0882</span><span class="p">,</span> <span class="mf">2.6965</span><span class="p">,</span> <span class="mf">2.4636</span><span class="p">,</span> <span class="mf">2.3062</span><span class="p">,</span> <span class="mf">2.1916</span><span class="p">,</span> <span class="mf">2.1035</span><span class="p">,</span> <span class="mf">2.0333</span><span class="p">,</span> <span class="mf">1.9758</span><span class="p">,</span> <span class="mf">1.9277</span><span class="p">,</span>
                       <span class="mf">1.8867</span><span class="p">,</span> <span class="mf">1.8513</span><span class="p">,</span> <span class="mf">1.8203</span><span class="p">,</span> <span class="mf">1.7929</span><span class="p">,</span> <span class="mf">1.7686</span><span class="p">,</span> <span class="mf">1.7467</span><span class="p">,</span> <span class="mf">1.7269</span><span class="p">,</span> <span class="mf">1.709</span><span class="p">,</span> <span class="mf">1.6926</span><span class="p">,</span> <span class="mf">1.6775</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mf">3.9361</span><span class="p">,</span> <span class="mf">3.0873</span><span class="p">,</span> <span class="mf">2.6955</span><span class="p">,</span> <span class="mf">2.4626</span><span class="p">,</span> <span class="mf">2.3053</span><span class="p">,</span> <span class="mf">2.1906</span><span class="p">,</span> <span class="mf">2.1025</span><span class="p">,</span> <span class="mf">2.0323</span><span class="p">,</span> <span class="mf">1.9748</span><span class="p">,</span> <span class="mf">1.9267</span><span class="p">,</span>
                       <span class="mf">1.8857</span><span class="p">,</span> <span class="mf">1.8502</span><span class="p">,</span> <span class="mf">1.8193</span><span class="p">,</span> <span class="mf">1.7919</span><span class="p">,</span> <span class="mf">1.7675</span><span class="p">,</span> <span class="mf">1.7456</span><span class="p">,</span> <span class="mf">1.7259</span><span class="p">,</span> <span class="mf">1.7079</span><span class="p">,</span> <span class="mf">1.6915</span><span class="p">,</span> <span class="mf">1.6764</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">101</span><span class="p">,</span> <span class="mf">3.9352</span><span class="p">,</span> <span class="mf">3.0864</span><span class="p">,</span> <span class="mf">2.6946</span><span class="p">,</span> <span class="mf">2.4617</span><span class="p">,</span> <span class="mf">2.3044</span><span class="p">,</span> <span class="mf">2.1897</span><span class="p">,</span> <span class="mf">2.1016</span><span class="p">,</span> <span class="mf">2.0314</span><span class="p">,</span> <span class="mf">1.9739</span><span class="p">,</span> <span class="mf">1.9257</span><span class="p">,</span>
                       <span class="mf">1.8847</span><span class="p">,</span> <span class="mf">1.8493</span><span class="p">,</span> <span class="mf">1.8183</span><span class="p">,</span> <span class="mf">1.7909</span><span class="p">,</span> <span class="mf">1.7665</span><span class="p">,</span> <span class="mf">1.7446</span><span class="p">,</span> <span class="mf">1.7248</span><span class="p">,</span> <span class="mf">1.7069</span><span class="p">,</span> <span class="mf">1.6904</span><span class="p">,</span> <span class="mf">1.6754</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">102</span><span class="p">,</span> <span class="mf">3.9342</span><span class="p">,</span> <span class="mf">3.0854</span><span class="p">,</span> <span class="mf">2.6937</span><span class="p">,</span> <span class="mf">2.4608</span><span class="p">,</span> <span class="mf">2.3035</span><span class="p">,</span> <span class="mf">2.1888</span><span class="p">,</span> <span class="mf">2.1007</span><span class="p">,</span> <span class="mf">2.0304</span><span class="p">,</span> <span class="mf">1.9729</span><span class="p">,</span> <span class="mf">1.9248</span><span class="p">,</span>
                       <span class="mf">1.8838</span><span class="p">,</span> <span class="mf">1.8483</span><span class="p">,</span> <span class="mf">1.8173</span><span class="p">,</span> <span class="mf">1.7899</span><span class="p">,</span> <span class="mf">1.7655</span><span class="p">,</span> <span class="mf">1.7436</span><span class="p">,</span> <span class="mf">1.7238</span><span class="p">,</span> <span class="mf">1.7058</span><span class="p">,</span> <span class="mf">1.6894</span><span class="p">,</span> <span class="mf">1.6744</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">103</span><span class="p">,</span> <span class="mf">3.9333</span><span class="p">,</span> <span class="mf">3.0846</span><span class="p">,</span> <span class="mf">2.6928</span><span class="p">,</span> <span class="mf">2.4599</span><span class="p">,</span> <span class="mf">2.3026</span><span class="p">,</span> <span class="mf">2.1879</span><span class="p">,</span> <span class="mf">2.0997</span><span class="p">,</span> <span class="mf">2.0295</span><span class="p">,</span> <span class="mf">1.972</span><span class="p">,</span> <span class="mf">1.9238</span><span class="p">,</span>
                       <span class="mf">1.8828</span><span class="p">,</span> <span class="mf">1.8474</span><span class="p">,</span> <span class="mf">1.8163</span><span class="p">,</span> <span class="mf">1.789</span><span class="p">,</span> <span class="mf">1.7645</span><span class="p">,</span> <span class="mf">1.7427</span><span class="p">,</span> <span class="mf">1.7229</span><span class="p">,</span> <span class="mf">1.7048</span><span class="p">,</span> <span class="mf">1.6884</span><span class="p">,</span> <span class="mf">1.6733</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">104</span><span class="p">,</span> <span class="mf">3.9325</span><span class="p">,</span> <span class="mf">3.0837</span><span class="p">,</span> <span class="mf">2.692</span><span class="p">,</span> <span class="mf">2.4591</span><span class="p">,</span> <span class="mf">2.3017</span><span class="p">,</span> <span class="mf">2.187</span><span class="p">,</span> <span class="mf">2.0989</span><span class="p">,</span> <span class="mf">2.0287</span><span class="p">,</span> <span class="mf">1.9711</span><span class="p">,</span> <span class="mf">1.9229</span><span class="p">,</span>
                       <span class="mf">1.8819</span><span class="p">,</span> <span class="mf">1.8464</span><span class="p">,</span> <span class="mf">1.8154</span><span class="p">,</span> <span class="mf">1.788</span><span class="p">,</span> <span class="mf">1.7636</span><span class="p">,</span> <span class="mf">1.7417</span><span class="p">,</span> <span class="mf">1.7219</span><span class="p">,</span> <span class="mf">1.7039</span><span class="p">,</span> <span class="mf">1.6874</span><span class="p">,</span> <span class="mf">1.6723</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">105</span><span class="p">,</span> <span class="mf">3.9316</span><span class="p">,</span> <span class="mf">3.0828</span><span class="p">,</span> <span class="mf">2.6912</span><span class="p">,</span> <span class="mf">2.4582</span><span class="p">,</span> <span class="mf">2.3009</span><span class="p">,</span> <span class="mf">2.1861</span><span class="p">,</span> <span class="mf">2.098</span><span class="p">,</span> <span class="mf">2.0278</span><span class="p">,</span> <span class="mf">1.9702</span><span class="p">,</span> <span class="mf">1.922</span><span class="p">,</span>
                       <span class="mf">1.881</span><span class="p">,</span> <span class="mf">1.8455</span><span class="p">,</span> <span class="mf">1.8145</span><span class="p">,</span> <span class="mf">1.7871</span><span class="p">,</span> <span class="mf">1.7627</span><span class="p">,</span> <span class="mf">1.7407</span><span class="p">,</span> <span class="mf">1.7209</span><span class="p">,</span> <span class="mf">1.7029</span><span class="p">,</span> <span class="mf">1.6865</span><span class="p">,</span> <span class="mf">1.6714</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">106</span><span class="p">,</span> <span class="mf">3.9307</span><span class="p">,</span> <span class="mf">3.082</span><span class="p">,</span> <span class="mf">2.6903</span><span class="p">,</span> <span class="mf">2.4574</span><span class="p">,</span> <span class="mf">2.3</span><span class="p">,</span> <span class="mf">2.1853</span><span class="p">,</span> <span class="mf">2.0971</span><span class="p">,</span> <span class="mf">2.0269</span><span class="p">,</span> <span class="mf">1.9694</span><span class="p">,</span> <span class="mf">1.9212</span><span class="p">,</span>
                       <span class="mf">1.8801</span><span class="p">,</span> <span class="mf">1.8446</span><span class="p">,</span> <span class="mf">1.8136</span><span class="p">,</span> <span class="mf">1.7862</span><span class="p">,</span> <span class="mf">1.7618</span><span class="p">,</span> <span class="mf">1.7398</span><span class="p">,</span> <span class="mf">1.72</span><span class="p">,</span> <span class="mf">1.702</span><span class="p">,</span> <span class="mf">1.6855</span><span class="p">,</span> <span class="mf">1.6704</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">107</span><span class="p">,</span> <span class="mf">3.9299</span><span class="p">,</span> <span class="mf">3.0812</span><span class="p">,</span> <span class="mf">2.6895</span><span class="p">,</span> <span class="mf">2.4566</span><span class="p">,</span> <span class="mf">2.2992</span><span class="p">,</span> <span class="mf">2.1845</span><span class="p">,</span> <span class="mf">2.0963</span><span class="p">,</span> <span class="mf">2.0261</span><span class="p">,</span> <span class="mf">1.9685</span><span class="p">,</span> <span class="mf">1.9203</span><span class="p">,</span>
                       <span class="mf">1.8792</span><span class="p">,</span> <span class="mf">1.8438</span><span class="p">,</span> <span class="mf">1.8127</span><span class="p">,</span> <span class="mf">1.7853</span><span class="p">,</span> <span class="mf">1.7608</span><span class="p">,</span> <span class="mf">1.7389</span><span class="p">,</span> <span class="mf">1.7191</span><span class="p">,</span> <span class="mf">1.7011</span><span class="p">,</span> <span class="mf">1.6846</span><span class="p">,</span> <span class="mf">1.6695</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">108</span><span class="p">,</span> <span class="mf">3.929</span><span class="p">,</span> <span class="mf">3.0804</span><span class="p">,</span> <span class="mf">2.6887</span><span class="p">,</span> <span class="mf">2.4558</span><span class="p">,</span> <span class="mf">2.2984</span><span class="p">,</span> <span class="mf">2.1837</span><span class="p">,</span> <span class="mf">2.0955</span><span class="p">,</span> <span class="mf">2.0252</span><span class="p">,</span> <span class="mf">1.9677</span><span class="p">,</span> <span class="mf">1.9195</span><span class="p">,</span>
                       <span class="mf">1.8784</span><span class="p">,</span> <span class="mf">1.8429</span><span class="p">,</span> <span class="mf">1.8118</span><span class="p">,</span> <span class="mf">1.7844</span><span class="p">,</span> <span class="mf">1.7599</span><span class="p">,</span> <span class="mf">1.738</span><span class="p">,</span> <span class="mf">1.7182</span><span class="p">,</span> <span class="mf">1.7001</span><span class="p">,</span> <span class="mf">1.6837</span><span class="p">,</span> <span class="mf">1.6685</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">109</span><span class="p">,</span> <span class="mf">3.9282</span><span class="p">,</span> <span class="mf">3.0796</span><span class="p">,</span> <span class="mf">2.6879</span><span class="p">,</span> <span class="mf">2.455</span><span class="p">,</span> <span class="mf">2.2976</span><span class="p">,</span> <span class="mf">2.1828</span><span class="p">,</span> <span class="mf">2.0947</span><span class="p">,</span> <span class="mf">2.0244</span><span class="p">,</span> <span class="mf">1.9669</span><span class="p">,</span> <span class="mf">1.9186</span><span class="p">,</span>
                       <span class="mf">1.8776</span><span class="p">,</span> <span class="mf">1.8421</span><span class="p">,</span> <span class="mf">1.811</span><span class="p">,</span> <span class="mf">1.7835</span><span class="p">,</span> <span class="mf">1.7591</span><span class="p">,</span> <span class="mf">1.7371</span><span class="p">,</span> <span class="mf">1.7173</span><span class="p">,</span> <span class="mf">1.6992</span><span class="p">,</span> <span class="mf">1.6828</span><span class="p">,</span> <span class="mf">1.6676</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">110</span><span class="p">,</span> <span class="mf">3.9274</span><span class="p">,</span> <span class="mf">3.0788</span><span class="p">,</span> <span class="mf">2.6872</span><span class="p">,</span> <span class="mf">2.4542</span><span class="p">,</span> <span class="mf">2.2968</span><span class="p">,</span> <span class="mf">2.1821</span><span class="p">,</span> <span class="mf">2.0939</span><span class="p">,</span> <span class="mf">2.0236</span><span class="p">,</span> <span class="mf">1.9661</span><span class="p">,</span> <span class="mf">1.9178</span><span class="p">,</span>
                       <span class="mf">1.8767</span><span class="p">,</span> <span class="mf">1.8412</span><span class="p">,</span> <span class="mf">1.8102</span><span class="p">,</span> <span class="mf">1.7827</span><span class="p">,</span> <span class="mf">1.7582</span><span class="p">,</span> <span class="mf">1.7363</span><span class="p">,</span> <span class="mf">1.7164</span><span class="p">,</span> <span class="mf">1.6984</span><span class="p">,</span> <span class="mf">1.6819</span><span class="p">,</span> <span class="mf">1.6667</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">111</span><span class="p">,</span> <span class="mf">3.9266</span><span class="p">,</span> <span class="mf">3.0781</span><span class="p">,</span> <span class="mf">2.6864</span><span class="p">,</span> <span class="mf">2.4535</span><span class="p">,</span> <span class="mf">2.2961</span><span class="p">,</span> <span class="mf">2.1813</span><span class="p">,</span> <span class="mf">2.0931</span><span class="p">,</span> <span class="mf">2.0229</span><span class="p">,</span> <span class="mf">1.9653</span><span class="p">,</span> <span class="mf">1.917</span><span class="p">,</span>
                       <span class="mf">1.8759</span><span class="p">,</span> <span class="mf">1.8404</span><span class="p">,</span> <span class="mf">1.8093</span><span class="p">,</span> <span class="mf">1.7819</span><span class="p">,</span> <span class="mf">1.7574</span><span class="p">,</span> <span class="mf">1.7354</span><span class="p">,</span> <span class="mf">1.7156</span><span class="p">,</span> <span class="mf">1.6975</span><span class="p">,</span> <span class="mf">1.681</span><span class="p">,</span> <span class="mf">1.6659</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">112</span><span class="p">,</span> <span class="mf">3.9258</span><span class="p">,</span> <span class="mf">3.0773</span><span class="p">,</span> <span class="mf">2.6857</span><span class="p">,</span> <span class="mf">2.4527</span><span class="p">,</span> <span class="mf">2.2954</span><span class="p">,</span> <span class="mf">2.1806</span><span class="p">,</span> <span class="mf">2.0924</span><span class="p">,</span> <span class="mf">2.0221</span><span class="p">,</span> <span class="mf">1.9645</span><span class="p">,</span> <span class="mf">1.9163</span><span class="p">,</span>
                       <span class="mf">1.8751</span><span class="p">,</span> <span class="mf">1.8396</span><span class="p">,</span> <span class="mf">1.8085</span><span class="p">,</span> <span class="mf">1.7811</span><span class="p">,</span> <span class="mf">1.7566</span><span class="p">,</span> <span class="mf">1.7346</span><span class="p">,</span> <span class="mf">1.7147</span><span class="p">,</span> <span class="mf">1.6967</span><span class="p">,</span> <span class="mf">1.6802</span><span class="p">,</span> <span class="mf">1.665</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">113</span><span class="p">,</span> <span class="mf">3.9251</span><span class="p">,</span> <span class="mf">3.0766</span><span class="p">,</span> <span class="mf">2.6849</span><span class="p">,</span> <span class="mf">2.452</span><span class="p">,</span> <span class="mf">2.2946</span><span class="p">,</span> <span class="mf">2.1798</span><span class="p">,</span> <span class="mf">2.0916</span><span class="p">,</span> <span class="mf">2.0213</span><span class="p">,</span> <span class="mf">1.9637</span><span class="p">,</span> <span class="mf">1.9155</span><span class="p">,</span>
                       <span class="mf">1.8744</span><span class="p">,</span> <span class="mf">1.8388</span><span class="p">,</span> <span class="mf">1.8077</span><span class="p">,</span> <span class="mf">1.7803</span><span class="p">,</span> <span class="mf">1.7558</span><span class="p">,</span> <span class="mf">1.7338</span><span class="p">,</span> <span class="mf">1.7139</span><span class="p">,</span> <span class="mf">1.6958</span><span class="p">,</span> <span class="mf">1.6793</span><span class="p">,</span> <span class="mf">1.6642</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">114</span><span class="p">,</span> <span class="mf">3.9243</span><span class="p">,</span> <span class="mf">3.0758</span><span class="p">,</span> <span class="mf">2.6842</span><span class="p">,</span> <span class="mf">2.4513</span><span class="p">,</span> <span class="mf">2.2939</span><span class="p">,</span> <span class="mf">2.1791</span><span class="p">,</span> <span class="mf">2.0909</span><span class="p">,</span> <span class="mf">2.0206</span><span class="p">,</span> <span class="mf">1.963</span><span class="p">,</span> <span class="mf">1.9147</span><span class="p">,</span>
                       <span class="mf">1.8736</span><span class="p">,</span> <span class="mf">1.8381</span><span class="p">,</span> <span class="mf">1.8069</span><span class="p">,</span> <span class="mf">1.7795</span><span class="p">,</span> <span class="mf">1.755</span><span class="p">,</span> <span class="mf">1.733</span><span class="p">,</span> <span class="mf">1.7131</span><span class="p">,</span> <span class="mf">1.695</span><span class="p">,</span> <span class="mf">1.6785</span><span class="p">,</span> <span class="mf">1.6633</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">115</span><span class="p">,</span> <span class="mf">3.9236</span><span class="p">,</span> <span class="mf">3.0751</span><span class="p">,</span> <span class="mf">2.6835</span><span class="p">,</span> <span class="mf">2.4506</span><span class="p">,</span> <span class="mf">2.2932</span><span class="p">,</span> <span class="mf">2.1784</span><span class="p">,</span> <span class="mf">2.0902</span><span class="p">,</span> <span class="mf">2.0199</span><span class="p">,</span> <span class="mf">1.9623</span><span class="p">,</span> <span class="mf">1.914</span><span class="p">,</span>
                       <span class="mf">1.8729</span><span class="p">,</span> <span class="mf">1.8373</span><span class="p">,</span> <span class="mf">1.8062</span><span class="p">,</span> <span class="mf">1.7787</span><span class="p">,</span> <span class="mf">1.7542</span><span class="p">,</span> <span class="mf">1.7322</span><span class="p">,</span> <span class="mf">1.7123</span><span class="p">,</span> <span class="mf">1.6942</span><span class="p">,</span> <span class="mf">1.6777</span><span class="p">,</span> <span class="mf">1.6625</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">116</span><span class="p">,</span> <span class="mf">3.9228</span><span class="p">,</span> <span class="mf">3.0744</span><span class="p">,</span> <span class="mf">2.6828</span><span class="p">,</span> <span class="mf">2.4499</span><span class="p">,</span> <span class="mf">2.2925</span><span class="p">,</span> <span class="mf">2.1777</span><span class="p">,</span> <span class="mf">2.0895</span><span class="p">,</span> <span class="mf">2.0192</span><span class="p">,</span> <span class="mf">1.9615</span><span class="p">,</span> <span class="mf">1.9132</span><span class="p">,</span>
                       <span class="mf">1.8721</span><span class="p">,</span> <span class="mf">1.8365</span><span class="p">,</span> <span class="mf">1.8054</span><span class="p">,</span> <span class="mf">1.7779</span><span class="p">,</span> <span class="mf">1.7534</span><span class="p">,</span> <span class="mf">1.7314</span><span class="p">,</span> <span class="mf">1.7115</span><span class="p">,</span> <span class="mf">1.6934</span><span class="p">,</span> <span class="mf">1.6769</span><span class="p">,</span> <span class="mf">1.6617</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">117</span><span class="p">,</span> <span class="mf">3.9222</span><span class="p">,</span> <span class="mf">3.0738</span><span class="p">,</span> <span class="mf">2.6821</span><span class="p">,</span> <span class="mf">2.4492</span><span class="p">,</span> <span class="mf">2.2918</span><span class="p">,</span> <span class="mf">2.177</span><span class="p">,</span> <span class="mf">2.0888</span><span class="p">,</span> <span class="mf">2.0185</span><span class="p">,</span> <span class="mf">1.9608</span><span class="p">,</span> <span class="mf">1.9125</span><span class="p">,</span>
                       <span class="mf">1.8714</span><span class="p">,</span> <span class="mf">1.8358</span><span class="p">,</span> <span class="mf">1.8047</span><span class="p">,</span> <span class="mf">1.7772</span><span class="p">,</span> <span class="mf">1.7527</span><span class="p">,</span> <span class="mf">1.7307</span><span class="p">,</span> <span class="mf">1.7108</span><span class="p">,</span> <span class="mf">1.6927</span><span class="p">,</span> <span class="mf">1.6761</span><span class="p">,</span> <span class="mf">1.6609</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">118</span><span class="p">,</span> <span class="mf">3.9215</span><span class="p">,</span> <span class="mf">3.0731</span><span class="p">,</span> <span class="mf">2.6815</span><span class="p">,</span> <span class="mf">2.4485</span><span class="p">,</span> <span class="mf">2.2912</span><span class="p">,</span> <span class="mf">2.1763</span><span class="p">,</span> <span class="mf">2.0881</span><span class="p">,</span> <span class="mf">2.0178</span><span class="p">,</span> <span class="mf">1.9601</span><span class="p">,</span> <span class="mf">1.9118</span><span class="p">,</span>
                       <span class="mf">1.8707</span><span class="p">,</span> <span class="mf">1.8351</span><span class="p">,</span> <span class="mf">1.804</span><span class="p">,</span> <span class="mf">1.7765</span><span class="p">,</span> <span class="mf">1.752</span><span class="p">,</span> <span class="mf">1.7299</span><span class="p">,</span> <span class="mf">1.71</span><span class="p">,</span> <span class="mf">1.6919</span><span class="p">,</span> <span class="mf">1.6754</span><span class="p">,</span> <span class="mf">1.6602</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">119</span><span class="p">,</span> <span class="mf">3.9208</span><span class="p">,</span> <span class="mf">3.0724</span><span class="p">,</span> <span class="mf">2.6808</span><span class="p">,</span> <span class="mf">2.4479</span><span class="p">,</span> <span class="mf">2.2905</span><span class="p">,</span> <span class="mf">2.1757</span><span class="p">,</span> <span class="mf">2.0874</span><span class="p">,</span> <span class="mf">2.0171</span><span class="p">,</span> <span class="mf">1.9594</span><span class="p">,</span> <span class="mf">1.9111</span><span class="p">,</span>
                       <span class="mf">1.87</span><span class="p">,</span> <span class="mf">1.8344</span><span class="p">,</span> <span class="mf">1.8032</span><span class="p">,</span> <span class="mf">1.7757</span><span class="p">,</span> <span class="mf">1.7512</span><span class="p">,</span> <span class="mf">1.7292</span><span class="p">,</span> <span class="mf">1.7093</span><span class="p">,</span> <span class="mf">1.6912</span><span class="p">,</span> <span class="mf">1.6746</span><span class="p">,</span> <span class="mf">1.6594</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">120</span><span class="p">,</span> <span class="mf">3.9202</span><span class="p">,</span> <span class="mf">3.0718</span><span class="p">,</span> <span class="mf">2.6802</span><span class="p">,</span> <span class="mf">2.4472</span><span class="p">,</span> <span class="mf">2.2899</span><span class="p">,</span> <span class="mf">2.175</span><span class="p">,</span> <span class="mf">2.0868</span><span class="p">,</span> <span class="mf">2.0164</span><span class="p">,</span> <span class="mf">1.9588</span><span class="p">,</span> <span class="mf">1.9105</span><span class="p">,</span>
                       <span class="mf">1.8693</span><span class="p">,</span> <span class="mf">1.8337</span><span class="p">,</span> <span class="mf">1.8026</span><span class="p">,</span> <span class="mf">1.775</span><span class="p">,</span> <span class="mf">1.7505</span><span class="p">,</span> <span class="mf">1.7285</span><span class="p">,</span> <span class="mf">1.7085</span><span class="p">,</span> <span class="mf">1.6904</span><span class="p">,</span> <span class="mf">1.6739</span><span class="p">,</span> <span class="mf">1.6587</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">121</span><span class="p">,</span> <span class="mf">3.9194</span><span class="p">,</span> <span class="mf">3.0712</span><span class="p">,</span> <span class="mf">2.6795</span><span class="p">,</span> <span class="mf">2.4466</span><span class="p">,</span> <span class="mf">2.2892</span><span class="p">,</span> <span class="mf">2.1744</span><span class="p">,</span> <span class="mf">2.0861</span><span class="p">,</span> <span class="mf">2.0158</span><span class="p">,</span> <span class="mf">1.9581</span><span class="p">,</span> <span class="mf">1.9098</span><span class="p">,</span>
                       <span class="mf">1.8686</span><span class="p">,</span> <span class="mf">1.833</span><span class="p">,</span> <span class="mf">1.8019</span><span class="p">,</span> <span class="mf">1.7743</span><span class="p">,</span> <span class="mf">1.7498</span><span class="p">,</span> <span class="mf">1.7278</span><span class="p">,</span> <span class="mf">1.7078</span><span class="p">,</span> <span class="mf">1.6897</span><span class="p">,</span> <span class="mf">1.6732</span><span class="p">,</span> <span class="mf">1.6579</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">122</span><span class="p">,</span> <span class="mf">3.9188</span><span class="p">,</span> <span class="mf">3.0705</span><span class="p">,</span> <span class="mf">2.6789</span><span class="p">,</span> <span class="mf">2.446</span><span class="p">,</span> <span class="mf">2.2886</span><span class="p">,</span> <span class="mf">2.1737</span><span class="p">,</span> <span class="mf">2.0855</span><span class="p">,</span> <span class="mf">2.0151</span><span class="p">,</span> <span class="mf">1.9575</span><span class="p">,</span> <span class="mf">1.9091</span><span class="p">,</span>
                       <span class="mf">1.868</span><span class="p">,</span> <span class="mf">1.8324</span><span class="p">,</span> <span class="mf">1.8012</span><span class="p">,</span> <span class="mf">1.7736</span><span class="p">,</span> <span class="mf">1.7491</span><span class="p">,</span> <span class="mf">1.727</span><span class="p">,</span> <span class="mf">1.7071</span><span class="p">,</span> <span class="mf">1.689</span><span class="p">,</span> <span class="mf">1.6724</span><span class="p">,</span> <span class="mf">1.6572</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">123</span><span class="p">,</span> <span class="mf">3.9181</span><span class="p">,</span> <span class="mf">3.0699</span><span class="p">,</span> <span class="mf">2.6783</span><span class="p">,</span> <span class="mf">2.4454</span><span class="p">,</span> <span class="mf">2.288</span><span class="p">,</span> <span class="mf">2.1731</span><span class="p">,</span> <span class="mf">2.0849</span><span class="p">,</span> <span class="mf">2.0145</span><span class="p">,</span> <span class="mf">1.9568</span><span class="p">,</span> <span class="mf">1.9085</span><span class="p">,</span>
                       <span class="mf">1.8673</span><span class="p">,</span> <span class="mf">1.8317</span><span class="p">,</span> <span class="mf">1.8005</span><span class="p">,</span> <span class="mf">1.773</span><span class="p">,</span> <span class="mf">1.7484</span><span class="p">,</span> <span class="mf">1.7264</span><span class="p">,</span> <span class="mf">1.7064</span><span class="p">,</span> <span class="mf">1.6883</span><span class="p">,</span> <span class="mf">1.6717</span><span class="p">,</span> <span class="mf">1.6565</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">124</span><span class="p">,</span> <span class="mf">3.9176</span><span class="p">,</span> <span class="mf">3.0693</span><span class="p">,</span> <span class="mf">2.6777</span><span class="p">,</span> <span class="mf">2.4448</span><span class="p">,</span> <span class="mf">2.2874</span><span class="p">,</span> <span class="mf">2.1725</span><span class="p">,</span> <span class="mf">2.0842</span><span class="p">,</span> <span class="mf">2.0139</span><span class="p">,</span> <span class="mf">1.9562</span><span class="p">,</span> <span class="mf">1.9078</span><span class="p">,</span>
                       <span class="mf">1.8667</span><span class="p">,</span> <span class="mf">1.831</span><span class="p">,</span> <span class="mf">1.7999</span><span class="p">,</span> <span class="mf">1.7723</span><span class="p">,</span> <span class="mf">1.7478</span><span class="p">,</span> <span class="mf">1.7257</span><span class="p">,</span> <span class="mf">1.7058</span><span class="p">,</span> <span class="mf">1.6876</span><span class="p">,</span> <span class="mf">1.6711</span><span class="p">,</span> <span class="mf">1.6558</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">125</span><span class="p">,</span> <span class="mf">3.9169</span><span class="p">,</span> <span class="mf">3.0687</span><span class="p">,</span> <span class="mf">2.6771</span><span class="p">,</span> <span class="mf">2.4442</span><span class="p">,</span> <span class="mf">2.2868</span><span class="p">,</span> <span class="mf">2.1719</span><span class="p">,</span> <span class="mf">2.0836</span><span class="p">,</span> <span class="mf">2.0133</span><span class="p">,</span> <span class="mf">1.9556</span><span class="p">,</span> <span class="mf">1.9072</span><span class="p">,</span>
                       <span class="mf">1.866</span><span class="p">,</span> <span class="mf">1.8304</span><span class="p">,</span> <span class="mf">1.7992</span><span class="p">,</span> <span class="mf">1.7717</span><span class="p">,</span> <span class="mf">1.7471</span><span class="p">,</span> <span class="mf">1.725</span><span class="p">,</span> <span class="mf">1.7051</span><span class="p">,</span> <span class="mf">1.6869</span><span class="p">,</span> <span class="mf">1.6704</span><span class="p">,</span> <span class="mf">1.6551</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">126</span><span class="p">,</span> <span class="mf">3.9163</span><span class="p">,</span> <span class="mf">3.0681</span><span class="p">,</span> <span class="mf">2.6765</span><span class="p">,</span> <span class="mf">2.4436</span><span class="p">,</span> <span class="mf">2.2862</span><span class="p">,</span> <span class="mf">2.1713</span><span class="p">,</span> <span class="mf">2.083</span><span class="p">,</span> <span class="mf">2.0126</span><span class="p">,</span> <span class="mf">1.955</span><span class="p">,</span> <span class="mf">1.9066</span><span class="p">,</span>
                       <span class="mf">1.8654</span><span class="p">,</span> <span class="mf">1.8298</span><span class="p">,</span> <span class="mf">1.7986</span><span class="p">,</span> <span class="mf">1.771</span><span class="p">,</span> <span class="mf">1.7464</span><span class="p">,</span> <span class="mf">1.7244</span><span class="p">,</span> <span class="mf">1.7044</span><span class="p">,</span> <span class="mf">1.6863</span><span class="p">,</span> <span class="mf">1.6697</span><span class="p">,</span> <span class="mf">1.6544</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">127</span><span class="p">,</span> <span class="mf">3.9157</span><span class="p">,</span> <span class="mf">3.0675</span><span class="p">,</span> <span class="mf">2.6759</span><span class="p">,</span> <span class="mf">2.443</span><span class="p">,</span> <span class="mf">2.2856</span><span class="p">,</span> <span class="mf">2.1707</span><span class="p">,</span> <span class="mf">2.0824</span><span class="p">,</span> <span class="mf">2.0121</span><span class="p">,</span> <span class="mf">1.9544</span><span class="p">,</span> <span class="mf">1.906</span><span class="p">,</span>
                       <span class="mf">1.8648</span><span class="p">,</span> <span class="mf">1.8291</span><span class="p">,</span> <span class="mf">1.7979</span><span class="p">,</span> <span class="mf">1.7704</span><span class="p">,</span> <span class="mf">1.7458</span><span class="p">,</span> <span class="mf">1.7237</span><span class="p">,</span> <span class="mf">1.7038</span><span class="p">,</span> <span class="mf">1.6856</span><span class="p">,</span> <span class="mf">1.669</span><span class="p">,</span> <span class="mf">1.6538</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">128</span><span class="p">,</span> <span class="mf">3.9151</span><span class="p">,</span> <span class="mf">3.0669</span><span class="p">,</span> <span class="mf">2.6754</span><span class="p">,</span> <span class="mf">2.4424</span><span class="p">,</span> <span class="mf">2.285</span><span class="p">,</span> <span class="mf">2.1701</span><span class="p">,</span> <span class="mf">2.0819</span><span class="p">,</span> <span class="mf">2.0115</span><span class="p">,</span> <span class="mf">1.9538</span><span class="p">,</span> <span class="mf">1.9054</span><span class="p">,</span>
                       <span class="mf">1.8642</span><span class="p">,</span> <span class="mf">1.8285</span><span class="p">,</span> <span class="mf">1.7974</span><span class="p">,</span> <span class="mf">1.7698</span><span class="p">,</span> <span class="mf">1.7452</span><span class="p">,</span> <span class="mf">1.7231</span><span class="p">,</span> <span class="mf">1.7031</span><span class="p">,</span> <span class="mf">1.685</span><span class="p">,</span> <span class="mf">1.6684</span><span class="p">,</span> <span class="mf">1.6531</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">129</span><span class="p">,</span> <span class="mf">3.9145</span><span class="p">,</span> <span class="mf">3.0664</span><span class="p">,</span> <span class="mf">2.6749</span><span class="p">,</span> <span class="mf">2.4419</span><span class="p">,</span> <span class="mf">2.2845</span><span class="p">,</span> <span class="mf">2.1696</span><span class="p">,</span> <span class="mf">2.0813</span><span class="p">,</span> <span class="mf">2.0109</span><span class="p">,</span> <span class="mf">1.9532</span><span class="p">,</span> <span class="mf">1.9048</span><span class="p">,</span>
                       <span class="mf">1.8636</span><span class="p">,</span> <span class="mf">1.828</span><span class="p">,</span> <span class="mf">1.7967</span><span class="p">,</span> <span class="mf">1.7692</span><span class="p">,</span> <span class="mf">1.7446</span><span class="p">,</span> <span class="mf">1.7225</span><span class="p">,</span> <span class="mf">1.7025</span><span class="p">,</span> <span class="mf">1.6843</span><span class="p">,</span> <span class="mf">1.6677</span><span class="p">,</span> <span class="mf">1.6525</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">130</span><span class="p">,</span> <span class="mf">3.914</span><span class="p">,</span> <span class="mf">3.0659</span><span class="p">,</span> <span class="mf">2.6743</span><span class="p">,</span> <span class="mf">2.4414</span><span class="p">,</span> <span class="mf">2.2839</span><span class="p">,</span> <span class="mf">2.169</span><span class="p">,</span> <span class="mf">2.0807</span><span class="p">,</span> <span class="mf">2.0103</span><span class="p">,</span> <span class="mf">1.9526</span><span class="p">,</span> <span class="mf">1.9042</span><span class="p">,</span>
                       <span class="mf">1.863</span><span class="p">,</span> <span class="mf">1.8273</span><span class="p">,</span> <span class="mf">1.7962</span><span class="p">,</span> <span class="mf">1.7685</span><span class="p">,</span> <span class="mf">1.744</span><span class="p">,</span> <span class="mf">1.7219</span><span class="p">,</span> <span class="mf">1.7019</span><span class="p">,</span> <span class="mf">1.6837</span><span class="p">,</span> <span class="mf">1.6671</span><span class="p">,</span> <span class="mf">1.6519</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">131</span><span class="p">,</span> <span class="mf">3.9134</span><span class="p">,</span> <span class="mf">3.0653</span><span class="p">,</span> <span class="mf">2.6737</span><span class="p">,</span> <span class="mf">2.4408</span><span class="p">,</span> <span class="mf">2.2834</span><span class="p">,</span> <span class="mf">2.1685</span><span class="p">,</span> <span class="mf">2.0802</span><span class="p">,</span> <span class="mf">2.0098</span><span class="p">,</span> <span class="mf">1.9521</span><span class="p">,</span> <span class="mf">1.9037</span><span class="p">,</span>
                       <span class="mf">1.8624</span><span class="p">,</span> <span class="mf">1.8268</span><span class="p">,</span> <span class="mf">1.7956</span><span class="p">,</span> <span class="mf">1.768</span><span class="p">,</span> <span class="mf">1.7434</span><span class="p">,</span> <span class="mf">1.7213</span><span class="p">,</span> <span class="mf">1.7013</span><span class="p">,</span> <span class="mf">1.6831</span><span class="p">,</span> <span class="mf">1.6665</span><span class="p">,</span> <span class="mf">1.6513</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">132</span><span class="p">,</span> <span class="mf">3.9129</span><span class="p">,</span> <span class="mf">3.0648</span><span class="p">,</span> <span class="mf">2.6732</span><span class="p">,</span> <span class="mf">2.4403</span><span class="p">,</span> <span class="mf">2.2829</span><span class="p">,</span> <span class="mf">2.168</span><span class="p">,</span> <span class="mf">2.0796</span><span class="p">,</span> <span class="mf">2.0092</span><span class="p">,</span> <span class="mf">1.9515</span><span class="p">,</span> <span class="mf">1.9031</span><span class="p">,</span>
                       <span class="mf">1.8619</span><span class="p">,</span> <span class="mf">1.8262</span><span class="p">,</span> <span class="mf">1.795</span><span class="p">,</span> <span class="mf">1.7674</span><span class="p">,</span> <span class="mf">1.7428</span><span class="p">,</span> <span class="mf">1.7207</span><span class="p">,</span> <span class="mf">1.7007</span><span class="p">,</span> <span class="mf">1.6825</span><span class="p">,</span> <span class="mf">1.6659</span><span class="p">,</span> <span class="mf">1.6506</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">133</span><span class="p">,</span> <span class="mf">3.9123</span><span class="p">,</span> <span class="mf">3.0642</span><span class="p">,</span> <span class="mf">2.6727</span><span class="p">,</span> <span class="mf">2.4398</span><span class="p">,</span> <span class="mf">2.2823</span><span class="p">,</span> <span class="mf">2.1674</span><span class="p">,</span> <span class="mf">2.0791</span><span class="p">,</span> <span class="mf">2.0087</span><span class="p">,</span> <span class="mf">1.951</span><span class="p">,</span> <span class="mf">1.9026</span><span class="p">,</span>
                       <span class="mf">1.8613</span><span class="p">,</span> <span class="mf">1.8256</span><span class="p">,</span> <span class="mf">1.7944</span><span class="p">,</span> <span class="mf">1.7668</span><span class="p">,</span> <span class="mf">1.7422</span><span class="p">,</span> <span class="mf">1.7201</span><span class="p">,</span> <span class="mf">1.7001</span><span class="p">,</span> <span class="mf">1.6819</span><span class="p">,</span> <span class="mf">1.6653</span><span class="p">,</span> <span class="mf">1.65</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">134</span><span class="p">,</span> <span class="mf">3.9118</span><span class="p">,</span> <span class="mf">3.0637</span><span class="p">,</span> <span class="mf">2.6722</span><span class="p">,</span> <span class="mf">2.4392</span><span class="p">,</span> <span class="mf">2.2818</span><span class="p">,</span> <span class="mf">2.1669</span><span class="p">,</span> <span class="mf">2.0786</span><span class="p">,</span> <span class="mf">2.0082</span><span class="p">,</span> <span class="mf">1.9504</span><span class="p">,</span> <span class="mf">1.902</span><span class="p">,</span>
                       <span class="mf">1.8608</span><span class="p">,</span> <span class="mf">1.8251</span><span class="p">,</span> <span class="mf">1.7939</span><span class="p">,</span> <span class="mf">1.7662</span><span class="p">,</span> <span class="mf">1.7416</span><span class="p">,</span> <span class="mf">1.7195</span><span class="p">,</span> <span class="mf">1.6995</span><span class="p">,</span> <span class="mf">1.6813</span><span class="p">,</span> <span class="mf">1.6647</span><span class="p">,</span> <span class="mf">1.6494</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">135</span><span class="p">,</span> <span class="mf">3.9112</span><span class="p">,</span> <span class="mf">3.0632</span><span class="p">,</span> <span class="mf">2.6717</span><span class="p">,</span> <span class="mf">2.4387</span><span class="p">,</span> <span class="mf">2.2813</span><span class="p">,</span> <span class="mf">2.1664</span><span class="p">,</span> <span class="mf">2.0781</span><span class="p">,</span> <span class="mf">2.0076</span><span class="p">,</span> <span class="mf">1.9499</span><span class="p">,</span> <span class="mf">1.9015</span><span class="p">,</span>
                       <span class="mf">1.8602</span><span class="p">,</span> <span class="mf">1.8245</span><span class="p">,</span> <span class="mf">1.7933</span><span class="p">,</span> <span class="mf">1.7657</span><span class="p">,</span> <span class="mf">1.7411</span><span class="p">,</span> <span class="mf">1.719</span><span class="p">,</span> <span class="mf">1.6989</span><span class="p">,</span> <span class="mf">1.6808</span><span class="p">,</span> <span class="mf">1.6641</span><span class="p">,</span> <span class="mf">1.6488</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">136</span><span class="p">,</span> <span class="mf">3.9108</span><span class="p">,</span> <span class="mf">3.0627</span><span class="p">,</span> <span class="mf">2.6712</span><span class="p">,</span> <span class="mf">2.4382</span><span class="p">,</span> <span class="mf">2.2808</span><span class="p">,</span> <span class="mf">2.1659</span><span class="p">,</span> <span class="mf">2.0775</span><span class="p">,</span> <span class="mf">2.0071</span><span class="p">,</span> <span class="mf">1.9494</span><span class="p">,</span> <span class="mf">1.901</span><span class="p">,</span>
                       <span class="mf">1.8597</span><span class="p">,</span> <span class="mf">1.824</span><span class="p">,</span> <span class="mf">1.7928</span><span class="p">,</span> <span class="mf">1.7651</span><span class="p">,</span> <span class="mf">1.7405</span><span class="p">,</span> <span class="mf">1.7184</span><span class="p">,</span> <span class="mf">1.6984</span><span class="p">,</span> <span class="mf">1.6802</span><span class="p">,</span> <span class="mf">1.6635</span><span class="p">,</span> <span class="mf">1.6483</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">137</span><span class="p">,</span> <span class="mf">3.9102</span><span class="p">,</span> <span class="mf">3.0622</span><span class="p">,</span> <span class="mf">2.6707</span><span class="p">,</span> <span class="mf">2.4378</span><span class="p">,</span> <span class="mf">2.2803</span><span class="p">,</span> <span class="mf">2.1654</span><span class="p">,</span> <span class="mf">2.077</span><span class="p">,</span> <span class="mf">2.0066</span><span class="p">,</span> <span class="mf">1.9488</span><span class="p">,</span> <span class="mf">1.9004</span><span class="p">,</span>
                       <span class="mf">1.8592</span><span class="p">,</span> <span class="mf">1.8235</span><span class="p">,</span> <span class="mf">1.7922</span><span class="p">,</span> <span class="mf">1.7646</span><span class="p">,</span> <span class="mf">1.74</span><span class="p">,</span> <span class="mf">1.7178</span><span class="p">,</span> <span class="mf">1.6978</span><span class="p">,</span> <span class="mf">1.6796</span><span class="p">,</span> <span class="mf">1.663</span><span class="p">,</span> <span class="mf">1.6477</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">138</span><span class="p">,</span> <span class="mf">3.9098</span><span class="p">,</span> <span class="mf">3.0617</span><span class="p">,</span> <span class="mf">2.6702</span><span class="p">,</span> <span class="mf">2.4373</span><span class="p">,</span> <span class="mf">2.2798</span><span class="p">,</span> <span class="mf">2.1649</span><span class="p">,</span> <span class="mf">2.0766</span><span class="p">,</span> <span class="mf">2.0061</span><span class="p">,</span> <span class="mf">1.9483</span><span class="p">,</span> <span class="mf">1.8999</span><span class="p">,</span>
                       <span class="mf">1.8586</span><span class="p">,</span> <span class="mf">1.823</span><span class="p">,</span> <span class="mf">1.7917</span><span class="p">,</span> <span class="mf">1.7641</span><span class="p">,</span> <span class="mf">1.7394</span><span class="p">,</span> <span class="mf">1.7173</span><span class="p">,</span> <span class="mf">1.6973</span><span class="p">,</span> <span class="mf">1.6791</span><span class="p">,</span> <span class="mf">1.6624</span><span class="p">,</span> <span class="mf">1.6471</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">139</span><span class="p">,</span> <span class="mf">3.9092</span><span class="p">,</span> <span class="mf">3.0613</span><span class="p">,</span> <span class="mf">2.6697</span><span class="p">,</span> <span class="mf">2.4368</span><span class="p">,</span> <span class="mf">2.2794</span><span class="p">,</span> <span class="mf">2.1644</span><span class="p">,</span> <span class="mf">2.0761</span><span class="p">,</span> <span class="mf">2.0056</span><span class="p">,</span> <span class="mf">1.9478</span><span class="p">,</span> <span class="mf">1.8994</span><span class="p">,</span>
                       <span class="mf">1.8581</span><span class="p">,</span> <span class="mf">1.8224</span><span class="p">,</span> <span class="mf">1.7912</span><span class="p">,</span> <span class="mf">1.7635</span><span class="p">,</span> <span class="mf">1.7389</span><span class="p">,</span> <span class="mf">1.7168</span><span class="p">,</span> <span class="mf">1.6967</span><span class="p">,</span> <span class="mf">1.6785</span><span class="p">,</span> <span class="mf">1.6619</span><span class="p">,</span> <span class="mf">1.6466</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">140</span><span class="p">,</span> <span class="mf">3.9087</span><span class="p">,</span> <span class="mf">3.0608</span><span class="p">,</span> <span class="mf">2.6692</span><span class="p">,</span> <span class="mf">2.4363</span><span class="p">,</span> <span class="mf">2.2789</span><span class="p">,</span> <span class="mf">2.1639</span><span class="p">,</span> <span class="mf">2.0756</span><span class="p">,</span> <span class="mf">2.0051</span><span class="p">,</span> <span class="mf">1.9473</span><span class="p">,</span> <span class="mf">1.8989</span><span class="p">,</span>
                       <span class="mf">1.8576</span><span class="p">,</span> <span class="mf">1.8219</span><span class="p">,</span> <span class="mf">1.7907</span><span class="p">,</span> <span class="mf">1.763</span><span class="p">,</span> <span class="mf">1.7384</span><span class="p">,</span> <span class="mf">1.7162</span><span class="p">,</span> <span class="mf">1.6962</span><span class="p">,</span> <span class="mf">1.678</span><span class="p">,</span> <span class="mf">1.6613</span><span class="p">,</span> <span class="mf">1.646</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">141</span><span class="p">,</span> <span class="mf">3.9083</span><span class="p">,</span> <span class="mf">3.0603</span><span class="p">,</span> <span class="mf">2.6688</span><span class="p">,</span> <span class="mf">2.4359</span><span class="p">,</span> <span class="mf">2.2784</span><span class="p">,</span> <span class="mf">2.1634</span><span class="p">,</span> <span class="mf">2.0751</span><span class="p">,</span> <span class="mf">2.0046</span><span class="p">,</span> <span class="mf">1.9469</span><span class="p">,</span> <span class="mf">1.8984</span><span class="p">,</span>
                       <span class="mf">1.8571</span><span class="p">,</span> <span class="mf">1.8214</span><span class="p">,</span> <span class="mf">1.7901</span><span class="p">,</span> <span class="mf">1.7625</span><span class="p">,</span> <span class="mf">1.7379</span><span class="p">,</span> <span class="mf">1.7157</span><span class="p">,</span> <span class="mf">1.6957</span><span class="p">,</span> <span class="mf">1.6775</span><span class="p">,</span> <span class="mf">1.6608</span><span class="p">,</span> <span class="mf">1.6455</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">142</span><span class="p">,</span> <span class="mf">3.9078</span><span class="p">,</span> <span class="mf">3.0598</span><span class="p">,</span> <span class="mf">2.6683</span><span class="p">,</span> <span class="mf">2.4354</span><span class="p">,</span> <span class="mf">2.2779</span><span class="p">,</span> <span class="mf">2.163</span><span class="p">,</span> <span class="mf">2.0747</span><span class="p">,</span> <span class="mf">2.0042</span><span class="p">,</span> <span class="mf">1.9464</span><span class="p">,</span> <span class="mf">1.8979</span><span class="p">,</span>
                       <span class="mf">1.8566</span><span class="p">,</span> <span class="mf">1.8209</span><span class="p">,</span> <span class="mf">1.7897</span><span class="p">,</span> <span class="mf">1.762</span><span class="p">,</span> <span class="mf">1.7374</span><span class="p">,</span> <span class="mf">1.7152</span><span class="p">,</span> <span class="mf">1.6952</span><span class="p">,</span> <span class="mf">1.6769</span><span class="p">,</span> <span class="mf">1.6603</span><span class="p">,</span> <span class="mf">1.645</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">143</span><span class="p">,</span> <span class="mf">3.9073</span><span class="p">,</span> <span class="mf">3.0594</span><span class="p">,</span> <span class="mf">2.6679</span><span class="p">,</span> <span class="mf">2.435</span><span class="p">,</span> <span class="mf">2.2775</span><span class="p">,</span> <span class="mf">2.1625</span><span class="p">,</span> <span class="mf">2.0742</span><span class="p">,</span> <span class="mf">2.0037</span><span class="p">,</span> <span class="mf">1.9459</span><span class="p">,</span> <span class="mf">1.8975</span><span class="p">,</span>
                       <span class="mf">1.8562</span><span class="p">,</span> <span class="mf">1.8204</span><span class="p">,</span> <span class="mf">1.7892</span><span class="p">,</span> <span class="mf">1.7615</span><span class="p">,</span> <span class="mf">1.7368</span><span class="p">,</span> <span class="mf">1.7147</span><span class="p">,</span> <span class="mf">1.6946</span><span class="p">,</span> <span class="mf">1.6764</span><span class="p">,</span> <span class="mf">1.6598</span><span class="p">,</span> <span class="mf">1.6444</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">144</span><span class="p">,</span> <span class="mf">3.9068</span><span class="p">,</span> <span class="mf">3.0589</span><span class="p">,</span> <span class="mf">2.6675</span><span class="p">,</span> <span class="mf">2.4345</span><span class="p">,</span> <span class="mf">2.277</span><span class="p">,</span> <span class="mf">2.1621</span><span class="p">,</span> <span class="mf">2.0737</span><span class="p">,</span> <span class="mf">2.0033</span><span class="p">,</span> <span class="mf">1.9455</span><span class="p">,</span> <span class="mf">1.897</span><span class="p">,</span>
                       <span class="mf">1.8557</span><span class="p">,</span> <span class="mf">1.82</span><span class="p">,</span> <span class="mf">1.7887</span><span class="p">,</span> <span class="mf">1.761</span><span class="p">,</span> <span class="mf">1.7364</span><span class="p">,</span> <span class="mf">1.7142</span><span class="p">,</span> <span class="mf">1.6941</span><span class="p">,</span> <span class="mf">1.6759</span><span class="p">,</span> <span class="mf">1.6592</span><span class="p">,</span> <span class="mf">1.6439</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">145</span><span class="p">,</span> <span class="mf">3.9064</span><span class="p">,</span> <span class="mf">3.0585</span><span class="p">,</span> <span class="mf">2.667</span><span class="p">,</span> <span class="mf">2.4341</span><span class="p">,</span> <span class="mf">2.2766</span><span class="p">,</span> <span class="mf">2.1617</span><span class="p">,</span> <span class="mf">2.0733</span><span class="p">,</span> <span class="mf">2.0028</span><span class="p">,</span> <span class="mf">1.945</span><span class="p">,</span> <span class="mf">1.8965</span><span class="p">,</span>
                       <span class="mf">1.8552</span><span class="p">,</span> <span class="mf">1.8195</span><span class="p">,</span> <span class="mf">1.7882</span><span class="p">,</span> <span class="mf">1.7605</span><span class="p">,</span> <span class="mf">1.7359</span><span class="p">,</span> <span class="mf">1.7137</span><span class="p">,</span> <span class="mf">1.6936</span><span class="p">,</span> <span class="mf">1.6754</span><span class="p">,</span> <span class="mf">1.6587</span><span class="p">,</span> <span class="mf">1.6434</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">146</span><span class="p">,</span> <span class="mf">3.906</span><span class="p">,</span> <span class="mf">3.0581</span><span class="p">,</span> <span class="mf">2.6666</span><span class="p">,</span> <span class="mf">2.4337</span><span class="p">,</span> <span class="mf">2.2762</span><span class="p">,</span> <span class="mf">2.1612</span><span class="p">,</span> <span class="mf">2.0728</span><span class="p">,</span> <span class="mf">2.0024</span><span class="p">,</span> <span class="mf">1.9445</span><span class="p">,</span> <span class="mf">1.8961</span><span class="p">,</span>
                       <span class="mf">1.8548</span><span class="p">,</span> <span class="mf">1.819</span><span class="p">,</span> <span class="mf">1.7877</span><span class="p">,</span> <span class="mf">1.7601</span><span class="p">,</span> <span class="mf">1.7354</span><span class="p">,</span> <span class="mf">1.7132</span><span class="p">,</span> <span class="mf">1.6932</span><span class="p">,</span> <span class="mf">1.6749</span><span class="p">,</span> <span class="mf">1.6582</span><span class="p">,</span> <span class="mf">1.6429</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">147</span><span class="p">,</span> <span class="mf">3.9055</span><span class="p">,</span> <span class="mf">3.0576</span><span class="p">,</span> <span class="mf">2.6662</span><span class="p">,</span> <span class="mf">2.4332</span><span class="p">,</span> <span class="mf">2.2758</span><span class="p">,</span> <span class="mf">2.1608</span><span class="p">,</span> <span class="mf">2.0724</span><span class="p">,</span> <span class="mf">2.0019</span><span class="p">,</span> <span class="mf">1.9441</span><span class="p">,</span> <span class="mf">1.8956</span><span class="p">,</span>
                       <span class="mf">1.8543</span><span class="p">,</span> <span class="mf">1.8186</span><span class="p">,</span> <span class="mf">1.7873</span><span class="p">,</span> <span class="mf">1.7596</span><span class="p">,</span> <span class="mf">1.7349</span><span class="p">,</span> <span class="mf">1.7127</span><span class="p">,</span> <span class="mf">1.6927</span><span class="p">,</span> <span class="mf">1.6744</span><span class="p">,</span> <span class="mf">1.6578</span><span class="p">,</span> <span class="mf">1.6424</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">148</span><span class="p">,</span> <span class="mf">3.9051</span><span class="p">,</span> <span class="mf">3.0572</span><span class="p">,</span> <span class="mf">2.6657</span><span class="p">,</span> <span class="mf">2.4328</span><span class="p">,</span> <span class="mf">2.2753</span><span class="p">,</span> <span class="mf">2.1604</span><span class="p">,</span> <span class="mf">2.072</span><span class="p">,</span> <span class="mf">2.0015</span><span class="p">,</span> <span class="mf">1.9437</span><span class="p">,</span> <span class="mf">1.8952</span><span class="p">,</span>
                       <span class="mf">1.8539</span><span class="p">,</span> <span class="mf">1.8181</span><span class="p">,</span> <span class="mf">1.7868</span><span class="p">,</span> <span class="mf">1.7591</span><span class="p">,</span> <span class="mf">1.7344</span><span class="p">,</span> <span class="mf">1.7123</span><span class="p">,</span> <span class="mf">1.6922</span><span class="p">,</span> <span class="mf">1.6739</span><span class="p">,</span> <span class="mf">1.6573</span><span class="p">,</span> <span class="mf">1.6419</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">149</span><span class="p">,</span> <span class="mf">3.9046</span><span class="p">,</span> <span class="mf">3.0568</span><span class="p">,</span> <span class="mf">2.6653</span><span class="p">,</span> <span class="mf">2.4324</span><span class="p">,</span> <span class="mf">2.2749</span><span class="p">,</span> <span class="mf">2.1599</span><span class="p">,</span> <span class="mf">2.0716</span><span class="p">,</span> <span class="mf">2.0011</span><span class="p">,</span> <span class="mf">1.9432</span><span class="p">,</span> <span class="mf">1.8947</span><span class="p">,</span>
                       <span class="mf">1.8534</span><span class="p">,</span> <span class="mf">1.8177</span><span class="p">,</span> <span class="mf">1.7864</span><span class="p">,</span> <span class="mf">1.7587</span><span class="p">,</span> <span class="mf">1.734</span><span class="p">,</span> <span class="mf">1.7118</span><span class="p">,</span> <span class="mf">1.6917</span><span class="p">,</span> <span class="mf">1.6735</span><span class="p">,</span> <span class="mf">1.6568</span><span class="p">,</span> <span class="mf">1.6414</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">150</span><span class="p">,</span> <span class="mf">3.9042</span><span class="p">,</span> <span class="mf">3.0564</span><span class="p">,</span> <span class="mf">2.6649</span><span class="p">,</span> <span class="mf">2.4319</span><span class="p">,</span> <span class="mf">2.2745</span><span class="p">,</span> <span class="mf">2.1595</span><span class="p">,</span> <span class="mf">2.0711</span><span class="p">,</span> <span class="mf">2.0006</span><span class="p">,</span> <span class="mf">1.9428</span><span class="p">,</span> <span class="mf">1.8943</span><span class="p">,</span>
                       <span class="mf">1.853</span><span class="p">,</span> <span class="mf">1.8172</span><span class="p">,</span> <span class="mf">1.7859</span><span class="p">,</span> <span class="mf">1.7582</span><span class="p">,</span> <span class="mf">1.7335</span><span class="p">,</span> <span class="mf">1.7113</span><span class="p">,</span> <span class="mf">1.6913</span><span class="p">,</span> <span class="mf">1.673</span><span class="p">,</span> <span class="mf">1.6563</span><span class="p">,</span> <span class="mf">1.641</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">151</span><span class="p">,</span> <span class="mf">3.9038</span><span class="p">,</span> <span class="mf">3.056</span><span class="p">,</span> <span class="mf">2.6645</span><span class="p">,</span> <span class="mf">2.4315</span><span class="p">,</span> <span class="mf">2.2741</span><span class="p">,</span> <span class="mf">2.1591</span><span class="p">,</span> <span class="mf">2.0707</span><span class="p">,</span> <span class="mf">2.0002</span><span class="p">,</span> <span class="mf">1.9424</span><span class="p">,</span> <span class="mf">1.8939</span><span class="p">,</span>
                       <span class="mf">1.8526</span><span class="p">,</span> <span class="mf">1.8168</span><span class="p">,</span> <span class="mf">1.7855</span><span class="p">,</span> <span class="mf">1.7578</span><span class="p">,</span> <span class="mf">1.7331</span><span class="p">,</span> <span class="mf">1.7109</span><span class="p">,</span> <span class="mf">1.6908</span><span class="p">,</span> <span class="mf">1.6726</span><span class="p">,</span> <span class="mf">1.6558</span><span class="p">,</span> <span class="mf">1.6405</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">152</span><span class="p">,</span> <span class="mf">3.9033</span><span class="p">,</span> <span class="mf">3.0555</span><span class="p">,</span> <span class="mf">2.6641</span><span class="p">,</span> <span class="mf">2.4312</span><span class="p">,</span> <span class="mf">2.2737</span><span class="p">,</span> <span class="mf">2.1587</span><span class="p">,</span> <span class="mf">2.0703</span><span class="p">,</span> <span class="mf">1.9998</span><span class="p">,</span> <span class="mf">1.942</span><span class="p">,</span> <span class="mf">1.8935</span><span class="p">,</span>
                       <span class="mf">1.8521</span><span class="p">,</span> <span class="mf">1.8163</span><span class="p">,</span> <span class="mf">1.785</span><span class="p">,</span> <span class="mf">1.7573</span><span class="p">,</span> <span class="mf">1.7326</span><span class="p">,</span> <span class="mf">1.7104</span><span class="p">,</span> <span class="mf">1.6904</span><span class="p">,</span> <span class="mf">1.6721</span><span class="p">,</span> <span class="mf">1.6554</span><span class="p">,</span> <span class="mf">1.64</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">153</span><span class="p">,</span> <span class="mf">3.903</span><span class="p">,</span> <span class="mf">3.0552</span><span class="p">,</span> <span class="mf">2.6637</span><span class="p">,</span> <span class="mf">2.4308</span><span class="p">,</span> <span class="mf">2.2733</span><span class="p">,</span> <span class="mf">2.1583</span><span class="p">,</span> <span class="mf">2.0699</span><span class="p">,</span> <span class="mf">1.9994</span><span class="p">,</span> <span class="mf">1.9416</span><span class="p">,</span> <span class="mf">1.8931</span><span class="p">,</span>
                       <span class="mf">1.8517</span><span class="p">,</span> <span class="mf">1.8159</span><span class="p">,</span> <span class="mf">1.7846</span><span class="p">,</span> <span class="mf">1.7569</span><span class="p">,</span> <span class="mf">1.7322</span><span class="p">,</span> <span class="mf">1.71</span><span class="p">,</span> <span class="mf">1.6899</span><span class="p">,</span> <span class="mf">1.6717</span><span class="p">,</span> <span class="mf">1.6549</span><span class="p">,</span> <span class="mf">1.6396</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">154</span><span class="p">,</span> <span class="mf">3.9026</span><span class="p">,</span> <span class="mf">3.0548</span><span class="p">,</span> <span class="mf">2.6634</span><span class="p">,</span> <span class="mf">2.4304</span><span class="p">,</span> <span class="mf">2.2729</span><span class="p">,</span> <span class="mf">2.1579</span><span class="p">,</span> <span class="mf">2.0695</span><span class="p">,</span> <span class="mf">1.999</span><span class="p">,</span> <span class="mf">1.9412</span><span class="p">,</span> <span class="mf">1.8926</span><span class="p">,</span>
                       <span class="mf">1.8513</span><span class="p">,</span> <span class="mf">1.8155</span><span class="p">,</span> <span class="mf">1.7842</span><span class="p">,</span> <span class="mf">1.7565</span><span class="p">,</span> <span class="mf">1.7318</span><span class="p">,</span> <span class="mf">1.7096</span><span class="p">,</span> <span class="mf">1.6895</span><span class="p">,</span> <span class="mf">1.6712</span><span class="p">,</span> <span class="mf">1.6545</span><span class="p">,</span> <span class="mf">1.6391</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">155</span><span class="p">,</span> <span class="mf">3.9021</span><span class="p">,</span> <span class="mf">3.0544</span><span class="p">,</span> <span class="mf">2.6629</span><span class="p">,</span> <span class="mf">2.43</span><span class="p">,</span> <span class="mf">2.2725</span><span class="p">,</span> <span class="mf">2.1575</span><span class="p">,</span> <span class="mf">2.0691</span><span class="p">,</span> <span class="mf">1.9986</span><span class="p">,</span> <span class="mf">1.9407</span><span class="p">,</span> <span class="mf">1.8923</span><span class="p">,</span>
                       <span class="mf">1.8509</span><span class="p">,</span> <span class="mf">1.8151</span><span class="p">,</span> <span class="mf">1.7838</span><span class="p">,</span> <span class="mf">1.7561</span><span class="p">,</span> <span class="mf">1.7314</span><span class="p">,</span> <span class="mf">1.7091</span><span class="p">,</span> <span class="mf">1.6891</span><span class="p">,</span> <span class="mf">1.6708</span><span class="p">,</span> <span class="mf">1.654</span><span class="p">,</span> <span class="mf">1.6387</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">156</span><span class="p">,</span> <span class="mf">3.9018</span><span class="p">,</span> <span class="mf">3.054</span><span class="p">,</span> <span class="mf">2.6626</span><span class="p">,</span> <span class="mf">2.4296</span><span class="p">,</span> <span class="mf">2.2722</span><span class="p">,</span> <span class="mf">2.1571</span><span class="p">,</span> <span class="mf">2.0687</span><span class="p">,</span> <span class="mf">1.9982</span><span class="p">,</span> <span class="mf">1.9403</span><span class="p">,</span> <span class="mf">1.8918</span><span class="p">,</span>
                       <span class="mf">1.8505</span><span class="p">,</span> <span class="mf">1.8147</span><span class="p">,</span> <span class="mf">1.7834</span><span class="p">,</span> <span class="mf">1.7557</span><span class="p">,</span> <span class="mf">1.7309</span><span class="p">,</span> <span class="mf">1.7087</span><span class="p">,</span> <span class="mf">1.6886</span><span class="p">,</span> <span class="mf">1.6703</span><span class="p">,</span> <span class="mf">1.6536</span><span class="p">,</span> <span class="mf">1.6383</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">157</span><span class="p">,</span> <span class="mf">3.9014</span><span class="p">,</span> <span class="mf">3.0537</span><span class="p">,</span> <span class="mf">2.6622</span><span class="p">,</span> <span class="mf">2.4293</span><span class="p">,</span> <span class="mf">2.2717</span><span class="p">,</span> <span class="mf">2.1568</span><span class="p">,</span> <span class="mf">2.0684</span><span class="p">,</span> <span class="mf">1.9978</span><span class="p">,</span> <span class="mf">1.94</span><span class="p">,</span> <span class="mf">1.8915</span><span class="p">,</span>
                       <span class="mf">1.8501</span><span class="p">,</span> <span class="mf">1.8143</span><span class="p">,</span> <span class="mf">1.7829</span><span class="p">,</span> <span class="mf">1.7552</span><span class="p">,</span> <span class="mf">1.7305</span><span class="p">,</span> <span class="mf">1.7083</span><span class="p">,</span> <span class="mf">1.6882</span><span class="p">,</span> <span class="mf">1.6699</span><span class="p">,</span> <span class="mf">1.6532</span><span class="p">,</span> <span class="mf">1.6378</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">158</span><span class="p">,</span> <span class="mf">3.901</span><span class="p">,</span> <span class="mf">3.0533</span><span class="p">,</span> <span class="mf">2.6618</span><span class="p">,</span> <span class="mf">2.4289</span><span class="p">,</span> <span class="mf">2.2714</span><span class="p">,</span> <span class="mf">2.1564</span><span class="p">,</span> <span class="mf">2.068</span><span class="p">,</span> <span class="mf">1.9974</span><span class="p">,</span> <span class="mf">1.9396</span><span class="p">,</span> <span class="mf">1.8911</span><span class="p">,</span>
                       <span class="mf">1.8497</span><span class="p">,</span> <span class="mf">1.8139</span><span class="p">,</span> <span class="mf">1.7826</span><span class="p">,</span> <span class="mf">1.7548</span><span class="p">,</span> <span class="mf">1.7301</span><span class="p">,</span> <span class="mf">1.7079</span><span class="p">,</span> <span class="mf">1.6878</span><span class="p">,</span> <span class="mf">1.6695</span><span class="p">,</span> <span class="mf">1.6528</span><span class="p">,</span> <span class="mf">1.6374</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">159</span><span class="p">,</span> <span class="mf">3.9006</span><span class="p">,</span> <span class="mf">3.0529</span><span class="p">,</span> <span class="mf">2.6615</span><span class="p">,</span> <span class="mf">2.4285</span><span class="p">,</span> <span class="mf">2.271</span><span class="p">,</span> <span class="mf">2.156</span><span class="p">,</span> <span class="mf">2.0676</span><span class="p">,</span> <span class="mf">1.997</span><span class="p">,</span> <span class="mf">1.9392</span><span class="p">,</span> <span class="mf">1.8907</span><span class="p">,</span>
                       <span class="mf">1.8493</span><span class="p">,</span> <span class="mf">1.8135</span><span class="p">,</span> <span class="mf">1.7822</span><span class="p">,</span> <span class="mf">1.7544</span><span class="p">,</span> <span class="mf">1.7297</span><span class="p">,</span> <span class="mf">1.7075</span><span class="p">,</span> <span class="mf">1.6874</span><span class="p">,</span> <span class="mf">1.6691</span><span class="p">,</span> <span class="mf">1.6524</span><span class="p">,</span> <span class="mf">1.637</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">160</span><span class="p">,</span> <span class="mf">3.9002</span><span class="p">,</span> <span class="mf">3.0525</span><span class="p">,</span> <span class="mf">2.6611</span><span class="p">,</span> <span class="mf">2.4282</span><span class="p">,</span> <span class="mf">2.2706</span><span class="p">,</span> <span class="mf">2.1556</span><span class="p">,</span> <span class="mf">2.0672</span><span class="p">,</span> <span class="mf">1.9967</span><span class="p">,</span> <span class="mf">1.9388</span><span class="p">,</span> <span class="mf">1.8903</span><span class="p">,</span>
                       <span class="mf">1.8489</span><span class="p">,</span> <span class="mf">1.8131</span><span class="p">,</span> <span class="mf">1.7818</span><span class="p">,</span> <span class="mf">1.754</span><span class="p">,</span> <span class="mf">1.7293</span><span class="p">,</span> <span class="mf">1.7071</span><span class="p">,</span> <span class="mf">1.687</span><span class="p">,</span> <span class="mf">1.6687</span><span class="p">,</span> <span class="mf">1.6519</span><span class="p">,</span> <span class="mf">1.6366</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">161</span><span class="p">,</span> <span class="mf">3.8998</span><span class="p">,</span> <span class="mf">3.0522</span><span class="p">,</span> <span class="mf">2.6607</span><span class="p">,</span> <span class="mf">2.4278</span><span class="p">,</span> <span class="mf">2.2703</span><span class="p">,</span> <span class="mf">2.1553</span><span class="p">,</span> <span class="mf">2.0669</span><span class="p">,</span> <span class="mf">1.9963</span><span class="p">,</span> <span class="mf">1.9385</span><span class="p">,</span> <span class="mf">1.8899</span><span class="p">,</span>
                       <span class="mf">1.8485</span><span class="p">,</span> <span class="mf">1.8127</span><span class="p">,</span> <span class="mf">1.7814</span><span class="p">,</span> <span class="mf">1.7537</span><span class="p">,</span> <span class="mf">1.7289</span><span class="p">,</span> <span class="mf">1.7067</span><span class="p">,</span> <span class="mf">1.6866</span><span class="p">,</span> <span class="mf">1.6683</span><span class="p">,</span> <span class="mf">1.6515</span><span class="p">,</span> <span class="mf">1.6361</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">162</span><span class="p">,</span> <span class="mf">3.8995</span><span class="p">,</span> <span class="mf">3.0518</span><span class="p">,</span> <span class="mf">2.6604</span><span class="p">,</span> <span class="mf">2.4275</span><span class="p">,</span> <span class="mf">2.27</span><span class="p">,</span> <span class="mf">2.155</span><span class="p">,</span> <span class="mf">2.0665</span><span class="p">,</span> <span class="mf">1.9959</span><span class="p">,</span> <span class="mf">1.9381</span><span class="p">,</span> <span class="mf">1.8895</span><span class="p">,</span>
                       <span class="mf">1.8482</span><span class="p">,</span> <span class="mf">1.8124</span><span class="p">,</span> <span class="mf">1.781</span><span class="p">,</span> <span class="mf">1.7533</span><span class="p">,</span> <span class="mf">1.7285</span><span class="p">,</span> <span class="mf">1.7063</span><span class="p">,</span> <span class="mf">1.6862</span><span class="p">,</span> <span class="mf">1.6679</span><span class="p">,</span> <span class="mf">1.6511</span><span class="p">,</span> <span class="mf">1.6357</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">163</span><span class="p">,</span> <span class="mf">3.8991</span><span class="p">,</span> <span class="mf">3.0515</span><span class="p">,</span> <span class="mf">2.6601</span><span class="p">,</span> <span class="mf">2.4271</span><span class="p">,</span> <span class="mf">2.2696</span><span class="p">,</span> <span class="mf">2.1546</span><span class="p">,</span> <span class="mf">2.0662</span><span class="p">,</span> <span class="mf">1.9956</span><span class="p">,</span> <span class="mf">1.9377</span><span class="p">,</span> <span class="mf">1.8892</span><span class="p">,</span>
                       <span class="mf">1.8478</span><span class="p">,</span> <span class="mf">1.812</span><span class="p">,</span> <span class="mf">1.7806</span><span class="p">,</span> <span class="mf">1.7529</span><span class="p">,</span> <span class="mf">1.7282</span><span class="p">,</span> <span class="mf">1.7059</span><span class="p">,</span> <span class="mf">1.6858</span><span class="p">,</span> <span class="mf">1.6675</span><span class="p">,</span> <span class="mf">1.6507</span><span class="p">,</span> <span class="mf">1.6353</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">164</span><span class="p">,</span> <span class="mf">3.8987</span><span class="p">,</span> <span class="mf">3.0512</span><span class="p">,</span> <span class="mf">2.6597</span><span class="p">,</span> <span class="mf">2.4268</span><span class="p">,</span> <span class="mf">2.2693</span><span class="p">,</span> <span class="mf">2.1542</span><span class="p">,</span> <span class="mf">2.0658</span><span class="p">,</span> <span class="mf">1.9953</span><span class="p">,</span> <span class="mf">1.9374</span><span class="p">,</span> <span class="mf">1.8888</span><span class="p">,</span>
                       <span class="mf">1.8474</span><span class="p">,</span> <span class="mf">1.8116</span><span class="p">,</span> <span class="mf">1.7803</span><span class="p">,</span> <span class="mf">1.7525</span><span class="p">,</span> <span class="mf">1.7278</span><span class="p">,</span> <span class="mf">1.7055</span><span class="p">,</span> <span class="mf">1.6854</span><span class="p">,</span> <span class="mf">1.6671</span><span class="p">,</span> <span class="mf">1.6503</span><span class="p">,</span> <span class="mf">1.6349</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">165</span><span class="p">,</span> <span class="mf">3.8985</span><span class="p">,</span> <span class="mf">3.0508</span><span class="p">,</span> <span class="mf">2.6594</span><span class="p">,</span> <span class="mf">2.4264</span><span class="p">,</span> <span class="mf">2.2689</span><span class="p">,</span> <span class="mf">2.1539</span><span class="p">,</span> <span class="mf">2.0655</span><span class="p">,</span> <span class="mf">1.9949</span><span class="p">,</span> <span class="mf">1.937</span><span class="p">,</span> <span class="mf">1.8885</span><span class="p">,</span>
                       <span class="mf">1.8471</span><span class="p">,</span> <span class="mf">1.8112</span><span class="p">,</span> <span class="mf">1.7799</span><span class="p">,</span> <span class="mf">1.7522</span><span class="p">,</span> <span class="mf">1.7274</span><span class="p">,</span> <span class="mf">1.7052</span><span class="p">,</span> <span class="mf">1.685</span><span class="p">,</span> <span class="mf">1.6667</span><span class="p">,</span> <span class="mf">1.6499</span><span class="p">,</span> <span class="mf">1.6345</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">166</span><span class="p">,</span> <span class="mf">3.8981</span><span class="p">,</span> <span class="mf">3.0505</span><span class="p">,</span> <span class="mf">2.6591</span><span class="p">,</span> <span class="mf">2.4261</span><span class="p">,</span> <span class="mf">2.2686</span><span class="p">,</span> <span class="mf">2.1536</span><span class="p">,</span> <span class="mf">2.0651</span><span class="p">,</span> <span class="mf">1.9945</span><span class="p">,</span> <span class="mf">1.9367</span><span class="p">,</span> <span class="mf">1.8881</span><span class="p">,</span>
                       <span class="mf">1.8467</span><span class="p">,</span> <span class="mf">1.8109</span><span class="p">,</span> <span class="mf">1.7795</span><span class="p">,</span> <span class="mf">1.7518</span><span class="p">,</span> <span class="mf">1.727</span><span class="p">,</span> <span class="mf">1.7048</span><span class="p">,</span> <span class="mf">1.6846</span><span class="p">,</span> <span class="mf">1.6663</span><span class="p">,</span> <span class="mf">1.6496</span><span class="p">,</span> <span class="mf">1.6341</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">167</span><span class="p">,</span> <span class="mf">3.8977</span><span class="p">,</span> <span class="mf">3.0502</span><span class="p">,</span> <span class="mf">2.6587</span><span class="p">,</span> <span class="mf">2.4258</span><span class="p">,</span> <span class="mf">2.2683</span><span class="p">,</span> <span class="mf">2.1533</span><span class="p">,</span> <span class="mf">2.0648</span><span class="p">,</span> <span class="mf">1.9942</span><span class="p">,</span> <span class="mf">1.9363</span><span class="p">,</span> <span class="mf">1.8878</span><span class="p">,</span>
                       <span class="mf">1.8464</span><span class="p">,</span> <span class="mf">1.8105</span><span class="p">,</span> <span class="mf">1.7792</span><span class="p">,</span> <span class="mf">1.7514</span><span class="p">,</span> <span class="mf">1.7266</span><span class="p">,</span> <span class="mf">1.7044</span><span class="p">,</span> <span class="mf">1.6843</span><span class="p">,</span> <span class="mf">1.6659</span><span class="p">,</span> <span class="mf">1.6492</span><span class="p">,</span> <span class="mf">1.6338</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">168</span><span class="p">,</span> <span class="mf">3.8974</span><span class="p">,</span> <span class="mf">3.0498</span><span class="p">,</span> <span class="mf">2.6584</span><span class="p">,</span> <span class="mf">2.4254</span><span class="p">,</span> <span class="mf">2.268</span><span class="p">,</span> <span class="mf">2.1529</span><span class="p">,</span> <span class="mf">2.0645</span><span class="p">,</span> <span class="mf">1.9939</span><span class="p">,</span> <span class="mf">1.936</span><span class="p">,</span> <span class="mf">1.8874</span><span class="p">,</span>
                       <span class="mf">1.846</span><span class="p">,</span> <span class="mf">1.8102</span><span class="p">,</span> <span class="mf">1.7788</span><span class="p">,</span> <span class="mf">1.7511</span><span class="p">,</span> <span class="mf">1.7263</span><span class="p">,</span> <span class="mf">1.704</span><span class="p">,</span> <span class="mf">1.6839</span><span class="p">,</span> <span class="mf">1.6656</span><span class="p">,</span> <span class="mf">1.6488</span><span class="p">,</span> <span class="mf">1.6334</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">169</span><span class="p">,</span> <span class="mf">3.8971</span><span class="p">,</span> <span class="mf">3.0495</span><span class="p">,</span> <span class="mf">2.6581</span><span class="p">,</span> <span class="mf">2.4251</span><span class="p">,</span> <span class="mf">2.2676</span><span class="p">,</span> <span class="mf">2.1526</span><span class="p">,</span> <span class="mf">2.0641</span><span class="p">,</span> <span class="mf">1.9936</span><span class="p">,</span> <span class="mf">1.9357</span><span class="p">,</span> <span class="mf">1.8871</span><span class="p">,</span>
                       <span class="mf">1.8457</span><span class="p">,</span> <span class="mf">1.8099</span><span class="p">,</span> <span class="mf">1.7785</span><span class="p">,</span> <span class="mf">1.7507</span><span class="p">,</span> <span class="mf">1.7259</span><span class="p">,</span> <span class="mf">1.7037</span><span class="p">,</span> <span class="mf">1.6835</span><span class="p">,</span> <span class="mf">1.6652</span><span class="p">,</span> <span class="mf">1.6484</span><span class="p">,</span> <span class="mf">1.633</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">170</span><span class="p">,</span> <span class="mf">3.8967</span><span class="p">,</span> <span class="mf">3.0492</span><span class="p">,</span> <span class="mf">2.6578</span><span class="p">,</span> <span class="mf">2.4248</span><span class="p">,</span> <span class="mf">2.2673</span><span class="p">,</span> <span class="mf">2.1523</span><span class="p">,</span> <span class="mf">2.0638</span><span class="p">,</span> <span class="mf">1.9932</span><span class="p">,</span> <span class="mf">1.9353</span><span class="p">,</span> <span class="mf">1.8868</span><span class="p">,</span>
                       <span class="mf">1.8454</span><span class="p">,</span> <span class="mf">1.8095</span><span class="p">,</span> <span class="mf">1.7781</span><span class="p">,</span> <span class="mf">1.7504</span><span class="p">,</span> <span class="mf">1.7256</span><span class="p">,</span> <span class="mf">1.7033</span><span class="p">,</span> <span class="mf">1.6832</span><span class="p">,</span> <span class="mf">1.6648</span><span class="p">,</span> <span class="mf">1.6481</span><span class="p">,</span> <span class="mf">1.6326</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">171</span><span class="p">,</span> <span class="mf">3.8965</span><span class="p">,</span> <span class="mf">3.0488</span><span class="p">,</span> <span class="mf">2.6575</span><span class="p">,</span> <span class="mf">2.4245</span><span class="p">,</span> <span class="mf">2.267</span><span class="p">,</span> <span class="mf">2.152</span><span class="p">,</span> <span class="mf">2.0635</span><span class="p">,</span> <span class="mf">1.9929</span><span class="p">,</span> <span class="mf">1.935</span><span class="p">,</span> <span class="mf">1.8864</span><span class="p">,</span>
                       <span class="mf">1.845</span><span class="p">,</span> <span class="mf">1.8092</span><span class="p">,</span> <span class="mf">1.7778</span><span class="p">,</span> <span class="mf">1.75</span><span class="p">,</span> <span class="mf">1.7252</span><span class="p">,</span> <span class="mf">1.703</span><span class="p">,</span> <span class="mf">1.6828</span><span class="p">,</span> <span class="mf">1.6645</span><span class="p">,</span> <span class="mf">1.6477</span><span class="p">,</span> <span class="mf">1.6323</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">172</span><span class="p">,</span> <span class="mf">3.8961</span><span class="p">,</span> <span class="mf">3.0485</span><span class="p">,</span> <span class="mf">2.6571</span><span class="p">,</span> <span class="mf">2.4242</span><span class="p">,</span> <span class="mf">2.2667</span><span class="p">,</span> <span class="mf">2.1516</span><span class="p">,</span> <span class="mf">2.0632</span><span class="p">,</span> <span class="mf">1.9926</span><span class="p">,</span> <span class="mf">1.9347</span><span class="p">,</span> <span class="mf">1.8861</span><span class="p">,</span>
                       <span class="mf">1.8447</span><span class="p">,</span> <span class="mf">1.8088</span><span class="p">,</span> <span class="mf">1.7774</span><span class="p">,</span> <span class="mf">1.7497</span><span class="p">,</span> <span class="mf">1.7249</span><span class="p">,</span> <span class="mf">1.7026</span><span class="p">,</span> <span class="mf">1.6825</span><span class="p">,</span> <span class="mf">1.6641</span><span class="p">,</span> <span class="mf">1.6473</span><span class="p">,</span> <span class="mf">1.6319</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">173</span><span class="p">,</span> <span class="mf">3.8958</span><span class="p">,</span> <span class="mf">3.0482</span><span class="p">,</span> <span class="mf">2.6568</span><span class="p">,</span> <span class="mf">2.4239</span><span class="p">,</span> <span class="mf">2.2664</span><span class="p">,</span> <span class="mf">2.1513</span><span class="p">,</span> <span class="mf">2.0628</span><span class="p">,</span> <span class="mf">1.9923</span><span class="p">,</span> <span class="mf">1.9343</span><span class="p">,</span> <span class="mf">1.8858</span><span class="p">,</span>
                       <span class="mf">1.8443</span><span class="p">,</span> <span class="mf">1.8085</span><span class="p">,</span> <span class="mf">1.7771</span><span class="p">,</span> <span class="mf">1.7493</span><span class="p">,</span> <span class="mf">1.7246</span><span class="p">,</span> <span class="mf">1.7023</span><span class="p">,</span> <span class="mf">1.6821</span><span class="p">,</span> <span class="mf">1.6638</span><span class="p">,</span> <span class="mf">1.647</span><span class="p">,</span> <span class="mf">1.6316</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">174</span><span class="p">,</span> <span class="mf">3.8954</span><span class="p">,</span> <span class="mf">3.0479</span><span class="p">,</span> <span class="mf">2.6566</span><span class="p">,</span> <span class="mf">2.4236</span><span class="p">,</span> <span class="mf">2.266</span><span class="p">,</span> <span class="mf">2.151</span><span class="p">,</span> <span class="mf">2.0626</span><span class="p">,</span> <span class="mf">1.9919</span><span class="p">,</span> <span class="mf">1.934</span><span class="p">,</span> <span class="mf">1.8855</span><span class="p">,</span>
                       <span class="mf">1.844</span><span class="p">,</span> <span class="mf">1.8082</span><span class="p">,</span> <span class="mf">1.7768</span><span class="p">,</span> <span class="mf">1.749</span><span class="p">,</span> <span class="mf">1.7242</span><span class="p">,</span> <span class="mf">1.7019</span><span class="p">,</span> <span class="mf">1.6818</span><span class="p">,</span> <span class="mf">1.6634</span><span class="p">,</span> <span class="mf">1.6466</span><span class="p">,</span> <span class="mf">1.6312</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">175</span><span class="p">,</span> <span class="mf">3.8952</span><span class="p">,</span> <span class="mf">3.0476</span><span class="p">,</span> <span class="mf">2.6563</span><span class="p">,</span> <span class="mf">2.4233</span><span class="p">,</span> <span class="mf">2.2658</span><span class="p">,</span> <span class="mf">2.1507</span><span class="p">,</span> <span class="mf">2.0622</span><span class="p">,</span> <span class="mf">1.9916</span><span class="p">,</span> <span class="mf">1.9337</span><span class="p">,</span> <span class="mf">1.8852</span><span class="p">,</span>
                       <span class="mf">1.8437</span><span class="p">,</span> <span class="mf">1.8078</span><span class="p">,</span> <span class="mf">1.7764</span><span class="p">,</span> <span class="mf">1.7487</span><span class="p">,</span> <span class="mf">1.7239</span><span class="p">,</span> <span class="mf">1.7016</span><span class="p">,</span> <span class="mf">1.6814</span><span class="p">,</span> <span class="mf">1.6631</span><span class="p">,</span> <span class="mf">1.6463</span><span class="p">,</span> <span class="mf">1.6309</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">176</span><span class="p">,</span> <span class="mf">3.8948</span><span class="p">,</span> <span class="mf">3.0473</span><span class="p">,</span> <span class="mf">2.6559</span><span class="p">,</span> <span class="mf">2.423</span><span class="p">,</span> <span class="mf">2.2655</span><span class="p">,</span> <span class="mf">2.1504</span><span class="p">,</span> <span class="mf">2.0619</span><span class="p">,</span> <span class="mf">1.9913</span><span class="p">,</span> <span class="mf">1.9334</span><span class="p">,</span> <span class="mf">1.8848</span><span class="p">,</span>
                       <span class="mf">1.8434</span><span class="p">,</span> <span class="mf">1.8075</span><span class="p">,</span> <span class="mf">1.7761</span><span class="p">,</span> <span class="mf">1.7483</span><span class="p">,</span> <span class="mf">1.7236</span><span class="p">,</span> <span class="mf">1.7013</span><span class="p">,</span> <span class="mf">1.6811</span><span class="p">,</span> <span class="mf">1.6628</span><span class="p">,</span> <span class="mf">1.646</span><span class="p">,</span> <span class="mf">1.6305</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">177</span><span class="p">,</span> <span class="mf">3.8945</span><span class="p">,</span> <span class="mf">3.047</span><span class="p">,</span> <span class="mf">2.6556</span><span class="p">,</span> <span class="mf">2.4227</span><span class="p">,</span> <span class="mf">2.2652</span><span class="p">,</span> <span class="mf">2.1501</span><span class="p">,</span> <span class="mf">2.0616</span><span class="p">,</span> <span class="mf">1.991</span><span class="p">,</span> <span class="mf">1.9331</span><span class="p">,</span> <span class="mf">1.8845</span><span class="p">,</span>
                       <span class="mf">1.8431</span><span class="p">,</span> <span class="mf">1.8072</span><span class="p">,</span> <span class="mf">1.7758</span><span class="p">,</span> <span class="mf">1.748</span><span class="p">,</span> <span class="mf">1.7232</span><span class="p">,</span> <span class="mf">1.7009</span><span class="p">,</span> <span class="mf">1.6808</span><span class="p">,</span> <span class="mf">1.6624</span><span class="p">,</span> <span class="mf">1.6456</span><span class="p">,</span> <span class="mf">1.6302</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">178</span><span class="p">,</span> <span class="mf">3.8943</span><span class="p">,</span> <span class="mf">3.0467</span><span class="p">,</span> <span class="mf">2.6554</span><span class="p">,</span> <span class="mf">2.4224</span><span class="p">,</span> <span class="mf">2.2649</span><span class="p">,</span> <span class="mf">2.1498</span><span class="p">,</span> <span class="mf">2.0613</span><span class="p">,</span> <span class="mf">1.9907</span><span class="p">,</span> <span class="mf">1.9328</span><span class="p">,</span> <span class="mf">1.8842</span><span class="p">,</span>
                       <span class="mf">1.8428</span><span class="p">,</span> <span class="mf">1.8069</span><span class="p">,</span> <span class="mf">1.7755</span><span class="p">,</span> <span class="mf">1.7477</span><span class="p">,</span> <span class="mf">1.7229</span><span class="p">,</span> <span class="mf">1.7006</span><span class="p">,</span> <span class="mf">1.6805</span><span class="p">,</span> <span class="mf">1.6621</span><span class="p">,</span> <span class="mf">1.6453</span><span class="p">,</span> <span class="mf">1.6298</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">179</span><span class="p">,</span> <span class="mf">3.8939</span><span class="p">,</span> <span class="mf">3.0465</span><span class="p">,</span> <span class="mf">2.6551</span><span class="p">,</span> <span class="mf">2.4221</span><span class="p">,</span> <span class="mf">2.2646</span><span class="p">,</span> <span class="mf">2.1495</span><span class="p">,</span> <span class="mf">2.0611</span><span class="p">,</span> <span class="mf">1.9904</span><span class="p">,</span> <span class="mf">1.9325</span><span class="p">,</span> <span class="mf">1.8839</span><span class="p">,</span>
                       <span class="mf">1.8425</span><span class="p">,</span> <span class="mf">1.8066</span><span class="p">,</span> <span class="mf">1.7752</span><span class="p">,</span> <span class="mf">1.7474</span><span class="p">,</span> <span class="mf">1.7226</span><span class="p">,</span> <span class="mf">1.7003</span><span class="p">,</span> <span class="mf">1.6801</span><span class="p">,</span> <span class="mf">1.6618</span><span class="p">,</span> <span class="mf">1.645</span><span class="p">,</span> <span class="mf">1.6295</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">180</span><span class="p">,</span> <span class="mf">3.8936</span><span class="p">,</span> <span class="mf">3.0462</span><span class="p">,</span> <span class="mf">2.6548</span><span class="p">,</span> <span class="mf">2.4218</span><span class="p">,</span> <span class="mf">2.2643</span><span class="p">,</span> <span class="mf">2.1492</span><span class="p">,</span> <span class="mf">2.0608</span><span class="p">,</span> <span class="mf">1.9901</span><span class="p">,</span> <span class="mf">1.9322</span><span class="p">,</span> <span class="mf">1.8836</span><span class="p">,</span>
                       <span class="mf">1.8422</span><span class="p">,</span> <span class="mf">1.8063</span><span class="p">,</span> <span class="mf">1.7749</span><span class="p">,</span> <span class="mf">1.7471</span><span class="p">,</span> <span class="mf">1.7223</span><span class="p">,</span> <span class="mf">1.7</span><span class="p">,</span> <span class="mf">1.6798</span><span class="p">,</span> <span class="mf">1.6614</span><span class="p">,</span> <span class="mf">1.6446</span><span class="p">,</span> <span class="mf">1.6292</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">181</span><span class="p">,</span> <span class="mf">3.8933</span><span class="p">,</span> <span class="mf">3.0458</span><span class="p">,</span> <span class="mf">2.6545</span><span class="p">,</span> <span class="mf">2.4216</span><span class="p">,</span> <span class="mf">2.264</span><span class="p">,</span> <span class="mf">2.149</span><span class="p">,</span> <span class="mf">2.0605</span><span class="p">,</span> <span class="mf">1.9899</span><span class="p">,</span> <span class="mf">1.9319</span><span class="p">,</span> <span class="mf">1.8833</span><span class="p">,</span>
                       <span class="mf">1.8419</span><span class="p">,</span> <span class="mf">1.806</span><span class="p">,</span> <span class="mf">1.7746</span><span class="p">,</span> <span class="mf">1.7468</span><span class="p">,</span> <span class="mf">1.7219</span><span class="p">,</span> <span class="mf">1.6997</span><span class="p">,</span> <span class="mf">1.6795</span><span class="p">,</span> <span class="mf">1.6611</span><span class="p">,</span> <span class="mf">1.6443</span><span class="p">,</span> <span class="mf">1.6289</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">182</span><span class="p">,</span> <span class="mf">3.8931</span><span class="p">,</span> <span class="mf">3.0456</span><span class="p">,</span> <span class="mf">2.6543</span><span class="p">,</span> <span class="mf">2.4213</span><span class="p">,</span> <span class="mf">2.2638</span><span class="p">,</span> <span class="mf">2.1487</span><span class="p">,</span> <span class="mf">2.0602</span><span class="p">,</span> <span class="mf">1.9896</span><span class="p">,</span> <span class="mf">1.9316</span><span class="p">,</span> <span class="mf">1.883</span><span class="p">,</span>
                       <span class="mf">1.8416</span><span class="p">,</span> <span class="mf">1.8057</span><span class="p">,</span> <span class="mf">1.7743</span><span class="p">,</span> <span class="mf">1.7465</span><span class="p">,</span> <span class="mf">1.7217</span><span class="p">,</span> <span class="mf">1.6994</span><span class="p">,</span> <span class="mf">1.6792</span><span class="p">,</span> <span class="mf">1.6608</span><span class="p">,</span> <span class="mf">1.644</span><span class="p">,</span> <span class="mf">1.6286</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">183</span><span class="p">,</span> <span class="mf">3.8928</span><span class="p">,</span> <span class="mf">3.0453</span><span class="p">,</span> <span class="mf">2.654</span><span class="p">,</span> <span class="mf">2.421</span><span class="p">,</span> <span class="mf">2.2635</span><span class="p">,</span> <span class="mf">2.1484</span><span class="p">,</span> <span class="mf">2.0599</span><span class="p">,</span> <span class="mf">1.9893</span><span class="p">,</span> <span class="mf">1.9313</span><span class="p">,</span> <span class="mf">1.8827</span><span class="p">,</span>
                       <span class="mf">1.8413</span><span class="p">,</span> <span class="mf">1.8054</span><span class="p">,</span> <span class="mf">1.774</span><span class="p">,</span> <span class="mf">1.7462</span><span class="p">,</span> <span class="mf">1.7214</span><span class="p">,</span> <span class="mf">1.6991</span><span class="p">,</span> <span class="mf">1.6789</span><span class="p">,</span> <span class="mf">1.6605</span><span class="p">,</span> <span class="mf">1.6437</span><span class="p">,</span> <span class="mf">1.6282</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">184</span><span class="p">,</span> <span class="mf">3.8925</span><span class="p">,</span> <span class="mf">3.045</span><span class="p">,</span> <span class="mf">2.6537</span><span class="p">,</span> <span class="mf">2.4207</span><span class="p">,</span> <span class="mf">2.2632</span><span class="p">,</span> <span class="mf">2.1481</span><span class="p">,</span> <span class="mf">2.0596</span><span class="p">,</span> <span class="mf">1.989</span><span class="p">,</span> <span class="mf">1.9311</span><span class="p">,</span> <span class="mf">1.8825</span><span class="p">,</span>
                       <span class="mf">1.841</span><span class="p">,</span> <span class="mf">1.8051</span><span class="p">,</span> <span class="mf">1.7737</span><span class="p">,</span> <span class="mf">1.7459</span><span class="p">,</span> <span class="mf">1.721</span><span class="p">,</span> <span class="mf">1.6987</span><span class="p">,</span> <span class="mf">1.6786</span><span class="p">,</span> <span class="mf">1.6602</span><span class="p">,</span> <span class="mf">1.6434</span><span class="p">,</span> <span class="mf">1.6279</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">185</span><span class="p">,</span> <span class="mf">3.8923</span><span class="p">,</span> <span class="mf">3.0448</span><span class="p">,</span> <span class="mf">2.6534</span><span class="p">,</span> <span class="mf">2.4205</span><span class="p">,</span> <span class="mf">2.263</span><span class="p">,</span> <span class="mf">2.1479</span><span class="p">,</span> <span class="mf">2.0594</span><span class="p">,</span> <span class="mf">1.9887</span><span class="p">,</span> <span class="mf">1.9308</span><span class="p">,</span> <span class="mf">1.8822</span><span class="p">,</span>
                       <span class="mf">1.8407</span><span class="p">,</span> <span class="mf">1.8048</span><span class="p">,</span> <span class="mf">1.7734</span><span class="p">,</span> <span class="mf">1.7456</span><span class="p">,</span> <span class="mf">1.7208</span><span class="p">,</span> <span class="mf">1.6984</span><span class="p">,</span> <span class="mf">1.6783</span><span class="p">,</span> <span class="mf">1.6599</span><span class="p">,</span> <span class="mf">1.643</span><span class="p">,</span> <span class="mf">1.6276</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">186</span><span class="p">,</span> <span class="mf">3.892</span><span class="p">,</span> <span class="mf">3.0445</span><span class="p">,</span> <span class="mf">2.6531</span><span class="p">,</span> <span class="mf">2.4202</span><span class="p">,</span> <span class="mf">2.2627</span><span class="p">,</span> <span class="mf">2.1476</span><span class="p">,</span> <span class="mf">2.0591</span><span class="p">,</span> <span class="mf">1.9885</span><span class="p">,</span> <span class="mf">1.9305</span><span class="p">,</span> <span class="mf">1.8819</span><span class="p">,</span>
                       <span class="mf">1.8404</span><span class="p">,</span> <span class="mf">1.8045</span><span class="p">,</span> <span class="mf">1.7731</span><span class="p">,</span> <span class="mf">1.7453</span><span class="p">,</span> <span class="mf">1.7205</span><span class="p">,</span> <span class="mf">1.6981</span><span class="p">,</span> <span class="mf">1.678</span><span class="p">,</span> <span class="mf">1.6596</span><span class="p">,</span> <span class="mf">1.6428</span><span class="p">,</span> <span class="mf">1.6273</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">187</span><span class="p">,</span> <span class="mf">3.8917</span><span class="p">,</span> <span class="mf">3.0442</span><span class="p">,</span> <span class="mf">2.6529</span><span class="p">,</span> <span class="mf">2.4199</span><span class="p">,</span> <span class="mf">2.2624</span><span class="p">,</span> <span class="mf">2.1473</span><span class="p">,</span> <span class="mf">2.0588</span><span class="p">,</span> <span class="mf">1.9882</span><span class="p">,</span> <span class="mf">1.9302</span><span class="p">,</span> <span class="mf">1.8816</span><span class="p">,</span>
                       <span class="mf">1.8401</span><span class="p">,</span> <span class="mf">1.8042</span><span class="p">,</span> <span class="mf">1.7728</span><span class="p">,</span> <span class="mf">1.745</span><span class="p">,</span> <span class="mf">1.7202</span><span class="p">,</span> <span class="mf">1.6979</span><span class="p">,</span> <span class="mf">1.6777</span><span class="p">,</span> <span class="mf">1.6593</span><span class="p">,</span> <span class="mf">1.6424</span><span class="p">,</span> <span class="mf">1.627</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">188</span><span class="p">,</span> <span class="mf">3.8914</span><span class="p">,</span> <span class="mf">3.044</span><span class="p">,</span> <span class="mf">2.6526</span><span class="p">,</span> <span class="mf">2.4197</span><span class="p">,</span> <span class="mf">2.2621</span><span class="p">,</span> <span class="mf">2.1471</span><span class="p">,</span> <span class="mf">2.0586</span><span class="p">,</span> <span class="mf">1.9879</span><span class="p">,</span> <span class="mf">1.9299</span><span class="p">,</span> <span class="mf">1.8814</span><span class="p">,</span>
                       <span class="mf">1.8399</span><span class="p">,</span> <span class="mf">1.804</span><span class="p">,</span> <span class="mf">1.7725</span><span class="p">,</span> <span class="mf">1.7447</span><span class="p">,</span> <span class="mf">1.7199</span><span class="p">,</span> <span class="mf">1.6976</span><span class="p">,</span> <span class="mf">1.6774</span><span class="p">,</span> <span class="mf">1.659</span><span class="p">,</span> <span class="mf">1.6421</span><span class="p">,</span> <span class="mf">1.6267</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">189</span><span class="p">,</span> <span class="mf">3.8912</span><span class="p">,</span> <span class="mf">3.0437</span><span class="p">,</span> <span class="mf">2.6524</span><span class="p">,</span> <span class="mf">2.4195</span><span class="p">,</span> <span class="mf">2.2619</span><span class="p">,</span> <span class="mf">2.1468</span><span class="p">,</span> <span class="mf">2.0583</span><span class="p">,</span> <span class="mf">1.9877</span><span class="p">,</span> <span class="mf">1.9297</span><span class="p">,</span> <span class="mf">1.8811</span><span class="p">,</span>
                       <span class="mf">1.8396</span><span class="p">,</span> <span class="mf">1.8037</span><span class="p">,</span> <span class="mf">1.7722</span><span class="p">,</span> <span class="mf">1.7444</span><span class="p">,</span> <span class="mf">1.7196</span><span class="p">,</span> <span class="mf">1.6973</span><span class="p">,</span> <span class="mf">1.6771</span><span class="p">,</span> <span class="mf">1.6587</span><span class="p">,</span> <span class="mf">1.6418</span><span class="p">,</span> <span class="mf">1.6264</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">190</span><span class="p">,</span> <span class="mf">3.8909</span><span class="p">,</span> <span class="mf">3.0435</span><span class="p">,</span> <span class="mf">2.6521</span><span class="p">,</span> <span class="mf">2.4192</span><span class="p">,</span> <span class="mf">2.2617</span><span class="p">,</span> <span class="mf">2.1466</span><span class="p">,</span> <span class="mf">2.0581</span><span class="p">,</span> <span class="mf">1.9874</span><span class="p">,</span> <span class="mf">1.9294</span><span class="p">,</span> <span class="mf">1.8808</span><span class="p">,</span>
                       <span class="mf">1.8393</span><span class="p">,</span> <span class="mf">1.8034</span><span class="p">,</span> <span class="mf">1.772</span><span class="p">,</span> <span class="mf">1.7441</span><span class="p">,</span> <span class="mf">1.7193</span><span class="p">,</span> <span class="mf">1.697</span><span class="p">,</span> <span class="mf">1.6768</span><span class="p">,</span> <span class="mf">1.6584</span><span class="p">,</span> <span class="mf">1.6416</span><span class="p">,</span> <span class="mf">1.6261</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">191</span><span class="p">,</span> <span class="mf">3.8906</span><span class="p">,</span> <span class="mf">3.0432</span><span class="p">,</span> <span class="mf">2.6519</span><span class="p">,</span> <span class="mf">2.4189</span><span class="p">,</span> <span class="mf">2.2614</span><span class="p">,</span> <span class="mf">2.1463</span><span class="p">,</span> <span class="mf">2.0578</span><span class="p">,</span> <span class="mf">1.9871</span><span class="p">,</span> <span class="mf">1.9292</span><span class="p">,</span> <span class="mf">1.8805</span><span class="p">,</span>
                       <span class="mf">1.8391</span><span class="p">,</span> <span class="mf">1.8032</span><span class="p">,</span> <span class="mf">1.7717</span><span class="p">,</span> <span class="mf">1.7439</span><span class="p">,</span> <span class="mf">1.719</span><span class="p">,</span> <span class="mf">1.6967</span><span class="p">,</span> <span class="mf">1.6765</span><span class="p">,</span> <span class="mf">1.6581</span><span class="p">,</span> <span class="mf">1.6413</span><span class="p">,</span> <span class="mf">1.6258</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">192</span><span class="p">,</span> <span class="mf">3.8903</span><span class="p">,</span> <span class="mf">3.043</span><span class="p">,</span> <span class="mf">2.6516</span><span class="p">,</span> <span class="mf">2.4187</span><span class="p">,</span> <span class="mf">2.2611</span><span class="p">,</span> <span class="mf">2.1461</span><span class="p">,</span> <span class="mf">2.0575</span><span class="p">,</span> <span class="mf">1.9869</span><span class="p">,</span> <span class="mf">1.9289</span><span class="p">,</span> <span class="mf">1.8803</span><span class="p">,</span>
                       <span class="mf">1.8388</span><span class="p">,</span> <span class="mf">1.8029</span><span class="p">,</span> <span class="mf">1.7714</span><span class="p">,</span> <span class="mf">1.7436</span><span class="p">,</span> <span class="mf">1.7188</span><span class="p">,</span> <span class="mf">1.6964</span><span class="p">,</span> <span class="mf">1.6762</span><span class="p">,</span> <span class="mf">1.6578</span><span class="p">,</span> <span class="mf">1.641</span><span class="p">,</span> <span class="mf">1.6255</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">193</span><span class="p">,</span> <span class="mf">3.8901</span><span class="p">,</span> <span class="mf">3.0427</span><span class="p">,</span> <span class="mf">2.6514</span><span class="p">,</span> <span class="mf">2.4184</span><span class="p">,</span> <span class="mf">2.2609</span><span class="p">,</span> <span class="mf">2.1458</span><span class="p">,</span> <span class="mf">2.0573</span><span class="p">,</span> <span class="mf">1.9866</span><span class="p">,</span> <span class="mf">1.9286</span><span class="p">,</span> <span class="mf">1.88</span><span class="p">,</span>
                       <span class="mf">1.8385</span><span class="p">,</span> <span class="mf">1.8026</span><span class="p">,</span> <span class="mf">1.7712</span><span class="p">,</span> <span class="mf">1.7433</span><span class="p">,</span> <span class="mf">1.7185</span><span class="p">,</span> <span class="mf">1.6961</span><span class="p">,</span> <span class="mf">1.6759</span><span class="p">,</span> <span class="mf">1.6575</span><span class="p">,</span> <span class="mf">1.6407</span><span class="p">,</span> <span class="mf">1.6252</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">194</span><span class="p">,</span> <span class="mf">3.8899</span><span class="p">,</span> <span class="mf">3.0425</span><span class="p">,</span> <span class="mf">2.6512</span><span class="p">,</span> <span class="mf">2.4182</span><span class="p">,</span> <span class="mf">2.2606</span><span class="p">,</span> <span class="mf">2.1456</span><span class="p">,</span> <span class="mf">2.057</span><span class="p">,</span> <span class="mf">1.9864</span><span class="p">,</span> <span class="mf">1.9284</span><span class="p">,</span> <span class="mf">1.8798</span><span class="p">,</span>
                       <span class="mf">1.8383</span><span class="p">,</span> <span class="mf">1.8023</span><span class="p">,</span> <span class="mf">1.7709</span><span class="p">,</span> <span class="mf">1.7431</span><span class="p">,</span> <span class="mf">1.7182</span><span class="p">,</span> <span class="mf">1.6959</span><span class="p">,</span> <span class="mf">1.6757</span><span class="p">,</span> <span class="mf">1.6572</span><span class="p">,</span> <span class="mf">1.6404</span><span class="p">,</span> <span class="mf">1.6249</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">195</span><span class="p">,</span> <span class="mf">3.8896</span><span class="p">,</span> <span class="mf">3.0422</span><span class="p">,</span> <span class="mf">2.6509</span><span class="p">,</span> <span class="mf">2.418</span><span class="p">,</span> <span class="mf">2.2604</span><span class="p">,</span> <span class="mf">2.1453</span><span class="p">,</span> <span class="mf">2.0568</span><span class="p">,</span> <span class="mf">1.9861</span><span class="p">,</span> <span class="mf">1.9281</span><span class="p">,</span> <span class="mf">1.8795</span><span class="p">,</span>
                       <span class="mf">1.838</span><span class="p">,</span> <span class="mf">1.8021</span><span class="p">,</span> <span class="mf">1.7706</span><span class="p">,</span> <span class="mf">1.7428</span><span class="p">,</span> <span class="mf">1.7179</span><span class="p">,</span> <span class="mf">1.6956</span><span class="p">,</span> <span class="mf">1.6754</span><span class="p">,</span> <span class="mf">1.657</span><span class="p">,</span> <span class="mf">1.6401</span><span class="p">,</span> <span class="mf">1.6247</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">196</span><span class="p">,</span> <span class="mf">3.8893</span><span class="p">,</span> <span class="mf">3.042</span><span class="p">,</span> <span class="mf">2.6507</span><span class="p">,</span> <span class="mf">2.4177</span><span class="p">,</span> <span class="mf">2.2602</span><span class="p">,</span> <span class="mf">2.1451</span><span class="p">,</span> <span class="mf">2.0566</span><span class="p">,</span> <span class="mf">1.9859</span><span class="p">,</span> <span class="mf">1.9279</span><span class="p">,</span> <span class="mf">1.8793</span><span class="p">,</span>
                       <span class="mf">1.8377</span><span class="p">,</span> <span class="mf">1.8018</span><span class="p">,</span> <span class="mf">1.7704</span><span class="p">,</span> <span class="mf">1.7425</span><span class="p">,</span> <span class="mf">1.7177</span><span class="p">,</span> <span class="mf">1.6953</span><span class="p">,</span> <span class="mf">1.6751</span><span class="p">,</span> <span class="mf">1.6567</span><span class="p">,</span> <span class="mf">1.6399</span><span class="p">,</span> <span class="mf">1.6244</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">197</span><span class="p">,</span> <span class="mf">3.8891</span><span class="p">,</span> <span class="mf">3.0418</span><span class="p">,</span> <span class="mf">2.6504</span><span class="p">,</span> <span class="mf">2.4175</span><span class="p">,</span> <span class="mf">2.26</span><span class="p">,</span> <span class="mf">2.1448</span><span class="p">,</span> <span class="mf">2.0563</span><span class="p">,</span> <span class="mf">1.9856</span><span class="p">,</span> <span class="mf">1.9277</span><span class="p">,</span> <span class="mf">1.879</span><span class="p">,</span>
                       <span class="mf">1.8375</span><span class="p">,</span> <span class="mf">1.8016</span><span class="p">,</span> <span class="mf">1.7701</span><span class="p">,</span> <span class="mf">1.7423</span><span class="p">,</span> <span class="mf">1.7174</span><span class="p">,</span> <span class="mf">1.6951</span><span class="p">,</span> <span class="mf">1.6748</span><span class="p">,</span> <span class="mf">1.6564</span><span class="p">,</span> <span class="mf">1.6396</span><span class="p">,</span> <span class="mf">1.6241</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">198</span><span class="p">,</span> <span class="mf">3.8889</span><span class="p">,</span> <span class="mf">3.0415</span><span class="p">,</span> <span class="mf">2.6502</span><span class="p">,</span> <span class="mf">2.4173</span><span class="p">,</span> <span class="mf">2.2597</span><span class="p">,</span> <span class="mf">2.1446</span><span class="p">,</span> <span class="mf">2.0561</span><span class="p">,</span> <span class="mf">1.9854</span><span class="p">,</span> <span class="mf">1.9274</span><span class="p">,</span> <span class="mf">1.8788</span><span class="p">,</span>
                       <span class="mf">1.8373</span><span class="p">,</span> <span class="mf">1.8013</span><span class="p">,</span> <span class="mf">1.7699</span><span class="p">,</span> <span class="mf">1.742</span><span class="p">,</span> <span class="mf">1.7172</span><span class="p">,</span> <span class="mf">1.6948</span><span class="p">,</span> <span class="mf">1.6746</span><span class="p">,</span> <span class="mf">1.6562</span><span class="p">,</span> <span class="mf">1.6393</span><span class="p">,</span> <span class="mf">1.6238</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">199</span><span class="p">,</span> <span class="mf">3.8886</span><span class="p">,</span> <span class="mf">3.0413</span><span class="p">,</span> <span class="mf">2.65</span><span class="p">,</span> <span class="mf">2.417</span><span class="p">,</span> <span class="mf">2.2595</span><span class="p">,</span> <span class="mf">2.1444</span><span class="p">,</span> <span class="mf">2.0558</span><span class="p">,</span> <span class="mf">1.9852</span><span class="p">,</span> <span class="mf">1.9272</span><span class="p">,</span> <span class="mf">1.8785</span><span class="p">,</span>
                       <span class="mf">1.837</span><span class="p">,</span> <span class="mf">1.8011</span><span class="p">,</span> <span class="mf">1.7696</span><span class="p">,</span> <span class="mf">1.7418</span><span class="p">,</span> <span class="mf">1.7169</span><span class="p">,</span> <span class="mf">1.6946</span><span class="p">,</span> <span class="mf">1.6743</span><span class="p">,</span> <span class="mf">1.6559</span><span class="p">,</span> <span class="mf">1.6391</span><span class="p">,</span> <span class="mf">1.6236</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">200</span><span class="p">,</span> <span class="mf">3.8883</span><span class="p">,</span> <span class="mf">3.041</span><span class="p">,</span> <span class="mf">2.6497</span><span class="p">,</span> <span class="mf">2.4168</span><span class="p">,</span> <span class="mf">2.2592</span><span class="p">,</span> <span class="mf">2.1441</span><span class="p">,</span> <span class="mf">2.0556</span><span class="p">,</span> <span class="mf">1.9849</span><span class="p">,</span> <span class="mf">1.9269</span><span class="p">,</span> <span class="mf">1.8783</span><span class="p">,</span> <span class="mf">1.8368</span><span class="p">,</span> <span class="mf">1.8008</span><span class="p">,</span> <span class="mf">1.7694</span><span class="p">,</span> <span class="mf">1.7415</span><span class="p">,</span> <span class="mf">1.7166</span><span class="p">,</span> <span class="mf">1.6943</span><span class="p">,</span> <span class="mf">1.6741</span><span class="p">,</span> <span class="mf">1.6557</span><span class="p">,</span> <span class="mf">1.6388</span><span class="p">,</span> <span class="mf">1.62</span><span class="p">]])</span>
    <span class="k">return</span> <span class="n">ftest</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">row</span><span class="p">)][</span><span class="nb">int</span><span class="p">(</span><span class="n">col</span><span class="p">)]</span></div>


<div class="viewcode-block" id="tcalc"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.tcalc">[docs]</a><span class="k">def</span> <span class="nf">tcalc</span><span class="p">(</span><span class="n">nf</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    T-table for nf degrees of freedom (95% confidence).</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    nf : degrees of freedom</span>
<span class="sd">    p : either 0.05 or 0.01</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    t value or 0 if given an invalid p value</span>
<span class="sd">    </span>
<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; pmag.tcalc(8,0.05)</span>
<span class="sd">    2.3646</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; pmag.tcalc(8,0.07)</span>
<span class="sd">    0</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; pmag.tcalc(8,0.01)</span>
<span class="sd">    3.4995</span>
<span class="sd">    &quot;&quot;&quot;</span>
<span class="c1">#</span>
    <span class="k">if</span> <span class="n">p</span> <span class="o">==</span> <span class="mf">.05</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">4.3027</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">3.1824</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.7765</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.5706</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">6</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.4469</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">7</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.3646</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">8</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.3060</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">9</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.2622</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.2281</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">11</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.2010</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">12</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.1788</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">13</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.1604</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">14</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.1448</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">15</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.1315</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">16</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.1199</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">17</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.1098</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">18</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.1009</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">19</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.0930</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">20</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.0860</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">21</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.0796</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">22</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.0739</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">23</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.0687</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">24</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.0639</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">25</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.0595</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">26</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.0555</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">27</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.0518</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">28</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.0484</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">29</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.0452</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">30</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.0423</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">31</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.0395</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">32</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.0369</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">33</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.0345</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">34</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.0322</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">35</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.0301</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">36</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.0281</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">37</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.0262</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">38</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.0244</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">39</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.0227</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">40</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.0211</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">41</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.0195</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">42</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.0181</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">43</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.0167</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">44</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.0154</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">45</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.0141</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">46</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.0129</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">47</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.0117</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">48</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.0106</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">49</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.0096</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">50</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.0086</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">51</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.0076</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">52</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.0066</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">53</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.0057</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">54</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.0049</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">55</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.0040</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">56</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.0032</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">57</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.0025</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">58</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.0017</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">59</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.0010</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">60</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.0003</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">61</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">1.9996</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">62</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">1.9990</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">63</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">1.9983</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">64</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">1.9977</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">65</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">1.9971</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">66</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">1.9966</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">67</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">1.9960</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">68</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">1.9955</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">69</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">1.9949</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">70</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">1.9944</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">71</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">1.9939</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">72</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">1.9935</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">73</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">1.9930</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">74</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">1.9925</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">75</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">1.9921</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">76</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">1.9917</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">77</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">1.9913</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">78</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">1.9908</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">79</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">1.9905</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">80</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">1.9901</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">81</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">1.9897</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">82</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">1.9893</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">83</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">1.9890</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">84</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">1.9886</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">85</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">1.9883</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">86</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">1.9879</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">87</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">1.9876</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">88</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">1.9873</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">89</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">1.9870</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">90</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">1.9867</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">91</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">1.9864</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">92</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">1.9861</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">93</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">1.9858</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">94</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">1.9855</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">95</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">1.9852</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">96</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">1.9850</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">97</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">1.9847</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">98</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">1.9845</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">99</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">1.9842</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">1.9840</span>
        <span class="k">return</span> <span class="n">t</span>
<span class="c1">#</span>
    <span class="k">elif</span> <span class="n">p</span> <span class="o">==</span> <span class="mf">.01</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">9.9250</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">5.8408</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">4.6041</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">4.0321</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">6</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">3.7074</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">7</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">3.4995</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">8</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">3.3554</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">9</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">3.2498</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">3.1693</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">11</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">3.1058</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">12</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">3.0545</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">13</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">3.0123</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">14</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.9768</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">15</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.9467</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">16</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.9208</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">17</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.8982</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">18</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.8784</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">19</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.8609</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">20</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.8453</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">21</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.8314</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">22</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.8188</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">23</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.8073</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">24</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.7970</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">25</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.7874</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">26</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.7787</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">27</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.7707</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">28</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.7633</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">29</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.7564</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">30</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.7500</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">31</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.7440</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">32</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.7385</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">33</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.7333</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">34</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.7284</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">35</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.7238</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">36</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.7195</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">37</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.7154</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">38</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.7116</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">39</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.7079</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">40</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.7045</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">41</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.7012</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">42</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.6981</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">43</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.6951</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">44</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.6923</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">45</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.6896</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">46</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.6870</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">47</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.6846</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">48</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.6822</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">49</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.6800</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">50</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.6778</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">51</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.6757</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">52</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.6737</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">53</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.6718</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">54</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.6700</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">55</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.6682</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">56</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.6665</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">57</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.6649</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">58</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.6633</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">59</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.6618</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">60</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.6603</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">61</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.6589</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">62</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.6575</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">63</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.6561</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">64</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.6549</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">65</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.6536</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">66</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.6524</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">67</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.6512</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">68</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.6501</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">69</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.6490</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">70</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.6479</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">71</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.6469</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">72</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.6458</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">73</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.6449</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">74</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.6439</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">75</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.6430</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">76</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.6421</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">77</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.6412</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">78</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.6403</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">79</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.6395</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">80</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.6387</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">81</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.6379</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">82</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.6371</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">83</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.6364</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">84</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.6356</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">85</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.6349</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">86</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.6342</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">87</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.6335</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">88</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.6329</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">89</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.6322</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">90</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.6316</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">91</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.6309</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">92</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.6303</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">93</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.6297</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">94</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.6291</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">95</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.6286</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">96</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.6280</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">97</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.6275</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">98</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.6269</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">99</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.6264</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">2.6259</span>
        <span class="k">return</span> <span class="n">t</span>
        <span class="k">return</span> <span class="n">t</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span></div>
<span class="c1">#</span>


<div class="viewcode-block" id="sbar"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.sbar">[docs]</a><span class="k">def</span> <span class="nf">sbar</span><span class="p">(</span><span class="n">Ss</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate average s,sigma from a list of S&#39;s.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Ss : nested list of lists</span>
<span class="sd">        each list is a six element tensors</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    nf : degrees of freedom</span>
<span class="sd">    sigma : sigma of the list</span>
<span class="sd">    avs : the original list</span>
<span class="sd">    </span>
<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; Ss = [[0.33586472,0.32757074,0.33656454,0.0056526,0.00449771,-0.00036542], [0.33815295,0.32601482,0.33583224,0.00754076,0.00405271,-0.0001627],</span>
<span class="sd">        [0.33806428,0.32925552,0.33268023,0.00480824,-0.00168595,0.0009308], [0.33939844,0.32750368,0.33309788,0.00763409,0.00264978,0.00070303],</span>
<span class="sd">        [0.3348785,0.32816416,0.33695734,0.00574405,0.00278172,-0.00073475], [0.33485019,0.32948497,0.33566481,0.00597801,0.00426423,-0.00040056]]</span>
<span class="sd">    &gt;&gt;&gt; pmag.sbar(Ss)</span>
<span class="sd">    (30,</span>
<span class="sd">     0.0018030794236146297,</span>
<span class="sd">     [0.33686818,</span>
<span class="sd">      0.3279989816666667,</span>
<span class="sd">      0.33513284,</span>
<span class="sd">      0.0062262916666666656,</span>
<span class="sd">      0.002760033333333333,</span>
<span class="sd">      -4.933333333333345e-06])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">Ss</span><span class="p">)</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
        <span class="n">Ss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Ss</span><span class="p">)</span>
    <span class="n">npts</span> <span class="o">=</span> <span class="n">Ss</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">Ss</span> <span class="o">=</span> <span class="n">Ss</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>

    <span class="n">avd</span><span class="p">,</span> <span class="n">avs</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="c1"># D=np.array([Ss[0],Ss[1],Ss[2],Ss[3]+0.5*(Ss[0]+Ss[1]),Ss[4]+0.5*(Ss[1]+Ss[2]),Ss[5]+0.5*(Ss[0]+Ss[2])]).transpose()</span>
    <span class="n">D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">Ss</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Ss</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">Ss</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">Ss</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">Ss</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">Ss</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
                  <span class="n">Ss</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">Ss</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">Ss</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="n">Ss</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">Ss</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">Ss</span><span class="p">[</span><span class="mi">2</span><span class="p">])])</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
        <span class="n">avd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">D</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span>
        <span class="n">avs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">Ss</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span>
    <span class="n">D</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
    <span class="c1"># for s in Ss:</span>
    <span class="c1">#    print &#39;from sbar: &#39;,s</span>
    <span class="c1">#    D.append(s[:]) # append a copy of s</span>
    <span class="c1">#    D[-1][3]=D[-1][3]+0.5*(s[0]+s[1])</span>
    <span class="c1">#    D[-1][4]=D[-1][4]+0.5*(s[1]+s[2])</span>
    <span class="c1">#    D[-1][5]=D[-1][5]+0.5*(s[0]+s[2])</span>
    <span class="c1">#    for j in range(6):</span>
    <span class="c1">#        avd[j]+=(D[-1][j])/float(npts)</span>
    <span class="c1">#        avs[j]+=(s[j])/float(npts)</span>
<span class="c1">#   calculate sigma</span>
    <span class="n">nf</span> <span class="o">=</span> <span class="p">(</span><span class="n">npts</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">6</span>  <span class="c1"># number of degrees of freedom</span>
    <span class="n">s0</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">Dels</span> <span class="o">=</span> <span class="p">(</span><span class="n">D</span> <span class="o">-</span> <span class="n">avd</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">s0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">Dels</span><span class="p">)</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">s0</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">nf</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">nf</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">avs</span></div>


<div class="viewcode-block" id="dohext"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.dohext">[docs]</a><span class="k">def</span> <span class="nf">dohext</span><span class="p">(</span><span class="n">nf</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates hext parameters for nf, sigma and s.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    nf :  number of degrees of freedom (measurements - 6)</span>
<span class="sd">    sigma : the sigma of the measurements</span>
<span class="sd">    s : [x11,x22,x33,x12,x23,x13] - the six tensor elements</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    hpars : dictionary of Hext statistics with keys:</span>
<span class="sd">        &#39;F_crit&#39; : critical value for anisotropy</span>
<span class="sd">        &#39;F12_crit&#39; : critical value for tau1&gt;tau2, tau2&gt;3</span>
<span class="sd">        &#39;F&#39; : value of F</span>
<span class="sd">        &#39;F12&#39; : value of F12</span>
<span class="sd">        &#39;F23&#39; : value of F23</span>
<span class="sd">        &#39;v1_dec&#39;: declination of principal eigenvector</span>
<span class="sd">        &#39;v1_inc&#39;: inclination of principal eigenvector</span>
<span class="sd">        &#39;v2_dec&#39;: declination of major eigenvector</span>
<span class="sd">        &#39;v2_inc&#39;: inclination of major eigenvector</span>
<span class="sd">        &#39;v3_dec&#39;: declination of minor eigenvector</span>
<span class="sd">        &#39;v3_inc&#39;: inclination of minor eigenvector</span>
<span class="sd">        &#39;t1&#39;: principal eigenvalue</span>
<span class="sd">        &#39;t2&#39;: major eigenvalue</span>
<span class="sd">        &#39;t3&#39;: minor eigenvalue</span>
<span class="sd">        &#39;e12&#39;: angle of confidence ellipse of principal eigenvector in direction of major eigenvector</span>
<span class="sd">        &#39;e23&#39;: angle of confidence ellipse of major eigenvector in direction of minor eigenvector</span>
<span class="sd">        &#39;e13&#39;: angle of confidence ellipse of principal eigenvector in direction of minor eigenvector</span>

<span class="sd">    If working with data set with no sigmas and the average is desired, use nf,sigma,avs=pmag.sbar(Ss) as input</span>
<span class="sd">    </span>
<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; pmag.dohext(30, 0.00027464, [0.33586472,0.32757074,0.33656454,0.0056526,0.00449771,-0.00036542])</span>
<span class="sd">    {&#39;F_crit&#39;: &#39;2.5335&#39;,</span>
<span class="sd">     &#39;F12_crit&#39;: &#39;3.3158&#39;,</span>
<span class="sd">     &#39;F&#39;: 820.3194287677485,</span>
<span class="sd">     &#39;F12&#39;: 74.97208429827333,</span>
<span class="sd">     &#39;F23&#39;: 1167.2979118918333,</span>
<span class="sd">     &#39;v1_dec&#39;: 38.360480228001826,</span>
<span class="sd">     &#39;v1_inc&#39;: 36.10621428141474,</span>
<span class="sd">     &#39;v2_dec&#39;: 183.62757676112915,</span>
<span class="sd">     &#39;v2_inc&#39;: 48.41031537341878,</span>
<span class="sd">     &#39;v3_dec&#39;: 294.8243200339332,</span>
<span class="sd">     &#39;v3_inc&#39;: 17.791534673908338,</span>
<span class="sd">     &#39;t1&#39;: 0.33999866,</span>
<span class="sd">     &#39;t2&#39;: 0.33663565,</span>
<span class="sd">     &#39;t3&#39;: 0.3233657,</span>
<span class="sd">     &#39;e12&#39;: 6.002663418693858,</span>
<span class="sd">     &#39;e23&#39;: 1.5264872237415046,</span>
<span class="sd">     &#39;e13&#39;: 1.2179522275647792}</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">hpars</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">hpars</span><span class="p">[</span><span class="s1">&#39;F_crit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span>
    <span class="n">hpars</span><span class="p">[</span><span class="s1">&#39;F12_crit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span>
    <span class="n">hpars</span><span class="p">[</span><span class="s2">&quot;F&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">hpars</span><span class="p">[</span><span class="s2">&quot;F12&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">hpars</span><span class="p">[</span><span class="s2">&quot;F23&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">hpars</span><span class="p">[</span><span class="s2">&quot;v1_dec&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">hpars</span><span class="p">[</span><span class="s2">&quot;v1_inc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">hpars</span><span class="p">[</span><span class="s2">&quot;v2_dec&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">hpars</span><span class="p">[</span><span class="s2">&quot;v2_inc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">hpars</span><span class="p">[</span><span class="s2">&quot;v3_dec&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">hpars</span><span class="p">[</span><span class="s2">&quot;v3_inc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">hpars</span><span class="p">[</span><span class="s2">&quot;t1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">hpars</span><span class="p">[</span><span class="s2">&quot;t2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">hpars</span><span class="p">[</span><span class="s2">&quot;t3&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">hpars</span><span class="p">[</span><span class="s2">&quot;e12&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">hpars</span><span class="p">[</span><span class="s2">&quot;e23&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">hpars</span><span class="p">[</span><span class="s2">&quot;e13&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">if</span> <span class="n">nf</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">sigma</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">hpars</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">2.</span> <span class="o">*</span> <span class="n">fcalc</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">nf</span><span class="p">))</span>
    <span class="n">t2sum</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">tau</span><span class="p">,</span> <span class="n">Vdir</span> <span class="o">=</span> <span class="n">doseigs</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">t2sum</span> <span class="o">+=</span> <span class="n">tau</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">chibar</span> <span class="o">=</span> <span class="n">old_div</span><span class="p">((</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">s</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="mf">3.</span><span class="p">)</span>
    <span class="n">hpars</span><span class="p">[</span><span class="s1">&#39;F_crit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">fcalc</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">nf</span><span class="p">))</span>
    <span class="n">hpars</span><span class="p">[</span><span class="s1">&#39;F12_crit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">fcalc</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">nf</span><span class="p">))</span>
    <span class="n">hpars</span><span class="p">[</span><span class="s2">&quot;F&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.4</span> <span class="o">*</span> <span class="p">(</span><span class="n">t2sum</span> <span class="o">-</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">chibar</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">sigma</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">hpars</span><span class="p">[</span><span class="s2">&quot;F12&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">old_div</span><span class="p">((</span><span class="n">tau</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">tau</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">sigma</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">hpars</span><span class="p">[</span><span class="s2">&quot;F23&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">old_div</span><span class="p">((</span><span class="n">tau</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">tau</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="n">sigma</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">hpars</span><span class="p">[</span><span class="s2">&quot;v1_dec&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Vdir</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">hpars</span><span class="p">[</span><span class="s2">&quot;v1_inc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Vdir</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">hpars</span><span class="p">[</span><span class="s2">&quot;v2_dec&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Vdir</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">hpars</span><span class="p">[</span><span class="s2">&quot;v2_inc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Vdir</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">hpars</span><span class="p">[</span><span class="s2">&quot;v3_dec&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Vdir</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">hpars</span><span class="p">[</span><span class="s2">&quot;v3_inc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Vdir</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">hpars</span><span class="p">[</span><span class="s2">&quot;t1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tau</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">hpars</span><span class="p">[</span><span class="s2">&quot;t2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tau</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">hpars</span><span class="p">[</span><span class="s2">&quot;t3&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tau</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">hpars</span><span class="p">[</span><span class="s2">&quot;e12&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span>
        <span class="n">old_div</span><span class="p">((</span><span class="n">f</span> <span class="o">*</span> <span class="n">sigma</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="nb">abs</span><span class="p">(</span><span class="n">tau</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">tau</span><span class="p">[</span><span class="mi">1</span><span class="p">]))))</span> <span class="o">*</span> <span class="mf">180.</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
    <span class="n">hpars</span><span class="p">[</span><span class="s2">&quot;e23&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span>
        <span class="n">old_div</span><span class="p">((</span><span class="n">f</span> <span class="o">*</span> <span class="n">sigma</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="nb">abs</span><span class="p">(</span><span class="n">tau</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">tau</span><span class="p">[</span><span class="mi">2</span><span class="p">]))))</span> <span class="o">*</span> <span class="mf">180.</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
    <span class="n">hpars</span><span class="p">[</span><span class="s2">&quot;e13&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span>
        <span class="n">old_div</span><span class="p">((</span><span class="n">f</span> <span class="o">*</span> <span class="n">sigma</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="nb">abs</span><span class="p">(</span><span class="n">tau</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">tau</span><span class="p">[</span><span class="mi">2</span><span class="p">]))))</span> <span class="o">*</span> <span class="mf">180.</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
    <span class="k">return</span> <span class="n">hpars</span></div>
<span class="c1">#</span>
<span class="c1">#</span>


<div class="viewcode-block" id="design"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.design">[docs]</a><span class="k">def</span> <span class="nf">design</span><span class="p">(</span><span class="n">npos</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Make a design matrix for an anisotropy experiment. </span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    npos : number of measurement positions.</span>
<span class="sd">        either 15 or 6</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    A : design matrix array for the given number of positions</span>
<span class="sd">    B : suseptibilities array</span>
<span class="sd">    </span>
<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; pmag.design(10)</span>
<span class="sd">    measurement protocol not supported yet </span>

<span class="sd">    &gt;&gt;&gt; pmag.design(15)</span>
<span class="sd">    (array([[ 0.5,  0.5,  0. , -1. ,  0. ,  0. ],</span>
<span class="sd">        [ 0.5,  0.5,  0. ,  1. ,  0. ,  0. ],</span>
<span class="sd">        [ 1. ,  0. ,  0. ,  0. ,  0. ,  0. ],</span>
<span class="sd">        [ 0.5,  0.5,  0. , -1. ,  0. ,  0. ],</span>
<span class="sd">        [ 0.5,  0.5,  0. ,  1. ,  0. ,  0. ],</span>
<span class="sd">        [ 0. ,  0.5,  0.5,  0. , -1. ,  0. ],</span>
<span class="sd">        [ 0. ,  0.5,  0.5,  0. ,  1. ,  0. ],</span>
<span class="sd">        [ 0. ,  1. ,  0. ,  0. ,  0. ,  0. ],</span>
<span class="sd">        [ 0. ,  0.5,  0.5,  0. , -1. ,  0. ],</span>
<span class="sd">        [ 0. ,  0.5,  0.5,  0. ,  1. ,  0. ],</span>
<span class="sd">        [ 0.5,  0. ,  0.5,  0. ,  0. , -1. ],</span>
<span class="sd">        [ 0.5,  0. ,  0.5,  0. ,  0. ,  1. ],</span>
<span class="sd">        [ 0. ,  0. ,  1. ,  0. ,  0. ,  0. ],</span>
<span class="sd">        [ 0.5,  0. ,  0.5,  0. ,  0. , -1. ],</span>
<span class="sd">        [ 0.5,  0. ,  0.5,  0. ,  0. ,  1. ]]),</span>
<span class="sd">     array([[ 0.15,  0.15,  0.4 ,  0.15,  0.15, -0.1 , -0.1 , -0.1 , -0.1 ,</span>
<span class="sd">         -0.1 ,  0.15,  0.15, -0.1 ,  0.15,  0.15],</span>
<span class="sd">        [ 0.15,  0.15, -0.1 ,  0.15,  0.15,  0.15,  0.15,  0.4 ,  0.15,</span>
<span class="sd">          0.15, -0.1 , -0.1 , -0.1 , -0.1 , -0.1 ],</span>
<span class="sd">        [-0.1 , -0.1 , -0.1 , -0.1 , -0.1 ,  0.15,  0.15, -0.1 ,  0.15,</span>
<span class="sd">          0.15,  0.15,  0.15,  0.4 ,  0.15,  0.15],</span>
<span class="sd">        [-0.25,  0.25,  0.  , -0.25,  0.25,  0.  ,  0.  ,  0.  ,  0.  ,</span>
<span class="sd">          0.  ,  0.  ,  0.  ,  0.  ,  0.  ,  0.  ],</span>
<span class="sd">        [ 0.  ,  0.  ,  0.  ,  0.  ,  0.  , -0.25,  0.25,  0.  , -0.25,</span>
<span class="sd">          0.25,  0.  ,  0.  ,  0.  ,  0.  ,  0.  ],</span>
<span class="sd">        [ 0.  ,  0.  ,  0.  ,  0.  ,  0.  ,  0.  ,  0.  ,  0.  ,  0.  ,</span>
<span class="sd">          0.  , -0.25,  0.25,  0.  , -0.25,  0.25]]))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">npos</span> <span class="o">==</span> <span class="mi">15</span><span class="p">:</span>
        <span class="c1">#</span>
        <span class="c1"># rotatable design of Jelinek for kappabridge (see Tauxe, 1998)</span>
        <span class="c1">#</span>
        <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">.5</span><span class="p">,</span> <span class="mf">.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">.5</span><span class="p">,</span> <span class="mf">.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">.0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">.5</span><span class="p">,</span> <span class="mf">.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">.5</span><span class="p">,</span> <span class="mf">.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">.5</span><span class="p">,</span> <span class="mf">.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">.5</span><span class="p">,</span> <span class="mf">.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">.5</span><span class="p">,</span> <span class="mf">.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">.5</span><span class="p">,</span> <span class="mf">.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]])</span>  <span class="c1"># design matrix for 15 measurement positions</span>
    <span class="k">elif</span> <span class="n">npos</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
        <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">.5</span><span class="p">,</span> <span class="mf">.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span>
                     <span class="mi">0</span><span class="p">,</span> <span class="mf">.5</span><span class="p">,</span> <span class="mf">.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]])</span>  <span class="c1"># design matrix for 6 measurement positions</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;measurement protocol not supported yet &quot;</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">A</span><span class="p">),</span> <span class="n">A</span><span class="p">)</span>
    <span class="n">B</span> <span class="o">=</span> <span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
    <span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">A</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span></div>
<span class="c1">#</span>
<span class="c1">#</span>


<div class="viewcode-block" id="dok15_s"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.dok15_s">[docs]</a><span class="k">def</span> <span class="nf">dok15_s</span><span class="p">(</span><span class="n">k15</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates least-squares matrix for 15 measurements from Jelinek [1976].</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    k15 : k15 value</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    sbar : array of six 15 element tensors</span>
<span class="sd">    sigma : array of sigma, standard deviation, of the measurement</span>
<span class="sd">    bulk : array of bulk susptibility </span>
<span class="sd">    </span>
<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; pmag.dok15_s(0.5)</span>
<span class="sd">    (array([[ 0.75,  0.75,  2.  ,  0.75,  0.75, -0.5 , -0.5 , -0.5 , -0.5 ,</span>
<span class="sd">         -0.5 ,  0.75,  0.75, -0.5 ,  0.75,  0.75],</span>
<span class="sd">        [ 0.75,  0.75, -0.5 ,  0.75,  0.75,  0.75,  0.75,  2.  ,  0.75,</span>
<span class="sd">          0.75, -0.5 , -0.5 , -0.5 , -0.5 , -0.5 ],</span>
<span class="sd">        [-0.5 , -0.5 , -0.5 , -0.5 , -0.5 ,  0.75,  0.75, -0.5 ,  0.75,</span>
<span class="sd">          0.75,  0.75,  0.75,  2.  ,  0.75,  0.75],</span>
<span class="sd">        [-1.25,  1.25,  0.  , -1.25,  1.25,  0.  ,  0.  ,  0.  ,  0.  ,</span>
<span class="sd">          0.  ,  0.  ,  0.  ,  0.  ,  0.  ,  0.  ],</span>
<span class="sd">        [ 0.  ,  0.  ,  0.  ,  0.  ,  0.  , -1.25,  1.25,  0.  , -1.25,</span>
<span class="sd">          1.25,  0.  ,  0.  ,  0.  ,  0.  ,  0.  ],</span>
<span class="sd">        [ 0.  ,  0.  ,  0.  ,  0.  ,  0.  ,  0.  ,  0.  ,  0.  ,  0.  ,</span>
<span class="sd">          0.  , -1.25,  1.25,  0.  , -1.25,  1.25]]),</span>
<span class="sd">     array([6.101001739241042, 6.101001739241042, 6.101001739241042,</span>
<span class="sd">        6.101001739241042, 6.101001739241042, 6.101001739241042,</span>
<span class="sd">        6.101001739241042, 6.101001739241042, 6.101001739241042,</span>
<span class="sd">        6.101001739241042, 6.10100173924104 , 6.10100173924104 ,</span>
<span class="sd">        6.101001739241042, 6.10100173924104 , 6.10100173924104 ]),</span>
<span class="sd">     array([0.033333333333333, 0.033333333333333, 0.033333333333333,</span>
<span class="sd">        0.033333333333333, 0.033333333333333, 0.033333333333333,</span>
<span class="sd">        0.033333333333333, 0.033333333333333, 0.033333333333333,</span>
<span class="sd">        0.033333333333333, 0.033333333333333, 0.033333333333333,</span>
<span class="sd">        0.033333333333333, 0.033333333333333, 0.033333333333333]))</span>
<span class="sd">    &quot;&quot;&quot;</span>
<span class="c1">#</span>
    <span class="n">A</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="n">design</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>  <span class="c1"># get design matrix for 15 measurements</span>
    <span class="n">sbar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">k15</span><span class="p">)</span>  <span class="c1"># get mean s</span>
    <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">sbar</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">sbar</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">sbar</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>  <span class="c1"># trace</span>
    <span class="n">bulk</span> <span class="o">=</span> <span class="n">old_div</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mf">3.</span><span class="p">)</span>  <span class="c1"># bulk susceptibility</span>
    <span class="n">Kbar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">sbar</span><span class="p">)</span>  <span class="c1"># get best fit values for K</span>
    <span class="n">dels</span> <span class="o">=</span> <span class="n">k15</span> <span class="o">-</span> <span class="n">Kbar</span>  <span class="c1"># get deltas</span>
    <span class="n">dels</span><span class="p">,</span> <span class="n">sbar</span> <span class="o">=</span> <span class="n">old_div</span><span class="p">(</span><span class="n">dels</span><span class="p">,</span> <span class="n">t</span><span class="p">),</span> <span class="n">old_div</span><span class="p">(</span><span class="n">sbar</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>  <span class="c1"># normalize by trace</span>
    <span class="n">So</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">dels</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">old_div</span><span class="p">(</span><span class="n">So</span><span class="p">,</span> <span class="mf">9.</span><span class="p">))</span>  <span class="c1"># standard deviation</span>
    <span class="k">return</span> <span class="n">sbar</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">bulk</span></div>
<span class="c1">#</span>


<div class="viewcode-block" id="cross"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.cross">[docs]</a><span class="k">def</span> <span class="nf">cross</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">w</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Cross product of two vectors.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    v : 3 value vector list</span>
<span class="sd">    w : 3 value vector list</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    [x, y, z] : cross product resultant vector</span>
<span class="sd">    </span>
<span class="sd">    Examples </span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; pmag.cross([3,6,0],[1,5,1])</span>
<span class="sd">    [6, -3, 9]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">w</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">w</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">]</span></div>
<span class="c1">#</span>


<div class="viewcode-block" id="dosgeo"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.dosgeo">[docs]</a><span class="k">def</span> <span class="nf">dosgeo</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">az</span><span class="p">,</span> <span class="n">pl</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Rotates matrix a to its azimuth and plunge. </span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    s : [x11,x22,x33,x12,x23,x13] - the six tensor elements</span>
<span class="sd">    az : the azimuth of the specimen X direction</span>
<span class="sd">    pl : the plunge (inclination) of the specimen X direction</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    s_rot : [x11,x22,x33,x12,x23,x13] after rotation</span>
<span class="sd">    </span>
<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; pmag.dosgeo([0.33586472,0.32757074,0.33656454,0.0056526,0.00449771,-0.00036542],12,33)</span>
<span class="sd">    array([ 0.33509237  ,  0.3288845   ,  0.33602312  ,  0.0038898108,</span>
<span class="sd">        0.0066036563, -0.0018823999], dtype=float32)</span>
<span class="sd">    &quot;&quot;&quot;</span>
<span class="c1">#</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">s2a</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>  <span class="c1"># convert to 3,3 matrix</span>
<span class="c1">#  first get three orthogonal axes</span>
    <span class="n">X1</span> <span class="o">=</span> <span class="n">dir2cart</span><span class="p">((</span><span class="n">az</span><span class="p">,</span> <span class="n">pl</span><span class="p">,</span> <span class="mf">1.</span><span class="p">))</span>
    <span class="n">X2</span> <span class="o">=</span> <span class="n">dir2cart</span><span class="p">((</span><span class="n">az</span> <span class="o">+</span> <span class="mi">90</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">))</span>
    <span class="n">X3</span> <span class="o">=</span> <span class="n">cross</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">)</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">([</span><span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="n">X3</span><span class="p">])</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,),</span> <span class="s1">&#39;f&#39;</span><span class="p">)</span>  <span class="c1"># initialize the b matrix</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="n">dum</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
                    <span class="n">dum</span> <span class="o">+=</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">A</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">l</span><span class="p">]</span> <span class="o">*</span> <span class="n">a</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">l</span><span class="p">]</span>
            <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">dum</span>
    <span class="n">s_rot</span> <span class="o">=</span> <span class="n">a2s</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>  <span class="c1"># after rotation</span>
    <span class="k">return</span> <span class="n">s_rot</span></div>
<span class="c1">#</span>
<span class="c1">#</span>


<div class="viewcode-block" id="dostilt"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.dostilt">[docs]</a><span class="k">def</span> <span class="nf">dostilt</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">bed_az</span><span class="p">,</span> <span class="n">bed_dip</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Rotates &quot;s&quot; tensor to stratigraphic coordinates</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    s : [x11,x22,x33,x12,x23,x13] - the six tensor elements</span>
<span class="sd">    bed_az : bedding dip direction</span>
<span class="sd">    bed_dip :  bedding dip</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    s_rot : [x11,x22,x33,x12,x23,x13] - after rotation</span>
<span class="sd">    </span>
<span class="sd">    Examples </span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; pmag.dostilt([0.33586472,0.32757074,0.33656454,0.0056526,0.00449771,-0.00036542],20,38)</span>
<span class="sd">    array([ 0.33473614  ,  0.32911453  ,  0.33614933  ,  0.0075679934,</span>
<span class="sd">        0.0020322995, -0.0014457355], dtype=float32)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tau</span><span class="p">,</span> <span class="n">Vdirs</span> <span class="o">=</span> <span class="n">doseigs</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="n">Vrot</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">evec</span> <span class="ow">in</span> <span class="n">Vdirs</span><span class="p">:</span>
        <span class="n">d</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="n">dotilt</span><span class="p">(</span><span class="n">evec</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">evec</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">bed_az</span><span class="p">,</span> <span class="n">bed_dip</span><span class="p">)</span>
        <span class="n">Vrot</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">d</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span>
    <span class="n">s_rot</span> <span class="o">=</span> <span class="n">doeigs_s</span><span class="p">(</span><span class="n">tau</span><span class="p">,</span> <span class="n">Vrot</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">s_rot</span></div>
<span class="c1">#</span>
<span class="c1">#</span>


<div class="viewcode-block" id="apseudo"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.apseudo">[docs]</a><span class="k">def</span> <span class="nf">apseudo</span><span class="p">(</span><span class="n">Ss</span><span class="p">,</span> <span class="n">ipar</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Depreciated: 9/14/2022</span>
<span class="sd">    </span>
<span class="sd">    Draw a bootstrap sample of Ss.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Ss : six element tensor as a list</span>
<span class="sd">    ipar : boolean (True, False, or zero value)</span>
<span class="sd">    sigma : sigma of Ss</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    BSs : array </span>
<span class="sd">        bootstrap sample of Ss</span>
<span class="sd">        </span>
<span class="sd">    Examples </span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; pmag.apseudo(np.array([2,2,1,6,1,1]),0,0)</span>
<span class="sd">    array([1, 2, 1, 2, 2, 1])</span>
<span class="sd">    &quot;&quot;&quot;</span>
<span class="c1">#</span>
    <span class="n">Ss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Ss</span><span class="p">)</span>   <span class="c1"># added 9/9/22 for consistency with other functions using the variable &quot;Ss&quot;</span>
    <span class="n">Is</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">Ss</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">Ss</span><span class="p">))</span>  <span class="c1"># draw N random integers</span>
    <span class="c1">#Ss = np.array(Ss)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">ipar</span><span class="p">:</span> <span class="c1"># ipar == 0:</span>
        <span class="n">BSs</span> <span class="o">=</span> <span class="n">Ss</span><span class="p">[</span><span class="n">Is</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># need to recreate measurement - then do the parametric stuffr</span>
        <span class="n">A</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="n">design</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>  <span class="c1"># get the design matrix for 6 measurementsa</span>
        <span class="n">K</span><span class="p">,</span> <span class="n">BSs</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Ss</span><span class="p">)):</span>
            <span class="n">K</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">Ss</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">]))</span>
        <span class="n">Pars</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Ss</span><span class="p">)):</span>
            <span class="n">BSs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">Pars</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">BSs</span><span class="p">)</span></div>
<span class="c1">#</span>


<div class="viewcode-block" id="sbootpars"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.sbootpars">[docs]</a><span class="k">def</span> <span class="nf">sbootpars</span><span class="p">(</span><span class="n">Taus</span><span class="p">,</span> <span class="n">Vs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get bootstrap parameters for s data from bootstrap eigenvalues and eigenvectors.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Taus : nested list of eigenvalues</span>
<span class="sd">    Vs : nested list of eigenvectors</span>
<span class="sd">    </span>
<span class="sd">    Returns </span>
<span class="sd">    -------</span>
<span class="sd">    bpars : dictionary of bootstrap parameters for the bootstrap eigenvalues and eigenvectors.</span>
<span class="sd">    </span>
<span class="sd">    Examples </span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; Taus = [[0.89332515, 0.2421235, -0.13544868], [1.2330734, 0.033398163, -0.26647156]]</span>
<span class="sd">    &gt;&gt;&gt; Vs = [[[16.71852040881784, 22.059363998317398],</span>
<span class="sd">           [122.30845200565045, 33.55240424468586],</span>
<span class="sd">           [259.90057243022835, 48.06963167162283]],</span>
<span class="sd">          [[36.31805058172574, 15.477280574403938],</span>
<span class="sd">           [183.99811452360234, 71.85809815162672],</span>
<span class="sd">           [303.738439079619, 9.23224775163199]]]</span>
<span class="sd">    &gt;&gt;&gt; pmag.sbootpars(Taus, Vs)</span>
<span class="sd">    {&#39;t1_sigma&#39;: 0.24023829147126252,</span>
<span class="sd">     &#39;t2_sigma&#39;: 0.1475911011981474,</span>
<span class="sd">     &#39;t3_sigma&#39;: 0.09264716693859128,</span>
<span class="sd">     &#39;v1_dec&#39;: 26.711662224665808,</span>
<span class="sd">     &#39;v1_inc&#39;: 19.026277799227568,</span>
<span class="sd">     &#39;v1_zeta&#39;: 24.690888880899667,</span>
<span class="sd">     &#39;v1_eta&#39;: 1.249303736510881e-14,</span>
<span class="sd">     &#39;v1_zeta_dec&#39;: 290.06398627901706,</span>
<span class="sd">     &#39;v1_zeta_inc&#39;: 18.55700265945684,</span>
<span class="sd">     &#39;v1_eta_dec&#39;: 159.07273109103403,</span>
<span class="sd">     &#39;v1_eta_inc&#39;: 62.89733254726475,</span>
<span class="sd">     &#39;v2_dec&#39;: 137.92012533786792,</span>
<span class="sd">     &#39;v2_inc&#39;: 55.87313967394276,</span>
<span class="sd">     &#39;v2_zeta&#39;: 1.250107785929978e-14,</span>
<span class="sd">     &#39;v2_eta&#39;: 75.07258147484707,</span>
<span class="sd">     &#39;v2_zeta_dec&#39;: 20.268001361016218,</span>
<span class="sd">     &#39;v2_zeta_inc&#39;: 17.460349183865556,</span>
<span class="sd">     &#39;v2_eta_dec&#39;: 280.5183204912709,</span>
<span class="sd">     &#39;v2_eta_inc&#39;: 28.297554981599696,</span>
<span class="sd">     &#39;v3_dec&#39;: 286.25118089868266,</span>
<span class="sd">     &#39;v3_inc&#39;: 30.42076774734727,</span>
<span class="sd">     &#39;v3_zeta&#39;: 2.4071834979709793e-14,</span>
<span class="sd">     &#39;v3_eta&#39;: 85.83440673704222,</span>
<span class="sd">     &#39;v3_zeta_dec&#39;: 40.186767906504166,</span>
<span class="sd">     &#39;v3_zeta_inc&#39;: 34.642182695768,</span>
<span class="sd">     &#39;v3_eta_dec&#39;: 166.24042846510952,</span>
<span class="sd">     &#39;v3_eta_inc&#39;: 40.4243181226488}</span>
<span class="sd">    &quot;&quot;&quot;</span>
<span class="c1">#</span>
    <span class="n">Tau1s</span><span class="p">,</span> <span class="n">Tau2s</span><span class="p">,</span> <span class="n">Tau3s</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">V1s</span><span class="p">,</span> <span class="n">V2s</span><span class="p">,</span> <span class="n">V3s</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">nb</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">Taus</span><span class="p">)</span>
    <span class="n">bpars</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nb</span><span class="p">):</span>
        <span class="n">Tau1s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Taus</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">Tau2s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Taus</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">Tau3s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Taus</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">V1s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Vs</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">V2s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Vs</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">V3s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Vs</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">sig</span> <span class="o">=</span> <span class="n">gausspars</span><span class="p">(</span><span class="n">Tau1s</span><span class="p">)</span>
    <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;t1_sigma&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sig</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">sig</span> <span class="o">=</span> <span class="n">gausspars</span><span class="p">(</span><span class="n">Tau2s</span><span class="p">)</span>
    <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;t2_sigma&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sig</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">sig</span> <span class="o">=</span> <span class="n">gausspars</span><span class="p">(</span><span class="n">Tau3s</span><span class="p">)</span>
    <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;t3_sigma&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sig</span>
    <span class="n">V1s</span><span class="o">=</span><span class="n">flip</span><span class="p">(</span><span class="n">V1s</span><span class="p">,</span><span class="n">combine</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">kpars</span> <span class="o">=</span> <span class="n">dokent</span><span class="p">(</span><span class="n">V1s</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">V1s</span><span class="p">))</span>
    <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v1_dec&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kpars</span><span class="p">[</span><span class="s2">&quot;dec&quot;</span><span class="p">]</span>
    <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v1_inc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kpars</span><span class="p">[</span><span class="s2">&quot;inc&quot;</span><span class="p">]</span>
    <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v1_zeta&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">kpars</span><span class="p">[</span><span class="s2">&quot;Zeta&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">nb</span><span class="p">))</span> <span class="o">%</span> <span class="mf">360.</span>
    <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v1_eta&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">kpars</span><span class="p">[</span><span class="s2">&quot;Eta&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">nb</span><span class="p">))</span> <span class="o">%</span> <span class="mf">360.</span>
    <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v1_zeta_dec&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kpars</span><span class="p">[</span><span class="s2">&quot;Zdec&quot;</span><span class="p">]</span>
    <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v1_zeta_inc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kpars</span><span class="p">[</span><span class="s2">&quot;Zinc&quot;</span><span class="p">]</span>
    <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v1_eta_dec&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kpars</span><span class="p">[</span><span class="s2">&quot;Edec&quot;</span><span class="p">]</span>
    <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v1_eta_inc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kpars</span><span class="p">[</span><span class="s2">&quot;Einc&quot;</span><span class="p">]</span>
    <span class="n">V2s</span><span class="o">=</span><span class="n">flip</span><span class="p">(</span><span class="n">V2s</span><span class="p">,</span><span class="n">combine</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">kpars</span> <span class="o">=</span> <span class="n">dokent</span><span class="p">(</span><span class="n">V2s</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">V2s</span><span class="p">))</span>
    <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v2_dec&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kpars</span><span class="p">[</span><span class="s2">&quot;dec&quot;</span><span class="p">]</span>
    <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v2_inc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kpars</span><span class="p">[</span><span class="s2">&quot;inc&quot;</span><span class="p">]</span>
    <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v2_zeta&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">kpars</span><span class="p">[</span><span class="s2">&quot;Zeta&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">nb</span><span class="p">))</span> <span class="o">%</span> <span class="mf">360.</span>
    <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v2_eta&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">kpars</span><span class="p">[</span><span class="s2">&quot;Eta&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">nb</span><span class="p">))</span> <span class="o">%</span> <span class="mf">360.</span>
    <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v2_zeta_dec&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kpars</span><span class="p">[</span><span class="s2">&quot;Zdec&quot;</span><span class="p">]</span>
    <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v2_zeta_inc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kpars</span><span class="p">[</span><span class="s2">&quot;Zinc&quot;</span><span class="p">]</span>
    <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v2_eta_dec&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kpars</span><span class="p">[</span><span class="s2">&quot;Edec&quot;</span><span class="p">]</span>
    <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v2_eta_inc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kpars</span><span class="p">[</span><span class="s2">&quot;Einc&quot;</span><span class="p">]</span>
    <span class="n">V3s</span><span class="o">=</span><span class="n">flip</span><span class="p">(</span><span class="n">V3s</span><span class="p">,</span><span class="n">combine</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">kpars</span> <span class="o">=</span> <span class="n">dokent</span><span class="p">(</span><span class="n">V3s</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">V3s</span><span class="p">))</span>
    <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v3_dec&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kpars</span><span class="p">[</span><span class="s2">&quot;dec&quot;</span><span class="p">]</span>
    <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v3_inc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kpars</span><span class="p">[</span><span class="s2">&quot;inc&quot;</span><span class="p">]</span>
    <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v3_zeta&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">kpars</span><span class="p">[</span><span class="s2">&quot;Zeta&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">nb</span><span class="p">))</span> <span class="o">%</span> <span class="mf">360.</span>
    <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v3_eta&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">kpars</span><span class="p">[</span><span class="s2">&quot;Eta&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">nb</span><span class="p">))</span> <span class="o">%</span> <span class="mf">360.</span>
    <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v3_zeta_dec&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kpars</span><span class="p">[</span><span class="s2">&quot;Zdec&quot;</span><span class="p">]</span>
    <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v3_zeta_inc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kpars</span><span class="p">[</span><span class="s2">&quot;Zinc&quot;</span><span class="p">]</span>
    <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v3_eta_dec&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kpars</span><span class="p">[</span><span class="s2">&quot;Edec&quot;</span><span class="p">]</span>
    <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v3_eta_inc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kpars</span><span class="p">[</span><span class="s2">&quot;Einc&quot;</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">bpars</span></div>
<span class="c1">#</span>
<span class="c1">#</span>


<div class="viewcode-block" id="s_boot"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.s_boot">[docs]</a><span class="k">def</span> <span class="nf">s_boot</span><span class="p">(</span><span class="n">Ss</span><span class="p">,</span> <span class="n">ipar</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">nb</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns bootstrap parameters for S data.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Ss : nested array of [[x11 x22 x33 x12 x23 x13],....] data</span>
<span class="sd">    ipar : if True, do a parametric bootstrap</span>
<span class="sd">    nb : number of bootstraps</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Tmean : average eigenvalues</span>
<span class="sd">    Vmean : average eigvectors</span>
<span class="sd">    Taus : bootstrapped eigenvalues</span>
<span class="sd">    Vs :  bootstrapped eigenvectors</span>
<span class="sd">    </span>
<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; Ss = [[0.33586472,0.32757074,0.33656454,0.0056526,0.00449771,-0.00036542], [0.33815295,0.32601482,0.33583224,0.00754076,0.00405271,-0.0001627],</span>
<span class="sd">        [0.33806428,0.32925552,0.33268023,0.00480824,-0.00168595,0.0009308], [0.33939844,0.32750368,0.33309788,0.00763409,0.00264978,0.00070303],</span>
<span class="sd">        [0.3348785,0.32816416,0.33695734,0.00574405,0.00278172,-0.00073475], [0.33485019,0.32948497,0.33566481,0.00597801,0.00426423,-0.00040056]]</span>
<span class="sd">    &gt;&gt;&gt; pmag.s_boot(Ss,0,2)</span>
<span class="sd">    ([0.34040287, 0.3353659, 0.32423124],</span>
<span class="sd">     [[29.594002551414974, 14.457521581993113],</span>
<span class="sd">      [166.31028417625646, 70.4972100801602],</span>
<span class="sd">      [296.2343306258123, 12.805665338949966]],</span>
<span class="sd">     [[0.34002233, 0.33413905, 0.32583863], [0.34043044, 0.33551994, 0.32404962]],</span>
<span class="sd">     [[[26.298051965057486, 5.235004519419732],</span>
<span class="sd">       [183.15464080261913, 84.30971842978398],</span>
<span class="sd">       [296.0941733228108, 2.224044816930646]],</span>
<span class="sd">      [[28.798353815000212, 14.686330248560294],</span>
<span class="sd">       [166.21187481069492, 70.40546729047502],</span>
<span class="sd">       [295.4174263407004, 12.681162985818712]]])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">#npts = len(Ss)</span>
    <span class="n">Ss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Ss</span><span class="p">)</span>
    <span class="n">npts</span> <span class="o">=</span> <span class="n">Ss</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="c1"># get average s for whole dataset</span>
    <span class="n">nf</span><span class="p">,</span> <span class="n">Sigma</span><span class="p">,</span> <span class="n">avs</span> <span class="o">=</span> <span class="n">sbar</span><span class="p">(</span><span class="n">Ss</span><span class="p">)</span>
    <span class="n">Tmean</span><span class="p">,</span> <span class="n">Vmean</span> <span class="o">=</span> <span class="n">doseigs</span><span class="p">(</span><span class="n">avs</span><span class="p">)</span>  <span class="c1"># get eigenvectors of mean tensor</span>
<span class="c1">#</span>
<span class="c1"># now do bootstrap to collect Vs and taus of bootstrap means</span>
<span class="c1">#</span>
    <span class="n">Taus</span><span class="p">,</span> <span class="n">Vs</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>  <span class="c1"># number of bootstraps, list of bootstrap taus and eigenvectors</span>
<span class="c1">#</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">nb</span><span class="p">))):</span>  <span class="c1"># repeat nb times</span>
        <span class="c1">#        if k%50==0:print k,&#39; out of &#39;,nb</span>
        <span class="c1"># get a pseudosample - if ipar=1, do a parametric bootstrap</span>
        <span class="n">BSs</span> <span class="o">=</span> <span class="n">apseudo</span><span class="p">(</span><span class="n">Ss</span><span class="p">,</span> <span class="n">ipar</span><span class="p">,</span> <span class="n">Sigma</span><span class="p">)</span>
        <span class="n">nf</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">avbs</span> <span class="o">=</span> <span class="n">sbar</span><span class="p">(</span><span class="n">BSs</span><span class="p">)</span>  <span class="c1"># get bootstrap mean s</span>
        <span class="n">tau</span><span class="p">,</span> <span class="n">Vdirs</span> <span class="o">=</span> <span class="n">doseigs</span><span class="p">(</span><span class="n">avbs</span><span class="p">)</span>  <span class="c1"># get bootstrap eigenparameters</span>
        <span class="n">Taus</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tau</span><span class="p">)</span>
        <span class="n">Vs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Vdirs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Tmean</span><span class="p">,</span> <span class="n">Vmean</span><span class="p">,</span> <span class="n">Taus</span><span class="p">,</span> <span class="n">Vs</span></div>

<span class="c1">#</span>


<div class="viewcode-block" id="designAARM"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.designAARM">[docs]</a><span class="k">def</span> <span class="nf">designAARM</span><span class="p">(</span><span class="n">npos</span><span class="p">):</span>
    <span class="c1">#</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates B matrix for AARM calculations.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    npos : number of positions</span>
<span class="sd">        9 is the only number of positions valid.</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    B : B matrix as an array</span>
<span class="sd">    H : Field directions</span>
<span class="sd">    tmpH : tmpH matrix</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">npos</span> <span class="o">!=</span> <span class="mi">9</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Sorry - only 9 positions available&#39;</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="n">Dec</span> <span class="o">=</span> <span class="p">[</span><span class="mf">315.</span><span class="p">,</span> <span class="mf">225.</span><span class="p">,</span> <span class="mf">180.</span><span class="p">,</span> <span class="mf">135.</span><span class="p">,</span> <span class="mf">45.</span><span class="p">,</span> <span class="mf">90.</span><span class="p">,</span> <span class="mf">270.</span><span class="p">,</span>
           <span class="mf">270.</span><span class="p">,</span> <span class="mf">270.</span><span class="p">,</span> <span class="mf">90.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">180.</span><span class="p">,</span> <span class="mf">180.</span><span class="p">]</span>
    <span class="n">Dip</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">45.</span><span class="p">,</span> <span class="o">-</span><span class="mf">45.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span>
           <span class="mf">45.</span><span class="p">,</span> <span class="mf">45.</span><span class="p">,</span> <span class="mf">45.</span><span class="p">,</span> <span class="o">-</span><span class="mf">45.</span><span class="p">,</span> <span class="o">-</span><span class="mf">90.</span><span class="p">,</span> <span class="o">-</span><span class="mf">45.</span><span class="p">,</span> <span class="mf">45.</span><span class="p">]</span>
    <span class="n">index9</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">]</span>
    <span class="n">H</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">15</span><span class="p">):</span>
        <span class="n">Dir</span> <span class="o">=</span> <span class="p">[</span><span class="n">Dec</span><span class="p">[</span><span class="n">ind</span><span class="p">],</span> <span class="n">Dip</span><span class="p">[</span><span class="n">ind</span><span class="p">],</span> <span class="mf">1.</span><span class="p">]</span>
        <span class="n">H</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dir2cart</span><span class="p">(</span><span class="n">Dir</span><span class="p">))</span>  <span class="c1"># 15 field directionss</span>
<span class="c1">#</span>
<span class="c1"># make design matrix A</span>
<span class="c1">#</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">npos</span> <span class="o">*</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="s1">&#39;f&#39;</span><span class="p">)</span>
    <span class="n">tmpH</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">npos</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;f&#39;</span><span class="p">)</span>  <span class="c1"># define tmpH</span>
    <span class="k">if</span> <span class="n">npos</span> <span class="o">==</span> <span class="mi">9</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">):</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">index9</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">ind</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">3</span>
            <span class="n">A</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">H</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">A</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">H</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">A</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="n">H</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">ind</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">A</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">H</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">A</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">H</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">A</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">H</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">ind</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span>
            <span class="n">A</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="n">H</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">A</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">H</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">A</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">H</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
                <span class="n">tmpH</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">H</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
        <span class="n">At</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
        <span class="n">ATA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">At</span><span class="p">,</span> <span class="n">A</span><span class="p">)</span>
        <span class="n">ATAI</span> <span class="o">=</span> <span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">ATA</span><span class="p">)</span>
        <span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">ATAI</span><span class="p">,</span> <span class="n">At</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;B matrix not yet supported&quot;</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="k">return</span> <span class="n">B</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">tmpH</span></div>
<span class="c1">#</span>


<div class="viewcode-block" id="designATRM"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.designATRM">[docs]</a><span class="k">def</span> <span class="nf">designATRM</span><span class="p">(</span><span class="n">npos</span><span class="p">):</span>
    <span class="c1">#</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates B matrix for ATRM calculations.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    npos : number of positions</span>
<span class="sd">        6 and greater number of positions valid.</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    B : B matrix as an array</span>
<span class="sd">    H : Field directions</span>
<span class="sd">    tmpH : tmpH matrix</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># if npos!=6:</span>
    <span class="c1">#    print &#39;Sorry - only 6 positions available&#39;</span>
    <span class="n">Dec</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">270</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>  <span class="c1"># for shuhui only</span>
    <span class="n">Dip</span> <span class="o">=</span> <span class="p">[</span><span class="mi">90</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="p">]</span>
    <span class="n">Dec</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">270</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">Dip</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="p">]</span>
    <span class="n">H</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
        <span class="n">Dir</span> <span class="o">=</span> <span class="p">[</span><span class="n">Dec</span><span class="p">[</span><span class="n">ind</span><span class="p">],</span> <span class="n">Dip</span><span class="p">[</span><span class="n">ind</span><span class="p">],</span> <span class="mf">1.</span><span class="p">]</span>
        <span class="n">H</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dir2cart</span><span class="p">(</span><span class="n">Dir</span><span class="p">))</span>  <span class="c1"># 6 field directionss</span>
<span class="c1">#</span>
<span class="c1"># make design matrix A</span>
<span class="c1">#</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">npos</span> <span class="o">*</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="s1">&#39;f&#39;</span><span class="p">)</span>
    <span class="n">tmpH</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">npos</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;f&#39;</span><span class="p">)</span>  <span class="c1"># define tmpH</span>
    <span class="c1"># if npos == 6:</span>
    <span class="c1">#    for i in range(6):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
        <span class="n">ind</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">3</span>
        <span class="n">A</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">H</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">A</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">H</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">A</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="n">H</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">ind</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">A</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">H</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">A</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">H</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">A</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">H</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">ind</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span>
        <span class="n">A</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="n">H</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">A</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">H</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">A</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">H</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="n">tmpH</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">H</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
    <span class="n">At</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
    <span class="n">ATA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">At</span><span class="p">,</span> <span class="n">A</span><span class="p">)</span>
    <span class="n">ATAI</span> <span class="o">=</span> <span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">ATA</span><span class="p">)</span>
    <span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">ATAI</span><span class="p">,</span> <span class="n">At</span><span class="p">)</span>
    <span class="c1"># else:</span>
    <span class="c1">#    print &quot;B matrix not yet supported&quot;</span>
    <span class="k">return</span> <span class="n">B</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">tmpH</span></div>

<span class="c1">#</span>


<div class="viewcode-block" id="domagicmag"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.domagicmag">[docs]</a><span class="k">def</span> <span class="nf">domagicmag</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">Recs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts a magic record back into the SIO mag format.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">Recs</span><span class="p">:</span>
        <span class="nb">type</span> <span class="o">=</span> <span class="s2">&quot;.0&quot;</span>
        <span class="n">meths</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;magic_method_codes&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">meth</span> <span class="ow">in</span> <span class="n">tmp</span><span class="p">:</span>
            <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">meth</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
        <span class="k">if</span> <span class="s1">&#39;LT-T-I&#39;</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>
            <span class="nb">type</span> <span class="o">=</span> <span class="s2">&quot;.1&quot;</span>
        <span class="k">if</span> <span class="s1">&#39;LT-PTRM-I&#39;</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>
            <span class="nb">type</span> <span class="o">=</span> <span class="s2">&quot;.2&quot;</span>
        <span class="k">if</span> <span class="s1">&#39;LT-PTRM-MD&#39;</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>
            <span class="nb">type</span> <span class="o">=</span> <span class="s2">&quot;.3&quot;</span>
        <span class="n">treatment</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treatment_temp&quot;</span><span class="p">])</span> <span class="o">-</span> <span class="mi">273</span>
        <span class="n">tr</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%i</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">treatment</span><span class="p">)</span> <span class="o">+</span> <span class="nb">type</span>
        <span class="n">inten</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%8.7e</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;measurement_magn_moment&quot;</span><span class="p">])</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">)</span>
        <span class="n">outstring</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;er_specimen_name&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">tr</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;measurement_csd&quot;</span><span class="p">]</span> <span class="o">+</span> \
            <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">inten</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;measurement_dec&quot;</span><span class="p">]</span> <span class="o">+</span> \
            <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;measurement_inc&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">outstring</span><span class="p">)</span></div>
<span class="c1">#</span>
<span class="c1">#</span>


<div class="viewcode-block" id="cleanup"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.cleanup">[docs]</a><span class="k">def</span> <span class="nf">cleanup</span><span class="p">(</span><span class="n">first_I</span><span class="p">,</span> <span class="n">first_Z</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">     cleans up unbalanced steps</span>
<span class="sd">     failure can be from unbalanced final step, or from missing steps,</span>
<span class="sd">     this takes care of  missing steps</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cont</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">Nmin</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">first_I</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">first_Z</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">Nmin</span><span class="p">:</span>
        <span class="n">Nmin</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">first_Z</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">kk</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nmin</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">first_I</span><span class="p">[</span><span class="n">kk</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">first_Z</span><span class="p">[</span><span class="n">kk</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> WARNING: &quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">first_I</span><span class="p">[</span><span class="n">kk</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">first_Z</span><span class="p">[</span><span class="n">kk</span><span class="p">]:</span>
                <span class="k">del</span> <span class="n">first_I</span><span class="p">[</span><span class="n">kk</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">del</span> <span class="n">first_Z</span><span class="p">[</span><span class="n">kk</span><span class="p">]</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Unmatched step number: &quot;</span><span class="p">,</span> <span class="n">kk</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;  ignored&#39;</span><span class="p">)</span>
            <span class="n">cont</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">cont</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">first_I</span><span class="p">,</span> <span class="n">first_Z</span><span class="p">,</span> <span class="n">cont</span>
    <span class="k">return</span> <span class="n">first_I</span><span class="p">,</span> <span class="n">first_Z</span><span class="p">,</span> <span class="n">cont</span></div>
<span class="c1">#</span>
<span class="c1">#</span>


<div class="viewcode-block" id="sortarai"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.sortarai">[docs]</a><span class="k">def</span> <span class="nf">sortarai</span><span class="p">(</span><span class="n">datablock</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">Zdiff</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sorts data block in to first_Z, first_I, etc.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    datablock : Pandas DataFrame with Thellier-Tellier type data</span>
<span class="sd">    s : specimen name</span>
<span class="sd">    Zdiff : if True, take difference in Z values instead of vector difference</span>
<span class="sd">            NB:  this should always be False</span>
<span class="sd">    **kwargs :</span>
<span class="sd">        version : data model.  if not 3, assume data model = 2.5</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    araiblock : [first_Z, first_I, ptrm_check,</span>
<span class="sd">                 ptrm_tail, zptrm_check, GammaChecks]</span>
<span class="sd">    field : lab field (in tesla)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="s1">&#39;version&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;version&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">dec_key</span><span class="p">,</span> <span class="n">inc_key</span> <span class="o">=</span> <span class="s1">&#39;dir_dec&#39;</span><span class="p">,</span> <span class="s1">&#39;dir_inc&#39;</span>
        <span class="n">Mkeys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;magn_moment&#39;</span><span class="p">,</span> <span class="s1">&#39;magn_volume&#39;</span><span class="p">,</span> <span class="s1">&#39;magn_mass&#39;</span><span class="p">,</span> <span class="s1">&#39;magnitude&#39;</span><span class="p">]</span>
        <span class="n">meth_key</span> <span class="o">=</span> <span class="s1">&#39;method_codes&#39;</span>
        <span class="n">temp_key</span><span class="p">,</span> <span class="n">dc_key</span> <span class="o">=</span> <span class="s1">&#39;treat_temp&#39;</span><span class="p">,</span> <span class="s1">&#39;treat_dc_field&#39;</span>
        <span class="n">dc_theta_key</span><span class="p">,</span> <span class="n">dc_phi_key</span> <span class="o">=</span> <span class="s1">&#39;treat_dc_field_theta&#39;</span><span class="p">,</span> <span class="s1">&#39;treat_dc_field_phi&#39;</span>
        <span class="c1"># convert dataframe to list of dictionaries</span>
        <span class="n">datablock</span> <span class="o">=</span> <span class="n">datablock</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="s1">&#39;records&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dec_key</span><span class="p">,</span> <span class="n">inc_key</span> <span class="o">=</span> <span class="s1">&#39;measurement_dec&#39;</span><span class="p">,</span> <span class="s1">&#39;measurement_inc&#39;</span>
        <span class="n">Mkeys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;measurement_magn_moment&#39;</span><span class="p">,</span> <span class="s1">&#39;measurement_magn_volume&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;measurement_magn_mass&#39;</span><span class="p">,</span> <span class="s1">&#39;measurement_magnitude&#39;</span><span class="p">]</span>
        <span class="n">meth_key</span> <span class="o">=</span> <span class="s1">&#39;magic_method_codes&#39;</span>
        <span class="n">temp_key</span><span class="p">,</span> <span class="n">dc_key</span> <span class="o">=</span> <span class="s1">&#39;treatment_temp&#39;</span><span class="p">,</span> <span class="s1">&#39;treatment_dc_field&#39;</span>
        <span class="n">dc_theta_key</span><span class="p">,</span> <span class="n">dc_phi_key</span> <span class="o">=</span> <span class="s1">&#39;treatment_dc_field_theta&#39;</span><span class="p">,</span> <span class="s1">&#39;treatment_dc_field_phi&#39;</span>
    <span class="n">first_Z</span><span class="p">,</span> <span class="n">first_I</span><span class="p">,</span> <span class="n">zptrm_check</span><span class="p">,</span> <span class="n">ptrm_check</span><span class="p">,</span> <span class="n">ptrm_tail</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">field</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">theta</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span>
    <span class="n">starthere</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">Treat_I</span><span class="p">,</span> <span class="n">Treat_Z</span><span class="p">,</span> <span class="n">Treat_PZ</span><span class="p">,</span> <span class="n">Treat_PI</span><span class="p">,</span> <span class="n">Treat_M</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">ISteps</span><span class="p">,</span> <span class="n">ZSteps</span><span class="p">,</span> <span class="n">PISteps</span><span class="p">,</span> <span class="n">PZSteps</span><span class="p">,</span> <span class="n">MSteps</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">GammaChecks</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># comparison of pTRM direction acquired and lab field</span>
    <span class="n">rec</span> <span class="o">=</span> <span class="n">datablock</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">Mkeys</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="n">rec</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">momkey</span> <span class="o">=</span> <span class="n">key</span>
            <span class="k">break</span>
<span class="c1"># first find all the steps</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">datablock</span><span class="p">)):</span>
        <span class="n">rec</span> <span class="o">=</span> <span class="n">datablock</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="n">temp</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="n">temp_key</span><span class="p">])</span>
        <span class="n">methcodes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="n">meth_key</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">meth</span> <span class="ow">in</span> <span class="n">tmp</span><span class="p">:</span>
            <span class="n">methcodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">meth</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
        <span class="k">if</span> <span class="s1">&#39;LT-T-I&#39;</span> <span class="ow">in</span> <span class="n">methcodes</span> <span class="ow">and</span> <span class="s1">&#39;LP-TRM&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">methcodes</span> <span class="ow">and</span> <span class="s1">&#39;LP-PI-TRM&#39;</span> <span class="ow">in</span> <span class="n">methcodes</span><span class="p">:</span>
            <span class="n">Treat_I</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
            <span class="n">ISteps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">field</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">field</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="n">dc_key</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">phi</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">phi</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="n">dc_phi_key</span><span class="p">])</span>
                <span class="n">theta</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="n">dc_theta_key</span><span class="p">])</span>
<span class="c1"># stick  first zero field stuff into first_Z</span>
        <span class="k">if</span> <span class="s1">&#39;LT-NO&#39;</span> <span class="ow">in</span> <span class="n">methcodes</span><span class="p">:</span>
            <span class="n">Treat_Z</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
            <span class="n">ZSteps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;LT-T-Z&#39;</span> <span class="ow">in</span> <span class="n">methcodes</span><span class="p">:</span>
            <span class="n">Treat_Z</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
            <span class="n">ZSteps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;LT-PTRM-Z&#39;</span> <span class="ow">in</span> <span class="n">methcodes</span><span class="p">:</span>
            <span class="n">Treat_PZ</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
            <span class="n">PZSteps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;LT-PTRM-I&#39;</span> <span class="ow">in</span> <span class="n">methcodes</span><span class="p">:</span>
            <span class="n">Treat_PI</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
            <span class="n">PISteps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;LT-PTRM-MD&#39;</span> <span class="ow">in</span> <span class="n">methcodes</span><span class="p">:</span>
            <span class="n">Treat_M</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
            <span class="n">MSteps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;LT-NO&#39;</span> <span class="ow">in</span> <span class="n">methcodes</span><span class="p">:</span>
            <span class="n">dec</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="n">dec_key</span><span class="p">])</span>
            <span class="n">inc</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="n">inc_key</span><span class="p">])</span>
            <span class="n">st</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="n">momkey</span><span class="p">])</span>
            <span class="n">first_I</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="mi">273</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
            <span class="n">first_Z</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="mi">273</span><span class="p">,</span> <span class="n">dec</span><span class="p">,</span> <span class="n">inc</span><span class="p">,</span> <span class="n">st</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>  <span class="c1"># NRM step</span>
    <span class="k">for</span> <span class="n">temp</span> <span class="ow">in</span> <span class="n">Treat_I</span><span class="p">:</span>  <span class="c1"># look through infield steps and find matching Z step</span>
        <span class="k">if</span> <span class="n">temp</span> <span class="ow">in</span> <span class="n">Treat_Z</span><span class="p">:</span>  <span class="c1"># found a match</span>
            <span class="n">istep</span> <span class="o">=</span> <span class="n">ISteps</span><span class="p">[</span><span class="n">Treat_I</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">temp</span><span class="p">)]</span>
            <span class="n">irec</span> <span class="o">=</span> <span class="n">datablock</span><span class="p">[</span><span class="n">istep</span><span class="p">]</span>
            <span class="n">methcodes</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">tmp</span> <span class="o">=</span> <span class="n">irec</span><span class="p">[</span><span class="n">meth_key</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">meth</span> <span class="ow">in</span> <span class="n">tmp</span><span class="p">:</span>
                <span class="n">methcodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">meth</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
            <span class="c1"># take last record as baseline to subtract</span>
            <span class="n">brec</span> <span class="o">=</span> <span class="n">datablock</span><span class="p">[</span><span class="n">istep</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
            <span class="n">zstep</span> <span class="o">=</span> <span class="n">ZSteps</span><span class="p">[</span><span class="n">Treat_Z</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">temp</span><span class="p">)]</span>
            <span class="n">zrec</span> <span class="o">=</span> <span class="n">datablock</span><span class="p">[</span><span class="n">zstep</span><span class="p">]</span>
    <span class="c1"># sort out first_Z records</span>
            <span class="k">if</span> <span class="s2">&quot;LP-PI-TRM-IZ&quot;</span> <span class="ow">in</span> <span class="n">methcodes</span><span class="p">:</span>
                <span class="n">ZI</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ZI</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">dec</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">zrec</span><span class="p">[</span><span class="n">dec_key</span><span class="p">])</span>
            <span class="n">inc</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">zrec</span><span class="p">[</span><span class="n">inc_key</span><span class="p">])</span>
            <span class="n">st</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">zrec</span><span class="p">[</span><span class="n">momkey</span><span class="p">])</span>
            <span class="n">first_Z</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">temp</span><span class="p">,</span> <span class="n">dec</span><span class="p">,</span> <span class="n">inc</span><span class="p">,</span> <span class="n">st</span><span class="p">,</span> <span class="n">ZI</span><span class="p">])</span>
    <span class="c1"># sort out first_I records</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">idec</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">irec</span><span class="p">[</span><span class="n">dec_key</span><span class="p">])</span>
                <span class="n">iinc</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">irec</span><span class="p">[</span><span class="n">inc_key</span><span class="p">])</span>
                <span class="n">istr</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">irec</span><span class="p">[</span><span class="n">momkey</span><span class="p">])</span>
            <span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Malformed data of some sort for dec/inc/moment in measurement: </span><span class="si">{}</span><span class="s1">.  You must fix this before proceeding.</span><span class="se">\n</span><span class="s1">           Bad record: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">irec</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;measurement&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n">irec</span><span class="p">))</span>
            <span class="n">X</span> <span class="o">=</span> <span class="n">dir2cart</span><span class="p">([</span><span class="n">idec</span><span class="p">,</span> <span class="n">iinc</span><span class="p">,</span> <span class="n">istr</span><span class="p">])</span>
            <span class="n">BL</span> <span class="o">=</span> <span class="n">dir2cart</span><span class="p">([</span><span class="n">dec</span><span class="p">,</span> <span class="n">inc</span><span class="p">,</span> <span class="n">st</span><span class="p">])</span>
            <span class="n">I</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
                <span class="n">I</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">X</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">-</span> <span class="n">BL</span><span class="p">[</span><span class="n">c</span><span class="p">]))</span>
            <span class="k">if</span> <span class="n">I</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">iDir</span> <span class="o">=</span> <span class="n">cart2dir</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">Zdiff</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">first_I</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">temp</span><span class="p">,</span> <span class="n">iDir</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">iDir</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">iDir</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">ZI</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">first_I</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">temp</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">I</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">ZI</span><span class="p">])</span>
                <span class="n">gamma</span> <span class="o">=</span> <span class="n">angle</span><span class="p">([</span><span class="n">iDir</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">iDir</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[</span><span class="n">phi</span><span class="p">,</span> <span class="n">theta</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">first_I</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">temp</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">ZI</span><span class="p">])</span>
                <span class="n">gamma</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="c1"># put in Gamma check (infield trm versus lab field)</span>
            <span class="k">if</span> <span class="mf">180.</span> <span class="o">-</span> <span class="n">gamma</span> <span class="o">&lt;</span> <span class="n">gamma</span><span class="p">:</span>
                <span class="n">gamma</span> <span class="o">=</span> <span class="mf">180.</span> <span class="o">-</span> <span class="n">gamma</span>
            <span class="n">GammaChecks</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">temp</span> <span class="o">-</span> <span class="mf">273.</span><span class="p">,</span> <span class="n">gamma</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">temp</span> <span class="ow">in</span> <span class="n">Treat_PI</span><span class="p">:</span>  <span class="c1"># look through infield steps and find matching Z step</span>
        <span class="n">step</span> <span class="o">=</span> <span class="n">PISteps</span><span class="p">[</span><span class="n">Treat_PI</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">temp</span><span class="p">)]</span>
        <span class="n">rec</span> <span class="o">=</span> <span class="n">datablock</span><span class="p">[</span><span class="n">step</span><span class="p">]</span>
        <span class="n">dec</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="n">dec_key</span><span class="p">])</span>
        <span class="n">inc</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="n">inc_key</span><span class="p">])</span>
        <span class="n">st</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="n">momkey</span><span class="p">])</span>
        <span class="n">brec</span> <span class="o">=</span> <span class="n">datablock</span><span class="p">[</span><span class="n">step</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>  <span class="c1"># take last record as baseline to subtract</span>
        <span class="n">pdec</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">brec</span><span class="p">[</span><span class="n">dec_key</span><span class="p">])</span>
        <span class="n">pinc</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">brec</span><span class="p">[</span><span class="n">inc_key</span><span class="p">])</span>
        <span class="n">pint</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">brec</span><span class="p">[</span><span class="n">momkey</span><span class="p">])</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">dir2cart</span><span class="p">([</span><span class="n">dec</span><span class="p">,</span> <span class="n">inc</span><span class="p">,</span> <span class="n">st</span><span class="p">])</span>
        <span class="n">prevX</span> <span class="o">=</span> <span class="n">dir2cart</span><span class="p">([</span><span class="n">pdec</span><span class="p">,</span> <span class="n">pinc</span><span class="p">,</span> <span class="n">pint</span><span class="p">])</span>
        <span class="n">I</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="n">I</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">-</span> <span class="n">prevX</span><span class="p">[</span><span class="n">c</span><span class="p">])</span>
        <span class="n">dir1</span> <span class="o">=</span> <span class="n">cart2dir</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Zdiff</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">ptrm_check</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">temp</span><span class="p">,</span> <span class="n">dir1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dir1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">dir1</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ptrm_check</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">temp</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">I</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>
<span class="c1"># in case there are zero-field pTRM checks (not the SIO way)</span>
    <span class="k">for</span> <span class="n">temp</span> <span class="ow">in</span> <span class="n">Treat_PZ</span><span class="p">:</span>
        <span class="n">step</span> <span class="o">=</span> <span class="n">PZSteps</span><span class="p">[</span><span class="n">Treat_PZ</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">temp</span><span class="p">)]</span>
        <span class="n">rec</span> <span class="o">=</span> <span class="n">datablock</span><span class="p">[</span><span class="n">step</span><span class="p">]</span>
        <span class="n">dec</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="n">dec_key</span><span class="p">])</span>
        <span class="n">inc</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="n">inc_key</span><span class="p">])</span>
        <span class="n">st</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="n">momkey</span><span class="p">])</span>
        <span class="n">brec</span> <span class="o">=</span> <span class="n">datablock</span><span class="p">[</span><span class="n">step</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">pdec</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">brec</span><span class="p">[</span><span class="n">dec_key</span><span class="p">])</span>
        <span class="n">pinc</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">brec</span><span class="p">[</span><span class="n">inc_key</span><span class="p">])</span>
        <span class="n">pint</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">brec</span><span class="p">[</span><span class="n">momkey</span><span class="p">])</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">dir2cart</span><span class="p">([</span><span class="n">dec</span><span class="p">,</span> <span class="n">inc</span><span class="p">,</span> <span class="n">st</span><span class="p">])</span>
        <span class="n">prevX</span> <span class="o">=</span> <span class="n">dir2cart</span><span class="p">([</span><span class="n">pdec</span><span class="p">,</span> <span class="n">pinc</span><span class="p">,</span> <span class="n">pint</span><span class="p">])</span>
        <span class="n">I</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="n">I</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">-</span> <span class="n">prevX</span><span class="p">[</span><span class="n">c</span><span class="p">])</span>
        <span class="n">dir2</span> <span class="o">=</span> <span class="n">cart2dir</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
        <span class="n">zptrm_check</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">temp</span><span class="p">,</span> <span class="n">dir2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dir2</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">dir2</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>
    <span class="c1"># get pTRM tail checks together -</span>
    <span class="k">for</span> <span class="n">temp</span> <span class="ow">in</span> <span class="n">Treat_M</span><span class="p">:</span>
        <span class="c1"># tail check step - just do a difference in magnitude!</span>
        <span class="n">step</span> <span class="o">=</span> <span class="n">MSteps</span><span class="p">[</span><span class="n">Treat_M</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">temp</span><span class="p">)]</span>
        <span class="n">rec</span> <span class="o">=</span> <span class="n">datablock</span><span class="p">[</span><span class="n">step</span><span class="p">]</span>
        <span class="n">st</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="n">momkey</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">temp</span> <span class="ow">in</span> <span class="n">Treat_Z</span><span class="p">:</span>
            <span class="n">step</span> <span class="o">=</span> <span class="n">ZSteps</span><span class="p">[</span><span class="n">Treat_Z</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">temp</span><span class="p">)]</span>
            <span class="n">brec</span> <span class="o">=</span> <span class="n">datablock</span><span class="p">[</span><span class="n">step</span><span class="p">]</span>
            <span class="n">pint</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">brec</span><span class="p">[</span><span class="n">momkey</span><span class="p">])</span>
<span class="c1">#        X=dir2cart([dec,inc,st])</span>
<span class="c1">#        prevX=dir2cart([pdec,pinc,pint])</span>
<span class="c1">#        I=[]</span>
<span class="c1">#        for c in range(3):I.append(X[c]-prevX[c])</span>
<span class="c1">#        d=cart2dir(I)</span>
<span class="c1">#        ptrm_tail.append([temp,d[0],d[1],d[2]])</span>
            <span class="c1"># difference - if negative, negative tail!</span>
            <span class="n">ptrm_tail</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">temp</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">st</span> <span class="o">-</span> <span class="n">pint</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="n">s</span><span class="p">,</span> <span class="s1">&#39;  has a tail check with no first zero field step - check input file! for step&#39;</span><span class="p">,</span> <span class="n">temp</span> <span class="o">-</span> <span class="mf">273.</span><span class="p">)</span>
<span class="c1">#</span>
<span class="c1"># final check</span>
<span class="c1">#</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">first_Z</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">first_I</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">first_Z</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">first_I</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Something wrong with this specimen! Better fix it or delete it &quot;</span><span class="p">)</span>
        <span class="nb">input</span><span class="p">(</span><span class="s2">&quot; press return to acknowledge message&quot;</span><span class="p">)</span>
    <span class="n">araiblock</span> <span class="o">=</span> <span class="p">(</span><span class="n">first_Z</span><span class="p">,</span> <span class="n">first_I</span><span class="p">,</span> <span class="n">ptrm_check</span><span class="p">,</span>
                 <span class="n">ptrm_tail</span><span class="p">,</span> <span class="n">zptrm_check</span><span class="p">,</span> <span class="n">GammaChecks</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">araiblock</span><span class="p">,</span> <span class="n">field</span></div>


<div class="viewcode-block" id="sortmwarai"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.sortmwarai">[docs]</a><span class="k">def</span> <span class="nf">sortmwarai</span><span class="p">(</span><span class="n">datablock</span><span class="p">,</span> <span class="n">exp_type</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">     sorts microwave double heating data block in to first_Z, first_I, etc.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">first_Z</span><span class="p">,</span> <span class="n">first_I</span><span class="p">,</span> <span class="n">ptrm_check</span><span class="p">,</span> <span class="n">ptrm_tail</span><span class="p">,</span> <span class="n">zptrm_check</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">field</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">theta</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span>
    <span class="n">POWT_I</span><span class="p">,</span> <span class="n">POWT_Z</span><span class="p">,</span> <span class="n">POWT_PZ</span><span class="p">,</span> <span class="n">POWT_PI</span><span class="p">,</span> <span class="n">POWT_M</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">ISteps</span><span class="p">,</span> <span class="n">ZSteps</span><span class="p">,</span> <span class="n">PZSteps</span><span class="p">,</span> <span class="n">PISteps</span><span class="p">,</span> <span class="n">MSteps</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">rad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.</span>
    <span class="n">ThetaChecks</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">DeltaChecks</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">GammaChecks</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># first find all the steps</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">datablock</span><span class="p">)):</span>
        <span class="n">rec</span> <span class="o">=</span> <span class="n">datablock</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="n">powt</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treatment_mw_energy&quot;</span><span class="p">]))</span>
        <span class="n">methcodes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;magic_method_codes&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">meth</span> <span class="ow">in</span> <span class="n">tmp</span><span class="p">:</span>
            <span class="n">methcodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">meth</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
        <span class="k">if</span> <span class="s1">&#39;LT-M-I&#39;</span> <span class="ow">in</span> <span class="n">methcodes</span> <span class="ow">and</span> <span class="s1">&#39;LP-MRM&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">methcodes</span><span class="p">:</span>
            <span class="n">POWT_I</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">powt</span><span class="p">)</span>
            <span class="n">ISteps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">field</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">field</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s1">&#39;treatment_dc_field&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">phi</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">phi</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s1">&#39;treatment_dc_field_phi&#39;</span><span class="p">])</span>
                <span class="n">theta</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s1">&#39;treatment_dc_field_theta&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="s1">&#39;LT-M-Z&#39;</span> <span class="ow">in</span> <span class="n">methcodes</span><span class="p">:</span>
            <span class="n">POWT_Z</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">powt</span><span class="p">)</span>
            <span class="n">ZSteps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;LT-PMRM-Z&#39;</span> <span class="ow">in</span> <span class="n">methcodes</span><span class="p">:</span>
            <span class="n">POWT_PZ</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">powt</span><span class="p">)</span>
            <span class="n">PZSteps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;LT-PMRM-I&#39;</span> <span class="ow">in</span> <span class="n">methcodes</span><span class="p">:</span>
            <span class="n">POWT_PI</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">powt</span><span class="p">)</span>
            <span class="n">PISteps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;LT-PMRM-MD&#39;</span> <span class="ow">in</span> <span class="n">methcodes</span><span class="p">:</span>
            <span class="n">POWT_M</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">powt</span><span class="p">)</span>
            <span class="n">MSteps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;LT-NO&#39;</span> <span class="ow">in</span> <span class="n">methcodes</span><span class="p">:</span>
            <span class="n">dec</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;measurement_dec&quot;</span><span class="p">])</span>
            <span class="n">inc</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;measurement_inc&quot;</span><span class="p">])</span>
            <span class="n">st</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;measurement_magn_moment&quot;</span><span class="p">])</span>
            <span class="n">first_I</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
            <span class="n">first_Z</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">dec</span><span class="p">,</span> <span class="n">inc</span><span class="p">,</span> <span class="n">st</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>  <span class="c1"># NRM step</span>
    <span class="k">if</span> <span class="n">exp_type</span> <span class="o">==</span> <span class="s2">&quot;LP-PI-M-D&quot;</span><span class="p">:</span>
        <span class="c1"># now look trough infield steps and  find matching Z step</span>
        <span class="k">for</span> <span class="n">powt</span> <span class="ow">in</span> <span class="n">POWT_I</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">powt</span> <span class="ow">in</span> <span class="n">POWT_Z</span><span class="p">:</span>
                <span class="n">istep</span> <span class="o">=</span> <span class="n">ISteps</span><span class="p">[</span><span class="n">POWT_I</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">powt</span><span class="p">)]</span>
                <span class="n">irec</span> <span class="o">=</span> <span class="n">datablock</span><span class="p">[</span><span class="n">istep</span><span class="p">]</span>
                <span class="n">methcodes</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">tmp</span> <span class="o">=</span> <span class="n">irec</span><span class="p">[</span><span class="s2">&quot;magic_method_codes&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">meth</span> <span class="ow">in</span> <span class="n">tmp</span><span class="p">:</span>
                    <span class="n">methcodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">meth</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
                <span class="c1"># take last record as baseline to subtract</span>
                <span class="n">brec</span> <span class="o">=</span> <span class="n">datablock</span><span class="p">[</span><span class="n">istep</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
                <span class="n">zstep</span> <span class="o">=</span> <span class="n">ZSteps</span><span class="p">[</span><span class="n">POWT_Z</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">powt</span><span class="p">)]</span>
                <span class="n">zrec</span> <span class="o">=</span> <span class="n">datablock</span><span class="p">[</span><span class="n">zstep</span><span class="p">]</span>
    <span class="c1"># sort out first_Z records</span>
                <span class="k">if</span> <span class="s2">&quot;LP-PI-M-IZ&quot;</span> <span class="ow">in</span> <span class="n">methcodes</span><span class="p">:</span>
                    <span class="n">ZI</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ZI</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">dec</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">zrec</span><span class="p">[</span><span class="s2">&quot;measurement_dec&quot;</span><span class="p">])</span>
                <span class="n">inc</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">zrec</span><span class="p">[</span><span class="s2">&quot;measurement_inc&quot;</span><span class="p">])</span>
                <span class="n">st</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">zrec</span><span class="p">[</span><span class="s2">&quot;measurement_magn_moment&quot;</span><span class="p">])</span>
                <span class="n">first_Z</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">powt</span><span class="p">,</span> <span class="n">dec</span><span class="p">,</span> <span class="n">inc</span><span class="p">,</span> <span class="n">st</span><span class="p">,</span> <span class="n">ZI</span><span class="p">])</span>
    <span class="c1"># sort out first_I records</span>
                <span class="n">idec</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">irec</span><span class="p">[</span><span class="s2">&quot;measurement_dec&quot;</span><span class="p">])</span>
                <span class="n">iinc</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">irec</span><span class="p">[</span><span class="s2">&quot;measurement_inc&quot;</span><span class="p">])</span>
                <span class="n">istr</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">irec</span><span class="p">[</span><span class="s2">&quot;measurement_magn_moment&quot;</span><span class="p">])</span>
                <span class="n">X</span> <span class="o">=</span> <span class="n">dir2cart</span><span class="p">([</span><span class="n">idec</span><span class="p">,</span> <span class="n">iinc</span><span class="p">,</span> <span class="n">istr</span><span class="p">])</span>
                <span class="n">BL</span> <span class="o">=</span> <span class="n">dir2cart</span><span class="p">([</span><span class="n">dec</span><span class="p">,</span> <span class="n">inc</span><span class="p">,</span> <span class="n">st</span><span class="p">])</span>
                <span class="n">I</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
                    <span class="n">I</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">X</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">-</span> <span class="n">BL</span><span class="p">[</span><span class="n">c</span><span class="p">]))</span>
                <span class="n">iDir</span> <span class="o">=</span> <span class="n">cart2dir</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
                <span class="n">first_I</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">powt</span><span class="p">,</span> <span class="n">iDir</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">iDir</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">iDir</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">ZI</span><span class="p">])</span>
<span class="c1"># put in Gamma check (infield trm versus lab field)</span>
                <span class="n">gamma</span> <span class="o">=</span> <span class="n">angle</span><span class="p">([</span><span class="n">iDir</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">iDir</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[</span><span class="n">phi</span><span class="p">,</span> <span class="n">theta</span><span class="p">])</span>
                <span class="n">GammaChecks</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">powt</span><span class="p">,</span> <span class="n">gamma</span><span class="p">])</span>
    <span class="k">elif</span> <span class="n">exp_type</span> <span class="o">==</span> <span class="s2">&quot;LP-PI-M-S&quot;</span><span class="p">:</span>
        <span class="c1"># find last zero field step before first infield step</span>
        <span class="n">lzrec</span> <span class="o">=</span> <span class="n">datablock</span><span class="p">[</span><span class="n">ISteps</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">irec</span> <span class="o">=</span> <span class="n">datablock</span><span class="p">[</span><span class="n">ISteps</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="n">ndec</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">lzrec</span><span class="p">[</span><span class="s2">&quot;measurement_dec&quot;</span><span class="p">])</span>
        <span class="n">ninc</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">lzrec</span><span class="p">[</span><span class="s2">&quot;measurement_inc&quot;</span><span class="p">])</span>
        <span class="n">nstr</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">lzrec</span><span class="p">[</span><span class="s2">&quot;measurement_magn_moment&quot;</span><span class="p">])</span>
        <span class="n">NRM</span> <span class="o">=</span> <span class="n">dir2cart</span><span class="p">([</span><span class="n">ndec</span><span class="p">,</span> <span class="n">ninc</span><span class="p">,</span> <span class="n">nstr</span><span class="p">])</span>
        <span class="n">fdec</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">irec</span><span class="p">[</span><span class="s2">&quot;treatment_dc_field_phi&quot;</span><span class="p">])</span>
        <span class="n">finc</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">irec</span><span class="p">[</span><span class="s2">&quot;treatment_dc_field_theta&quot;</span><span class="p">])</span>
        <span class="n">Flab</span> <span class="o">=</span> <span class="n">dir2cart</span><span class="p">([</span><span class="n">fdec</span><span class="p">,</span> <span class="n">finc</span><span class="p">,</span> <span class="mf">1.</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">ISteps</span><span class="p">:</span>
            <span class="n">irec</span> <span class="o">=</span> <span class="n">datablock</span><span class="p">[</span><span class="n">step</span><span class="p">]</span>
            <span class="n">rdec</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">irec</span><span class="p">[</span><span class="s2">&quot;measurement_dec&quot;</span><span class="p">])</span>
            <span class="n">rinc</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">irec</span><span class="p">[</span><span class="s2">&quot;measurement_inc&quot;</span><span class="p">])</span>
            <span class="n">rstr</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">irec</span><span class="p">[</span><span class="s2">&quot;measurement_magn_moment&quot;</span><span class="p">])</span>
            <span class="n">theta1</span> <span class="o">=</span> <span class="n">angle</span><span class="p">([</span><span class="n">ndec</span><span class="p">,</span> <span class="n">ninc</span><span class="p">],</span> <span class="p">[</span><span class="n">rdec</span><span class="p">,</span> <span class="n">rinc</span><span class="p">])</span>
            <span class="n">theta2</span> <span class="o">=</span> <span class="n">angle</span><span class="p">([</span><span class="n">rdec</span><span class="p">,</span> <span class="n">rinc</span><span class="p">],</span> <span class="p">[</span><span class="n">fdec</span><span class="p">,</span> <span class="n">finc</span><span class="p">])</span>
            <span class="n">powt</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">irec</span><span class="p">[</span><span class="s2">&quot;treatment_mw_energy&quot;</span><span class="p">]))</span>
            <span class="n">ThetaChecks</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">powt</span><span class="p">,</span> <span class="n">theta1</span> <span class="o">+</span> <span class="n">theta2</span><span class="p">])</span>
            <span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="mf">180.</span> <span class="o">-</span> <span class="p">(</span><span class="n">theta1</span> <span class="o">+</span> <span class="n">theta2</span><span class="p">))</span>
            <span class="n">nstr</span> <span class="o">=</span> <span class="n">rstr</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta2</span> <span class="o">*</span> <span class="n">rad</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">p</span> <span class="o">*</span> <span class="n">rad</span><span class="p">))</span>
            <span class="n">tmstr</span> <span class="o">=</span> <span class="n">rstr</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta1</span> <span class="o">*</span> <span class="n">rad</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">p</span> <span class="o">*</span> <span class="n">rad</span><span class="p">))</span>
            <span class="n">first_Z</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">powt</span><span class="p">,</span> <span class="n">ndec</span><span class="p">,</span> <span class="n">ninc</span><span class="p">,</span> <span class="n">nstr</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
            <span class="n">first_I</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">powt</span><span class="p">,</span> <span class="n">dec</span><span class="p">,</span> <span class="n">inc</span><span class="p">,</span> <span class="n">tmstr</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="c1"># check if zero field steps are parallel to assumed NRM</span>
        <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">ZSteps</span><span class="p">:</span>
            <span class="n">zrec</span> <span class="o">=</span> <span class="n">datablock</span><span class="p">[</span><span class="n">step</span><span class="p">]</span>
            <span class="n">powt</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">zrec</span><span class="p">[</span><span class="s2">&quot;treatment_mw_energy&quot;</span><span class="p">]))</span>
            <span class="n">zdec</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">zrec</span><span class="p">[</span><span class="s2">&quot;measurement_dec&quot;</span><span class="p">])</span>
            <span class="n">zinc</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">zrec</span><span class="p">[</span><span class="s2">&quot;measurement_inc&quot;</span><span class="p">])</span>
            <span class="n">delta</span> <span class="o">=</span> <span class="n">angle</span><span class="p">([</span><span class="n">ndec</span><span class="p">,</span> <span class="n">ninc</span><span class="p">],</span> <span class="p">[</span><span class="n">zdec</span><span class="p">,</span> <span class="n">zinc</span><span class="p">])</span>
            <span class="n">DeltaChecks</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">powt</span><span class="p">,</span> <span class="n">delta</span><span class="p">])</span>
    <span class="c1"># get pTRMs together - take previous record and subtract</span>
    <span class="k">for</span> <span class="n">powt</span> <span class="ow">in</span> <span class="n">POWT_PI</span><span class="p">:</span>
        <span class="n">step</span> <span class="o">=</span> <span class="n">PISteps</span><span class="p">[</span><span class="n">POWT_PI</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">powt</span><span class="p">)]</span>
        <span class="n">rec</span> <span class="o">=</span> <span class="n">datablock</span><span class="p">[</span><span class="n">step</span><span class="p">]</span>
        <span class="n">dec</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;measurement_dec&quot;</span><span class="p">])</span>
        <span class="n">inc</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;measurement_inc&quot;</span><span class="p">])</span>
        <span class="n">st</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;measurement_magn_moment&quot;</span><span class="p">])</span>
        <span class="n">brec</span> <span class="o">=</span> <span class="n">datablock</span><span class="p">[</span><span class="n">step</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>  <span class="c1"># take last record as baseline to subtract</span>
        <span class="n">pdec</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">brec</span><span class="p">[</span><span class="s2">&quot;measurement_dec&quot;</span><span class="p">])</span>
        <span class="n">pinc</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">brec</span><span class="p">[</span><span class="s2">&quot;measurement_inc&quot;</span><span class="p">])</span>
        <span class="n">pint</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">brec</span><span class="p">[</span><span class="s2">&quot;measurement_magn_moment&quot;</span><span class="p">])</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">dir2cart</span><span class="p">([</span><span class="n">dec</span><span class="p">,</span> <span class="n">inc</span><span class="p">,</span> <span class="n">st</span><span class="p">])</span>
        <span class="n">prevX</span> <span class="o">=</span> <span class="n">dir2cart</span><span class="p">([</span><span class="n">pdec</span><span class="p">,</span> <span class="n">pinc</span><span class="p">,</span> <span class="n">pint</span><span class="p">])</span>
        <span class="n">I</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="n">I</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">-</span> <span class="n">prevX</span><span class="p">[</span><span class="n">c</span><span class="p">])</span>
        <span class="n">dir1</span> <span class="o">=</span> <span class="n">cart2dir</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
        <span class="n">ptrm_check</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">powt</span><span class="p">,</span> <span class="n">dir1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dir1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">dir1</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>
    <span class="c1"># get zero field pTRM  checks together</span>
    <span class="k">for</span> <span class="n">powt</span> <span class="ow">in</span> <span class="n">POWT_PZ</span><span class="p">:</span>
        <span class="n">step</span> <span class="o">=</span> <span class="n">PZSteps</span><span class="p">[</span><span class="n">POWT_PZ</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">powt</span><span class="p">)]</span>
        <span class="n">rec</span> <span class="o">=</span> <span class="n">datablock</span><span class="p">[</span><span class="n">step</span><span class="p">]</span>
        <span class="n">dec</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;measurement_dec&quot;</span><span class="p">])</span>
        <span class="n">inc</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;measurement_inc&quot;</span><span class="p">])</span>
        <span class="n">st</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;measurement_magn_moment&quot;</span><span class="p">])</span>
        <span class="n">brec</span> <span class="o">=</span> <span class="n">datablock</span><span class="p">[</span><span class="n">step</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">pdec</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">brec</span><span class="p">[</span><span class="s2">&quot;measurement_dec&quot;</span><span class="p">])</span>
        <span class="n">pinc</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">brec</span><span class="p">[</span><span class="s2">&quot;measurement_inc&quot;</span><span class="p">])</span>
        <span class="n">pint</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">brec</span><span class="p">[</span><span class="s2">&quot;measurement_magn_moment&quot;</span><span class="p">])</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">dir2cart</span><span class="p">([</span><span class="n">dec</span><span class="p">,</span> <span class="n">inc</span><span class="p">,</span> <span class="n">st</span><span class="p">])</span>
        <span class="n">prevX</span> <span class="o">=</span> <span class="n">dir2cart</span><span class="p">([</span><span class="n">pdec</span><span class="p">,</span> <span class="n">pinc</span><span class="p">,</span> <span class="n">pint</span><span class="p">])</span>
        <span class="n">I</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="n">I</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">-</span> <span class="n">prevX</span><span class="p">[</span><span class="n">c</span><span class="p">])</span>
        <span class="n">dir2</span> <span class="o">=</span> <span class="n">cart2dir</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
        <span class="n">zptrm_check</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">powt</span><span class="p">,</span> <span class="n">dir2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dir2</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">dir2</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>
    <span class="c1"># get pTRM tail checks together -</span>
    <span class="k">for</span> <span class="n">powt</span> <span class="ow">in</span> <span class="n">POWT_M</span><span class="p">:</span>
        <span class="n">step</span> <span class="o">=</span> <span class="n">MSteps</span><span class="p">[</span><span class="n">POWT_M</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">powt</span><span class="p">)]</span>  <span class="c1"># tail check step</span>
        <span class="n">rec</span> <span class="o">=</span> <span class="n">datablock</span><span class="p">[</span><span class="n">step</span><span class="p">]</span>
<span class="c1">#        dec=float(rec[&quot;measurement_dec&quot;])</span>
<span class="c1">#        inc=float(rec[&quot;measurement_inc&quot;])</span>
        <span class="n">st</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;measurement_magn_moment&quot;</span><span class="p">])</span>
        <span class="n">step</span> <span class="o">=</span> <span class="n">ZSteps</span><span class="p">[</span><span class="n">POWT_Z</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">powt</span><span class="p">)]</span>
        <span class="n">brec</span> <span class="o">=</span> <span class="n">datablock</span><span class="p">[</span><span class="n">step</span><span class="p">]</span>
<span class="c1">#        pdec=float(brec[&quot;measurement_dec&quot;])</span>
<span class="c1">#        pinc=float(brec[&quot;measurement_inc&quot;])</span>
        <span class="n">pint</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">brec</span><span class="p">[</span><span class="s2">&quot;measurement_magn_moment&quot;</span><span class="p">])</span>
<span class="c1">#        X=dir2cart([dec,inc,st])</span>
<span class="c1">#        prevX=dir2cart([pdec,pinc,pint])</span>
<span class="c1">#        I=[]</span>
<span class="c1">#        for c in range(3):I.append(X[c]-prevX[c])</span>
<span class="c1">#        d=cart2dir(I)</span>
 <span class="c1">#       ptrm_tail.append([powt,d[0],d[1],d[2]])</span>
        <span class="c1"># just do absolute magnitude difference # not vector diff</span>
        <span class="n">ptrm_tail</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">powt</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">st</span> <span class="o">-</span> <span class="n">pint</span><span class="p">])</span>
    <span class="c1">#  check</span>
    <span class="c1">#</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">first_Z</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">first_I</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">first_Z</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">first_I</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Something wrong with this specimen! Better fix it or delete it &quot;</span><span class="p">)</span>
            <span class="nb">input</span><span class="p">(</span><span class="s2">&quot; press return to acknowledge message&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">MaxRec</span><span class="p">)</span>
    <span class="n">araiblock</span> <span class="o">=</span> <span class="p">(</span><span class="n">first_Z</span><span class="p">,</span> <span class="n">first_I</span><span class="p">,</span> <span class="n">ptrm_check</span><span class="p">,</span> <span class="n">ptrm_tail</span><span class="p">,</span>
                 <span class="n">zptrm_check</span><span class="p">,</span> <span class="n">GammaChecks</span><span class="p">,</span> <span class="n">ThetaChecks</span><span class="p">,</span> <span class="n">DeltaChecks</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">araiblock</span><span class="p">,</span> <span class="n">field</span></div>

    <span class="c1">#</span>


<div class="viewcode-block" id="docustom"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.docustom">[docs]</a><span class="k">def</span> <span class="nf">docustom</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">alt</span><span class="p">,</span> <span class="n">gh</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Passes the coefficients to the Malin and Barraclough</span>
<span class="sd">    routine (function pmag.magsyn) to calculate the field from the coefficients.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    lon : east longitude in degrees (0 to 360 or -180 to 180)</span>
<span class="sd">    lat : latitude in degrees (-90 to 90)</span>
<span class="sd">    alt : height above mean sea level in km (itype = 1 assumed)</span>
<span class="sd">    gh : list of gauss coefficients</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    x : north component of the magnetic field in nT</span>
<span class="sd">    y : east component of the magnetic field in nT</span>
<span class="sd">    z : downward component of the magnetic field in nT</span>
<span class="sd">    f : total magnetic field in nT</span>
<span class="sd">    </span>
<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; gh = pmag.doigrf(30,70,10,2022,coeffs=True)</span>
<span class="sd">    &gt;&gt;&gt; pmag.docustom(30,70,10,gh)</span>
<span class="sd">    (10033.695088989529, 2822.610862622648, 53170.834174096184, 54182.8365443324)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">model</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">itype</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
    <span class="n">sv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">gh</span><span class="p">))</span>
    <span class="n">colat</span> <span class="o">=</span> <span class="mf">90.</span> <span class="o">-</span> <span class="n">lat</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">f</span> <span class="o">=</span> <span class="n">magsyn</span><span class="p">(</span><span class="n">gh</span><span class="p">,</span> <span class="n">sv</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">itype</span><span class="p">,</span> <span class="n">alt</span><span class="p">,</span> <span class="n">colat</span><span class="p">,</span> <span class="n">lon</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">f</span></div>


<div class="viewcode-block" id="doigrf"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.doigrf">[docs]</a><span class="k">def</span> <span class="nf">doigrf</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">alt</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the interpolated (&lt;=2020) or extrapolated (&gt;2020) main field and</span>
<span class="sd">    secular variation coefficients and passes them to the Malin and Barraclough</span>
<span class="sd">    routine (function pmag.magsyn) to calculate the field from the coefficients.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    lon : east longitude in degrees (0 to 360 or -180 to 180)</span>
<span class="sd">    lat : latitude in degrees (-90 to 90)</span>
<span class="sd">    alt : height above mean sea level in km (itype = 1 assumed)</span>
<span class="sd">    date : Required date in years and decimals of a year (A.D.)</span>

<span class="sd">    Optional Parameters</span>
<span class="sd">    -------------------</span>
<span class="sd">    coeffs : if True, then return the gh coefficients</span>
<span class="sd">    mod  : model to use (&#39;arch3k&#39;,&#39;cals3k&#39;,&#39;pfm9k&#39;,&#39;hfm10k&#39;,&#39;cals10k.2&#39;,&#39;cals10k.1b&#39;,&#39;shadif14k&#39;,&#39;shawq2k&#39;,&#39;shawqIA&#39;)</span>
<span class="sd">        arch3k (Korte et al., 2009)</span>
<span class="sd">        cals3k (Korte and Constable, 2011)</span>
<span class="sd">        cals10k.1b (Korte et al., 2011)</span>
<span class="sd">        pfm9k  (Nilsson et al., 2014)</span>
<span class="sd">        hfm.OL1.A1 (Constable et al., 2016)</span>
<span class="sd">        cals10k.2 (Constable et al., 2016)</span>
<span class="sd">        shadif14k (Pavon-Carrasco et al., 2014)</span>
<span class="sd">        shawq2k (Campuzano et al., 2019)</span>
<span class="sd">        shawqIA (Osete et al., 2020)</span>
<span class="sd">        ggf100k (Panofska et al., 2018) [in 200 year increments from -99950 to 1850 only]</span>
<span class="sd">          NB : the first four of these models, are constrained to agree</span>
<span class="sd">               with gufm1 (Jackson et al., 2000) for the past four centuries</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    x : north component of the magnetic field in nT</span>
<span class="sd">    y : east component of the magnetic field in nT</span>
<span class="sd">    z : downward component of the magnetic field in nT</span>
<span class="sd">    f : total magnetic field in nT</span>
<span class="sd">    gh : list of gauss coefficients</span>
<span class="sd">        only if coeffs=True</span>

<span class="sd">    By default, igrf13 coefficients are used between 1900 and 2020</span>
<span class="sd">    from http://www.ngdc.noaa.gov/IAGA/vmod/igrf.html.</span>


<span class="sd">    To check the results you can run the interactive program at the NGDC</span>
<span class="sd">    www.ngdc.noaa.gov/geomag-web</span>
<span class="sd">    </span>
<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; pmag.doigrf(30,70,10,2022)</span>
<span class="sd">    (10030.985358058582, 2797.0490284010084, 53258.99275624336, 54267.52675339505)</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; pmag.doigrf(30,70,10,2022,coeffs=True)</span>
<span class="sd">    array([-2.94048e+04, -1.45090e+03,  4.65250e+03, -2.49960e+03,</span>
<span class="sd">        2.98200e+03, -2.99160e+03,  1.67700e+03, -7.34600e+02,</span>
<span class="sd">        1.36320e+03, -2.38120e+03, -8.21000e+01,  1.23620e+03,</span>
<span class="sd">        2.41900e+02,  5.25700e+02, -5.43400e+02,  9.03000e+02,</span>
<span class="sd">        8.09500e+02,  2.81900e+02,  8.63000e+01, -1.58400e+02,</span>
<span class="sd">       -3.09400e+02,  1.99700e+02,  4.80000e+01, -3.49700e+02, ...</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">coefficients</span> <span class="k">as</span> <span class="n">cf</span>
    <span class="n">gh</span><span class="p">,</span> <span class="n">sv</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">colat</span> <span class="o">=</span> <span class="mf">90.</span> <span class="o">-</span> <span class="n">lat</span>
<span class="c1">#! convert to colatitude for MB routine</span>
    <span class="k">if</span> <span class="n">lon</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">lon</span> <span class="o">=</span> <span class="n">lon</span> <span class="o">+</span> <span class="mf">360.</span>
<span class="c1"># ensure all positive east longitudes</span>
    <span class="n">itype</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">models</span><span class="p">,</span> <span class="n">igrf13coeffs</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">get_igrf13</span><span class="p">()</span>
    <span class="c1">#models, igrf12coeffs = cf.get_igrf12()</span>
    <span class="k">if</span> <span class="s1">&#39;mod&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="k">if</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;mod&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;arch3k&#39;</span><span class="p">:</span>
            <span class="n">psvmodels</span><span class="p">,</span> <span class="n">psvcoeffs</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">get_arch3k</span><span class="p">()</span>  <span class="c1"># use ARCH3k coefficients</span>
        <span class="k">elif</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;mod&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;cals3k&#39;</span><span class="p">:</span>
            <span class="c1"># use CALS3K_4b coefficients between -1000,1940</span>
            <span class="n">psvmodels</span><span class="p">,</span> <span class="n">psvcoeffs</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">get_cals3k</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;mod&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;pfm9k&#39;</span><span class="p">:</span>
            <span class="c1"># use PFM9k (Nilsson et al., 2014), coefficients from -7000 to 1900</span>
            <span class="n">psvmodels</span><span class="p">,</span> <span class="n">psvcoeffs</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">get_pfm9k</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;mod&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;hfm10k&#39;</span><span class="p">:</span>
            <span class="c1"># use HFM.OL1.A1 (Constable et al., 2016), coefficients from -8000</span>
            <span class="c1"># to 1900</span>
            <span class="n">psvmodels</span><span class="p">,</span> <span class="n">psvcoeffs</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">get_hfm10k</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;mod&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;cals10k.2&#39;</span><span class="p">:</span>
            <span class="c1"># use CALS10k.2 (Constable et al., 2016), coefficients from -8000</span>
            <span class="c1"># to 1900</span>
            <span class="n">psvmodels</span><span class="p">,</span> <span class="n">psvcoeffs</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">get_cals10k_2</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;mod&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;shadif14k&#39;</span><span class="p">:</span>
            <span class="c1"># use CALS10k.2 (Constable et al., 2016), coefficients from -8000</span>
            <span class="c1"># to 1900</span>
            <span class="n">psvmodels</span><span class="p">,</span> <span class="n">psvcoeffs</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">get_shadif14k</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;mod&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;shawq2k&#39;</span><span class="p">:</span>
            <span class="n">psvmodels</span><span class="p">,</span> <span class="n">psvcoeffs</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">get_shawq2k</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;mod&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;shawqIA&#39;</span><span class="p">:</span>
            <span class="n">psvmodels</span><span class="p">,</span> <span class="n">psvcoeffs</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">get_shawqIA</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;mod&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;ggf100k&#39;</span><span class="p">:</span>
            <span class="n">psvmodels</span><span class="p">,</span> <span class="n">psvcoeffs</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">get_ggf100k</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Korte and Constable, 2011;  use prior to -1000, back to -8000</span>
            <span class="n">psvmodels</span><span class="p">,</span> <span class="n">psvcoeffs</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">get_cals10k</span><span class="p">()</span>
<span class="c1"># use geodetic coordinates</span>
    <span class="k">if</span> <span class="s1">&#39;models&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;mod&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="k">return</span> <span class="n">psvmodels</span><span class="p">,</span> <span class="n">psvcoeffs</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">models</span><span class="p">,</span> <span class="n">igrf13coeffs</span>
    <span class="k">if</span> <span class="n">date</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">100000</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;too old&#39;</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="k">if</span> <span class="s1">&#39;mod&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;mod&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;ggf100k&#39;</span><span class="p">:</span>
        <span class="n">incr</span> <span class="o">=</span> <span class="mi">200</span>
        <span class="c1">#model = date - date % incr</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">date</span>
        <span class="n">gh</span> <span class="o">=</span> <span class="n">psvcoeffs</span><span class="p">[</span><span class="n">psvmodels</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">model</span><span class="p">))]</span>
        <span class="n">sv</span> <span class="o">=</span> <span class="p">(</span><span class="n">psvcoeffs</span><span class="p">[</span><span class="n">psvmodels</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">model</span> <span class="o">+</span> <span class="n">incr</span><span class="p">))]</span> <span class="o">-</span> <span class="n">gh</span><span class="p">)</span><span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">incr</span><span class="p">)</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">f</span> <span class="o">=</span> <span class="n">magsyn</span><span class="p">(</span><span class="n">gh</span><span class="p">,</span> <span class="n">sv</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">itype</span><span class="p">,</span> <span class="n">alt</span><span class="p">,</span> <span class="n">colat</span><span class="p">,</span> <span class="n">lon</span><span class="p">)</span>
    <span class="k">elif</span> <span class="s1">&#39;mod&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;mod&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;shadif14k&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">date</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">10000</span><span class="p">:</span>
            <span class="n">incr</span> <span class="o">=</span> <span class="mi">100</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">incr</span> <span class="o">=</span> <span class="mi">50</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">date</span> <span class="o">-</span> <span class="n">date</span> <span class="o">%</span> <span class="n">incr</span>
        <span class="n">gh</span> <span class="o">=</span> <span class="n">psvcoeffs</span><span class="p">[</span><span class="n">psvmodels</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">model</span><span class="p">))]</span>
        <span class="n">sv</span> <span class="o">=</span> <span class="p">(</span><span class="n">psvcoeffs</span><span class="p">[</span><span class="n">psvmodels</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">model</span> <span class="o">+</span> <span class="n">incr</span><span class="p">))]</span> <span class="o">-</span> <span class="n">gh</span><span class="p">)</span><span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">incr</span><span class="p">)</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">f</span> <span class="o">=</span> <span class="n">magsyn</span><span class="p">(</span><span class="n">gh</span><span class="p">,</span> <span class="n">sv</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">itype</span><span class="p">,</span> <span class="n">alt</span><span class="p">,</span> <span class="n">colat</span><span class="p">,</span> <span class="n">lon</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">date</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">1000</span><span class="p">:</span>
        <span class="n">incr</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">date</span> <span class="o">-</span> <span class="n">date</span> <span class="o">%</span> <span class="n">incr</span>
        <span class="n">gh</span> <span class="o">=</span> <span class="n">psvcoeffs</span><span class="p">[</span><span class="n">psvmodels</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">model</span><span class="p">))]</span>
        <span class="n">sv</span> <span class="o">=</span> <span class="p">(</span><span class="n">psvcoeffs</span><span class="p">[</span><span class="n">psvmodels</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">model</span> <span class="o">+</span> <span class="n">incr</span><span class="p">))]</span> <span class="o">-</span> <span class="n">gh</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">incr</span><span class="p">)</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">f</span> <span class="o">=</span> <span class="n">magsyn</span><span class="p">(</span><span class="n">gh</span><span class="p">,</span> <span class="n">sv</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">itype</span><span class="p">,</span> <span class="n">alt</span><span class="p">,</span> <span class="n">colat</span><span class="p">,</span> <span class="n">lon</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">date</span> <span class="o">&lt;</span> <span class="mi">1900</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;mod&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;cals10k&#39;</span><span class="p">:</span>
            <span class="n">incr</span> <span class="o">=</span> <span class="mi">50</span>
        <span class="k">elif</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;mod&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;shawq2k&#39;</span> <span class="ow">or</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;mod&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;shawqIA&#39;</span><span class="p">:</span>
            <span class="n">incr</span> <span class="o">=</span> <span class="mi">25</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">incr</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="n">model</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">date</span> <span class="o">-</span> <span class="n">date</span> <span class="o">%</span> <span class="n">incr</span><span class="p">)</span>
        <span class="n">gh</span> <span class="o">=</span> <span class="n">psvcoeffs</span><span class="p">[</span><span class="n">psvmodels</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">model</span><span class="p">)]</span>
        <span class="k">if</span> <span class="n">model</span> <span class="o">+</span> <span class="n">incr</span> <span class="o">&lt;</span> <span class="mi">1900</span><span class="p">:</span>
            <span class="n">sv</span> <span class="o">=</span> <span class="p">(</span><span class="n">psvcoeffs</span><span class="p">[</span><span class="n">psvmodels</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">model</span> <span class="o">+</span> <span class="n">incr</span><span class="p">)]</span> <span class="o">-</span> <span class="n">gh</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">incr</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">field2</span> <span class="o">=</span> <span class="n">igrf13coeffs</span><span class="p">[</span><span class="n">models</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="mi">1940</span><span class="p">)][</span><span class="mi">0</span><span class="p">:</span><span class="mi">120</span><span class="p">]</span>
            <span class="n">sv</span> <span class="o">=</span> <span class="p">(</span><span class="n">field2</span> <span class="o">-</span> <span class="n">gh</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">1940</span> <span class="o">-</span> <span class="n">model</span><span class="p">)</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">f</span> <span class="o">=</span> <span class="n">magsyn</span><span class="p">(</span><span class="n">gh</span><span class="p">,</span> <span class="n">sv</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">itype</span><span class="p">,</span> <span class="n">alt</span><span class="p">,</span> <span class="n">colat</span><span class="p">,</span> <span class="n">lon</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">date</span> <span class="o">-</span> <span class="n">date</span> <span class="o">%</span> <span class="mi">5</span>
        <span class="k">if</span> <span class="n">date</span> <span class="o">&lt;=</span><span class="mi">2025</span><span class="p">:</span>
            <span class="n">gh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">igrf13coeffs</span><span class="p">[</span><span class="n">models</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">model</span><span class="p">)])</span>
            <span class="k">if</span> <span class="n">date</span><span class="o">&lt;</span><span class="mi">2025</span><span class="p">:</span>
                <span class="n">sv</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">igrf13coeffs</span><span class="p">[</span><span class="n">models</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">model</span> <span class="o">+</span> <span class="mi">5</span><span class="p">)])</span> <span class="o">-</span> <span class="n">gh</span><span class="p">)</span><span class="o">/</span><span class="mf">5.</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">sv</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">igrf13coeffs</span><span class="p">[</span><span class="n">models</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">model</span><span class="p">)])))</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">f</span> <span class="o">=</span> <span class="n">magsyn</span><span class="p">(</span><span class="n">gh</span><span class="p">,</span> <span class="n">sv</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">itype</span><span class="p">,</span> <span class="n">alt</span><span class="p">,</span> <span class="n">colat</span><span class="p">,</span> <span class="n">lon</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;model not available past 2025&#39;</span><span class="p">)</span>
            <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">f</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span>
        <span class="c1">#    gh = igrf13coeffs[models.index(2020)]</span>
        <span class="c1">#    sv = np.array(igrf13coeffs[models.index(2020.2)])</span>
        <span class="c1">#    x, y, z, f = magsyn(gh, sv, model, date, itype, alt, colat, lon)</span>
    <span class="k">if</span> <span class="s1">&#39;coeffs&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="k">return</span> <span class="n">gh</span>
    <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">f</span></div>
<span class="c1">#</span>


<div class="viewcode-block" id="unpack"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.unpack">[docs]</a><span class="k">def</span> <span class="nf">unpack</span><span class="p">(</span><span class="n">gh</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Unpacks gh list into l m g h type list.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    gh : list of gauss coefficients (as returned by, e.g., doigrf)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    data : nested list of [[l,m,g,h],...]</span>
<span class="sd">    </span>
<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; gh = pmag.doigrf(30,70,10,2022,coeffs=True)</span>
<span class="sd">    &gt;&gt;&gt; pmag.unpack(gh)</span>
<span class="sd">    [[1, 0, -29404.8, 0],</span>
<span class="sd">     [1, 1, -1450.9, 4652.5],</span>
<span class="sd">     [2, 0, -2499.6, 0],</span>
<span class="sd">     [2, 1, 2982.0, -2991.6],</span>
<span class="sd">     [2, 2, 1677.0, -734.6],</span>
<span class="sd">     [3, 0, 1363.2, 0],</span>
<span class="sd">     [3, 1, -2381.2, -82.1],</span>
<span class="sd">     [3, 2, 1236.2, 241.9],</span>
<span class="sd">     [3, 3, 525.7, -543.4], ...</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">k</span><span class="p">,</span> <span class="n">l</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
    <span class="k">while</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">gh</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">m</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">l</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">gh</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="mi">0</span><span class="p">])</span>
                <span class="n">k</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">l</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">gh</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">gh</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]])</span>
                <span class="n">k</span> <span class="o">+=</span> <span class="mi">2</span>
        <span class="n">l</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">data</span></div>


<div class="viewcode-block" id="magsyn"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.magsyn">[docs]</a><span class="k">def</span> <span class="nf">magsyn</span><span class="p">(</span><span class="n">gh</span><span class="p">,</span> <span class="n">sv</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">itype</span><span class="p">,</span> <span class="n">alt</span><span class="p">,</span> <span class="n">colat</span><span class="p">,</span> <span class="n">elong</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes x, y, z, and f for a given date and position, from the</span>
<span class="sd">    spherical harmonic coefficients of the International Geomagnetic</span>
<span class="sd">    Reference Field (IGRF).</span>
<span class="sd">    From Malin and Barraclough (1981), Computers and Geosciences, V.7, 401-405.</span>
<span class="sd"> </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    gh : main field values for date (calc. in igrf subroutine)</span>
<span class="sd">    sv : secular variation coefficients (calc. in igrf subroutine)</span>
<span class="sd">    b : date of dgrf (or igrf) field prior to required date</span>
<span class="sd">    date : Required date in years and decimals of a year (A.D.)</span>
<span class="sd">    itype : 1, if geodetic coordinates are used, 2 if geocentric</span>
<span class="sd">    alt : itype = 1 : height above mean sea level in km </span>
<span class="sd">          itype = 2 : radial distance from the center of the earth </span>
<span class="sd">    colat : colatitude in degrees (0 to 180)</span>
<span class="sd">    elong : east longitude in degrees (0 to 360)</span>
<span class="sd"> </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    x : north component of the magnetic force in nT</span>
<span class="sd">    y : east component of the magnetic force in nT</span>
<span class="sd">    z : downward component of the magnetic force in nT</span>
<span class="sd">    f : total magnetic force in nT</span>
<span class="sd">        </span>
<span class="sd">    note: the coordinate system for x,y, and z is the same as that specified by itype</span>
<span class="sd">    &quot;&quot;&quot;</span>
<span class="c1"># Modified 4/9/97 to use DGRFs from 1945 to 1990 IGRF</span>
<span class="c1"># Modified 10/13/06 to use  1995 DGRF, 2005 IGRF and sv coefficient</span>
<span class="c1"># for extrapolation beyond 2005. Coefficients from Barton et al. PEPI, 97: 23-26</span>
<span class="c1"># (1996), via web site for NOAA, World Data Center A. Modified to use</span>
<span class="c1">#degree and</span>
<span class="c1"># order 10 as per notes in Malin and Barraclough (1981).</span>
<span class="c1"># coefficients for DGRF 1995 and IGRF 2005 are from http://nssdcftp.gsfc.nasa.gov/models/geomagnetic/igrf/fortran_code/</span>
<span class="c1"># igrf subroutine calculates</span>
<span class="c1"># the proper main field and secular variation coefficients (interpolated between</span>
<span class="c1"># dgrf values or extrapolated from 1995 sv values as appropriate).</span>

<span class="c1">#</span>
<span class="c1">#       real gh(120),sv(120),p(66),q(66),cl(10),sl(10)</span>
<span class="c1">#               real begin,dateq</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">66</span><span class="p">),</span> <span class="s1">&#39;f&#39;</span><span class="p">)</span>
    <span class="n">q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">66</span><span class="p">),</span> <span class="s1">&#39;f&#39;</span><span class="p">)</span>
    <span class="n">cl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">10</span><span class="p">),</span> <span class="s1">&#39;f&#39;</span><span class="p">)</span>
    <span class="n">sl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">10</span><span class="p">),</span> <span class="s1">&#39;f&#39;</span><span class="p">)</span>
    <span class="n">begin</span> <span class="o">=</span> <span class="n">b</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">date</span> <span class="o">-</span> <span class="n">begin</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">alt</span>
    <span class="n">one</span> <span class="o">=</span> <span class="n">colat</span> <span class="o">*</span> <span class="mf">0.0174532925</span>
    <span class="n">ct</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">one</span><span class="p">)</span>
    <span class="n">st</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">one</span><span class="p">)</span>
    <span class="n">one</span> <span class="o">=</span> <span class="n">elong</span> <span class="o">*</span> <span class="mf">0.0174532925</span>
    <span class="n">cl</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">one</span><span class="p">)</span>
    <span class="n">sl</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">one</span><span class="p">)</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span>
    <span class="n">cd</span><span class="p">,</span> <span class="n">sd</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span>
    <span class="n">l</span><span class="p">,</span> <span class="n">ll</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">itype</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="c1">#</span>
        <span class="c1"># if required, convert from geodectic to geocentric</span>
        <span class="n">a2</span> <span class="o">=</span> <span class="mf">40680925.0</span>
        <span class="n">b2</span> <span class="o">=</span> <span class="mf">40408585.0</span>
        <span class="n">one</span> <span class="o">=</span> <span class="n">a2</span> <span class="o">*</span> <span class="n">st</span> <span class="o">*</span> <span class="n">st</span>
        <span class="n">two</span> <span class="o">=</span> <span class="n">b2</span> <span class="o">*</span> <span class="n">ct</span> <span class="o">*</span> <span class="n">ct</span>
        <span class="n">three</span> <span class="o">=</span> <span class="n">one</span> <span class="o">+</span> <span class="n">two</span>
        <span class="n">rho</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">three</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">alt</span> <span class="o">*</span> <span class="p">(</span><span class="n">alt</span> <span class="o">+</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">rho</span><span class="p">)</span> <span class="o">+</span>
                    <span class="n">old_div</span><span class="p">((</span><span class="n">a2</span> <span class="o">*</span> <span class="n">one</span> <span class="o">+</span> <span class="n">b2</span> <span class="o">*</span> <span class="n">two</span><span class="p">),</span> <span class="n">three</span><span class="p">))</span>
        <span class="n">cd</span> <span class="o">=</span> <span class="n">old_div</span><span class="p">((</span><span class="n">alt</span> <span class="o">+</span> <span class="n">rho</span><span class="p">),</span> <span class="n">r</span><span class="p">)</span>
        <span class="n">sd</span> <span class="o">=</span> <span class="p">(</span><span class="n">a2</span> <span class="o">-</span> <span class="n">b2</span><span class="p">)</span> <span class="o">/</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">ct</span> <span class="o">*</span> <span class="n">st</span> <span class="o">/</span> <span class="n">r</span>
        <span class="n">one</span> <span class="o">=</span> <span class="n">ct</span>
        <span class="n">ct</span> <span class="o">=</span> <span class="n">ct</span> <span class="o">*</span> <span class="n">cd</span> <span class="o">-</span> <span class="n">st</span> <span class="o">*</span> <span class="n">sd</span>
        <span class="n">st</span> <span class="o">=</span> <span class="n">st</span> <span class="o">*</span> <span class="n">cd</span> <span class="o">+</span> <span class="n">one</span> <span class="o">*</span> <span class="n">sd</span>
    <span class="n">ratio</span> <span class="o">=</span> <span class="n">old_div</span><span class="p">(</span><span class="mf">6371.2</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
    <span class="n">rr</span> <span class="o">=</span> <span class="n">ratio</span> <span class="o">*</span> <span class="n">ratio</span>
<span class="c1">#</span>
<span class="c1"># compute Schmidt quasi-normal coefficients p and x(=q)</span>
    <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">st</span>
    <span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">q</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">ct</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">66</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="n">m</span><span class="p">:</span>   <span class="c1"># else go to 2</span>
            <span class="n">m</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">rr</span> <span class="o">=</span> <span class="n">rr</span> <span class="o">*</span> <span class="n">ratio</span>
            <span class="n">fn</span> <span class="o">=</span> <span class="n">n</span>
            <span class="n">gn</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span>
<span class="c1"># 2</span>
        <span class="n">fm</span> <span class="o">=</span> <span class="n">m</span>
        <span class="k">if</span> <span class="n">k</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>  <span class="c1"># else go to 4</span>
            <span class="k">if</span> <span class="n">m</span> <span class="o">==</span> <span class="n">n</span><span class="p">:</span>   <span class="c1"># else go to 3</span>
                <span class="n">one</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">old_div</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">fm</span><span class="p">))</span>
                <span class="n">j</span> <span class="o">=</span> <span class="n">k</span> <span class="o">-</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span>
                <span class="n">p</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">one</span> <span class="o">*</span> <span class="n">st</span> <span class="o">*</span> <span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                <span class="n">q</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">one</span> <span class="o">*</span> <span class="p">(</span><span class="n">st</span> <span class="o">*</span> <span class="n">q</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">ct</span> <span class="o">*</span> <span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
                <span class="n">cl</span><span class="p">[</span><span class="n">m</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">cl</span><span class="p">[</span><span class="n">m</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">cl</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">sl</span><span class="p">[</span><span class="n">m</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">sl</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">sl</span><span class="p">[</span><span class="n">m</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">sl</span><span class="p">[</span><span class="n">m</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">cl</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">cl</span><span class="p">[</span><span class="n">m</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">sl</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># 3</span>
                <span class="n">gm</span> <span class="o">=</span> <span class="n">m</span> <span class="o">*</span> <span class="n">m</span>
                <span class="n">one</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">fn</span> <span class="o">*</span> <span class="n">fn</span> <span class="o">-</span> <span class="n">gm</span><span class="p">)</span>
                <span class="n">two</span> <span class="o">=</span> <span class="n">old_div</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">gn</span> <span class="o">*</span> <span class="n">gn</span> <span class="o">-</span> <span class="n">gm</span><span class="p">),</span> <span class="n">one</span><span class="p">)</span>
                <span class="n">three</span> <span class="o">=</span> <span class="n">old_div</span><span class="p">((</span><span class="n">fn</span> <span class="o">+</span> <span class="n">gn</span><span class="p">),</span> <span class="n">one</span><span class="p">)</span>
                <span class="n">i</span> <span class="o">=</span> <span class="n">k</span> <span class="o">-</span> <span class="n">n</span>
                <span class="n">j</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="n">p</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">three</span> <span class="o">*</span> <span class="n">ct</span> <span class="o">*</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">two</span> <span class="o">*</span> <span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                <span class="n">q</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">three</span> <span class="o">*</span> <span class="p">(</span><span class="n">ct</span> <span class="o">*</span> <span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">st</span> <span class="o">*</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span> <span class="n">two</span> <span class="o">*</span> <span class="n">q</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
<span class="c1">#</span>
<span class="c1"># synthesize x, y, and z in geocentric coordinates.</span>
<span class="c1"># 4</span>
        <span class="n">one</span> <span class="o">=</span> <span class="p">(</span><span class="n">gh</span><span class="p">[</span><span class="n">l</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">sv</span><span class="p">[</span><span class="n">ll</span> <span class="o">+</span> <span class="n">l</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">rr</span>
        <span class="k">if</span> <span class="n">m</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># else go to 7</span>
            <span class="n">two</span> <span class="o">=</span> <span class="p">(</span><span class="n">gh</span><span class="p">[</span><span class="n">l</span><span class="p">]</span> <span class="o">+</span> <span class="n">sv</span><span class="p">[</span><span class="n">ll</span> <span class="o">+</span> <span class="n">l</span><span class="p">]</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">rr</span>
            <span class="n">two</span> <span class="o">=</span> <span class="p">(</span><span class="n">gh</span><span class="p">[</span><span class="n">l</span><span class="p">])</span> <span class="o">*</span> <span class="n">rr</span>
            <span class="n">three</span> <span class="o">=</span> <span class="n">one</span> <span class="o">*</span> <span class="n">cl</span><span class="p">[</span><span class="n">m</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">two</span> <span class="o">*</span> <span class="n">sl</span><span class="p">[</span><span class="n">m</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">three</span> <span class="o">*</span> <span class="n">q</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">z</span> <span class="o">-</span> <span class="p">(</span><span class="n">fn</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">three</span> <span class="o">*</span> <span class="n">p</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">st</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">:</span>  <span class="c1"># else go to 5</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">one</span> <span class="o">*</span> <span class="n">sl</span><span class="p">[</span><span class="n">m</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">two</span> <span class="o">*</span> <span class="n">cl</span><span class="p">[</span><span class="n">m</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">fm</span> <span class="o">*</span> <span class="n">p</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">/</span> <span class="n">st</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># 5</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">one</span> <span class="o">*</span> <span class="n">sl</span><span class="p">[</span><span class="n">m</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">two</span> <span class="o">*</span> <span class="n">cl</span><span class="p">[</span><span class="n">m</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">q</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">ct</span>
            <span class="n">l</span> <span class="o">=</span> <span class="n">l</span> <span class="o">+</span> <span class="mi">2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># 7</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">one</span> <span class="o">*</span> <span class="n">q</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">z</span> <span class="o">-</span> <span class="p">(</span><span class="n">fn</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">one</span> <span class="o">*</span> <span class="n">p</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="n">l</span> <span class="o">=</span> <span class="n">l</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">m</span> <span class="o">+</span> <span class="mi">1</span>
<span class="c1">#</span>
<span class="c1"># convert to coordinate system specified by itype</span>
    <span class="n">one</span> <span class="o">=</span> <span class="n">x</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="n">cd</span> <span class="o">+</span> <span class="n">z</span> <span class="o">*</span> <span class="n">sd</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">z</span> <span class="o">*</span> <span class="n">cd</span> <span class="o">-</span> <span class="n">one</span> <span class="o">*</span> <span class="n">sd</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="o">*</span> <span class="n">y</span> <span class="o">+</span> <span class="n">z</span> <span class="o">*</span> <span class="n">z</span><span class="p">)</span>
<span class="c1">#</span>
    <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">f</span></div>
<span class="c1">#</span>
<span class="c1">#</span>


<div class="viewcode-block" id="measurements_methods"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.measurements_methods">[docs]</a><span class="k">def</span> <span class="nf">measurements_methods</span><span class="p">(</span><span class="n">meas_data</span><span class="p">,</span> <span class="n">noave</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get list of unique specs</span>
<span class="sd">    &quot;&quot;&quot;</span>
<span class="c1">#</span>
    <span class="n">version_num</span> <span class="o">=</span> <span class="n">get_version</span><span class="p">()</span>
    <span class="n">sids</span> <span class="o">=</span> <span class="n">get_specs</span><span class="p">(</span><span class="n">meas_data</span><span class="p">)</span>
<span class="c1"># list  of measurement records for this specimen</span>
<span class="c1">#</span>
<span class="c1"># step through spec by spec</span>
<span class="c1">#</span>
    <span class="n">SpecTmps</span><span class="p">,</span> <span class="n">SpecOuts</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">spec</span> <span class="ow">in</span> <span class="n">sids</span><span class="p">:</span>
        <span class="n">TRM</span><span class="p">,</span> <span class="n">IRM3D</span><span class="p">,</span> <span class="n">ATRM</span><span class="p">,</span> <span class="n">CR</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
        <span class="n">expcodes</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="c1"># first collect all data for this specimen and do lab treatments</span>
        <span class="c1"># list  of measurement records for this specimen</span>
        <span class="n">SpecRecs</span> <span class="o">=</span> <span class="n">get_dictitem</span><span class="p">(</span><span class="n">meas_data</span><span class="p">,</span> <span class="s1">&#39;er_specimen_name&#39;</span><span class="p">,</span> <span class="n">spec</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">SpecRecs</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;measurement_flag&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                <span class="n">rec</span><span class="p">[</span><span class="s1">&#39;measurement_flag&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;g&#39;</span>
            <span class="n">tmpmeths</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="s1">&#39;magic_method_codes&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
            <span class="n">meths</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="s2">&quot;LP-TRM&quot;</span> <span class="ow">in</span> <span class="n">tmpmeths</span><span class="p">:</span>
                <span class="n">TRM</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># catch these suckers here!</span>
            <span class="k">if</span> <span class="s2">&quot;LP-IRM-3D&quot;</span> <span class="ow">in</span> <span class="n">tmpmeths</span><span class="p">:</span>
                <span class="n">IRM3D</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># catch these suckers here!</span>
            <span class="k">elif</span> <span class="s2">&quot;LP-AN-TRM&quot;</span> <span class="ow">in</span> <span class="n">tmpmeths</span><span class="p">:</span>
                <span class="n">ATRM</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># catch these suckers here!</span>
            <span class="k">elif</span> <span class="s2">&quot;LP-CR-TRM&quot;</span> <span class="ow">in</span> <span class="n">tmpmeths</span><span class="p">:</span>
                <span class="n">CR</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># catch these suckers here!</span>
<span class="c1">#</span>
<span class="c1"># otherwise write over existing method codes</span>
<span class="c1">#</span>
<span class="c1"># find NRM data (LT-NO)</span>
<span class="c1">#</span>
            <span class="k">elif</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;measurement_temp&quot;</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="mf">273.</span> <span class="ow">and</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;measurement_temp&quot;</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mf">323.</span><span class="p">:</span>
                <span class="c1"># between 0 and 50C is room T measurement</span>
                <span class="k">if</span> <span class="p">(</span><span class="s2">&quot;measurement_dc_field&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">or</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;measurement_dc_field&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;measurement_dc_field&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s2">&quot;measurement_ac_field&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">or</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;measurement_ac_field&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;measurement_ac_field&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
                    <span class="c1"># measurement done in zero field!</span>
                    <span class="k">if</span> <span class="s2">&quot;treatment_temp&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">or</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treatment_temp&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treatment_temp&quot;</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="mf">273.</span> <span class="ow">and</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treatment_temp&quot;</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mf">298.</span><span class="p">):</span>
                        <span class="c1"># between 0 and 50C is room T treatment</span>
                        <span class="k">if</span> <span class="s2">&quot;treatment_ac_field&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">or</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treatment_ac_field&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="ow">or</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treatment_ac_field&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="c1"># no AF</span>
                            <span class="c1"># no IRM!</span>
                            <span class="k">if</span> <span class="s2">&quot;treatment_dc_field&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">or</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treatment_dc_field&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="ow">or</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treatment_dc_field&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                                <span class="k">if</span> <span class="s2">&quot;LT-NO&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>
                                    <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;LT-NO&quot;</span><span class="p">)</span>
                            <span class="k">elif</span> <span class="s2">&quot;LT-IRM&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>
                                <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;LT-IRM&quot;</span><span class="p">)</span>  <span class="c1"># it&#39;s an IRM</span>
<span class="c1">#</span>
<span class="c1"># find AF/infield/zerofield</span>
<span class="c1">#</span>
                        <span class="c1"># no ARM</span>
                        <span class="k">elif</span> <span class="s2">&quot;treatment_dc_field&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">or</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treatment_dc_field&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="ow">or</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treatment_dc_field&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="k">if</span> <span class="s2">&quot;LT-AF-Z&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>
                                <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;LT-AF-Z&quot;</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>  <span class="c1"># yes ARM</span>
                            <span class="k">if</span> <span class="s2">&quot;LT-AF-I&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>
                                <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;LT-AF-I&quot;</span><span class="p">)</span>
<span class="c1">#</span>
<span class="c1"># find Thermal/infield/zerofield</span>
<span class="c1">#</span>
                    <span class="k">elif</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treatment_temp&quot;</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="mi">323</span><span class="p">:</span>  <span class="c1"># treatment done at  high T</span>
                        <span class="k">if</span> <span class="n">TRM</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="k">if</span> <span class="s2">&quot;LT-T-I&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>
                                <span class="c1"># TRM - even if zero applied field!</span>
                                <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;LT-T-I&quot;</span><span class="p">)</span>
                        <span class="c1"># no TRM</span>
                        <span class="k">elif</span> <span class="s2">&quot;treatment_dc_field&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">or</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treatment_dc_field&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="ow">or</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treatment_dc_field&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="mf">0.</span><span class="p">:</span>
                            <span class="k">if</span> <span class="s2">&quot;LT-T-Z&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>
                                <span class="c1"># don&#39;t overwrite if part of a TRM experiment!</span>
                                <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;LT-T-Z&quot;</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>  <span class="c1"># yes TRM</span>
                            <span class="k">if</span> <span class="s2">&quot;LT-T-I&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>
                                <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;LT-T-I&quot;</span><span class="p">)</span>
<span class="c1">#</span>
<span class="c1"># find low-T infield,zero field</span>
<span class="c1">#</span>
                    <span class="k">else</span><span class="p">:</span>  <span class="c1"># treatment done at low T</span>
                        <span class="c1"># no field</span>
                        <span class="k">if</span> <span class="s2">&quot;treatment_dc_field&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">or</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treatment_dc_field&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="ow">or</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treatment_dc_field&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="k">if</span> <span class="s2">&quot;LT-LT-Z&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>
                                <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;LT-LT-Z&quot;</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>  <span class="c1"># yes field</span>
                            <span class="k">if</span> <span class="s2">&quot;LT-LT-I&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>
                                <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;LT-LT-I&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="s2">&quot;measurement_chi_volume&quot;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">or</span> <span class="s2">&quot;measurement_chi_mass&quot;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                    <span class="k">if</span> <span class="s2">&quot;LP-X&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>
                        <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;LP-X&quot;</span><span class="p">)</span>
                <span class="c1"># measurement in presence of dc field and not susceptibility;</span>
                <span class="c1"># hysteresis!</span>
                <span class="k">elif</span> <span class="s2">&quot;measurement_lab_dc_field&quot;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;measurement_lab_dc_field&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">if</span> <span class="s2">&quot;LP-HYS&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>
                        <span class="n">hysq</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Is this a hysteresis experiment? [1]/0&quot;</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">hysq</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="ow">or</span> <span class="n">hysq</span> <span class="o">==</span> <span class="s2">&quot;1&quot;</span><span class="p">:</span>
                            <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;LP-HYS&quot;</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">metha</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span>
                                <span class="s2">&quot;Enter the lab protocol code that best describes this experiment &quot;</span><span class="p">)</span>
                            <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">metha</span><span class="p">)</span>
                <span class="n">methcode</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                <span class="k">for</span> <span class="n">meth</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>
                    <span class="n">methcode</span> <span class="o">=</span> <span class="n">methcode</span> <span class="o">+</span> <span class="n">meth</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span>
                <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;magic_method_codes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">methcode</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># assign them back</span>
<span class="c1">#</span>
<span class="c1"># done with first pass, collect and assign provisional method codes</span>
            <span class="k">if</span> <span class="s2">&quot;measurement_description&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;measurement_description&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;er_citation_names&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;This study&quot;</span>
            <span class="n">SpecTmps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">)</span>
<span class="c1"># ready for second pass through, step through specimens, check whether ptrm, ptrm tail checks, or AARM, etc.</span>
<span class="c1">#</span>
    <span class="k">for</span> <span class="n">spec</span> <span class="ow">in</span> <span class="n">sids</span><span class="p">:</span>
        <span class="n">MD</span><span class="p">,</span> <span class="n">pTRM</span><span class="p">,</span> <span class="n">IZ</span><span class="p">,</span> <span class="n">ZI</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>  <span class="c1"># these are flags for the lab protocol codes</span>
        <span class="n">expcodes</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">NewSpecs</span><span class="p">,</span> <span class="n">SpecMeths</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="n">experiment_name</span><span class="p">,</span> <span class="n">measnum</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">IRM3D</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">experiment_name</span> <span class="o">=</span> <span class="s2">&quot;LP-IRM-3D&quot;</span>
        <span class="k">if</span> <span class="n">ATRM</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">experiment_name</span> <span class="o">=</span> <span class="s2">&quot;LP-AN-TRM&quot;</span>
        <span class="k">if</span> <span class="n">CR</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">experiment_name</span> <span class="o">=</span> <span class="s2">&quot;LP-CR&quot;</span>
        <span class="n">NewSpecs</span> <span class="o">=</span> <span class="n">get_dictitem</span><span class="p">(</span><span class="n">SpecTmps</span><span class="p">,</span> <span class="s1">&#39;er_specimen_name&#39;</span><span class="p">,</span> <span class="n">spec</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">)</span>
<span class="c1">#</span>
<span class="c1"># first look for replicate measurements</span>
<span class="c1">#</span>
        <span class="n">Ninit</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">NewSpecs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">noave</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># averages replicate measurements, returns treatment keys that are</span>
            <span class="c1"># being used</span>
            <span class="n">vdata</span><span class="p">,</span> <span class="n">treatkeys</span> <span class="o">=</span> <span class="n">vspec_magic</span><span class="p">(</span><span class="n">NewSpecs</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">vdata</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">NewSpecs</span><span class="p">):</span>
                <span class="c1"># print spec,&#39;started with &#39;,Ninit,&#39; ending with &#39;,len(vdata)</span>
                <span class="n">NewSpecs</span> <span class="o">=</span> <span class="n">vdata</span>
                <span class="c1"># print &quot;Averaged replicate measurements&quot;</span>
<span class="c1">#</span>
<span class="c1"># now look through this specimen&#39;s records - try to figure out what experiment it is</span>
<span class="c1">#</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">NewSpecs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># more than one meas for this spec - part of an unknown experiment</span>
            <span class="n">SpecMeths</span> <span class="o">=</span> <span class="n">get_list</span><span class="p">(</span><span class="n">NewSpecs</span><span class="p">,</span> <span class="s1">&#39;magic_method_codes&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
            <span class="c1"># TRM steps, could be TRM acquisition, Shaw or a Thellier</span>
            <span class="c1"># experiment or TDS experiment</span>
            <span class="k">if</span> <span class="s2">&quot;LT-T-I&quot;</span> <span class="ow">in</span> <span class="n">SpecMeths</span> <span class="ow">and</span> <span class="n">experiment_name</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="c1">#</span>
                <span class="c1"># collect all the infield steps and look for changes in dc field vector</span>
                <span class="c1">#</span>
                <span class="n">Steps</span><span class="p">,</span> <span class="n">TI</span> <span class="o">=</span> <span class="p">[],</span> <span class="mi">1</span>
                <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">NewSpecs</span><span class="p">:</span>
                    <span class="n">methods</span> <span class="o">=</span> <span class="n">get_list</span><span class="p">(</span>
                        <span class="n">NewSpecs</span><span class="p">,</span> <span class="s1">&#39;magic_method_codes&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="s2">&quot;LT-T-I&quot;</span> <span class="ow">in</span> <span class="n">methods</span><span class="p">:</span>
                        <span class="n">Steps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">)</span>  <span class="c1"># get all infield steps together</span>
                <span class="n">rec_bak</span> <span class="o">=</span> <span class="n">Steps</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="s2">&quot;treatment_dc_field_phi&quot;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec_bak</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="s2">&quot;treatment_dc_field_theta&quot;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec_bak</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                    <span class="c1"># at least there is field orientation info</span>
                    <span class="k">if</span> <span class="n">rec_bak</span><span class="p">[</span><span class="s2">&quot;treatment_dc_field_phi&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span> <span class="ow">and</span> <span class="n">rec_bak</span><span class="p">[</span><span class="s2">&quot;treatment_dc_field_theta&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                        <span class="n">phi0</span><span class="p">,</span> <span class="n">theta0</span> <span class="o">=</span> <span class="n">rec_bak</span><span class="p">[</span><span class="s2">&quot;treatment_dc_field_phi&quot;</span><span class="p">],</span> <span class="n">rec_bak</span><span class="p">[</span><span class="s2">&quot;treatment_dc_field_theta&quot;</span><span class="p">]</span>
                        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">Steps</span><span class="p">)):</span>
                            <span class="n">rec</span> <span class="o">=</span> <span class="n">Steps</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                            <span class="n">phi</span><span class="p">,</span> <span class="n">theta</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treatment_dc_field_phi&quot;</span><span class="p">],</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treatment_dc_field_theta&quot;</span><span class="p">]</span>
                            <span class="k">if</span> <span class="n">phi</span> <span class="o">!=</span> <span class="n">phi0</span> <span class="ow">or</span> <span class="n">theta</span> <span class="o">!=</span> <span class="n">theta0</span><span class="p">:</span>
                                <span class="n">ANIS</span> <span class="o">=</span> <span class="mi">1</span>   <span class="c1"># if direction changes, is some sort of anisotropy experiment</span>
                <span class="k">if</span> <span class="s2">&quot;LT-AF-I&quot;</span> <span class="ow">in</span> <span class="n">SpecMeths</span> <span class="ow">and</span> <span class="s2">&quot;LT-AF-Z&quot;</span> <span class="ow">in</span> <span class="n">SpecMeths</span><span class="p">:</span>  <span class="c1"># must be Shaw :(</span>
                    <span class="n">experiment_name</span> <span class="o">=</span> <span class="s2">&quot;LP-PI-TRM:LP-PI-ALT-AFARM&quot;</span>
                <span class="k">elif</span> <span class="n">TRM</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">experiment_name</span> <span class="o">=</span> <span class="s2">&quot;LP-TRM&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">TI</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># no infield steps at all</span>
            <span class="k">if</span> <span class="s2">&quot;LT-T-Z&quot;</span> <span class="ow">in</span> <span class="n">SpecMeths</span> <span class="ow">and</span> <span class="n">experiment_name</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>  <span class="c1"># thermal demag steps</span>
                <span class="k">if</span> <span class="n">TI</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">experiment_name</span> <span class="o">=</span> <span class="s2">&quot;LP-DIR-T&quot;</span>  <span class="c1"># just ordinary thermal demag</span>
                <span class="k">elif</span> <span class="n">TRM</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># heart pounding - could be some  kind of TRM normalized paleointensity or LP-TRM-TD experiment</span>
                    <span class="n">Temps</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">Steps</span><span class="p">:</span>  <span class="c1"># check through the infield steps - if all at same temperature, then must be a demag of a total TRM with checks</span>
                        <span class="k">if</span> <span class="n">step</span><span class="p">[</span><span class="s1">&#39;treatment_temp&#39;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">Temps</span><span class="p">:</span>
                            <span class="n">Temps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">step</span><span class="p">[</span><span class="s1">&#39;treatment_temp&#39;</span><span class="p">])</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">Temps</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">experiment_name</span> <span class="o">=</span> <span class="s2">&quot;LP-PI-TRM&quot;</span>  <span class="c1"># paleointensity normalized by TRM</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="c1"># thermal demag of a lab TRM (could be part of a</span>
                        <span class="c1"># LP-PI-TDS experiment)</span>
                        <span class="n">experiment_name</span> <span class="o">=</span> <span class="s2">&quot;LP-TRM-TD&quot;</span>
                <span class="n">TZ</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">TZ</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># no zero field steps at all</span>
            <span class="k">if</span> <span class="s2">&quot;LT-AF-I&quot;</span> <span class="ow">in</span> <span class="n">SpecMeths</span><span class="p">:</span>  <span class="c1"># ARM steps</span>
                <span class="n">Steps</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">NewSpecs</span><span class="p">:</span>
                    <span class="n">tmp</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;magic_method_codes&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
                    <span class="n">methods</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">meth</span> <span class="ow">in</span> <span class="n">tmp</span><span class="p">:</span>
                        <span class="n">methods</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">meth</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
                    <span class="k">if</span> <span class="s2">&quot;LT-AF-I&quot;</span> <span class="ow">in</span> <span class="n">methods</span><span class="p">:</span>
                        <span class="n">Steps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">)</span>  <span class="c1"># get all infield steps together</span>
                <span class="n">rec_bak</span> <span class="o">=</span> <span class="n">Steps</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="s2">&quot;treatment_dc_field_phi&quot;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec_bak</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="s2">&quot;treatment_dc_field_theta&quot;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec_bak</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                    <span class="c1"># at least there is field orientation info</span>
                    <span class="k">if</span> <span class="n">rec_bak</span><span class="p">[</span><span class="s2">&quot;treatment_dc_field_phi&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span> <span class="ow">and</span> <span class="n">rec_bak</span><span class="p">[</span><span class="s2">&quot;treatment_dc_field_theta&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                        <span class="n">phi0</span><span class="p">,</span> <span class="n">theta0</span> <span class="o">=</span> <span class="n">rec_bak</span><span class="p">[</span><span class="s2">&quot;treatment_dc_field_phi&quot;</span><span class="p">],</span> <span class="n">rec_bak</span><span class="p">[</span><span class="s2">&quot;treatment_dc_field_theta&quot;</span><span class="p">]</span>
                        <span class="n">ANIS</span> <span class="o">=</span> <span class="mi">0</span>
                        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">Steps</span><span class="p">)):</span>
                            <span class="n">rec</span> <span class="o">=</span> <span class="n">Steps</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                            <span class="n">phi</span><span class="p">,</span> <span class="n">theta</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treatment_dc_field_phi&quot;</span><span class="p">],</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treatment_dc_field_theta&quot;</span><span class="p">]</span>
                            <span class="k">if</span> <span class="n">phi</span> <span class="o">!=</span> <span class="n">phi0</span> <span class="ow">or</span> <span class="n">theta</span> <span class="o">!=</span> <span class="n">theta0</span><span class="p">:</span>
                                <span class="n">ANIS</span> <span class="o">=</span> <span class="mi">1</span>   <span class="c1"># if direction changes, is some sort of anisotropy experiment</span>
                        <span class="k">if</span> <span class="n">ANIS</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="n">experiment_name</span> <span class="o">=</span> <span class="s2">&quot;LP-AN-ARM&quot;</span>
                <span class="k">if</span> <span class="n">experiment_name</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>  <span class="c1"># not anisotropy of ARM - acquisition?</span>
                    <span class="n">field0</span> <span class="o">=</span> <span class="n">rec_bak</span><span class="p">[</span><span class="s2">&quot;treatment_dc_field&quot;</span><span class="p">]</span>
                    <span class="n">ARM</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">Steps</span><span class="p">)):</span>
                        <span class="n">rec</span> <span class="o">=</span> <span class="n">Steps</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                        <span class="n">field</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treatment_dc_field&quot;</span><span class="p">]</span>
                        <span class="k">if</span> <span class="n">field</span> <span class="o">!=</span> <span class="n">field0</span><span class="p">:</span>
                            <span class="n">ARM</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="k">if</span> <span class="n">ARM</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">experiment_name</span> <span class="o">=</span> <span class="s2">&quot;LP-ARM&quot;</span>
                <span class="n">AFI</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">AFI</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># no ARM steps at all</span>
            <span class="k">if</span> <span class="s2">&quot;LT-AF-Z&quot;</span> <span class="ow">in</span> <span class="n">SpecMeths</span> <span class="ow">and</span> <span class="n">experiment_name</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>  <span class="c1"># AF demag steps</span>
                <span class="k">if</span> <span class="n">AFI</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">experiment_name</span> <span class="o">=</span> <span class="s2">&quot;LP-DIR-AF&quot;</span>  <span class="c1"># just ordinary AF demag</span>
                <span class="k">else</span><span class="p">:</span>  <span class="c1"># heart pounding - a pseudothellier?</span>
                    <span class="n">experiment_name</span> <span class="o">=</span> <span class="s2">&quot;LP-PI-ARM&quot;</span>
                <span class="n">AFZ</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">AFZ</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># no AF demag at all</span>
            <span class="k">if</span> <span class="s2">&quot;LT-IRM&quot;</span> <span class="ow">in</span> <span class="n">SpecMeths</span><span class="p">:</span>  <span class="c1"># IRM</span>
                <span class="n">Steps</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">NewSpecs</span><span class="p">:</span>
                    <span class="n">tmp</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;magic_method_codes&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
                    <span class="n">methods</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">meth</span> <span class="ow">in</span> <span class="n">tmp</span><span class="p">:</span>
                        <span class="n">methods</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">meth</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
                    <span class="k">if</span> <span class="s2">&quot;LT-IRM&quot;</span> <span class="ow">in</span> <span class="n">methods</span><span class="p">:</span>
                        <span class="n">Steps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">)</span>  <span class="c1"># get all infield steps together</span>
                <span class="n">rec_bak</span> <span class="o">=</span> <span class="n">Steps</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="s2">&quot;treatment_dc_field_phi&quot;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec_bak</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="s2">&quot;treatment_dc_field_theta&quot;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec_bak</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                    <span class="c1"># at least there is field orientation info</span>
                    <span class="k">if</span> <span class="n">rec_bak</span><span class="p">[</span><span class="s2">&quot;treatment_dc_field_phi&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span> <span class="ow">and</span> <span class="n">rec_bak</span><span class="p">[</span><span class="s2">&quot;treatment_dc_field_theta&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                        <span class="n">phi0</span><span class="p">,</span> <span class="n">theta0</span> <span class="o">=</span> <span class="n">rec_bak</span><span class="p">[</span><span class="s2">&quot;treatment_dc_field_phi&quot;</span><span class="p">],</span> <span class="n">rec_bak</span><span class="p">[</span><span class="s2">&quot;treatment_dc_field_theta&quot;</span><span class="p">]</span>
                        <span class="n">ANIS</span> <span class="o">=</span> <span class="mi">0</span>
                        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">Steps</span><span class="p">)):</span>
                            <span class="n">rec</span> <span class="o">=</span> <span class="n">Steps</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                            <span class="n">phi</span><span class="p">,</span> <span class="n">theta</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treatment_dc_field_phi&quot;</span><span class="p">],</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treatment_dc_field_theta&quot;</span><span class="p">]</span>
                            <span class="k">if</span> <span class="n">phi</span> <span class="o">!=</span> <span class="n">phi0</span> <span class="ow">or</span> <span class="n">theta</span> <span class="o">!=</span> <span class="n">theta0</span><span class="p">:</span>
                                <span class="n">ANIS</span> <span class="o">=</span> <span class="mi">1</span>   <span class="c1"># if direction changes, is some sort of anisotropy experiment</span>
                        <span class="k">if</span> <span class="n">ANIS</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="n">experiment_name</span> <span class="o">=</span> <span class="s2">&quot;LP-AN-IRM&quot;</span>
                <span class="k">if</span> <span class="n">experiment_name</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>  <span class="c1"># not anisotropy of IRM - acquisition?</span>
                    <span class="n">field0</span> <span class="o">=</span> <span class="n">rec_bak</span><span class="p">[</span><span class="s2">&quot;treatment_dc_field&quot;</span><span class="p">]</span>
                    <span class="n">IRM</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">Steps</span><span class="p">)):</span>
                        <span class="n">rec</span> <span class="o">=</span> <span class="n">Steps</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                        <span class="n">field</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treatment_dc_field&quot;</span><span class="p">]</span>
                        <span class="k">if</span> <span class="n">field</span> <span class="o">!=</span> <span class="n">field0</span><span class="p">:</span>
                            <span class="n">IRM</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="k">if</span> <span class="n">IRM</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">experiment_name</span> <span class="o">=</span> <span class="s2">&quot;LP-IRM&quot;</span>
                <span class="n">IRM</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">IRM</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># no IRM at all</span>
            <span class="k">if</span> <span class="s2">&quot;LP-X&quot;</span> <span class="ow">in</span> <span class="n">SpecMeths</span><span class="p">:</span>  <span class="c1"># susceptibility run</span>
                <span class="n">Steps</span> <span class="o">=</span> <span class="n">get_dictitem</span><span class="p">(</span>
                    <span class="n">NewSpecs</span><span class="p">,</span> <span class="s1">&#39;magic_method_codes&#39;</span><span class="p">,</span> <span class="s1">&#39;LT-X&#39;</span><span class="p">,</span> <span class="s1">&#39;has&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">Steps</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">rec_bak</span> <span class="o">=</span> <span class="n">Steps</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">if</span> <span class="s2">&quot;treatment_dc_field_phi&quot;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec_bak</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="s2">&quot;treatment_dc_field_theta&quot;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec_bak</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                        <span class="c1"># at least there is field orientation info</span>
                        <span class="k">if</span> <span class="n">rec_bak</span><span class="p">[</span><span class="s2">&quot;treatment_dc_field_phi&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span> <span class="ow">and</span> <span class="n">rec_bak</span><span class="p">[</span><span class="s2">&quot;treatment_dc_field_theta&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                            <span class="n">phi0</span><span class="p">,</span> <span class="n">theta0</span> <span class="o">=</span> <span class="n">rec_bak</span><span class="p">[</span><span class="s2">&quot;treatment_dc_field_phi&quot;</span><span class="p">],</span> <span class="n">rec_bak</span><span class="p">[</span><span class="s2">&quot;treatment_dc_field_theta&quot;</span><span class="p">]</span>
                            <span class="n">ANIS</span> <span class="o">=</span> <span class="mi">0</span>
                            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">Steps</span><span class="p">)):</span>
                                <span class="n">rec</span> <span class="o">=</span> <span class="n">Steps</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                                <span class="n">phi</span><span class="p">,</span> <span class="n">theta</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treatment_dc_field_phi&quot;</span><span class="p">],</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treatment_dc_field_theta&quot;</span><span class="p">]</span>
                                <span class="k">if</span> <span class="n">phi</span> <span class="o">!=</span> <span class="n">phi0</span> <span class="ow">or</span> <span class="n">theta</span> <span class="o">!=</span> <span class="n">theta0</span><span class="p">:</span>
                                    <span class="n">ANIS</span> <span class="o">=</span> <span class="mi">1</span>   <span class="c1"># if direction changes, is some sort of anisotropy experiment</span>
                            <span class="k">if</span> <span class="n">ANIS</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                                <span class="n">experiment_name</span> <span class="o">=</span> <span class="s2">&quot;LP-AN-MS&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">CHI</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># no susceptibility at all</span>
    <span class="c1">#</span>
    <span class="c1"># now need to deal with special thellier experiment problems - first clear up pTRM checks and  tail checks</span>
    <span class="c1">#</span>
            <span class="k">if</span> <span class="n">experiment_name</span> <span class="o">==</span> <span class="s2">&quot;LP-PI-TRM&quot;</span><span class="p">:</span>  <span class="c1"># is some sort of thellier experiment</span>
                <span class="n">rec_bak</span> <span class="o">=</span> <span class="n">NewSpecs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">tmp</span> <span class="o">=</span> <span class="n">rec_bak</span><span class="p">[</span><span class="s2">&quot;magic_method_codes&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
                <span class="n">methbak</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">meth</span> <span class="ow">in</span> <span class="n">tmp</span><span class="p">:</span>
                    <span class="n">methbak</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">meth</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>  <span class="c1"># previous steps method codes</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">NewSpecs</span><span class="p">)):</span>
                    <span class="n">rec</span> <span class="o">=</span> <span class="n">NewSpecs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                    <span class="n">tmp</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;magic_method_codes&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
                    <span class="n">meths</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">meth</span> <span class="ow">in</span> <span class="n">tmp</span><span class="p">:</span>
                        <span class="c1"># get this guys method codes</span>
                        <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">meth</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
    <span class="c1">#</span>
    <span class="c1"># check if this is a pTRM check</span>
    <span class="c1">#</span>
                    <span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treatment_temp&quot;</span><span class="p">])</span> <span class="o">&lt;</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec_bak</span><span class="p">[</span><span class="s2">&quot;treatment_temp&quot;</span><span class="p">]):</span>  <span class="c1"># went backward</span>
                        <span class="k">if</span> <span class="s2">&quot;LT-T-I&quot;</span> <span class="ow">in</span> <span class="n">meths</span> <span class="ow">and</span> <span class="s2">&quot;LT-T-Z&quot;</span> <span class="ow">in</span> <span class="n">methbak</span><span class="p">:</span>  <span class="c1"># must be a pTRM check after first z</span>
                            <span class="c1">#</span>
                            <span class="c1"># replace LT-T-I method code with LT-PTRM-I</span>
                            <span class="c1">#</span>
                            <span class="n">methcodes</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                            <span class="k">for</span> <span class="n">meth</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>
                                <span class="k">if</span> <span class="n">meth</span> <span class="o">!=</span> <span class="s2">&quot;LT-T-I&quot;</span><span class="p">:</span>
                                    <span class="n">methcode</span> <span class="o">=</span> <span class="n">methcode</span> <span class="o">+</span> <span class="n">meth</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span>
                            <span class="n">methcodes</span> <span class="o">=</span> <span class="n">methcodes</span> <span class="o">+</span> <span class="s2">&quot;LT-PTRM-I&quot;</span>
                            <span class="n">meths</span> <span class="o">=</span> <span class="n">methcodes</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
                            <span class="n">pTRM</span> <span class="o">=</span> <span class="mi">1</span>
                        <span class="k">elif</span> <span class="s2">&quot;LT-T-Z&quot;</span> <span class="ow">in</span> <span class="n">meths</span> <span class="ow">and</span> <span class="s2">&quot;LT-T-I&quot;</span> <span class="ow">in</span> <span class="n">methbak</span><span class="p">:</span>  <span class="c1"># must be pTRM check after first I</span>
                            <span class="c1">#</span>
                            <span class="c1"># replace LT-T-Z method code with LT-PTRM-Z</span>
                            <span class="c1">#</span>
                            <span class="n">methcodes</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                            <span class="k">for</span> <span class="n">meth</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>
                                <span class="k">if</span> <span class="n">meth</span> <span class="o">!=</span> <span class="s2">&quot;LT-T-Z&quot;</span><span class="p">:</span>
                                    <span class="n">methcode</span> <span class="o">=</span> <span class="n">methcode</span> <span class="o">+</span> <span class="n">meth</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span>
                            <span class="n">methcodes</span> <span class="o">=</span> <span class="n">methcodes</span> <span class="o">+</span> <span class="s2">&quot;LT-PTRM-Z&quot;</span>
                            <span class="n">meths</span> <span class="o">=</span> <span class="n">methcodes</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
                            <span class="n">pTRM</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="n">methcodes</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                    <span class="k">for</span> <span class="n">meth</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>
                        <span class="n">methcodes</span> <span class="o">=</span> <span class="n">methcodes</span> <span class="o">+</span> <span class="n">meth</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span>
                    <span class="c1"># attach new method code</span>
                    <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;magic_method_codes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">methcodes</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">rec_bak</span> <span class="o">=</span> <span class="n">rec</span>  <span class="c1"># next previous record</span>
                    <span class="n">tmp</span> <span class="o">=</span> <span class="n">rec_bak</span><span class="p">[</span><span class="s2">&quot;magic_method_codes&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
                    <span class="n">methbak</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">meth</span> <span class="ow">in</span> <span class="n">tmp</span><span class="p">:</span>
                        <span class="c1"># previous steps method codes</span>
                        <span class="n">methbak</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">meth</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
    <span class="c1">#</span>
    <span class="c1"># done with assigning pTRM checks.  data should be &quot;fixed&quot; in NewSpecs</span>
    <span class="c1">#</span>
    <span class="c1"># now let&#39;s find out which steps are infield zerofield (IZ) and which are zerofield infield (ZI)</span>
    <span class="c1">#</span>
                <span class="n">rec_bak</span> <span class="o">=</span> <span class="n">NewSpecs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">tmp</span> <span class="o">=</span> <span class="n">rec_bak</span><span class="p">[</span><span class="s2">&quot;magic_method_codes&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
                <span class="n">methbak</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">meth</span> <span class="ow">in</span> <span class="n">tmp</span><span class="p">:</span>
                    <span class="n">methbak</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">meth</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>  <span class="c1"># previous steps method codes</span>
                <span class="k">if</span> <span class="s2">&quot;LT-NO&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">methbak</span><span class="p">:</span>  <span class="c1"># first measurement is not NRM</span>
                    <span class="k">if</span> <span class="s2">&quot;LT-T-I&quot;</span> <span class="ow">in</span> <span class="n">methbak</span><span class="p">:</span>
                        <span class="n">IZorZI</span> <span class="o">=</span> <span class="s2">&quot;LP-PI-TRM-IZ&quot;</span>  <span class="c1"># first pair is IZ</span>
                    <span class="k">if</span> <span class="s2">&quot;LT-T-Z&quot;</span> <span class="ow">in</span> <span class="n">methbak</span><span class="p">:</span>
                        <span class="n">IZorZI</span> <span class="o">=</span> <span class="s2">&quot;LP-PI-TRM-ZI&quot;</span>  <span class="c1"># first pair is ZI</span>
                    <span class="k">if</span> <span class="n">IZorZI</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">methbak</span><span class="p">:</span>
                        <span class="n">methbak</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">IZorZI</span><span class="p">)</span>
                    <span class="n">methcode</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                    <span class="k">for</span> <span class="n">meth</span> <span class="ow">in</span> <span class="n">methbak</span><span class="p">:</span>
                        <span class="n">methcode</span> <span class="o">=</span> <span class="n">methcode</span> <span class="o">+</span> <span class="n">meth</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span>
                    <span class="c1"># fix first heating step when no NRM</span>
                    <span class="n">NewSpecs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;magic_method_codes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">methcode</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">IZorZI</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>  <span class="c1"># first measurement is NRM and not one of a pair</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">NewSpecs</span><span class="p">)):</span>  <span class="c1"># hunt through measurements again</span>
                    <span class="n">rec</span> <span class="o">=</span> <span class="n">NewSpecs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                    <span class="n">tmp</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;magic_method_codes&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
                    <span class="n">meths</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">meth</span> <span class="ow">in</span> <span class="n">tmp</span><span class="p">:</span>
                        <span class="c1"># get this guys method codes</span>
                        <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">meth</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
    <span class="c1">#</span>
    <span class="c1"># check if this start a new temperature step of a infield/zerofield pair</span>
    <span class="c1">#</span>
                    <span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treatment_temp&quot;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec_bak</span><span class="p">[</span><span class="s2">&quot;treatment_temp&quot;</span><span class="p">])</span> <span class="ow">and</span> <span class="s2">&quot;LT-PTRM-I&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">methbak</span><span class="p">:</span>  <span class="c1"># new pair?</span>
                        <span class="k">if</span> <span class="s2">&quot;LT-T-I&quot;</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>  <span class="c1"># infield of this pair</span>
                            <span class="n">IZorZI</span> <span class="o">=</span> <span class="s2">&quot;LP-PI-TRM-IZ&quot;</span>
                            <span class="n">IZ</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># at least one IZ pair</span>
                        <span class="k">elif</span> <span class="s2">&quot;LT-T-Z&quot;</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>  <span class="c1"># zerofield</span>
                            <span class="n">IZorZI</span> <span class="o">=</span> <span class="s2">&quot;LP-PI-TRM-ZI&quot;</span>
                            <span class="n">ZI</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># at least one ZI pair</span>
                    <span class="c1"># new pair after out of sequence PTRM check?</span>
                    <span class="k">elif</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treatment_temp&quot;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec_bak</span><span class="p">[</span><span class="s2">&quot;treatment_temp&quot;</span><span class="p">])</span> <span class="ow">and</span> <span class="s2">&quot;LT-PTRM-I&quot;</span> <span class="ow">in</span> <span class="n">methbak</span> <span class="ow">and</span> <span class="n">IZorZI</span> <span class="o">!=</span> <span class="s2">&quot;LP-PI-TRM-ZI&quot;</span><span class="p">:</span>
                        <span class="k">if</span> <span class="s2">&quot;LT-T-I&quot;</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>  <span class="c1"># infield of this pair</span>
                            <span class="n">IZorZI</span> <span class="o">=</span> <span class="s2">&quot;LP-PI-TRM-IZ&quot;</span>
                            <span class="n">IZ</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># at least one IZ pair</span>
                        <span class="k">elif</span> <span class="s2">&quot;LT-T-Z&quot;</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>  <span class="c1"># zerofield</span>
                            <span class="n">IZorZI</span> <span class="o">=</span> <span class="s2">&quot;LP-PI-TRM-ZI&quot;</span>
                            <span class="n">ZI</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># at least one ZI pair</span>
                    <span class="c1"># stayed same temp</span>
                    <span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treatment_temp&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec_bak</span><span class="p">[</span><span class="s2">&quot;treatment_temp&quot;</span><span class="p">]):</span>
                        <span class="k">if</span> <span class="s2">&quot;LT-T-Z&quot;</span> <span class="ow">in</span> <span class="n">meths</span> <span class="ow">and</span> <span class="s2">&quot;LT-T-I&quot;</span> <span class="ow">in</span> <span class="n">methbak</span> <span class="ow">and</span> <span class="n">IZorZI</span> <span class="o">==</span> <span class="s2">&quot;LP-PI-TRM-ZI&quot;</span><span class="p">:</span>  <span class="c1"># must be a tail check</span>
                            <span class="c1">#</span>
                            <span class="c1"># replace LT-T-Z method code with LT-PTRM-MD</span>
                            <span class="c1">#</span>
                            <span class="n">methcodes</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                            <span class="k">for</span> <span class="n">meth</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>
                                <span class="k">if</span> <span class="n">meth</span> <span class="o">!=</span> <span class="s2">&quot;LT-T-Z&quot;</span><span class="p">:</span>
                                    <span class="n">methcode</span> <span class="o">=</span> <span class="n">methcode</span> <span class="o">+</span> <span class="n">meth</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span>
                            <span class="n">methcodes</span> <span class="o">=</span> <span class="n">methcodes</span> <span class="o">+</span> <span class="s2">&quot;LT-PTRM-MD&quot;</span>
                            <span class="n">meths</span> <span class="o">=</span> <span class="n">methcodes</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
                            <span class="n">MD</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="c1"># fix method codes</span>
                    <span class="k">if</span> <span class="s2">&quot;LT-PTRM-I&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">meths</span> <span class="ow">and</span> <span class="s2">&quot;LT-PTRM-MD&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">meths</span> <span class="ow">and</span> <span class="n">IZorZI</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>
                        <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">IZorZI</span><span class="p">)</span>
                    <span class="n">newmeths</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">meth</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">meth</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">newmeths</span><span class="p">:</span>
                            <span class="n">newmeths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">meth</span><span class="p">)</span>  <span class="c1"># try to get unique set</span>
                    <span class="n">methcode</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                    <span class="k">for</span> <span class="n">meth</span> <span class="ow">in</span> <span class="n">newmeths</span><span class="p">:</span>
                        <span class="n">methcode</span> <span class="o">=</span> <span class="n">methcode</span> <span class="o">+</span> <span class="n">meth</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span>
                    <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;magic_method_codes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">methcode</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">rec_bak</span> <span class="o">=</span> <span class="n">rec</span>  <span class="c1"># moving on to next record, making current one the backup</span>
                    <span class="c1"># get last specimen&#39;s method codes in a list</span>
                    <span class="n">methbak</span> <span class="o">=</span> <span class="n">rec_bak</span><span class="p">[</span><span class="s2">&quot;magic_method_codes&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>

    <span class="c1">#</span>
    <span class="c1"># done with this specimen&#39;s records, now  check if any pTRM checks or MD checks</span>
    <span class="c1">#</span>
                <span class="k">if</span> <span class="n">pTRM</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">experiment_name</span> <span class="o">=</span> <span class="n">experiment_name</span> <span class="o">+</span> <span class="s2">&quot;:LP-PI-ALT-PTRM&quot;</span>
                <span class="k">if</span> <span class="n">MD</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">experiment_name</span> <span class="o">=</span> <span class="n">experiment_name</span> <span class="o">+</span> <span class="s2">&quot;:LP-PI-BT-MD&quot;</span>
                <span class="k">if</span> <span class="n">IZ</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">ZI</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">experiment_name</span> <span class="o">=</span> <span class="n">experiment_name</span> <span class="o">+</span> <span class="s2">&quot;:LP-PI-BT-IZZI&quot;</span>
                <span class="k">if</span> <span class="n">IZ</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">ZI</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">experiment_name</span> <span class="o">=</span> <span class="n">experiment_name</span> <span class="o">+</span> <span class="s2">&quot;:LP-PI-IZ&quot;</span>  <span class="c1"># Aitken method</span>
                <span class="k">if</span> <span class="n">IZ</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">ZI</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">experiment_name</span> <span class="o">=</span> <span class="n">experiment_name</span> <span class="o">+</span> <span class="s2">&quot;:LP-PI-ZI&quot;</span>  <span class="c1"># Coe method</span>
                <span class="n">IZ</span><span class="p">,</span> <span class="n">ZI</span><span class="p">,</span> <span class="n">pTRM</span><span class="p">,</span> <span class="n">MD</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>  <span class="c1"># reset these for next specimen</span>
                <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">NewSpecs</span><span class="p">:</span>  <span class="c1"># fix the experiment name for all recs for this specimen and save in SpecOuts</span>
                    <span class="c1"># assign an experiment name to all specimen measurements</span>
                    <span class="c1"># from this specimen</span>
                    <span class="k">if</span> <span class="n">experiment_name</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                        <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;magic_method_codes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;magic_method_codes&quot;</span><span class="p">]</span> <span class="o">+</span> \
                            <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">experiment_name</span>
                    <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;magic_experiment_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">spec</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">experiment_name</span>
                    <span class="n">rec</span><span class="p">[</span><span class="s1">&#39;measurement_number&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%i</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                        <span class="n">measnum</span><span class="p">)</span>  <span class="c1"># assign measurement numbers</span>
                    <span class="n">measnum</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="c1">#rec[&#39;sequence&#39;] = &#39;%i&#39;%(seqnum)</span>
                    <span class="c1">#seqnum += 1</span>
                    <span class="n">SpecOuts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">experiment_name</span> <span class="o">==</span> <span class="s2">&quot;LP-PI-TRM:LP-PI-ALT-AFARM&quot;</span><span class="p">:</span>  <span class="c1"># is a Shaw experiment!</span>
                <span class="n">ARM</span><span class="p">,</span> <span class="n">TRM</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
                <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">NewSpecs</span><span class="p">:</span>  <span class="c1"># fix the experiment name for all recs for this specimen and save in SpecOuts</span>
                    <span class="c1"># assign an experiment name to all specimen measurements from this specimen</span>
                    <span class="c1"># make the second ARM in Shaw experiments LT-AF-I-2, stick</span>
                    <span class="c1"># in the AF of ARM and TRM codes</span>
                    <span class="n">meths</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;magic_method_codes&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">ARM</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="k">if</span> <span class="s2">&quot;LT-AF-I&quot;</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>
                            <span class="k">del</span> <span class="n">meths</span><span class="p">[</span><span class="n">meths</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&quot;LT-AF-I&quot;</span><span class="p">)]</span>
                            <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;LT-AF-I-2&quot;</span><span class="p">)</span>
                            <span class="n">ARM</span> <span class="o">=</span> <span class="mi">2</span>
                        <span class="k">if</span> <span class="s2">&quot;LT-AF-Z&quot;</span> <span class="ow">in</span> <span class="n">meths</span> <span class="ow">and</span> <span class="n">TRM</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;LP-ARM-AFD&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">TRM</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">ARM</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="k">if</span> <span class="s2">&quot;LT-AF-Z&quot;</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>
                            <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;LP-TRM-AFD&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">ARM</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="k">if</span> <span class="s2">&quot;LT-AF-Z&quot;</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>
                            <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;LP-ARM2-AFD&quot;</span><span class="p">)</span>
                    <span class="n">newcode</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                    <span class="k">for</span> <span class="n">meth</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>
                        <span class="n">newcode</span> <span class="o">=</span> <span class="n">newcode</span> <span class="o">+</span> <span class="n">meth</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span>
                    <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;magic_method_codes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">newcode</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="k">if</span> <span class="s2">&quot;LT-AF-I&quot;</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>
                        <span class="n">ARM</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="k">if</span> <span class="s2">&quot;LT-T-I&quot;</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>
                        <span class="n">TRM</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;magic_method_codes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;magic_method_codes&quot;</span><span class="p">]</span> <span class="o">+</span> \
                        <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">experiment_name</span>
                    <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;magic_experiment_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">spec</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">experiment_name</span>
                    <span class="n">rec</span><span class="p">[</span><span class="s1">&#39;measurement_number&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%i</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                        <span class="n">measnum</span><span class="p">)</span>  <span class="c1"># assign measurement numbers</span>
                    <span class="c1">#rec[&#39;sequence&#39;] = &#39;%i&#39;%(seqnum)</span>
                    <span class="c1">#seqnum += 1</span>
                    <span class="n">measnum</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="n">SpecOuts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1"># not a Thellier-Thellier  or a Shaw experiemnt</span>
                <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">NewSpecs</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">experiment_name</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                        <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;magic_method_codes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;LT-NO&quot;</span>
                        <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;magic_experiment_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">spec</span> <span class="o">+</span> <span class="s2">&quot;:LT-NO&quot;</span>
                        <span class="n">rec</span><span class="p">[</span><span class="s1">&#39;measurement_number&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%i</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                            <span class="n">measnum</span><span class="p">)</span>  <span class="c1"># assign measurement numbers</span>
                        <span class="c1">#rec[&#39;sequence&#39;] = &#39;%i&#39;%(seqnum)</span>
                        <span class="c1">#seqnum += 1</span>
                        <span class="n">measnum</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">experiment_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">rec</span><span class="p">[</span><span class="s1">&#39;magic_method_codes&#39;</span><span class="p">]:</span>
                            <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;magic_method_codes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;magic_method_codes&quot;</span><span class="p">]</span> <span class="o">+</span> \
                                <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">experiment_name</span>
                            <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;magic_method_codes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;magic_method_codes&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span>
                                <span class="s1">&#39;:&#39;</span><span class="p">)</span>
                        <span class="n">rec</span><span class="p">[</span><span class="s1">&#39;measurement_number&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%i</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                            <span class="n">measnum</span><span class="p">)</span>  <span class="c1"># assign measurement numbers</span>
                        <span class="c1">#rec[&#39;sequence&#39;] = &#39;%i&#39;%(seqnum)</span>
                        <span class="c1">#seqnum += 1</span>
                        <span class="n">measnum</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;magic_experiment_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">spec</span> <span class="o">+</span> \
                            <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">experiment_name</span>
                    <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;magic_software_packages&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">version_num</span>
                    <span class="n">SpecOuts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">NewSpecs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;magic_experiment_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">spec</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> \
                <span class="n">NewSpecs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;magic_method_codes&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">NewSpecs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;magic_software_packages&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">version_num</span>
            <span class="c1"># just copy over the single record as is</span>
            <span class="n">SpecOuts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">NewSpecs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">SpecOuts</span></div>


<div class="viewcode-block" id="measurements_methods3"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.measurements_methods3">[docs]</a><span class="k">def</span> <span class="nf">measurements_methods3</span><span class="p">(</span><span class="n">meas_data</span><span class="p">,</span> <span class="n">noave</span><span class="p">,</span><span class="n">savelast</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add necessary method codes, experiment names, sequence, etc.</span>
<span class="sd">    &quot;&quot;&quot;</span>
<span class="c1">#</span>
    <span class="k">if</span> <span class="n">noave</span><span class="p">:</span>
        <span class="n">noave</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">noave</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">savelast</span><span class="p">:</span><span class="n">noave</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">version_num</span> <span class="o">=</span> <span class="n">get_version</span><span class="p">()</span>
    <span class="n">seqnum</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">sids</span> <span class="o">=</span> <span class="n">get_specs</span><span class="p">(</span><span class="n">meas_data</span><span class="p">)</span>
<span class="c1"># list  of measurement records for this specimen</span>
<span class="c1">#</span>
<span class="c1"># step through spec by spec</span>
<span class="c1">#</span>
    <span class="n">SpecTmps</span><span class="p">,</span> <span class="n">SpecOuts</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">spec</span> <span class="ow">in</span> <span class="n">sids</span><span class="p">:</span>
        <span class="n">TRM</span><span class="p">,</span> <span class="n">IRM3D</span><span class="p">,</span> <span class="n">ATRM</span><span class="p">,</span> <span class="n">CR</span><span class="p">,</span> <span class="n">AC</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
        <span class="n">expcodes</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="c1"># first collect all data for this specimen and do lab treatments</span>
        <span class="c1"># list  of measurement records for this specimen</span>
        <span class="n">SpecRecs</span> <span class="o">=</span> <span class="n">get_dictitem</span><span class="p">(</span><span class="n">meas_data</span><span class="p">,</span> <span class="s1">&#39;specimen&#39;</span><span class="p">,</span> <span class="n">spec</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">SpecRecs</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;quality&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                <span class="n">rec</span><span class="p">[</span><span class="s1">&#39;quality&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;g&#39;</span>
            <span class="n">tmpmeths</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="s1">&#39;method_codes&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
            <span class="n">meths</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="s1">&#39;LP-HYS&#39;</span> <span class="ow">in</span> <span class="n">tmpmeths</span><span class="p">:</span>
                <span class="n">HYS</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># catch these!</span>
            <span class="k">if</span> <span class="s2">&quot;LP-TRM&quot;</span> <span class="ow">in</span> <span class="n">tmpmeths</span><span class="p">:</span>
                <span class="n">TRM</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># catch these suckers here!</span>
            <span class="k">if</span> <span class="s2">&quot;LP-IRM-3D&quot;</span> <span class="ow">in</span> <span class="n">tmpmeths</span><span class="p">:</span>
                <span class="n">IRM3D</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># catch these suckers here!</span>
            <span class="k">elif</span> <span class="s2">&quot;LP-AN-TRM&quot;</span> <span class="ow">in</span> <span class="n">tmpmeths</span><span class="p">:</span>
                <span class="n">ATRM</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># catch these suckers here!</span>
            <span class="k">elif</span> <span class="s2">&quot;LP-CR-TRM&quot;</span> <span class="ow">in</span> <span class="n">tmpmeths</span><span class="p">:</span>
                <span class="n">CR</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># catch these suckers here!</span>
            <span class="k">elif</span> <span class="s2">&quot;LT-PTRM-AC&quot;</span> <span class="ow">in</span> <span class="n">tmpmeths</span><span class="p">:</span>
                <span class="n">AC</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># catch these suckers here!</span>
<span class="c1"># Bypass overwriting method codes if &quot;B&quot; and &quot;D&quot; demag types used by Scott Bogue have been used</span>
            <span class="k">elif</span> <span class="n">rec</span><span class="p">[</span><span class="s1">&#39;method_codes&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;LP-ARM:LT-NO:LP-DIR-AF&quot;</span> <span class="ow">or</span> <span class="n">rec</span><span class="p">[</span><span class="s1">&#39;method_codes&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;LP-ARM-AFD:LT-AF-Z:LP-DIR-AF&quot;</span><span class="p">:</span>
                <span class="k">pass</span>
<span class="c1">#</span>
<span class="c1"># otherwise write over existing method codes</span>
<span class="c1">#</span>
<span class="c1"># find NRM data (LT-NO)</span>
<span class="c1">#</span>
      
            <span class="k">elif</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;meas_temp&quot;</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="mf">273.</span> <span class="ow">and</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;meas_temp&quot;</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="mf">323.</span><span class="p">:</span>
                <span class="c1"># between 0 and 50C is room T measurement</span>
                <span class="k">if</span> <span class="p">(</span><span class="s2">&quot;meas_dc_field&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">or</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;meas_dc_field&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;meas_dc_field&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s2">&quot;meas_ac_field&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">or</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;meas_ac_field&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;meas_ac_field&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
                    <span class="c1"># measurement done in zero field!</span>
                    <span class="k">if</span> <span class="s2">&quot;treat_temp&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treat_temp&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treat_temp&quot;</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="mf">273.</span> <span class="ow">and</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treat_temp&quot;</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mf">298.</span><span class="p">):</span>
                        <span class="c1"># between 0 and 50C is room T treatment</span>
                        <span class="k">if</span> <span class="s2">&quot;treat_ac_field&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treat_ac_field&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="ow">or</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treat_ac_field&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="c1"># no AF</span>
                            <span class="c1"># no IRM!</span>
                            <span class="k">if</span> <span class="s2">&quot;treat_dc_field&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treat_dc_field&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="ow">or</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treat_dc_field&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                                <span class="k">if</span> <span class="s2">&quot;LT-NO&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>
                                    <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;LT-NO&quot;</span><span class="p">)</span>
                            <span class="k">elif</span> <span class="s2">&quot;LT-IRM&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>
                                <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;LT-IRM&quot;</span><span class="p">)</span>  <span class="c1"># it&#39;s an IRM</span>
<span class="c1">#</span>
<span class="c1"># find AF/infield/zerofield</span>
<span class="c1">#</span>
                        <span class="c1"># no ARM</span>
                        <span class="k">elif</span> <span class="s2">&quot;treat_dc_field&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">or</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treat_dc_field&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="ow">or</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treat_dc_field&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="k">if</span> <span class="s2">&quot;LT-AF-Z&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>
                                <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;LT-AF-Z&quot;</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>  <span class="c1"># yes ARM</span>
                            <span class="k">if</span> <span class="s2">&quot;LT-AF-I&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>
                                <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;LT-AF-I&quot;</span><span class="p">)</span>
<span class="c1">#</span>
<span class="c1"># find Thermal/infield/zerofield</span>
<span class="c1">#</span>
                    <span class="k">elif</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treat_temp&quot;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">323</span><span class="p">:</span>  <span class="c1"># treatment done at  high T</span>
                        <span class="k">if</span> <span class="n">TRM</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="k">if</span> <span class="s2">&quot;LT-T-I&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>
                                <span class="c1"># TRM - even if zero applied field!</span>
                                <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;LT-T-I&quot;</span><span class="p">)</span>
                        <span class="c1"># no TRM</span>
                        <span class="k">elif</span> <span class="s2">&quot;treat_dc_field&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">or</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treat_dc_field&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="ow">or</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treat_dc_field&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="mf">0.</span><span class="p">:</span>
                            <span class="k">if</span> <span class="s2">&quot;LT-T-Z&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>
                                <span class="c1"># don&#39;t overwrite if part of a TRM experiment!</span>
                                <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;LT-T-Z&quot;</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>  <span class="c1"># yes TRM</span>
                            <span class="k">if</span> <span class="s2">&quot;LT-T-I&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>
                                <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;LT-T-I&quot;</span><span class="p">)</span>
<span class="c1">#</span>
<span class="c1"># find low-T infield,zero field</span>
<span class="c1">#</span>
                    <span class="k">else</span><span class="p">:</span>  <span class="c1"># treatment done at low T</span>
                        <span class="c1"># no field</span>
                        <span class="k">if</span> <span class="s2">&quot;treat_dc_field&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">or</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treat_dc_field&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="ow">or</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treat_dc_field&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="k">if</span> <span class="s2">&quot;LT-LT-Z&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>
                                <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;LT-LT-Z&quot;</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>  <span class="c1"># yes field</span>
                            <span class="k">if</span> <span class="s2">&quot;LT-LT-I&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>
                                <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;LT-LT-I&quot;</span><span class="p">)</span>

                <span class="k">if</span> <span class="s2">&quot;susc_chi_volume&quot;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">or</span> <span class="s2">&quot;susc_chi_mass&quot;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                    <span class="k">if</span> <span class="s2">&quot;LP-X&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>
                        <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;LP-X&quot;</span><span class="p">)</span>
                <span class="c1"># measurement in presence of dc field and not susceptibility;</span>
                <span class="c1"># hysteresis!</span>
                <span class="k">elif</span> <span class="s2">&quot;meas_lab_dc_field&quot;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;meas_lab_dc_field&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="c1"># if &quot;LP-HYS&quot; not in meths:</span>
                    <span class="c1">#    hysq = input(&quot;Is this a hysteresis experiment? [1]/0&quot;)</span>
                    <span class="c1">#    if hysq == &quot;&quot; or hysq == &quot;1&quot;:</span>
                    <span class="c1">#        meths.append(&quot;LP-HYS&quot;)</span>
                    <span class="c1">#    else:</span>
                    <span class="c1">#        metha = input(</span>
                    <span class="c1">#            &quot;Enter the lab protocol code that best describes this experiment &quot;)</span>
                    <span class="c1">#        meths.append(metha)</span>
                    <span class="k">if</span> <span class="n">HYS</span><span class="p">:</span>
                        <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;LP-HYS&quot;</span><span class="p">)</span>
                <span class="n">methcode</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                <span class="k">for</span> <span class="n">meth</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>
                    <span class="n">methcode</span> <span class="o">=</span> <span class="n">methcode</span> <span class="o">+</span> <span class="n">meth</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span>
                <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;method_codes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">methcode</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># assign them back</span>
<span class="c1">#</span>
<span class="c1"># done with first pass, collect and assign provisional method codes</span>
            <span class="k">if</span> <span class="s2">&quot;description&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;description&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">if</span> <span class="s2">&quot;standard&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;standard&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;s&quot;</span>
            <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;citations&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;This study&quot;</span>
            <span class="n">SpecTmps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">)</span>
<span class="c1"># ready for second pass through, step through specimens, check whether ptrm, ptrm tail checks, or AARM, etc.</span>
<span class="c1">#</span>
    <span class="k">for</span> <span class="n">spec</span> <span class="ow">in</span> <span class="n">sids</span><span class="p">:</span>
        <span class="n">MD</span><span class="p">,</span> <span class="n">pTRM</span><span class="p">,</span> <span class="n">IZ</span><span class="p">,</span> <span class="n">ZI</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>  <span class="c1"># these are flags for the lab protocol codes</span>
        <span class="n">expcodes</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">NewSpecs</span><span class="p">,</span> <span class="n">SpecMeths</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="n">experiment_name</span><span class="p">,</span> <span class="n">measnum</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">IRM3D</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">experiment_name</span> <span class="o">=</span> <span class="s2">&quot;LP-IRM-3D&quot;</span>
        <span class="k">if</span> <span class="n">ATRM</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">experiment_name</span> <span class="o">=</span> <span class="s2">&quot;LP-AN-TRM&quot;</span>
        <span class="k">if</span> <span class="n">CR</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">experiment_name</span> <span class="o">=</span> <span class="s2">&quot;LP-CR&quot;</span>
        <span class="n">NewSpecs</span> <span class="o">=</span> <span class="n">get_dictitem</span><span class="p">(</span><span class="n">SpecTmps</span><span class="p">,</span> <span class="s1">&#39;specimen&#39;</span><span class="p">,</span> <span class="n">spec</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">)</span>
<span class="c1">#</span>
<span class="c1"># first look for replicate measurements</span>
<span class="c1">#</span>
        <span class="n">Ninit</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">NewSpecs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">savelast</span><span class="p">:</span>
            <span class="n">NewSpecs</span><span class="o">=</span><span class="n">NewSpecs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># just keep thelast one</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">noave</span><span class="p">:</span>
            <span class="c1"># averages replicate measurements, returns treatment keys that are</span>
            <span class="c1"># being used</span>
            <span class="n">vdata</span><span class="p">,</span> <span class="n">treatkeys</span> <span class="o">=</span> <span class="n">vspec_magic3</span><span class="p">(</span><span class="n">NewSpecs</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">vdata</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">NewSpecs</span><span class="p">):</span>
                <span class="c1"># print spec,&#39;started with &#39;,Ninit,&#39; ending with &#39;,len(vdata)</span>
                <span class="n">NewSpecs</span> <span class="o">=</span> <span class="n">vdata</span>
                <span class="c1"># print &quot;Averaged replicate measurements&quot;</span>
<span class="c1">#</span>
<span class="c1"># now look through this specimen&#39;s records - try to figure out what experiment it is</span>
<span class="c1">#</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">NewSpecs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># more than one meas for this spec - part of an unknown experiment</span>
            <span class="n">SpecMeths</span> <span class="o">=</span> <span class="n">get_list</span><span class="p">(</span><span class="n">NewSpecs</span><span class="p">,</span> <span class="s1">&#39;method_codes&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
            <span class="c1"># TRM steps, could be TRM acquisition, Shaw or a Thellier</span>
            <span class="c1"># experiment or TDS experiment</span>
            <span class="k">if</span> <span class="s2">&quot;LT-T-I&quot;</span> <span class="ow">in</span> <span class="n">SpecMeths</span> <span class="ow">and</span> <span class="n">experiment_name</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="c1">#</span>
                <span class="c1"># collect all the infield steps and look for changes in dc field vector</span>
                <span class="c1">#</span>
                <span class="n">Steps</span><span class="p">,</span> <span class="n">TI</span> <span class="o">=</span> <span class="p">[],</span> <span class="mi">1</span>
                <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">NewSpecs</span><span class="p">:</span>
                    <span class="n">methods</span> <span class="o">=</span> <span class="n">get_list</span><span class="p">(</span><span class="n">NewSpecs</span><span class="p">,</span> <span class="s1">&#39;method_codes&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="s2">&quot;LT-T-I&quot;</span> <span class="ow">in</span> <span class="n">methods</span><span class="p">:</span>
                        <span class="n">Steps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">)</span>  <span class="c1"># get all infield steps together</span>
                <span class="n">rec_bak</span> <span class="o">=</span> <span class="n">Steps</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="s2">&quot;treat_dc_field_phi&quot;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec_bak</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="s2">&quot;treat_dc_field_theta&quot;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec_bak</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                    <span class="c1"># at least there is field orientation info</span>
                    <span class="k">if</span> <span class="n">rec_bak</span><span class="p">[</span><span class="s2">&quot;treat_dc_field_phi&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span> <span class="ow">and</span> <span class="n">rec_bak</span><span class="p">[</span><span class="s2">&quot;treat_dc_field_theta&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                        <span class="n">phi0</span><span class="p">,</span> <span class="n">theta0</span> <span class="o">=</span> <span class="n">rec_bak</span><span class="p">[</span><span class="s2">&quot;treat_dc_field_phi&quot;</span><span class="p">],</span> <span class="n">rec_bak</span><span class="p">[</span><span class="s2">&quot;treat_dc_field_theta&quot;</span><span class="p">]</span>
                        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">Steps</span><span class="p">)):</span>
                            <span class="n">rec</span> <span class="o">=</span> <span class="n">Steps</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                            <span class="n">phi</span><span class="p">,</span> <span class="n">theta</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treat_dc_field_phi&quot;</span><span class="p">],</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treat_dc_field_theta&quot;</span><span class="p">]</span>
                            <span class="k">if</span> <span class="n">phi</span> <span class="o">!=</span> <span class="n">phi0</span> <span class="ow">or</span> <span class="n">theta</span> <span class="o">!=</span> <span class="n">theta0</span><span class="p">:</span>
                                <span class="n">ANIS</span> <span class="o">=</span> <span class="mi">1</span>   <span class="c1"># if direction changes, is some sort of anisotropy experiment</span>
                <span class="k">if</span> <span class="s2">&quot;LT-AF-I&quot;</span> <span class="ow">in</span> <span class="n">SpecMeths</span> <span class="ow">and</span> <span class="s2">&quot;LT-AF-Z&quot;</span> <span class="ow">in</span> <span class="n">SpecMeths</span><span class="p">:</span>  <span class="c1"># must be Shaw :(</span>
                    <span class="n">experiment_name</span> <span class="o">=</span> <span class="s2">&quot;LP-PI-TRM:LP-PI-ALT-AFARM&quot;</span>
                <span class="k">elif</span> <span class="n">TRM</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">experiment_name</span> <span class="o">=</span> <span class="s2">&quot;LP-TRM&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">TI</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># no infield steps at all</span>
            <span class="k">if</span> <span class="p">(</span><span class="s2">&quot;LT-T-Z&quot;</span> <span class="ow">in</span> <span class="n">SpecMeths</span> <span class="ow">or</span> <span class="s2">&quot;LT-LT-Z&quot;</span> <span class="ow">in</span> <span class="n">SpecMeths</span><span class="p">)</span> <span class="ow">and</span> <span class="n">experiment_name</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>  <span class="c1"># thermal demag steps</span>
                <span class="k">if</span> <span class="n">TI</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">experiment_name</span> <span class="o">=</span> <span class="s2">&quot;LP-DIR-T&quot;</span>  <span class="c1"># just ordinary thermal demag</span>
                <span class="k">elif</span> <span class="n">TRM</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># heart pounding - could be some  kind of TRM normalized paleointensity or LP-TRM-TD experiment</span>
                    <span class="n">Temps</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">Steps</span><span class="p">:</span>  <span class="c1"># check through the infield steps - if all at same temperature, then must be a demag of a total TRM with checks</span>
                        <span class="k">if</span> <span class="n">step</span><span class="p">[</span><span class="s1">&#39;treat_temp&#39;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">Temps</span><span class="p">:</span>
                            <span class="n">Temps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">step</span><span class="p">[</span><span class="s1">&#39;treat_temp&#39;</span><span class="p">])</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">Temps</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">experiment_name</span> <span class="o">=</span> <span class="s2">&quot;LP-PI-TRM&quot;</span>  <span class="c1"># paleointensity normalized by TRM</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="c1"># thermal demag of a lab TRM (could be part of a</span>
                        <span class="c1"># LP-PI-TDS experiment)</span>
                        <span class="n">experiment_name</span> <span class="o">=</span> <span class="s2">&quot;LP-TRM-TD&quot;</span>
                <span class="n">TZ</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">TZ</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># no zero field steps at all</span>
            <span class="k">if</span> <span class="s2">&quot;LT-AF-I&quot;</span> <span class="ow">in</span> <span class="n">SpecMeths</span><span class="p">:</span>  <span class="c1"># ARM steps</span>
                <span class="n">Steps</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">NewSpecs</span><span class="p">:</span>
                    <span class="n">tmp</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;method_codes&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
                    <span class="n">methods</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">meth</span> <span class="ow">in</span> <span class="n">tmp</span><span class="p">:</span>
                        <span class="n">methods</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">meth</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
                    <span class="k">if</span> <span class="s2">&quot;LT-AF-I&quot;</span> <span class="ow">in</span> <span class="n">methods</span><span class="p">:</span>
                        <span class="n">Steps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">)</span>  <span class="c1"># get all infield steps together</span>
                <span class="n">rec_bak</span> <span class="o">=</span> <span class="n">Steps</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="s2">&quot;treat_dc_field_phi&quot;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec_bak</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="s2">&quot;treat_dc_field_theta&quot;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec_bak</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                    <span class="c1"># at least there is field orientation info</span>
                    <span class="k">if</span> <span class="n">rec_bak</span><span class="p">[</span><span class="s2">&quot;treat_dc_field_phi&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span> <span class="ow">and</span> <span class="n">rec_bak</span><span class="p">[</span><span class="s2">&quot;treat_dc_field_theta&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                        <span class="n">phi0</span><span class="p">,</span> <span class="n">theta0</span> <span class="o">=</span> <span class="n">rec_bak</span><span class="p">[</span><span class="s2">&quot;treat_dc_field_phi&quot;</span><span class="p">],</span> <span class="n">rec_bak</span><span class="p">[</span><span class="s2">&quot;treat_dc_field_theta&quot;</span><span class="p">]</span>
                        <span class="n">ANIS</span> <span class="o">=</span> <span class="mi">0</span>
                        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">Steps</span><span class="p">)):</span>
                            <span class="n">rec</span> <span class="o">=</span> <span class="n">Steps</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                            <span class="n">phi</span><span class="p">,</span> <span class="n">theta</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treat_dc_field_phi&quot;</span><span class="p">],</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treat_dc_field_theta&quot;</span><span class="p">]</span>
                            <span class="k">if</span> <span class="n">phi</span> <span class="o">!=</span> <span class="n">phi0</span> <span class="ow">or</span> <span class="n">theta</span> <span class="o">!=</span> <span class="n">theta0</span><span class="p">:</span>
                                <span class="n">ANIS</span> <span class="o">=</span> <span class="mi">1</span>   <span class="c1"># if direction changes, is some sort of anisotropy experiment</span>
                        <span class="k">if</span> <span class="n">ANIS</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="n">experiment_name</span> <span class="o">=</span> <span class="s2">&quot;LP-AN-ARM&quot;</span>
                <span class="k">if</span> <span class="n">experiment_name</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>  <span class="c1"># not anisotropy of ARM - acquisition?</span>
                    <span class="n">field0</span> <span class="o">=</span> <span class="n">rec_bak</span><span class="p">[</span><span class="s2">&quot;treat_dc_field&quot;</span><span class="p">]</span>
                    <span class="n">ARM</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">Steps</span><span class="p">)):</span>
                        <span class="n">rec</span> <span class="o">=</span> <span class="n">Steps</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                        <span class="n">field</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treat_dc_field&quot;</span><span class="p">]</span>
                        <span class="k">if</span> <span class="n">field</span> <span class="o">!=</span> <span class="n">field0</span><span class="p">:</span>
                            <span class="n">ARM</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="k">if</span> <span class="n">ARM</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">experiment_name</span> <span class="o">=</span> <span class="s2">&quot;LP-ARM&quot;</span>
                <span class="n">AFI</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">AFI</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># no ARM steps at all</span>
            <span class="k">if</span> <span class="s2">&quot;LT-AF-Z&quot;</span> <span class="ow">in</span> <span class="n">SpecMeths</span> <span class="ow">and</span> <span class="n">experiment_name</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>  <span class="c1"># AF demag steps</span>
                <span class="k">if</span> <span class="n">AFI</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">experiment_name</span> <span class="o">=</span> <span class="s2">&quot;LP-DIR-AF&quot;</span>  <span class="c1"># just ordinary AF demag</span>
                <span class="k">else</span><span class="p">:</span>  <span class="c1"># heart pounding - a pseudothellier?</span>
                    <span class="n">experiment_name</span> <span class="o">=</span> <span class="s2">&quot;LP-PI-ARM&quot;</span>
                <span class="n">AFZ</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">AFZ</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># no AF demag at all</span>
            <span class="k">if</span> <span class="s2">&quot;LT-IRM&quot;</span> <span class="ow">in</span> <span class="n">SpecMeths</span><span class="p">:</span>  <span class="c1"># IRM</span>
                <span class="n">Steps</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">NewSpecs</span><span class="p">:</span>
                    <span class="n">tmp</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;method_codes&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
                    <span class="n">methods</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">meth</span> <span class="ow">in</span> <span class="n">tmp</span><span class="p">:</span>
                        <span class="n">methods</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">meth</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
                    <span class="k">if</span> <span class="s2">&quot;LT-IRM&quot;</span> <span class="ow">in</span> <span class="n">methods</span><span class="p">:</span>
                        <span class="n">Steps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">)</span>  <span class="c1"># get all infield steps together</span>
                <span class="n">rec_bak</span> <span class="o">=</span> <span class="n">Steps</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="s2">&quot;treat_dc_field_phi&quot;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec_bak</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="s2">&quot;treat_dc_field_theta&quot;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec_bak</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                    <span class="c1"># at least there is field orientation info</span>
                    <span class="k">if</span> <span class="n">rec_bak</span><span class="p">[</span><span class="s2">&quot;treat_dc_field_phi&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span> <span class="ow">and</span> <span class="n">rec_bak</span><span class="p">[</span><span class="s2">&quot;treat_dc_field_theta&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                        <span class="n">phi0</span><span class="p">,</span> <span class="n">theta0</span> <span class="o">=</span> <span class="n">rec_bak</span><span class="p">[</span><span class="s2">&quot;treat_dc_field_phi&quot;</span><span class="p">],</span> <span class="n">rec_bak</span><span class="p">[</span><span class="s2">&quot;treat_dc_field_theta&quot;</span><span class="p">]</span>
                        <span class="n">ANIS</span> <span class="o">=</span> <span class="mi">0</span>
                        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">Steps</span><span class="p">)):</span>
                            <span class="n">rec</span> <span class="o">=</span> <span class="n">Steps</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                            <span class="n">phi</span><span class="p">,</span> <span class="n">theta</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treat_dc_field_phi&quot;</span><span class="p">],</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treat_dc_field_theta&quot;</span><span class="p">]</span>
                            <span class="k">if</span> <span class="n">phi</span> <span class="o">!=</span> <span class="n">phi0</span> <span class="ow">or</span> <span class="n">theta</span> <span class="o">!=</span> <span class="n">theta0</span><span class="p">:</span>
                                <span class="n">ANIS</span> <span class="o">=</span> <span class="mi">1</span>   <span class="c1"># if direction changes, is some sort of anisotropy experiment</span>
                        <span class="k">if</span> <span class="n">ANIS</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="n">experiment_name</span> <span class="o">=</span> <span class="s2">&quot;LP-AN-IRM&quot;</span>
                <span class="k">if</span> <span class="n">experiment_name</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>  <span class="c1"># not anisotropy of IRM - acquisition?</span>
                    <span class="n">field0</span> <span class="o">=</span> <span class="n">rec_bak</span><span class="p">[</span><span class="s2">&quot;treat_dc_field&quot;</span><span class="p">]</span>
                    <span class="n">IRM</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">Steps</span><span class="p">)):</span>
                        <span class="n">rec</span> <span class="o">=</span> <span class="n">Steps</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                        <span class="n">field</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treat_dc_field&quot;</span><span class="p">]</span>
                        <span class="k">if</span> <span class="n">field</span> <span class="o">!=</span> <span class="n">field0</span><span class="p">:</span>
                            <span class="n">IRM</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="k">if</span> <span class="n">IRM</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">experiment_name</span> <span class="o">=</span> <span class="s2">&quot;LP-IRM&quot;</span>
                <span class="n">IRM</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">IRM</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># no IRM at all</span>
            <span class="k">if</span> <span class="s2">&quot;LP-X&quot;</span> <span class="ow">in</span> <span class="n">SpecMeths</span><span class="p">:</span>  <span class="c1"># susceptibility run</span>
                <span class="n">Steps</span> <span class="o">=</span> <span class="n">get_dictitem</span><span class="p">(</span><span class="n">NewSpecs</span><span class="p">,</span> <span class="s1">&#39;method_codes&#39;</span><span class="p">,</span> <span class="s1">&#39;LT-X&#39;</span><span class="p">,</span> <span class="s1">&#39;has&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">Steps</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">rec_bak</span> <span class="o">=</span> <span class="n">Steps</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">if</span> <span class="s2">&quot;treat_dc_field_phi&quot;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec_bak</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="s2">&quot;treat_dc_field_theta&quot;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec_bak</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                        <span class="c1"># at least there is field orientation info</span>
                        <span class="k">if</span> <span class="n">rec_bak</span><span class="p">[</span><span class="s2">&quot;treat_dc_field_phi&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span> <span class="ow">and</span> <span class="n">rec_bak</span><span class="p">[</span><span class="s2">&quot;treat_dc_field_theta&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                            <span class="n">phi0</span><span class="p">,</span> <span class="n">theta0</span> <span class="o">=</span> <span class="n">rec_bak</span><span class="p">[</span><span class="s2">&quot;treat_dc_field_phi&quot;</span><span class="p">],</span> <span class="n">rec_bak</span><span class="p">[</span><span class="s2">&quot;treat_dc_field_theta&quot;</span><span class="p">]</span>
                            <span class="n">ANIS</span> <span class="o">=</span> <span class="mi">0</span>
                            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">Steps</span><span class="p">)):</span>
                                <span class="n">rec</span> <span class="o">=</span> <span class="n">Steps</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                                <span class="n">phi</span><span class="p">,</span> <span class="n">theta</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treat_dc_field_phi&quot;</span><span class="p">],</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treat_dc_field_theta&quot;</span><span class="p">]</span>
                                <span class="k">if</span> <span class="n">phi</span> <span class="o">!=</span> <span class="n">phi0</span> <span class="ow">or</span> <span class="n">theta</span> <span class="o">!=</span> <span class="n">theta0</span><span class="p">:</span>
                                    <span class="n">ANIS</span> <span class="o">=</span> <span class="mi">1</span>   <span class="c1"># if direction changes, is some sort of anisotropy experiment</span>
                            <span class="k">if</span> <span class="n">ANIS</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                                <span class="n">experiment_name</span> <span class="o">=</span> <span class="s2">&quot;LP-AN-MS&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">CHI</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># no susceptibility at all</span>
    <span class="c1">#</span>
    <span class="c1"># now need to deal with special thellier experiment problems - first clear up pTRM checks and  tail checks</span>
    <span class="c1">#</span>
            <span class="k">if</span> <span class="n">experiment_name</span> <span class="o">==</span> <span class="s2">&quot;LP-PI-TRM&quot;</span><span class="p">:</span>  <span class="c1"># is some sort of thellier experiment</span>
                <span class="n">rec_bak</span> <span class="o">=</span> <span class="n">NewSpecs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">tmp</span> <span class="o">=</span> <span class="n">rec_bak</span><span class="p">[</span><span class="s2">&quot;method_codes&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
                <span class="n">methbak</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">meth</span> <span class="ow">in</span> <span class="n">tmp</span><span class="p">:</span>
                    <span class="n">methbak</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">meth</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>  <span class="c1"># previous steps method codes</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">NewSpecs</span><span class="p">)):</span>
                    <span class="n">rec</span> <span class="o">=</span> <span class="n">NewSpecs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                    <span class="n">tmp</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;method_codes&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
                    <span class="n">meths</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">meth</span> <span class="ow">in</span> <span class="n">tmp</span><span class="p">:</span>
                        <span class="c1"># get this guys method codes</span>
                        <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">meth</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
    <span class="c1">#</span>
    <span class="c1"># check if this is a pTRM check</span>
    <span class="c1">#</span>
                    <span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treat_temp&quot;</span><span class="p">])</span> <span class="o">&lt;</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec_bak</span><span class="p">[</span><span class="s2">&quot;treat_temp&quot;</span><span class="p">]):</span>  <span class="c1"># went backward</span>
                        <span class="k">if</span> <span class="s2">&quot;LT-PTRM-AC&quot;</span> <span class="ow">in</span> <span class="n">rec</span><span class="p">[</span><span class="s1">&#39;method_codes&#39;</span><span class="p">]:</span>
                            <span class="n">methcodes</span> <span class="o">=</span> <span class="n">methcodes</span> <span class="o">+</span> <span class="s2">&quot;LT-PTRM-AC&quot;</span>
                        <span class="k">elif</span> <span class="s2">&quot;LT-T-I&quot;</span> <span class="ow">in</span> <span class="n">meths</span> <span class="ow">and</span> <span class="s2">&quot;LT-T-Z&quot;</span> <span class="ow">in</span> <span class="n">methbak</span><span class="p">:</span>  <span class="c1"># must be a pTRM check after first z</span>
                            <span class="c1">#</span>
                            <span class="c1"># replace LT-T-I method code with LT-PTRM-I</span>
                            <span class="c1">#</span>
                            <span class="n">methcodes</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                            <span class="k">for</span> <span class="n">meth</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>
                                <span class="k">if</span> <span class="n">meth</span> <span class="o">!=</span> <span class="s2">&quot;LT-T-I&quot;</span><span class="p">:</span>
                                    <span class="n">methcode</span> <span class="o">=</span> <span class="n">methcode</span> <span class="o">+</span> <span class="n">meth</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span>
                            <span class="n">methcodes</span> <span class="o">=</span> <span class="n">methcodes</span> <span class="o">+</span> <span class="s2">&quot;LT-PTRM-I&quot;</span>
                            <span class="n">meths</span> <span class="o">=</span> <span class="n">methcodes</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
                            <span class="n">pTRM</span> <span class="o">=</span> <span class="mi">1</span>
                        <span class="k">elif</span> <span class="s2">&quot;LT-T-Z&quot;</span> <span class="ow">in</span> <span class="n">meths</span> <span class="ow">and</span> <span class="s2">&quot;LT-T-I&quot;</span> <span class="ow">in</span> <span class="n">methbak</span><span class="p">:</span>  <span class="c1"># must be pTRM check after first I</span>
                            <span class="c1">#</span>
                            <span class="c1"># replace LT-T-Z method code with LT-PTRM-Z</span>
                            <span class="c1">#</span>
                            <span class="n">methcodes</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                            <span class="k">for</span> <span class="n">meth</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>
                                <span class="k">if</span> <span class="n">meth</span> <span class="o">!=</span> <span class="s2">&quot;LT-T-Z&quot;</span><span class="p">:</span>
                                    <span class="n">methcode</span> <span class="o">=</span> <span class="n">methcode</span> <span class="o">+</span> <span class="n">meth</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span>
                            <span class="n">methcodes</span> <span class="o">=</span> <span class="n">methcodes</span> <span class="o">+</span> <span class="s2">&quot;LT-PTRM-Z&quot;</span>
                            <span class="n">meths</span> <span class="o">=</span> <span class="n">methcodes</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
                            <span class="n">pTRM</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="n">methcodes</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                    <span class="k">for</span> <span class="n">meth</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>
                        <span class="n">methcodes</span> <span class="o">=</span> <span class="n">methcodes</span> <span class="o">+</span> <span class="n">meth</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span>
                    <span class="c1"># attach new method code</span>
                    <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;method_codes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">methcodes</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">rec_bak</span> <span class="o">=</span> <span class="n">rec</span>  <span class="c1"># next previous record</span>
                    <span class="n">tmp</span> <span class="o">=</span> <span class="n">rec_bak</span><span class="p">[</span><span class="s2">&quot;method_codes&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
                    <span class="n">methbak</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">meth</span> <span class="ow">in</span> <span class="n">tmp</span><span class="p">:</span>
                        <span class="c1"># previous steps method codes</span>
                        <span class="n">methbak</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">meth</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
    <span class="c1">#</span>
    <span class="c1"># done with assigning pTRM checks.  data should be &quot;fixed&quot; in NewSpecs</span>
    <span class="c1">#</span>
    <span class="c1"># now let&#39;s find out which steps are infield zerofield (IZ) and which are zerofield infield (ZI)</span>
    <span class="c1">#</span>
                <span class="n">rec_bak</span> <span class="o">=</span> <span class="n">NewSpecs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">tmp</span> <span class="o">=</span> <span class="n">rec_bak</span><span class="p">[</span><span class="s2">&quot;method_codes&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
                <span class="n">methbak</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">meth</span> <span class="ow">in</span> <span class="n">tmp</span><span class="p">:</span>
                    <span class="n">methbak</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">meth</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>  <span class="c1"># previous steps method codes</span>
                <span class="k">if</span> <span class="s2">&quot;LT-NO&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">methbak</span><span class="p">:</span>  <span class="c1"># first measurement is not NRM</span>
                    <span class="k">if</span> <span class="s2">&quot;LT-T-I&quot;</span> <span class="ow">in</span> <span class="n">methbak</span><span class="p">:</span>
                        <span class="n">IZorZI</span> <span class="o">=</span> <span class="s2">&quot;LP-PI-TRM-IZ&quot;</span>  <span class="c1"># first pair is IZ</span>
                    <span class="k">if</span> <span class="s2">&quot;LT-T-Z&quot;</span> <span class="ow">in</span> <span class="n">methbak</span><span class="p">:</span>
                        <span class="n">IZorZI</span> <span class="o">=</span> <span class="s2">&quot;LP-PI-TRM-ZI&quot;</span>  <span class="c1"># first pair is ZI</span>
                    <span class="k">if</span> <span class="n">IZorZI</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">methbak</span><span class="p">:</span>
                        <span class="n">methbak</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">IZorZI</span><span class="p">)</span>
                    <span class="n">methcode</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                    <span class="k">for</span> <span class="n">meth</span> <span class="ow">in</span> <span class="n">methbak</span><span class="p">:</span>
                        <span class="n">methcode</span> <span class="o">=</span> <span class="n">methcode</span> <span class="o">+</span> <span class="n">meth</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span>
                    <span class="c1"># fix first heating step when no NRM</span>
                    <span class="n">NewSpecs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;method_codes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">methcode</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">IZorZI</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>  <span class="c1"># first measurement is NRM and not one of a pair</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">NewSpecs</span><span class="p">)):</span>  <span class="c1"># hunt through measurements again</span>
                    <span class="n">rec</span> <span class="o">=</span> <span class="n">NewSpecs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                    <span class="n">tmp</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;method_codes&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
                    <span class="n">meths</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">meth</span> <span class="ow">in</span> <span class="n">tmp</span><span class="p">:</span>
                        <span class="c1"># get this guys method codes</span>
                        <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">meth</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
    <span class="c1">#</span>
    <span class="c1"># check if this start a new temperature step of a infield/zerofield pair</span>
    <span class="c1">#</span>
                    <span class="c1"># new pair?</span>
                    <span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treat_temp&quot;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec_bak</span><span class="p">[</span><span class="s2">&quot;treat_temp&quot;</span><span class="p">])</span> <span class="ow">and</span> <span class="s2">&quot;LT-PTRM-I&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">methbak</span><span class="p">:</span>
                        <span class="k">if</span> <span class="s2">&quot;LT-T-I&quot;</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>  <span class="c1"># infield of this pair</span>
                            <span class="n">IZorZI</span> <span class="o">=</span> <span class="s2">&quot;LP-PI-TRM-IZ&quot;</span>
                            <span class="n">IZ</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># at least one IZ pair</span>
                        <span class="k">elif</span> <span class="s2">&quot;LT-T-Z&quot;</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>  <span class="c1"># zerofield</span>
                            <span class="n">IZorZI</span> <span class="o">=</span> <span class="s2">&quot;LP-PI-TRM-ZI&quot;</span>
                            <span class="n">ZI</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># at least one ZI pair</span>
                    <span class="c1"># new pair after out of sequence PTRM check?</span>
                    <span class="k">elif</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treat_temp&quot;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec_bak</span><span class="p">[</span><span class="s2">&quot;treat_temp&quot;</span><span class="p">])</span> <span class="ow">and</span> <span class="s2">&quot;LT-PTRM-I&quot;</span> <span class="ow">in</span> <span class="n">methbak</span> <span class="ow">and</span> <span class="n">IZorZI</span> <span class="o">!=</span> <span class="s2">&quot;LP-PI-TRM-ZI&quot;</span><span class="p">:</span>
                        <span class="k">if</span> <span class="s2">&quot;LT-T-I&quot;</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>  <span class="c1"># infield of this pair</span>
                            <span class="n">IZorZI</span> <span class="o">=</span> <span class="s2">&quot;LP-PI-TRM-IZ&quot;</span>
                            <span class="n">IZ</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># at least one IZ pair</span>
                        <span class="k">elif</span> <span class="s2">&quot;LT-T-Z&quot;</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>  <span class="c1"># zerofield</span>
                            <span class="n">IZorZI</span> <span class="o">=</span> <span class="s2">&quot;LP-PI-TRM-ZI&quot;</span>
                            <span class="n">ZI</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># at least one ZI pair</span>
                    <span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treat_temp&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec_bak</span><span class="p">[</span><span class="s2">&quot;treat_temp&quot;</span><span class="p">]):</span>  <span class="c1"># stayed same temp</span>
                        <span class="k">if</span> <span class="s2">&quot;LT-T-Z&quot;</span> <span class="ow">in</span> <span class="n">meths</span> <span class="ow">and</span> <span class="s2">&quot;LT-T-I&quot;</span> <span class="ow">in</span> <span class="n">methbak</span> <span class="ow">and</span> <span class="n">IZorZI</span> <span class="o">==</span> <span class="s2">&quot;LP-PI-TRM-ZI&quot;</span><span class="p">:</span>  <span class="c1"># must be a tail check</span>
                            <span class="c1">#</span>
                            <span class="c1"># replace LT-T-Z method code with LT-PTRM-MD</span>
                            <span class="c1">#</span>
                            <span class="n">methcodes</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                            <span class="k">for</span> <span class="n">meth</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>
                                <span class="k">if</span> <span class="n">meth</span> <span class="o">!=</span> <span class="s2">&quot;LT-T-Z&quot;</span><span class="p">:</span>
                                    <span class="n">methcode</span> <span class="o">=</span> <span class="n">methcode</span> <span class="o">+</span> <span class="n">meth</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span>
                            <span class="n">methcodes</span> <span class="o">=</span> <span class="n">methcodes</span> <span class="o">+</span> <span class="s2">&quot;LT-PTRM-MD&quot;</span>
                            <span class="n">meths</span> <span class="o">=</span> <span class="n">methcodes</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
                            <span class="n">MD</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="c1"># fix method codes</span>
                    <span class="k">if</span> <span class="s2">&quot;LT-PTRM-I&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">meths</span> <span class="ow">and</span> <span class="s2">&quot;LT-PTRM-MD&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">meths</span> <span class="ow">and</span> <span class="n">IZorZI</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>
                        <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">IZorZI</span><span class="p">)</span>
                    <span class="n">newmeths</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">meth</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">meth</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">newmeths</span><span class="p">:</span>
                            <span class="n">newmeths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">meth</span><span class="p">)</span>  <span class="c1"># try to get uniq set</span>
                    <span class="n">methcode</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                    <span class="k">for</span> <span class="n">meth</span> <span class="ow">in</span> <span class="n">newmeths</span><span class="p">:</span>
                        <span class="n">methcode</span> <span class="o">=</span> <span class="n">methcode</span> <span class="o">+</span> <span class="n">meth</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span>
                    <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;method_codes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">methcode</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">rec_bak</span> <span class="o">=</span> <span class="n">rec</span>  <span class="c1"># moving on to next record, making current one the backup</span>
                    <span class="c1"># get last specimen&#39;s method codes in a list</span>
                    <span class="n">methbak</span> <span class="o">=</span> <span class="n">rec_bak</span><span class="p">[</span><span class="s2">&quot;method_codes&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>

    <span class="c1">#</span>
    <span class="c1"># done with this specimen&#39;s records, now  check if any pTRM checks or MD checks</span>
    <span class="c1">#</span>
                <span class="k">if</span> <span class="n">pTRM</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">experiment_name</span> <span class="o">=</span> <span class="n">experiment_name</span> <span class="o">+</span> <span class="s2">&quot;:LP-PI-ALT-PTRM&quot;</span>
                <span class="k">if</span> <span class="n">MD</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">experiment_name</span> <span class="o">=</span> <span class="n">experiment_name</span> <span class="o">+</span> <span class="s2">&quot;:LP-PI-BT-MD&quot;</span>
                <span class="k">if</span> <span class="n">IZ</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">ZI</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">experiment_name</span> <span class="o">=</span> <span class="n">experiment_name</span> <span class="o">+</span> <span class="s2">&quot;:LP-PI-BT-IZZI&quot;</span>
                <span class="k">if</span> <span class="n">IZ</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">ZI</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">experiment_name</span> <span class="o">=</span> <span class="n">experiment_name</span> <span class="o">+</span> <span class="s2">&quot;:LP-PI-IZ&quot;</span>  <span class="c1"># Aitken method</span>
                <span class="k">if</span> <span class="n">IZ</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">ZI</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">experiment_name</span> <span class="o">=</span> <span class="n">experiment_name</span> <span class="o">+</span> <span class="s2">&quot;:LP-PI-ZI&quot;</span>  <span class="c1"># Coe method</span>
                <span class="n">IZ</span><span class="p">,</span> <span class="n">ZI</span><span class="p">,</span> <span class="n">pTRM</span><span class="p">,</span> <span class="n">MD</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>  <span class="c1"># reset these for next specimen</span>
                <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">NewSpecs</span><span class="p">:</span>  <span class="c1"># fix the experiment name for all recs for this specimen and save in SpecOuts</span>
                    <span class="c1"># assign an experiment name to all specimen measurements</span>
                    <span class="c1"># from this specimen</span>
                    <span class="k">if</span> <span class="n">experiment_name</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                        <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;method_codes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;method_codes&quot;</span><span class="p">]</span> <span class="o">+</span> \
                            <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">experiment_name</span>
                    <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;experiment&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">spec</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">experiment_name</span>
                    <span class="n">rec</span><span class="p">[</span><span class="s1">&#39;treat_step_num&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%i</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                        <span class="n">measnum</span><span class="p">)</span>  <span class="c1"># assign measurement numbers</span>
                    <span class="n">rec</span><span class="p">[</span><span class="s1">&#39;sequence&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%i</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seqnum</span><span class="p">)</span>
                    <span class="n">seqnum</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="n">measnum</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="n">SpecOuts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">experiment_name</span> <span class="o">==</span> <span class="s2">&quot;LP-PI-TRM:LP-PI-ALT-AFARM&quot;</span><span class="p">:</span>  <span class="c1"># is a Shaw experiment!</span>
                <span class="n">ARM</span><span class="p">,</span> <span class="n">TRM</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
                <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">NewSpecs</span><span class="p">:</span>  <span class="c1"># fix the experiment name for all recs for this specimen and save in SpecOuts</span>
                    <span class="c1"># assign an experiment name to all specimen measurements from this specimen</span>
                    <span class="c1"># make the second ARM in Shaw experiments LT-AF-I-2, stick</span>
                    <span class="c1"># in the AF of ARM and TRM codes</span>
                    <span class="n">meths</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;method_codes&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">ARM</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="k">if</span> <span class="s2">&quot;LT-AF-I&quot;</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>
                            <span class="k">del</span> <span class="n">meths</span><span class="p">[</span><span class="n">meths</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&quot;LT-AF-I&quot;</span><span class="p">)]</span>
                            <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;LT-AF-I-2&quot;</span><span class="p">)</span>
                            <span class="n">ARM</span> <span class="o">=</span> <span class="mi">2</span>
                        <span class="k">if</span> <span class="s2">&quot;LT-AF-Z&quot;</span> <span class="ow">in</span> <span class="n">meths</span> <span class="ow">and</span> <span class="n">TRM</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;LP-ARM-AFD&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">TRM</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">ARM</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="k">if</span> <span class="s2">&quot;LT-AF-Z&quot;</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>
                            <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;LP-TRM-AFD&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">ARM</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="k">if</span> <span class="s2">&quot;LT-AF-Z&quot;</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>
                            <span class="n">meths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;LP-ARM2-AFD&quot;</span><span class="p">)</span>
                    <span class="n">newcode</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                    <span class="k">for</span> <span class="n">meth</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>
                        <span class="n">newcode</span> <span class="o">=</span> <span class="n">newcode</span> <span class="o">+</span> <span class="n">meth</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span>
                    <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;method_codes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">newcode</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="k">if</span> <span class="s2">&quot;LT-AF-I&quot;</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>
                        <span class="n">ARM</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="k">if</span> <span class="s2">&quot;LT-T-I&quot;</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>
                        <span class="n">TRM</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;method_codes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;method_codes&quot;</span><span class="p">]</span> <span class="o">+</span> \
                        <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">experiment_name</span>
                    <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;experiment&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">spec</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">experiment_name</span>
                    <span class="n">rec</span><span class="p">[</span><span class="s1">&#39;treat_step_num&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%i</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                        <span class="n">measnum</span><span class="p">)</span>  <span class="c1"># assign measurement numbers</span>
                    <span class="n">rec</span><span class="p">[</span><span class="s1">&#39;sequence&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%i</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seqnum</span><span class="p">)</span>
                    <span class="n">seqnum</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="n">measnum</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="n">SpecOuts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1"># not a Thellier-Thellier  or a Shaw experiemnt</span>
                <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">NewSpecs</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">experiment_name</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                        <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;method_codes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;LT-NO&quot;</span>
                        <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;experiment&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">spec</span> <span class="o">+</span> <span class="s2">&quot;:LT-NO&quot;</span>
                        <span class="n">rec</span><span class="p">[</span><span class="s1">&#39;treat_step_num&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%i</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                            <span class="n">measnum</span><span class="p">)</span>  <span class="c1"># assign measurement numbers</span>
                        <span class="n">rec</span><span class="p">[</span><span class="s1">&#39;sequence&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%i</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seqnum</span><span class="p">)</span>
                        <span class="n">seqnum</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="n">measnum</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">experiment_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">rec</span><span class="p">[</span><span class="s1">&#39;method_codes&#39;</span><span class="p">]:</span>
                            <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;method_codes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;method_codes&quot;</span><span class="p">]</span> <span class="o">+</span> \
                                <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">experiment_name</span>
                            <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;method_codes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;method_codes&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span>
                                <span class="s1">&#39;:&#39;</span><span class="p">)</span>
                        <span class="n">rec</span><span class="p">[</span><span class="s1">&#39;treat_step_num&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%i</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                            <span class="n">measnum</span><span class="p">)</span>  <span class="c1"># assign measurement numbers</span>
                        <span class="n">rec</span><span class="p">[</span><span class="s1">&#39;sequence&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%i</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seqnum</span><span class="p">)</span>
                        <span class="n">seqnum</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="n">measnum</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;experiment&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">spec</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">experiment_name</span>
                    <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;software_packages&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">version_num</span>
                    <span class="n">SpecOuts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">NewSpecs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;experiment&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">spec</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> \
                <span class="n">NewSpecs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;method_codes&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">NewSpecs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;software_packages&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">version_num</span>
            <span class="c1"># just copy over the single record as is</span>
            <span class="n">SpecOuts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">NewSpecs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="c1"># added to get rid of colons in experiment names</span>
    <span class="n">SpecOutsNoColons</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">num</span><span class="o">=</span><span class="mi">1</span>
    <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">SpecOuts</span><span class="p">:</span>
        <span class="n">experiment</span><span class="o">=</span><span class="n">rec</span><span class="p">[</span><span class="s1">&#39;experiment&#39;</span><span class="p">]</span>
        <span class="n">newex</span><span class="o">=</span><span class="n">experiment</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">,</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
        <span class="n">rec</span><span class="p">[</span><span class="s1">&#39;experiment&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">newex</span>
        <span class="n">rec</span><span class="p">[</span><span class="s1">&#39;measurement&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">newex</span><span class="o">+</span><span class="s1">&#39;-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
        <span class="n">num</span><span class="o">+=</span><span class="mi">1</span>
        <span class="n">SpecOutsNoColons</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">SpecOutsNoColons</span></div>


<span class="k">def</span> <span class="nf">mw_measurements_methods</span><span class="p">(</span><span class="n">MagRecs</span><span class="p">):</span>
    <span class="c1"># first collect all data for this specimen and do lab treatments</span>
    <span class="n">MD</span><span class="p">,</span> <span class="n">pMRM</span><span class="p">,</span> <span class="n">IZ</span><span class="p">,</span> <span class="n">ZI</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>  <span class="c1"># these are flags for the lab protocol codes</span>
    <span class="n">expcodes</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">NewSpecs</span><span class="p">,</span> <span class="n">SpecMeths</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">experiment_name</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">phi</span><span class="p">,</span> <span class="n">theta</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span>
    <span class="n">Dec</span><span class="p">,</span> <span class="n">Inc</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span>  <span class="c1"># NRM direction</span>
    <span class="n">ZI</span><span class="p">,</span> <span class="n">IZ</span><span class="p">,</span> <span class="n">MD</span><span class="p">,</span> <span class="n">pMRM</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span>
    <span class="n">k</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">POWT_I</span><span class="p">,</span> <span class="n">POWT_Z</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">ISteps</span><span class="p">,</span> <span class="n">ZSteps</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">k</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">MagRecs</span><span class="p">:</span>
        <span class="n">k</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="c1"># ready for pass through, step through specimens, check whether ptrm, ptrm tail checks, or AARM, etc.</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1"># collect all the experimental data for this specimen</span>
<span class="c1"># and look through this specimen&#39;s records - try to figure out what experiment it is</span>
<span class="c1">#</span>
        <span class="n">meths</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;magic_method_codes&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
        <span class="n">powt</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treatment_mw_energy&quot;</span><span class="p">]))</span>
        <span class="k">for</span> <span class="n">meth</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">meth</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">SpecMeths</span><span class="p">:</span>
                <span class="c1"># collect all the methods for this experiment</span>
                <span class="n">SpecMeths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">meth</span><span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;LT-M-I&quot;</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>  <span class="c1"># infield step</span>
            <span class="n">POWT_I</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">powt</span><span class="p">)</span>
            <span class="n">ISteps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">phi</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>  <span class="c1"># first one</span>
                <span class="n">phi</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treatment_dc_field_phi&quot;</span><span class="p">])</span>
                <span class="n">theta</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treatment_dc_field_theta&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="s2">&quot;LT-M-Z&quot;</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>  <span class="c1"># zero field  step</span>
            <span class="n">POWT_Z</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">powt</span><span class="p">)</span>
            <span class="n">ZSteps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">phi</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>  <span class="c1"># first one</span>
                <span class="n">Dec</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;measurement_dec&quot;</span><span class="p">])</span>
                <span class="n">Inc</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;measurement_inc&quot;</span><span class="p">])</span>
    <span class="k">if</span> <span class="s2">&quot;LT-M-I&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">SpecMeths</span><span class="p">:</span>  <span class="c1"># just microwave demag</span>
        <span class="n">experiment_name</span> <span class="o">=</span> <span class="s2">&quot;LP-DIR-M&quot;</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># Microwave infield steps , some sort of LP-PI-M experiment</span>
        <span class="n">experiment_name</span> <span class="o">=</span> <span class="s2">&quot;LP-PI-M&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;LT-PMRM-Z&quot;</span> <span class="ow">in</span> <span class="n">SpecMeths</span> <span class="ow">or</span> <span class="s2">&quot;LT-PMRM-I&quot;</span> <span class="ow">in</span> <span class="n">SpecMeths</span><span class="p">:</span>  <span class="c1"># has pTRM checks</span>
            <span class="n">experiment_name</span> <span class="o">=</span> <span class="n">experiment_name</span> <span class="o">+</span> <span class="s2">&quot;:LP-PI-ALT-PMRM&quot;</span>
        <span class="k">if</span> <span class="n">Dec</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span> <span class="ow">and</span> <span class="n">phi</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="c1"># angle between applied field and NRM</span>
            <span class="n">ang</span> <span class="o">=</span> <span class="n">angle</span><span class="p">([</span><span class="n">Dec</span><span class="p">,</span> <span class="n">Inc</span><span class="p">],</span> <span class="p">[</span><span class="n">phi</span><span class="p">,</span> <span class="n">theta</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">ang</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">ang</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">experiment_name</span> <span class="o">=</span> <span class="n">experiment_name</span> <span class="o">+</span> <span class="s2">&quot;:LP-NRM-PAR&quot;</span>
            <span class="k">if</span> <span class="n">ang</span> <span class="o">&gt;</span> <span class="mi">88</span> <span class="ow">and</span> <span class="n">ang</span> <span class="o">&lt;</span> <span class="mi">92</span><span class="p">:</span>
                <span class="n">experiment_name</span> <span class="o">=</span> <span class="n">experiment_name</span> <span class="o">+</span> <span class="s2">&quot;:LP-NRM-PERP&quot;</span>
            <span class="k">if</span> <span class="n">ang</span> <span class="o">&gt;</span> <span class="mi">178</span> <span class="ow">and</span> <span class="n">ang</span> <span class="o">&lt;</span> <span class="mi">182</span><span class="p">:</span>
                <span class="n">experiment_name</span> <span class="o">=</span> <span class="n">experiment_name</span> <span class="o">+</span> <span class="s2">&quot;:LP-NRM-APAR&quot;</span>
<span class="c1">#</span>
<span class="c1"># now check whether there are z pairs for all I steps or is this a single heating experiment</span>
<span class="c1">#</span>
        <span class="n">noZ</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">powt</span> <span class="ow">in</span> <span class="n">POWT_I</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">powt</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">POWT_Z</span><span class="p">:</span>
                <span class="n">noZ</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># some I&#39;s missing their Z&#39;s</span>
        <span class="k">if</span> <span class="n">noZ</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">meths</span> <span class="o">=</span> <span class="n">experiment_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="s2">&quot;LP-NRM-PERP&quot;</span> <span class="ow">in</span> <span class="n">meths</span><span class="p">:</span>  <span class="c1"># this is a single  heating experiment</span>
                <span class="n">experiment_name</span> <span class="o">=</span> <span class="n">experiment_name</span> <span class="o">+</span> <span class="s2">&quot;:LP-PI-M-S&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Trouble interpreting file - missing zerofield steps? &quot;</span><span class="p">)</span>
                <span class="k">return</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># this is a double heating experiment</span>
            <span class="n">experiment_name</span> <span class="o">=</span> <span class="n">experiment_name</span> <span class="o">+</span> <span class="s2">&quot;:LP-PI-M-D&quot;</span>
  <span class="c1"># check for IZ or ZI pairs</span>
            <span class="k">for</span> <span class="n">istep</span> <span class="ow">in</span> <span class="n">ISteps</span><span class="p">:</span>  <span class="c1"># look for first zerofield step with this power</span>
                <span class="n">rec</span> <span class="o">=</span> <span class="n">MagRecs</span><span class="p">[</span><span class="n">istep</span><span class="p">]</span>
                <span class="n">powt_i</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treatment_mw_energy&quot;</span><span class="p">]))</span>
                <span class="n">IZorZI</span><span class="p">,</span> <span class="n">step</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span>
                <span class="k">while</span> <span class="n">IZorZI</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="ow">and</span> <span class="n">step</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">ZSteps</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">step</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="n">zstep</span> <span class="o">=</span> <span class="n">ZSteps</span><span class="p">[</span><span class="n">step</span><span class="p">]</span>
                    <span class="n">zrec</span> <span class="o">=</span> <span class="n">MagRecs</span><span class="p">[</span><span class="n">zstep</span><span class="p">]</span>
                    <span class="n">powt_z</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">zrec</span><span class="p">[</span><span class="s2">&quot;treatment_mw_energy&quot;</span><span class="p">]))</span>
                    <span class="k">if</span> <span class="n">powt_i</span> <span class="o">==</span> <span class="n">powt_z</span><span class="p">:</span>  <span class="c1"># found a match</span>
                        <span class="k">if</span> <span class="n">zstep</span> <span class="o">&lt;</span> <span class="n">istep</span><span class="p">:</span>  <span class="c1"># zero field first</span>
                            <span class="n">IZorZI</span> <span class="o">=</span> <span class="s2">&quot;LP-PI-M-ZI&quot;</span>
                            <span class="n">ZI</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># there is at least one ZI step</span>
                            <span class="k">break</span>
                        <span class="k">else</span><span class="p">:</span>  <span class="c1"># in field first</span>
                            <span class="n">IZorZI</span> <span class="o">=</span> <span class="s2">&quot;LP-PI-M-IZ&quot;</span>
                            <span class="n">IZ</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># there is at least one ZI step</span>
                            <span class="k">break</span>
                <span class="k">if</span> <span class="n">IZorZI</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                    <span class="n">MagRecs</span><span class="p">[</span><span class="n">istep</span><span class="p">][</span><span class="s1">&#39;magic_method_codes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">MagRecs</span><span class="p">[</span><span class="n">istep</span><span class="p">][</span><span class="s1">&#39;magic_method_codes&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;:&#39;</span> <span class="o">+</span> <span class="n">IZorZI</span>
                    <span class="n">MagRecs</span><span class="p">[</span><span class="n">zstep</span><span class="p">][</span><span class="s1">&#39;magic_method_codes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">MagRecs</span><span class="p">[</span><span class="n">zstep</span><span class="p">][</span><span class="s1">&#39;magic_method_codes&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;:&#39;</span> <span class="o">+</span> <span class="n">IZorZI</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">POWT_Z</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">POWT_I</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">istep</span> <span class="ow">in</span> <span class="n">ISteps</span><span class="p">:</span>  <span class="c1"># now look for MD checks (zero field)</span>
                <span class="c1"># only if there is another step to consider</span>
                <span class="k">if</span> <span class="n">istep</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">MagRecs</span><span class="p">):</span>
                    <span class="n">irec</span> <span class="o">=</span> <span class="n">MagRecs</span><span class="p">[</span><span class="n">istep</span><span class="p">]</span>
                    <span class="n">powt_i</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">irec</span><span class="p">[</span><span class="s2">&quot;treatment_mw_energy&quot;</span><span class="p">]))</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">istep</span><span class="p">,</span> <span class="n">powt_i</span><span class="p">,</span> <span class="n">ZSteps</span><span class="p">[</span><span class="n">POWT_Z</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">powt_i</span><span class="p">)])</span>
                    <span class="c1"># if there is a previous zero field step at same  power</span>
                    <span class="k">if</span> <span class="n">powt_i</span> <span class="ow">in</span> <span class="n">POWT_Z</span> <span class="ow">and</span> <span class="n">ZSteps</span><span class="p">[</span><span class="n">POWT_Z</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">powt_i</span><span class="p">)]</span> <span class="o">&lt;</span> <span class="n">istep</span><span class="p">:</span>
                        <span class="n">nrec</span> <span class="o">=</span> <span class="n">MagRecs</span><span class="p">[</span><span class="n">istep</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>  <span class="c1"># next step</span>
                        <span class="n">nmeths</span> <span class="o">=</span> <span class="n">nrec</span><span class="p">[</span><span class="s1">&#39;magic_method_codes&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
                        <span class="n">powt_n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">nrec</span><span class="p">[</span><span class="s2">&quot;treatment_mw_energy&quot;</span><span class="p">]))</span>
                        <span class="k">if</span> <span class="s1">&#39;LT-M-Z&#39;</span> <span class="ow">in</span> <span class="n">nmeths</span> <span class="ow">and</span> <span class="n">powt_n</span> <span class="o">==</span> <span class="n">powt_i</span><span class="p">:</span>  <span class="c1"># the step after this infield was a zero field at same energy</span>
                            <span class="n">MD</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># found a second zero field  match</span>
                            <span class="n">mdmeths</span> <span class="o">=</span> <span class="n">MagRecs</span><span class="p">[</span><span class="n">istep</span> <span class="o">+</span>
                                              <span class="mi">1</span><span class="p">][</span><span class="s1">&#39;magic_method_codes&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
                            <span class="c1"># replace method code with tail check code</span>
                            <span class="n">mdmeths</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;LT-PMRM-MD&quot;</span>
                            <span class="n">methods</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                            <span class="k">for</span> <span class="n">meth</span> <span class="ow">in</span> <span class="n">mdmeths</span><span class="p">:</span>
                                <span class="n">methods</span> <span class="o">=</span> <span class="n">methods</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">meth</span>
                            <span class="n">MagRecs</span><span class="p">[</span><span class="n">istep</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="s1">&#39;magic_method_codes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">methods</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
            <span class="k">if</span> <span class="n">MD</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">experiment_name</span> <span class="o">=</span> <span class="n">experiment_name</span> <span class="o">+</span> <span class="s2">&quot;:LP-PI-BT-MD&quot;</span>
            <span class="k">if</span> <span class="n">IZ</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">ZI</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">experiment_name</span> <span class="o">=</span> <span class="n">experiment_name</span> <span class="o">+</span> <span class="s2">&quot;:LP-PI-BT-IZZI&quot;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">experiment_name</span> <span class="o">=</span> <span class="n">experiment_name</span> <span class="o">+</span> <span class="s2">&quot;:LP-PI-M-IZ&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">ZI</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">experiment_name</span> <span class="o">=</span> <span class="n">experiment_name</span> <span class="o">+</span> <span class="s2">&quot;:LP-PI-M-ZI&quot;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span>
                        <span class="s2">&quot;problem in measurements_methods - no ZI or IZ in double heating experiment&quot;</span><span class="p">)</span>
                    <span class="k">return</span>
    <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">MagRecs</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;er_synthetic_name&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="n">rec</span><span class="p">[</span><span class="s1">&#39;er_synthetic_name&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">rec</span><span class="p">[</span><span class="s1">&#39;magic_experiment_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="s1">&#39;er_synthetic_name&#39;</span><span class="p">]</span> <span class="o">+</span> \
                <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">experiment_name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rec</span><span class="p">[</span><span class="s1">&#39;magic_experiment_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="s1">&#39;er_specimen_name&#39;</span><span class="p">]</span> <span class="o">+</span> \
                <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">experiment_name</span>
        <span class="n">rec</span><span class="p">[</span><span class="s1">&#39;magic_method_codes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="s1">&#39;magic_method_codes&#39;</span><span class="p">]</span> <span class="o">+</span> \
            <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">experiment_name</span>
    <span class="k">return</span> <span class="n">MagRecs</span>


<div class="viewcode-block" id="parse_site"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.parse_site">[docs]</a><span class="k">def</span> <span class="nf">parse_site</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">convention</span><span class="p">,</span> <span class="n">Z</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parse the site name from the sample name using the specified convention</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">convention</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">convention</span><span class="p">)</span>
    <span class="n">site</span> <span class="o">=</span> <span class="n">sample</span>  <span class="c1"># default is that site = sample</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1"># Sample is final letter on site designation eg:  TG001a (used by SIO lab</span>
<span class="c1"># in San Diego)</span>
    <span class="k">if</span> <span class="n">convention</span> <span class="o">==</span> <span class="s2">&quot;1&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">sample</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># peel off terminal character</span>
<span class="c1">#</span>
<span class="c1"># Site-Sample format eg:  BG94-1  (used by PGL lab in Beijing)</span>
<span class="c1">#</span>
    <span class="k">if</span> <span class="n">convention</span> <span class="o">==</span> <span class="s2">&quot;2&quot;</span><span class="p">:</span>
        <span class="n">parts</span> <span class="o">=</span> <span class="n">sample</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="c1">#</span>
<span class="c1"># Sample is XXXX.YY where XXX is site and YY is sample</span>
<span class="c1">#</span>
    <span class="k">if</span> <span class="n">convention</span> <span class="o">==</span> <span class="s2">&quot;3&quot;</span><span class="p">:</span>
        <span class="n">parts</span> <span class="o">=</span> <span class="n">sample</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="c1">#</span>
<span class="c1"># Sample is XXXXYYY where XXX is site desgnation and YYY is Z long integer</span>
<span class="c1">#</span>
    <span class="k">if</span> <span class="n">convention</span> <span class="o">==</span> <span class="s2">&quot;4&quot;</span><span class="p">:</span>
        <span class="n">k</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">sample</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="n">k</span><span class="p">]</span>  <span class="c1"># peel off Z characters from site</span>

    <span class="k">if</span> <span class="n">convention</span> <span class="o">==</span> <span class="s2">&quot;5&quot;</span><span class="p">:</span>  <span class="c1"># sample == site</span>
        <span class="k">return</span> <span class="n">sample</span>

    <span class="k">if</span> <span class="n">convention</span> <span class="o">==</span> <span class="s2">&quot;6&quot;</span><span class="p">:</span>  <span class="c1"># should be names in orient.txt</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-W- Finding names in orient.txt is not currently supported&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">convention</span> <span class="o">==</span> <span class="s2">&quot;7&quot;</span><span class="p">:</span>  <span class="c1"># peel off Z characters for site</span>
        <span class="n">k</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">sample</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">k</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">convention</span> <span class="o">==</span> <span class="s2">&quot;8&quot;</span><span class="p">:</span>  <span class="c1"># split by &#39;_&#39;, return spec/sample/site</span>
        <span class="n">parts</span><span class="o">=</span><span class="n">sample</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
        <span class="n">spec</span><span class="o">=</span><span class="n">sample</span>
        <span class="n">samp</span><span class="o">=</span><span class="n">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">site</span><span class="o">=</span><span class="n">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">spec</span><span class="p">,</span><span class="n">samp</span><span class="p">,</span><span class="n">site</span><span class="p">)</span>


    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error in site parsing routine&quot;</span><span class="p">)</span>
    <span class="k">return</span></div>


<div class="viewcode-block" id="get_samp_con"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.get_samp_con">[docs]</a><span class="k">def</span> <span class="nf">get_samp_con</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get sample naming convention.</span>
<span class="sd">    &quot;&quot;&quot;</span>
<span class="c1">#</span>
    <span class="n">samp_con</span><span class="p">,</span> <span class="n">Z</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span>
    <span class="k">while</span> <span class="n">samp_con</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
        <span class="n">samp_con</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        Sample naming convention:</span>
<span class="s2">            [1] XXXXY: where XXXX is an arbitrary length site designation and Y</span>
<span class="s2">                is the single character sample designation.  e.g., TG001a is the</span>
<span class="s2">                first sample from site TG001.    [default]</span>
<span class="s2">            [2] XXXX-YY: YY sample from site XXXX (XXX, YY of arbitrary length)</span>
<span class="s2">            [3] XXXX.YY: YY sample from site XXXX (XXX, YY of arbitrary length)</span>
<span class="s2">            [4-Z] XXXX[YYY]:  YYY is sample designation with Z characters from site XXX</span>
<span class="s2">            [5] site name same as sample</span>
<span class="s2">            [6] site is entered under a separate column</span>
<span class="s2">            [7-Z] [XXXX]YYY:  XXXX is site designation with Z characters with sample name XXXXYYYY</span>
<span class="s2">            NB: all others you will have to customize your self</span>
<span class="s2">                 or e-mail ltauxe@ucsd.edu for help.</span>
<span class="s2">            select one:</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
    <span class="c1">#</span>
        <span class="k">if</span> <span class="n">samp_con</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="ow">or</span> <span class="n">samp_con</span> <span class="o">==</span> <span class="s2">&quot;1&quot;</span><span class="p">:</span>
            <span class="n">samp_con</span><span class="p">,</span> <span class="n">Z</span> <span class="o">=</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="s2">&quot;4&quot;</span> <span class="ow">in</span> <span class="n">samp_con</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;-&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">samp_con</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;option [4] must be in form 4-Z where Z is an integer&quot;</span><span class="p">)</span>
                <span class="n">samp_con</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">Z</span> <span class="o">=</span> <span class="n">samp_con</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">samp_con</span> <span class="o">=</span> <span class="s2">&quot;4&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;7&quot;</span> <span class="ow">in</span> <span class="n">samp_con</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;-&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">samp_con</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;option [7] must be in form 7-Z where Z is an integer&quot;</span><span class="p">)</span>
                <span class="n">samp_con</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">Z</span> <span class="o">=</span> <span class="n">samp_con</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">samp_con</span> <span class="o">=</span> <span class="s2">&quot;7&quot;</span>
        <span class="k">if</span> <span class="n">samp_con</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span> <span class="o">==</span> <span class="kc">False</span> <span class="ow">or</span> <span class="nb">int</span><span class="p">(</span><span class="n">samp_con</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">7</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Try again</span><span class="se">\n</span><span class="s2"> &quot;</span><span class="p">)</span>
            <span class="n">samp_con</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">return</span> <span class="n">samp_con</span><span class="p">,</span> <span class="n">Z</span></div>


<div class="viewcode-block" id="get_tilt"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.get_tilt">[docs]</a><span class="k">def</span> <span class="nf">get_tilt</span><span class="p">(</span><span class="n">dec_geo</span><span class="p">,</span> <span class="n">inc_geo</span><span class="p">,</span> <span class="n">dec_tilt</span><span class="p">,</span> <span class="n">inc_tilt</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to return the dip direction and dip that would yield the tilt</span>
<span class="sd">    corrected direction if applied to the uncorrected direction (geographic</span>
<span class="sd">    coordinates).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dec_geo : declination in geographic coordinates</span>
<span class="sd">    inc_geo : inclination in geographic coordinates</span>
<span class="sd">    dec_tilt : declination in tilt-corrected coordinates</span>
<span class="sd">    inc_tilt : inclination in tilt-corrected coordinates</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    DipDir, Dip : tuple of dip direction and dip</span>
<span class="sd">    </span>
<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; pmag.get_tilt(85,110,80.2,112.3)</span>
<span class="sd">    (223.67057238530975, 2.95374920443805)</span>
<span class="sd">    &quot;&quot;&quot;</span>
<span class="c1"># strike is horizontal line equidistant from two input directions</span>
    <span class="n">SCart</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>  <span class="c1"># cartesian coordites of Strike</span>
    <span class="n">SCart</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>  <span class="c1"># by definition</span>
    <span class="c1"># cartesian coordites of Geographic D</span>
    <span class="n">GCart</span> <span class="o">=</span> <span class="n">dir2cart</span><span class="p">([</span><span class="n">dec_geo</span><span class="p">,</span> <span class="n">inc_geo</span><span class="p">,</span> <span class="mf">1.</span><span class="p">])</span>
    <span class="n">TCart</span> <span class="o">=</span> <span class="n">dir2cart</span><span class="p">([</span><span class="n">dec_tilt</span><span class="p">,</span> <span class="n">inc_tilt</span><span class="p">,</span> <span class="mf">1.</span><span class="p">])</span>  <span class="c1"># cartesian coordites of Tilt D</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">old_div</span><span class="p">((</span><span class="n">TCart</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">GCart</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="p">(</span><span class="n">GCart</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">TCart</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="n">SCart</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">old_div</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">X</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">1.</span><span class="p">)))</span>
    <span class="n">SCart</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">SCart</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">X</span>
    <span class="n">SDir</span> <span class="o">=</span> <span class="n">cart2dir</span><span class="p">(</span><span class="n">SCart</span><span class="p">)</span>
    <span class="n">DipDir</span> <span class="o">=</span> <span class="p">(</span><span class="n">SDir</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">90.</span><span class="p">)</span> <span class="o">%</span> <span class="mf">360.</span>
    <span class="n">DipDir</span> <span class="o">=</span> <span class="p">(</span><span class="n">SDir</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mf">90.</span><span class="p">)</span> <span class="o">%</span> <span class="mf">360.</span>
<span class="c1"># D is great circle distance between geo direction and strike</span>
<span class="c1"># theta is GCD between geo and tilt (on unit sphere).  use law of cosines</span>
<span class="c1"># to get small cirlce between geo and tilt (dip)</span>
    <span class="n">cosd</span> <span class="o">=</span> <span class="n">GCart</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">SCart</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">GCart</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> \
        <span class="n">SCart</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># cosine of angle between two</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">cosd</span><span class="p">)</span>
    <span class="n">cosTheta</span> <span class="o">=</span> <span class="n">GCart</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">TCart</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">GCart</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">TCart</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">GCart</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">TCart</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">Dip</span> <span class="o">=</span> <span class="p">(</span><span class="n">old_div</span><span class="p">(</span><span class="mf">180.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span> <span class="o">*</span> \
        <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">old_div</span><span class="p">((</span><span class="n">cosd</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">cosTheta</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)))</span>
    <span class="k">if</span> <span class="n">Dip</span> <span class="o">&gt;</span> <span class="mi">90</span><span class="p">:</span>
        <span class="n">Dip</span> <span class="o">=</span> <span class="o">-</span><span class="n">Dip</span>
    <span class="k">return</span> <span class="n">DipDir</span><span class="p">,</span> <span class="n">Dip</span></div>
<span class="c1">#</span>


<div class="viewcode-block" id="get_azpl"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.get_azpl">[docs]</a><span class="k">def</span> <span class="nf">get_azpl</span><span class="p">(</span><span class="n">cdec</span><span class="p">,</span> <span class="n">cinc</span><span class="p">,</span> <span class="n">gdec</span><span class="p">,</span> <span class="n">ginc</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Gets azimuth and plunge from specimen declination, inclination, and (geographic) coordinates.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    cdec : specimen declination</span>
<span class="sd">    cinc : specimen inclination</span>
<span class="sd">    gdec : geographic declination</span>
<span class="sd">    ginc : geographic inclination</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    list of the two values for the azmiuth and plunge </span>
<span class="sd">    </span>
<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; pmag.get_azpl(85,110,80.2,112.3)</span>
<span class="sd">    (323.77999999985053, -12.079999999990653)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">TOL</span> <span class="o">=</span> <span class="mf">1e-4</span>
    <span class="n">Xp</span> <span class="o">=</span> <span class="n">dir2cart</span><span class="p">([</span><span class="n">gdec</span><span class="p">,</span> <span class="n">ginc</span><span class="p">,</span> <span class="mf">1.</span><span class="p">])</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">dir2cart</span><span class="p">([</span><span class="n">cdec</span><span class="p">,</span> <span class="n">cinc</span><span class="p">,</span> <span class="mf">1.</span><span class="p">])</span>
    <span class="c1"># find plunge first</span>
    <span class="n">az</span><span class="p">,</span> <span class="n">pl</span><span class="p">,</span> <span class="n">zdif</span><span class="p">,</span> <span class="n">ang</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">90.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">360.</span>
    <span class="k">while</span> <span class="n">zdif</span> <span class="o">&gt;</span> <span class="n">TOL</span> <span class="ow">and</span> <span class="n">pl</span> <span class="o">&lt;</span> <span class="mf">180.</span><span class="p">:</span>
        <span class="n">znew</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">pl</span><span class="p">))</span> <span class="o">+</span> <span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">pl</span><span class="p">))</span>
        <span class="n">zdif</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Xp</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">znew</span><span class="p">)</span>
        <span class="n">pl</span> <span class="o">+=</span> <span class="mf">.01</span>

    <span class="k">while</span> <span class="n">ang</span> <span class="o">&gt;</span> <span class="mf">0.1</span> <span class="ow">and</span> <span class="n">az</span> <span class="o">&lt;</span> <span class="mf">360.</span><span class="p">:</span>
        <span class="n">d</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="n">dogeo</span><span class="p">(</span><span class="n">cdec</span><span class="p">,</span> <span class="n">cinc</span><span class="p">,</span> <span class="n">az</span><span class="p">,</span> <span class="n">pl</span><span class="p">)</span>
        <span class="n">ang</span> <span class="o">=</span> <span class="n">angle</span><span class="p">([</span><span class="n">gdec</span><span class="p">,</span> <span class="n">ginc</span><span class="p">],</span> <span class="p">[</span><span class="n">d</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span>
        <span class="n">az</span> <span class="o">+=</span> <span class="mf">.01</span>
    <span class="k">return</span> <span class="n">az</span> <span class="o">-</span> <span class="mf">.01</span><span class="p">,</span> <span class="n">pl</span> <span class="o">-</span> <span class="mf">.01</span></div>


<div class="viewcode-block" id="set_priorities"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.set_priorities">[docs]</a><span class="k">def</span> <span class="nf">set_priorities</span><span class="p">(</span><span class="n">SO_methods</span><span class="p">,</span> <span class="n">ask</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Figure out which sample_azimuth to use, if multiple orientation methods</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># if ask set to 1, then can change priorities</span>
    <span class="n">SO_methods</span> <span class="o">=</span> <span class="p">[</span><span class="n">meth</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">meth</span> <span class="ow">in</span> <span class="n">SO_methods</span><span class="p">]</span>
    <span class="n">SO_defaults</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;SO-SUN&#39;</span><span class="p">,</span> <span class="s1">&#39;SO-GPS-DIFF&#39;</span><span class="p">,</span> <span class="s1">&#39;SO-SUN-SIGHT&#39;</span><span class="p">,</span> <span class="s1">&#39;SO-SIGHT&#39;</span><span class="p">,</span> <span class="s1">&#39;SO-SIGHT-BS&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;SO-CMD-NORTH&#39;</span><span class="p">,</span> <span class="s1">&#39;SO-MAG&#39;</span><span class="p">,</span> <span class="s1">&#39;SO-SM&#39;</span><span class="p">,</span> <span class="s1">&#39;SO-REC&#39;</span><span class="p">,</span> <span class="s1">&#39;SO-V&#39;</span><span class="p">,</span> <span class="s1">&#39;SO-CORE&#39;</span><span class="p">,</span> <span class="s1">&#39;SO-NO&#39;</span><span class="p">]</span>
    <span class="n">SO_priorities</span><span class="p">,</span> <span class="n">prior_list</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">SO_methods</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">SO_defaults</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">SO_defaults</span><span class="p">[</span><span class="n">l</span><span class="p">]</span> <span class="ow">in</span> <span class="n">SO_methods</span><span class="p">:</span>
                <span class="n">SO_priorities</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SO_defaults</span><span class="p">[</span><span class="n">l</span><span class="p">])</span>
    <span class="n">pri</span><span class="p">,</span> <span class="n">change</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span>
    <span class="k">if</span> <span class="n">ask</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;These methods of sample orientation were found:</span>
<span class="s2">      They have been assigned a provisional priority (top = zero, last = highest number) &quot;&quot;&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">SO_defaults</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">SO_defaults</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="ow">in</span> <span class="n">SO_methods</span><span class="p">:</span>
                <span class="n">SO_priorities</span><span class="p">[</span><span class="n">SO_methods</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">SO_defaults</span><span class="p">[</span><span class="n">m</span><span class="p">])]</span> <span class="o">=</span> <span class="n">pri</span>
                <span class="n">pri</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">while</span> <span class="n">change</span> <span class="o">==</span> <span class="s2">&quot;1&quot;</span><span class="p">:</span>
            <span class="n">prior_list</span> <span class="o">=</span> <span class="n">SO_priorities</span>
            <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">SO_methods</span><span class="p">)):</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">SO_methods</span><span class="p">[</span><span class="n">m</span><span class="p">],</span> <span class="n">SO_priorities</span><span class="p">[</span><span class="n">m</span><span class="p">])</span>
            <span class="n">change</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Change these?  1/[0] &quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">change</span> <span class="o">!=</span> <span class="s2">&quot;1&quot;</span><span class="p">:</span>
                <span class="k">break</span>
        <span class="n">SO_priorities</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">SO_methods</span><span class="p">)):</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">SO_methods</span><span class="p">[</span><span class="n">l</span><span class="p">])</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Priority?   &quot;</span><span class="p">,</span> <span class="n">prior_list</span><span class="p">)</span>
            <span class="n">pri</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">())</span>
            <span class="n">SO_priorities</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pri</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">prior_list</span><span class="p">[</span><span class="n">prior_list</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">pri</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">SO_priorities</span></div>
<span class="c1">#</span>
<span class="c1">#</span>


<div class="viewcode-block" id="get_EOL"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.get_EOL">[docs]</a><span class="k">def</span> <span class="nf">get_EOL</span><span class="p">(</span><span class="n">file</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Find EOL of input file (whether mac,PC or unix format)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">firstline</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">350</span><span class="p">)</span>
    <span class="n">EOL</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">350</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">firstline</span><span class="p">[</span><span class="n">k</span><span class="p">:</span><span class="n">k</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s1">&#39; appears to be a dos file&#39;</span><span class="p">)</span>
            <span class="n">EOL</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\r\n</span><span class="s1">&#39;</span>
            <span class="k">break</span>
    <span class="k">if</span> <span class="n">EOL</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">350</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">firstline</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;</span><span class="se">\r</span><span class="s2">&quot;</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s1">&#39; appears to be a mac file&#39;</span><span class="p">)</span>
                <span class="n">EOL</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\r</span><span class="s1">&#39;</span>
    <span class="k">if</span> <span class="n">EOL</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s2">&quot; appears to be a  unix file&quot;</span><span class="p">)</span>
        <span class="n">EOL</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">EOL</span></div>
<span class="c1">#</span>


<div class="viewcode-block" id="sortshaw"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.sortshaw">[docs]</a><span class="k">def</span> <span class="nf">sortshaw</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">datablock</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sorts data block in to ARM1,ARM2 NRM,TRM,ARM1,ARM2=[],[],[],[]</span>
<span class="sd">    stick first zero field stuff into first_Z</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">datablock</span><span class="p">:</span>
        <span class="n">methcodes</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;magic_method_codes&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
        <span class="n">step</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treatment_ac_field&quot;</span><span class="p">])</span>
        <span class="nb">str</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;measurement_magn_moment&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="s2">&quot;LT-NO&quot;</span> <span class="ow">in</span> <span class="n">methcodes</span><span class="p">:</span>
            <span class="n">NRM</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="nb">str</span><span class="p">])</span>
        <span class="k">if</span> <span class="s2">&quot;LT-T-I&quot;</span> <span class="ow">in</span> <span class="n">methcodes</span><span class="p">:</span>
            <span class="n">TRM</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="nb">str</span><span class="p">])</span>
            <span class="n">field</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="s2">&quot;treatment_dc_field&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="s2">&quot;LT-AF-I&quot;</span> <span class="ow">in</span> <span class="n">methcodes</span><span class="p">:</span>
            <span class="n">ARM1</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="nb">str</span><span class="p">])</span>
        <span class="k">if</span> <span class="s2">&quot;LT-AF-I-2&quot;</span> <span class="ow">in</span> <span class="n">methcodes</span><span class="p">:</span>
            <span class="n">ARM2</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="nb">str</span><span class="p">])</span>
        <span class="k">if</span> <span class="s2">&quot;LT-AF-Z&quot;</span> <span class="ow">in</span> <span class="n">methcodes</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;LP-ARM-AFD&quot;</span> <span class="ow">in</span> <span class="n">methcodes</span><span class="p">:</span>
                <span class="n">ARM1</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">step</span><span class="p">,</span> <span class="nb">str</span><span class="p">])</span>
            <span class="k">elif</span> <span class="s2">&quot;LP-TRM-AFD&quot;</span> <span class="ow">in</span> <span class="n">methcodes</span><span class="p">:</span>
                <span class="n">TRM</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">step</span><span class="p">,</span> <span class="nb">str</span><span class="p">])</span>
            <span class="k">elif</span> <span class="s2">&quot;LP-ARM2-AFD&quot;</span> <span class="ow">in</span> <span class="n">methcodes</span><span class="p">:</span>
                <span class="n">ARM2</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">step</span><span class="p">,</span> <span class="nb">str</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">NRM</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">step</span><span class="p">,</span> <span class="nb">str</span><span class="p">])</span>
    <span class="n">cont</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">while</span> <span class="n">cont</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">NRM</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">TRM</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Uneven NRM/TRM steps: &quot;</span><span class="p">)</span>
            <span class="n">NRM</span><span class="p">,</span> <span class="n">TRM</span><span class="p">,</span> <span class="n">cont</span> <span class="o">=</span> <span class="n">cleanup</span><span class="p">(</span><span class="n">TRM</span><span class="p">,</span> <span class="n">NRM</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cont</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">cont</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">while</span> <span class="n">cont</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ARM1</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ARM2</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Uneven ARM1/ARM2 steps: &quot;</span><span class="p">)</span>
            <span class="n">ARM1</span><span class="p">,</span> <span class="n">ARM2</span><span class="p">,</span> <span class="n">cont</span> <span class="o">=</span> <span class="n">cleanup</span><span class="p">(</span><span class="n">ARM2</span><span class="p">,</span> <span class="n">ARM1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cont</span> <span class="o">=</span> <span class="mi">0</span>
<span class="c1">#</span>
<span class="c1"># final check</span>
<span class="c1">#</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">NRM</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">TRM</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">ARM1</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ARM2</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">NRM</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">TRM</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">ARM1</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">ARM2</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Something wrong with this specimen! Better fix it or delete it &quot;</span><span class="p">)</span>
        <span class="nb">input</span><span class="p">(</span><span class="s2">&quot; press return to acknowledge message&quot;</span><span class="p">)</span>
<span class="c1"># now do the ratio to &quot;fix&quot; NRM/TRM data</span>
<span class="c1"># a</span>
    <span class="n">TRM_ADJ</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">kk</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">TRM</span><span class="p">)):</span>
        <span class="n">step</span> <span class="o">=</span> <span class="n">TRM</span><span class="p">[</span><span class="n">kk</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ARM1</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">ARM1</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">step</span><span class="p">:</span>
                <span class="n">TRM_ADJ</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">step</span><span class="p">,</span> <span class="n">TRM</span><span class="p">[</span><span class="n">kk</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">ARM1</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">ARM2</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">1</span><span class="p">]])</span>
                <span class="k">break</span>
    <span class="n">shawblock</span> <span class="o">=</span> <span class="p">(</span><span class="n">NRM</span><span class="p">,</span> <span class="n">TRM</span><span class="p">,</span> <span class="n">ARM1</span><span class="p">,</span> <span class="n">ARM2</span><span class="p">,</span> <span class="n">TRM_ADJ</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">shawblock</span><span class="p">,</span> <span class="n">field</span></div>
<span class="c1">#</span>
<span class="c1">#</span>


<div class="viewcode-block" id="makelist"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.makelist">[docs]</a><span class="k">def</span> <span class="nf">makelist</span><span class="p">(</span><span class="n">List</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Makes a colon delimited list from List.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    List : any list of strings or numbers</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    colon delimited list</span>
<span class="sd">    </span>
<span class="sd">    Examples </span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; pmag.makelist([&quot;mT&quot;,&quot;T&quot;,&quot;Am&quot;])</span>
<span class="sd">    &#39;mT:T:Am&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">clist</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">List</span><span class="p">:</span>
        <span class="n">clist</span> <span class="o">=</span> <span class="n">clist</span> <span class="o">+</span> <span class="n">element</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span>
    <span class="k">return</span> <span class="n">clist</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span></div>


<div class="viewcode-block" id="getvec"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.getvec">[docs]</a><span class="k">def</span> <span class="nf">getvec</span><span class="p">(</span><span class="n">gh</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Evaluates the vector at a given latitude and longitude for a specified</span>
<span class="sd">    set of coefficients.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    gh : a list of gauss coefficients</span>
<span class="sd">    lat : latitude of location</span>
<span class="sd">    long : longitude of location</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    vec : direction as an array [dec, inc, intensity]</span>
<span class="sd">    </span>
<span class="sd">    Examples </span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; gh = pmag.doigrf(30,70,10,2022,coeffs=True)</span>
<span class="sd">    &gt;&gt;&gt; pmag.getvec(gh, 30,70)</span>
<span class="sd">    array([2.007319473143944e+00, 4.740186709049829e+01,</span>
<span class="sd">       4.831229434010185e+04])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sv</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">pad</span> <span class="o">=</span> <span class="mi">120</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">gh</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">pad</span><span class="p">):</span>
        <span class="n">gh</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">gh</span><span class="p">)):</span>
        <span class="n">sv</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.</span><span class="p">)</span>
<span class="c1">#! convert to colatitude for MB routine</span>
    <span class="n">itype</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">colat</span> <span class="o">=</span> <span class="mf">90.</span> <span class="o">-</span> <span class="n">lat</span>
    <span class="n">date</span><span class="p">,</span> <span class="n">alt</span> <span class="o">=</span> <span class="mf">2000.</span><span class="p">,</span> <span class="mf">0.</span>  <span class="c1"># use a dummy date and altitude</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">f</span> <span class="o">=</span> <span class="n">magsyn</span><span class="p">(</span><span class="n">gh</span><span class="p">,</span> <span class="n">sv</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">itype</span><span class="p">,</span> <span class="n">alt</span><span class="p">,</span> <span class="n">colat</span><span class="p">,</span> <span class="n">lon</span><span class="p">)</span>
    <span class="n">vec</span> <span class="o">=</span> <span class="n">cart2dir</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">])</span>
    <span class="n">vec</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span>
    <span class="k">return</span> <span class="n">vec</span></div>


<div class="viewcode-block" id="s_l"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.s_l">[docs]</a><span class="k">def</span> <span class="nf">s_l</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">27.7</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get sigma as a function of degree l from Constable and Parker (1988)</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    l : int</span>
<span class="sd">        degree of spherical harmonic expansion</span>
<span class="sd">    alpha : float</span>
<span class="sd">        alpha parameter for CP88 model, default is 27.7 in CP88</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    sigma corresponding to degree l</span>
<span class="sd">    </span>
<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; pmag.s_l(4)</span>
<span class="sd">    0.36967732888223936    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a2</span> <span class="o">=</span> <span class="n">alpha</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">c_a</span> <span class="o">=</span> <span class="mf">0.547</span>
    <span class="n">s_l</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(((</span><span class="n">c_a</span><span class="o">**</span><span class="p">(</span><span class="mf">2.</span> <span class="o">*</span> <span class="n">l</span><span class="p">))</span> <span class="o">*</span> <span class="n">a2</span><span class="p">)</span><span class="o">/</span> <span class="p">((</span><span class="n">l</span> <span class="o">+</span> <span class="mf">1.</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">2.</span> <span class="o">*</span> <span class="n">l</span> <span class="o">+</span> <span class="mf">1.</span><span class="p">)))</span>
    <span class="k">return</span> <span class="n">s_l</span></div>
<span class="c1">#</span>


<div class="viewcode-block" id="mktk03"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.mktk03">[docs]</a><span class="k">def</span> <span class="nf">mktk03</span><span class="p">(</span><span class="n">terms</span><span class="p">,</span> <span class="n">seed</span><span class="p">,</span> <span class="n">G2</span><span class="p">,</span> <span class="n">G3</span><span class="p">,</span><span class="n">G1</span><span class="o">=-</span><span class="mf">18e3</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates a list of gauss coefficients drawn from the TK03 distribution.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    terms : int</span>
<span class="sd">            number of terms to return</span>
<span class="sd">    seed : random seed</span>
<span class="sd">    G2 : int</span>
<span class="sd">         ratio of axial quadrupole term to dipole term</span>
<span class="sd">    G3 : int</span>
<span class="sd">         ratio of axial octupole term to dipole term</span>
<span class="sd">    G1 : float</span>
<span class="sd">         value of the axial dipole, default is -18e3 (in nT)</span>
<span class="sd">    verbose : default is False</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    gh : list</span>
<span class="sd">        list of l,m,g,h field model generated by TK03</span>
<span class="sd">    &quot;&quot;&quot;</span>
<span class="c1"># random.seed(n)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">seed</span>
    <span class="n">gh</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">g10</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">afact</span> <span class="o">=</span> <span class="n">G1</span><span class="p">,</span> <span class="mf">3.8</span><span class="p">,</span> <span class="mf">2.4</span>
    <span class="n">g20</span> <span class="o">=</span> <span class="n">G2</span> <span class="o">*</span> <span class="n">g10</span>
    <span class="n">g30</span> <span class="o">=</span> <span class="n">G3</span> <span class="o">*</span> <span class="n">g10</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="n">g10</span><span class="o">/</span><span class="n">afact</span>
    <span class="n">s1</span> <span class="o">=</span> <span class="n">s_l</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
    <span class="n">s10</span> <span class="o">=</span> <span class="n">beta</span> <span class="o">*</span> <span class="n">s1</span>
    <span class="n">gnew</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">g10</span><span class="p">,</span> <span class="n">s10</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span> 
        <span class="nb">print</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">gnew</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">gh</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gnew</span><span class="p">)</span>
    <span class="n">gh</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">s1</span><span class="p">))</span>
    <span class="n">gnew</span> <span class="o">=</span> <span class="n">gh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">gh</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">s1</span><span class="p">))</span>
    <span class="n">hnew</span> <span class="o">=</span> <span class="n">gh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">gnew</span><span class="p">,</span> <span class="n">hnew</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">terms</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">OFF</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="k">if</span> <span class="n">l</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">m</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">OFF</span> <span class="o">=</span> <span class="n">g20</span>
            <span class="k">if</span> <span class="n">l</span> <span class="o">==</span> <span class="mi">3</span> <span class="ow">and</span> <span class="n">m</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">OFF</span> <span class="o">=</span> <span class="n">g30</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">s_l</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
            <span class="n">j</span> <span class="o">=</span> <span class="p">(</span><span class="n">l</span> <span class="o">-</span> <span class="n">m</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span>
            <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="c1"># dipole family</span>
                <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">*</span> <span class="n">beta</span>
            <span class="n">gh</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">OFF</span><span class="p">,</span> <span class="n">s</span><span class="p">))</span>
            <span class="n">gnew</span> <span class="o">=</span> <span class="n">gh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">m</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">hnew</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">gh</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">s</span><span class="p">))</span>
                <span class="n">hnew</span> <span class="o">=</span> <span class="n">gh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">gnew</span><span class="p">,</span> <span class="n">hnew</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">gh</span></div>
<span class="c1">#</span>
<span class="c1">#</span>


<div class="viewcode-block" id="pinc"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.pinc">[docs]</a><span class="k">def</span> <span class="nf">pinc</span><span class="p">(</span><span class="n">lat</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate paleoinclination from latitude using dipole formula: tan(I) = 2tan(lat). </span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    lat : either a single value or an array of latitudes</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    array of inclinations</span>
<span class="sd">    </span>
<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; lats = [45,40,60,80, -30,55]</span>
<span class="sd">    &gt;&gt;&gt; np.round(pmag.pinc(lats),1)</span>
<span class="sd">    array([ 63.4,  59.2,  73.9,  85. , -49.1,  70.7])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tanl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">lat</span><span class="p">))</span>
    <span class="n">inc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span><span class="mf">2.</span> <span class="o">*</span> <span class="n">tanl</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">inc</span><span class="p">)</span></div>
<span class="c1">#</span>


<div class="viewcode-block" id="plat"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.plat">[docs]</a><span class="k">def</span> <span class="nf">plat</span><span class="p">(</span><span class="n">inc</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate paleolatitude from inclination using dipole formula: tan(I) = 2tan(lat).</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    inc : either a single value or an array of inclinations</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    array of latitudes</span>
<span class="sd">    </span>
<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; incs = [63.4,59.2,73.9,85,-49.1,70.7]</span>
<span class="sd">    &gt;&gt;&gt; np.round(pmag.plat(incs))</span>
<span class="sd">    array([ 45.,  40.,  60.,  80., -30.,  55.])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tani</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">inc</span><span class="p">))</span>
    <span class="n">lat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span><span class="n">tani</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">lat</span><span class="p">)</span></div>
<span class="c1">#</span>
<span class="c1">#</span>


<div class="viewcode-block" id="pseudo"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.pseudo">[docs]</a><span class="k">def</span> <span class="nf">pseudo</span><span class="p">(</span><span class="n">DIs</span><span class="p">,</span> <span class="n">random_seed</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Draw a bootstrap sample of directions returning as many bootstrapped samples</span>
<span class="sd">    as in the input directions.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    DIs : nested list of dec, inc lists (known as a di_block)</span>
<span class="sd">    random_seed : set random seed for reproducible number generation (default is None)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Bootstrap_directions : nested list of dec, inc lists that have been</span>
<span class="sd">    bootstrapped resampled</span>
<span class="sd">    </span>
<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; di_block = ([[-45,150],</span>
<span class="sd">     [-40,150],</span>
<span class="sd">     [-38,145]])</span>
<span class="sd">    &gt;&gt;&gt; pmag.pseudo(di_block,10)</span>
<span class="sd">    array([[-40, 150],</span>
<span class="sd">       [-40, 150],</span>
<span class="sd">       [-45, 150]])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">random_seed</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">random_seed</span><span class="p">)</span>
    <span class="n">Inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">DIs</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">DIs</span><span class="p">))</span>
    <span class="n">D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">DIs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">D</span><span class="p">[</span><span class="n">Inds</span><span class="p">]</span></div>


<div class="viewcode-block" id="di_boot"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.di_boot">[docs]</a><span class="k">def</span> <span class="nf">di_boot</span><span class="p">(</span><span class="n">DIs</span><span class="p">,</span> <span class="n">nb</span><span class="o">=</span><span class="mi">5000</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns bootstrap means for Directional data.</span>
<span class="sd">     </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    DIs : nested list of Dec,Inc pairs</span>
<span class="sd">    nb : number of bootstrap pseudosamples, default is 5000</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    BDIs : nested list of bootstrapped mean Dec,Inc pairs</span>
<span class="sd">    </span>
<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; di_block = ([[-45,150],</span>
<span class="sd">     [-40,150],</span>
<span class="sd">     [-38,145]])</span>
<span class="sd">    &gt;&gt;&gt; pmag.di_boot(di_block,5)</span>
<span class="sd">    [[136.66619627955163, 30.021001931432338],</span>
<span class="sd">     [138.33380372044837, 30.02100193143235],</span>
<span class="sd">     [140.64213759144877, 31.669596401508702],</span>
<span class="sd">     [136.66619627955163, 30.021001931432338],</span>
<span class="sd">     [139.58053739971953, 33.378250658618654]]</span>
<span class="sd">    &quot;&quot;&quot;</span>
<span class="c1">#</span>
<span class="c1"># now do bootstrap to collect BDIs  bootstrap means</span>
<span class="c1">#</span>
    <span class="n">BDIs</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># number of bootstraps, list of bootstrap directions</span>
<span class="c1">#</span>

    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nb</span><span class="p">):</span>  <span class="c1"># repeat nb times</span>
        <span class="c1">#        if k%50==0:print k,&#39; out of &#39;,nb</span>
        <span class="n">pDIs</span> <span class="o">=</span> <span class="n">pseudo</span><span class="p">(</span><span class="n">DIs</span><span class="p">)</span>  <span class="c1"># get a pseudosample</span>
        <span class="n">bfpars</span> <span class="o">=</span> <span class="n">fisher_mean</span><span class="p">(</span><span class="n">pDIs</span><span class="p">)</span>  <span class="c1"># get bootstrap mean bootstrap sample</span>
        <span class="n">BDIs</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">bfpars</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">],</span> <span class="n">bfpars</span><span class="p">[</span><span class="s1">&#39;inc&#39;</span><span class="p">]])</span>
    <span class="k">return</span> <span class="n">BDIs</span></div>


<div class="viewcode-block" id="dir_df_boot"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.dir_df_boot">[docs]</a><span class="k">def</span> <span class="nf">dir_df_boot</span><span class="p">(</span><span class="n">dir_df</span><span class="p">,</span> <span class="n">nb</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span> <span class="n">par</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Performs a bootstrap for direction DataFrame with optional parametric bootstrap</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dir_df : Pandas DataFrame with columns:</span>
<span class="sd">        dir_dec : mean declination</span>
<span class="sd">        dir_inc : mean inclination</span>
<span class="sd">      Required for parametric bootstrap</span>
<span class="sd">        dir_n : number of data points in mean</span>
<span class="sd">        dir_k : Fisher k statistic for mean</span>
<span class="sd">    nb : number of bootstraps, default is 5000</span>
<span class="sd">    par : if True, do a parameteric bootstrap</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    BDIs : nested list of bootstrapped mean Dec,Inc pairs</span>
<span class="sd">    </span>
<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; dir_df = pd.DataFrame()</span>
<span class="sd">    &gt;&gt;&gt; dir_df[&#39;dir_inc&#39;] = [30,75,-113,-127,104]</span>
<span class="sd">    &gt;&gt;&gt; dir_df[&#39;dir_dec&#39;] = [50,100,78,48,87]</span>
<span class="sd">    &gt;&gt;&gt; pmag.dir_df_boot(dir_df,nb=4)</span>
<span class="sd">    [[249.0092732274716, 47.78774025782868],</span>
<span class="sd">     [52.15562660104691, 14.523345688004293],</span>
<span class="sd">     [214.5976992675414, 49.79280429500907],</span>
<span class="sd">     [119.6384153360684, 86.17066958304461]]</span>
<span class="sd">     </span>
<span class="sd">    &gt;&gt;&gt; dir_df[&#39;dir_n&#39;] = [4,15,2,36,55]</span>
<span class="sd">    &gt;&gt;&gt; dir_df[&#39;dir_k&#39;] = [1.2,3.0,0.4,0.4,0.8]</span>
<span class="sd">    &gt;&gt;&gt; pmag.dir_df_boot(dir_df,3,par=True)</span>
<span class="sd">    [[43.54318517848151, 53.40671924110994],</span>
<span class="sd">     [278.5836582875345, 25.159165079114043],</span>
<span class="sd">     [276.59474232833645, -22.88695795286902]]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">N</span> <span class="o">=</span> <span class="n">dir_df</span><span class="o">.</span><span class="n">dir_dec</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># number of data points</span>
    <span class="n">BDIs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nb</span><span class="p">):</span>
        <span class="n">pdir_df</span> <span class="o">=</span> <span class="n">dir_df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># bootstrap pseudosample</span>
        <span class="n">pdir_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># reset the index</span>
        <span class="k">if</span> <span class="n">par</span><span class="p">:</span>  <span class="c1"># do a parametric bootstrap</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">pdir_df</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>  <span class="c1"># set through the pseudosample</span>
                <span class="n">n</span> <span class="o">=</span> <span class="n">pdir_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;dir_n&#39;</span><span class="p">]</span>  <span class="c1"># get number of samples/site</span>
                <span class="c1"># get ks for each sample</span>
                <span class="n">ks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="n">pdir_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;dir_k&#39;</span><span class="p">]</span>
                <span class="c1"># draw a fisher distributed set of directions</span>
                <span class="n">decs</span><span class="p">,</span> <span class="n">incs</span> <span class="o">=</span> <span class="n">fshdev</span><span class="p">(</span><span class="n">ks</span><span class="p">)</span>
                <span class="n">di_block</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">decs</span><span class="p">,</span> <span class="n">incs</span><span class="p">))</span>
                <span class="c1">#  rotate them to the mean</span>
                <span class="n">di_block</span> <span class="o">=</span> <span class="n">dodirot_V</span><span class="p">(</span>
                    <span class="n">di_block</span><span class="p">,</span> <span class="n">pdir_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;dir_dec&#39;</span><span class="p">],</span> <span class="n">pdir_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;dir_inc&#39;</span><span class="p">])</span>
                <span class="c1"># get the new mean direction for the pseudosample</span>
                <span class="n">fpars</span> <span class="o">=</span> <span class="n">fisher_mean</span><span class="p">(</span><span class="n">di_block</span><span class="p">)</span>
                <span class="c1"># replace the pseudo sample mean direction</span>
                <span class="n">pdir_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;dir_dec&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fpars</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">]</span>
                <span class="n">pdir_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;dir_inc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fpars</span><span class="p">[</span><span class="s1">&#39;inc&#39;</span><span class="p">]</span>
        <span class="c1"># get bootstrap mean bootstrap sample</span>
        <span class="n">bfpars</span> <span class="o">=</span> <span class="n">dir_df_fisher_mean</span><span class="p">(</span><span class="n">pdir_df</span><span class="p">)</span>
        <span class="n">BDIs</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">bfpars</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">],</span> <span class="n">bfpars</span><span class="p">[</span><span class="s1">&#39;inc&#39;</span><span class="p">]])</span>
    <span class="k">return</span> <span class="n">BDIs</span></div>


<div class="viewcode-block" id="dir_df_fisher_mean"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.dir_df_fisher_mean">[docs]</a><span class="k">def</span> <span class="nf">dir_df_fisher_mean</span><span class="p">(</span><span class="n">dir_df</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates fisher mean for Pandas dataframe.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dir_df: pandas data frame with columns:</span>
<span class="sd">        dir_dec : declination</span>
<span class="sd">        dir_inc : inclination</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fpars : dictionary containing the Fisher mean and statistics</span>
<span class="sd">        dec : mean declination</span>
<span class="sd">        inc : mean inclination</span>
<span class="sd">        r : resultant vector length</span>
<span class="sd">        n : number of data points</span>
<span class="sd">        k : Fisher k value</span>
<span class="sd">        csd : Fisher circular standard deviation</span>
<span class="sd">        alpha95 : Fisher circle of 95% confidence</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">N</span> <span class="o">=</span> <span class="n">dir_df</span><span class="o">.</span><span class="n">dir_dec</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># number of data points</span>
    <span class="n">fpars</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="n">N</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">fpars</span>
    <span class="n">dirs</span> <span class="o">=</span> <span class="n">dir_df</span><span class="p">[[</span><span class="s1">&#39;dir_dec&#39;</span><span class="p">,</span> <span class="s1">&#39;dir_inc&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">dir2cart</span><span class="p">(</span><span class="n">dirs</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
    <span class="n">Xbar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()])</span>
    <span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Xbar</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">Xbar</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">Xbar</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">Xbar</span> <span class="o">=</span> <span class="n">Xbar</span><span class="o">/</span><span class="n">R</span>
    <span class="nb">dir</span> <span class="o">=</span> <span class="n">cart2dir</span><span class="p">(</span><span class="n">Xbar</span><span class="p">)</span>
    <span class="n">fpars</span><span class="p">[</span><span class="s2">&quot;dec&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dir</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">fpars</span><span class="p">[</span><span class="s2">&quot;inc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dir</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">fpars</span><span class="p">[</span><span class="s2">&quot;n&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">N</span>
    <span class="n">fpars</span><span class="p">[</span><span class="s2">&quot;r&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">R</span>
    <span class="k">if</span> <span class="n">N</span> <span class="o">!=</span> <span class="n">R</span><span class="p">:</span>
        <span class="n">k</span> <span class="o">=</span> <span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="n">R</span><span class="p">)</span>
        <span class="n">fpars</span><span class="p">[</span><span class="s2">&quot;k&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">k</span>
        <span class="n">csd</span> <span class="o">=</span> <span class="mf">81.</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">fpars</span><span class="p">[</span><span class="s1">&#39;k&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;inf&#39;</span>
        <span class="n">csd</span> <span class="o">=</span> <span class="mf">0.</span>
    <span class="n">b</span> <span class="o">=</span> <span class="mf">20.</span><span class="o">**</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">b</span> <span class="o">*</span> <span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="n">R</span><span class="p">)</span> <span class="o">/</span> <span class="n">R</span>
    <span class="k">if</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">a95</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
    <span class="n">fpars</span><span class="p">[</span><span class="s2">&quot;alpha95&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">a95</span>
    <span class="n">fpars</span><span class="p">[</span><span class="s2">&quot;csd&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">csd</span>
    <span class="k">if</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">fpars</span><span class="p">[</span><span class="s2">&quot;alpha95&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">180.0</span>
    <span class="k">return</span> <span class="n">fpars</span></div>


<div class="viewcode-block" id="pseudosample"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.pseudosample">[docs]</a><span class="k">def</span> <span class="nf">pseudosample</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Draw a bootstrap sample of x</span>
<span class="sd">    &quot;&quot;&quot;</span>
<span class="c1">#</span>
    <span class="n">BXs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
        <span class="n">ind</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">BXs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">BXs</span></div>


<div class="viewcode-block" id="get_plate_data"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.get_plate_data">[docs]</a><span class="k">def</span> <span class="nf">get_plate_data</span><span class="p">(</span><span class="n">plate</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the pole list for a given plate</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    plate : string (options: AF, ANT, AU, EU, GL, IN, NA, SA)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    apwp : string with format</span>
<span class="sd">        0.0        90.00    0.00</span>
<span class="sd">        1.0        88.38  182.20</span>
<span class="sd">        2.0        86.76  182.20</span>
<span class="sd">        ...</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">poles</span>
    <span class="n">apwp</span> <span class="o">=</span> <span class="n">poles</span><span class="o">.</span><span class="n">get_apwp</span><span class="p">(</span><span class="n">plate</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">apwp</span></div>


<div class="viewcode-block" id="bc02"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.bc02">[docs]</a><span class="k">def</span> <span class="nf">bc02</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get APWP from Besse and Courtillot 2002 paper</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Takes input as [plate, site_lat, site_lon, age]</span>
<span class="sd">    plate : string (options: AF, ANT, AU, EU, GL, IN, NA, SA)</span>
<span class="sd">    site_lat : float</span>
<span class="sd">    site_lon : float</span>
<span class="sd">    age : float in Myr</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pole_lat : pole latitude</span>
<span class="sd">    pole_lon : pole longitude</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">plate</span><span class="p">,</span> <span class="n">site_lat</span><span class="p">,</span> <span class="n">site_lon</span><span class="p">,</span> <span class="n">age</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">apwp</span> <span class="o">=</span> <span class="n">get_plate_data</span><span class="p">(</span><span class="n">plate</span><span class="p">)</span>
    <span class="n">recs</span> <span class="o">=</span> <span class="n">apwp</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
    <span class="c1">#</span>
    <span class="c1"># put it into  usable form in plate_data</span>
    <span class="c1">#</span>
    <span class="n">k</span><span class="p">,</span> <span class="n">plate_data</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="p">[]</span>
    <span class="k">while</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">recs</span><span class="p">)</span> <span class="o">-</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">rec</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">recs</span><span class="p">[</span><span class="n">k</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">recs</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">recs</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])]</span>
        <span class="n">plate_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">)</span>
        <span class="n">k</span> <span class="o">=</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">3</span>

    <span class="c1">#</span>
    <span class="c1"># find the right pole for the age</span>
    <span class="c1">#</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">plate_data</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">age</span> <span class="o">&gt;=</span> <span class="n">plate_data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">age</span> <span class="o">&lt;=</span> <span class="n">plate_data</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">age</span> <span class="o">-</span> <span class="n">plate_data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">plate_data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">age</span><span class="p">):</span>
                <span class="n">rec</span> <span class="o">=</span> <span class="n">i</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">rec</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">break</span>
    <span class="n">pole_lat</span> <span class="o">=</span> <span class="n">plate_data</span><span class="p">[</span><span class="n">rec</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">pole_lon</span> <span class="o">=</span> <span class="n">plate_data</span><span class="p">[</span><span class="n">rec</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">pole_lat</span><span class="p">,</span> <span class="n">pole_lon</span></div>


<div class="viewcode-block" id="linreg"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.linreg">[docs]</a><span class="k">def</span> <span class="nf">linreg</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Does a linear regression</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;x and y must be same length&#39;</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">xsum</span><span class="p">,</span> <span class="n">ysum</span><span class="p">,</span> <span class="n">xy</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="nb">sum</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="mi">0</span>
    <span class="n">linpars</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">xx</span> <span class="o">+=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">yy</span> <span class="o">+=</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">xy</span> <span class="o">+=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">xsum</span> <span class="o">+=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">ysum</span> <span class="o">+=</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">xsig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">old_div</span><span class="p">((</span><span class="n">xx</span> <span class="o">-</span> <span class="n">old_div</span><span class="p">(</span><span class="n">xsum</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">)),</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">)))</span>
        <span class="n">ysig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">old_div</span><span class="p">((</span><span class="n">yy</span> <span class="o">-</span> <span class="n">old_div</span><span class="p">(</span><span class="n">ysum</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">)),</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">)))</span>
    <span class="n">linpars</span><span class="p">[</span><span class="s1">&#39;slope&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">old_div</span><span class="p">(</span>
        <span class="p">(</span><span class="n">xy</span> <span class="o">-</span> <span class="p">(</span><span class="n">xsum</span> <span class="o">*</span> <span class="n">ysum</span> <span class="o">/</span> <span class="n">n</span><span class="p">)),</span> <span class="p">(</span><span class="n">xx</span> <span class="o">-</span> <span class="n">old_div</span><span class="p">((</span><span class="n">xsum</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="n">n</span><span class="p">)))</span>
    <span class="n">linpars</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">old_div</span><span class="p">((</span><span class="n">ysum</span> <span class="o">-</span> <span class="n">linpars</span><span class="p">[</span><span class="s1">&#39;slope&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">xsum</span><span class="p">),</span> <span class="n">n</span><span class="p">)</span>
    <span class="n">linpars</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">old_div</span><span class="p">((</span><span class="n">linpars</span><span class="p">[</span><span class="s1">&#39;slope&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">xsig</span><span class="p">),</span> <span class="n">ysig</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">linpars</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">linpars</span><span class="p">[</span><span class="s1">&#39;slope&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="nb">sum</span> <span class="o">+=</span> <span class="n">a</span>
    <span class="n">linpars</span><span class="p">[</span><span class="s1">&#39;sigma&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">old_div</span><span class="p">(</span><span class="nb">sum</span><span class="p">,</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mf">2.</span><span class="p">))</span>
    <span class="n">linpars</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">n</span>
    <span class="k">return</span> <span class="n">linpars</span></div>


<div class="viewcode-block" id="interval_overlap"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.interval_overlap">[docs]</a><span class="k">def</span> <span class="nf">interval_overlap</span><span class="p">(</span><span class="n">interval_a</span><span class="p">,</span> <span class="n">interval_b</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Determine the extent of overlap between two ranges of numbers </span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    interval_a : a list of [min, max]</span>
<span class="sd">    interval_b : a list of [min, max]</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    overlap : the amount of overlap between interval_a and interval_b</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a0</span><span class="p">,</span><span class="n">a1</span> <span class="o">=</span> <span class="n">interval_a</span>
    <span class="n">b0</span><span class="p">,</span><span class="n">b1</span> <span class="o">=</span> <span class="n">interval_b</span>
    <span class="n">overlap</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">min</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span><span class="n">b1</span><span class="p">)</span><span class="o">-</span><span class="nb">max</span><span class="p">(</span><span class="n">a0</span><span class="p">,</span><span class="n">b0</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">overlap</span></div>


<div class="viewcode-block" id="squish"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.squish">[docs]</a><span class="k">def</span> <span class="nf">squish</span><span class="p">(</span><span class="n">incs</span><span class="p">,</span> <span class="n">f</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns &#39;flattened&#39; inclination, assuming factor, f and King (1955) formula:</span>
<span class="sd">    tan (I_o) = f tan (I_f)</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    incs : array of inclination (I_f)  data to flatten</span>
<span class="sd">    f : flattening factor</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    I_o :  inclinations after flattening</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">incs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">incs</span><span class="p">)</span>
    <span class="n">I_o</span> <span class="o">=</span> <span class="n">f</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">incs</span><span class="p">)</span>  <span class="c1"># multiply tangent by flattening factor</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span><span class="n">I_o</span><span class="p">))</span></div>


<div class="viewcode-block" id="unsquish"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.unsquish">[docs]</a><span class="k">def</span> <span class="nf">unsquish</span><span class="p">(</span><span class="n">incs</span><span class="p">,</span> <span class="n">f</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns &#39;unflattened&#39; inclination, assuming factor, f and King (1955) formula: tan (I_o) = tan (I_f)/f.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    incs : array of inclination (I_f) data to unflatten</span>
<span class="sd">    f : flattening factor</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    I_o :  array of inclinations after unflattening</span>
<span class="sd">    </span>
<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; incs = [63.4,59.2,73.9,85,-49.1,70.7]</span>
<span class="sd">    &gt;&gt;&gt; np.round(pmag.unsquish(incs,2),1)</span>
<span class="sd">    array([ 45. ,  40. ,  60. ,  80.1, -30. ,  55. ])</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; incs=np.loadtxt(&#39;data_files/unsquish/unsquish_example.dat&#39;)</span>
<span class="sd">    &gt;&gt;&gt; pmag.unsquish(incs,2)</span>
<span class="sd">    array([[ -5.140729823126393,  11.420796025697275],</span>
<span class="sd">       [  0.900222120901553,  10.204588442982518],</span>
<span class="sd">       [  2.957841023919168,   7.263099363956552],</span>
<span class="sd">       [  0.100000304618348,  14.648986731143856],</span>
<span class="sd">       [ 14.887975603633317,  11.476705854028246], ...</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">incs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">incs</span><span class="p">)</span>
    <span class="n">I_o</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">incs</span><span class="p">)</span><span class="o">/</span><span class="n">f</span>  <span class="c1"># divide tangent by flattening factor</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span><span class="n">I_o</span><span class="p">))</span></div>


<div class="viewcode-block" id="get_ts"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.get_ts">[docs]</a><span class="k">def</span> <span class="nf">get_ts</span><span class="p">(</span><span class="n">ts</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    returns GPTS timescales.</span>
<span class="sd">    options are:  ck95, gts04, and gts12</span>
<span class="sd">    returns timescales and Chron labels</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">ts</span> <span class="o">==</span> <span class="s1">&#39;ck95&#39;</span><span class="p">:</span>
        <span class="n">TS</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.780</span><span class="p">,</span> <span class="mf">0.990</span><span class="p">,</span> <span class="mf">1.070</span><span class="p">,</span> <span class="mf">1.770</span><span class="p">,</span> <span class="mf">1.950</span><span class="p">,</span> <span class="mf">2.140</span><span class="p">,</span> <span class="mf">2.150</span><span class="p">,</span> <span class="mf">2.581</span><span class="p">,</span> <span class="mf">3.040</span><span class="p">,</span> <span class="mf">3.110</span><span class="p">,</span> <span class="mf">3.220</span><span class="p">,</span> <span class="mf">3.330</span><span class="p">,</span> <span class="mf">3.580</span><span class="p">,</span> <span class="mf">4.180</span><span class="p">,</span> <span class="mf">4.290</span><span class="p">,</span> <span class="mf">4.480</span><span class="p">,</span> <span class="mf">4.620</span><span class="p">,</span> <span class="mf">4.800</span><span class="p">,</span> <span class="mf">4.890</span><span class="p">,</span> <span class="mf">4.980</span><span class="p">,</span> <span class="mf">5.230</span><span class="p">,</span> <span class="mf">5.894</span><span class="p">,</span> <span class="mf">6.137</span><span class="p">,</span> <span class="mf">6.269</span><span class="p">,</span> <span class="mf">6.567</span><span class="p">,</span> <span class="mf">6.935</span><span class="p">,</span> <span class="mf">7.091</span><span class="p">,</span> <span class="mf">7.135</span><span class="p">,</span> <span class="mf">7.170</span><span class="p">,</span> <span class="mf">7.341</span><span class="p">,</span> <span class="mf">7.375</span><span class="p">,</span> <span class="mf">7.432</span><span class="p">,</span> <span class="mf">7.562</span><span class="p">,</span> <span class="mf">7.650</span><span class="p">,</span> <span class="mf">8.072</span><span class="p">,</span> <span class="mf">8.225</span><span class="p">,</span> <span class="mf">8.257</span><span class="p">,</span> <span class="mf">8.699</span><span class="p">,</span> <span class="mf">9.025</span><span class="p">,</span> <span class="mf">9.230</span><span class="p">,</span> <span class="mf">9.308</span><span class="p">,</span> <span class="mf">9.580</span><span class="p">,</span> <span class="mf">9.642</span><span class="p">,</span> <span class="mf">9.740</span><span class="p">,</span> <span class="mf">9.880</span><span class="p">,</span> <span class="mf">9.920</span><span class="p">,</span> <span class="mf">10.949</span><span class="p">,</span> <span class="mf">11.052</span><span class="p">,</span> <span class="mf">11.099</span><span class="p">,</span> <span class="mf">11.476</span><span class="p">,</span> <span class="mf">11.531</span><span class="p">,</span> <span class="mf">11.935</span><span class="p">,</span> <span class="mf">12.078</span><span class="p">,</span> <span class="mf">12.184</span><span class="p">,</span> <span class="mf">12.401</span><span class="p">,</span> <span class="mf">12.678</span><span class="p">,</span> <span class="mf">12.708</span><span class="p">,</span> <span class="mf">12.775</span><span class="p">,</span> <span class="mf">12.819</span><span class="p">,</span> <span class="mf">12.991</span><span class="p">,</span> <span class="mf">13.139</span><span class="p">,</span> <span class="mf">13.302</span><span class="p">,</span> <span class="mf">13.510</span><span class="p">,</span> <span class="mf">13.703</span><span class="p">,</span> <span class="mf">14.076</span><span class="p">,</span> <span class="mf">14.178</span><span class="p">,</span> <span class="mf">14.612</span><span class="p">,</span> <span class="mf">14.800</span><span class="p">,</span> <span class="mf">14.888</span><span class="p">,</span> <span class="mf">15.034</span><span class="p">,</span> <span class="mf">15.155</span><span class="p">,</span> <span class="mf">16.014</span><span class="p">,</span> <span class="mf">16.293</span><span class="p">,</span> <span class="mf">16.327</span><span class="p">,</span> <span class="mf">16.488</span><span class="p">,</span> <span class="mf">16.556</span><span class="p">,</span> <span class="mf">16.726</span><span class="p">,</span> <span class="mf">17.277</span><span class="p">,</span> <span class="mf">17.615</span><span class="p">,</span> <span class="mf">18.281</span><span class="p">,</span> <span class="mf">18.781</span><span class="p">,</span> <span class="mf">19.048</span><span class="p">,</span> <span class="mf">20.131</span><span class="p">,</span> <span class="mf">20.518</span><span class="p">,</span> <span class="mf">20.725</span><span class="p">,</span> <span class="mf">20.996</span><span class="p">,</span> <span class="mf">21.320</span><span class="p">,</span> <span class="mf">21.768</span><span class="p">,</span> <span class="mf">21.859</span><span class="p">,</span> <span class="mf">22.151</span><span class="p">,</span> <span class="mf">22.248</span><span class="p">,</span> <span class="mf">22.459</span><span class="p">,</span> <span class="mf">22.493</span><span class="p">,</span> <span class="mf">22.588</span><span class="p">,</span>
              <span class="mf">22.750</span><span class="p">,</span> <span class="mf">22.804</span><span class="p">,</span> <span class="mf">23.069</span><span class="p">,</span> <span class="mf">23.353</span><span class="p">,</span> <span class="mf">23.535</span><span class="p">,</span> <span class="mf">23.677</span><span class="p">,</span> <span class="mf">23.800</span><span class="p">,</span> <span class="mf">23.999</span><span class="p">,</span> <span class="mf">24.118</span><span class="p">,</span> <span class="mf">24.730</span><span class="p">,</span> <span class="mf">24.781</span><span class="p">,</span> <span class="mf">24.835</span><span class="p">,</span> <span class="mf">25.183</span><span class="p">,</span> <span class="mf">25.496</span><span class="p">,</span> <span class="mf">25.648</span><span class="p">,</span> <span class="mf">25.823</span><span class="p">,</span> <span class="mf">25.951</span><span class="p">,</span> <span class="mf">25.992</span><span class="p">,</span> <span class="mf">26.554</span><span class="p">,</span> <span class="mf">27.027</span><span class="p">,</span> <span class="mf">27.972</span><span class="p">,</span> <span class="mf">28.283</span><span class="p">,</span> <span class="mf">28.512</span><span class="p">,</span> <span class="mf">28.578</span><span class="p">,</span> <span class="mf">28.745</span><span class="p">,</span> <span class="mf">29.401</span><span class="p">,</span> <span class="mf">29.662</span><span class="p">,</span> <span class="mf">29.765</span><span class="p">,</span> <span class="mf">30.098</span><span class="p">,</span> <span class="mf">30.479</span><span class="p">,</span> <span class="mf">30.939</span><span class="p">,</span> <span class="mf">33.058</span><span class="p">,</span> <span class="mf">33.545</span><span class="p">,</span> <span class="mf">34.655</span><span class="p">,</span> <span class="mf">34.940</span><span class="p">,</span> <span class="mf">35.343</span><span class="p">,</span> <span class="mf">35.526</span><span class="p">,</span> <span class="mf">35.685</span><span class="p">,</span> <span class="mf">36.341</span><span class="p">,</span> <span class="mf">36.618</span><span class="p">,</span> <span class="mf">37.473</span><span class="p">,</span> <span class="mf">37.604</span><span class="p">,</span> <span class="mf">37.848</span><span class="p">,</span> <span class="mf">37.920</span><span class="p">,</span> <span class="mf">38.113</span><span class="p">,</span> <span class="mf">38.426</span><span class="p">,</span> <span class="mf">39.552</span><span class="p">,</span> <span class="mf">39.631</span><span class="p">,</span> <span class="mf">40.130</span><span class="p">,</span> <span class="mf">41.257</span><span class="p">,</span> <span class="mf">41.521</span><span class="p">,</span> <span class="mf">42.536</span><span class="p">,</span> <span class="mf">43.789</span><span class="p">,</span> <span class="mf">46.264</span><span class="p">,</span> <span class="mf">47.906</span><span class="p">,</span> <span class="mf">49.037</span><span class="p">,</span> <span class="mf">49.714</span><span class="p">,</span> <span class="mf">50.778</span><span class="p">,</span> <span class="mf">50.946</span><span class="p">,</span> <span class="mf">51.047</span><span class="p">,</span> <span class="mf">51.743</span><span class="p">,</span> <span class="mf">52.364</span><span class="p">,</span> <span class="mf">52.663</span><span class="p">,</span> <span class="mf">52.757</span><span class="p">,</span> <span class="mf">52.801</span><span class="p">,</span> <span class="mf">52.903</span><span class="p">,</span> <span class="mf">53.347</span><span class="p">,</span> <span class="mf">55.904</span><span class="p">,</span> <span class="mf">56.391</span><span class="p">,</span> <span class="mf">57.554</span><span class="p">,</span> <span class="mf">57.911</span><span class="p">,</span> <span class="mf">60.920</span><span class="p">,</span> <span class="mf">61.276</span><span class="p">,</span> <span class="mf">62.499</span><span class="p">,</span> <span class="mf">63.634</span><span class="p">,</span> <span class="mf">63.976</span><span class="p">,</span> <span class="mf">64.745</span><span class="p">,</span> <span class="mf">65.578</span><span class="p">,</span> <span class="mf">67.610</span><span class="p">,</span> <span class="mf">67.735</span><span class="p">,</span> <span class="mf">68.737</span><span class="p">,</span> <span class="mf">71.071</span><span class="p">,</span> <span class="mf">71.338</span><span class="p">,</span> <span class="mf">71.587</span><span class="p">,</span> <span class="mf">73.004</span><span class="p">,</span> <span class="mf">73.291</span><span class="p">,</span> <span class="mf">73.374</span><span class="p">,</span> <span class="mf">73.619</span><span class="p">,</span> <span class="mf">79.075</span><span class="p">,</span> <span class="mf">83.000</span><span class="p">]</span>
        <span class="n">Labels</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;C1n&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C1r&#39;</span><span class="p">,</span> <span class="mf">0.78</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="mf">1.77</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C2An&#39;</span><span class="p">,</span> <span class="mf">2.581</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C2Ar&#39;</span><span class="p">,</span> <span class="mf">3.58</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C3n&#39;</span><span class="p">,</span> <span class="mf">4.18</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C3r&#39;</span><span class="p">,</span> <span class="mf">5.23</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C3An&#39;</span><span class="p">,</span> <span class="mf">5.894</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C3Ar&#39;</span><span class="p">,</span> <span class="mf">6.567</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C3Bn&#39;</span><span class="p">,</span> <span class="mf">6.935</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C3Br&#39;</span><span class="p">,</span> <span class="mf">7.091</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C4n&#39;</span><span class="p">,</span> <span class="mf">7.432</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C4r&#39;</span><span class="p">,</span> <span class="mf">8.072</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C4An&#39;</span><span class="p">,</span> <span class="mf">8.699</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C4Ar&#39;</span><span class="p">,</span> <span class="mf">9.025</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C5n&#39;</span><span class="p">,</span> <span class="mf">9.74</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C5r&#39;</span><span class="p">,</span> <span class="mf">10.949</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C5An&#39;</span><span class="p">,</span> <span class="mf">11.935</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C5Ar&#39;</span><span class="p">,</span> <span class="mf">12.401</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C5AAn&#39;</span><span class="p">,</span> <span class="mf">12.991</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C5AAr&#39;</span><span class="p">,</span> <span class="mf">13.139</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C5ABn&#39;</span><span class="p">,</span> <span class="mf">13.302</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C5ABr&#39;</span><span class="p">,</span> <span class="mf">13.51</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C5ACn&#39;</span><span class="p">,</span> <span class="mf">13.703</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C5ACr&#39;</span><span class="p">,</span> <span class="mf">14.076</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C5ADn&#39;</span><span class="p">,</span> <span class="mf">14.178</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C5ADr&#39;</span><span class="p">,</span> <span class="mf">14.612</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C5Bn&#39;</span><span class="p">,</span> <span class="mf">14.8</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C5Br&#39;</span><span class="p">,</span> <span class="mf">15.155</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C5Cn&#39;</span><span class="p">,</span> <span class="mf">16.014</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C5Cr&#39;</span><span class="p">,</span> <span class="mf">16.726</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C5Dn&#39;</span><span class="p">,</span> <span class="mf">17.277</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C5Dr&#39;</span><span class="p">,</span> <span class="mf">17.615</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C5En&#39;</span><span class="p">,</span> <span class="mf">18.281</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C5Er&#39;</span><span class="p">,</span> <span class="mf">18.781</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C6n&#39;</span><span class="p">,</span> <span class="mf">19.048</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C6r&#39;</span><span class="p">,</span> <span class="mf">20.131</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C6An&#39;</span><span class="p">,</span> <span class="mf">20.518</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C6Ar&#39;</span><span class="p">,</span> <span class="mf">21.32</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C6AAn&#39;</span><span class="p">,</span> <span class="mf">21.768</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C6AAr&#39;</span><span class="p">,</span> <span class="mf">21.859</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C6Bn&#39;</span><span class="p">,</span> <span class="mf">22.588</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C6Br&#39;</span><span class="p">,</span> <span class="mf">23.069</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C6Cn&#39;</span><span class="p">,</span> <span class="mf">23.353</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C6Cr&#39;</span><span class="p">,</span> <span class="mf">24.118</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C7n&#39;</span><span class="p">,</span> <span class="mf">24.73</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C7r&#39;</span><span class="p">,</span> <span class="mf">25.183</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C7A&#39;</span><span class="p">,</span> <span class="mf">25.496</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C8n&#39;</span><span class="p">,</span> <span class="mf">25.823</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C8r&#39;</span><span class="p">,</span> <span class="mf">26.554</span><span class="p">],</span> <span class="p">[</span>
            <span class="s1">&#39;C9n&#39;</span><span class="p">,</span> <span class="mf">27.027</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C9r&#39;</span><span class="p">,</span> <span class="mf">27.972</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C10n&#39;</span><span class="p">,</span> <span class="mf">28.283</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C10r&#39;</span><span class="p">,</span> <span class="mf">28.745</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C11n&#39;</span><span class="p">,</span> <span class="mf">29.401</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C11r&#39;</span><span class="p">,</span> <span class="mf">30.098</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C12n&#39;</span><span class="p">,</span> <span class="mf">30.479</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C12r&#39;</span><span class="p">,</span> <span class="mf">30.939</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C13n&#39;</span><span class="p">,</span> <span class="mf">33.058</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C13r&#39;</span><span class="p">,</span> <span class="mf">33.545</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C15n&#39;</span><span class="p">,</span> <span class="mf">34.655</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C15r&#39;</span><span class="p">,</span> <span class="mf">34.94</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C16n&#39;</span><span class="p">,</span> <span class="mf">35.343</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C16r&#39;</span><span class="p">,</span> <span class="mf">36.341</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C17n&#39;</span><span class="p">,</span> <span class="mf">36.618</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C17r&#39;</span><span class="p">,</span> <span class="mf">38.113</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C18n&#39;</span><span class="p">,</span> <span class="mf">38.426</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C18r&#39;</span><span class="p">,</span> <span class="mf">40.13</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C19n&#39;</span><span class="p">,</span> <span class="mf">41.257</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C19r&#39;</span><span class="p">,</span> <span class="mf">41.521</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C20n&#39;</span><span class="p">,</span> <span class="mf">42.536</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C20r&#39;</span><span class="p">,</span> <span class="mf">43.789</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C21n&#39;</span><span class="p">,</span> <span class="mf">46.264</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C21r&#39;</span><span class="p">,</span> <span class="mf">47.906</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C22n&#39;</span><span class="p">,</span> <span class="mf">49.037</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C22r&#39;</span><span class="p">,</span> <span class="mf">49.714</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C23n&#39;</span><span class="p">,</span> <span class="mf">50.778</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C23r&#39;</span><span class="p">,</span> <span class="mf">51.743</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C24n&#39;</span><span class="p">,</span> <span class="mf">52.364</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C24r&#39;</span><span class="p">,</span> <span class="mf">53.347</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C25n&#39;</span><span class="p">,</span> <span class="mf">55.904</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C25r&#39;</span><span class="p">,</span> <span class="mf">56.391</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C26n&#39;</span><span class="p">,</span> <span class="mf">57.554</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C26r&#39;</span><span class="p">,</span> <span class="mf">57.911</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C27n&#39;</span><span class="p">,</span> <span class="mf">60.92</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C27r&#39;</span><span class="p">,</span> <span class="mf">61.276</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C28n&#39;</span><span class="p">,</span> <span class="mf">62.499</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C28r&#39;</span><span class="p">,</span> <span class="mf">63.634</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C29n&#39;</span><span class="p">,</span> <span class="mf">63.976</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C29r&#39;</span><span class="p">,</span> <span class="mf">64.745</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C30n&#39;</span><span class="p">,</span> <span class="mf">65.578</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C30r&#39;</span><span class="p">,</span> <span class="mf">67.61</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C31n&#39;</span><span class="p">,</span> <span class="mf">67.735</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C31r&#39;</span><span class="p">,</span> <span class="mf">68.737</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C32n&#39;</span><span class="p">,</span> <span class="mf">71.071</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C32r&#39;</span><span class="p">,</span> <span class="mf">73.004</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C33n&#39;</span><span class="p">,</span> <span class="mf">73.619</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C33r&#39;</span><span class="p">,</span> <span class="mf">79.075</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C34n&#39;</span><span class="p">,</span> <span class="mi">83</span><span class="p">]]</span>
        <span class="k">return</span> <span class="n">TS</span><span class="p">,</span> <span class="n">Labels</span>
    <span class="k">if</span> <span class="n">ts</span> <span class="o">==</span> <span class="s1">&#39;gts04&#39;</span><span class="p">:</span>
        <span class="n">TS</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.781</span><span class="p">,</span> <span class="mf">0.988</span><span class="p">,</span> <span class="mf">1.072</span><span class="p">,</span> <span class="mf">1.778</span><span class="p">,</span> <span class="mf">1.945</span><span class="p">,</span> <span class="mf">2.128</span><span class="p">,</span> <span class="mf">2.148</span><span class="p">,</span> <span class="mf">2.581</span><span class="p">,</span> <span class="mf">3.032</span><span class="p">,</span> <span class="mf">3.116</span><span class="p">,</span> <span class="mf">3.207</span><span class="p">,</span> <span class="mf">3.33</span><span class="p">,</span> <span class="mf">3.596</span><span class="p">,</span> <span class="mf">4.187</span><span class="p">,</span> <span class="mf">4.3</span><span class="p">,</span> <span class="mf">4.493</span><span class="p">,</span> <span class="mf">4.631</span><span class="p">,</span> <span class="mf">4.799</span><span class="p">,</span> <span class="mf">4.896</span><span class="p">,</span> <span class="mf">4.997</span><span class="p">,</span> <span class="mf">5.235</span><span class="p">,</span> <span class="mf">6.033</span><span class="p">,</span> <span class="mf">6.252</span><span class="p">,</span> <span class="mf">6.436</span><span class="p">,</span> <span class="mf">6.733</span><span class="p">,</span> <span class="mf">7.14</span><span class="p">,</span> <span class="mf">7.212</span><span class="p">,</span> <span class="mf">7.251</span><span class="p">,</span> <span class="mf">7.285</span><span class="p">,</span> <span class="mf">7.454</span><span class="p">,</span> <span class="mf">7.489</span><span class="p">,</span> <span class="mf">7.528</span><span class="p">,</span> <span class="mf">7.642</span><span class="p">,</span> <span class="mf">7.695</span><span class="p">,</span> <span class="mf">8.108</span><span class="p">,</span> <span class="mf">8.254</span><span class="p">,</span> <span class="mf">8.3</span><span class="p">,</span> <span class="mf">8.769</span><span class="p">,</span> <span class="mf">9.098</span><span class="p">,</span> <span class="mf">9.312</span><span class="p">,</span> <span class="mf">9.409</span><span class="p">,</span> <span class="mf">9.656</span><span class="p">,</span> <span class="mf">9.717</span><span class="p">,</span> <span class="mf">9.779</span><span class="p">,</span> <span class="mf">9.934</span><span class="p">,</span> <span class="mf">9.987</span><span class="p">,</span> <span class="mf">11.04</span><span class="p">,</span> <span class="mf">11.118</span><span class="p">,</span> <span class="mf">11.154</span><span class="p">,</span> <span class="mf">11.554</span><span class="p">,</span> <span class="mf">11.614</span><span class="p">,</span> <span class="mf">12.014</span><span class="p">,</span> <span class="mf">12.116</span><span class="p">,</span> <span class="mf">12.207</span><span class="p">,</span> <span class="mf">12.415</span><span class="p">,</span> <span class="mf">12.73</span><span class="p">,</span> <span class="mf">12.765</span><span class="p">,</span> <span class="mf">12.82</span><span class="p">,</span> <span class="mf">12.878</span><span class="p">,</span> <span class="mf">13.015</span><span class="p">,</span> <span class="mf">13.183</span><span class="p">,</span> <span class="mf">13.369</span><span class="p">,</span> <span class="mf">13.605</span><span class="p">,</span> <span class="mf">13.734</span><span class="p">,</span> <span class="mf">14.095</span><span class="p">,</span> <span class="mf">14.194</span><span class="p">,</span> <span class="mf">14.581</span><span class="p">,</span> <span class="mf">14.784</span><span class="p">,</span> <span class="mf">14.877</span><span class="p">,</span> <span class="mf">15.032</span><span class="p">,</span> <span class="mf">15.16</span><span class="p">,</span> <span class="mf">15.974</span><span class="p">,</span> <span class="mf">16.268</span><span class="p">,</span> <span class="mf">16.303</span><span class="p">,</span> <span class="mf">16.472</span><span class="p">,</span> <span class="mf">16.543</span><span class="p">,</span> <span class="mf">16.721</span><span class="p">,</span> <span class="mf">17.235</span><span class="p">,</span> <span class="mf">17.533</span><span class="p">,</span> <span class="mf">17.717</span><span class="p">,</span> <span class="mf">17.74</span><span class="p">,</span> <span class="mf">18.056</span><span class="p">,</span> <span class="mf">18.524</span><span class="p">,</span> <span class="mf">18.748</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mf">20.04</span><span class="p">,</span> <span class="mf">20.213</span><span class="p">,</span> <span class="mf">20.439</span><span class="p">,</span> <span class="mf">20.709</span><span class="p">,</span> <span class="mf">21.083</span><span class="p">,</span> <span class="mf">21.159</span><span class="p">,</span> <span class="mf">21.403</span><span class="p">,</span> <span class="mf">21.483</span><span class="p">,</span> <span class="mf">21.659</span><span class="p">,</span> <span class="mf">21.688</span><span class="p">,</span> <span class="mf">21.767</span><span class="p">,</span>
              <span class="mf">21.936</span><span class="p">,</span> <span class="mf">21.992</span><span class="p">,</span> <span class="mf">22.268</span><span class="p">,</span> <span class="mf">22.564</span><span class="p">,</span> <span class="mf">22.754</span><span class="p">,</span> <span class="mf">22.902</span><span class="p">,</span> <span class="mf">23.03</span><span class="p">,</span> <span class="mf">23.249</span><span class="p">,</span> <span class="mf">23.375</span><span class="p">,</span> <span class="mf">24.044</span><span class="p">,</span> <span class="mf">24.102</span><span class="p">,</span> <span class="mf">24.163</span><span class="p">,</span> <span class="mf">24.556</span><span class="p">,</span> <span class="mf">24.915</span><span class="p">,</span> <span class="mf">25.091</span><span class="p">,</span> <span class="mf">25.295</span><span class="p">,</span> <span class="mf">25.444</span><span class="p">,</span> <span class="mf">25.492</span><span class="p">,</span> <span class="mf">26.154</span><span class="p">,</span> <span class="mf">26.714</span><span class="p">,</span> <span class="mf">27.826</span><span class="p">,</span> <span class="mf">28.186</span><span class="p">,</span> <span class="mf">28.45</span><span class="p">,</span> <span class="mf">28.525</span><span class="p">,</span> <span class="mf">28.715</span><span class="p">,</span> <span class="mf">29.451</span><span class="p">,</span> <span class="mf">29.74</span><span class="p">,</span> <span class="mf">29.853</span><span class="p">,</span> <span class="mf">30.217</span><span class="p">,</span> <span class="mf">30.627</span><span class="p">,</span> <span class="mf">31.116</span><span class="p">,</span> <span class="mf">33.266</span><span class="p">,</span> <span class="mf">33.738</span><span class="p">,</span> <span class="mf">34.782</span><span class="p">,</span> <span class="mf">35.043</span><span class="p">,</span> <span class="mf">35.404</span><span class="p">,</span> <span class="mf">35.567</span><span class="p">,</span> <span class="mf">35.707</span><span class="p">,</span> <span class="mf">36.276</span><span class="p">,</span> <span class="mf">36.512</span><span class="p">,</span> <span class="mf">37.235</span><span class="p">,</span> <span class="mf">37.345</span><span class="p">,</span> <span class="mf">37.549</span><span class="p">,</span> <span class="mf">37.61</span><span class="p">,</span> <span class="mf">37.771</span><span class="p">,</span> <span class="mf">38.032</span><span class="p">,</span> <span class="mf">38.975</span><span class="p">,</span> <span class="mf">39.041</span><span class="p">,</span> <span class="mf">39.464</span><span class="p">,</span> <span class="mf">40.439</span><span class="p">,</span> <span class="mf">40.671</span><span class="p">,</span> <span class="mf">41.59</span><span class="p">,</span> <span class="mf">42.774</span><span class="p">,</span> <span class="mf">45.346</span><span class="p">,</span> <span class="mf">47.235</span><span class="p">,</span> <span class="mf">48.599</span><span class="p">,</span> <span class="mf">49.427</span><span class="p">,</span> <span class="mf">50.73</span><span class="p">,</span> <span class="mf">50.932</span><span class="p">,</span> <span class="mf">51.057</span><span class="p">,</span> <span class="mf">51.901</span><span class="p">,</span> <span class="mf">52.648</span><span class="p">,</span> <span class="mf">53.004</span><span class="p">,</span> <span class="mf">53.116</span><span class="p">,</span> <span class="mf">53.167</span><span class="p">,</span> <span class="mf">53.286</span><span class="p">,</span> <span class="mf">53.808</span><span class="p">,</span> <span class="mf">56.665</span><span class="p">,</span> <span class="mf">57.18</span><span class="p">,</span> <span class="mf">58.379</span><span class="p">,</span> <span class="mf">58.737</span><span class="p">,</span> <span class="mf">61.65</span><span class="p">,</span> <span class="mf">61.983</span><span class="p">,</span> <span class="mf">63.104</span><span class="p">,</span> <span class="mf">64.128</span><span class="p">,</span> <span class="mf">64.432</span><span class="p">,</span> <span class="mf">65.118</span><span class="p">,</span> <span class="mf">65.861</span><span class="p">,</span> <span class="mf">67.696</span><span class="p">,</span> <span class="mf">67.809</span><span class="p">,</span> <span class="mf">68.732</span><span class="p">,</span> <span class="mf">70.961</span><span class="p">,</span> <span class="mf">71.225</span><span class="p">,</span> <span class="mf">71.474</span><span class="p">,</span> <span class="mf">72.929</span><span class="p">,</span> <span class="mf">73.231</span><span class="p">,</span> <span class="mf">73.318</span><span class="p">,</span> <span class="mf">73.577</span><span class="p">,</span> <span class="mf">79.543</span><span class="p">,</span> <span class="mi">84</span><span class="p">]</span>
        <span class="n">Labels</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;C1n&#39;</span><span class="p">,</span> <span class="mf">0.000</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C1r&#39;</span><span class="p">,</span> <span class="mf">0.781</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="mf">1.778</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C2An&#39;</span><span class="p">,</span> <span class="mf">2.581</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C2Ar&#39;</span><span class="p">,</span> <span class="mf">3.596</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C3n&#39;</span><span class="p">,</span> <span class="mf">4.187</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C3r&#39;</span><span class="p">,</span> <span class="mf">5.235</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C3An&#39;</span><span class="p">,</span> <span class="mf">6.033</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C3Ar&#39;</span><span class="p">,</span> <span class="mf">6.733</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C3Bn&#39;</span><span class="p">,</span> <span class="mf">7.140</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C3Br&#39;</span><span class="p">,</span> <span class="mf">7.212</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C4n&#39;</span><span class="p">,</span> <span class="mf">7.528</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C4r&#39;</span><span class="p">,</span> <span class="mf">8.108</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C4An&#39;</span><span class="p">,</span> <span class="mf">8.769</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C4Ar&#39;</span><span class="p">,</span> <span class="mf">9.098</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C5n&#39;</span><span class="p">,</span> <span class="mf">9.779</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C5r&#39;</span><span class="p">,</span> <span class="mf">11.040</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C5An&#39;</span><span class="p">,</span> <span class="mf">12.014</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C5Ar&#39;</span><span class="p">,</span> <span class="mf">12.415</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C5AAn&#39;</span><span class="p">,</span> <span class="mf">13.015</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C5AAr&#39;</span><span class="p">,</span> <span class="mf">13.183</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C5ABn&#39;</span><span class="p">,</span> <span class="mf">13.369</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C5ABr&#39;</span><span class="p">,</span> <span class="mf">13.605</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C5ACn&#39;</span><span class="p">,</span> <span class="mf">13.734</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C5ACr&#39;</span><span class="p">,</span> <span class="mf">14.095</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C5ADn&#39;</span><span class="p">,</span> <span class="mf">14.194</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C5ADr&#39;</span><span class="p">,</span> <span class="mf">14.581</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C5Bn&#39;</span><span class="p">,</span> <span class="mf">14.784</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C5Br&#39;</span><span class="p">,</span> <span class="mf">15.160</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C5Cn&#39;</span><span class="p">,</span> <span class="mf">15.974</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C5Cr&#39;</span><span class="p">,</span> <span class="mf">16.721</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C5Dn&#39;</span><span class="p">,</span> <span class="mf">17.235</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C5Dr&#39;</span><span class="p">,</span> <span class="mf">17.533</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C5En&#39;</span><span class="p">,</span> <span class="mf">18.056</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C5Er&#39;</span><span class="p">,</span> <span class="mf">18.524</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C6n&#39;</span><span class="p">,</span> <span class="mf">18.748</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C6r&#39;</span><span class="p">,</span> <span class="mf">19.772</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C6An&#39;</span><span class="p">,</span> <span class="mf">20.040</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C6Ar&#39;</span><span class="p">,</span> <span class="mf">20.709</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C6AAn&#39;</span><span class="p">,</span> <span class="mf">21.083</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C6AAr&#39;</span><span class="p">,</span> <span class="mf">21.159</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C6Bn&#39;</span><span class="p">,</span> <span class="mf">21.767</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C6Br&#39;</span><span class="p">,</span> <span class="mf">22.268</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C6Cn&#39;</span><span class="p">,</span> <span class="mf">22.564</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C6Cr&#39;</span><span class="p">,</span> <span class="mf">23.375</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C7n&#39;</span><span class="p">,</span> <span class="mf">24.044</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C7r&#39;</span><span class="p">,</span> <span class="mf">24.556</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C7A&#39;</span><span class="p">,</span> <span class="mf">24.919</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C8n&#39;</span><span class="p">,</span> <span class="mf">25.295</span><span class="p">],</span> <span class="p">[</span>
            <span class="s1">&#39;C8r&#39;</span><span class="p">,</span> <span class="mf">26.154</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C9n&#39;</span><span class="p">,</span> <span class="mf">26.714</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C9r&#39;</span><span class="p">,</span> <span class="mf">27.826</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C10n&#39;</span><span class="p">,</span> <span class="mf">28.186</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C11n&#39;</span><span class="p">,</span> <span class="mf">29.451</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C11r&#39;</span><span class="p">,</span> <span class="mf">30.217</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C12n&#39;</span><span class="p">,</span> <span class="mf">30.627</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C12r&#39;</span><span class="p">,</span> <span class="mf">31.116</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C13n&#39;</span><span class="p">,</span> <span class="mf">33.266</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C13r&#39;</span><span class="p">,</span> <span class="mf">33.738</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C15n&#39;</span><span class="p">,</span> <span class="mf">34.782</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C15r&#39;</span><span class="p">,</span> <span class="mf">35.043</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C16n&#39;</span><span class="p">,</span> <span class="mf">35.404</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C16r&#39;</span><span class="p">,</span> <span class="mf">36.276</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C17n&#39;</span><span class="p">,</span> <span class="mf">36.512</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C17r&#39;</span><span class="p">,</span> <span class="mf">37.771</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C18n&#39;</span><span class="p">,</span> <span class="mf">38.032</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C18r&#39;</span><span class="p">,</span> <span class="mf">39.464</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C19n&#39;</span><span class="p">,</span> <span class="mf">40.439</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C19r&#39;</span><span class="p">,</span> <span class="mf">40.671</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C20n&#39;</span><span class="p">,</span> <span class="mf">41.590</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C20r&#39;</span><span class="p">,</span> <span class="mf">42.774</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C21n&#39;</span><span class="p">,</span> <span class="mf">45.346</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C21r&#39;</span><span class="p">,</span> <span class="mf">47.235</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C22n&#39;</span><span class="p">,</span> <span class="mf">48.599</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C22r&#39;</span><span class="p">,</span> <span class="mf">49.427</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C23n&#39;</span><span class="p">,</span> <span class="mf">50.730</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C23r&#39;</span><span class="p">,</span> <span class="mf">51.901</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C24n&#39;</span><span class="p">,</span> <span class="mf">52.648</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C24r&#39;</span><span class="p">,</span> <span class="mf">53.808</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C25n&#39;</span><span class="p">,</span> <span class="mf">56.665</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C25r&#39;</span><span class="p">,</span> <span class="mf">57.180</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C26n&#39;</span><span class="p">,</span> <span class="mf">58.379</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C26r&#39;</span><span class="p">,</span> <span class="mf">58.737</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C27n&#39;</span><span class="p">,</span> <span class="mf">61.650</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C27r&#39;</span><span class="p">,</span> <span class="mf">61.938</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C28n&#39;</span><span class="p">,</span> <span class="mf">63.104</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C28r&#39;</span><span class="p">,</span> <span class="mf">64.128</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C29n&#39;</span><span class="p">,</span> <span class="mf">64.432</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C29r&#39;</span><span class="p">,</span> <span class="mf">65.118</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C30n&#39;</span><span class="p">,</span> <span class="mf">65.861</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C30r&#39;</span><span class="p">,</span> <span class="mf">67.696</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C31n&#39;</span><span class="p">,</span> <span class="mf">67.809</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C31r&#39;</span><span class="p">,</span> <span class="mf">68.732</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C32n&#39;</span><span class="p">,</span> <span class="mf">70.961</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C32r&#39;</span><span class="p">,</span> <span class="mf">72.929</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C33n&#39;</span><span class="p">,</span> <span class="mf">73.577</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C33r&#39;</span><span class="p">,</span> <span class="mf">79.543</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C34n&#39;</span><span class="p">,</span> <span class="mf">84.000</span><span class="p">]]</span>
        <span class="k">return</span> <span class="n">TS</span><span class="p">,</span> <span class="n">Labels</span>
    <span class="k">if</span> <span class="n">ts</span> <span class="o">==</span> <span class="s1">&#39;gts12&#39;</span><span class="p">:</span>
        <span class="n">TS</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.781</span><span class="p">,</span> <span class="mf">0.988</span><span class="p">,</span> <span class="mf">1.072</span><span class="p">,</span> <span class="mf">1.173</span><span class="p">,</span> <span class="mf">1.185</span><span class="p">,</span> <span class="mf">1.778</span><span class="p">,</span> <span class="mf">1.945</span><span class="p">,</span> <span class="mf">2.128</span><span class="p">,</span> <span class="mf">2.148</span><span class="p">,</span> <span class="mf">2.581</span><span class="p">,</span> <span class="mf">3.032</span><span class="p">,</span> <span class="mf">3.116</span><span class="p">,</span> <span class="mf">3.207</span><span class="p">,</span> <span class="mf">3.330</span><span class="p">,</span> <span class="mf">3.596</span><span class="p">,</span> <span class="mf">4.187</span><span class="p">,</span> <span class="mf">4.300</span><span class="p">,</span> <span class="mf">4.493</span><span class="p">,</span> <span class="mf">4.631</span><span class="p">,</span> <span class="mf">4.799</span><span class="p">,</span> <span class="mf">4.896</span><span class="p">,</span> <span class="mf">4.997</span><span class="p">,</span> <span class="mf">5.235</span><span class="p">,</span> <span class="mf">6.033</span><span class="p">,</span> <span class="mf">6.252</span><span class="p">,</span> <span class="mf">6.436</span><span class="p">,</span> <span class="mf">6.733</span><span class="p">,</span> <span class="mf">7.140</span><span class="p">,</span> <span class="mf">7.212</span><span class="p">,</span> <span class="mf">7.251</span><span class="p">,</span> <span class="mf">7.285</span><span class="p">,</span> <span class="mf">7.454</span><span class="p">,</span> <span class="mf">7.489</span><span class="p">,</span> <span class="mf">7.528</span><span class="p">,</span> <span class="mf">7.642</span><span class="p">,</span> <span class="mf">7.695</span><span class="p">,</span> <span class="mf">8.108</span><span class="p">,</span> <span class="mf">8.254</span><span class="p">,</span> <span class="mf">8.300</span><span class="p">,</span> <span class="mf">8.771</span><span class="p">,</span> <span class="mf">9.105</span><span class="p">,</span> <span class="mf">9.311</span><span class="p">,</span> <span class="mf">9.426</span><span class="p">,</span> <span class="mf">9.647</span><span class="p">,</span> <span class="mf">9.721</span><span class="p">,</span> <span class="mf">9.786</span><span class="p">,</span> <span class="mf">9.937</span><span class="p">,</span> <span class="mf">9.984</span><span class="p">,</span> <span class="mf">11.056</span><span class="p">,</span> <span class="mf">11.146</span><span class="p">,</span> <span class="mf">11.188</span><span class="p">,</span> <span class="mf">11.592</span><span class="p">,</span> <span class="mf">11.657</span><span class="p">,</span> <span class="mf">12.049</span><span class="p">,</span> <span class="mf">12.174</span><span class="p">,</span> <span class="mf">12.272</span><span class="p">,</span> <span class="mf">12.474</span><span class="p">,</span> <span class="mf">12.735</span><span class="p">,</span> <span class="mf">12.770</span><span class="p">,</span> <span class="mf">12.829</span><span class="p">,</span> <span class="mf">12.887</span><span class="p">,</span> <span class="mf">13.032</span><span class="p">,</span> <span class="mf">13.183</span><span class="p">,</span> <span class="mf">13.363</span><span class="p">,</span> <span class="mf">13.608</span><span class="p">,</span> <span class="mf">13.739</span><span class="p">,</span> <span class="mf">14.070</span><span class="p">,</span> <span class="mf">14.163</span><span class="p">,</span> <span class="mf">14.609</span><span class="p">,</span> <span class="mf">14.775</span><span class="p">,</span> <span class="mf">14.870</span><span class="p">,</span> <span class="mf">15.032</span><span class="p">,</span> <span class="mf">15.160</span><span class="p">,</span> <span class="mf">15.974</span><span class="p">,</span> <span class="mf">16.268</span><span class="p">,</span> <span class="mf">16.303</span><span class="p">,</span> <span class="mf">16.472</span><span class="p">,</span> <span class="mf">16.543</span><span class="p">,</span> <span class="mf">16.721</span><span class="p">,</span> <span class="mf">17.235</span><span class="p">,</span> <span class="mf">17.533</span><span class="p">,</span> <span class="mf">17.717</span><span class="p">,</span> <span class="mf">17.740</span><span class="p">,</span> <span class="mf">18.056</span><span class="p">,</span> <span class="mf">18.524</span><span class="p">,</span> <span class="mf">18.748</span><span class="p">,</span> <span class="mf">19.722</span><span class="p">,</span> <span class="mf">20.040</span><span class="p">,</span> <span class="mf">20.213</span><span class="p">,</span> <span class="mf">20.439</span><span class="p">,</span> <span class="mf">20.709</span><span class="p">,</span> <span class="mf">21.083</span><span class="p">,</span> <span class="mf">21.159</span><span class="p">,</span> <span class="mf">21.403</span><span class="p">,</span> <span class="mf">21.483</span><span class="p">,</span> <span class="mf">21.659</span><span class="p">,</span>
              <span class="mf">21.688</span><span class="p">,</span> <span class="mf">21.767</span><span class="p">,</span> <span class="mf">21.936</span><span class="p">,</span> <span class="mf">21.992</span><span class="p">,</span> <span class="mf">22.268</span><span class="p">,</span> <span class="mf">22.564</span><span class="p">,</span> <span class="mf">22.754</span><span class="p">,</span> <span class="mf">22.902</span><span class="p">,</span> <span class="mf">23.030</span><span class="p">,</span> <span class="mf">23.233</span><span class="p">,</span> <span class="mf">23.295</span><span class="p">,</span> <span class="mf">23.962</span><span class="p">,</span> <span class="mf">24.000</span><span class="p">,</span> <span class="mf">24.109</span><span class="p">,</span> <span class="mf">24.474</span><span class="p">,</span> <span class="mf">24.761</span><span class="p">,</span> <span class="mf">24.984</span><span class="p">,</span> <span class="mf">25.099</span><span class="p">,</span> <span class="mf">25.264</span><span class="p">,</span> <span class="mf">25.304</span><span class="p">,</span> <span class="mf">25.987</span><span class="p">,</span> <span class="mf">26.420</span><span class="p">,</span> <span class="mf">27.439</span><span class="p">,</span> <span class="mf">27.859</span><span class="p">,</span> <span class="mf">28.087</span><span class="p">,</span> <span class="mf">28.141</span><span class="p">,</span> <span class="mf">28.278</span><span class="p">,</span> <span class="mf">29.183</span><span class="p">,</span> <span class="mf">29.477</span><span class="p">,</span> <span class="mf">29.527</span><span class="p">,</span> <span class="mf">29.970</span><span class="p">,</span> <span class="mf">30.591</span><span class="p">,</span> <span class="mf">31.034</span><span class="p">,</span> <span class="mf">33.157</span><span class="p">,</span> <span class="mf">33.705</span><span class="p">,</span> <span class="mf">34.999</span><span class="p">,</span> <span class="mf">35.294</span><span class="p">,</span> <span class="mf">35.706</span><span class="p">,</span> <span class="mf">35.892</span><span class="p">,</span> <span class="mf">36.051</span><span class="p">,</span> <span class="mf">36.700</span><span class="p">,</span> <span class="mf">36.969</span><span class="p">,</span> <span class="mf">37.753</span><span class="p">,</span> <span class="mf">37.872</span><span class="p">,</span> <span class="mf">38.093</span><span class="p">,</span> <span class="mf">38.159</span><span class="p">,</span> <span class="mf">38.333</span><span class="p">,</span> <span class="mf">38.615</span><span class="p">,</span> <span class="mf">39.627</span><span class="p">,</span> <span class="mf">39.698</span><span class="p">,</span> <span class="mf">40.145</span><span class="p">,</span> <span class="mf">41.154</span><span class="p">,</span> <span class="mf">41.390</span><span class="p">,</span> <span class="mf">42.301</span><span class="p">,</span> <span class="mf">43.432</span><span class="p">,</span> <span class="mf">45.724</span><span class="p">,</span> <span class="mf">47.349</span><span class="p">,</span> <span class="mf">48.566</span><span class="p">,</span> <span class="mf">49.344</span><span class="p">,</span> <span class="mf">50.628</span><span class="p">,</span> <span class="mf">50.835</span><span class="p">,</span> <span class="mf">50.961</span><span class="p">,</span> <span class="mf">51.833</span><span class="p">,</span> <span class="mf">52.620</span><span class="p">,</span> <span class="mf">53.074</span><span class="p">,</span> <span class="mf">53.199</span><span class="p">,</span> <span class="mf">53.274</span><span class="p">,</span> <span class="mf">53.416</span><span class="p">,</span> <span class="mf">53.983</span><span class="p">,</span> <span class="mf">57.101</span><span class="p">,</span> <span class="mf">57.656</span><span class="p">,</span> <span class="mf">58.959</span><span class="p">,</span> <span class="mf">59.237</span><span class="p">,</span> <span class="mf">62.221</span><span class="p">,</span> <span class="mf">62.517</span><span class="p">,</span> <span class="mf">63.494</span><span class="p">,</span> <span class="mf">64.667</span><span class="p">,</span> <span class="mf">64.958</span><span class="p">,</span> <span class="mf">65.688</span><span class="p">,</span> <span class="mf">66.398</span><span class="p">,</span> <span class="mf">68.196</span><span class="p">,</span> <span class="mf">68.369</span><span class="p">,</span> <span class="mf">69.269</span><span class="p">,</span> <span class="mf">71.449</span><span class="p">,</span> <span class="mf">71.689</span><span class="p">,</span> <span class="mf">71.939</span><span class="p">,</span> <span class="mf">73.649</span><span class="p">,</span> <span class="mf">73.949</span><span class="p">,</span> <span class="mf">74.049</span><span class="p">,</span> <span class="mf">74.309</span><span class="p">,</span> <span class="mf">79.900</span><span class="p">,</span> <span class="mf">83.64</span><span class="p">]</span>
        <span class="n">Labels</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;C1n&#39;</span><span class="p">,</span> <span class="mf">0.000</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C1r&#39;</span><span class="p">,</span> <span class="mf">0.781</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C2n&#39;</span><span class="p">,</span> <span class="mf">1.778</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C2r&#39;</span><span class="p">,</span> <span class="mf">1.945</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C2An&#39;</span><span class="p">,</span> <span class="mf">2.581</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C2Ar&#39;</span><span class="p">,</span> <span class="mf">3.596</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C3n&#39;</span><span class="p">,</span> <span class="mf">4.187</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C3r&#39;</span><span class="p">,</span> <span class="mf">5.235</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C3An&#39;</span><span class="p">,</span> <span class="mf">6.033</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C3Ar&#39;</span><span class="p">,</span> <span class="mf">6.733</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C3Bn&#39;</span><span class="p">,</span> <span class="mf">7.140</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C3Br&#39;</span><span class="p">,</span> <span class="mf">7.212</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C4n&#39;</span><span class="p">,</span> <span class="mf">7.528</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C4r&#39;</span><span class="p">,</span> <span class="mf">8.108</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C4An&#39;</span><span class="p">,</span> <span class="mf">8.771</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C4Ar&#39;</span><span class="p">,</span> <span class="mf">9.105</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C5n&#39;</span><span class="p">,</span> <span class="mf">9.786</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C5r&#39;</span><span class="p">,</span> <span class="mf">11.056</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C5An&#39;</span><span class="p">,</span> <span class="mf">12.049</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C5Ar&#39;</span><span class="p">,</span> <span class="mf">12.474</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C5AAn&#39;</span><span class="p">,</span> <span class="mf">13.032</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C5AAr&#39;</span><span class="p">,</span> <span class="mf">13.183</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C5ABn&#39;</span><span class="p">,</span> <span class="mf">13.363</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C5ABr&#39;</span><span class="p">,</span> <span class="mf">13.608</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C5ACn&#39;</span><span class="p">,</span> <span class="mf">13.739</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C5ACr&#39;</span><span class="p">,</span> <span class="mf">14.070</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C5ADn&#39;</span><span class="p">,</span> <span class="mf">14.163</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C5ADr&#39;</span><span class="p">,</span> <span class="mf">14.609</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C5Bn&#39;</span><span class="p">,</span> <span class="mf">14.775</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C5Br&#39;</span><span class="p">,</span> <span class="mf">15.160</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C5Cn&#39;</span><span class="p">,</span> <span class="mf">15.974</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C5Cr&#39;</span><span class="p">,</span> <span class="mf">16.721</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C5Dn&#39;</span><span class="p">,</span> <span class="mf">17.235</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C5Dr&#39;</span><span class="p">,</span> <span class="mf">17.533</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C5En&#39;</span><span class="p">,</span> <span class="mf">18.056</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C5Er&#39;</span><span class="p">,</span> <span class="mf">18.524</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C6n&#39;</span><span class="p">,</span> <span class="mf">18.748</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C6r&#39;</span><span class="p">,</span> <span class="mf">19.722</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C6An&#39;</span><span class="p">,</span> <span class="mf">20.040</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C6Ar&#39;</span><span class="p">,</span> <span class="mf">20.709</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C6AAn&#39;</span><span class="p">,</span> <span class="mf">21.083</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C6AAr&#39;</span><span class="p">,</span> <span class="mf">21.159</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C6Bn&#39;</span><span class="p">,</span> <span class="mf">21.767</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C6Br&#39;</span><span class="p">,</span> <span class="mf">22.268</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C6Cn&#39;</span><span class="p">,</span> <span class="mf">22.564</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C6Cr&#39;</span><span class="p">,</span> <span class="mf">23.295</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C7n&#39;</span><span class="p">,</span> <span class="mf">23.962</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C7r&#39;</span><span class="p">,</span> <span class="mf">24.474</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C7An&#39;</span><span class="p">,</span> <span class="mf">24.761</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C7Ar&#39;</span><span class="p">,</span> <span class="mf">24.984</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C8n&#39;</span><span class="p">,</span> <span class="mf">25.099</span><span class="p">],</span> <span class="p">[</span>
            <span class="s1">&#39;C8r&#39;</span><span class="p">,</span> <span class="mf">25.987</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C9n&#39;</span><span class="p">,</span> <span class="mf">26.420</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C9r&#39;</span><span class="p">,</span> <span class="mf">27.439</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C10n&#39;</span><span class="p">,</span> <span class="mf">27.859</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C10r&#39;</span><span class="p">,</span> <span class="mf">28.278</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C11n&#39;</span><span class="p">,</span> <span class="mf">29.183</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C11r&#39;</span><span class="p">,</span> <span class="mf">29.970</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C12n&#39;</span><span class="p">,</span> <span class="mf">30.591</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C12r&#39;</span><span class="p">,</span> <span class="mf">31.034</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C13n&#39;</span><span class="p">,</span> <span class="mf">33.157</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C13r&#39;</span><span class="p">,</span> <span class="mf">33.705</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C15n&#39;</span><span class="p">,</span> <span class="mf">34.999</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C15r&#39;</span><span class="p">,</span> <span class="mf">35.294</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C16n&#39;</span><span class="p">,</span> <span class="mf">35.706</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C16r&#39;</span><span class="p">,</span> <span class="mf">36.700</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C17n&#39;</span><span class="p">,</span> <span class="mf">36.969</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C17r&#39;</span><span class="p">,</span> <span class="mf">38.333</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C18n&#39;</span><span class="p">,</span> <span class="mf">38.615</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C18r&#39;</span><span class="p">,</span> <span class="mf">40.145</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C19n&#39;</span><span class="p">,</span> <span class="mf">41.154</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C19r&#39;</span><span class="p">,</span> <span class="mf">41.390</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C20n&#39;</span><span class="p">,</span> <span class="mf">42.301</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C20r&#39;</span><span class="p">,</span> <span class="mf">43.432</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C21n&#39;</span><span class="p">,</span> <span class="mf">45.724</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C21r&#39;</span><span class="p">,</span> <span class="mf">47.349</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C22n&#39;</span><span class="p">,</span> <span class="mf">48.566</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C22r&#39;</span><span class="p">,</span> <span class="mf">49.344</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C23n&#39;</span><span class="p">,</span> <span class="mf">50.628</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C23r&#39;</span><span class="p">,</span> <span class="mf">51.833</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C24n&#39;</span><span class="p">,</span> <span class="mf">52.620</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C24r&#39;</span><span class="p">,</span> <span class="mf">53.983</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C25n&#39;</span><span class="p">,</span> <span class="mf">57.101</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C25r&#39;</span><span class="p">,</span> <span class="mf">57.656</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C26n&#39;</span><span class="p">,</span> <span class="mf">58.959</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C26r&#39;</span><span class="p">,</span> <span class="mf">59.237</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C27n&#39;</span><span class="p">,</span> <span class="mf">62.221</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C27r&#39;</span><span class="p">,</span> <span class="mf">62.517</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C28n&#39;</span><span class="p">,</span> <span class="mf">63.494</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C28r&#39;</span><span class="p">,</span> <span class="mf">64.667</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C29n&#39;</span><span class="p">,</span> <span class="mf">64.958</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C29r&#39;</span><span class="p">,</span> <span class="mf">65.688</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C30n&#39;</span><span class="p">,</span> <span class="mf">66.398</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C30r&#39;</span><span class="p">,</span> <span class="mf">68.196</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C31n&#39;</span><span class="p">,</span> <span class="mf">68.369</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C31r&#39;</span><span class="p">,</span> <span class="mf">69.269</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C32n&#39;</span><span class="p">,</span> <span class="mf">71.449</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C32r&#39;</span><span class="p">,</span> <span class="mf">73.649</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C33n&#39;</span><span class="p">,</span> <span class="mf">74.309</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C33r&#39;</span><span class="p">,</span> <span class="mf">79.900</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;C34n&#39;</span><span class="p">,</span> <span class="mf">83.64</span><span class="p">]]</span>
        <span class="k">return</span> <span class="n">TS</span><span class="p">,</span> <span class="n">Labels</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Time Scale Option Not Available&quot;</span><span class="p">)</span>
    <span class="k">return</span></div>


<div class="viewcode-block" id="execute"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.execute">[docs]</a><span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Work around for Python3 exec function which doesn&#39;t allow changes to the local namespace because of scope.</span>
<span class="sd">    This breaks a lot of the old functionality in the code which was originally in Python2. So this function</span>
<span class="sd">    runs just like exec except that it returns the output of the input statement to the local namespace. It may</span>
<span class="sd">    break if you start feeding it multiline monoliths of statements (haven&#39;t tested) but you shouldn&#39;t do that</span>
<span class="sd">    anyway (bad programming).</span>

<span class="sd">    Parameters</span>
<span class="sd">    -----------</span>
<span class="sd">    st : the statement you want executed and for which you want the return</span>
<span class="sd">    kwargs : anything that may need to be in this namespace to execute st</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    The return value of executing the input statement</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">namespace</span> <span class="o">=</span> <span class="n">kwargs</span>
    <span class="n">exec</span><span class="p">(</span><span class="s2">&quot;b = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">st</span><span class="p">),</span> <span class="n">namespace</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">namespace</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">]</span></div>

<span class="c1"># Functions for dealing with acceptance criteria</span>


<div class="viewcode-block" id="initialize_acceptance_criteria"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.initialize_acceptance_criteria">[docs]</a><span class="k">def</span> <span class="nf">initialize_acceptance_criteria</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    initialize acceptance criteria with NULL values for thellier_gui and demag_gui</span>

<span class="sd">    acceptance criteria format is doctionaries:</span>

<span class="sd">    acceptance_criteria={}</span>
<span class="sd">        acceptance_criteria[crit]={}</span>
<span class="sd">            acceptance_criteria[crit][&#39;category&#39;]=</span>
<span class="sd">            acceptance_criteria[crit][&#39;criterion_name&#39;]=</span>
<span class="sd">            acceptance_criteria[crit][&#39;value&#39;]=</span>
<span class="sd">            acceptance_criteria[crit][&#39;threshold_type&#39;]</span>
<span class="sd">            acceptance_criteria[crit][&#39;decimal_points&#39;]</span>

<span class="sd">   &#39;category&#39;:</span>
<span class="sd">       &#39;DE-SPEC&#39;,&#39;DE-SAMP&#39;..etc</span>
<span class="sd">   &#39;criterion_name&#39;:</span>
<span class="sd">       MagIC name</span>
<span class="sd">   &#39;value&#39;:</span>
<span class="sd">        a number (for &#39;regular criteria&#39;)</span>
<span class="sd">        a string (for &#39;flag&#39;)</span>
<span class="sd">        1 for True (if criteria is bullean)</span>
<span class="sd">        0 for False (if criteria is bullean)</span>
<span class="sd">        -999 means N/A</span>
<span class="sd">   &#39;threshold_type&#39;:</span>
<span class="sd">       &#39;low&#39;for low threshold value</span>
<span class="sd">       &#39;high&#39;for high threshold value</span>
<span class="sd">        [flag1.flag2]: for flags</span>
<span class="sd">        &#39;bool&#39; for boolean flags (can be &#39;g&#39;,&#39;b&#39; or True/Flase or 1/0)</span>
<span class="sd">   &#39;decimal_points&#39;:</span>
<span class="sd">       number of decimal points in rounding</span>
<span class="sd">       (this is used in displaying criteria in the dialog box)</span>
<span class="sd">       -999 means Exponent with 3 descimal points for floats and string for string</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">acceptance_criteria</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="c1"># --------------------------------</span>
    <span class="c1"># &#39;DE-SPEC&#39;</span>
    <span class="c1"># --------------------------------</span>
    <span class="c1"># low cutoff value</span>
    <span class="n">category</span> <span class="o">=</span> <span class="s1">&#39;DE-SPEC&#39;</span>
    <span class="k">for</span> <span class="n">crit</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;specimen_n&#39;</span><span class="p">]:</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">category</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;criterion_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">crit</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;threshold_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;low&quot;</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;decimal_points&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># high cutoff value</span>
    <span class="n">category</span> <span class="o">=</span> <span class="s1">&#39;DE-SPEC&#39;</span>
    <span class="k">for</span> <span class="n">crit</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;specimen_mad&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_dang&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_alpha95&#39;</span><span class="p">]:</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">category</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;criterion_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">crit</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;threshold_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;high&quot;</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;decimal_points&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="c1"># flag</span>
    <span class="k">for</span> <span class="n">crit</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;specimen_direction_type&#39;</span><span class="p">]:</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">category</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;criterion_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">crit</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>
        <span class="k">if</span> <span class="n">crit</span> <span class="o">==</span> <span class="s1">&#39;specimen_direction_type&#39;</span><span class="p">:</span>
            <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;threshold_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="s1">&#39;p&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">crit</span> <span class="o">==</span> <span class="s1">&#39;specimen_polarity&#39;</span><span class="p">:</span>
            <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;threshold_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;i&#39;</span><span class="p">]</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;decimal_points&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>

    <span class="c1"># --------------------------------</span>
    <span class="c1"># &#39;DE-SAMP&#39;</span>
    <span class="c1"># --------------------------------</span>

    <span class="c1"># low cutoff value</span>
    <span class="n">category</span> <span class="o">=</span> <span class="s1">&#39;DE-SAMP&#39;</span>
    <span class="k">for</span> <span class="n">crit</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;sample_n&#39;</span><span class="p">,</span> <span class="s1">&#39;sample_n_lines&#39;</span><span class="p">,</span> <span class="s1">&#39;sample_n_planes&#39;</span><span class="p">]:</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">category</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;criterion_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">crit</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;threshold_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;low&quot;</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;decimal_points&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># high cutoff value</span>
    <span class="n">category</span> <span class="o">=</span> <span class="s1">&#39;DE-SAMP&#39;</span>
    <span class="k">for</span> <span class="n">crit</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;sample_r&#39;</span><span class="p">,</span> <span class="s1">&#39;sample_alpha95&#39;</span><span class="p">,</span> <span class="s1">&#39;sample_sigma&#39;</span><span class="p">,</span> <span class="s1">&#39;sample_k&#39;</span><span class="p">,</span> <span class="s1">&#39;sample_tilt_correction&#39;</span><span class="p">]:</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">category</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;criterion_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">crit</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;threshold_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;high&quot;</span>
        <span class="k">if</span> <span class="n">crit</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;sample_tilt_correction&#39;</span><span class="p">]:</span>
            <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;decimal_points&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">elif</span> <span class="n">crit</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;sample_alpha95&#39;</span><span class="p">]:</span>
            <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;decimal_points&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;decimal_points&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>

    <span class="c1"># flag</span>
    <span class="k">for</span> <span class="n">crit</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;sample_direction_type&#39;</span><span class="p">,</span> <span class="s1">&#39;sample_polarity&#39;</span><span class="p">]:</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">category</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;criterion_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">crit</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>
        <span class="k">if</span> <span class="n">crit</span> <span class="o">==</span> <span class="s1">&#39;sample_direction_type&#39;</span><span class="p">:</span>
            <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;threshold_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="s1">&#39;p&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">crit</span> <span class="o">==</span> <span class="s1">&#39;sample_polarity&#39;</span><span class="p">:</span>
            <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;threshold_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;i&#39;</span><span class="p">]</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;decimal_points&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>

    <span class="c1"># --------------------------------</span>
    <span class="c1"># &#39;DE-SITE&#39;</span>
    <span class="c1"># --------------------------------</span>

    <span class="c1"># low cutoff value</span>
    <span class="n">category</span> <span class="o">=</span> <span class="s1">&#39;DE-SITE&#39;</span>
    <span class="k">for</span> <span class="n">crit</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;site_n&#39;</span><span class="p">,</span> <span class="s1">&#39;site_n_lines&#39;</span><span class="p">,</span> <span class="s1">&#39;site_n_planes&#39;</span><span class="p">]:</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">category</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;criterion_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">crit</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;threshold_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;low&quot;</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;decimal_points&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># high cutoff value</span>
    <span class="k">for</span> <span class="n">crit</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;site_k&#39;</span><span class="p">,</span> <span class="s1">&#39;site_r&#39;</span><span class="p">,</span> <span class="s1">&#39;site_alpha95&#39;</span><span class="p">,</span> <span class="s1">&#39;site_sigma&#39;</span><span class="p">,</span> <span class="s1">&#39;site_tilt_correction&#39;</span><span class="p">]:</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">category</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;criterion_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">crit</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;threshold_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;high&quot;</span>
        <span class="k">if</span> <span class="n">crit</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;site_tilt_correction&#39;</span><span class="p">]:</span>
            <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;decimal_points&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;decimal_points&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="c1"># flag</span>
    <span class="k">for</span> <span class="n">crit</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;site_direction_type&#39;</span><span class="p">,</span> <span class="s1">&#39;site_polarity&#39;</span><span class="p">]:</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">category</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;criterion_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">crit</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>
        <span class="k">if</span> <span class="n">crit</span> <span class="o">==</span> <span class="s1">&#39;site_direction_type&#39;</span><span class="p">:</span>
            <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;threshold_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="s1">&#39;p&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">crit</span> <span class="o">==</span> <span class="s1">&#39;site_polarity&#39;</span><span class="p">:</span>
            <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;threshold_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;i&#39;</span><span class="p">]</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;decimal_points&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>

    <span class="c1"># --------------------------------</span>
    <span class="c1"># &#39;DE-STUDY&#39;</span>
    <span class="c1"># --------------------------------</span>
    <span class="n">category</span> <span class="o">=</span> <span class="s1">&#39;DE-STUDY&#39;</span>
    <span class="c1"># low cutoff value</span>
    <span class="k">for</span> <span class="n">crit</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;average_k&#39;</span><span class="p">,</span> <span class="s1">&#39;average_n&#39;</span><span class="p">,</span> <span class="s1">&#39;average_nn&#39;</span><span class="p">,</span> <span class="s1">&#39;average_nnn&#39;</span><span class="p">,</span> <span class="s1">&#39;average_r&#39;</span><span class="p">]:</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">category</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;criterion_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">crit</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;threshold_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;low&quot;</span>
        <span class="k">if</span> <span class="n">crit</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;average_n&#39;</span><span class="p">,</span> <span class="s1">&#39;average_nn&#39;</span><span class="p">,</span> <span class="s1">&#39;average_nnn&#39;</span><span class="p">]:</span>
            <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;decimal_points&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">elif</span> <span class="n">crit</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;average_alpha95&#39;</span><span class="p">]:</span>
            <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;decimal_points&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;decimal_points&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>

    <span class="c1"># high cutoff value</span>
    <span class="k">for</span> <span class="n">crit</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;average_alpha95&#39;</span><span class="p">,</span> <span class="s1">&#39;average_sigma&#39;</span><span class="p">]:</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">category</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;criterion_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">crit</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;threshold_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;high&quot;</span>
        <span class="k">if</span> <span class="n">crit</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;average_alpha95&#39;</span><span class="p">]:</span>
            <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;decimal_points&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;decimal_points&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>

    <span class="c1"># --------------------------------</span>
    <span class="c1"># &#39;IE-SPEC&#39; (a long list from SPD.v.1.0)</span>
    <span class="c1"># --------------------------------</span>
    <span class="n">category</span> <span class="o">=</span> <span class="s1">&#39;IE-SPEC&#39;</span>

    <span class="c1"># low cutoff value</span>
    <span class="k">for</span> <span class="n">crit</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;specimen_int_n&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_f&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_fvds&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_frac&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_q&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_w&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_r_sq&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_int_ptrm_n&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;specimen_int_ptrm_tail_n&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_ac_n&#39;</span><span class="p">]:</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">category</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;criterion_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">crit</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;threshold_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;low&quot;</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;decimal_points&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">crit</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;specimen_int_n&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_int_ptrm_n&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_int_ptrm_tail_n&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_ac_n&#39;</span><span class="p">]:</span>
            <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;decimal_points&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">elif</span> <span class="n">crit</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;specimen_f&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_fvds&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_frac&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_q&#39;</span><span class="p">]:</span>
            <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;decimal_points&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;decimal_points&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>

    <span class="c1"># high cutoff value</span>
    <span class="k">for</span> <span class="n">crit</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;specimen_b_sigma&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_b_beta&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_g&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_gmax&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_k&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_k_sse&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_k_prime&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_k_prime_sse&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;specimen_coeff_det_sq&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_z&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_z_md&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_int_mad&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_int_mad_anc&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_int_alpha&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_alpha&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_alpha_prime&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;specimen_theta&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_int_dang&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_int_crm&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_ptrm&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_dck&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_drat&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_maxdev&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_cdrat&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;specimen_drats&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_mdrat&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_mdev&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_dpal&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_tail_drat&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_dtr&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_md&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_dt&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_dac&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_gamma&#39;</span><span class="p">]:</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">category</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;criterion_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">crit</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;threshold_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;high&quot;</span>
        <span class="k">if</span> <span class="n">crit</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;specimen_int_mad&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_int_mad_anc&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_int_dang&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_drat&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_cdrat&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_drats&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_tail_drat&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_dtr&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_md&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_dac&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_gamma&#39;</span><span class="p">]:</span>
            <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;decimal_points&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">crit</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;specimen_gmax&#39;</span><span class="p">]:</span>
            <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;decimal_points&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">elif</span> <span class="n">crit</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;specimen_b_sigma&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_b_beta&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_g&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_k&#39;</span><span class="p">,</span> <span class="s1">&#39;specimen_k_prime&#39;</span><span class="p">]:</span>
            <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;decimal_points&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;decimal_points&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>

    <span class="c1"># flags</span>
    <span class="k">for</span> <span class="n">crit</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;specimen_scat&#39;</span><span class="p">]:</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">category</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;criterion_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">crit</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;threshold_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;bool&#39;</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;decimal_points&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>

    <span class="c1"># --------------------------------</span>
    <span class="c1"># &#39;IE-SAMP&#39;</span>
    <span class="c1"># --------------------------------</span>
    <span class="n">category</span> <span class="o">=</span> <span class="s1">&#39;IE-SAMP&#39;</span>

    <span class="c1"># low cutoff value</span>
    <span class="k">for</span> <span class="n">crit</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;sample_int_n&#39;</span><span class="p">]:</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">category</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;criterion_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">crit</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;threshold_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;low&quot;</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;decimal_points&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># high cutoff value</span>
    <span class="k">for</span> <span class="n">crit</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;sample_int_rel_sigma&#39;</span><span class="p">,</span> <span class="s1">&#39;sample_int_rel_sigma_perc&#39;</span><span class="p">,</span> <span class="s1">&#39;sample_int_sigma&#39;</span><span class="p">,</span> <span class="s1">&#39;sample_int_sigma_perc&#39;</span><span class="p">]:</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">category</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;criterion_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">crit</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;threshold_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;high&quot;</span>
        <span class="k">if</span> <span class="n">crit</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;sample_int_rel_sigma_perc&#39;</span><span class="p">,</span> <span class="s1">&#39;sample_int_sigma_perc&#39;</span><span class="p">]:</span>
            <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;decimal_points&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;decimal_points&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>

    <span class="c1"># --------------------------------</span>
    <span class="c1"># &#39;IE-SITE&#39;</span>
    <span class="c1"># --------------------------------</span>
    <span class="n">category</span> <span class="o">=</span> <span class="s1">&#39;IE-SITE&#39;</span>

    <span class="c1"># low cutoff value</span>
    <span class="k">for</span> <span class="n">crit</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;site_int_n&#39;</span><span class="p">]:</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">category</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;criterion_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">crit</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;threshold_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;low&quot;</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;decimal_points&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># high cutoff value</span>
    <span class="k">for</span> <span class="n">crit</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;site_int_rel_sigma&#39;</span><span class="p">,</span> <span class="s1">&#39;site_int_rel_sigma_perc&#39;</span><span class="p">,</span> <span class="s1">&#39;site_int_sigma&#39;</span><span class="p">,</span> <span class="s1">&#39;site_int_sigma_perc&#39;</span><span class="p">]:</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">category</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;criterion_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">crit</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;threshold_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;high&quot;</span>
        <span class="k">if</span> <span class="n">crit</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;site_int_rel_sigma_perc&#39;</span><span class="p">,</span> <span class="s1">&#39;site_int_sigma_perc&#39;</span><span class="p">]:</span>
            <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;decimal_points&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;decimal_points&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>

    <span class="c1"># --------------------------------</span>
    <span class="c1"># &#39;IE-STUDY&#39;</span>
    <span class="c1"># --------------------------------</span>
    <span class="n">category</span> <span class="o">=</span> <span class="s1">&#39;IE-STUDY&#39;</span>
    <span class="c1"># low cutoff value</span>
    <span class="k">for</span> <span class="n">crit</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;average_int_n&#39;</span><span class="p">,</span> <span class="s1">&#39;average_int_n&#39;</span><span class="p">,</span> <span class="s1">&#39;average_int_nn&#39;</span><span class="p">,</span> <span class="s1">&#39;average_int_nnn&#39;</span><span class="p">,</span> <span class="p">]:</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">category</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;criterion_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">crit</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;threshold_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;low&quot;</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;decimal_points&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># high cutoff value</span>
    <span class="k">for</span> <span class="n">crit</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;average_int_rel_sigma&#39;</span><span class="p">,</span> <span class="s1">&#39;average_int_rel_sigma_perc&#39;</span><span class="p">,</span> <span class="s1">&#39;average_int_sigma&#39;</span><span class="p">]:</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">category</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;criterion_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">crit</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;threshold_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;high&quot;</span>
        <span class="k">if</span> <span class="n">crit</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;average_int_rel_sigma_perc&#39;</span><span class="p">]:</span>
            <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;decimal_points&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;decimal_points&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>

    <span class="c1"># --------------------------------</span>
    <span class="c1"># &#39;NPOLE&#39;</span>
    <span class="c1"># --------------------------------</span>
    <span class="n">category</span> <span class="o">=</span> <span class="s1">&#39;NPOLE&#39;</span>
    <span class="c1"># flags</span>
    <span class="k">for</span> <span class="n">crit</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;site_polarity&#39;</span><span class="p">]:</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">category</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;criterion_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">crit</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;threshold_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">]</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;decimal_points&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>

    <span class="c1"># --------------------------------</span>
    <span class="c1"># &#39;NPOLE&#39;</span>
    <span class="c1"># --------------------------------</span>
    <span class="n">category</span> <span class="o">=</span> <span class="s1">&#39;RPOLE&#39;</span>
    <span class="c1"># flags</span>
    <span class="k">for</span> <span class="n">crit</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;site_polarity&#39;</span><span class="p">]:</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">category</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;criterion_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">crit</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;threshold_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">]</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;decimal_points&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>

    <span class="c1"># --------------------------------</span>
    <span class="c1"># &#39;VADM&#39;</span>
    <span class="c1"># --------------------------------</span>
    <span class="n">category</span> <span class="o">=</span> <span class="s1">&#39;VADM&#39;</span>
    <span class="c1"># low cutoff value</span>
    <span class="k">for</span> <span class="n">crit</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;vadm_n&#39;</span><span class="p">]:</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">category</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;criterion_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">crit</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;threshold_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;low&quot;</span>
        <span class="k">if</span> <span class="n">crit</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;vadm_n&#39;</span><span class="p">]:</span>
            <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;decimal_points&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;decimal_points&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>

    <span class="c1"># --------------------------------</span>
    <span class="c1"># &#39;VADM&#39;</span>
    <span class="c1"># --------------------------------</span>
    <span class="n">category</span> <span class="o">=</span> <span class="s1">&#39;VADM&#39;</span>
    <span class="c1"># low cutoff value</span>
    <span class="k">for</span> <span class="n">crit</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;vadm_n&#39;</span><span class="p">]:</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">category</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;criterion_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">crit</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;threshold_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;low&quot;</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;decimal_points&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># high cutoff value</span>
    <span class="k">for</span> <span class="n">crit</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;vadm_sigma&#39;</span><span class="p">]:</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">category</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;criterion_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">crit</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;threshold_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;low&quot;</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;decimal_points&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>

    <span class="c1"># --------------------------------</span>
    <span class="c1"># &#39;VADM&#39;</span>
    <span class="c1"># --------------------------------</span>
    <span class="n">category</span> <span class="o">=</span> <span class="s1">&#39;VDM&#39;</span>
    <span class="c1"># low cutoff value</span>
    <span class="k">for</span> <span class="n">crit</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;vdm_n&#39;</span><span class="p">]:</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">category</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;criterion_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">crit</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;threshold_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;low&quot;</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;decimal_points&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># high cutoff value</span>
    <span class="k">for</span> <span class="n">crit</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;vdm_sigma&#39;</span><span class="p">]:</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">category</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;criterion_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">crit</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;threshold_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;low&quot;</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;decimal_points&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>

    <span class="c1"># --------------------------------</span>
    <span class="c1"># &#39;VGP&#39;</span>
    <span class="c1"># --------------------------------</span>
    <span class="n">category</span> <span class="o">=</span> <span class="s1">&#39;VDM&#39;</span>
    <span class="c1"># low cutoff value</span>
    <span class="k">for</span> <span class="n">crit</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;vgp_n&#39;</span><span class="p">]:</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">category</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;criterion_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">crit</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;threshold_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;low&quot;</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;decimal_points&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># high cutoff value</span>
    <span class="k">for</span> <span class="n">crit</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;vgp_alpha95&#39;</span><span class="p">,</span> <span class="s1">&#39;vgp_dm&#39;</span><span class="p">,</span> <span class="s1">&#39;vgp_dp&#39;</span><span class="p">,</span> <span class="s1">&#39;vgp_sigma&#39;</span><span class="p">]:</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">category</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;criterion_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">crit</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;threshold_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;low&quot;</span>
        <span class="k">if</span> <span class="n">crit</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;vgp_alpha95&#39;</span><span class="p">]:</span>
            <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;decimal_points&#39;</span><span class="p">,</span> <span class="s1">&#39;vgp_dm&#39;</span><span class="p">,</span> <span class="s1">&#39;vgp_dp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;decimal_points&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>

    <span class="c1"># --------------------------------</span>
    <span class="c1"># &#39;AGE&#39;</span>
    <span class="c1"># --------------------------------</span>
    <span class="n">category</span> <span class="o">=</span> <span class="s1">&#39;AGE&#39;</span>
    <span class="c1"># low cutoff value</span>
    <span class="k">for</span> <span class="n">crit</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;average_age_min&#39;</span><span class="p">]:</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">category</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;criterion_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">crit</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;threshold_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;low&quot;</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;decimal_points&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>

    <span class="c1"># high cutoff value</span>
    <span class="k">for</span> <span class="n">crit</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;average_age_max&#39;</span><span class="p">,</span> <span class="s1">&#39;average_age_sigma&#39;</span><span class="p">]:</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">category</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;criterion_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">crit</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;threshold_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;high&quot;</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;decimal_points&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>

    <span class="c1"># flags</span>
    <span class="k">for</span> <span class="n">crit</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;average_age_unit&#39;</span><span class="p">]:</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">category</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;criterion_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">crit</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;threshold_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;Ga&#39;</span><span class="p">,</span> <span class="s1">&#39;Ka&#39;</span><span class="p">,</span> <span class="s1">&#39;Ma&#39;</span><span class="p">,</span> <span class="s1">&#39;Years AD (+/-)&#39;</span><span class="p">,</span> <span class="s1">&#39;Years BP&#39;</span><span class="p">,</span> <span class="s1">&#39;Years Cal AD (+/-)&#39;</span><span class="p">,</span> <span class="s1">&#39;Years Cal BP&#39;</span><span class="p">]</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;decimal_points&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>

    <span class="c1"># --------------------------------</span>
    <span class="c1"># &#39;ANI&#39;</span>
    <span class="c1"># --------------------------------</span>
    <span class="n">category</span> <span class="o">=</span> <span class="s1">&#39;ANI&#39;</span>
    <span class="c1"># high cutoff value</span>
    <span class="k">for</span> <span class="n">crit</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;anisotropy_alt&#39;</span><span class="p">,</span> <span class="s1">&#39;sample_aniso_mean&#39;</span><span class="p">,</span> <span class="s1">&#39;site_aniso_mean&#39;</span><span class="p">]:</span>  <span class="c1"># value is in percent</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">category</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;criterion_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">crit</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;threshold_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;high&quot;</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;decimal_points&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>

    <span class="c1"># flags</span>

    <span class="k">for</span> <span class="n">crit</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;specimen_aniso_ftest_flag&#39;</span><span class="p">]:</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">category</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;criterion_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">crit</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;threshold_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;bool&#39;</span>
        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;decimal_points&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>

    <span class="k">return</span><span class="p">(</span><span class="n">acceptance_criteria</span><span class="p">)</span></div>


<div class="viewcode-block" id="read_criteria_from_file"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.read_criteria_from_file">[docs]</a><span class="k">def</span> <span class="nf">read_criteria_from_file</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">acceptance_criteria</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Read accceptance criteria from magic criteria file</span>
<span class="sd">    # old format:</span>
<span class="sd">    multiple lines.  pmag_criteria_code defines the type of criteria</span>

<span class="sd">    to deal with old format this function reads all the lines and ignore empty cells.</span>
<span class="sd">    i.e., the program assumes that in each column there is only one value (in one of the lines)</span>

<span class="sd">    special case in the old format:</span>
<span class="sd">        specimen_dang has a value and pmag_criteria_code is IE-specimen.</span>
<span class="sd">        The program assumes that the user means specimen_int_dang</span>
<span class="sd">    # New format for thellier_gui and demag_gui:</span>
<span class="sd">    one long line. pmag_criteria_code=ACCEPT</span>

<span class="sd">    path is the full path to the criteria file</span>

<span class="sd">    the function takes exiting acceptance_criteria</span>
<span class="sd">    and updtate it with criteria from file</span>

<span class="sd">    output:</span>
<span class="sd">    acceptance_criteria={}</span>
<span class="sd">    acceptance_criteria[MagIC Variable Names]={}</span>
<span class="sd">    acceptance_criteria[MagIC Variable Names][&#39;value&#39;]:</span>
<span class="sd">        a number for acceptance criteria value</span>
<span class="sd">        -999 for N/A</span>
<span class="sd">        1/0 for True/False or Good/Bad</span>
<span class="sd">    acceptance_criteria[MagIC Variable Names][&#39;threshold_type&#39;]:</span>
<span class="sd">        &quot;low&quot;:  lower cutoff value i.e. crit&gt;=value pass criteria</span>
<span class="sd">        &quot;high&quot;: high cutoff value i.e. crit&lt;=value pass criteria</span>
<span class="sd">        [string1,string2,....]: for flags</span>
<span class="sd">    acceptance_criteria[MagIC Variable Names][&#39;decimal_points&#39;]:number of decimal points in rounding</span>
<span class="sd">            (this is used in displaying criteria in the dialog box)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">warnings</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">acceptance_criteria_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">acceptance_criteria</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="k">if</span> <span class="s1">&#39;data_model&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;data_model&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">crit_data</span> <span class="o">=</span> <span class="n">acceptance_criteria</span>  <span class="c1"># data already read in</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">crit_data</span><span class="p">,</span> <span class="n">file_type</span> <span class="o">=</span> <span class="n">magic_read</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;criteria&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">file_type</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;empty&#39;</span> <span class="ow">in</span> <span class="n">file_type</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-W- No criteria found: </span><span class="si">{}</span><span class="s1"> &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span>
                    <span class="s1">&#39;-W- </span><span class="si">{}</span><span class="s1"> could not be read and may be improperly formatted...&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">crit_data</span><span class="p">:</span>
        <span class="c1"># gather metadata</span>
        <span class="n">metadata_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;pmag_criteria_code&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;criteria_definition&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;er_citation_names&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">}</span>
        <span class="k">for</span> <span class="n">metadata</span> <span class="ow">in</span> <span class="n">metadata_dict</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">metadata</span> <span class="ow">in</span> <span class="n">rec</span><span class="p">:</span>
                <span class="n">metadata_dict</span><span class="p">[</span><span class="n">metadata</span><span class="p">]</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="n">metadata</span><span class="p">]</span>
        <span class="c1"># check each record for correct name and compatibility</span>
        <span class="k">for</span> <span class="n">crit</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="k">if</span> <span class="n">crit</span> <span class="o">==</span> <span class="s1">&#39;anisotropy_ftest_flag&#39;</span> <span class="ow">and</span> <span class="n">crit</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                <span class="n">crit</span> <span class="o">=</span> <span class="s1">&#39;specimen_aniso_ftest_flag&#39;</span>  <span class="c1"># convert legacy criterion to 2.5</span>
            <span class="n">rec</span><span class="p">[</span><span class="n">crit</span><span class="p">]</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="n">crit</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">crit</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;pmag_criteria_code&#39;</span><span class="p">,</span> <span class="s1">&#39;criteria_definition&#39;</span><span class="p">,</span> <span class="s1">&#39;magic_experiment_names&#39;</span><span class="p">,</span> <span class="s1">&#39;er_citation_names&#39;</span><span class="p">]:</span>
                <span class="k">continue</span>
            <span class="k">elif</span> <span class="n">rec</span><span class="p">[</span><span class="n">crit</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="c1"># this catches all the ones that are being overwritten</span>
            <span class="k">if</span> <span class="n">crit</span> <span class="ow">in</span> <span class="n">acceptance_criteria</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="o">-</span><span class="mi">999</span><span class="p">,</span> <span class="s1">&#39;-999&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">999</span><span class="p">]:</span>

                    <span class="nb">print</span><span class="p">(</span>
                        <span class="s2">&quot;-W- You have multiple different criteria that both use column: </span><span class="si">{}</span><span class="s2">.</span><span class="se">\n</span><span class="s2">The last will be used:</span><span class="se">\n</span><span class="si">{}</span><span class="s2">.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">crit</span><span class="p">,</span> <span class="n">rec</span><span class="p">))</span>
                    <span class="n">warn_string</span> <span class="o">=</span> <span class="s1">&#39;multiple criteria for column: </span><span class="si">{}</span><span class="s1"> (only last will be used)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="n">crit</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">warn_string</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">warnings</span><span class="p">:</span>
                        <span class="n">warnings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">warn_string</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">crit</span> <span class="o">==</span> <span class="s2">&quot;specimen_dang&quot;</span> <span class="ow">and</span> <span class="s2">&quot;pmag_criteria_code&quot;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="s2">&quot;IE-SPEC&quot;</span> <span class="ow">in</span> <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;pmag_criteria_code&quot;</span><span class="p">]:</span>
                <span class="n">crit</span> <span class="o">=</span> <span class="s2">&quot;specimen_int_dang&quot;</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-W- Found backward compatibility problem with selection criteria specimen_dang. Cannot be associated with IE-SPEC. Program assumes that the statistic is specimen_int_dang&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="s1">&#39;specimen_int_dang&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">acceptance_criteria</span><span class="p">:</span>
                    <span class="n">acceptance_criteria</span><span class="p">[</span><span class="s2">&quot;specimen_int_dang&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="n">acceptance_criteria</span><span class="p">[</span><span class="s2">&quot;specimen_int_dang&quot;</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span>
                    <span class="n">rec</span><span class="p">[</span><span class="s2">&quot;specimen_dang&quot;</span><span class="p">])</span>

            <span class="k">elif</span> <span class="n">crit</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">acceptance_criteria_list</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span>
                    <span class="s2">&quot;-W- WARNING: criteria code </span><span class="si">%s</span><span class="s2"> is not supported by PmagPy GUI. please check&quot;</span> <span class="o">%</span> <span class="n">crit</span><span class="p">)</span>
                <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rec</span><span class="p">[</span><span class="n">crit</span><span class="p">]</span>
                <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;threshold_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;inherited&quot;</span>
                <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;decimal_points&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span>
                <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="c1"># boolean flag</span>
            <span class="k">elif</span> <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;threshold_type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;bool&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="n">crit</span><span class="p">])</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;True&#39;</span><span class="p">,</span> <span class="s1">&#39;TRUE&#39;</span><span class="p">]:</span>
                    <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="c1"># criteria as flags</span>
            <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;threshold_type&#39;</span><span class="p">])</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="n">crit</span><span class="p">])</span> <span class="ow">in</span> <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;threshold_type&#39;</span><span class="p">]:</span>
                    <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="n">crit</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span>
                        <span class="s2">&quot;-W- WARNING: data </span><span class="si">%s</span><span class="s2"> from criteria code  </span><span class="si">%s</span><span class="s2"> and is not supported by PmagPy GUI. please check&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">crit</span><span class="p">,</span> <span class="n">rec</span><span class="p">[</span><span class="n">crit</span><span class="p">]))</span>
            <span class="k">elif</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="n">crit</span><span class="p">])</span> <span class="o">==</span> <span class="o">-</span><span class="mi">999</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="n">crit</span><span class="p">])</span>
            <span class="c1"># add in metadata to each record</span>
            <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">metadata_dict</span><span class="p">)</span>
    <span class="k">if</span> <span class="s2">&quot;return_warnings&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">acceptance_criteria</span><span class="p">,</span> <span class="n">warnings</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span><span class="p">(</span><span class="n">acceptance_criteria</span><span class="p">)</span></div>


<span class="k">def</span> <span class="nf">write_criteria_to_file</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">acceptance_criteria</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">bad_vals</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;-999&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">999</span><span class="p">,</span> <span class="o">-</span><span class="mf">999.</span><span class="p">]</span>
    <span class="n">acceptance_criteria</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">acceptance_criteria</span><span class="o">.</span><span class="n">items</span><span class="p">(</span>
    <span class="p">))</span> <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">v</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">bad_vals</span><span class="p">}</span>
    <span class="n">crit_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">acceptance_criteria</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">crit_list</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="k">if</span> <span class="s1">&#39;data_model&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;data_model&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">code_key</span> <span class="o">=</span> <span class="s1">&#39;criterion&#39;</span>
        <span class="n">definition_key</span> <span class="o">=</span> <span class="s1">&#39;description&#39;</span>
        <span class="n">citation_key</span> <span class="o">=</span> <span class="s1">&#39;citations&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">code_key</span> <span class="o">=</span> <span class="s1">&#39;pmag_criteria_code&#39;</span>
        <span class="n">definition_key</span> <span class="o">=</span> <span class="s1">&#39;criteria_definition&#39;</span>
        <span class="n">citation_key</span> <span class="o">=</span> <span class="s1">&#39;er_citation_names&#39;</span>
    <span class="n">recs</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># data_model 3 has a list of dictionaries, data_model 2.5 has just one record</span>
    <span class="n">rec</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">rec</span><span class="p">[</span><span class="n">code_key</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ACCEPT&quot;</span>
    <span class="n">rec</span><span class="p">[</span><span class="n">definition_key</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;acceptance criteria for study&quot;</span>
    <span class="n">rec</span><span class="p">[</span><span class="n">citation_key</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;This study&quot;</span>
    <span class="k">for</span> <span class="n">crit</span> <span class="ow">in</span> <span class="n">crit_list</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;category&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="c1"># ignore criteria that are not in MagIc model 2.5 or 3.0</span>
            <span class="k">if</span> <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;category&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;thellier_gui&#39;</span><span class="p">:</span>
                <span class="c1"># need to make a list of these dictionaries</span>
                <span class="k">if</span> <span class="s1">&#39;data_model&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;data_model&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                    <span class="n">rec</span> <span class="o">=</span> <span class="p">{}</span>
                    <span class="n">rec</span><span class="p">[</span><span class="n">definition_key</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;acceptance criteria for study&quot;</span>
                    <span class="n">rec</span><span class="p">[</span><span class="n">citation_key</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;This study&quot;</span>
                    <span class="n">rec</span><span class="p">[</span><span class="n">code_key</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;IE-SPEC&quot;</span>
                    <span class="k">if</span> <span class="s1">&#39;sample&#39;</span> <span class="ow">in</span> <span class="n">crit</span><span class="p">:</span>
                        <span class="n">rec</span><span class="p">[</span><span class="n">code_key</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;IE-SAMP&quot;</span>
                    <span class="k">if</span> <span class="s1">&#39;site&#39;</span> <span class="ow">in</span> <span class="n">crit</span><span class="p">:</span>
                        <span class="n">rec</span><span class="p">[</span><span class="n">code_key</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;IE-SITE&quot;</span>
                    <span class="n">rec</span><span class="p">[</span><span class="n">definition_key</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;acceptance criteria for study&quot;</span>
                    <span class="n">rec</span><span class="p">[</span><span class="n">citation_key</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;This study&quot;</span>
                    <span class="n">crit3_0</span> <span class="o">=</span> <span class="n">map_magic</span><span class="o">.</span><span class="n">convert_intensity_criteria</span><span class="p">(</span>
                        <span class="s1">&#39;magic3&#39;</span><span class="p">,</span> <span class="n">crit</span><span class="p">)</span>
                    <span class="n">rec</span><span class="p">[</span><span class="s1">&#39;table_column&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">crit3_0</span>
                    <span class="k">if</span> <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;threshold_type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;low&#39;</span><span class="p">:</span>
                        <span class="n">op</span> <span class="o">=</span> <span class="s1">&#39;&gt;=&#39;</span>
                    <span class="k">elif</span> <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;threshold_type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;high&#39;</span><span class="p">:</span>
                        <span class="n">op</span> <span class="o">=</span> <span class="s1">&#39;&lt;=&#39;</span>
                    <span class="k">elif</span> <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;threshold_type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;bool&#39;</span><span class="p">:</span>
                        <span class="n">op</span> <span class="o">=</span> <span class="s1">&#39;=&#39;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">op</span> <span class="o">=</span> <span class="s1">&#39;?&#39;</span>
                    <span class="n">rec</span><span class="p">[</span><span class="s1">&#39;criterion_operation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">op</span>
                    <span class="n">value_key</span> <span class="o">=</span> <span class="s1">&#39;criterion_value&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">value_key</span> <span class="o">=</span> <span class="n">crit</span>

        <span class="c1"># fix True/False typoes</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s2">&quot;value&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s2">&quot;value&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;TRUE&quot;</span><span class="p">:</span>
                        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s2">&quot;value&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;True&quot;</span>
                    <span class="k">if</span> <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s2">&quot;value&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;FALSE&quot;</span><span class="p">:</span>
                        <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s2">&quot;value&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;False&quot;</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s2">&quot;value&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s2">&quot;value&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;-999&quot;</span> <span class="ow">and</span> <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                        <span class="n">rec</span><span class="p">[</span><span class="n">value_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
                <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s2">&quot;value&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="nb">int</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s2">&quot;value&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">999</span><span class="p">:</span>
                        <span class="n">rec</span><span class="p">[</span><span class="n">value_key</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;%.i&quot;</span> <span class="o">%</span> <span class="p">(</span>
                            <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s2">&quot;value&quot;</span><span class="p">])</span>
                    <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s2">&quot;value&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="nb">float</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s2">&quot;value&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="o">-</span><span class="mi">999</span><span class="p">:</span>
                            <span class="k">continue</span>
                <span class="k">if</span> <span class="s1">&#39;decimal_points&#39;</span> <span class="ow">in</span> <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">]</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                    <span class="n">decimal_points</span> <span class="o">=</span> <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;decimal_points&#39;</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">decimal_points</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">999</span><span class="p">:</span>
                        <span class="n">val</span> <span class="o">=</span> <span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
                        <span class="n">rec</span><span class="p">[</span><span class="n">value_key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">decimal_points</span><span class="p">)))</span>
                        <span class="c1"># command=&quot;rec[value_key]=&#39;%%.%sf&#39;%%(acceptance_criteria[crit][&#39;value&#39;])&quot;%(decimal_points)</span>
                        <span class="c1"># exec command</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">rec</span><span class="p">[</span><span class="n">value_key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s2">&quot;value&quot;</span><span class="p">])</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s2">&quot;value&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="nb">bool</span><span class="p">:</span>
                    <span class="n">rec</span><span class="p">[</span><span class="n">value_key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">acceptance_criteria</span><span class="p">[</span><span class="n">crit</span><span class="p">][</span><span class="s2">&quot;value&quot;</span><span class="p">])</span>
                <span class="c1"># need to make a list of these dictionaries</span>
                <span class="k">if</span> <span class="s1">&#39;data_model&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;data_model&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">eval</span><span class="p">(</span><span class="n">rec</span><span class="p">[</span><span class="n">value_key</span><span class="p">])</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">999</span><span class="p">:</span>
                        <span class="n">recs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-W- WARNING: statistic </span><span class="si">{}</span><span class="s2"> not written to file&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">crit</span><span class="p">))</span>
    <span class="c1"># need to make a list of these dictionaries</span>
    <span class="k">if</span> <span class="s1">&#39;data_model&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;data_model&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;prior_crits&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="n">prior_crits</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;prior_crits&#39;</span><span class="p">]</span>
            <span class="n">included</span> <span class="o">=</span> <span class="p">{</span><span class="n">rec</span><span class="p">[</span><span class="s1">&#39;table_column&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">recs</span><span class="p">}</span>
            <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">prior_crits</span><span class="p">:</span>
                <span class="k">if</span> <span class="s1">&#39;criterion&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="s1">&#39;IE-&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">rec</span><span class="p">[</span><span class="s1">&#39;criterion&#39;</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="n">rec</span><span class="p">[</span><span class="s1">&#39;criterion&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;ACCEPT&#39;</span> <span class="ow">and</span> <span class="n">rec</span><span class="p">[</span><span class="s1">&#39;table_column&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">included</span><span class="p">:</span>
                        <span class="c1"># ignore intensity criteria converted from ACCEPT to</span>
                        <span class="c1"># IE-*</span>
                        <span class="k">pass</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="c1"># preserve non-intensity related criteria</span>
                        <span class="n">recs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rec</span><span class="p">)</span>
        <span class="n">magic_write</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">recs</span><span class="p">,</span> <span class="s1">&#39;criteria&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">magic_write</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="p">[</span><span class="n">rec</span><span class="p">],</span> <span class="s1">&#39;pmag_criteria&#39;</span><span class="p">)</span>


<span class="c1"># Helpers for command-line programs</span>

<div class="viewcode-block" id="add_flag"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.add_flag">[docs]</a><span class="k">def</span> <span class="nf">add_flag</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">flag</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    For use when calling command-line scripts from within a program.</span>
<span class="sd">    if a variable is present, add its proper command_line flag.</span>
<span class="sd">    return a string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">var</span><span class="p">:</span>
        <span class="n">var</span> <span class="o">=</span> <span class="n">flag</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">var</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">return</span> <span class="n">var</span></div>


<div class="viewcode-block" id="get_named_arg"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.get_named_arg">[docs]</a><span class="k">def</span> <span class="nf">get_named_arg</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">default_val</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">reqd</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extract the value after a command-line flag such as &#39;-f&#39; and return it.</span>
<span class="sd">    If the command-line flag is missing, return default_val.</span>
<span class="sd">    If reqd == True and the command-line flag is missing, throw an error.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    name : str</span>
<span class="sd">        command line flag, e.g. &quot;-f&quot;</span>
<span class="sd">    default_val</span>
<span class="sd">        value to use if command line flag is missing, e.g. &quot;measurements.txt&quot;</span>
<span class="sd">        default is None</span>
<span class="sd">    reqd : bool</span>
<span class="sd">        throw error if reqd==True and command line flag is missing.</span>
<span class="sd">        if reqd == True, default_val will be ignored.</span>
<span class="sd">        default is False.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Desired value from sys.argv if available, otherwise default_val.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">:</span>  <span class="c1"># if the command line flag is found in sys.argv</span>
        <span class="n">ind</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">reqd</span><span class="p">:</span>  <span class="c1"># if arg is required but not present</span>
        <span class="k">raise</span> <span class="n">MissingCommandLineArgException</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">default_val</span>  <span class="c1"># if arg is not provided but has a default value, return that value</span></div>


<span class="k">def</span> <span class="nf">get_flag_arg_from_sys</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">true</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">false</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">true</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">false</span>


<span class="c1"># Miscellaneous helpers</span>

<div class="viewcode-block" id="merge_recs_headers"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.merge_recs_headers">[docs]</a><span class="k">def</span> <span class="nf">merge_recs_headers</span><span class="p">(</span><span class="n">recs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Take a list of recs [rec1,rec2,rec3....], each rec is a dictionary.</span>
<span class="sd">    make sure that all recs have the same headers.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">recs</span><span class="p">:</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">headers</span><span class="p">:</span>
                <span class="n">headers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">recs</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">header</span> <span class="ow">in</span> <span class="n">headers</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">header</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                <span class="n">rec</span><span class="p">[</span><span class="n">header</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">return</span> <span class="n">recs</span></div>


<div class="viewcode-block" id="resolve_file_name"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.resolve_file_name">[docs]</a><span class="k">def</span> <span class="nf">resolve_file_name</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">dir_path</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parse file name information and output full path.</span>
<span class="sd">    Allows input as:</span>
<span class="sd">    fname == /path/to/file.txt</span>
<span class="sd">    or</span>
<span class="sd">    fname == file.txt, dir_path == /path/to</span>
<span class="sd">    Either way, returns /path/to/file.txt.</span>
<span class="sd">    Used in conversion scripts.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    fname : str</span>
<span class="sd">        short filename or full path to file</span>
<span class="sd">    dir_path : str</span>
<span class="sd">        directory, optional</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    full_file : str</span>
<span class="sd">        full path/to/file.txt</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">fname</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
    <span class="n">file_dir_path</span><span class="p">,</span> <span class="n">file_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">file_dir_path</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">file_dir_path</span> <span class="o">==</span> <span class="s1">&#39;.&#39;</span><span class="p">):</span>
        <span class="n">full_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="n">fname</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">full_file</span> <span class="o">=</span> <span class="n">fname</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="n">full_file</span><span class="p">)</span></div>


<span class="k">def</span> <span class="nf">remove_files</span><span class="p">(</span><span class="n">file_list</span><span class="p">,</span> <span class="n">WD</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">file_list</span><span class="p">:</span>
        <span class="n">full_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">WD</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">full_file</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">full_file</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">get_attr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">attr</span><span class="o">=</span><span class="s1">&#39;name&#39;</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="n">name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">name</span>


<div class="viewcode-block" id="adjust_val_to_360"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.adjust_val_to_360">[docs]</a><span class="k">def</span> <span class="nf">adjust_val_to_360</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Take in a single numeric (or null) argument.</span>
<span class="sd">    Return argument adjusted to be between</span>
<span class="sd">    0 and 360 degrees.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">val</span> <span class="ow">and</span> <span class="p">(</span><span class="n">val</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">val</span></div>


<div class="viewcode-block" id="adjust_to_360"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.adjust_to_360">[docs]</a><span class="k">def</span> <span class="nf">adjust_to_360</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Take in a value and a key.  If the key is of the type:</span>
<span class="sd">    declination/longitude/azimuth/direction, adjust it to be within</span>
<span class="sd">    the range 0-360 as required by the MagIC data model</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">CheckDec</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;_dec&#39;</span><span class="p">,</span> <span class="s1">&#39;_lon&#39;</span><span class="p">,</span> <span class="s1">&#39;_azimuth&#39;</span><span class="p">,</span> <span class="s1">&#39;dip_direction&#39;</span><span class="p">]</span>
    <span class="n">adjust</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">dec_key</span> <span class="ow">in</span> <span class="n">CheckDec</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">dec_key</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">dec_key</span><span class="p">)</span> <span class="ow">or</span> <span class="n">key</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">):</span>
                <span class="n">adjust</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">val</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="n">adjust</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">val</span>
    <span class="k">elif</span> <span class="n">adjust</span><span class="p">:</span>
        <span class="n">new_val</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span>
        <span class="k">if</span> <span class="n">new_val</span> <span class="o">!=</span> <span class="nb">float</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-I- adjusted </span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> to 0=&gt;360.: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">new_val</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">new_val</span></div>


<div class="viewcode-block" id="adjust_all_to_360"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.adjust_all_to_360">[docs]</a><span class="k">def</span> <span class="nf">adjust_all_to_360</span><span class="p">(</span><span class="n">dictionary</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Take a dictionary and check each key/value pair.</span>
<span class="sd">    If this key is of type: declination/longitude/azimuth/direction,</span>
<span class="sd">    adjust it to be within 0-360 as required by the MagIC data model</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">dictionary</span><span class="p">:</span>
        <span class="n">dictionary</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">adjust_to_360</span><span class="p">(</span><span class="n">dictionary</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">key</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dictionary</span></div>


<div class="viewcode-block" id="get_test_WD"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.get_test_WD">[docs]</a><span class="k">def</span> <span class="nf">get_test_WD</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Find proper working directory to run tests.</span>
<span class="sd">    With developer install, tests should be run from PmagPy directory.</span>
<span class="sd">    Otherwise, assume pip install, and run tests from sys.prefix,</span>
<span class="sd">    where data_files are installed by setuptools.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">WD</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
    <span class="k">if</span> <span class="s1">&#39;PmagPy&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">WD</span><span class="p">:</span>
        <span class="n">WD</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">prefix</span>
    <span class="k">return</span> <span class="n">WD</span></div>


<div class="viewcode-block" id="MissingCommandLineArgException"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.MissingCommandLineArgException">[docs]</a><span class="k">class</span> <span class="nc">MissingCommandLineArgException</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> is a required option! Please provide this information and try again&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">message</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">message</span></div>


<div class="viewcode-block" id="do_mag_map"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.do_mag_map">[docs]</a><span class="k">def</span> <span class="nf">do_mag_map</span><span class="p">(</span><span class="n">date</span><span class="p">,</span> <span class="n">lon_0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">alt</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">mod</span><span class="o">=</span><span class="s2">&quot;cals10k&quot;</span><span class="p">,</span><span class="n">resolution</span><span class="o">=</span><span class="s1">&#39;low&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns lists of declination, inclination and intensities for lat/lon grid for</span>
<span class="sd">    desired model and date.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    date = Required date in decimal years (Common Era, negative for Before Common Era) - NB: only dates prior to 2025 supported</span>

<span class="sd">    Optional Parameters</span>
<span class="sd">    -------------------</span>
<span class="sd">    mod  = model to use (&#39;arch3k&#39;,&#39;cals3k&#39;,&#39;pfm9k&#39;,&#39;hfm10k&#39;,&#39;cals10k.2&#39;,&#39;shadif14k&#39;,&#39;cals10k.1b&#39;,&#39;custom&#39;)</span>
<span class="sd">    file = l m g h formatted filefor custom model</span>
<span class="sd">    lon_0 : central longitude for Hammer projection</span>
<span class="sd">    alt  = altitude</span>
<span class="sd">    resolution = [&#39;low&#39;,&#39;high&#39;] default is low</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Bdec=list of declinations</span>
<span class="sd">    Binc=list of inclinations</span>
<span class="sd">    B = list of total field intensities in nT</span>
<span class="sd">    Br = list of radial field intensities</span>
<span class="sd">    lons = list of longitudes evaluated</span>
<span class="sd">    lats = list of latitudes evaluated</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">date</span><span class="o">&gt;=</span><span class="mi">2025</span><span class="p">:</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;only dates prior to 2020 supported&#39;</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="k">if</span> <span class="n">resolution</span><span class="o">==</span><span class="s1">&#39;low&#39;</span><span class="p">:</span>
        <span class="n">incr</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># we can vary to the resolution of the model</span>
    <span class="k">elif</span> <span class="n">resolution</span><span class="o">==</span><span class="s1">&#39;high&#39;</span><span class="p">:</span>
        <span class="n">incr</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1"># we can vary to the resolution of the model</span>
    <span class="k">if</span> <span class="n">lon_0</span> <span class="o">==</span> <span class="mi">180</span><span class="p">:</span>
        <span class="n">lon_0</span> <span class="o">=</span> <span class="mf">179.99</span>
    <span class="k">if</span> <span class="n">lon_0</span> <span class="o">&gt;</span> <span class="mi">180</span><span class="p">:</span>
        <span class="n">lon_0</span> <span class="o">=</span> <span class="n">lon_0</span><span class="o">-</span><span class="mf">360.</span>
    <span class="c1"># get some parameters for our arrays of lat/lon</span>
    <span class="n">lonmax</span> <span class="o">=</span> <span class="p">(</span><span class="n">lon_0</span> <span class="o">+</span> <span class="mf">180.</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span> <span class="o">+</span> <span class="n">incr</span>
    <span class="n">lonmin</span> <span class="o">=</span> <span class="p">(</span><span class="n">lon_0</span> <span class="o">-</span> <span class="mf">180.</span><span class="p">)</span>
    <span class="n">latmax</span> <span class="o">=</span> <span class="mi">90</span> <span class="o">+</span> <span class="n">incr</span>
    <span class="c1"># make a 1D array of longitudes (like elons)</span>
    <span class="n">lons</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">lonmin</span><span class="p">,</span> <span class="n">lonmax</span><span class="p">,</span> <span class="n">incr</span><span class="p">)</span>
    <span class="c1"># make a 1D array of longitudes (like elats)</span>
    <span class="n">lats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="n">latmax</span><span class="p">,</span> <span class="n">incr</span><span class="p">)</span>
    <span class="c1"># set up some containers for the field elements</span>
    <span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">lats</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">lons</span><span class="p">)))</span>
    <span class="n">Binc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">lats</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">lons</span><span class="p">)))</span>
    <span class="n">Bdec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">lats</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">lons</span><span class="p">)))</span>
    <span class="n">Brad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">lats</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">lons</span><span class="p">)))</span>
    <span class="k">if</span> <span class="n">mod</span> <span class="o">==</span> <span class="s1">&#39;custom&#39;</span> <span class="ow">and</span> <span class="n">file</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
        <span class="n">gh</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">lmgh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">file</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
        <span class="n">gh</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lmgh</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">lmgh</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
            <span class="n">gh</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lmgh</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">lmgh</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">gh</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lmgh</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">gh</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">120</span><span class="p">:</span><span class="n">gh</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lats</span><span class="p">)):</span>  <span class="c1"># step through the latitudes</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lons</span><span class="p">)):</span>  <span class="c1"># and the longitudes</span>
            <span class="c1"># get the field elements</span>
            <span class="k">if</span> <span class="n">mod</span> <span class="o">==</span> <span class="s1">&#39;custom&#39;</span><span class="p">:</span>
                <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">f</span> <span class="o">=</span> <span class="n">docustom</span><span class="p">(</span><span class="n">lons</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">lats</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">alt</span><span class="p">,</span> <span class="n">gh</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">f</span> <span class="o">=</span> <span class="n">doigrf</span><span class="p">(</span>
                    <span class="n">lons</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">lats</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">alt</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">mod</span><span class="o">=</span><span class="n">mod</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">file</span><span class="p">)</span>
            <span class="c1"># turn them into polar coordinates</span>
            <span class="n">Dec</span><span class="p">,</span> <span class="n">Inc</span><span class="p">,</span> <span class="n">Int</span> <span class="o">=</span> <span class="n">cart2dir</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">mod</span> <span class="o">!=</span> <span class="s1">&#39;custom&#39;</span><span class="p">:</span>
                <span class="c1"># convert the string to microtesla (from nT)</span>
                <span class="n">B</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">Int</span> <span class="o">*</span> <span class="mf">1e-3</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">B</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">Int</span>  <span class="c1"># convert the string to microtesla (from nT)</span>
            <span class="n">Binc</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">Inc</span>  <span class="c1"># store the inclination value</span>
            <span class="k">if</span> <span class="n">Dec</span> <span class="o">&gt;</span> <span class="mi">180</span><span class="p">:</span>
                <span class="n">Dec</span> <span class="o">=</span> <span class="n">Dec</span><span class="o">-</span><span class="mf">360.</span>
            <span class="n">Bdec</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">Dec</span>  <span class="c1"># store the declination value</span>
            <span class="k">if</span> <span class="n">mod</span> <span class="o">!=</span> <span class="s1">&#39;custom&#39;</span><span class="p">:</span>
                <span class="n">Brad</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">z</span><span class="o">*</span><span class="mf">1e-3</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">Brad</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">z</span>
    <span class="k">return</span> <span class="n">Bdec</span><span class="p">,</span> <span class="n">Binc</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">Brad</span><span class="p">,</span> <span class="n">lons</span><span class="p">,</span> <span class="n">lats</span>  <span class="c1"># return the arrays.</span></div>


<div class="viewcode-block" id="doeqdi"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.doeqdi">[docs]</a><span class="k">def</span> <span class="nf">doeqdi</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">UP</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Takes digitized x,y, data and returns the dec,inc, assuming an</span>
<span class="sd">    equal area projection.</span>
<span class="sd">   </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : array of digitized x from point on equal area projection</span>
<span class="sd">    y : array of  igitized y from point on equal area projection</span>
<span class="sd">    UP : if True, is an upper hemisphere projection</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dec : declination</span>
<span class="sd">    inc : inclination</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">xp</span><span class="p">,</span> <span class="n">yp</span> <span class="o">=</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span>  <span class="c1"># need to switch into geographic convention</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">xp</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">yp</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">z</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">-</span><span class="n">r</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">UP</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">t</span> <span class="o">=</span> <span class="o">-</span><span class="n">t</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">yp</span><span class="p">,</span> <span class="n">xp</span><span class="p">)</span>
    <span class="n">dec</span><span class="p">,</span> <span class="n">inc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dec</span><span class="p">,</span> <span class="n">inc</span></div>


<div class="viewcode-block" id="separate_directions"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.separate_directions">[docs]</a><span class="k">def</span> <span class="nf">separate_directions</span><span class="p">(</span><span class="n">di_block</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Separates set of directions into two modes based on principal direction</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    di_block : block of nested dec,inc pairs</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    mode_1_block,mode_2_block :  two arrays of nested dec,inc pairs</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ppars</span> <span class="o">=</span> <span class="n">doprinc</span><span class="p">(</span><span class="n">di_block</span><span class="p">)</span>
    <span class="n">di_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">di_block</span><span class="p">)</span>  <span class="c1"># turn into a data frame for easy filtering</span>
    <span class="n">di_df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">,</span> <span class="s1">&#39;inc&#39;</span><span class="p">]</span>
    <span class="n">di_df</span><span class="p">[</span><span class="s1">&#39;pdec&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ppars</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">]</span>
    <span class="n">di_df</span><span class="p">[</span><span class="s1">&#39;pinc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ppars</span><span class="p">[</span><span class="s1">&#39;inc&#39;</span><span class="p">]</span>
    <span class="n">di_df</span><span class="p">[</span><span class="s1">&#39;angle&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">angle</span><span class="p">(</span><span class="n">di_df</span><span class="p">[[</span><span class="s1">&#39;dec&#39;</span><span class="p">,</span> <span class="s1">&#39;inc&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                           <span class="n">di_df</span><span class="p">[[</span><span class="s1">&#39;pdec&#39;</span><span class="p">,</span> <span class="s1">&#39;pinc&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
    <span class="n">mode1_df</span> <span class="o">=</span> <span class="n">di_df</span><span class="p">[</span><span class="n">di_df</span><span class="p">[</span><span class="s1">&#39;angle&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">90</span><span class="p">]</span>
    <span class="n">mode2_df</span> <span class="o">=</span> <span class="n">di_df</span><span class="p">[</span><span class="n">di_df</span><span class="p">[</span><span class="s1">&#39;angle&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">90</span><span class="p">]</span>
    <span class="n">mode1</span> <span class="o">=</span> <span class="n">mode1_df</span><span class="p">[[</span><span class="s1">&#39;dec&#39;</span><span class="p">,</span> <span class="s1">&#39;inc&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="n">mode2</span> <span class="o">=</span> <span class="n">mode2_df</span><span class="p">[[</span><span class="s1">&#39;dec&#39;</span><span class="p">,</span> <span class="s1">&#39;inc&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">mode1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">mode2</span><span class="p">)</span></div>


<div class="viewcode-block" id="dovandamme"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.dovandamme">[docs]</a><span class="k">def</span> <span class="nf">dovandamme</span><span class="p">(</span><span class="n">vgp_df</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Determine the S_b value for VGPs using the Vandamme (1994) method</span>
<span class="sd">    for determining cutoff value for &quot;outliers&quot;.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    vgp_df : pandas DataFrame with required column &quot;vgp_lat&quot;</span>
<span class="sd">             This should be in the desired coordinate system and assumes one polarity</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    vgp_df : after applying cutoff</span>
<span class="sd">    cutoff : colatitude cutoff</span>
<span class="sd">    S_b : S_b of vgp_df  after applying cutoff</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">vgp_df</span><span class="p">[</span><span class="s1">&#39;delta&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">90.</span><span class="o">-</span><span class="n">vgp_df</span><span class="p">[</span><span class="s1">&#39;vgp_lat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
    <span class="n">ASD</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">vgp_df</span><span class="o">.</span><span class="n">delta</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">vgp_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">A</span> <span class="o">=</span> <span class="mf">1.8</span> <span class="o">*</span> <span class="n">ASD</span> <span class="o">+</span> <span class="mf">5.</span>
    <span class="n">delta_max</span> <span class="o">=</span> <span class="n">vgp_df</span><span class="o">.</span><span class="n">delta</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">delta_max</span><span class="o">&lt;</span><span class="n">A</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">vgp_df</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">ASD</span>
    <span class="k">while</span> <span class="n">delta_max</span> <span class="o">&gt;</span> <span class="n">A</span><span class="p">:</span>
        <span class="n">delta_max</span> <span class="o">=</span> <span class="n">vgp_df</span><span class="o">.</span><span class="n">delta</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">delta_max</span> <span class="o">&lt;</span> <span class="n">A</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">vgp_df</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">ASD</span>
        <span class="n">vgp_df</span> <span class="o">=</span> <span class="n">vgp_df</span><span class="p">[</span><span class="n">vgp_df</span><span class="o">.</span><span class="n">delta</span> <span class="o">&lt;</span> <span class="n">delta_max</span><span class="p">]</span>
        <span class="n">ASD</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">vgp_df</span><span class="o">.</span><span class="n">delta</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">vgp_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">A</span> <span class="o">=</span> <span class="mf">1.8</span> <span class="o">*</span> <span class="n">ASD</span> <span class="o">+</span> <span class="mf">5.</span></div>


<div class="viewcode-block" id="scalc_vgp_df"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.scalc_vgp_df">[docs]</a><span class="k">def</span> <span class="nf">scalc_vgp_df</span><span class="p">(</span><span class="n">vgp_df</span><span class="p">,</span> <span class="n">anti</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">rev</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="mf">180.</span><span class="p">,</span> <span class="n">kappa</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">spin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">boot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">mm97</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">nb</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates Sf for a dataframe with VGP Lat., and optional Fisher&#39;s k,</span>
<span class="sd">    site latitude and N information can be used to correct for within site</span>
<span class="sd">    scatter (McElhinny &amp; McFadden, 1997)</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    vgp_df : Pandas Dataframe with columns</span>
<span class="sd">        REQUIRED:</span>
<span class="sd">        vgp_lat :  VGP latitude</span>
<span class="sd">        ONLY REQUIRED for MM97 correction:</span>
<span class="sd">        dir_k : Fisher kappa estimate</span>
<span class="sd">        dir_n_samples : number of samples per site</span>
<span class="sd">        lat : latitude of the site</span>
<span class="sd">        mm97 : if True, will do the correction for within site scatter</span>
<span class="sd">        OPTIONAL:</span>
<span class="sd">        boot : if True. do bootstrap</span>
<span class="sd">        nb : number of bootstraps, default is 1000</span>
<span class="sd">    anti : Boolean</span>
<span class="sd">        if True, take antipodes of reverse poles</span>
<span class="sd">    spin : Boolean</span>
<span class="sd">        if True, transform data to spin axis</span>
<span class="sd">    rev : Boolean</span>
<span class="sd">        if True, take only reverse poles</span>
<span class="sd">    v : Boolean</span>
<span class="sd">        if True, filter data with Vandamme (1994) cutoff</span>
<span class="sd">    boot : Boolean</span>
<span class="sd">        if True, use bootstrap for confidence 95% interval</span>
<span class="sd">    mm97 : Boolean</span>
<span class="sd">        if True, use McFadden McElhinny 1997 correction for S</span>
<span class="sd">    nb : int</span>
<span class="sd">        number of bootstrapped pseudosamples for confidence estimate</span>
<span class="sd">    verbose : Boolean</span>
<span class="sd">        if True, print messages</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    N : number of VGPs used in calculation</span>
<span class="sd">    S_B : S value</span>
<span class="sd">    low : 95% confidence lower bound [0 if boot=0]</span>
<span class="sd">    high : 95% confidence upper bound [0 if boot=0]</span>
<span class="sd">    cutoff : cutoff used in calculation of  S</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">vgp_df</span><span class="p">[</span><span class="s1">&#39;delta&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">90.</span><span class="o">-</span><span class="n">vgp_df</span><span class="o">.</span><span class="n">vgp_lat</span><span class="o">.</span><span class="n">values</span>
    <span class="c1"># filter by cutoff, kappa, and n if desired</span>
    <span class="k">if</span> <span class="n">v</span><span class="p">:</span> <span class="n">vgp_df</span> <span class="o">=</span> <span class="n">vgp_df</span><span class="p">[</span><span class="n">vgp_df</span><span class="o">.</span><span class="n">delta</span> <span class="o">&lt;=</span> <span class="n">cutoff</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">mm97</span><span class="p">:</span><span class="n">vgp_df</span> <span class="o">=</span> <span class="n">vgp_df</span><span class="p">[</span><span class="n">vgp_df</span><span class="o">.</span><span class="n">dir_k</span> <span class="o">&gt;=</span> <span class="n">kappa</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">n</span><span class="p">:</span> <span class="n">vgp_df</span> <span class="o">=</span> <span class="n">vgp_df</span><span class="p">[</span><span class="n">vgp_df</span><span class="o">.</span><span class="n">dir_n_samples</span> <span class="o">&gt;=</span> <span class="n">n</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">spin</span><span class="p">:</span>  <span class="c1"># do transformation to pole</span>
        <span class="n">Pvgps</span> <span class="o">=</span> <span class="n">vgp_df</span><span class="p">[[</span><span class="s1">&#39;vgp_lon&#39;</span><span class="p">,</span> <span class="s1">&#39;vgp_lat&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">ppars</span> <span class="o">=</span> <span class="n">doprinc</span><span class="p">(</span><span class="n">Pvgps</span><span class="p">)</span>
        <span class="n">Bdirs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">Pvgps</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">ppars</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">]</span><span class="o">-</span><span class="mf">180.</span><span class="p">)</span>
        <span class="n">Bdips</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">Pvgps</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="mf">90.</span><span class="o">-</span><span class="n">ppars</span><span class="p">[</span><span class="s1">&#39;inc&#39;</span><span class="p">])</span>
        <span class="n">Pvgps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">Pvgps</span><span class="p">,</span> <span class="n">Bdirs</span><span class="p">,</span> <span class="n">Bdips</span><span class="p">))</span>
        <span class="n">lons</span><span class="p">,</span> <span class="n">lats</span> <span class="o">=</span> <span class="n">dotilt_V</span><span class="p">(</span><span class="n">Pvgps</span><span class="p">)</span>
        <span class="n">vgp_df</span><span class="p">[</span><span class="s1">&#39;vgp_lon&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lons</span>
        <span class="n">vgp_df</span><span class="p">[</span><span class="s1">&#39;vgp_lat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lats</span>
        <span class="n">vgp_df</span><span class="p">[</span><span class="s1">&#39;delta&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">90.</span><span class="o">-</span><span class="n">vgp_df</span><span class="o">.</span><span class="n">vgp_lat</span>
    <span class="k">if</span> <span class="n">anti</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;flipping reverse&#39;</span><span class="p">)</span>
        <span class="n">vgp_rev</span> <span class="o">=</span> <span class="n">vgp_df</span><span class="p">[</span><span class="n">vgp_df</span><span class="o">.</span><span class="n">vgp_lat</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">vgp_norm</span> <span class="o">=</span> <span class="n">vgp_df</span><span class="p">[</span><span class="n">vgp_df</span><span class="o">.</span><span class="n">vgp_lat</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">vgp_anti</span> <span class="o">=</span> <span class="n">vgp_rev</span>
        <span class="n">vgp_anti</span><span class="p">[</span><span class="s1">&#39;vgp_lat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">vgp_anti</span><span class="p">[</span><span class="s1">&#39;vgp_lat&#39;</span><span class="p">]</span>
        <span class="n">vgp_anti</span><span class="p">[</span><span class="s1">&#39;vgp_lon&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">vgp_anti</span><span class="p">[</span><span class="s1">&#39;vgp_lon&#39;</span><span class="p">]</span><span class="o">-</span><span class="mi">180</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span>
        <span class="n">vgp_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">vgp_norm</span><span class="p">,</span> <span class="n">vgp_anti</span><span class="p">],</span> <span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">rev</span><span class="p">:</span>
        <span class="n">vgp_df</span> <span class="o">=</span> <span class="n">vgp_df</span><span class="p">[</span><span class="n">vgp_df</span><span class="o">.</span><span class="n">vgp_lat</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span>  <span class="c1"># use only reverse data</span>
    <span class="k">if</span> <span class="n">v</span><span class="p">:</span>
        <span class="n">vgp_df</span><span class="p">,</span> <span class="n">cutoff</span><span class="p">,</span> <span class="n">S_v</span> <span class="o">=</span> <span class="n">dovandamme</span><span class="p">(</span><span class="n">vgp_df</span><span class="p">)</span>  <span class="c1"># do vandamme cutoff</span>
    <span class="n">S_B</span> <span class="o">=</span> <span class="n">get_sb_df</span><span class="p">(</span><span class="n">vgp_df</span><span class="p">,</span> <span class="n">mm97</span><span class="o">=</span><span class="n">mm97</span><span class="p">)</span>  <span class="c1"># get</span>
    <span class="n">N</span> <span class="o">=</span> <span class="n">vgp_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">SBs</span><span class="p">,</span> <span class="n">low</span><span class="p">,</span> <span class="n">high</span> <span class="o">=</span> <span class="p">[],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">boot</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nb</span><span class="p">):</span>  <span class="c1"># now do bootstrap</span>
            <span class="n">bs_df</span> <span class="o">=</span> <span class="n">vgp_df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">Sb_bs</span> <span class="o">=</span> <span class="n">get_sb_df</span><span class="p">(</span><span class="n">bs_df</span><span class="p">)</span>
            <span class="n">SBs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Sb_bs</span><span class="p">)</span>
        <span class="n">SBs</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">low</span> <span class="o">=</span> <span class="n">SBs</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="mf">.025</span> <span class="o">*</span> <span class="n">nb</span><span class="p">)]</span>
        <span class="n">high</span> <span class="o">=</span> <span class="n">SBs</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="mf">.975</span> <span class="o">*</span> <span class="n">nb</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">N</span><span class="p">,</span> <span class="n">S_B</span><span class="p">,</span> <span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="p">,</span> <span class="n">cutoff</span></div>


<div class="viewcode-block" id="watsons_f"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.watsons_f">[docs]</a><span class="k">def</span> <span class="nf">watsons_f</span><span class="p">(</span><span class="n">DI1</span><span class="p">,</span> <span class="n">DI2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates Watson&#39;s F statistic (equation 11.16 in Essentials text book).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    DI1 : nested array of [Dec,Inc] pairs</span>
<span class="sd">    DI2 : nested array of [Dec,Inc] pairs</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    F : Watson&#39;s F</span>
<span class="sd">    Fcrit : critical value from F table</span>
<span class="sd">    </span>
<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; D1= [[-45,150],[-40,150],[-38,145]]</span>
<span class="sd">    &gt;&gt;&gt; D2= [[-43,140],[-39,130],[-38,145]]</span>
<span class="sd">    &gt;&gt;&gt; pmag.watsons_f(D1,D2)</span>
<span class="sd">    (3.7453156915587567, 4.459)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># first calculate R for the combined data set, then R1 and R2 for each individually.</span>
    <span class="c1"># create a new array from two smaller ones</span>
    <span class="n">DI</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">DI1</span><span class="p">,</span> <span class="n">DI2</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">fpars</span> <span class="o">=</span> <span class="n">fisher_mean</span><span class="p">(</span><span class="n">DI</span><span class="p">)</span>  <span class="c1"># re-use our functionfrom problem 1b</span>
    <span class="n">fpars1</span> <span class="o">=</span> <span class="n">fisher_mean</span><span class="p">(</span><span class="n">DI1</span><span class="p">)</span>
    <span class="n">fpars2</span> <span class="o">=</span> <span class="n">fisher_mean</span><span class="p">(</span><span class="n">DI2</span><span class="p">)</span>
    <span class="n">N</span> <span class="o">=</span> <span class="n">fpars</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span>
    <span class="n">R</span> <span class="o">=</span> <span class="n">fpars</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">]</span>
    <span class="n">R1</span> <span class="o">=</span> <span class="n">fpars1</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">]</span>
    <span class="n">R2</span> <span class="o">=</span> <span class="n">fpars2</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">]</span>
    <span class="n">F</span> <span class="o">=</span> <span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mf">2.</span><span class="p">)</span><span class="o">*</span><span class="p">((</span><span class="n">R1</span><span class="o">+</span><span class="n">R2</span><span class="o">-</span><span class="n">R</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="n">R1</span><span class="o">-</span><span class="n">R2</span><span class="p">))</span>
    <span class="n">Fcrit</span> <span class="o">=</span> <span class="n">fcalc</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">2</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">F</span><span class="p">,</span> <span class="n">Fcrit</span></div>


<div class="viewcode-block" id="apwp"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.apwp">[docs]</a><span class="k">def</span> <span class="nf">apwp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">print_results</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates expected pole positions and directions for given plate, location and age.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : [plate,lat,lon,age]</span>
<span class="sd">        plate : [NA, SA, AF, IN, EU, AU, ANT, GL]</span>
<span class="sd">            NA : North America</span>
<span class="sd">            SA : South America</span>
<span class="sd">            AF : Africa</span>
<span class="sd">            IN : India</span>
<span class="sd">            EU : Eurasia</span>
<span class="sd">            AU : Australia</span>
<span class="sd">            ANT: Antarctica</span>
<span class="sd">            GL : Greenland</span>
<span class="sd">            lat/lon : latitude/longitude in degrees N/E</span>
<span class="sd">            age : age in millions of years</span>
<span class="sd">    print_results : if True will print out nicely formatted results</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    if print_results is False, [Age,Paleolat, Dec, Inc, Pole_lat, Pole_lon]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pole_lat</span><span class="p">,</span> <span class="n">pole_lon</span> <span class="o">=</span> <span class="n">bc02</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>  <span class="c1"># get the pole for these parameters</span>
    <span class="c1"># get the declination and inclination for that pole</span>
    <span class="n">ExpDec</span><span class="p">,</span> <span class="n">ExpInc</span> <span class="o">=</span> <span class="n">vgp_di</span><span class="p">(</span><span class="n">pole_lat</span><span class="p">,</span> <span class="n">pole_lon</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="c1"># convert the inclination to paleo latitude</span>
    <span class="n">paleo_lat</span> <span class="o">=</span> <span class="n">magnetic_lat</span><span class="p">(</span><span class="n">ExpInc</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">print_results</span><span class="p">:</span>
        <span class="c1"># print everything out</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; Age   Paleolat.   Dec.   Inc.   Pole_lat.  Pole_Long.&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%7.1f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1">  </span><span class="si">%7.1f</span><span class="se">\n</span><span class="s1">&#39;</span>
              <span class="o">%</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">paleo_lat</span><span class="p">,</span> <span class="n">ExpDec</span><span class="p">,</span> <span class="n">ExpInc</span><span class="p">,</span> <span class="n">pole_lat</span><span class="p">,</span> <span class="n">pole_lon</span><span class="p">))</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">paleo_lat</span><span class="p">,</span> <span class="n">ExpDec</span><span class="p">,</span> <span class="n">ExpInc</span><span class="p">,</span> <span class="n">pole_lat</span><span class="p">,</span> <span class="n">pole_lon</span><span class="p">]</span></div>


<div class="viewcode-block" id="chart_maker"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.chart_maker">[docs]</a><span class="k">def</span> <span class="nf">chart_maker</span><span class="p">(</span><span class="n">Int</span><span class="p">,</span> <span class="n">Top</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">outfile</span><span class="o">=</span><span class="s1">&#39;chart.txt&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Makes a chart for performing IZZI experiments. Print out the file and</span>
<span class="sd">    tape it to the oven.  This chart will help keep track of the different</span>
<span class="sd">    steps.</span>
<span class="sd">    Z : performed in zero field - enter the temperature XXX.0 in the sio</span>
<span class="sd">        formatted measurement file created by the LabView program</span>
<span class="sd">    I : performed in the lab field written at the top of the form</span>
<span class="sd">    P : a pTRM step - performed at the temperature and in the lab field.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Int : list of intervals [e.g., 50,10,5]</span>
<span class="sd">    Top : list of upper bounds for each interval [e.g., 500, 550, 600]</span>
<span class="sd">    start : first temperature step, default is 100</span>
<span class="sd">    outfile : name of output file, default is &#39;chart.txt&#39;</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    creates a file with:</span>
<span class="sd">         file:  write down the name of the measurement file</span>
<span class="sd">         field:  write down the lab field for the infield steps (in uT)</span>
<span class="sd">         the type of step (Z: zerofield, I: infield, P: pTRM step</span>
<span class="sd">         temperature of the step and code for SIO-like treatment steps</span>
<span class="sd">             XXX.0   [zero field]</span>
<span class="sd">             XXX.1   [in field]</span>
<span class="sd">             XXX.2   [pTRM check] - done in a lab field</span>
<span class="sd">         date : date the step was performed</span>
<span class="sd">         run # : an optional run number</span>
<span class="sd">         zones I-III : field in the zones in the oven</span>
<span class="sd">         start : time the run was started</span>
<span class="sd">         sp :  time the setpoint was reached</span>
<span class="sd">         cool : time cooling started</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">low</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">iz</span> <span class="o">=</span> <span class="n">start</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
    <span class="n">Tzero</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;chart.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
    <span class="n">vline</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
        <span class="s1">&#39;   |      |        |         |          |       |    |      |&#39;</span><span class="p">)</span>
    <span class="n">hline</span> <span class="o">=</span> <span class="s1">&#39;______________________________________________________________________________</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;file:_________________    field:___________uT</span><span class="se">\n\n\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
        <span class="s1">&#39;               date | run# | zone I | zone II | zone III | start | sp | cool|&#39;</span><span class="p">))</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">hline</span><span class="p">)</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;   0.0&#39;</span><span class="p">))</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">vline</span><span class="p">)</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">hline</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Top</span><span class="p">)):</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">low</span><span class="p">,</span> <span class="n">Top</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">+</span><span class="n">Int</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">Int</span><span class="p">[</span><span class="n">k</span><span class="p">]):</span>
            <span class="k">if</span> <span class="n">iz</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">Tzero</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>  <span class="c1"># zero field first step</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> </span><span class="se">\t</span><span class="s1"> </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">iz</span><span class="p">)))</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">vline</span><span class="p">)</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">hline</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">Tzero</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> </span><span class="se">\t</span><span class="s1"> </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">Tzero</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;.&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">vline</span><span class="p">)</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">hline</span><span class="p">)</span>
                <span class="n">iz</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="c1"># infield after zero field first</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> </span><span class="se">\t</span><span class="s1"> </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">iz</span><span class="p">)))</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">vline</span><span class="p">)</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">hline</span><span class="p">)</span>

<span class="c1">#                f.write(&#39;%s \t %s&#39;%(&#39;T&#39;,str(t)+&#39;.&#39;+str(3))) # print second zero field (tail check)</span>
<span class="c1">#                f.write(vline)</span>
<span class="c1">#                f.write(hline)</span>

            <span class="k">elif</span> <span class="n">iz</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="c1"># infield first step</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> </span><span class="se">\t</span><span class="s1"> </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">iz</span><span class="p">)))</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">vline</span><span class="p">)</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">hline</span><span class="p">)</span>
                <span class="n">iz</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="c1"># zero field step (after infield)</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> </span><span class="se">\t</span><span class="s1"> </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">iz</span><span class="p">)))</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">vline</span><span class="p">)</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">hline</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">low</span> <span class="o">=</span> <span class="n">Top</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">+</span><span class="n">Int</span><span class="p">[</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># increment to next temp step</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;output stored in: chart.txt&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="import_basemap"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.import_basemap">[docs]</a><span class="k">def</span> <span class="nf">import_basemap</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Try to import Basemap and print out a useful help message</span>
<span class="sd">    if Basemap is either not installed or is missing required</span>
<span class="sd">    environment variables.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    has_basemap : bool</span>
<span class="sd">    Basemap : Basemap package if possible else None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Basemap</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">has_basemap</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">has_cartopy</span> <span class="o">=</span> <span class="n">import_cartopy</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">mpl_toolkits.basemap</span> <span class="kn">import</span> <span class="n">Basemap</span>
        <span class="n">WARNINGS</span><span class="p">[</span><span class="s1">&#39;has_basemap&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="n">has_basemap</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># if they have installed cartopy, no warning is needed</span>
        <span class="k">if</span> <span class="n">has_cartopy</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">has_basemap</span><span class="p">,</span> <span class="kc">False</span>
        <span class="c1"># if they haven&#39;t installed Basemap or cartopy, they need to be warned</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">WARNINGS</span><span class="p">[</span><span class="s1">&#39;basemap&#39;</span><span class="p">]:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="s2">&quot;-W- You haven&#39;t installed a module for plotting maps (cartopy or Basemap)&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    Recommended: install cartopy.  With conda:&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    conda install cartopy&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="s2">&quot;    For more information, see http://earthref.org/PmagPy/Cookbook#getting_python&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="p">(</span><span class="ne">KeyError</span><span class="p">,</span> <span class="ne">FileNotFoundError</span><span class="p">):</span>
        <span class="n">has_basemap</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># if cartopy is installed, no warning is needed</span>
        <span class="k">if</span> <span class="n">has_cartopy</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">has_basemap</span><span class="p">,</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">WARNINGS</span><span class="p">[</span><span class="s1">&#39;basemap&#39;</span><span class="p">]:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-W- Basemap is installed but could not be imported.&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;    You are probably missing a required environment variable&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="s1">&#39;    If you need to use Basemap, you will need to run this program or notebook in a conda env.&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;    For more on how to create a conda env, see: https://conda.io/docs/user-guide/tasks/manage-environments.html&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="s1">&#39;    Recommended alternative: install cartopy for plotting maps.  With conda:&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;    conda install cartopy&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">has_basemap</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">has_cartopy</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-W- You have installed Basemap but not cartopy.&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    In the future, Basemap will no longer be supported.&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    To continue to make maps, install using conda:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;    conda install cartopy&#39;</span><span class="p">)</span>

    <span class="n">WARNINGS</span><span class="p">[</span><span class="s1">&#39;basemap&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="n">has_basemap</span><span class="p">,</span> <span class="n">Basemap</span></div>


<div class="viewcode-block" id="import_cartopy"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.import_cartopy">[docs]</a><span class="k">def</span> <span class="nf">import_cartopy</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Try to import cartopy and print out a help message</span>
<span class="sd">    if it is not installed</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    has_cartopy : bool</span>
<span class="sd">    cartopy : cartopy package if available else None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># cartopy breaks Pyinstaller as of 9/16/20</span>
    <span class="k">if</span> <span class="n">set_env</span><span class="o">.</span><span class="n">IS_FROZEN</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">set_env</span><span class="o">.</span><span class="n">IS_WIN</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">None</span>
    <span class="n">cartopy</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">has_cartopy</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">cartopy</span>
        <span class="n">WARNINGS</span><span class="p">[</span><span class="s1">&#39;has_cartopy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="n">has_cartopy</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">WARNINGS</span><span class="p">[</span><span class="s1">&#39;cartopy&#39;</span><span class="p">]:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-W- cartopy is not installed&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;    If you want to make maps, install using conda:&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;    conda install cartopy&#39;</span><span class="p">)</span>
    <span class="n">WARNINGS</span><span class="p">[</span><span class="s1">&#39;cartopy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="n">has_cartopy</span><span class="p">,</span> <span class="n">cartopy</span></div>


<div class="viewcode-block" id="age_to_BP"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.age_to_BP">[docs]</a><span class="k">def</span> <span class="nf">age_to_BP</span><span class="p">(</span><span class="n">age</span><span class="p">,</span> <span class="n">age_unit</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert an age value into the equivalent in time Before Present(BP) where Present is 1950.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    age : age as a float</span>
<span class="sd">    age_unit : age unit as a str, valid strings:</span>
<span class="sd">        (Years AD (+/-), Years Cal AD (+/-), Years BP, ka, Ma, or Ga)</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ageBP : age before present</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ageBP</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1e9</span>
    <span class="k">if</span> <span class="n">age_unit</span> <span class="o">==</span> <span class="s2">&quot;Years AD (+/-)&quot;</span> <span class="ow">or</span> <span class="n">age_unit</span> <span class="o">==</span> <span class="s2">&quot;Years Cal AD (+/-)&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">age</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">age</span> <span class="o">=</span> <span class="n">age</span><span class="o">+</span><span class="mi">1</span>  <span class="c1"># to correct for there being no 0 AD</span>
        <span class="n">ageBP</span> <span class="o">=</span> <span class="mi">1950</span><span class="o">-</span><span class="n">age</span>
    <span class="k">elif</span> <span class="n">age_unit</span> <span class="o">==</span> <span class="s2">&quot;Years BP&quot;</span> <span class="ow">or</span> <span class="n">age_unit</span> <span class="o">==</span> <span class="s2">&quot;Years Cal BP&quot;</span><span class="p">:</span>
        <span class="n">ageBP</span> <span class="o">=</span> <span class="n">age</span>
    <span class="k">elif</span> <span class="n">age_unit</span> <span class="o">==</span> <span class="s2">&quot;ka&quot;</span><span class="p">:</span>
        <span class="n">ageBP</span> <span class="o">=</span> <span class="n">age</span><span class="o">*</span><span class="mi">1000</span>
    <span class="k">elif</span> <span class="n">age_unit</span> <span class="o">==</span> <span class="s2">&quot;Ma&quot;</span><span class="p">:</span>
        <span class="n">ageBP</span> <span class="o">=</span> <span class="n">age</span><span class="o">*</span><span class="mf">1e6</span>
    <span class="k">elif</span> <span class="n">age_unit</span> <span class="o">==</span> <span class="s2">&quot;Ga&quot;</span><span class="p">:</span>
        <span class="n">ageBP</span> <span class="o">=</span> <span class="n">age</span><span class="o">*</span><span class="mf">1e9</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Age unit invalid. Age set to -1.0e9&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">ageBP</span></div>


<div class="viewcode-block" id="vocab_convert"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.vocab_convert">[docs]</a><span class="k">def</span> <span class="nf">vocab_convert</span><span class="p">(</span><span class="n">vocab</span><span class="p">,</span> <span class="n">standard</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts MagIC database terms (method codes, geologic_types, etc) to other standards.</span>
<span class="sd">    May not be comprehensive for each standard. Terms added to standards as people need them</span>
<span class="sd">    and may not be up-to-date.</span>

<span class="sd">    &#39;key&#39; can be used to distinguish vocab terms that exist in two different lists.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    value of the MagIC vocab in the standard requested</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; pmag.vocab_convert(&#39;Egypt&#39;,&#39;GEOMAGIA&#39;) </span>
<span class="sd">    &#39;1&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">places_to_geomagia</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;Egypt&#39;</span><span class="p">:</span>                 <span class="s2">&quot;1&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Japan&#39;</span><span class="p">:</span>                 <span class="s2">&quot;2&quot;</span><span class="p">,</span>
        <span class="s1">&#39;France&#39;</span><span class="p">:</span>                <span class="s2">&quot;3&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Ukraine&#39;</span><span class="p">:</span>               <span class="s2">&quot;5&quot;</span><span class="p">,</span>
        <span class="s1">&#39;India&#39;</span><span class="p">:</span>                 <span class="s2">&quot;6&quot;</span><span class="p">,</span>
        <span class="s1">&#39;China&#39;</span><span class="p">:</span>                 <span class="s2">&quot;7&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Finland&#39;</span><span class="p">:</span>               <span class="s2">&quot;8&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Greece&#39;</span><span class="p">:</span>                <span class="s2">&quot;9&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Italy&#39;</span><span class="p">:</span>                 <span class="s2">&quot;11&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Switzerland&#39;</span><span class="p">:</span>           <span class="s2">&quot;12&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Bulgaria&#39;</span><span class="p">:</span>              <span class="s2">&quot;13&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Syria&#39;</span><span class="p">:</span>                 <span class="s2">&quot;14&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Hungary&#39;</span><span class="p">:</span>               <span class="s2">&quot;15&quot;</span><span class="p">,</span>
        <span class="s1">&#39;East Pacific Ridge&#39;</span><span class="p">:</span>    <span class="s2">&quot;17&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Hawaii&#39;</span><span class="p">:</span>                <span class="s2">&quot;18&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Morocco&#39;</span><span class="p">:</span>               <span class="s2">&quot;19&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Australia&#39;</span><span class="p">:</span>             <span class="s2">&quot;20&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Georgia&#39;</span><span class="p">:</span>               <span class="s2">&quot;21&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Azerbaijan&#39;</span><span class="p">:</span>            <span class="s2">&quot;22&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Spain&#39;</span><span class="p">:</span>                 <span class="s2">&quot;24&quot;</span><span class="p">,</span>
        <span class="s1">&#39;England&#39;</span><span class="p">:</span>               <span class="s2">&quot;25&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Czech Republic&#39;</span><span class="p">:</span>        <span class="s2">&quot;26&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Mexico&#39;</span><span class="p">:</span>                <span class="s2">&quot;27&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Iraq&#39;</span><span class="p">:</span>                  <span class="s2">&quot;28&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Israel&#39;</span><span class="p">:</span>                <span class="s2">&quot;29&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Iran&#39;</span><span class="p">:</span>                  <span class="s2">&quot;30&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Uzbekistan&#39;</span><span class="p">:</span>            <span class="s2">&quot;31&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Turkmenistan&#39;</span><span class="p">:</span>          <span class="s2">&quot;32&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Mongolia&#39;</span><span class="p">:</span>              <span class="s2">&quot;33&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Iceland&#39;</span><span class="p">:</span>               <span class="s2">&quot;34&quot;</span><span class="p">,</span>
        <span class="s1">&#39;New Zealand&#39;</span><span class="p">:</span>           <span class="s2">&quot;35&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Amsterdam Island&#39;</span><span class="p">:</span>      <span class="s2">&quot;36&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Guadeloupe&#39;</span><span class="p">:</span>            <span class="s2">&quot;37&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Mid Atlantic Ridge&#39;</span><span class="p">:</span>    <span class="s2">&quot;38&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Austria&#39;</span><span class="p">:</span>               <span class="s2">&quot;39&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Belgium&#39;</span><span class="p">:</span>               <span class="s2">&quot;40&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Romania&#39;</span><span class="p">:</span>               <span class="s2">&quot;41&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Guatemala&#39;</span><span class="p">:</span>             <span class="s2">&quot;42&quot;</span><span class="p">,</span>
        <span class="s1">&#39;El Salvador&#39;</span><span class="p">:</span>           <span class="s2">&quot;43&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Canary Islands&#39;</span><span class="p">:</span>        <span class="s2">&quot;45&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Moldova&#39;</span><span class="p">:</span>               <span class="s2">&quot;46&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Latvia&#39;</span><span class="p">:</span>                <span class="s2">&quot;47&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Lithuania&#39;</span><span class="p">:</span>             <span class="s2">&quot;48&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Russia&#39;</span><span class="p">:</span>                <span class="s2">&quot;49&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Germany&#39;</span><span class="p">:</span>               <span class="s2">&quot;51&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Martinique&#39;</span><span class="p">:</span>            <span class="s2">&quot;52&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Netherlands&#39;</span><span class="p">:</span>           <span class="s2">&quot;53&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Turkey&#39;</span><span class="p">:</span>                <span class="s2">&quot;54&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Denmark&#39;</span><span class="p">:</span>               <span class="s2">&quot;55&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Cameroon&#39;</span><span class="p">:</span>              <span class="s2">&quot;56&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Honduras&#39;</span><span class="p">:</span>              <span class="s2">&quot;57&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Jordan&#39;</span><span class="p">:</span>                <span class="s2">&quot;58&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Brazil&#39;</span><span class="p">:</span>                <span class="s2">&quot;59&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Estonia&#39;</span><span class="p">:</span>               <span class="s2">&quot;61&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Sweden&#39;</span><span class="p">:</span>                <span class="s2">&quot;62&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Peru&#39;</span><span class="p">:</span>                  <span class="s2">&quot;63&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Bolivia&#39;</span><span class="p">:</span>               <span class="s2">&quot;64&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Ecuador&#39;</span><span class="p">:</span>               <span class="s2">&quot;65&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Ontario&#39;</span><span class="p">:</span>               <span class="s2">&quot;66&quot;</span><span class="p">,</span>
        <span class="s1">&#39;New Mexico&#39;</span><span class="p">:</span>            <span class="s2">&quot;67&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Arizona&#39;</span><span class="p">:</span>               <span class="s2">&quot;68&quot;</span><span class="p">,</span>
        <span class="s1">&#39;California&#39;</span><span class="p">:</span>            <span class="s2">&quot;69&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Colorado&#39;</span><span class="p">:</span>              <span class="s2">&quot;70&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Utah&#39;</span><span class="p">:</span>                  <span class="s2">&quot;71&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Washington&#39;</span><span class="p">:</span>            <span class="s2">&quot;72&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Oregon&#39;</span><span class="p">:</span>                <span class="s2">&quot;73&quot;</span><span class="p">,</span>
        <span class="s1">&#39;British Columbia&#39;</span><span class="p">:</span>      <span class="s2">&quot;74&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Idaho&#39;</span><span class="p">:</span>                 <span class="s2">&quot;75&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Arkansas&#39;</span><span class="p">:</span>              <span class="s2">&quot;76&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Tennessee&#39;</span><span class="p">:</span>             <span class="s2">&quot;78&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Serbia&#39;</span><span class="p">:</span>                <span class="s2">&quot;79&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Kosovo&#39;</span><span class="p">:</span>                <span class="s2">&quot;80&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Portugal&#39;</span><span class="p">:</span>              <span class="s2">&quot;81&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Thailand&#39;</span><span class="p">:</span>              <span class="s2">&quot;82&quot;</span><span class="p">,</span>
        <span class="s1">&#39;South Korea&#39;</span><span class="p">:</span>           <span class="s2">&quot;83&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Kazakhstan&#39;</span><span class="p">:</span>            <span class="s2">&quot;84&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Nebraska&#39;</span><span class="p">:</span>              <span class="s2">&quot;85&quot;</span><span class="p">,</span>
        <span class="s1">&#39;La Reunion&#39;</span><span class="p">:</span>            <span class="s2">&quot;86&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Cyprus&#39;</span><span class="p">:</span>                <span class="s2">&quot;87&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Papua New Guinea&#39;</span><span class="p">:</span>      <span class="s2">&quot;88&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Vanuatu&#39;</span><span class="p">:</span>               <span class="s2">&quot;89&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Fiji&#39;</span><span class="p">:</span>                  <span class="s2">&quot;90&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Argentina&#39;</span><span class="p">:</span>             <span class="s2">&quot;91&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Tunisia&#39;</span><span class="p">:</span>               <span class="s2">&quot;92&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Mali&#39;</span><span class="p">:</span>                  <span class="s2">&quot;93&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Senegal&#39;</span><span class="p">:</span>               <span class="s2">&quot;95&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Alaska&#39;</span><span class="p">:</span>                <span class="s2">&quot;96&quot;</span><span class="p">,</span>
        <span class="s1">&#39;North Atlantic&#39;</span><span class="p">:</span>        <span class="s2">&quot;97&quot;</span><span class="p">,</span>
        <span class="s1">&#39;South Atlantic&#39;</span><span class="p">:</span>        <span class="s2">&quot;98&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Beaufort Sea&#39;</span><span class="p">:</span>          <span class="s2">&quot;99&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Chukchi Sea&#39;</span><span class="p">:</span>           <span class="s2">&quot;100&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Kyrgyzstan&#39;</span><span class="p">:</span>            <span class="s2">&quot;101&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Indonesia&#39;</span><span class="p">:</span>             <span class="s2">&quot;102&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Azores&#39;</span><span class="p">:</span>                <span class="s2">&quot;103&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Quebec&#39;</span><span class="p">:</span>                <span class="s2">&quot;104&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Norway&#39;</span><span class="p">:</span>                <span class="s2">&quot;105&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Northern Ireland&#39;</span><span class="p">:</span>      <span class="s2">&quot;106&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Wales&#39;</span><span class="p">:</span>                 <span class="s2">&quot;107&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Scotland&#39;</span><span class="p">:</span>              <span class="s2">&quot;108&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Virginia&#39;</span><span class="p">:</span>              <span class="s2">&quot;109&quot;</span><span class="p">,</span>
        <span class="s1">&#39;North West Pacific&#39;</span><span class="p">:</span>    <span class="s2">&quot;110&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Mediterranean&#39;</span><span class="p">:</span>         <span class="s2">&quot;111&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Slovakia&#39;</span><span class="p">:</span>              <span class="s2">&quot;121&quot;</span><span class="p">,</span>
        <span class="s1">&#39;Poland&#39;</span><span class="p">:</span>                <span class="s2">&quot;124&quot;</span>
    <span class="p">}</span>

    <span class="n">geologic_types_to_geomagia</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;Baked Clay&quot;</span><span class="p">:</span>                                  <span class="s2">&quot;2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Tile&quot;</span><span class="p">:</span>                                        <span class="s2">&quot;3&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Lava&quot;</span><span class="p">:</span>                                        <span class="s2">&quot;4&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Pottery&quot;</span><span class="p">:</span>                                     <span class="s2">&quot;5&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Sun Dried Object&quot;</span><span class="p">:</span>                            <span class="s2">&quot;6&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Porcelain&quot;</span><span class="p">:</span>                                   <span class="s2">&quot;7&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Ceramic&quot;</span><span class="p">:</span>                                     <span class="s2">&quot;8&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Kiln&quot;</span><span class="p">:</span>                                        <span class="s2">&quot;9&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Oven or Hearth (GEOMAGIA Only)&quot;</span><span class="p">:</span>              <span class="s2">&quot;10&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Mixed Archeological Objects&quot;</span><span class="p">:</span>                 <span class="s2">&quot;11&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Slag&quot;</span><span class="p">:</span>                                        <span class="s2">&quot;12&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Baked Rock&quot;</span><span class="p">:</span>                                  <span class="s2">&quot;13&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Fresco&quot;</span><span class="p">:</span>                                      <span class="s2">&quot;14&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Mosaic&quot;</span><span class="p">:</span>                                      <span class="s2">&quot;15&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Wall&quot;</span><span class="p">:</span>                                        <span class="s2">&quot;16&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Bath&quot;</span><span class="p">:</span>                                        <span class="s2">&quot;17&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Burnt Floor&quot;</span><span class="p">:</span>                                 <span class="s2">&quot;18&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Funeral Pyre&quot;</span><span class="p">:</span>                                <span class="s2">&quot;19&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Hypocaust&quot;</span><span class="p">:</span>                                   <span class="s2">&quot;20&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Burnt Pit&quot;</span><span class="p">:</span>                                   <span class="s2">&quot;21&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Bell Mould&quot;</span><span class="p">:</span>                                  <span class="s2">&quot;22&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Smoking Chamber&quot;</span><span class="p">:</span>                             <span class="s2">&quot;23&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Baked Mud&quot;</span><span class="p">:</span>                                   <span class="s2">&quot;24&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Volcanic Ash&quot;</span><span class="p">:</span>                                <span class="s2">&quot;25&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Burnt Structure&quot;</span><span class="p">:</span>                             <span class="s2">&quot;26&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Burnt Castle Wall&quot;</span><span class="p">:</span>                           <span class="s2">&quot;27&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Charcoal Pile&quot;</span><span class="p">:</span>                               <span class="s2">&quot;28&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Burnt Earth&quot;</span><span class="p">:</span>                                 <span class="s2">&quot;29&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Vitrified Object&quot;</span><span class="p">:</span>                            <span class="s2">&quot;30&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Unbaked Sediment&quot;</span><span class="p">:</span>                            <span class="s2">&quot;31&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Tuyere&quot;</span><span class="p">:</span>                                      <span class="s2">&quot;32&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Sauna&quot;</span><span class="p">:</span>                                       <span class="s2">&quot;33&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Pit Structure&quot;</span><span class="p">:</span>                               <span class="s2">&quot;35&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Room&quot;</span><span class="p">:</span>                                        <span class="s2">&quot;36&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Pit House&quot;</span><span class="p">:</span>                                   <span class="s2">&quot;37&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Salt Kiln&quot;</span><span class="p">:</span>                                   <span class="s2">&quot;38&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Burnt Sediment&quot;</span><span class="p">:</span>                              <span class="s2">&quot;39&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Archeological Ashes&quot;</span><span class="p">:</span>                         <span class="s2">&quot;40&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Volcanic Other or Undefined (GEOMAGIA Only)&quot;</span><span class="p">:</span> <span class="s2">&quot;41&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Mural&quot;</span><span class="p">:</span>                                       <span class="s2">&quot;42&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Vitrified Stone&quot;</span><span class="p">:</span>                             <span class="s2">&quot;43&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Soil&quot;</span><span class="p">:</span>                                        <span class="s2">&quot;44&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Kamadogu&quot;</span><span class="p">:</span>                                    <span class="s2">&quot;45&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Foundry&quot;</span><span class="p">:</span>                                     <span class="s2">&quot;46&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Obsidian&quot;</span><span class="p">:</span>                                    <span class="s2">&quot;47&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Chert&quot;</span><span class="p">:</span>                                       <span class="s2">&quot;48&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Burnt daub&quot;</span><span class="p">:</span>                                  <span class="s2">&quot;49&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Amphora&quot;</span><span class="p">:</span>                                     <span class="s2">&quot;50&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Granite&quot;</span><span class="p">:</span>                                     <span class="s2">&quot;51&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Volcanic Glass&quot;</span><span class="p">:</span>                              <span class="s2">&quot;52&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Furnace&quot;</span><span class="p">:</span>                                     <span class="s2">&quot;53&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Roasting Pit&quot;</span><span class="p">:</span>                                <span class="s2">&quot;54&quot;</span>

    <span class="p">}</span>

<span class="c1">#   Some of the simple method code mappings are done here</span>

    <span class="n">method_codes_to_geomagia</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;GM-NO&quot;</span><span class="p">:</span>        <span class="s2">&quot;0&quot;</span><span class="p">,</span>
        <span class="s2">&quot;GM-CC-ARCH&quot;</span><span class="p">:</span>   <span class="s2">&quot;101&quot;</span><span class="p">,</span>
        <span class="s2">&quot;GM-C14-CAL&quot;</span><span class="p">:</span>   <span class="s2">&quot;102&quot;</span><span class="p">,</span>
        <span class="s2">&quot;GM-C14-UNCAL&quot;</span><span class="p">:</span> <span class="s2">&quot;103&quot;</span><span class="p">,</span>
        <span class="s2">&quot;GM-LUM-TH&quot;</span><span class="p">:</span>    <span class="s2">&quot;104&quot;</span><span class="p">,</span>
        <span class="s2">&quot;GM-HIST&quot;</span><span class="p">:</span>      <span class="s2">&quot;105&quot;</span><span class="p">,</span>
        <span class="s2">&quot;GM-PMAG-ARCH&quot;</span><span class="p">:</span> <span class="s2">&quot;106&quot;</span><span class="p">,</span>
        <span class="s2">&quot;GM-ARAR&quot;</span><span class="p">:</span>      <span class="s2">&quot;107&quot;</span><span class="p">,</span>
        <span class="s2">&quot;GM-CC-TEPH&quot;</span><span class="p">:</span>   <span class="s2">&quot;108&quot;</span><span class="p">,</span>
        <span class="s2">&quot;GM-CC-STRAT&quot;</span><span class="p">:</span>  <span class="s2">&quot;109&quot;</span><span class="p">,</span>
        <span class="s2">&quot;GM-CC-REL&quot;</span><span class="p">:</span>    <span class="s2">&quot;110&quot;</span><span class="p">,</span>
        <span class="s2">&quot;GM-DENDRO&quot;</span><span class="p">:</span>    <span class="s2">&quot;111&quot;</span><span class="p">,</span>
        <span class="s2">&quot;GM-RATH&quot;</span><span class="p">:</span>      <span class="s2">&quot;112&quot;</span><span class="p">,</span>
        <span class="s2">&quot;GM-KAR&quot;</span><span class="p">:</span>       <span class="s2">&quot;113&quot;</span><span class="p">,</span>
        <span class="s2">&quot;GM-UTH&quot;</span><span class="p">:</span>       <span class="s2">&quot;114&quot;</span><span class="p">,</span>
        <span class="s2">&quot;GM-FT&quot;</span><span class="p">:</span>        <span class="s2">&quot;115&quot;</span><span class="p">,</span>
        <span class="s2">&quot;GM-C14-AMS&quot;</span><span class="p">:</span>   <span class="s2">&quot;116&quot;</span><span class="p">,</span>
        <span class="s2">&quot;GM-LUM-OS&quot;</span><span class="p">:</span>    <span class="s2">&quot;117&quot;</span><span class="p">,</span>
        <span class="s2">&quot;GM-HE3&quot;</span><span class="p">:</span>       <span class="s2">&quot;118&quot;</span><span class="p">,</span>
        <span class="s2">&quot;GM-VARVE&quot;</span><span class="p">:</span>     <span class="s2">&quot;119&quot;</span><span class="p">,</span>
        <span class="s2">&quot;GM-CS137&quot;</span><span class="p">:</span>     <span class="s2">&quot;120&quot;</span><span class="p">,</span>
        <span class="s2">&quot;GM-USD-PB210&quot;</span><span class="p">:</span> <span class="s2">&quot;121&quot;</span><span class="p">,</span>
        <span class="s2">&quot;GM-C14-BETA&quot;</span><span class="p">:</span>  <span class="s2">&quot;122&quot;</span><span class="p">,</span>
        <span class="s2">&quot;GM-O18&quot;</span><span class="p">:</span>       <span class="s2">&quot;123&quot;</span><span class="p">,</span>
        <span class="s2">&quot;GM-PA&quot;</span><span class="p">:</span>        <span class="s2">&quot;124&quot;</span>
    <span class="p">}</span>

    <span class="n">standard</span> <span class="o">=</span> <span class="n">standard</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="n">standard_value</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">if</span> <span class="n">standard</span> <span class="o">==</span> <span class="s2">&quot;geomagia&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">vocab</span> <span class="ow">in</span> <span class="n">places_to_geomagia</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">standard_value</span> <span class="o">=</span> <span class="n">places_to_geomagia</span><span class="p">[</span><span class="n">vocab</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">vocab</span> <span class="ow">in</span> <span class="n">geologic_types_to_geomagia</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">standard_value</span> <span class="o">=</span> <span class="n">geologic_types_to_geomagia</span><span class="p">[</span><span class="n">vocab</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">vocab</span> <span class="ow">in</span> <span class="n">method_codes_to_geomagia</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">standard_value</span> <span class="o">=</span> <span class="n">method_codes_to_geomagia</span><span class="p">[</span><span class="n">vocab</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">standard_value</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">vocab</span><span class="o">==</span><span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="n">standard_value</span><span class="o">=</span><span class="s2">&quot;Fail:vocab_to_convert_is_null&quot;</span>
        <span class="k">elif</span> <span class="n">vocab</span><span class="o">.</span><span class="n">isspace</span><span class="p">()</span> <span class="ow">or</span> <span class="n">vocab</span><span class="o">!=</span><span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="n">standard_value</span><span class="o">=</span><span class="s2">&quot;Fail:vocab_to_convert_is_all_whitespace&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;pmag.vocab_convert:Magic vocab &#39;&quot;</span><span class="p">,</span> <span class="n">vocab</span><span class="p">,</span> <span class="s2">&quot;&#39; not found for standard &quot;</span><span class="p">,</span> <span class="n">standard</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="k">return</span><span class="p">(</span><span class="n">vocab</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">standard_value</span></div>


<div class="viewcode-block" id="fix_directories"><a class="viewcode-back" href="../../api/api.html#pmagpy.pmag.fix_directories">[docs]</a><span class="k">def</span> <span class="nf">fix_directories</span><span class="p">(</span><span class="n">input_dir_path</span><span class="p">,</span> <span class="n">output_dir_path</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Take arguments input/output directories and fixes them.</span>
<span class="sd">    If no input_directory, default to output_dir_path for both.</span>
<span class="sd">    Then return realpath for both values.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    input_dir_path : str</span>
<span class="sd">    output_dir_path : str</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    input_dir_path, output_dir_path</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">input_dir_path</span><span class="p">:</span>
        <span class="n">input_dir_path</span> <span class="o">=</span> <span class="n">output_dir_path</span>
    <span class="n">input_dir_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="n">input_dir_path</span><span class="p">)</span>
    <span class="n">output_dir_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="n">output_dir_path</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">input_dir_path</span><span class="p">,</span> <span class="n">output_dir_path</span></div>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Full PmagPy documentation is available at: https://earthref.org/PmagPy/cookbook/&quot;</span><span class="p">)</span>
</pre></div>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By PmagPy Contributors<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>