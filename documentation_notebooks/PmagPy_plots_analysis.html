

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Visualizations and more analysis with PmagPy &#8212; PmagPy Documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=927b94d3fcb96560df09" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=927b94d3fcb96560df09" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=927b94d3fcb96560df09" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=927b94d3fcb96560df09" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=927b94d3fcb96560df09" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=927b94d3fcb96560df09" />
  <script src="../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=927b94d3fcb96560df09"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'documentation_notebooks/PmagPy_plots_analysis';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Working with the MagIC database using PmagPy" href="PmagPy_MagIC.html" />
    <link rel="prev" title="Calculations with PmagPy" href="PmagPy_calculations.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/pmagpy_logo_notext.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/pmagpy_logo_notext.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    PmagPy: An open source package for paleomagnetic data analysis
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Installation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../installation/PmagPy_install.html">Installing <strong>PmagPy</strong></a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../installation/osx_pip.html">OSX pip install</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation/osx_developer.html">OSX developer install</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation/windows_pip.html">Windows pip install</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation/windows_developer.html">Windows developer install</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation/linux_pip.html">Linux pip install</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation/linux_developer.html">Linux developer install</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation/troubleshooting.html">Troubleshooting installation issues</a></li>
<li class="toctree-l2"><a class="reference internal" href="../programs/command_line_programs.html">Command line programs</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../programs/pmag_gui.html">Installing and Getting Started with Pmag GUI</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../programs/demag_gui.html">Demag GUI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../programs/thellier_gui.html">Thellier GUI</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../resources/survival_skills.html">Survival computer skills</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Documentation notebooks</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Jupyter.html">Jupyter Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="PmagPy_introduction.html">Introduction to PmagPy</a></li>

<li class="toctree-l1"><a class="reference internal" href="PmagPy_calculations.html">Calculations with PmagPy</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Visualizations and more analysis with PmagPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="PmagPy_MagIC.html">Working with the MagIC database using PmagPy</a></li>


</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Example notebooks</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../example_notebooks/tutorial_notebooks.html">Tutorial notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../example_notebooks/template_notebooks.html">Template notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../example_notebooks/published_notebooks.html">Published studies notebooks</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">MagIC</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../MagIC/MagIC.html">MagIC database and file formats</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Function docstrings</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../api/api.html">API Reference</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">References</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/pmagpy/pmagpy-docs" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/pmagpy/pmagpy-docs/issues/new?title=Issue%20on%20page%20%2Fdocumentation_notebooks/PmagPy_plots_analysis.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/documentation_notebooks/PmagPy_plots_analysis.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Visualizations and more analysis with PmagPy</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#guide-to-pmagpy">Guide to PmagPy</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#customizing-this-notebook">Customizing this notebook</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#get-started">Get started</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#functions-demonstrated-within-pmagpy-plots-analysis-ipynb">Functions demonstrated within <span class="xref myst">PmagPy_plots_analysis.ipynb</span>:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#figures">Figures</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ani-depthplot">ani_depthplot</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#aniso-magic">aniso_magic</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#biplot-magic">biplot_magic</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#chi-magic">chi_magic</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#common-mean">common_mean</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cont-rot">cont_rot</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#core-depthplot">core_depthplot</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#curie">curie</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dayplot-magic">dayplot_magic</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dmag-magic">dmag_magic</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dmag-magic-with-a-downloaded-file">dmag_magic with a downloaded file</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dms2dd">dms2dd</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#eqarea">eqarea</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#eqarea-ell">eqarea_ell</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bingham-ellipses">Bingham ellipses</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fisher-mean-a95">Fisher mean, a95</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#kent-mean-and-ellipse">Kent mean and ellipse</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bootstrap-eigenvectors">Bootstrap eigenvectors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bootstrapped-ellipses">Bootstrapped ellipses</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#eqarea-magic">eqarea_magic</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#whole-study">whole study</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#whole-study-with-color-contour-option">whole study with color contour option</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#specimens-by-site">specimens by site</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#measurements-by-specimen">measurements by specimen</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#individual-specimens">Individual specimens</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#find-ei">find_ei</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fishqq">fishqq</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#foldtest">foldtest</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#foldtest-magic">foldtest_magic</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#forc-diagram">forc_diagram</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#histplot">histplot</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hysteresis-magic">hysteresis_magic</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#irm-unmix">irm_unmix</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#irmaq-magic">irmaq_magic</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lnp-magic">lnp_magic</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lowes">lowes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lowrie">lowrie</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-cdf">plot_cdf</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-geomagia">plot_geomagia</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-mag-map">plot_mag_map</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-map-pts">plot_map_pts</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-di-mean">plot_di_mean</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#polemap-magic">polemap_magic</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-poles-with-a-95-ellipse">Plotting poles with A_{95} ellipse</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-ts">plot_ts</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#qqplot">qqplot</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#qqunf">qqunf</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#quick-hyst">quick_hyst</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#revtest">revtest</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#revtest-magic">revtest_magic</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#revtest-mm1990">revtest_mm1990</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#thellier-magic">thellier_magic</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#vgpmap-magic">vgpmap_magic</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#watsons-v">watsons_v</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#zeq">zeq</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#zeq-magic">zeq_magic</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#clean-up">Clean up</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="visualizations-and-more-analysis-with-pmagpy">
<h1>Visualizations and more analysis with PmagPy<a class="headerlink" href="#visualizations-and-more-analysis-with-pmagpy" title="Permalink to this heading">#</a></h1>
<p>This notebook demonstrates PmagPy functions that can be used to visualize data as well as those that conduct statistical tests that have associated visualizations.</p>
<section id="guide-to-pmagpy">
<h2>Guide to PmagPy<a class="headerlink" href="#guide-to-pmagpy" title="Permalink to this heading">#</a></h2>
<p>The notebook is one of a series of notebooks that demonstrate the functionality of PmagPy. The other notebooks are:</p>
<ul class="simple">
<li><p><a class="reference internal" href="PmagPy_introduction.html"><span class="doc std std-doc">PmagPy_introduction.ipynb</span></a> This notebook introduces PmagPy and lists the functions that are demonstrated in the other notebooks.</p></li>
<li><p><a class="reference internal" href="PmagPy_calculations.html"><span class="doc std std-doc">PmagPy_calculations.ipynb</span></a> This notebook demonstrates many of the PmagPy calculation functions such as those that rotate directions, return statistical parameters, and simulate data from specified distributions</p></li>
<li><p><a class="reference internal" href="PmagPy_MagIC.html"><span class="doc std std-doc">PmagPy_MagIC.ipynb</span></a> This notebook demonstrates how PmagPy can be used to read and write data to and from the MagIC database format including conversion from many individual lab measurement file formats.</p></li>
</ul>
</section>
<section id="customizing-this-notebook">
<h2>Customizing this notebook<a class="headerlink" href="#customizing-this-notebook" title="Permalink to this heading">#</a></h2>
<p>If you want to make changes to this notebook, you should make a copy (see File menu).  Otherwise each time you update <strong>PmagPy</strong>, your changes will be overwritten.</p>
</section>
<section id="get-started">
<h2>Get started<a class="headerlink" href="#get-started" title="Permalink to this heading">#</a></h2>
<p>To use the functions in this notebook, we have to   import the <strong>PmagPy</strong> modules <strong>pmagplotlib</strong>, <strong>pmag</strong> and <strong>ipmag</strong> and some other handy functions for use in the notebook.  This is done in the following code block which must be executed before running any other code block. To execute, click on the code block and then click on the “Run” button in the menu.</p>
<p>In order to access the example data, this notebook is meant to be run in the PmagPy-data directory (PmagPy directory for developers).</p>
<p>Try it!  Run the code block below (click on the cell and then click ‘Run’):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pmagpy.pmag</span> <span class="k">as</span> <span class="nn">pmag</span>
<span class="kn">import</span> <span class="nn">pmagpy.pmagplotlib</span> <span class="k">as</span> <span class="nn">pmagplotlib</span>
<span class="kn">import</span> <span class="nn">pmagpy.ipmag</span> <span class="k">as</span> <span class="nn">ipmag</span>
<span class="kn">import</span> <span class="nn">pmagpy.contribution_builder</span> <span class="k">as</span> <span class="nn">cb</span>
<span class="kn">from</span> <span class="nn">pmagpy</span> <span class="kn">import</span> <span class="n">convert_2_magic</span> <span class="k">as</span> <span class="n">convert</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span> <span class="c1"># our plotting buddy</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span> <span class="c1"># the fabulous NumPy package</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span> <span class="c1"># and of course Pandas</span>
<span class="c1"># test if Basemap and/or cartopy is installed</span>
<span class="n">has_basemap</span><span class="p">,</span> <span class="n">Basemap</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">import_basemap</span><span class="p">()</span>
<span class="n">has_cartopy</span><span class="p">,</span> <span class="n">Cartopy</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">import_cartopy</span><span class="p">()</span>
<span class="c1"># test if xlwt is installed (allows you to export to excel)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">xlwt</span>
    <span class="n">has_xlwt</span> <span class="o">=</span> <span class="kc">True</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="n">has_xlwt</span> <span class="o">=</span> <span class="kc">False</span>
<span class="c1"># This allows you to make matplotlib plots inside the notebook.  </span>
<span class="o">%</span><span class="k">matplotlib</span> inline 
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;All modules imported!&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>All modules imported!
</pre></div>
</div>
</div>
</div>
<section id="functions-demonstrated-within-pmagpy-plots-analysis-ipynb">
<h3>Functions demonstrated within <a class="reference internal" href="#"><span class="doc std std-doc">PmagPy_plots_analysis.ipynb</span></a>:<a class="headerlink" href="#functions-demonstrated-within-pmagpy-plots-analysis-ipynb" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Functions in <strong>PmagPy_plots_tests.ipynb</strong></p>
<ul>
<li><p><span class="xref myst">ani_depthplot</span> : plots anisotropy data against depth in stratigraphic section (Xmas tree plots)</p></li>
<li><p><span class="xref myst">aniso_magic</span> : makes plots of anisotropy data and bootstrapped confidences</p></li>
<li><p><span class="xref myst">biplot_magic</span> : plots different columns against each other in MagIC formatted data files</p></li>
<li><p><span class="xref myst">chi_magic</span> : plots magnetic susceptibility data in MagIC format as function of field, frequency or temperature</p></li>
<li><p><span class="xref myst">common_mean</span> : graphical approach to testing two sets of directions for common mean using bootstrap</p></li>
<li><p><span class="xref myst">cont_rot</span> : makes plots of continents after rotation to specified coordinate system</p></li>
<li><p><span class="xref myst">core_depthplot</span> : plots MagIC formatted data</p></li>
<li><p><span class="xref myst">curie</span> : makes plots of Curie Temperature data and provides estimates for Tc</p></li>
<li><p><span class="xref myst">dayplot_magic</span> : makes Day et al. (1977) and other plots with hysteresis statistics</p></li>
<li><p><span class="xref myst">dmag_magic</span> : plots remanence against demagnetization step for MagIC formatted files</p></li>
<li><p><span class="xref myst">eqarea</span> and <span class="xref myst">eqarea_magic</span> : makes equal area projections for directions</p></li>
<li><p><span class="xref myst">eqarea_ell</span> : makes equal area projections for directions with specified confidence ellipses</p></li>
<li><p><span class="xref myst">find_ei</span> : finds the inclination unflattening factor that unsquishes directions to match TK03 distribution</p></li>
<li><p><span class="xref myst">fishqq</span>: makes a Quantile-Quantile plot for directions against uniform and exponential distributions</p></li>
<li><p><span class="xref myst">foldtest</span> &amp; <span class="xref myst">foldtest_magic</span> : finds  tilt correction that maximizes concentration of directions, with bootstrap confidence bounds.</p></li>
<li><p><span class="xref myst">forc_diagram</span>: plots FORC diagrams for both conventional and irregular FORCs</p></li>
<li><p><span class="xref myst">histplot</span> : makes histograms</p></li>
<li><p><span class="xref myst">hysteresis_magic</span> : makes plots of hysteresis data (not FORCs).</p></li>
<li><p><span class="xref myst">irm_unmix</span> : analyzes IRM acquisition data in terms of coercivity distributions</p></li>
<li><p><span class="xref myst">irmaq_magic</span> : plots IRM acquistion data</p></li>
<li><p><span class="xref myst">lnp_magic</span> : plots lines and planes for site level data and calculates best fit mean and alpha_95</p></li>
<li><p><span class="xref myst">lowes</span> : makes a plot of the Lowe’s spectrum for a geomagnetic field model</p></li>
<li><p><span class="xref myst">lowrie</span> and <span class="xref myst">lowrie_magic</span> : makes plots of Lowrie’s (1990) 3D-IRM demagnetization experiments</p></li>
<li><p><span class="xref myst">plot_cdf</span> and <span class="xref myst">plot_2cdfs</span> : makes a cumulative distribution plot of data</p></li>
<li><p><span class="xref myst">plot_di_mean</span> : makes equal area plots of directions and their <span class="math notranslate nohighlight">\(\alpha_{95}\)</span>s</p></li>
<li><p><span class="xref myst">plot_geomagia</span> : makes plots from files downloaded from the  geomagia website</p></li>
<li><p><span class="xref myst">plot_mag_map</span> : makes a color contour plot of geomagnetic field models</p></li>
<li><p><span class="xref myst">plot_magic_keys</span> : plots data from MagIC formatted data files</p></li>
<li><p><span class="xref myst">plot_map_pts</span> : plots points on maps</p></li>
<li><p><span class="xref myst">plot_ts</span> : makes a plot of the desired Geomagnetic Reversal time scale</p></li>
<li><p><span class="xref myst">polemap_magic</span> : reads in MagIC formatted file with paleomagnetic poles and plots them</p></li>
<li><p><span class="xref myst">qqplot</span> : makes a Quantile-Quantile plot for data against a normal distribution</p></li>
<li><p><span class="xref myst">qqunf</span> : makes a Quantile-Quantile plot for data against a uniform distribution</p></li>
<li><p><span class="xref myst">quick_hyst</span> : makes hysteresis plots</p></li>
<li><p><span class="xref myst">revtest</span> &amp; <span class="xref myst">revtest_magic</span> : performs a bootstrap reversals test</p></li>
<li><p><span class="xref myst">thellier_magic</span> : makes plots of thellier-thellier data.</p></li>
<li><p><span class="xref myst">vgpmap_magic</span> : reads in MagIC formatted file with virtual geomagnetic poles and plots them</p></li>
<li><p><span class="xref myst">watsons_v</span> : makes a graph for Watson’s V test for common mean</p></li>
<li><p><span class="xref myst">zeq</span> and <span class="xref myst">zeq_magic</span> : makes quick zijderveld plots for measurement data</p></li>
</ul>
</li>
<li><p>Maps:</p>
<ul>
<li><p><span class="xref myst">cont_rot</span> : makes plots of continents after rotation to specified coordinate system</p></li>
<li><p><span class="xref myst">plot_mag_map</span> : makes a color contour plot of geomagnetic field models</p></li>
<li><p><span class="xref myst">plot_map_pts</span> : plots points on maps</p></li>
<li><p><span class="xref myst">polemap_magic</span> : reads in MagIC formatted file with paleomagnetic poles and plots them</p></li>
<li><p><span class="xref myst">vgpmap_magic</span> : reads in MagIC formatted file with virtual geomagnetic poles and plots them</p></li>
</ul>
</li>
</ul>
</section>
</section>
<section id="figures">
<h2>Figures<a class="headerlink" href="#figures" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>The plotting functions make plots to the screen (using the  <code class="docutils literal notranslate"><span class="pre">%matplotlib</span> <span class="pre">inline</span></code> magic command), but all <strong>matplotlib</strong> plots can be saved with the command:</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">plt.savefig('PATH_TO_FILE_NAME.FMT')</span> </code></p>
<p>and then viewed in the notebook with:</p>
<p><code class="docutils literal notranslate"><span class="pre">Image('PATH_TO_FILE_NAME.FMT')</span></code></p>
</section>
<section id="ani-depthplot">
<h2>ani_depthplot<a class="headerlink" href="#ani-depthplot" title="Permalink to this heading">#</a></h2>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch13.html#x15-15600013">[Essentials Chapter 13]</a> <a class="reference external" href="https://earthref.org/MagIC">[MagIC Database]</a> <a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#ani_depthplot.py">[command_line_version]</a></p>
<p>Anisotropy data can be plotted versus depth. The program <strong>ani_depthplot</strong> uses MagIC formatted data tables. Bulk susceptibility measurements can also be plotted if they are available in a <strong>measurements.txt</strong> formatted file.</p>
<p>In this example, we will use the data from Tauxe et al. (2015, doi:10.1016/j.epsl.2014.12.034) measured on samples obtained during Expedition 318 of the International Ocean Drilling Program. To get the entire dataset, go to the MagIC data base at: <a class="reference external" href="https://www2.earthref.org/MagIC/doi/10.1016/j.epsl.2014.12.034">https://www2.earthref.org/MagIC/doi/10.1016/j.epsl.2014.12.034</a>.  Download the data set and unpack it with <strong>ipmag.download_magic</strong> (see the <strong>PmagPy_MagIC</strong> notebook).</p>
<p>We will use the <strong>ipmag.ani_depthplot()</strong> version of this program.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">ipmag</span><span class="o">.</span><span class="n">ani_depthplot</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function ani_depthplot in module pmagpy.ipmag:

ani_depthplot(spec_file=&#39;specimens.txt&#39;, samp_file=&#39;samples.txt&#39;, meas_file=&#39;measurements.txt&#39;, site_file=&#39;sites.txt&#39;, age_file=&#39;&#39;, sum_file=&#39;&#39;, fmt=&#39;svg&#39;, dmin=-1, dmax=-1, depth_scale=&#39;core_depth&#39;, dir_path=&#39;.&#39;, contribution=None)
    returns matplotlib figure with anisotropy data plotted against depth
    available depth scales: &#39;composite_depth&#39;, &#39;core_depth&#39; or &#39;age&#39; (you must provide an age file to use this option).
    You must provide valid specimens and sites files, and either a samples or an ages file.
    You may additionally provide measurements and a summary file (csv).
    
    Parameters
    ----------
    spec_file : str, default &quot;specimens.txt&quot;
    samp_file : str, default &quot;samples.txt&quot;
    meas_file : str, default &quot;measurements.txt&quot;
    site_file : str, default &quot;sites.txt&quot;
    age_file : str, default &quot;&quot;
    sum_file : str, default &quot;&quot;
    fmt : str, default &quot;svg&quot;
        format for figures, [&quot;svg&quot;, &quot;jpg&quot;, &quot;pdf&quot;, &quot;png&quot;]
    dmin : number, default -1
        minimum depth to plot (if -1, default to plotting all)
    dmax : number, default -1
        maximum depth to plot (if -1, default to plotting all)
    depth_scale : str, default &quot;core_depth&quot;
        scale to plot, [&#39;composite_depth&#39;, &#39;core_depth&#39;, &#39;age&#39;].
        if &#39;age&#39; is selected, you must provide an ages file.
    dir_path : str, default &quot;.&quot;
        directory for input files
    contribution : cb.Contribution, default None
        if provided, use Contribution object instead of reading in
        data from files
    
    Returns
    ---------
    plot : matplotlib plot, or False if no plot could be created
    name : figure name, or error message if no plot could be created
</pre></div>
</div>
</div>
</div>
<p>And here we go:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ipmag</span><span class="o">.</span><span class="n">ani_depthplot</span><span class="p">(</span><span class="n">dir_path</span><span class="o">=</span><span class="s1">&#39;data_files/ani_depthplot&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-I- Using online data model
-I- Getting method codes from earthref.org
-I- Importing controlled vocabularies from https://earthref.org
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">folders</span><span class="o">/</span><span class="n">hb</span><span class="o">/</span><span class="n">m9qm0bdd13q_t59j9424w1n80000gn</span><span class="o">/</span><span class="n">T</span><span class="o">/</span><span class="n">ipykernel_74170</span><span class="o">/</span><span class="mf">730097389.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">ipmag</span><span class="o">.</span><span class="n">ani_depthplot</span><span class="p">(</span><span class="n">dir_path</span><span class="o">=</span><span class="s1">&#39;data_files/ani_depthplot&#39;</span><span class="p">);</span>

<span class="nn">~/PmagPy/pmagpy/ipmag.py</span> in <span class="ni">ani_depthplot</span><span class="nt">(spec_file, samp_file, meas_file, site_file, age_file, sum_file, fmt, dmin, dmax, depth_scale, dir_path, contribution)</span>
<span class="g g-Whitespace">   </span><span class="mi">3393</span>             <span class="n">Axs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ax6</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3394</span>             <span class="n">ax6</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Bulks</span><span class="p">,</span> <span class="n">BulkDepths</span><span class="p">,</span> <span class="s1">&#39;bo&#39;</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">3395</span>             <span class="n">ax6</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="n">bmin</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.1</span> <span class="o">*</span> <span class="n">bmax</span><span class="p">,</span> <span class="n">dmax</span><span class="p">,</span> <span class="n">dmin</span><span class="p">])</span>
<span class="g g-Whitespace">   </span><span class="mi">3396</span>             <span class="n">ax6</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Bulk Susc. (uSI)&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3397</span>             <span class="n">ax6</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">NullLocator</span><span class="p">())</span>

<span class="nn">~/opt/anaconda3/envs/pmagpy_env/lib/python3.9/site-packages/matplotlib/axes/_base.py</span> in <span class="ni">axis</span><span class="nt">(self, emit, *args, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">1926</span>                      <span class="k">if</span> <span class="n">ymin</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">ymax</span> <span class="ow">is</span> <span class="kc">None</span>
<span class="g g-Whitespace">   </span><span class="mi">1927</span>                      <span class="k">else</span> <span class="kc">False</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1928</span>             <span class="bp">self</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">emit</span><span class="o">=</span><span class="n">emit</span><span class="p">,</span> <span class="n">auto</span><span class="o">=</span><span class="n">xauto</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1929</span>             <span class="bp">self</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">,</span> <span class="n">emit</span><span class="o">=</span><span class="n">emit</span><span class="p">,</span> <span class="n">auto</span><span class="o">=</span><span class="n">yauto</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1930</span>         <span class="k">if</span> <span class="n">kwargs</span><span class="p">:</span>

<span class="nn">~/opt/anaconda3/envs/pmagpy_env/lib/python3.9/site-packages/matplotlib/axes/_base.py</span> in <span class="ni">set_xlim</span><span class="nt">(self, left, right, emit, auto, xmin, xmax)</span>
<span class="g g-Whitespace">   </span><span class="mi">3520</span> 
<span class="g g-Whitespace">   </span><span class="mi">3521</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_process_unit_info</span><span class="p">([(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">))],</span> <span class="n">convert</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">3522</span>         <span class="n">left</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_converted_limits</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_xunits</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3523</span>         <span class="n">right</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_converted_limits</span><span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_xunits</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3524</span> 

<span class="nn">~/opt/anaconda3/envs/pmagpy_env/lib/python3.9/site-packages/matplotlib/axes/_base.py</span> in <span class="ni">_validate_converted_limits</span><span class="nt">(self, limit, convert)</span>
<span class="g g-Whitespace">   </span><span class="mi">3437</span>             <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">converted_limit</span><span class="p">,</span> <span class="n">Real</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3438</span>                     <span class="ow">and</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">converted_limit</span><span class="p">)):</span>
<span class="ne">-&gt; </span><span class="mi">3439</span>                 <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Axis limits cannot be NaN or Inf&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3440</span>             <span class="k">return</span> <span class="n">converted_limit</span>
<span class="g g-Whitespace">   </span><span class="mi">3441</span> 

<span class="ne">ValueError</span>: Axis limits cannot be NaN or Inf
</pre></div>
</div>
<img alt="../_images/824b33d2f58bdcfcdd71f50a408edcb3e79587528a4ac9caf4b909eb8a055231.png" src="../_images/824b33d2f58bdcfcdd71f50a408edcb3e79587528a4ac9caf4b909eb8a055231.png" />
</div>
</div>
</section>
<section id="aniso-magic">
<h2>aniso_magic<a class="headerlink" href="#aniso-magic" title="Permalink to this heading">#</a></h2>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch13.html#x15-15600013">[Essentials Chapter 13]</a> <a class="reference external" href="https://earthref.org/MagIC">[MagIC Database]</a> <a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#aniso_magic.py">[command line version]</a></p>
<p>Samples were collected from the eastern margin a dike oriented with a bedding pole declination of 110∘ and dip of 2∘. The data have been imported into a MagIC (data model 3) formatted file named dike_specimens.txt.</p>
<p>We will make a plot of the data using <strong>ipmag.aniso_magic()</strong>, using the site parametric bootstrap option and plot out the bootstrapped eigenvectors. We will also draw on the trace of the dike.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">ipmag</span><span class="o">.</span><span class="n">aniso_magic</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function aniso_magic in module pmagpy.ipmag:

aniso_magic(infile=&#39;specimens.txt&#39;, samp_file=&#39;samples.txt&#39;, site_file=&#39;sites.txt&#39;, verbose=True, ipar=False, ihext=True, ivec=False, isite=False, iloc=False, iboot=False, vec=0, Dir=[], PDir=[], crd=&#39;s&#39;, num_bootstraps=1000, dir_path=&#39;.&#39;, fignum=1, save_plots=True, interactive=False, fmt=&#39;png&#39;, contribution=None, image_records=False)
    Makes plots of anisotropy eigenvectors, eigenvalues and confidence bounds
    All directions are on the lower hemisphere.
    
    Parameters
    __________
        infile : specimens formatted file with aniso_s data
        samp_file : samples formatted file with sample =&gt; site relationship
        site_file : sites formatted file with site =&gt; location relationship
        verbose : if True, print messages to output
        confidence bounds options:
            ipar : if True - perform parametric bootstrap - requires non-blank aniso_s_sigma
            ihext : if True - Hext ellipses
            ivec : if True - plot bootstrapped eigenvectors instead of ellipses
            isite : if True plot by site, requires non-blank samp_file
            #iloc : if True plot by location, requires non-blank samp_file, and site_file  NOT IMPLEMENTED
            iboot : if True - bootstrap ellipses
        vec : eigenvector for comparison with Dir
        Dir : [Dec,Inc] list for comparison direction
        PDir : [Pole_dec, Pole_Inc] for pole to plane for comparison
              green dots are on the lower hemisphere, cyan are on the upper hemisphere
        crd : [&#39;s&#39;,&#39;g&#39;,&#39;t&#39;], coordinate system for plotting whereby:
            s : specimen coordinates, aniso_tile_correction = -1, or unspecified
            g : geographic coordinates, aniso_tile_correction = 0
            t : tilt corrected coordinates, aniso_tile_correction = 100
        num_bootstraps : how many bootstraps to do, default 1000
        dir_path : directory path
        fignum : matplotlib figure number, default 1
        save_plots : bool, default True
            if True, create and save all requested plots
        interactive : bool, default False
            interactively plot and display for each specimen
            (this is best used on the command line only)
        fmt : str, default &quot;svg&quot;
            format for figures, [svg, jpg, pdf, png]
        contribution : pmagpy contribution_builder.Contribution object, if not provided will be created
            in directory (default None).  (if provided, infile/samp_file/dir_path may be left blank)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ipmag</span><span class="o">.</span><span class="n">aniso_magic</span><span class="p">(</span><span class="n">infile</span><span class="o">=</span><span class="s1">&#39;dike_specimens.txt&#39;</span><span class="p">,</span><span class="n">dir_path</span><span class="o">=</span><span class="s1">&#39;data_files/aniso_magic&#39;</span><span class="p">,</span>
       <span class="n">iboot</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ihext</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ivec</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">PDir</span><span class="o">=</span><span class="p">[</span><span class="mi">120</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span><span class="n">ipar</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">save_plots</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># compare dike directions with plane of dike with pole of 120,10</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>desired coordinate system not available, using available:  g
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(True, [])
</pre></div>
</div>
<img alt="../_images/db93e4b233e85bd44397f23b4a92d6033c2a11f2a3134317119e7c858c4880e9.png" src="../_images/db93e4b233e85bd44397f23b4a92d6033c2a11f2a3134317119e7c858c4880e9.png" />
<img alt="../_images/61a68e8c75a7c2585b56b6db160878201b0102270c7204fec419eb403b4ac445.png" src="../_images/61a68e8c75a7c2585b56b6db160878201b0102270c7204fec419eb403b4ac445.png" />
<img alt="../_images/4ead4894cec69de8477ef513038d86b31e6e420cfcad70914b06c8881aa6d1e7.png" src="../_images/4ead4894cec69de8477ef513038d86b31e6e420cfcad70914b06c8881aa6d1e7.png" />
</div>
</div>
<p>The specimen eigenvectors are plotted in the top diagram with the usual convention that squares are the V<span class="math notranslate nohighlight">\(_1\)</span> directions, triangles are the V<span class="math notranslate nohighlight">\(_2\)</span> directions and circles are the V<span class="math notranslate nohighlight">\(_3\)</span> directions. All directions are plotted on the lower hemisphere. The bootstrapped eigenvectors are shown in the middle diagram. Cumulative distributions of the bootstrapped eigenvalues are shown in the bottom plot with the 95% confidence bounds plotted as vertical lines. It appears that the magma was moving in the northern and slightly up direction along the dike.</p>
<p>There are more options to <strong>ipmag.aniso_magic_nb()</strong> that come in handy. In particular, one often wishes to test if a particular fabric is isotropic (the three eigenvalues cannot be distinguished), or if a particular eigenvector is parallel to some direction. For example, undisturbed sedimentary fabrics are oblate (the maximum and intermediate directions cannot be distinguished from one another, but are distinct from the minimum) and the eigenvector associated with the minimum eigenvalue is vertical. These criteria can be tested using the distributions of bootstrapped eigenvalues and eigenvectors.</p>
<p>The following session illustrates how this is done, using the data in the test file sed_specimens.txt in the aniso_magic directory.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ipmag</span><span class="o">.</span><span class="n">aniso_magic</span><span class="p">(</span><span class="n">infile</span><span class="o">=</span><span class="s1">&#39;sed_specimens.txt&#39;</span><span class="p">,</span><span class="n">dir_path</span><span class="o">=</span><span class="s1">&#39;data_files/aniso_magic&#39;</span><span class="p">,</span>
       <span class="n">iboot</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ihext</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ivec</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">Dir</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">90</span><span class="p">],</span><span class="n">vec</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">ipar</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">save_plots</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># parametric bootstrap and compare V3 with vertical</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>desired coordinate system not available, using available:  g
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(True, [])
</pre></div>
</div>
<img alt="../_images/d074ea5762b38961f232906b4054c928873121e99fbb2a147e532f7c52949690.png" src="../_images/d074ea5762b38961f232906b4054c928873121e99fbb2a147e532f7c52949690.png" />
<img alt="../_images/d906f908d5704b6c70b7790ae3e799aa29ea9ef157ff2aaba1616a86d408cfa0.png" src="../_images/d906f908d5704b6c70b7790ae3e799aa29ea9ef157ff2aaba1616a86d408cfa0.png" />
<img alt="../_images/597a297be0a33b1a607d8df10a89d2e7f589c6a61839d9c323145104d929d0ff.png" src="../_images/597a297be0a33b1a607d8df10a89d2e7f589c6a61839d9c323145104d929d0ff.png" />
<img alt="../_images/e6851c6c038f477578946d7e0cc160b3cdefb799885621e96726ffdf9771e84b.png" src="../_images/e6851c6c038f477578946d7e0cc160b3cdefb799885621e96726ffdf9771e84b.png" />
<img alt="../_images/40dedee02ab04d88c349ee8f39e35457cdc06eaaba69c18e2b3a32a9e81037f7.png" src="../_images/40dedee02ab04d88c349ee8f39e35457cdc06eaaba69c18e2b3a32a9e81037f7.png" />
<img alt="../_images/e0da3fa2986620f0bb733f683ad64ef5c5f3d015a1d53cae171f1336b3940bf5.png" src="../_images/e0da3fa2986620f0bb733f683ad64ef5c5f3d015a1d53cae171f1336b3940bf5.png" />
</div>
</div>
<p>The top three plots are as in the dike example before, showing a clear triaxial fabric (all three eigenvalues and associated eigenvectors are distinct from one another. In the lower three plots we have the distributions of the three components of the chosen axis, V<span class="math notranslate nohighlight">\(_3\)</span>, their 95% confidence bounds (dash lines) and the components of the designated direction (solid line). This direction is also shown in the equal area projection above as a red pentagon. The minimum eigenvector is not vertical in this case.</p>
</section>
<section id="biplot-magic">
<h2>biplot_magic<a class="headerlink" href="#biplot-magic" title="Permalink to this heading">#</a></h2>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch8.html#x15-1560008">[Essentials Chapter 8]</a> <a class="reference external" href="https://earthref.org/MagIC">[MagIC Database]</a>  <a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#biplot_magic.py">[command line version]</a></p>
<p>It is often useful to plot measurements from one experiement against another. For example, rock magnetic studies of sediments often plot the IRM against the ARM or magnetic susceptibility. All of these types of measurements can be imported into a single measurements formatted file and use the MagIC method codes and other clues (lab fields, etc.) to differentiate one measurement from another.</p>
<p>Data were obtained by Hartl and Tauxe (1997, doi: 10.1111/j.1365-246X.1997.tb04082.x) from a Paleogene core from 28<span class="math notranslate nohighlight">\(^{\circ}\)</span> S (DSDP Site 522) and used for a relative paleointensity study. IRM, ARM, magnetic susceptibility and remanence data were uploaded to the MagIC database. The MagIC measurements formatted file for this study (which you can get from   <a class="reference external" href="https://earthref.org/MagIC/doi/10.1111/j.1365-246X.1997.tb04082.x">https://earthref.org/MagIC/doi/10.1111/j.1365-246X.1997.tb04082.x</a> and unpack with <span class="xref myst">download_magic</span>  is saved in data_files/biplot_magic/measurements.txt.</p>
<p>We can create these plots using Pandas.  The key to what the measurements mean is in the <a class="reference external" href="https://www2.earthref.org/MagIC/method-codes">Magic method codes</a>, so we can first get a unique list of all the available method_codes, then plot the ones we are interested in  against each other.  Let’s read in the data file in to a <strong>Pandas</strong> DataFrame and exctract the method codes to see what we have:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># read in the data</span>
<span class="n">meas_df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data_files/biplot_magic/measurements.txt&#39;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># get the method_codes and print</span>
<span class="nb">print</span><span class="p">(</span><span class="n">meas_df</span><span class="o">.</span><span class="n">method_codes</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
<span class="c1"># take a look at the top part of the measurements data frame</span>
<span class="n">meas_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;LT-AF-Z&#39; &#39;LT-AF-I&#39; &#39;LT-IRM&#39; &#39;LP-X&#39;]
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>citations</th>
      <th>dir_dec</th>
      <th>dir_inc</th>
      <th>experiment</th>
      <th>magn_mass</th>
      <th>meas_temp</th>
      <th>measurement</th>
      <th>method_codes</th>
      <th>quality</th>
      <th>specimen</th>
      <th>standard</th>
      <th>susc_chi_mass</th>
      <th>treat_ac_field</th>
      <th>treat_dc_field</th>
      <th>treat_step_num</th>
      <th>treat_temp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>This study</td>
      <td>268.5</td>
      <td>-41.2</td>
      <td>15-1-013:LP-AF-DIR</td>
      <td>0.000003</td>
      <td>300</td>
      <td>15-1-013:LP-AF-DIR-1</td>
      <td>LT-AF-Z</td>
      <td>g</td>
      <td>15-1-013</td>
      <td>u</td>
      <td>NaN</td>
      <td>0.015</td>
      <td>0.00000</td>
      <td>1.0</td>
      <td>300</td>
    </tr>
    <tr>
      <th>1</th>
      <td>This study</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>15-1-013:LP-ARM</td>
      <td>0.000179</td>
      <td>300</td>
      <td>15-1-013:LP-ARM-2</td>
      <td>LT-AF-I</td>
      <td>g</td>
      <td>15-1-013</td>
      <td>u</td>
      <td>NaN</td>
      <td>0.080</td>
      <td>0.00005</td>
      <td>2.0</td>
      <td>300</td>
    </tr>
    <tr>
      <th>2</th>
      <td>This study</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>15-1-013:LP-IRM</td>
      <td>0.003600</td>
      <td>300</td>
      <td>15-1-013:LP-IRM-3</td>
      <td>LT-IRM</td>
      <td>g</td>
      <td>15-1-013</td>
      <td>u</td>
      <td>NaN</td>
      <td>0.000</td>
      <td>1.00000</td>
      <td>3.0</td>
      <td>300</td>
    </tr>
    <tr>
      <th>3</th>
      <td>This study</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>15-1-013:LP-X</td>
      <td>NaN</td>
      <td>300</td>
      <td>15-1-013:LP-X-4</td>
      <td>LP-X</td>
      <td>NaN</td>
      <td>15-1-013</td>
      <td>NaN</td>
      <td>2.380000e-07</td>
      <td>0.010</td>
      <td>0.00000</td>
      <td>4.0</td>
      <td>300</td>
    </tr>
    <tr>
      <th>4</th>
      <td>This study</td>
      <td>181.0</td>
      <td>68.6</td>
      <td>15-1-022:LP-AF-DIR</td>
      <td>0.000011</td>
      <td>300</td>
      <td>15-1-022:LP-AF-DIR-5</td>
      <td>LT-AF-Z</td>
      <td>g</td>
      <td>15-1-022</td>
      <td>u</td>
      <td>NaN</td>
      <td>0.015</td>
      <td>0.00000</td>
      <td>5.0</td>
      <td>300</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>These are: an AF demag step (LT-AF-Z), an ARM (LT-AF-I), an IRM  (LT-IRM) and a susceptibility (LP-X).  Now we can fish out data for each method, merge them by specimen, dropping any missing measurements and finally plot one against the other.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># get the IRM data</span>
<span class="n">IRM</span><span class="o">=</span><span class="n">meas_df</span><span class="p">[</span><span class="n">meas_df</span><span class="o">.</span><span class="n">method_codes</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;LT-IRM&#39;</span><span class="p">)]</span>
<span class="n">IRM</span><span class="o">=</span><span class="n">IRM</span><span class="p">[[</span><span class="s1">&#39;specimen&#39;</span><span class="p">,</span><span class="s1">&#39;magn_mass&#39;</span><span class="p">]]</span> <span class="c1">#trim the data frame</span>
<span class="n">IRM</span><span class="o">.</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;specimen&#39;</span><span class="p">,</span><span class="s1">&#39;IRM&#39;</span><span class="p">]</span> <span class="c1"># rename the column</span>
<span class="c1"># do the same for the ARM data</span>
<span class="n">ARM</span><span class="o">=</span><span class="n">meas_df</span><span class="p">[</span><span class="n">meas_df</span><span class="o">.</span><span class="n">method_codes</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;LT-AF-I&#39;</span><span class="p">)]</span>
<span class="n">ARM</span><span class="o">=</span><span class="n">ARM</span><span class="p">[[</span><span class="s1">&#39;specimen&#39;</span><span class="p">,</span><span class="s1">&#39;magn_mass&#39;</span><span class="p">]]</span>
<span class="n">ARM</span><span class="o">.</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;specimen&#39;</span><span class="p">,</span><span class="s1">&#39;ARM&#39;</span><span class="p">]</span>
<span class="c1"># and the magnetic susceptibility</span>
<span class="n">CHI</span><span class="o">=</span><span class="n">meas_df</span><span class="p">[</span><span class="n">meas_df</span><span class="o">.</span><span class="n">method_codes</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;LP-X&#39;</span><span class="p">)]</span>
<span class="n">CHI</span><span class="o">=</span><span class="n">CHI</span><span class="p">[[</span><span class="s1">&#39;specimen&#39;</span><span class="p">,</span><span class="s1">&#39;susc_chi_mass&#39;</span><span class="p">]]</span>  
<span class="n">CHI</span><span class="o">.</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;specimen&#39;</span><span class="p">,</span><span class="s1">&#39;CHI&#39;</span><span class="p">]</span>
<span class="c1"># merge IRM ARM data by specimen</span>
<span class="n">RMRMs</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">IRM</span><span class="p">,</span><span class="n">ARM</span><span class="p">,</span><span class="n">on</span><span class="o">=</span><span class="s1">&#39;specimen&#39;</span><span class="p">)</span>
<span class="c1"># add on the susceptility data</span>
<span class="n">RMRMs</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">RMRMs</span><span class="p">,</span><span class="n">CHI</span><span class="p">,</span><span class="n">on</span><span class="o">=</span><span class="s1">&#39;specimen&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now we are ready to make the plots.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span> <span class="c1"># make a figure</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">131</span><span class="p">)</span> <span class="c1"># make the first in a row of three subplots </span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">RMRMs</span><span class="o">.</span><span class="n">IRM</span><span class="p">,</span><span class="n">RMRMs</span><span class="o">.</span><span class="n">ARM</span><span class="p">,</span><span class="s1">&#39;ro&#39;</span><span class="p">,</span><span class="n">markeredgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;IRM (Am$^2$/kg)&#39;</span><span class="p">)</span> <span class="c1"># label the X axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;ARM (Am$^2$/kg)&#39;</span><span class="p">)</span> <span class="c1"># and the Y axis</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">132</span><span class="p">)</span><span class="c1"># make the second in a row of three subplots </span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">RMRMs</span><span class="o">.</span><span class="n">IRM</span><span class="p">,</span><span class="n">RMRMs</span><span class="o">.</span><span class="n">CHI</span><span class="p">,</span><span class="s1">&#39;ro&#39;</span><span class="p">,</span><span class="n">markeredgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;IRM (Am$^2$/kg)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$\chi$ (m$^3$/kg)&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">133</span><span class="p">)</span><span class="c1"># and the third in a row of three subplots </span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">RMRMs</span><span class="o">.</span><span class="n">ARM</span><span class="p">,</span><span class="n">RMRMs</span><span class="o">.</span><span class="n">CHI</span><span class="p">,</span><span class="s1">&#39;ro&#39;</span><span class="p">,</span><span class="n">markeredgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$\chi$ (m$^3$/kg)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;IRM (Am$^2$/kg)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/5e1914344ec94cf9f3494aa81719b13d7452a9294043b6b2303f633a3dbb463b.png" src="../_images/5e1914344ec94cf9f3494aa81719b13d7452a9294043b6b2303f633a3dbb463b.png" />
</div>
</div>
</section>
<section id="chi-magic">
<h2>chi_magic<a class="headerlink" href="#chi-magic" title="Permalink to this heading">#</a></h2>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch8.html#x15-1560008">[Essentials Chapter 8]</a> <a class="reference external" href="https://earthref.org/MagIC">[MagIC Database]</a>  <a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#chi_magic.py">[command line version]</a></p>
<p>It is sometimes useful to measure susceptibility as a function of temperature, applied field and frequency. Here we use a data set that came from the Tiva Canyon Tuff sequence (see Jackson et al., 2006, doi: 10.1029/2006JB004514).</p>
<p><strong>chi_magic</strong> reads in a MagIC formatted file and makes various plots.  We do this using Pandas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># with ipmag</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">chi_magic</span><span class="p">(</span><span class="s1">&#39;data_files/chi_magic/measurements.txt&#39;</span><span class="p">,</span> <span class="n">save_plots</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Not enough data to plot IRM-Kappa-2352
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(True, [])
</pre></div>
</div>
<img alt="../_images/07172430c05cc878b8ea6704a118c8b73db4e042780cc5a6fd9800a00ae2df6d.png" src="../_images/07172430c05cc878b8ea6704a118c8b73db4e042780cc5a6fd9800a00ae2df6d.png" />
<img alt="../_images/bfca5c4462a3401e344bf1ef249b5b2461a0fa7faa9c3b55eb807537508f39c0.png" src="../_images/bfca5c4462a3401e344bf1ef249b5b2461a0fa7faa9c3b55eb807537508f39c0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># read in data from data model 3 example file using pandas</span>
<span class="n">chi_data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data_files/chi_magic/measurements.txt&#39;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">chi_data</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="c1"># get arrays of available temps, frequencies and fields</span>
<span class="n">Ts</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">chi_data</span><span class="o">.</span><span class="n">meas_temp</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
<span class="n">Fs</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">chi_data</span><span class="o">.</span><span class="n">meas_freq</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
<span class="n">Bs</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">chi_data</span><span class="o">.</span><span class="n">meas_field_ac</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;experiment&#39;, &#39;specimen&#39;, &#39;measurement&#39;, &#39;treat_step_num&#39;, &#39;citations&#39;,
       &#39;instrument_codes&#39;, &#39;method_codes&#39;, &#39;meas_field_ac&#39;, &#39;meas_freq&#39;,
       &#39;meas_temp&#39;, &#39;timestamp&#39;, &#39;susc_chi_qdr_volume&#39;, &#39;susc_chi_volume&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot chi versus temperature at constant field</span>
<span class="n">b</span><span class="o">=</span><span class="n">Bs</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">Fs</span><span class="p">:</span>
    <span class="n">this_f</span><span class="o">=</span><span class="n">chi_data</span><span class="p">[</span><span class="n">chi_data</span><span class="o">.</span><span class="n">meas_freq</span><span class="o">==</span><span class="n">f</span><span class="p">]</span>
    <span class="n">this_f</span><span class="o">=</span><span class="n">this_f</span><span class="p">[</span><span class="n">this_f</span><span class="o">.</span><span class="n">meas_field_ac</span><span class="o">==</span><span class="n">b</span><span class="p">]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">this_f</span><span class="o">.</span><span class="n">meas_temp</span><span class="p">,</span><span class="mf">1e6</span><span class="o">*</span><span class="n">this_f</span><span class="o">.</span><span class="n">susc_chi_volume</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%i</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; Hz&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Temperature (K)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$\chi$ ($\mu$SI)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;B = &#39;</span><span class="o">+</span><span class="s1">&#39;</span><span class="si">%7.2e</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">+</span> <span class="s1">&#39; T&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5,1,&#39;B = 3.00e-04 T&#39;)
</pre></div>
</div>
<img alt="../_images/f49611c2883f1d9d0a79a0042afc94c3703032235826cf0e3f77af73d45c80fe.png" src="../_images/f49611c2883f1d9d0a79a0042afc94c3703032235826cf0e3f77af73d45c80fe.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot chi versus frequency at constant B</span>
<span class="n">b</span><span class="o">=</span><span class="n">Bs</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="n">t</span><span class="o">=</span><span class="n">Ts</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="n">this_t</span><span class="o">=</span><span class="n">chi_data</span><span class="p">[</span><span class="n">chi_data</span><span class="o">.</span><span class="n">meas_temp</span><span class="o">==</span><span class="n">t</span><span class="p">]</span>
<span class="n">this_t</span><span class="o">=</span><span class="n">this_t</span><span class="p">[</span><span class="n">this_t</span><span class="o">.</span><span class="n">meas_field_ac</span><span class="o">==</span><span class="n">b</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">this_t</span><span class="o">.</span><span class="n">meas_freq</span><span class="p">,</span><span class="mf">1e6</span><span class="o">*</span><span class="n">this_t</span><span class="o">.</span><span class="n">susc_chi_volume</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%i</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; K&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$\chi$ ($\mu$SI)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;B = &#39;</span><span class="o">+</span><span class="s1">&#39;</span><span class="si">%7.2e</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">+</span> <span class="s1">&#39; T&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5,1,&#39;B = 3.00e-04 T&#39;)
</pre></div>
</div>
<img alt="../_images/da4dde0a5b044db932f7590dc976237d4c347b2aed7a44155570cd12195ad6f8.png" src="../_images/da4dde0a5b044db932f7590dc976237d4c347b2aed7a44155570cd12195ad6f8.png" />
</div>
</div>
<p>You can see the dependence on temperature, frequency and applied field. These data support the suggestion that there is a strong superparamagnetic component in these specimens.</p>
</section>
<section id="common-mean">
<h2>common_mean<a class="headerlink" href="#common-mean" title="Permalink to this heading">#</a></h2>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch12.html#x15-15600012">[Essentials Chapter 12]</a>  <a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#common_mean.py">[command line version]</a></p>
<p>Most paleomagnetists use some form of Fisher Statistics to decide if two directions are statistically distinct or not (see <a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch11.html#x15-15600011">Essentials Chapter 11</a> for a discussion of those techniques). But often directional data are not Fisher distributed and the parametric approach will give misleading answers. In these cases, one can use a boostrap approach, described in detail in [Essentials Chapter 12]. The program <strong>common_mean</strong> can be used for a bootstrap test for common mean to check whether two declination, inclination data sets have a common mean at the 95% level of confidence.</p>
<p>We want to compare the two data sets: common_mean_ex_file1.dat and common_mean_ex_file2.dat. But first, let’s look at the data in equal area projection using the methods outline in the section on <span class="xref myst">eqarea</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">directions_A</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;data_files/common_mean/common_mean_ex_file1.dat&#39;</span><span class="p">)</span>
<span class="n">directions_B</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;data_files/common_mean/common_mean_ex_file2.dat&#39;</span><span class="p">)</span> 
<span class="n">ipmag</span><span class="o">.</span><span class="n">plot_net</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">plot_di</span><span class="p">(</span><span class="n">di_block</span><span class="o">=</span><span class="n">directions_A</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">plot_di</span><span class="p">(</span><span class="n">di_block</span><span class="o">=</span><span class="n">directions_B</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3fac77a0c5e1318213b3225182eb669723e863940a7ed161d726a469f615eb74.png" src="../_images/3fac77a0c5e1318213b3225182eb669723e863940a7ed161d726a469f615eb74.png" />
</div>
</div>
<p>Now let’s look at the common mean problem using <strong>ipmag.common_mean_bootstrap()</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">ipmag</span><span class="o">.</span><span class="n">common_mean_bootstrap</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function common_mean_bootstrap in module pmagpy.ipmag:

common_mean_bootstrap(Data1, Data2, NumSims=1000, save=False, save_folder=&#39;.&#39;, fmt=&#39;svg&#39;, figsize=(7, 2.3), x_tick_bins=4)
    Conduct a bootstrap test (Tauxe, 2010) for a common mean on two declination,
    inclination data sets. Plots are generated of the cumulative distributions
    of the Cartesian coordinates of the means of the pseudo-samples (one for x,
    one for y and one for z). If the 95 percent confidence bounds for each
    component overlap, the two directions are not significantly different.
    
    Parameters
    ----------
    Data1 : a nested list of directional data [dec,inc] (a di_block)
    Data2 : a nested list of directional data [dec,inc] (a di_block)
            if Data2 is length of 1, treat as single direction
    NumSims : number of bootstrap samples (default is 1000)
    save : optional save of plots (default is False)
    save_folder : path to directory where plots should be saved
    fmt : format of figures to be saved (default is &#39;svg&#39;)
    figsize : optionally adjust figure size (default is (7, 2.3))
    x_tick_bins : because they occasionally overlap depending on the data, this
        argument allows you adjust number of tick marks on the x axis of graphs
        (default is 4)
    
    Returns
    -------
    three plots : cumulative distributions of the X, Y, Z of bootstrapped means
    
    Examples
    --------
    Develop two populations of directions using ``ipmag.fishrot``. Use the
    function to determine if they share a common mean (through visual inspection
    of resulting plots).
    
    &gt;&gt;&gt; directions_A = ipmag.fishrot(k=20, n=30, dec=40, inc=60)
    &gt;&gt;&gt; directions_B = ipmag.fishrot(k=35, n=25, dec=42, inc=57)
    &gt;&gt;&gt; ipmag.common_mean_bootstrap(directions_A, directions_B)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ipmag</span><span class="o">.</span><span class="n">common_mean_bootstrap</span><span class="p">(</span><span class="n">directions_A</span><span class="p">,</span><span class="n">directions_B</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ab3b6e8658ca3ae5b0af5abdf16e79b390f5ebdbac6b23a2fbd2f4e0f5e5c7c5.png" src="../_images/ab3b6e8658ca3ae5b0af5abdf16e79b390f5ebdbac6b23a2fbd2f4e0f5e5c7c5.png" />
</div>
</div>
<p>These plots suggest that the two data sets share a common mean.</p>
<p>Now compare the data in common_mean_ex_file1.dat with the expected direction at the 5<span class="math notranslate nohighlight">\(^{\circ}\)</span> N latitude that these data were collected (Dec=0, Inc=9.9).</p>
<p>To do this, we set the second data set to be the desired direction for comparison.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">comp_dir</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mf">9.9</span><span class="p">]</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">common_mean_bootstrap</span><span class="p">(</span><span class="n">directions_A</span><span class="p">,</span><span class="n">comp_dir</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/a97263ec54a3e46f9009a0e17eb6f9ba00d5c4c573a5b01c947844325333ae31.png" src="../_images/a97263ec54a3e46f9009a0e17eb6f9ba00d5c4c573a5b01c947844325333ae31.png" />
</div>
</div>
<p>Apparently the data (cumulative distribution functions) are entirely consistent with the expected direction (dashed lines are the cartesian coordinates of that).</p>
</section>
<section id="cont-rot">
<h2>cont_rot<a class="headerlink" href="#cont-rot" title="Permalink to this heading">#</a></h2>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch16.html#x15-15600016">[Essentials Chapter 16]</a>  <a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#cont_rot.py">[command line version]</a></p>
<p>We can  make an orthographic projection with latitude = -20<span class="math notranslate nohighlight">\(^{\circ}\)</span> and longitude = 0<span class="math notranslate nohighlight">\(^{\circ}\)</span> at the center of the African and South American continents reconstructed to 180 Ma using the Torsvik et al. (2008, doi: 10.1029/2007RG000227) poles of finite rotation. We would do this by first holding Africa fixed.</p>
<p>We need to read in in the outlines of continents from <strong>continents.get_cont()</strong>, rotate them around a rotation pole and angle as specified by the age  and continent in question (from <strong>frp.get_pole()</strong> using <strong>pmag.pt_rot()</strong>.  Then we can plot them using <strong>pmagplotlib.plot_map()</strong>.  If the Basemap version is preferred, use <strong>pmagplotlib.plot_map_basemap()</strong>.
Here we demonstrate this from within  the notebook by just calling the  PmagPy  functions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># load in the continents module</span>
<span class="kn">import</span> <span class="nn">pmagpy.continents</span> <span class="k">as</span> <span class="nn">continents</span>
<span class="kn">import</span> <span class="nn">pmagpy.frp</span> <span class="k">as</span> <span class="nn">frp</span>
<span class="n">help</span><span class="p">(</span><span class="n">continents</span><span class="o">.</span><span class="n">get_continent</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function get_continent in module pmagpy.continents:

get_continent(continent)
    get_continent(continent)
    returns the outlines of specified continent.
    
    Parameters:
    ____________________
    continent:
        af : Africa
        congo : Congo
        kala : Kalahari
        aus : Australia
        balt : Baltica
        eur : Eurasia
        ind : India
        sam : South America
        ant : Antarctica
        grn : Greenland
        lau : Laurentia
        nam : North America
        gond : Gondawanaland
    Returns : 
        array of [lat/long] points defining continent
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pmagplotlib</span><span class="o">.</span><span class="n">plot_map</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function plot_map in module pmagpy.pmagplotlib:

plot_map(fignum, lats, lons, Opts)
    makes a cartopy map  with lats/lons
    Requires installation of cartopy
    
    Parameters:
    _______________
    fignum : matplotlib figure number
    lats : array or list of latitudes
    lons : array or list of longitudes
    Opts : dictionary of plotting options:
        Opts.keys=
            proj : projection [supported cartopy projections:
                pc = Plate Carree
                aea = Albers Equal Area
                aeqd = Azimuthal Equidistant
                lcc = Lambert Conformal
                lcyl = Lambert Cylindrical
                merc = Mercator
                mill = Miller Cylindrical
                moll = Mollweide [default]
                ortho = Orthographic
                robin = Robinson
                sinu = Sinusoidal
                stere = Stereographic
                tmerc = Transverse Mercator
                utm = UTM [set zone and south keys in Opts]
                laea = Lambert Azimuthal Equal Area
                geos = Geostationary
                npstere = North-Polar Stereographic
                spstere = South-Polar Stereographic
            latmin : minimum latitude for plot
            latmax : maximum latitude for plot
            lonmin : minimum longitude for plot
            lonmax : maximum longitude
            lat_0 : central latitude
            lon_0 : central longitude
            sym : matplotlib symbol
            symsize : symbol size in pts
            edge : markeredgecolor
            cmap : matplotlib color map
            res :  resolution [c,l,i,h] for low/crude, intermediate, high
            boundinglat : bounding latitude
            sym : matplotlib symbol for plotting
            symsize : matplotlib symbol size for plotting
            names : list of names for lats/lons (if empty, none will be plotted)
            pltgrd : if True, put on grid lines
            padlat : padding of latitudes
            padlon : padding of longitudes
            gridspace : grid line spacing
            global : global projection [default is True]
            oceancolor : &#39;azure&#39;
            landcolor : &#39;bisque&#39; [choose any of the valid color names for matplotlib
              see https://matplotlib.org/examples/color/named_colors.html
            details : dictionary with keys:
                coasts : if True, plot coastlines
                rivers : if True, plot rivers
                states : if True, plot states
                countries : if True, plot countries
                ocean : if True, plot ocean
                fancy : if True, plot etopo 20 grid
                    NB:  etopo must be installed
        if Opts keys not set :these are the defaults:
           Opts={&#39;latmin&#39;:-90,&#39;latmax&#39;:90,&#39;lonmin&#39;:0,&#39;lonmax&#39;:360,&#39;lat_0&#39;:0,&#39;lon_0&#39;:0,&#39;proj&#39;:&#39;moll&#39;,&#39;sym&#39;:&#39;ro,&#39;symsize&#39;:5,&#39;edge&#39;:&#39;black&#39;,&#39;pltgrid&#39;:1,&#39;res&#39;:&#39;c&#39;,&#39;boundinglat&#39;:0.,&#39;padlon&#39;:0,&#39;padlat&#39;:0,&#39;gridspace&#39;:30,&#39;details&#39;:all False,&#39;edge&#39;:None,&#39;cmap&#39;:&#39;jet&#39;,&#39;fancy&#39;:0,&#39;zone&#39;:&#39;&#39;,&#39;south&#39;:False,&#39;oceancolor&#39;:&#39;azure&#39;,&#39;landcolor&#39;:&#39;bisque&#39;}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># retrieve continental outline</span>
<span class="c1"># This is the version that uses cartopy and requires installation of cartopy</span>
<span class="n">af</span><span class="o">=</span><span class="n">continents</span><span class="o">.</span><span class="n">get_continent</span><span class="p">(</span><span class="s1">&#39;af&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="n">sam</span><span class="o">=</span><span class="n">continents</span><span class="o">.</span><span class="n">get_continent</span><span class="p">(</span><span class="s1">&#39;sam&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>


<span class="c1">#define options for pmagplotlib.plot_map</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">Opts</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;latmin&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="s1">&#39;latmax&#39;</span><span class="p">:</span> <span class="mi">90</span><span class="p">,</span> <span class="s1">&#39;lonmin&#39;</span><span class="p">:</span> <span class="mf">0.</span><span class="p">,</span> <span class="s1">&#39;lonmax&#39;</span><span class="p">:</span> <span class="mf">360.</span><span class="p">,</span> <span class="s1">&#39;lat_0&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">20</span><span class="p">,</span> \
            <span class="s1">&#39;lon_0&#39;</span><span class="p">:</span> <span class="mi">345</span><span class="p">,</span><span class="s1">&#39;proj&#39;</span><span class="p">:</span> <span class="s1">&#39;ortho&#39;</span><span class="p">,</span> <span class="s1">&#39;sym&#39;</span><span class="p">:</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="s1">&#39;symsize&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>\
            <span class="s1">&#39;pltgrid&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;res&#39;</span><span class="p">:</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;boundinglat&#39;</span><span class="p">:</span> <span class="mf">0.</span><span class="p">}</span>
<span class="k">if</span> <span class="n">has_cartopy</span><span class="p">:</span>
    <span class="n">pmagplotlib</span><span class="o">.</span><span class="n">plot_map</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">af</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">af</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">Opts</span><span class="p">)</span>
    <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;sym&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;b-&#39;</span>
    <span class="n">pmagplotlib</span><span class="o">.</span><span class="n">plot_map</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">sam</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">sam</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">Opts</span><span class="p">)</span>
<span class="k">elif</span> <span class="n">has_basemap</span><span class="p">:</span>
    <span class="n">pmagplotlib</span><span class="o">.</span><span class="n">plot_map_basemap</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">af</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">af</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">Opts</span><span class="p">)</span>
    <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;sym&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;b-&#39;</span>
    <span class="n">pmagplotlib</span><span class="o">.</span><span class="n">plot_map_basemap</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">sam</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">sam</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">Opts</span><span class="p">)</span>
    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/97e7e1f1b4361ad22749c3bbbffbd91f21fce59898c66f94750786201de5635f.png" src="../_images/97e7e1f1b4361ad22749c3bbbffbd91f21fce59898c66f94750786201de5635f.png" />
</div>
</div>
<p>Now for the rotation part.  These are in a function called <strong>frp.get_pole()</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">frp</span><span class="o">.</span><span class="n">get_pole</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function get_pole in module pmagpy.frp:

get_pole(continent, age)
    returns rotation poles and angles for specified continents and ages
    assumes fixed Africa.  
    Parameters
    __________
        continent : 
            aus : Australia
            eur : Eurasia
            mad : Madacascar
            [nwaf,congo] : NW Africa  [choose one]
            col :  Colombia
            grn : Greenland
            nam : North America
            par : Paraguay
            eant :  East Antarctica
            ind : India
            [neaf,kala] : NE Africa [choose one]
            [sac,sam] :  South America [choose one]
            ib : Iberia
            saf : South Africa
      Returns
      _______
          [pole longitude, pole latitude, rotation angle] : for the continent at specified age
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># get the rotation pole for south america relative to South Africa at 180 Ma</span>
<span class="n">sam_pole</span><span class="o">=</span><span class="n">frp</span><span class="o">.</span><span class="n">get_pole</span><span class="p">(</span><span class="s1">&#39;sam&#39;</span><span class="p">,</span><span class="mi">180</span><span class="p">)</span>
<span class="c1"># NB: for african rotations, first rotate other continents to fixed Africa, then </span>
<span class="c1"># rotate with South African pole (saf)</span>
</pre></div>
</div>
</div>
</div>
<p>The rotation is done by <strong>pmag.pt_rot()</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">pt_rot</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function pt_rot in module pmagpy.pmag:

pt_rot(EP, Lats, Lons)
    Rotates points on a globe by an Euler pole rotation using method of
    Cox and Hart 1986, box 7-3.
    
    Parameters
    ----------
    EP : Euler pole list [lat,lon,angle]
    Lats : list of latitudes of points to be rotated
    Lons : list of longitudes of points to be rotated
    
    Returns
    _________
    RLats : rotated latitudes
    RLons : rotated longitudes
</pre></div>
</div>
</div>
</div>
<p>so here we go…</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">sam_rot</span><span class="o">=</span><span class="n">pmag</span><span class="o">.</span><span class="n">pt_rot</span><span class="p">(</span><span class="n">sam_pole</span><span class="p">,</span><span class="n">sam</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">sam</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="c1"># same for south america</span>
<span class="c1"># and plot &#39;em</span>
<span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;sym&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;r-&#39;</span>
<span class="k">if</span> <span class="n">has_cartopy</span><span class="p">:</span>
    <span class="n">pmagplotlib</span><span class="o">.</span><span class="n">plot_map</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">af</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">af</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">Opts</span><span class="p">)</span>
    <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;sym&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;b-&#39;</span>
    <span class="n">pmagplotlib</span><span class="o">.</span><span class="n">plot_map</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">sam_rot</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">sam_rot</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">Opts</span><span class="p">)</span>
<span class="k">elif</span> <span class="n">has_basemap</span><span class="p">:</span>
    <span class="n">pmagplotlib</span><span class="o">.</span><span class="n">plot_map_basemap</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">af</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">af</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">Opts</span><span class="p">)</span>
    <span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;sym&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;b-&#39;</span>
    <span class="n">pmagplotlib</span><span class="o">.</span><span class="n">plot_map_basemap</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">sam_rot</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">sam_rot</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">Opts</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/222b40970c26e03977e189950092dccff7243fb2862a6f93c6500a176f5836ad.png" src="../_images/222b40970c26e03977e189950092dccff7243fb2862a6f93c6500a176f5836ad.png" />
</div>
</div>
</section>
<section id="core-depthplot">
<h2>core_depthplot<a class="headerlink" href="#core-depthplot" title="Permalink to this heading">#</a></h2>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch15.html#x15-15600015">[Essentials Chapter 15]</a>  <a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#core_depthplot.py">[command line version]</a></p>
<p>The program <strong>core_depthplot</strong> can be used to plot various measurement data versus sample depth. The data must be in the MagIC data format. The program will plot whole core data, discrete sample at a bulk demagnetization step, data from vector demagnetization experiments, and so on.</p>
<p>We can try this out on some data from DSDP Hole 522, (drilled at 26S/5W) and measured by Tauxe and Hartl (1997, doi: 10.1111/j.1365-246X.1997.tb04082.x). These were  downloaded and unpacked in the <span class="xref myst">biplot_magic</span> example. More of the data are in the directory ../data_files/core_depthplot.</p>
<p>In this example, we will plot the alternating field (AF) data after the 15 mT step. The magnetizations will be plotted on a log scale and, as this is a record of the Oligocene, we will plot the Oligocene time scale, using the calibration of Gradstein et al. (2012), commonly referred to as “GTS12” for the the Oligocene. We are only interested in the data between 50 and 150 meters  and we are not interested in the declinations here.</p>
<p>All this can be done using the wonders of Pandas data frames using the  data in the <strong>data_files/core_depthplot</strong> directory.</p>
<p>Let’s do things this way:</p>
<ul class="simple">
<li><p>read in the data from the sites and specimens files.</p></li>
<li><p>Drop the records with NaN for analysts, keeping one of the three lines available for each specimen.</p></li>
<li><p>Make a new column named <strong>site</strong> in the specdimens table that is the same as the <strong>specimen</strong> column.</p></li>
<li><p>(this makes sense because these are core data, so the specimen=sample=site. )</p></li>
<li><p>Merge the two DataFrames on the <strong>site</strong> column.</p></li>
<li><p>filter the data for depths between 50 and 150.</p></li>
<li><p>Plot <strong>dir_inc</strong> versus <strong>core_depth</strong>.</p></li>
<li><p>Put on GAD field inclination</p></li>
<li><p>plot the time scale</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">specimens</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data_files/core_depthplot/specimens.txt&#39;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">sites</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data_files/core_depthplot/sites.txt&#39;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">specimens</span><span class="o">=</span><span class="n">specimens</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;dir_inc&#39;</span><span class="p">])</span> <span class="c1"># kill unwanted lines with duplicate or irrelevent info</span>
<span class="n">specimens</span><span class="p">[</span><span class="s1">&#39;site&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">specimens</span><span class="p">[</span><span class="s1">&#39;specimen&#39;</span><span class="p">]</span> <span class="c1"># make a column with site name</span>
<span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">specimens</span><span class="p">,</span><span class="n">sites</span><span class="p">,</span><span class="n">on</span><span class="o">=</span><span class="s1">&#39;site&#39;</span><span class="p">)</span> <span class="c1"># merge the two data frames on site</span>
<span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">core_depth</span><span class="o">&gt;</span><span class="mi">50</span><span class="p">]</span> <span class="c1"># all levels &gt; 50</span>
<span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">core_depth</span><span class="o">&lt;</span><span class="mi">150</span><span class="p">]</span> <span class="c1"># and &lt; 150</span>
<span class="n">lat</span><span class="o">=</span><span class="mi">26</span> <span class="c1"># we need this for the GAD INC</span>
</pre></div>
</div>
</div>
</div>
<p>Plot versus core_depth</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,(</span><span class="mi">6</span><span class="p">,</span><span class="mi">12</span><span class="p">))</span> <span class="c1"># make the figure</span>
<span class="n">ax</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span> <span class="c1"># make the first of 2 subplots</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Depth (m)&#39;</span><span class="p">)</span> <span class="c1"># label the Y axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">dir_inc</span><span class="p">,</span><span class="n">data</span><span class="o">.</span><span class="n">core_depth</span><span class="p">,</span><span class="s1">&#39;k-&#39;</span><span class="p">)</span> <span class="c1"># draw on a black line through the data</span>
<span class="c1"># draw the data points as cyan dots with black edges</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">dir_inc</span><span class="p">,</span><span class="n">data</span><span class="o">.</span><span class="n">core_depth</span><span class="p">,</span><span class="s1">&#39;co&#39;</span><span class="p">,</span><span class="n">markeredgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Inclinations&#39;</span><span class="p">)</span> <span class="c1"># put on a title</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span><span class="c1"># make a central line at inc=0</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span> <span class="c1"># set the plot Y limits to the desired depths</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span> <span class="c1"># make the second of two subplots</span>
<span class="c1"># plot intensity data on semi-log plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">int_rel</span><span class="o">/</span><span class="n">data</span><span class="o">.</span><span class="n">int_rel</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span><span class="n">data</span><span class="o">.</span><span class="n">core_depth</span><span class="p">,</span><span class="s1">&#39;k-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">int_rel</span><span class="o">/</span><span class="n">data</span><span class="o">.</span><span class="n">int_rel</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span>\
             <span class="n">data</span><span class="o">.</span><span class="n">core_depth</span><span class="p">,</span><span class="s1">&#39;co&#39;</span><span class="p">,</span><span class="n">markeredgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Relative Intensity&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/341ce21f429204890cd355e875ddba2ad224bd0e29e109c049f12268bd77e9a2.png" src="../_images/341ce21f429204890cd355e875ddba2ad224bd0e29e109c049f12268bd77e9a2.png" />
</div>
</div>
<p>And now versus age:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,(</span><span class="mi">9</span><span class="p">,</span><span class="mi">12</span><span class="p">))</span> <span class="c1"># make the figure</span>
<span class="n">ax</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">131</span><span class="p">)</span> <span class="c1"># make the first of three subplots</span>
<span class="n">pmagplotlib</span><span class="o">.</span><span class="n">plot_ts</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="mi">23</span><span class="p">,</span><span class="mi">34</span><span class="p">,</span><span class="n">timescale</span><span class="o">=</span><span class="s1">&#39;gts12&#39;</span><span class="p">)</span> <span class="c1"># plot on the time scale</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">132</span><span class="p">)</span> <span class="c1"># make the second of three subplots</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">dir_inc</span><span class="p">,</span><span class="n">data</span><span class="o">.</span><span class="n">core_depth</span><span class="p">,</span><span class="s1">&#39;k-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">dir_inc</span><span class="p">,</span><span class="n">data</span><span class="o">.</span><span class="n">core_depth</span><span class="p">,</span><span class="s1">&#39;co&#39;</span><span class="p">,</span><span class="n">markeredgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">35</span><span class="p">,</span><span class="mi">23</span><span class="p">)</span>
<span class="c1"># calculate the geocentric axial dipole field for the site latitude</span>
<span class="n">gad</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">lat</span><span class="p">))))</span> <span class="c1"># tan (I) = 2 tan (lat)</span>
<span class="c1"># put it on the plot as a green dashed line</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">gad</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="o">-</span><span class="n">gad</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Inclinations&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">133</span><span class="p">)</span> <span class="c1"># make the third of three plots</span>
<span class="c1"># plot the intensity data on semi-log plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">int_rel</span><span class="o">/</span><span class="n">data</span><span class="o">.</span><span class="n">int_rel</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span><span class="n">data</span><span class="o">.</span><span class="n">core_depth</span><span class="p">,</span><span class="s1">&#39;k-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">int_rel</span><span class="o">/</span><span class="n">data</span><span class="o">.</span><span class="n">int_rel</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span><span class="n">data</span><span class="o">.</span><span class="n">core_depth</span><span class="p">,</span><span class="s1">&#39;co&#39;</span><span class="p">,</span><span class="n">markeredgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Relative Intensity&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/17673b764f51ea47d6b7690426386e0d87e186d24f9c003684fd3548956dd599.png" src="../_images/17673b764f51ea47d6b7690426386e0d87e186d24f9c003684fd3548956dd599.png" />
</div>
</div>
</section>
<section id="curie">
<h2>curie<a class="headerlink" href="#curie" title="Permalink to this heading">#</a></h2>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch6.html#x15-1560006">[Essentials Chapter 6]</a>  <a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#curie.py">[command line version]</a></p>
<p>Curie Temperature experiments, saved in MagIC formatted files, can be plotted using <strong>ipmag.curie()</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">ipmag</span><span class="o">.</span><span class="n">curie</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function curie in module pmagpy.ipmag:

curie(path_to_file=&#39;.&#39;, file_name=&#39;&#39;, magic=False, window_length=3, save=False, save_folder=&#39;.&#39;, fmt=&#39;svg&#39;, t_begin=&#39;&#39;, t_end=&#39;&#39;)
    Plots and interprets curie temperature data.
    ***
    The 1st derivative is calculated from smoothed M-T curve (convolution
    with trianfular window with width= &lt;-w&gt; degrees)
    ***
    The 2nd derivative is calculated from smoothed 1st derivative curve
    (using the same sliding window width)
    ***
    The estimated curie temp. is the maximum of the 2nd derivative.
    Temperature steps should be in multiples of 1.0 degrees.
    
    Parameters
    __________
    file_name : name of file to be opened
    
    Optional Parameters (defaults are used if not specified)
    ----------
    path_to_file : path to directory that contains file (default is current directory, &#39;.&#39;)
    window_length : dimension of smoothing window (input to smooth() function)
    save : boolean argument to save plots (default is False)
    save_folder : relative directory where plots will be saved (default is current directory, &#39;.&#39;)
    fmt : format of saved figures
    t_begin: start of truncated window for search
    t_end: end of truncated window for search
    magic : True if MagIC formated measurements.txt file
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ipmag</span><span class="o">.</span><span class="n">curie</span><span class="p">(</span><span class="n">path_to_file</span><span class="o">=</span><span class="s1">&#39;data_files/curie&#39;</span><span class="p">,</span><span class="n">file_name</span><span class="o">=</span><span class="s1">&#39;curie_example.dat&#39;</span><span class="p">,</span>\
           <span class="n">window_length</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>second derivative maximum is at T=552
</pre></div>
</div>
<img alt="../_images/b27e7cb55d102d8362e050353c9e1a0930743fcef2389732a33fd2f5bf733045.png" src="../_images/b27e7cb55d102d8362e050353c9e1a0930743fcef2389732a33fd2f5bf733045.png" />
<img alt="../_images/5b3667cd6eb0f7f418d0e4f8973e45810ec5868627af21af39574b46534a0ce5.png" src="../_images/5b3667cd6eb0f7f418d0e4f8973e45810ec5868627af21af39574b46534a0ce5.png" />
<img alt="../_images/dac7f227b2d70cabf67ff4857c2fe4c5b63202526923165143058868933392c5.png" src="../_images/dac7f227b2d70cabf67ff4857c2fe4c5b63202526923165143058868933392c5.png" />
<img alt="../_images/6e5cde5182c0f210c6cd71310993fc9d7902b101e21f579695e6957a735c6abe.png" src="../_images/6e5cde5182c0f210c6cd71310993fc9d7902b101e21f579695e6957a735c6abe.png" />
</div>
</div>
<section id="dayplot-magic">
<h3>dayplot_magic<a class="headerlink" href="#dayplot-magic" title="Permalink to this heading">#</a></h3>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch5.html#x15-1560005">[Essentials Chapter 5]</a>  <a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#dayplot_magic.py">[command line version]</a></p>
<p>The program <strong>dayplot_magic</strong>   makes Day (Day et al., 1977), or Squareness-Coercivity and Squareness-Coercivity of Remanence plots (e.g., Tauxe et al., 2002) from the MagIC formatted data.
To do this, we will call <strong>ipmag.dayplot_magic()</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">ipmag</span><span class="o">.</span><span class="n">dayplot_magic</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function dayplot_magic in module pmagpy.ipmag:

dayplot_magic(path_to_file=&#39;.&#39;, hyst_file=&#39;specimens.txt&#39;, rem_file=&#39;&#39;, save=True, save_folder=&#39;.&#39;, fmt=&#39;svg&#39;, data_model=3, interactive=False, contribution=None, image_records=False)
    Makes &#39;day plots&#39; (Day et al. 1977) and squareness/coercivity plots
    (Neel, 1955; plots after Tauxe et al., 2002); plots &#39;linear mixing&#39;
    curve from Dunlop and Carter-Stiglitz (2006).
    
    Optional Parameters (defaults are used if not specified)
    ----------
    path_to_file : path to directory that contains files (default is current directory, &#39;.&#39;)
    the default input file is &#39;specimens.txt&#39; (data_model=3
    if data_model = 2, then must these are the defaults:
        hyst_file : hysteresis file (default is &#39;rmag_hysteresis.txt&#39;)
        rem_file : remanence file (default is &#39;rmag_remanence.txt&#39;)
    save : boolean argument to save plots (default is True)
    save_folder : relative directory where plots will be saved (default is current directory, &#39;.&#39;)
    fmt : format of saved figures (default is &#39;pdf&#39;)
    image_records : generate and return a record for each image in a list of dicts
        which can be ingested by pmag.magic_write
        bool, default False
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ipmag</span><span class="o">.</span><span class="n">dayplot_magic</span><span class="p">(</span><span class="n">path_to_file</span><span class="o">=</span><span class="s1">&#39;data_files/dayplot_magic&#39;</span><span class="p">,</span><span class="n">hyst_file</span><span class="o">=</span><span class="s1">&#39;specimens.txt&#39;</span><span class="p">,</span><span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(True, [])
</pre></div>
</div>
<img alt="../_images/34bbb6a5a77fe3157354e3a97879696be04f318a5ba7a8a08d41ee5bb1640176.png" src="../_images/34bbb6a5a77fe3157354e3a97879696be04f318a5ba7a8a08d41ee5bb1640176.png" />
<img alt="../_images/75b089d04c01868780563641a1c6227692fa4a277bb46639617c9a6b129888a9.png" src="../_images/75b089d04c01868780563641a1c6227692fa4a277bb46639617c9a6b129888a9.png" />
<img alt="../_images/52f3b501cf70657f8408cb5b92776b842c4555d17a9e0eb28aeb2bb43ed67ab0.png" src="../_images/52f3b501cf70657f8408cb5b92776b842c4555d17a9e0eb28aeb2bb43ed67ab0.png" />
</div>
</div>
</section>
</section>
<section id="dmag-magic">
<h2>dmag_magic<a class="headerlink" href="#dmag-magic" title="Permalink to this heading">#</a></h2>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch9.html#x15-15600089">[Essentials Chapter 9]</a> <a class="reference external" href="https://earthref.org/MagIC">[MagIC Database]</a>  <a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#dmag_magic.py">[command line version]</a></p>
<p>We use <strong>dmag_magic</strong> to plot out the decay of all alternating field demagnetization experiments in MagIC  formatted files.   Here we can take a look at some of the data from   from Cromwell et al.  (2013, doi: 10.1002/ggge.20174).</p>
<p>This program calls <strong>pmagplotlib.plot_mag()</strong> to plot the demagnetization curve for a sample, site, or entire data file interactively.  There is a version that will prepare dataframes for plotting with this function called <strong>ipmag.plot_dmag()</strong>. So let’s try that:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">ipmag</span><span class="o">.</span><span class="n">plot_dmag</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function plot_dmag in module pmagpy.ipmag:

plot_dmag(data=&#39;&#39;, title=&#39;&#39;, fignum=1, norm=1, dmag_key=&#39;treat_ac_field&#39;, intensity=&#39;&#39;, quality=False)
    plots demagenetization data versus step for all specimens in pandas dataframe datablock
    
    Parameters
    ______________
    data : Pandas dataframe with MagIC data model 3 columns:
        fignum : figure number
        specimen : specimen name
        dmag_key : one of these: [&#39;treat_temp&#39;,&#39;treat_ac_field&#39;,&#39;treat_mw_energy&#39;]
            selected using method_codes : [&#39;LT_T-Z&#39;,&#39;LT-AF-Z&#39;,&#39;LT-M-Z&#39;] respectively
        intensity  : if blank will choose one of these: [&#39;magn_moment&#39;, &#39;magn_volume&#39;, &#39;magn_mass&#39;]
        quality : if True use the quality column of the DataFrame
     title : title for plot
     norm : if True, normalize data to first step
    Output :
      matptlotlib plot
</pre></div>
</div>
</div>
</div>
<p>Read in data from a MagIC data model 3 file.  Let’s go ahead and read it in with the full data hierarchy.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">status</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">cb</span><span class="o">.</span><span class="n">add_sites_to_meas_table</span><span class="p">(</span><span class="s1">&#39;data_files/dmag_magic&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>analysts</th>
      <th>citations</th>
      <th>description</th>
      <th>dir_csd</th>
      <th>dir_dec</th>
      <th>dir_inc</th>
      <th>experiment</th>
      <th>magn_moment</th>
      <th>meas_n_orient</th>
      <th>meas_temp</th>
      <th>...</th>
      <th>standard</th>
      <th>timestamp</th>
      <th>treat_ac_field</th>
      <th>treat_dc_field</th>
      <th>treat_dc_field_phi</th>
      <th>treat_dc_field_theta</th>
      <th>treat_temp</th>
      <th>sequence</th>
      <th>sample</th>
      <th>site</th>
    </tr>
    <tr>
      <th>measurement name</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>Cromwell</td>
      <td>This study</td>
      <td>None</td>
      <td>0.3</td>
      <td>190.4</td>
      <td>43.5</td>
      <td>jm002a1:LT-NO</td>
      <td>5.76e-05</td>
      <td>4</td>
      <td>273</td>
      <td>...</td>
      <td>u</td>
      <td>2009-10-05T22:51:00Z</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>90</td>
      <td>273</td>
      <td>1</td>
      <td>jm002a</td>
      <td>jm002</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Cromwell</td>
      <td>This study</td>
      <td>None</td>
      <td>0.2</td>
      <td>193.2</td>
      <td>44.5</td>
      <td>jm002a2:LT-NO</td>
      <td>6.51e-05</td>
      <td>4</td>
      <td>273</td>
      <td>...</td>
      <td>u</td>
      <td>2009-10-05T22:51:00Z</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>90</td>
      <td>273</td>
      <td>2</td>
      <td>jm002a</td>
      <td>jm002</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Cromwell</td>
      <td>This study</td>
      <td>None</td>
      <td>0.2</td>
      <td>147.5</td>
      <td>50.6</td>
      <td>jm002b1:LT-NO</td>
      <td>4.97e-05</td>
      <td>4</td>
      <td>273</td>
      <td>...</td>
      <td>u</td>
      <td>2009-10-05T22:48:00Z</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>90</td>
      <td>273</td>
      <td>3</td>
      <td>jm002b</td>
      <td>jm002</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Cromwell</td>
      <td>This study</td>
      <td>None</td>
      <td>0.2</td>
      <td>152.5</td>
      <td>55.8</td>
      <td>jm002b2:LT-NO</td>
      <td>5.23e-05</td>
      <td>4</td>
      <td>273</td>
      <td>...</td>
      <td>u</td>
      <td>2009-10-05T23:07:00Z</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>90</td>
      <td>273</td>
      <td>4</td>
      <td>jm002b</td>
      <td>jm002</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Cromwell</td>
      <td>This study</td>
      <td>None</td>
      <td>0.2</td>
      <td>186.2</td>
      <td>55.7</td>
      <td>jm002c1:LT-NO</td>
      <td>5.98e-05</td>
      <td>4</td>
      <td>273</td>
      <td>...</td>
      <td>u</td>
      <td>2009-10-05T22:54:00Z</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>90</td>
      <td>273</td>
      <td>5</td>
      <td>jm002c</td>
      <td>jm002</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 25 columns</p>
</div></div></div>
</div>
<p>There are several forms of intensity measurements with different normalizations.<br />
We could hunt through the magn_* columns to see what is non-blank or we can use the tool <strong>contribution_builder.get_intensity_col()</strong> which returns the first non-zero column.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">magn_col</span><span class="o">=</span><span class="n">cb</span><span class="o">.</span><span class="n">get_intensity_col</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">magn_col</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>magn_moment
</pre></div>
</div>
</div>
</div>
<p>Let’s look at what demagnetization data are available to us:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">method_codes</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;LT-NO&#39;, &#39;LT-AF-Z:LP-DIR-AF&#39;, &#39;LT-AF-Z:DE-VM:LP-DIR-AF&#39;,
       &#39;LT-NO:LP-PI-TRM:LP-PI-ALT-PTRM:LP-PI-BT-MD:LP-PI-BT-IZZI&#39;,
       &#39;LT-T-Z:LP-PI-TRM-ZI:LP-PI-TRM:LP-PI-ALT-PTRM:LP-PI-BT-MD:LP-PI-BT-IZZI&#39;,
       &#39;LT-T-I:LP-PI-TRM-ZI:LP-PI-TRM:LP-PI-ALT-PTRM:LP-PI-BT-MD:LP-PI-BT-IZZI&#39;,
       &#39;LT-PTRM-MD:LP-PI-TRM:LP-PI-ALT-PTRM:LP-PI-BT-MD:LP-PI-BT-IZZI&#39;,
       &#39;LT-T-I:LP-PI-TRM-IZ:LP-PI-TRM:LP-PI-ALT-PTRM:LP-PI-BT-MD:LP-PI-BT-IZZI&#39;,
       &#39;LT-T-Z:LP-PI-TRM-IZ:LP-PI-TRM:LP-PI-ALT-PTRM:LP-PI-BT-MD:LP-PI-BT-IZZI&#39;,
       &#39;LT-PTRM-I:LP-PI-TRM:LP-PI-ALT-PTRM:LP-PI-BT-MD:LP-PI-BT-IZZI&#39;,
       &#39;LT-T-I:DE-VM:LP-PI-TRM-IZ:LP-PI-TRM:LP-PI-ALT-PTRM:LP-PI-BT-MD:LP-PI-BT-IZZI&#39;,
       &#39;LT-T-I:DE-VM:LP-PI-TRM-ZI:LP-PI-TRM:LP-PI-ALT-PTRM:LP-PI-BT-MD:LP-PI-BT-IZZI&#39;,
       &#39;LT-T-Z:DE-VM:LP-PI-TRM-IZ:LP-PI-TRM:LP-PI-ALT-PTRM:LP-PI-BT-MD:LP-PI-BT-IZZI&#39;,
       &#39;LT-AF-Z:LP-AN-ARM&#39;, &#39;LT-AF-I:LP-AN-ARM&#39;, &#39;LT-T-Z:LP-DIR-T&#39;,
       &#39;LT-T-Z:DE-VM:LP-DIR-T&#39;,
       &#39;LT-T-Z:DE-VM:LP-PI-TRM-ZI:LP-PI-TRM:LP-PI-ALT-PTRM:LP-PI-BT-MD:LP-PI-BT-IZZI&#39;,
       None], dtype=object)
</pre></div>
</div>
</div>
</div>
<p>Oops - at least one of our records has blank method_codes!  so, let’s get rid of that one.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;method_codes&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>We can make the plots in this way:</p>
<ul class="simple">
<li><p>select the AF demagnetization data with method_codes = ‘LP-DIR-AF’</p></li>
<li><p>make a dataframe with these columns:
‘specimen’,’treat_ac_field’,magn_col,and ‘quality’</p></li>
<li><p>call ipmag.plot_dmag() to view the plot:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">af_df</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">method_codes</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;LP-DIR-AF&#39;</span><span class="p">)]</span> <span class="c1"># select the thermal demag data</span>
<span class="n">af_df</span><span class="o">=</span><span class="n">af_df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;treat_ac_field&#39;</span><span class="p">])</span>
<span class="n">df</span><span class="o">=</span><span class="n">af_df</span><span class="p">[[</span><span class="s1">&#39;specimen&#39;</span><span class="p">,</span><span class="s1">&#39;treat_ac_field&#39;</span><span class="p">,</span><span class="n">magn_col</span><span class="p">,</span><span class="s1">&#39;quality&#39;</span><span class="p">]]</span>

<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>specimen</th>
      <th>treat_ac_field</th>
      <th>magn_moment</th>
      <th>quality</th>
    </tr>
    <tr>
      <th>measurement name</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>jm002a1</td>
      <td>0.005</td>
      <td>4.55e-05</td>
      <td>g</td>
    </tr>
    <tr>
      <th>2</th>
      <td>jm002a1</td>
      <td>0.01</td>
      <td>2.08e-05</td>
      <td>g</td>
    </tr>
    <tr>
      <th>3</th>
      <td>jm002a1</td>
      <td>0.015</td>
      <td>1.47e-05</td>
      <td>g</td>
    </tr>
    <tr>
      <th>4</th>
      <td>jm002a1</td>
      <td>0.02</td>
      <td>1.15e-05</td>
      <td>g</td>
    </tr>
    <tr>
      <th>5</th>
      <td>jm002a1</td>
      <td>0.03</td>
      <td>8e-06</td>
      <td>g</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ipmag</span><span class="o">.</span><span class="n">plot_dmag</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;AF demag&quot;</span><span class="p">,</span><span class="n">fignum</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/7b9666cd9ed43ec637d5204b1af5fb687b766e370fc56f83db3931d9caf11382.png" src="../_images/7b9666cd9ed43ec637d5204b1af5fb687b766e370fc56f83db3931d9caf11382.png" />
</div>
</div>
<p>This plotted all the data in the file.  we could also plot the data by site
by getting a unique list of site names and then walk through them one by one</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sites</span><span class="o">=</span><span class="n">af_df</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="n">cnt</span><span class="o">=</span><span class="mi">1</span>
<span class="k">for</span> <span class="n">site</span> <span class="ow">in</span> <span class="n">sites</span><span class="p">:</span>
    <span class="n">site_df</span><span class="o">=</span><span class="n">af_df</span><span class="p">[</span><span class="n">af_df</span><span class="o">.</span><span class="n">site</span><span class="o">==</span><span class="n">site</span><span class="p">]</span> <span class="c1"># fish out this site</span>
    <span class="c1"># trim to only AF data. </span>
    <span class="n">site_df</span><span class="o">=</span><span class="n">site_df</span><span class="p">[[</span><span class="s1">&#39;specimen&#39;</span><span class="p">,</span><span class="s1">&#39;treat_ac_field&#39;</span><span class="p">,</span><span class="n">magn_col</span><span class="p">,</span><span class="s1">&#39;quality&#39;</span><span class="p">]]</span> 
    <span class="n">ipmag</span><span class="o">.</span><span class="n">plot_dmag</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">site_df</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="n">site</span><span class="p">,</span><span class="n">fignum</span><span class="o">=</span><span class="n">cnt</span><span class="p">)</span>
    <span class="n">cnt</span><span class="o">+=</span><span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/11e0dc5405645aad1f99fb32e34b542e248644242e520d54bfb4e0c833d856ee.png" src="../_images/11e0dc5405645aad1f99fb32e34b542e248644242e520d54bfb4e0c833d856ee.png" />
<img alt="../_images/7e4369a8b297757d7004cfedc0defea521753c1d55271991d4729b1fea5c5b20.png" src="../_images/7e4369a8b297757d7004cfedc0defea521753c1d55271991d4729b1fea5c5b20.png" />
<img alt="../_images/a85663f5f4261ce489b2058f151ddf542b9b318d25ebceb031963c0aee5783dc.png" src="../_images/a85663f5f4261ce489b2058f151ddf542b9b318d25ebceb031963c0aee5783dc.png" />
<img alt="../_images/4fe09befb4f8f4b109b98412453a06dbd7273abffbd6b1895d5d537b35614acb.png" src="../_images/4fe09befb4f8f4b109b98412453a06dbd7273abffbd6b1895d5d537b35614acb.png" />
<img alt="../_images/08aa3d92c2cdf64562aed67854e6edc005c47b4792e90ce48e40ccb7d8548fdc.png" src="../_images/08aa3d92c2cdf64562aed67854e6edc005c47b4792e90ce48e40ccb7d8548fdc.png" />
<img alt="../_images/395c29740b47e476203f51735aacf4224c3d0a1a866ed5f30cb2072d05cd02cc.png" src="../_images/395c29740b47e476203f51735aacf4224c3d0a1a866ed5f30cb2072d05cd02cc.png" />
<img alt="../_images/f64ccd7439ca12e738bbbab1ff002b48e5eb524bcdbadec573b0e88801e4bf24.png" src="../_images/f64ccd7439ca12e738bbbab1ff002b48e5eb524bcdbadec573b0e88801e4bf24.png" />
<img alt="../_images/7233b4d67aad5f5bb024f8570b17ae17a84d570d4a763f4f9a2aa013505f3c3e.png" src="../_images/7233b4d67aad5f5bb024f8570b17ae17a84d570d4a763f4f9a2aa013505f3c3e.png" />
<img alt="../_images/267be2d088e1386f494d6d82c8bca88c40d9cbec30b6c8a8ba3b850f01130c9a.png" src="../_images/267be2d088e1386f494d6d82c8bca88c40d9cbec30b6c8a8ba3b850f01130c9a.png" />
<img alt="../_images/33cfb2cc9e400aba81381ee9a293759ffffc57d9ef19422303bc0f3eb5e1192c.png" src="../_images/33cfb2cc9e400aba81381ee9a293759ffffc57d9ef19422303bc0f3eb5e1192c.png" />
<img alt="../_images/41b5220d1e44f2ba7c8890bf5e4ebab33c165b2b9f19def5a8c7be8aae68ad22.png" src="../_images/41b5220d1e44f2ba7c8890bf5e4ebab33c165b2b9f19def5a8c7be8aae68ad22.png" />
<img alt="../_images/9917c440c135e1082fdc3278035db8ecb522d6abfc6c0f9b006bafb326ec901c.png" src="../_images/9917c440c135e1082fdc3278035db8ecb522d6abfc6c0f9b006bafb326ec901c.png" />
<img alt="../_images/111235be3756c8477ebd681ed5599afe0939bd1de4526e415fe15e8908fb650f.png" src="../_images/111235be3756c8477ebd681ed5599afe0939bd1de4526e415fe15e8908fb650f.png" />
<img alt="../_images/a2cad4dea1613a629d5cdad122fc8310b88bcfe8162da15549f18e2848fcba9b.png" src="../_images/a2cad4dea1613a629d5cdad122fc8310b88bcfe8162da15549f18e2848fcba9b.png" />
<img alt="../_images/8bce76438f307f7d452bd910dcbb83d0ae60d036a6bc9a21341e09ee2df06554.png" src="../_images/8bce76438f307f7d452bd910dcbb83d0ae60d036a6bc9a21341e09ee2df06554.png" />
<img alt="../_images/8d0ff703cc318a3ed7da4dde18b3f2442903c5a12694a772faa9215a33a5023e.png" src="../_images/8d0ff703cc318a3ed7da4dde18b3f2442903c5a12694a772faa9215a33a5023e.png" />
<img alt="../_images/2107142a681481d546debd76c1e4c4befcbe513f285f794ee2b67b560affbc51.png" src="../_images/2107142a681481d546debd76c1e4c4befcbe513f285f794ee2b67b560affbc51.png" />
<img alt="../_images/7d8072e8991122ab5a5a6228700a35071e9d2e3b333177c9d511a67a2e788ed8.png" src="../_images/7d8072e8991122ab5a5a6228700a35071e9d2e3b333177c9d511a67a2e788ed8.png" />
<img alt="../_images/b48731d3cdd030ac9eb623a00e24314ffd3556965a12ee42926fc16bba0fa4a3.png" src="../_images/b48731d3cdd030ac9eb623a00e24314ffd3556965a12ee42926fc16bba0fa4a3.png" />
<img alt="../_images/ee3ece50ea2dd2728e1986d66fa120fd4eb86bb3be597e25bee1772dc029f871.png" src="../_images/ee3ece50ea2dd2728e1986d66fa120fd4eb86bb3be597e25bee1772dc029f871.png" />
<img alt="../_images/c8cdad3673361089e70225c28c93c1a5908cf8336e44328670f1cb0f96255fcf.png" src="../_images/c8cdad3673361089e70225c28c93c1a5908cf8336e44328670f1cb0f96255fcf.png" />
<img alt="../_images/c1050c722a951b3f03b706e0082c58e0fb21512099db8674c7d4b5b6cdb8e834.png" src="../_images/c1050c722a951b3f03b706e0082c58e0fb21512099db8674c7d4b5b6cdb8e834.png" />
<img alt="../_images/1b5d4a120453fc80cd80b997419fa0bf7e8b54cbdee9779ec21328bc79a71390.png" src="../_images/1b5d4a120453fc80cd80b997419fa0bf7e8b54cbdee9779ec21328bc79a71390.png" />
</div>
</div>
<p>We could repeat for thermal data if we felt like it using ‘LT-T-Z’ as the method_code key
and treat_temp as the step.  We could also save the plots using plt.savefig(‘FIGNAME.FMT’) where FIGNAME could be the site, location, demag type as you wish.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># alternatively, using ipmag.dmag_magic</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">dmag_magic</span><span class="p">(</span><span class="n">dir_path</span><span class="o">=</span><span class="s1">&#39;data_files/dmag_magic&#39;</span><span class="p">,</span> <span class="n">LT</span><span class="o">=</span><span class="s2">&quot;AF&quot;</span><span class="p">,</span> <span class="n">save_plots</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5001  records read from  measurements.txt
Jan Mayen plotting by:  location
</pre></div>
</div>
<img alt="../_images/61ad87d69f241ba875ccc0d3ddb3c4b3751d6c12ff8634ca32f2c75c6d612a90.png" src="../_images/61ad87d69f241ba875ccc0d3ddb3c4b3751d6c12ff8634ca32f2c75c6d612a90.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(True, [])
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 432x288 with 0 Axes&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ipmag</span><span class="o">.</span><span class="n">dmag_magic</span><span class="p">(</span><span class="n">dir_path</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">input_dir_path</span><span class="o">=</span><span class="s2">&quot;data_files/dmag_magic&quot;</span><span class="p">,</span> 
                 <span class="n">LT</span><span class="o">=</span><span class="s2">&quot;AF&quot;</span><span class="p">,</span> <span class="n">plot_by</span><span class="o">=</span><span class="s1">&#39;sit&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;png&quot;</span><span class="p">,</span> <span class="n">save_plots</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5001  records read from  measurements.txt
jm002 plotting by:  site
</pre></div>
</div>
<img alt="../_images/3ac90d6d9e0c7b1b38d657759c2a529555ee88aa54699ef30f03c3bd838abd0f.png" src="../_images/3ac90d6d9e0c7b1b38d657759c2a529555ee88aa54699ef30f03c3bd838abd0f.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>jm003 plotting by:  site
</pre></div>
</div>
<img alt="../_images/fc4a804a89d501ad5ef7e5fb63413791427631dea89e8f1a1465fd72454e0fa2.png" src="../_images/fc4a804a89d501ad5ef7e5fb63413791427631dea89e8f1a1465fd72454e0fa2.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>jm004 plotting by:  site
</pre></div>
</div>
<img alt="../_images/512829cca7bbc782d688459d96b2adac69abfae10f1ebd77765b6f5f94a9c276.png" src="../_images/512829cca7bbc782d688459d96b2adac69abfae10f1ebd77765b6f5f94a9c276.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>jm006 plotting by:  site
</pre></div>
</div>
<img alt="../_images/bc5ddd5a88eed04d13fed0d95256e00f9f598a61f159faf894bcc5870190f233.png" src="../_images/bc5ddd5a88eed04d13fed0d95256e00f9f598a61f159faf894bcc5870190f233.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>jm007 plotting by:  site
</pre></div>
</div>
<img alt="../_images/2df0cdfabfebee42e40405b8b8d236707538846fe2f9e9eb9a94b32d6d8207a6.png" src="../_images/2df0cdfabfebee42e40405b8b8d236707538846fe2f9e9eb9a94b32d6d8207a6.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(True, [])
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 432x288 with 0 Axes&gt;
</pre></div>
</div>
</div>
</div>
<section id="dmag-magic-with-a-downloaded-file">
<h3>dmag_magic with a downloaded file<a class="headerlink" href="#dmag-magic-with-a-downloaded-file" title="Permalink to this heading">#</a></h3>
<p>Now let’s look at a <span class="xref myst">downloaded</span> contribution using <span class="xref myst">dmag_magic</span> as before, but this time with thermal demagnetization.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ipmag</span><span class="o">.</span><span class="n">download_magic</span><span class="p">(</span><span class="s2">&quot;magic_contribution_16533.txt&quot;</span><span class="p">,</span> <span class="n">dir_path</span><span class="o">=</span><span class="s2">&quot;data_files/download_magic&quot;</span><span class="p">,</span> 
                     <span class="n">input_dir_path</span><span class="o">=</span><span class="s2">&quot;data_files/download_magic&quot;</span><span class="p">)</span>
<span class="n">status</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">cb</span><span class="o">.</span><span class="n">add_sites_to_meas_table</span><span class="p">(</span><span class="s1">&#39;data_files/download_magic&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">method_codes</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;LT-T-Z&#39;</span><span class="p">)]</span> <span class="c1"># select the thermal demag data</span>
<span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;specimen&#39;</span><span class="p">,</span><span class="s1">&#39;treat_temp&#39;</span><span class="p">,</span><span class="s1">&#39;magn_moment&#39;</span><span class="p">,</span><span class="s1">&#39;quality&#39;</span><span class="p">]]</span>
<span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;treat_temp&#39;</span><span class="p">,</span><span class="s1">&#39;magn_moment&#39;</span><span class="p">])</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">plot_dmag</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Thermal demag&quot;</span><span class="p">,</span><span class="n">fignum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dmag_key</span><span class="o">=</span><span class="s1">&#39;treat_temp&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>working on:  &#39;contribution&#39;
1  records written to file  /Users/nebula/Python/PmagPy/data_files/download_magic/contribution.txt
contribution  data put in  /Users/nebula/Python/PmagPy/data_files/download_magic/contribution.txt
working on:  &#39;locations&#39;
3  records written to file  /Users/nebula/Python/PmagPy/data_files/download_magic/locations.txt
locations  data put in  /Users/nebula/Python/PmagPy/data_files/download_magic/locations.txt
working on:  &#39;sites&#39;
52  records written to file  /Users/nebula/Python/PmagPy/data_files/download_magic/sites.txt
sites  data put in  /Users/nebula/Python/PmagPy/data_files/download_magic/sites.txt
working on:  &#39;samples&#39;
271  records written to file  /Users/nebula/Python/PmagPy/data_files/download_magic/samples.txt
samples  data put in  /Users/nebula/Python/PmagPy/data_files/download_magic/samples.txt
working on:  &#39;specimens&#39;
225  records written to file  /Users/nebula/Python/PmagPy/data_files/download_magic/specimens.txt
specimens  data put in  /Users/nebula/Python/PmagPy/data_files/download_magic/specimens.txt
working on:  &#39;measurements&#39;
3072  records written to file  /Users/nebula/Python/PmagPy/data_files/download_magic/measurements.txt
measurements  data put in  /Users/nebula/Python/PmagPy/data_files/download_magic/measurements.txt
working on:  &#39;criteria&#39;
20  records written to file  /Users/nebula/Python/PmagPy/data_files/download_magic/criteria.txt
criteria  data put in  /Users/nebula/Python/PmagPy/data_files/download_magic/criteria.txt
working on:  &#39;ages&#39;
20  records written to file  /Users/nebula/Python/PmagPy/data_files/download_magic/ages.txt
ages  data put in  /Users/nebula/Python/PmagPy/data_files/download_magic/ages.txt
</pre></div>
</div>
<img alt="../_images/067cf03d0239fd6bcc58750910134a674961520ecf5f6a9aa7e49ea4b52fc50b.png" src="../_images/067cf03d0239fd6bcc58750910134a674961520ecf5f6a9aa7e49ea4b52fc50b.png" />
</div>
</div>
</section>
</section>
<section id="dms2dd">
<h2>dms2dd<a class="headerlink" href="#dms2dd" title="Permalink to this heading">#</a></h2>
<p>convert degrees minutes seconds to decimal degrees</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">dms2dd</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function dms2dd in module pmagpy.pmag:

dms2dd(d)
    Converts a list or array degree, minute, second locations to an array of decimal degrees. 
    
    Parameters
    __________
        d : list or array of [deg, min, sec]
    Returns
    _______
        d : input list or array and its corresponding
        dd : decimal degree
        
    Examples
    ________
    &gt;&gt;&gt; pmag.dms2dd([60,35,15])
    60 35 15
    array(60.587500000000006)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pmag</span><span class="o">.</span><span class="n">dms2dd</span><span class="p">([</span><span class="mi">70</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array(70.16666666666667)
</pre></div>
</div>
</div>
</div>
</section>
<section id="eqarea">
<h2>eqarea<a class="headerlink" href="#eqarea" title="Permalink to this heading">#</a></h2>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch2.html#x15-156000813">[Essentials Chapter 2]</a><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ap2.html#x21-227000B#x15-156000813">[Essentials Appendix B]</a> <a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#eqarea.py">[command line version]</a></p>
<p>The problem of plotting equal area projections in Jupyter notebooks was solved by Nick Swanson-Hysell who started the <strong>ipmag</strong> module just for this purpose!  We use <strong>ipmag.plot_net()</strong> to plot the net, then <strong>ipmag.plot_di()</strong> to plot the directions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">ipmag</span><span class="o">.</span><span class="n">plot_di</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function plot_di in module pmagpy.ipmag:

plot_di(dec=None, inc=None, di_block=None, color=&#39;k&#39;, marker=&#39;o&#39;, markersize=20, legend=&#39;no&#39;, label=&#39;&#39;, title=&#39;&#39;, edge=&#39;&#39;, alpha=1)
    Plot declination, inclination data on an equal area plot.
    
    Before this function is called a plot needs to be initialized with code that looks
    something like:
    &gt;fignum = 1
    &gt;plt.figure(num=fignum,figsize=(10,10),dpi=160)
    &gt;ipmag.plot_net(fignum)
    
    Required Parameters
    -----------
    dec : declination being plotted
    inc : inclination being plotted
    
    or
    
    di_block: a nested list of [dec,inc,1.0]
    (di_block can be provided instead of dec, inc in which case it will be used)
    
    Optional Parameters (defaults are used if not specified)
    -----------
    color : the default color is black. Other colors can be chosen (e.g. &#39;r&#39;)
    marker : the default marker is a circle (&#39;o&#39;)
    markersize : default size is 20
    label : the default label is blank (&#39;&#39;)
    legend : the default is no legend (&#39;no&#39;). Putting &#39;yes&#39; will plot a legend.
    edge : marker edge color - if blank, is color of marker
    alpha : opacity
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">di_block</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;data_files/eqarea/fishrot.out&#39;</span><span class="p">)</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">plot_net</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">plot_di</span><span class="p">(</span><span class="n">di_block</span><span class="o">=</span><span class="n">di_block</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">edge</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/9df7c8664e50d589a8a37b6621b3b59c38a63bb5050e05e6f77ed8b754906298.png" src="../_images/9df7c8664e50d589a8a37b6621b3b59c38a63bb5050e05e6f77ed8b754906298.png" />
</div>
</div>
</section>
<section id="eqarea-ell">
<h2>eqarea_ell<a class="headerlink" href="#eqarea-ell" title="Permalink to this heading">#</a></h2>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch11.html">[Essentials Chapter 11]</a>
<a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch12.html">[Essentials Chapter 12]</a>
<a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ap2.html#x21-227000B#x15-156000813">[Essentials Appendix B]</a>
<a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#eqarea_ell.py">[command line version]</a></p>
<p>There are several ways of plotting ellipses for directions. The first is to plot an alpha_95 for each direction (dec, inc).</p>
<p>To do that, we use <strong>ipmag.plot_di_mean( )</strong> to plot each direction and its associated alpha_95.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vectors</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;data_files/eqarea_ell/eqarea_ell_example.txt&#39;</span><span class="p">)</span>
<span class="n">vectors</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 26.9,  15.5,   3.2],
       [ 20.9,  14.7,   2.6],
       [ 31.8,  16.4,   4.2],
       [ 32.8,   6.3,   7.6],
       [ 43.7,  -4.7,   8.9],
       [209.3, -26.1,   7.6],
       [224.4, -21.1,  14.3],
       [197. , -40.8,  10.3],
       [209.4,  -2.9,  10.8],
       [202.7,  -4.6,   4.7],
       [220.7,  -9. ,  13.3],
       [219.4, -10.2,  11.4],
       [228.9, -17.3,   7.9],
       [213.2, -14. ,   7.7]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">plot_net</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">vectors</span><span class="p">)):</span>
    <span class="n">ipmag</span><span class="o">.</span><span class="n">plot_di_mean</span><span class="p">(</span><span class="n">vectors</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">vectors</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">vectors</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/0b76c2853ae2e7269ca2c6168d90a0de6285786a7ff4f4c589b19ca3808186dd.png" src="../_images/0b76c2853ae2e7269ca2c6168d90a0de6285786a7ff4f4c589b19ca3808186dd.png" />
</div>
</div>
<p>Alternatively, one can make a plot of all the directions and the mean and confidence ellipse for the ensemble.</p>
<p>We make the equal area projects with the <strong>ipmag.plot_net()</strong> and <strong>ipmag.plot_di()</strong> functions.  The options in eqarea_ell are:
- Bingham mean and ellipse(s)
- Fisher mean(s) and alpha_95(s)
- Kent mean(s) - same as Fisher - and Kent ellipse(s)
- Bootstrapped mean(s)  - same as Fisher - and ellipse(s)
- Bootstrapped eigenvectors
For Bingham mean, the N/R data are assumed antipodal and the procedure would be:
- plot the data
- calculate the bingham ellipse with <strong>pmag.dobingham()</strong>
- plot the ellipse using <strong>pmag.plot_di_mean_ellipse()</strong>
All others, the data are not assumed antipodal, and must be separated into normal and reverse modes. To do that you can either use <strong>pmag.separate_directions()</strong> to calculate ellipses for each mode, OR use <strong>pmag.flip()</strong> to flip the reverse mode to the normal mode.  To calculate the ellipses:
- calculate the ellipses for each mode (or the flipped data set):
- Kent: use <strong>pmag.dokent()</strong>, setting NN to the number of data points
- Bootstrap : use <strong>pmag.di_boot()</strong> to generate the bootstrapped means
- either just plot the eigenvectors (ipmag.plot_di()) OR
- calcualate the bootstrapped ellipses with <strong>pmag.dokent()</strong> setting NN to 1
- Parametric bootstrap : you need a pandas data frame with the site mean directions, n and kappa.  Then you can use <strong>pmag.dir_df_boot()</strong>.<br />
- plot the ellipses if desired.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#read in the data into an array</span>
<span class="n">vectors</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;data_files/eqarea_ell/tk03.out&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="n">di_block</span><span class="o">=</span><span class="n">vectors</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="c1"># decs are di_block[0], incs are di_block[1]</span>
<span class="n">di_block</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[182.7, -64.7],
       [354.7,  62.8],
       [198.1, -68.1],
       [344.8,  61.8],
       [194. , -56.5],
       [350. ,  56.1],
       [214.2, -55.3],
       [344.9,  56.5],
       [172.6, -70.7],
       [  3. ,  60.9],
       [155.2, -60.2],
       [  8.4,  65.1],
       [183.5, -56.5],
       [342.5,  56.1],
       [175.5, -53.4],
       [338.9,  73.3],
       [169.8, -56.9],
       [347.1,  45.9],
       [183.2, -52.5],
       [ 12.5,  57.5]])
</pre></div>
</div>
</div>
</div>
<section id="bingham-ellipses">
<h3>Bingham ellipses<a class="headerlink" href="#bingham-ellipses" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">dobingham</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function dobingham in module pmagpy.pmag:

dobingham(di_block)
    Calculates the Bingham mean and associated statistical parameters from
    directions that are input as a di_block
    
    Parameters
    ----------
    di_block : a nested list of [dec,inc] or [dec,inc,intensity]
    
    Returns
    -------
    bpars : dictionary containing the Bingham mean and associated statistics
    dictionary keys
        dec : mean declination
        inc : mean inclination
        n : number of datapoints
        Eta : major ellipse
        Edec : declination of major ellipse axis
        Einc : inclination of major ellipse axis
        Zeta : minor ellipse
        Zdec : declination of minor ellipse axis
        Zinc : inclination of minor ellipse axis
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">ipmag</span><span class="o">.</span><span class="n">plot_di_mean_ellipse</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function plot_di_mean_ellipse in module pmagpy.ipmag:

plot_di_mean_ellipse(dictionary, fignum=1, color=&#39;k&#39;, marker=&#39;o&#39;, markersize=20, label=&#39;&#39;, legend=&#39;no&#39;)
    Plot a mean direction (declination, inclination)  confidence ellipse.
    
    Parameters
    -----------
    dictionary : a dictionary generated by the pmag.dobingham or pmag.dokent funcitons
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ipmag</span><span class="o">.</span><span class="n">plot_net</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">plot_di</span><span class="p">(</span><span class="n">di_block</span><span class="o">=</span><span class="n">di_block</span><span class="p">)</span>
<span class="n">bpars</span><span class="o">=</span><span class="n">pmag</span><span class="o">.</span><span class="n">dobingham</span><span class="p">(</span><span class="n">di_block</span><span class="p">)</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">plot_di_mean_ellipse</span><span class="p">(</span><span class="n">bpars</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;^&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/6b71201d665b7043de3c76539ca4671ba2d80561362864933b09f92dd9b539b0.png" src="../_images/6b71201d665b7043de3c76539ca4671ba2d80561362864933b09f92dd9b539b0.png" />
</div>
</div>
</section>
<section id="fisher-mean-a95">
<h3>Fisher mean, a95<a class="headerlink" href="#fisher-mean-a95" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">separate_directions</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function separate_directions in module pmagpy.pmag:

separate_directions(di_block)
    Separates set of directions into two modes based on principal direction
    
    Parameters
    _______________
    di_block : block of nested dec,inc pairs
    
    Return
    mode_1_block,mode_2_block :  two lists of nested dec,inc pairs
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vectors</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;data_files/eqarea_ell/tk03.out&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="n">di_block</span><span class="o">=</span><span class="n">vectors</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="c1"># decs are di_block[0], incs are di_block[1]</span>
<span class="n">mode_1</span><span class="p">,</span><span class="n">mode_2</span><span class="o">=</span><span class="n">pmag</span><span class="o">.</span><span class="n">separate_directions</span><span class="p">(</span><span class="n">di_block</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">ipmag</span><span class="o">.</span><span class="n">fisher_mean</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function fisher_mean in module pmagpy.ipmag:

fisher_mean(dec=None, inc=None, di_block=None)
    Calculates the Fisher mean and associated parameters from either a list of
    declination values and a separate list of inclination values or from a
    di_block (a nested list a nested list of [dec,inc,1.0]). Returns a
    dictionary with the Fisher mean and statistical parameters.
    
    Parameters
    ----------
    dec : list of declinations or longitudes
    inc : list of inclinations or latitudes
    di_block : a nested list of [dec,inc,1.0]
        A di_block can be provided instead of dec, inc lists in which case it
        will be used. Either dec, inc lists or a di_block need to be provided.
    
    Returns
    -------
    fisher_mean : dictionary containing the Fisher mean parameters
    
    Examples
    --------
    Use lists of declination and inclination to calculate a Fisher mean:
    
    &gt;&gt;&gt; ipmag.fisher_mean(dec=[140,127,142,136],inc=[21,23,19,22])
    {&#39;alpha95&#39;: 7.292891411309177,
    &#39;csd&#39;: 6.4097743211340896,
    &#39;dec&#39;: 136.30838974272072,
    &#39;inc&#39;: 21.347784026899987,
    &#39;k&#39;: 159.69251473636305,
    &#39;n&#39;: 4,
    &#39;r&#39;: 3.9812138971889026}
    
    Use a di_block to calculate a Fisher mean (will give the same output as the
    example with the lists):
    
    &gt;&gt;&gt; ipmag.fisher_mean(di_block=[[140,21],[127,23],[142,19],[136,22]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mode_1_fpars</span><span class="o">=</span><span class="n">ipmag</span><span class="o">.</span><span class="n">fisher_mean</span><span class="p">(</span><span class="n">di_block</span><span class="o">=</span><span class="n">mode_1</span><span class="p">)</span>
<span class="n">mode_2_fpars</span><span class="o">=</span><span class="n">ipmag</span><span class="o">.</span><span class="n">fisher_mean</span><span class="p">(</span><span class="n">di_block</span><span class="o">=</span><span class="n">mode_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">ipmag</span><span class="o">.</span><span class="n">plot_di_mean</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function plot_di_mean in module pmagpy.ipmag:

plot_di_mean(dec, inc, a95, color=&#39;k&#39;, marker=&#39;o&#39;, markersize=20, label=&#39;&#39;, legend=&#39;no&#39;)
    Plot a mean direction (declination, inclination) with alpha_95 ellipse on
    an equal area plot.
    
    Before this function is called, a plot needs to be initialized with code
    that looks something like:
    &gt;fignum = 1
    &gt;plt.figure(num=fignum,figsize=(10,10),dpi=160)
    &gt;ipmag.plot_net(fignum)
    
    Required Parameters
    -----------
    dec : declination of mean being plotted
    inc : inclination of mean being plotted
    a95 : a95 confidence ellipse of mean being plotted
    
    Optional Parameters (defaults are used if not specified)
    -----------
    color : the default color is black. Other colors can be chosen (e.g. &#39;r&#39;).
    marker : the default is a circle. Other symbols can be chosen (e.g. &#39;s&#39;).
    markersize : the default is 20. Other sizes can be chosen.
    label : the default is no label. Labels can be assigned.
    legend : the default is no legend (&#39;no&#39;). Putting &#39;yes&#39; will plot a legend.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot the data</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">plot_net</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">plot_di</span><span class="p">(</span><span class="n">di_block</span><span class="o">=</span><span class="n">di_block</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">edge</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="c1"># draw on the means and lpha95</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">plot_di_mean</span><span class="p">(</span><span class="n">dec</span><span class="o">=</span><span class="n">mode_1_fpars</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">],</span><span class="n">inc</span><span class="o">=</span><span class="n">mode_1_fpars</span><span class="p">[</span><span class="s1">&#39;inc&#39;</span><span class="p">],</span><span class="n">a95</span><span class="o">=</span><span class="n">mode_1_fpars</span><span class="p">[</span><span class="s1">&#39;alpha95&#39;</span><span class="p">],</span>\
                  <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>

<span class="n">ipmag</span><span class="o">.</span><span class="n">plot_di_mean</span><span class="p">(</span><span class="n">dec</span><span class="o">=</span><span class="n">mode_2_fpars</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">],</span><span class="n">inc</span><span class="o">=</span><span class="n">mode_2_fpars</span><span class="p">[</span><span class="s1">&#39;inc&#39;</span><span class="p">],</span><span class="n">a95</span><span class="o">=</span><span class="n">mode_2_fpars</span><span class="p">[</span><span class="s1">&#39;alpha95&#39;</span><span class="p">],</span>\
                  <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/cc26828e035e56ed1500de3412e1d5ca9c60a2ed473c852209130c0e7aca53cd.png" src="../_images/cc26828e035e56ed1500de3412e1d5ca9c60a2ed473c852209130c0e7aca53cd.png" />
</div>
</div>
</section>
<section id="kent-mean-and-ellipse">
<h3>Kent mean and ellipse<a class="headerlink" href="#kent-mean-and-ellipse" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">dokent</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function dokent in module pmagpy.pmag:

dokent(data, NN)
    gets Kent  parameters for data
    Parameters
    ___________________
    data :  nested pairs of [Dec,Inc]
    NN  : normalization
        NN is the number of data for Kent ellipse
        NN is 1 for Kent ellipses of bootstrapped mean directions
    
    Return
    kpars dictionary keys
        dec : mean declination
        inc : mean inclination
        n : number of datapoints
        Eta : major ellipse
        Edec : declination of major ellipse axis
        Einc : inclination of major ellipse axis
        Zeta : minor ellipse
        Zdec : declination of minor ellipse axis
        Zinc : inclination of minor ellipse axis
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mode_1_kpars</span><span class="o">=</span><span class="n">pmag</span><span class="o">.</span><span class="n">dokent</span><span class="p">(</span><span class="n">mode_1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">mode_1</span><span class="p">))</span>
<span class="n">mode_2_kpars</span><span class="o">=</span><span class="n">pmag</span><span class="o">.</span><span class="n">dokent</span><span class="p">(</span><span class="n">mode_2</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">mode_2</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot the data</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">plot_net</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">plot_di</span><span class="p">(</span><span class="n">di_block</span><span class="o">=</span><span class="n">di_block</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">edge</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="c1"># draw on the means and lpha95</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">plot_di_mean_ellipse</span><span class="p">(</span><span class="n">mode_1_kpars</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;cyan&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">plot_di_mean_ellipse</span><span class="p">(</span><span class="n">mode_2_kpars</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;cyan&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/46475451d631533c9d138179b2727b75965b3386fc73a12d44e74bdf33ddeb7b.png" src="../_images/46475451d631533c9d138179b2727b75965b3386fc73a12d44e74bdf33ddeb7b.png" />
</div>
</div>
</section>
<section id="bootstrap-eigenvectors">
<h3>Bootstrap eigenvectors<a class="headerlink" href="#bootstrap-eigenvectors" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">di_boot</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function di_boot in module pmagpy.pmag:

di_boot(DIs, nb=5000)
     returns bootstrap means  for Directional data
     Parameters
     _________________
     DIs : nested list of Dec,Inc pairs
     nb : number of bootstrap pseudosamples
    
     Returns
    -------
     BDIs:   nested list of bootstrapped mean Dec,Inc pairs
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mode_1_BDIs</span><span class="o">=</span><span class="n">pmag</span><span class="o">.</span><span class="n">di_boot</span><span class="p">(</span><span class="n">mode_1</span><span class="p">)</span>
<span class="n">mode_2_BDIs</span><span class="o">=</span><span class="n">pmag</span><span class="o">.</span><span class="n">di_boot</span><span class="p">(</span><span class="n">mode_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ipmag</span><span class="o">.</span><span class="n">plot_net</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">plot_di</span><span class="p">(</span><span class="n">di_block</span><span class="o">=</span><span class="n">mode_1_BDIs</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;cyan&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">plot_di</span><span class="p">(</span><span class="n">di_block</span><span class="o">=</span><span class="n">mode_2_BDIs</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;cyan&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">plot_di</span><span class="p">(</span><span class="n">di_block</span><span class="o">=</span><span class="n">di_block</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">edge</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/5c558ec64eb9ba839325aaa6917f44a7b87a1649db05dc9991463b6a203f13ce.png" src="../_images/5c558ec64eb9ba839325aaa6917f44a7b87a1649db05dc9991463b6a203f13ce.png" />
</div>
</div>
</section>
<section id="bootstrapped-ellipses">
<h3>Bootstrapped ellipses<a class="headerlink" href="#bootstrapped-ellipses" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mode_1_bpars</span><span class="o">=</span><span class="n">pmag</span><span class="o">.</span><span class="n">dokent</span><span class="p">(</span><span class="n">mode_1_BDIs</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">mode_2_bpars</span><span class="o">=</span><span class="n">pmag</span><span class="o">.</span><span class="n">dokent</span><span class="p">(</span><span class="n">mode_2_BDIs</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot the data</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">plot_net</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">plot_di</span><span class="p">(</span><span class="n">di_block</span><span class="o">=</span><span class="n">di_block</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">edge</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="c1"># draw on the means and lpha95</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">plot_di_mean_ellipse</span><span class="p">(</span><span class="n">mode_1_bpars</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;cyan&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">plot_di_mean_ellipse</span><span class="p">(</span><span class="n">mode_2_bpars</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;cyan&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/c9720d180349a0a566001b1b3e2d68d277bd861fef5c8cc793a2826f3f9c2574.png" src="../_images/c9720d180349a0a566001b1b3e2d68d277bd861fef5c8cc793a2826f3f9c2574.png" />
</div>
</div>
</section>
</section>
<section id="eqarea-magic">
<h2>eqarea_magic<a class="headerlink" href="#eqarea-magic" title="Permalink to this heading">#</a></h2>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch2.html#x15-1560008">[Essentials Chapter 2]</a> <a class="reference external" href="https://earthref.org/MagIC">[MagIC Database]</a>  <a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#eqarea_magic.py">[command line version]</a></p>
<p><strong>eqarea_magic</strong> takes MagIC data model 3 files and makes equal area projections of declination, inclination data for a variety of  selections,
i.e. all the data, by site, by sample, or by specimen
It has the option to plot in different coordinate systems (if available) and various ellipses.  It will also make a color contour plot if desired.<br />
We will do this with <strong>ipmag.plot_net()</strong> and <strong>ipmag_plot_di()</strong> using <strong>Pandas</strong> filtering capability.</p>
<p>Let’s start with a simple plot of site mean directions, assuming that they were interpreted from measurements using <strong>pmag_gui.py</strong> or some such program and have all the required meta-data.</p>
<p>We want data in geographic coordinates (dir_tilt_correction=0).  The keys for directions are dir_dec and dir_inc.     One could add the ellipses using <strong>ipmag.plot_di_mean_ellipse()</strong>.</p>
<section id="whole-study">
<h3>whole study<a class="headerlink" href="#whole-study" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sites</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data_files/eqarea_magic/sites.txt&#39;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">site_dirs</span><span class="o">=</span><span class="n">sites</span><span class="p">[</span><span class="n">sites</span><span class="p">[</span><span class="s1">&#39;dir_tilt_correction&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">plot_net</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">di_block</span><span class="o">=</span><span class="n">sites</span><span class="p">[[</span><span class="s1">&#39;dir_dec&#39;</span><span class="p">,</span><span class="s1">&#39;dir_inc&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
<span class="c1">#ipmag.plot_di(sites[&#39;dir_dec&#39;].values,sites[&#39;dir_inc&#39;].values,color=&#39;blue&#39;,markersize=50)</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">plot_di</span><span class="p">(</span><span class="n">di_block</span><span class="o">=</span><span class="n">di_block</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/e17b83887a8edd096799167bb0276ae3bff0bc68eebb2fe167400a12816dc886.png" src="../_images/e17b83887a8edd096799167bb0276ae3bff0bc68eebb2fe167400a12816dc886.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># or, using ipmag.eqarea_magic:</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">eqarea_magic</span><span class="p">(</span><span class="s1">&#39;data_files/eqarea_magic/sites.txt&#39;</span><span class="p">,</span> <span class="n">save_plots</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>388  sites records read in
All
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(True, [])
</pre></div>
</div>
<img alt="../_images/d89caabfe412ae4c15c95b061cd241902e759b336b3a770f9508ff4dfd420a74.png" src="../_images/d89caabfe412ae4c15c95b061cd241902e759b336b3a770f9508ff4dfd420a74.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># with a contribution </span>
<span class="n">con</span> <span class="o">=</span> <span class="n">cb</span><span class="o">.</span><span class="n">Contribution</span><span class="p">(</span><span class="s2">&quot;data_files/3_0/Osler&quot;</span><span class="p">)</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">eqarea_magic</span><span class="p">(</span><span class="n">crd</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">contribution</span><span class="o">=</span><span class="n">con</span><span class="p">,</span> <span class="n">source_table</span><span class="o">=</span><span class="s1">&#39;sites&#39;</span><span class="p">,</span> <span class="n">save_plots</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>90  sites records read in
All
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(True, [])
</pre></div>
</div>
<img alt="../_images/e2d4859c9011a36a9a1360313172c2cda1b23ac4bccee9f1f6ba2767b4d92d2e.png" src="../_images/e2d4859c9011a36a9a1360313172c2cda1b23ac4bccee9f1f6ba2767b4d92d2e.png" />
</div>
</div>
</section>
<section id="whole-study-with-color-contour-option">
<h3>whole study with color contour option<a class="headerlink" href="#whole-study-with-color-contour-option" title="Permalink to this heading">#</a></h3>
<p>for this we can use the function <strong>pmagplotlib.plot_eq_cont()</strong> which makes a color contour of a dec, inc data</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pmagplotlib</span><span class="o">.</span><span class="n">plot_eq_cont</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function plot_eq_cont in module pmagpy.pmagplotlib:

plot_eq_cont(fignum, DIblock, color_map=&#39;coolwarm&#39;)
    plots dec inc block as a color contour
    Parameters
    __________________
    Input:
        fignum :  figure number
        DIblock : nested pairs of [Declination, Inclination]
        color_map : matplotlib color map [default is coolwarm]
    Output:
        figure
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ipmag</span><span class="o">.</span><span class="n">plot_net</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">pmagplotlib</span><span class="o">.</span><span class="n">plot_eq_cont</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">di_block</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/564d493261913c9c2b1312724deed3455a1a0ae7024231fdb8d45c1f6f25f373.png" src="../_images/564d493261913c9c2b1312724deed3455a1a0ae7024231fdb8d45c1f6f25f373.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># with ipmag.eqarea_magic</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">eqarea_magic</span><span class="p">(</span><span class="s1">&#39;data_files/eqarea_magic/sites.txt&#39;</span><span class="p">,</span> <span class="n">save_plots</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">contour</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>388  sites records read in
All
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(True, [])
</pre></div>
</div>
<img alt="../_images/136519955f214963d7f48df0e90505681f651ef41d59a65e99faea95245f8384.png" src="../_images/136519955f214963d7f48df0e90505681f651ef41d59a65e99faea95245f8384.png" />
</div>
</div>
</section>
<section id="specimens-by-site">
<h3>specimens by site<a class="headerlink" href="#specimens-by-site" title="Permalink to this heading">#</a></h3>
<p>This study averaged specimens (not samples) by site, so we would like to make plots of all the specimen data for each site.   We can do things the in a similar way to what we did in the <strong>dmag_magic</strong> example.<br />
A few particulars:</p>
<ul class="simple">
<li><p>We will be plotting specimen interpetations in geographic coordinates (dir_tilt_correction=0)</p></li>
<li><p>We need to look at the method codes as there might be fisher means, principal components, great circles, etc.  A complete list of method codes for Direction Estimation can be found here:  <a class="reference external" href="https://www2.earthref.org/MagIC/method-codes">https://www2.earthref.org/MagIC/method-codes</a></p></li>
<li><p>There might be ‘bad’ directions - ‘result_quality’=’b’ as opposed to ‘g’.</p></li>
<li><p>There are a lot of sites in this study, so let’s just look at the first 10…</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># read in specimen table</span>
<span class="n">spec_df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data_files/eqarea_magic/specimens.txt&#39;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> 
<span class="c1"># read in sample table</span>
<span class="n">samp_df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data_files/eqarea_magic/samples.txt&#39;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> 
<span class="c1"># get only what we need from samples (sample to site mapping)</span>
<span class="n">samp_df</span><span class="o">=</span><span class="n">samp_df</span><span class="p">[[</span><span class="s1">&#39;sample&#39;</span><span class="p">,</span><span class="s1">&#39;site&#39;</span><span class="p">]]</span> 
<span class="c1"># merge site to specimen name in the specimen data frame</span>
<span class="n">df_ext</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">spec_df</span><span class="p">,</span><span class="n">samp_df</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">,</span><span class="n">on</span><span class="o">=</span><span class="s1">&#39;sample&#39;</span><span class="p">)</span> 
<span class="c1"># truncate to the first 10 sites</span>
<span class="n">sites</span><span class="o">=</span><span class="n">df_ext</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">unique</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">11</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>We need to filter specimen data for dir_tilt_correction=0
and separate into DE-BFP (best fit planes) and not.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># get the geographic coordinates</span>
<span class="n">spec_df</span><span class="o">=</span><span class="n">df_ext</span><span class="p">[</span><span class="n">spec_df</span><span class="o">.</span><span class="n">dir_tilt_correction</span><span class="o">==</span><span class="mi">0</span><span class="p">]</span>
<span class="c1"># filter to exclude planes</span>
<span class="n">spec_lines</span><span class="o">=</span><span class="n">spec_df</span><span class="p">[</span><span class="n">spec_df</span><span class="o">.</span><span class="n">method_codes</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;DE-BFP&#39;</span><span class="p">)</span><span class="o">==</span><span class="kc">False</span><span class="p">]</span>
<span class="c1"># filter for planes</span>
<span class="n">spec_df_gc</span><span class="o">=</span><span class="n">spec_df</span><span class="p">[</span><span class="n">spec_df</span><span class="o">.</span><span class="n">method_codes</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;DE-BFP&#39;</span><span class="p">)</span><span class="o">==</span><span class="kc">True</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># here&#39;s a new one:</span>
<span class="n">help</span><span class="p">(</span><span class="n">ipmag</span><span class="o">.</span><span class="n">plot_gc</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function plot_gc in module pmagpy.ipmag:

plot_gc(poles, color=&#39;g&#39;, fignum=1)
    plots a great circle on an equal area projection
    Parameters
    ____________________
    Input
       fignum : number of matplotlib object
       poles : nested list of [Dec,Inc] pairs of poles
       color : color of lower hemisphere dots for great circle - must be in form: &#39;g&#39;,&#39;r&#39;,&#39;y&#39;,&#39;k&#39;,etc.
               upper hemisphere is always cyan
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cnt</span><span class="o">=</span><span class="mi">1</span>
<span class="k">for</span> <span class="n">site</span> <span class="ow">in</span> <span class="n">sites</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">cnt</span><span class="p">)</span>
    <span class="n">ipmag</span><span class="o">.</span><span class="n">plot_net</span><span class="p">(</span><span class="n">cnt</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">site</span><span class="p">)</span>
    <span class="n">site_lines</span><span class="o">=</span><span class="n">spec_lines</span><span class="p">[</span><span class="n">spec_lines</span><span class="o">.</span><span class="n">site</span><span class="o">==</span><span class="n">site</span><span class="p">]</span> <span class="c1"># fish out this site</span>
    <span class="n">ipmag</span><span class="o">.</span><span class="n">plot_di</span><span class="p">(</span><span class="n">site_lines</span><span class="o">.</span><span class="n">dir_dec</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">site_lines</span><span class="o">.</span><span class="n">dir_inc</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
    <span class="n">site_planes</span><span class="o">=</span><span class="n">spec_df_gc</span><span class="p">[</span><span class="n">spec_df_gc</span><span class="o">.</span><span class="n">site</span><span class="o">==</span><span class="n">site</span><span class="p">]</span>
    <span class="n">poles</span><span class="o">=</span><span class="n">site_planes</span><span class="p">[[</span><span class="s1">&#39;dir_dec&#39;</span><span class="p">,</span><span class="s1">&#39;dir_inc&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
    <span class="k">if</span> <span class="n">poles</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">ipmag</span><span class="o">.</span><span class="n">plot_gc</span><span class="p">(</span><span class="n">poles</span><span class="p">,</span><span class="n">fignum</span><span class="o">=</span><span class="n">cnt</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">cnt</span><span class="o">+=</span><span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/7effde0b509e42f03886129c1bc14d592fecaebeef78901e9363651efa65f5e3.png" src="../_images/7effde0b509e42f03886129c1bc14d592fecaebeef78901e9363651efa65f5e3.png" />
<img alt="../_images/f6c9f5e2c921a9355fe5d26b43cb131dcb24ecdce4f2f0eb29e633e30c6ce99d.png" src="../_images/f6c9f5e2c921a9355fe5d26b43cb131dcb24ecdce4f2f0eb29e633e30c6ce99d.png" />
<img alt="../_images/cac58d0a6e010d3e264697881e4cfbff7c044c27b8bb7ef718e8303e849fb77b.png" src="../_images/cac58d0a6e010d3e264697881e4cfbff7c044c27b8bb7ef718e8303e849fb77b.png" />
<img alt="../_images/334bdd3adfe58ea454cdcb0be7ed0330543e8ea27b5195126abc00bd1883bbed.png" src="../_images/334bdd3adfe58ea454cdcb0be7ed0330543e8ea27b5195126abc00bd1883bbed.png" />
<img alt="../_images/8296a5483379905e6f2bb4e96ab658cadf8927f438447c8f18e3aefade8e5484.png" src="../_images/8296a5483379905e6f2bb4e96ab658cadf8927f438447c8f18e3aefade8e5484.png" />
<img alt="../_images/ef9f5ed7aae9752f5177c8664b7f3990140ab15c98afd6557d6b0489e585db3f.png" src="../_images/ef9f5ed7aae9752f5177c8664b7f3990140ab15c98afd6557d6b0489e585db3f.png" />
<img alt="../_images/093a847758ab8eb2382761f9efa2019b0cc4a9017d8ca5484821c968600d8ef0.png" src="../_images/093a847758ab8eb2382761f9efa2019b0cc4a9017d8ca5484821c968600d8ef0.png" />
<img alt="../_images/d722f04004f58a93b3709c68f0ec4bf5073fdb285b4ef9347865ac00935631ff.png" src="../_images/d722f04004f58a93b3709c68f0ec4bf5073fdb285b4ef9347865ac00935631ff.png" />
<img alt="../_images/d07946823e67f929dc4c38700c95ef681951b68990a6b3d7bef9728787d5f777.png" src="../_images/d07946823e67f929dc4c38700c95ef681951b68990a6b3d7bef9728787d5f777.png" />
<img alt="../_images/d2ca9631e855abaf7d0540813c8da3e47fa461183d06997491fb46317700520e.png" src="../_images/d2ca9631e855abaf7d0540813c8da3e47fa461183d06997491fb46317700520e.png" />
<img alt="../_images/f4f918af0b3b2ec995cdda54c60476db994481f17a43f3a3867bbb6b2a2c5a39.png" src="../_images/f4f918af0b3b2ec995cdda54c60476db994481f17a43f3a3867bbb6b2a2c5a39.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># using ipmag.eqarea_magic:</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">eqarea_magic</span><span class="p">(</span><span class="s1">&#39;specimens.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;data_files/eqarea_magic&#39;</span><span class="p">,</span> <span class="n">plot_by</span><span class="o">=</span><span class="s1">&#39;sit&#39;</span><span class="p">,</span> <span class="n">save_plots</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1374  specimens records read in
mc01
mc02
mc03
mc04
mc06
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(True, [])
</pre></div>
</div>
<img alt="../_images/3ab78c106044dfd6fa6bbf06414c7bbeeb8fc5d9c050efa493eaae15ba3300c1.png" src="../_images/3ab78c106044dfd6fa6bbf06414c7bbeeb8fc5d9c050efa493eaae15ba3300c1.png" />
<img alt="../_images/73b620f1802ff8e3fcdef5dfc702ff8a0ab9cc8f2b01fafe87bd0084740c41aa.png" src="../_images/73b620f1802ff8e3fcdef5dfc702ff8a0ab9cc8f2b01fafe87bd0084740c41aa.png" />
<img alt="../_images/3fe8b4a88c9381641b4bc74cd5f6fb06612dbee9e4ee674ad92bb3b61027736d.png" src="../_images/3fe8b4a88c9381641b4bc74cd5f6fb06612dbee9e4ee674ad92bb3b61027736d.png" />
<img alt="../_images/61efb12bc03f96e5d6be27b9c8eb4e6741466efdb82a8de5f83f4d03ac517f3c.png" src="../_images/61efb12bc03f96e5d6be27b9c8eb4e6741466efdb82a8de5f83f4d03ac517f3c.png" />
<img alt="../_images/d2f16073c1c41071c99a2fb609824bd9336d0650c6ae6dedda1f4202fc18115f.png" src="../_images/d2f16073c1c41071c99a2fb609824bd9336d0650c6ae6dedda1f4202fc18115f.png" />
</div>
</div>
</section>
<section id="measurements-by-specimen">
<h3>measurements by specimen<a class="headerlink" href="#measurements-by-specimen" title="Permalink to this heading">#</a></h3>
<p>We can do this like this:</p>
<ul class="simple">
<li><p>read in the MagIC data model 3 measurements table into a <strong>Pandas</strong> data frame</p></li>
<li><p>get a list of unique specimen names</p></li>
<li><p>truncate this to the first 10 for this purpose</p></li>
<li><p>plot the dir_dec and dir_inc fields by specimen</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># read in measurements table</span>
<span class="n">meas_df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data_files/eqarea_magic/measurements.txt&#39;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> 
<span class="n">specimens</span><span class="o">=</span><span class="n">meas_df</span><span class="o">.</span><span class="n">specimen</span><span class="o">.</span><span class="n">unique</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">11</span><span class="p">]</span>
<span class="n">cnt</span><span class="o">=</span><span class="mi">1</span>
<span class="k">for</span> <span class="n">spec</span> <span class="ow">in</span> <span class="n">specimens</span><span class="p">:</span>
    <span class="n">meas_spc</span><span class="o">=</span><span class="n">meas_df</span><span class="p">[</span><span class="n">meas_df</span><span class="o">.</span><span class="n">specimen</span><span class="o">==</span><span class="n">spec</span><span class="p">]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">cnt</span><span class="p">)</span>
    <span class="n">ipmag</span><span class="o">.</span><span class="n">plot_net</span><span class="p">(</span><span class="n">cnt</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
    <span class="n">ipmag</span><span class="o">.</span><span class="n">plot_di</span><span class="p">(</span><span class="n">meas_spc</span><span class="o">.</span><span class="n">dir_dec</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">meas_spc</span><span class="o">.</span><span class="n">dir_inc</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
    <span class="n">cnt</span><span class="o">+=</span><span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3097ab09046b05cfae243ce65db667dc3ec6a01a992645c2aae1086f4c99fef3.png" src="../_images/3097ab09046b05cfae243ce65db667dc3ec6a01a992645c2aae1086f4c99fef3.png" />
<img alt="../_images/40b5b01743b3c9cf7e68de52f649494e3e2486a1539f3009137d0c7b66b93cb2.png" src="../_images/40b5b01743b3c9cf7e68de52f649494e3e2486a1539f3009137d0c7b66b93cb2.png" />
<img alt="../_images/51c35fc9709ae5df94060027bf985548f2a614291604b721a041d3aa57a4d1fe.png" src="../_images/51c35fc9709ae5df94060027bf985548f2a614291604b721a041d3aa57a4d1fe.png" />
<img alt="../_images/82fcd1411cb1f5dc3879aa2186587f11defb7e69e6af10b88806fd65346db8bb.png" src="../_images/82fcd1411cb1f5dc3879aa2186587f11defb7e69e6af10b88806fd65346db8bb.png" />
<img alt="../_images/3999c5f38dedd78f14a632b5d1dc30e34a3374b253ab9bcf0ca144417258cae0.png" src="../_images/3999c5f38dedd78f14a632b5d1dc30e34a3374b253ab9bcf0ca144417258cae0.png" />
<img alt="../_images/7ca9b3fa8d9ad932d277a15d4a22de9ca7c64678357f7b4bb2725247cc6dbb9a.png" src="../_images/7ca9b3fa8d9ad932d277a15d4a22de9ca7c64678357f7b4bb2725247cc6dbb9a.png" />
<img alt="../_images/e66ba6db6dc854c8e53aad0fb52419fba8453cb245261c41d004613f91b96767.png" src="../_images/e66ba6db6dc854c8e53aad0fb52419fba8453cb245261c41d004613f91b96767.png" />
<img alt="../_images/bfcdf8959de7644aa8c381ce8d8e9c6fd83cfe04c5ddccc310d91ae303c66e32.png" src="../_images/bfcdf8959de7644aa8c381ce8d8e9c6fd83cfe04c5ddccc310d91ae303c66e32.png" />
<img alt="../_images/60534dae079fa421f4438866456576f5656ef1a3b46b5d8fde9c4f306a5c2d32.png" src="../_images/60534dae079fa421f4438866456576f5656ef1a3b46b5d8fde9c4f306a5c2d32.png" />
<img alt="../_images/85fbcb9fc9bc9762b74b773716acb78c4e7974198ae27dd0da7d6f302e0cb04e.png" src="../_images/85fbcb9fc9bc9762b74b773716acb78c4e7974198ae27dd0da7d6f302e0cb04e.png" />
<img alt="../_images/5404df9b43be6734779e2e1e3ce8b246e62ba9cab1519683686c844f6f76bd0f.png" src="../_images/5404df9b43be6734779e2e1e3ce8b246e62ba9cab1519683686c844f6f76bd0f.png" />
</div>
</div>
</section>
<section id="individual-specimens">
<h3>Individual specimens<a class="headerlink" href="#individual-specimens" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># using ipmag.eqarea_magic:</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">eqarea_magic</span><span class="p">(</span><span class="s1">&#39;specimens.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;data_files/eqarea_magic&#39;</span><span class="p">,</span> <span class="n">plot_by</span><span class="o">=</span><span class="s1">&#39;spc&#39;</span><span class="p">,</span> <span class="n">save_plots</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1374  specimens records read in
mc01a
no records for plotting
mc01b
mc01c
mc01d
mc01e
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(True, [])
</pre></div>
</div>
<img alt="../_images/7b64d6efc602e506fad5462083944771b549bcab4df69303e3392379628ae099.png" src="../_images/7b64d6efc602e506fad5462083944771b549bcab4df69303e3392379628ae099.png" />
<img alt="../_images/a5261d59ef4249795a1baf5b48fdcb2803d6d9ef9e4898e661fd506b4e621120.png" src="../_images/a5261d59ef4249795a1baf5b48fdcb2803d6d9ef9e4898e661fd506b4e621120.png" />
<img alt="../_images/ff63d3906a49be71360cd04b60eb6144a92af020ea5546a445b1883e18afd53f.png" src="../_images/ff63d3906a49be71360cd04b60eb6144a92af020ea5546a445b1883e18afd53f.png" />
<img alt="../_images/8e426c65c71fb91c3f60f38210cb55c7f1dfc77ad1ac83f039f41f682976dde2.png" src="../_images/8e426c65c71fb91c3f60f38210cb55c7f1dfc77ad1ac83f039f41f682976dde2.png" />
</div>
</div>
</section>
</section>
<section id="find-ei">
<h2>find_ei<a class="headerlink" href="#find-ei" title="Permalink to this heading">#</a></h2>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch14.html#x15-1560008">[Essentials Chapter 14]</a> <a class="reference external" href="https://earthref.org/MagIC">[MagIC Database]</a>  <a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#find_ei.py">[command line version]</a></p>
<p>This program is meant to find the unflattening factor (see <span class="xref myst">unsquish</span> documentation) that brings a sedimentary data set into agreement with the statistical field model TK03 of Tauxe and Kent (2004, doi: 10.1029/145GM08).  It  has been implemented for notebooks as <strong>ipmag.find_ei()</strong>.</p>
<p>A data file (data_files/find_EI/find_EI_example.dat) was prepared using the program <strong><span class="xref myst">tk03</span></strong>  to simulate directions at a latitude of 42<span class="math notranslate nohighlight">\(^{\circ}\)</span>. with an expected inclination of 61<span class="math notranslate nohighlight">\(^{\circ}\)</span> (which could be gotten using <strong><span class="xref myst">dipole_pinc</span></strong> of course.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">ipmag</span><span class="o">.</span><span class="n">find_ei</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function find_ei in module pmagpy.ipmag:

find_ei(data, nb=1000, save=False, save_folder=&#39;.&#39;, fmt=&#39;svg&#39;, site_correction=False, return_new_dirs=False)
    Applies series of assumed flattening factor and &quot;unsquishes&quot; inclinations assuming tangent function.
    Finds flattening factor that gives elongation/inclination pair consistent with TK03;
    or, if correcting by site instead of for study-level secular variation,
    finds flattening factor that minimizes elongation and most resembles a
    Fisherian distribution.
    Finds bootstrap confidence bounds
    
    Required Parameter
    -----------
    data: a nested list of dec/inc pairs
    
    Optional Parameters (defaults are used unless specified)
    -----------
    nb: number of bootstrapped pseudo-samples (default is 1000)
    save: Boolean argument to save plots (default is False)
    save_folder: path to folder in which plots should be saved (default is current directory)
    fmt: specify format of saved plots (default is &#39;svg&#39;)
    site_correction: Boolean argument to specify whether to &quot;unsquish&quot; data to
        1) the elongation/inclination pair consistent with TK03 secular variation model
        (site_correction = False)
        or
        2) a Fisherian distribution (site_correction = True). Default is FALSE.
        Note that many directions (~ 100) are needed for this correction to be reliable.
    return_new_dirs: optional return of newly &quot;unflattened&quot; directions (default is False)
    
    Returns
    -----------
    four plots:   1) equal area plot of original directions
                  2) Elongation/inclination pairs as a function of f,  data plus 25 bootstrap samples
                  3) Cumulative distribution of bootstrapped optimal inclinations plus uncertainties.
                     Estimate from original data set plotted as solid line
                  4) Orientation of principle direction through unflattening
    
    NOTE: If distribution does not have a solution, plot labeled: Pathological.  Some bootstrap samples may have
       valid solutions and those are plotted in the CDFs and E/I plot.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;data_files/find_EI/find_EI_example.dat&#39;</span><span class="p">)</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">find_ei</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Bootstrapping.... be patient

The original inclination was: 38.92904490925402

The corrected inclination is: 58.83246032206779
with bootstrapped confidence bounds of: 47.97995046611144 to 67.19209713147673
and elongation parameter of: 1.4678654859428288
The flattening factor is: 0.4249999999999995
</pre></div>
</div>
<img alt="../_images/027e65d435c96ce78e6897a105f56e67bbb64aa29d70630ee06b0bdb42ed99b4.png" src="../_images/027e65d435c96ce78e6897a105f56e67bbb64aa29d70630ee06b0bdb42ed99b4.png" />
<img alt="../_images/bb761f92596d57cfe29e5415f643409e15abbf8a75883a4988e82b9e11b09371.png" src="../_images/bb761f92596d57cfe29e5415f643409e15abbf8a75883a4988e82b9e11b09371.png" />
<img alt="../_images/fac35b04bab2917d82d3930d43b490c0b074ef69a7e6d6524af1b1b1e46e00cc.png" src="../_images/fac35b04bab2917d82d3930d43b490c0b074ef69a7e6d6524af1b1b1e46e00cc.png" />
<img alt="../_images/4d5306a0cb0d69fca9b54a3760abf1ec3e1012b2d7407c3e3bf3124d56219e1c.png" src="../_images/4d5306a0cb0d69fca9b54a3760abf1ec3e1012b2d7407c3e3bf3124d56219e1c.png" />
</div>
</div>
<p>In this example, the original expected inclination at paleolatitude of 42 (61<span class="math notranslate nohighlight">\(^{\circ}\)</span>) is recovered within the 95% confidence bounds.</p>
</section>
<section id="fishqq">
<h2>fishqq<a class="headerlink" href="#fishqq" title="Permalink to this heading">#</a></h2>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch11.html">[Essentials Chapter 11]</a>
<a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#fishqq.py">[command line version]</a></p>
<p>This program tests whether a given directional data set is Fisher distributed using a Quantile-Quantile plot (see also <span class="xref myst">qqunf</span> or <span class="xref myst">qqplot</span> for more on Quantile-Quantile plots).</p>
<p>Blessedly, <strong>fishqq</strong> has been incorporated into <strong>ipmag.fishqq()</strong> for use within notebooks.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">ipmag</span><span class="o">.</span><span class="n">fishqq</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function fishqq in module pmagpy.ipmag:

fishqq(lon=None, lat=None, di_block=None)
    Test whether a distribution is Fisherian and make a corresponding Q-Q plot.
    The Q-Q plot shows the data plotted against the value expected from a
    Fisher distribution. The first plot is the uniform plot which is the
    Fisher model distribution in terms of longitude (declination). The second
    plot is the exponential plot which is the Fisher model distribution in terms
    of latitude (inclination). In addition to the plots, the test statistics Mu
    (uniform) and Me (exponential) are calculated and compared against the
    critical test values. If Mu or Me are too large in comparision to the test
    statistics, the hypothesis that the distribution is Fisherian is rejected
    (see Fisher et al., 1987).
    
    Parameters:
    -----------
    lon : longitude or declination of the data
    lat : latitude or inclination of the data
        or
    di_block: a nested list of [dec,inc]
        A di_block can be provided in which case it will be used instead of
        dec, inc lists.
    
    Output:
    -----------
    dictionary containing
    lon : mean longitude (or declination)
    lat : mean latitude (or inclination)
    N : number of vectors
    Mu : Mu test statistic value for the data
    Mu_critical : critical value for Mu
    Me : Me test statistic value for the data
    Me_critical : critical value for Me
    
    if the data has two modes with N &gt;=10 (N and R)
    two of these dictionaries will be returned
    
    Examples
    --------
    In this example, directions are sampled from a Fisher distribution using
    ``ipmag.fishrot`` and then the ``ipmag.fishqq`` function is used to test
    whether that distribution is Fisherian:
    
    &gt;&gt;&gt; directions = ipmag.fishrot(k=40, n=50, dec=200, inc=50)
    &gt;&gt;&gt; ipmag.fishqq(di_block = directions)
    {&#39;Dec&#39;: 199.73564290371894,
    &#39;Inc&#39;: 49.017612342358298,
    &#39;Me&#39;: 0.78330310031220352,
    &#39;Me_critical&#39;: 1.094,
    &#39;Mode&#39;: &#39;Mode 1&#39;,
    &#39;Mu&#39;: 0.69915926146177099,
    &#39;Mu_critical&#39;: 1.207,
    &#39;N&#39;: 50,
    &#39;Test_result&#39;: &#39;consistent with Fisherian model&#39;}
    
    The above example passed a di_block to the function as an input. Lists of
    paired declination and inclination can also be used as inputs. Here the
    directions di_block is unpacked to separate declination and inclination
    lists using the ``ipmag.unpack_di_block`` functionwhich are then used as
    input to fishqq:
    
    &gt;&gt;&gt; dec_list, inc_list = ipmag.unpack_di_block(directions)
    &gt;&gt;&gt; ipmag.fishqq(lon=dec_list, lat=inc_list)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">di_block</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;data_files/fishqq/fishqq_example.txt&#39;</span><span class="p">)</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">fishqq</span><span class="p">(</span><span class="n">di_block</span><span class="o">=</span><span class="n">di_block</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;Mode&#39;: &#39;Mode 1&#39;,
 &#39;Dec&#39;: 305.2748079001374,
 &#39;Inc&#39;: 89.0552105546049,
 &#39;N&#39;: 100,
 &#39;Mu&#39;: 0.09595300000000008,
 &#39;Mu_critical&#39;: 1.207,
 &#39;Me&#39;: 0.744655603828423,
 &#39;Me_critical&#39;: 1.094,
 &#39;Test_result&#39;: &#39;consistent with Fisherian model&#39;}
</pre></div>
</div>
<img alt="../_images/f4c054c85421f4fe37578d63e7643b2d25e24f4157d6b1a99765720ff3108eb9.png" src="../_images/f4c054c85421f4fe37578d63e7643b2d25e24f4157d6b1a99765720ff3108eb9.png" />
</div>
</div>
</section>
<section id="foldtest">
<h2>foldtest<a class="headerlink" href="#foldtest" title="Permalink to this heading">#</a></h2>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch12.html">[Essentials Chapter 12]</a>
<a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#foldtest.py">[command line version]</a></p>
<p><strong>foldtest</strong> uses the fold test of Tauxe and Watson (1994, 10.1016/0012-821x(94)90006-x  ) to find the degree of unfolding that produces the tightest distribution of directions (using the eigenvalue <span class="math notranslate nohighlight">\(\tau_1\)</span> as the criterion.</p>
<p>This can be done via <strong>pmag.bootstrap_fold_test()</strong>. Note that this can take several minutes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">ipmag</span><span class="o">.</span><span class="n">bootstrap_fold_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function bootstrap_fold_test in module pmagpy.ipmag:

bootstrap_fold_test(Data, num_sims=1000, min_untilt=-10, max_untilt=120, bedding_error=0, save=False, save_folder=&#39;.&#39;, fmt=&#39;svg&#39;, ninety_nine=False)
    Conduct a bootstrap fold test (Tauxe and Watson, 1994)
    
    Three plots are generated: 1) equal area plot of uncorrected data;
    2) tilt-corrected equal area plot; 3) bootstrap results showing the trend
    of the largest eigenvalues for a selection of the pseudo-samples (red
    dashed lines), the cumulative distribution of the eigenvalue maximum (green
    line) and the confidence bounds that enclose 95% of the pseudo-sample
    maxima. If the confidence bounds enclose 100% unfolding, the data &quot;pass&quot;
    the fold test.
    
    Parameters
    ----------
    Data : a numpy array of directional data [dec, inc, dip_direction, dip]
    num_sims : number of bootstrap samples (default is 1000)
    min_untilt : minimum percent untilting applied to the data (default is -10%)
    max_untilt : maximum percent untilting applied to the data (default is 120%)
    bedding_error : (circular standard deviation) for uncertainty on bedding poles
    save : optional save of plots (default is False)
    save_folder : path to directory where plots should be saved
    fmt : format of figures to be saved (default is &#39;svg&#39;)
    ninety_nine : changes confidence bounds from 95 percent to 99 if True
    
    Returns
    -------
    three plots : uncorrected data equal area plot, tilt-corrected data equal
    area plot, bootstrap results and CDF of the eigenvalue maximum
    
    Examples
    --------
    Data in separate lists of dec, inc, dip_direction, dip data can be made into
    the needed array using the ``ipmag.make_diddd_array`` function.
    
    &gt;&gt;&gt; dec = [132.5,124.3,142.7,130.3,163.2]
    &gt;&gt;&gt; inc = [12.1,23.2,34.2,37.7,32.6]
    &gt;&gt;&gt; dip_direction = [265.0,265.0,265.0,164.0,164.0]
    &gt;&gt;&gt; dip = [20.0,20.0,20.0,72.0,72.0]
    &gt;&gt;&gt; data_array = ipmag.make_diddd_array(dec,inc,dip_direction,dip)
    &gt;&gt;&gt; data_array
    array([[ 132.5,   12.1,  265. ,   20. ],
       [ 124.3,   23.2,  265. ,   20. ],
       [ 142.7,   34.2,  265. ,   20. ],
       [ 130.3,   37.7,  164. ,   72. ],
       [ 163.2,   32.6,  164. ,   72. ]])
    
    This array can then be passed to the function:
    
    &gt;&gt;&gt; ipmag.bootstrap_fold_test(data_array)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;data_files/foldtest/foldtest_example.dat&#39;</span><span class="p">)</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">bootstrap_fold_test</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">num_sims</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/a838db60667bb086d873438ed85d4f01b88c142e34c69a03cac014b42e6d3a33.png" src="../_images/a838db60667bb086d873438ed85d4f01b88c142e34c69a03cac014b42e6d3a33.png" />
<img alt="../_images/59d86b02f4c5a45fa7364ded1e77ee30ce1d903e59718f35b6df41bcd477a81c.png" src="../_images/59d86b02f4c5a45fa7364ded1e77ee30ce1d903e59718f35b6df41bcd477a81c.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>doing  300  iterations...please be patient.....

tightest grouping of vectors obtained at (95% confidence bounds):
82 - 119 percent unfolding
range of all bootstrap samples: 
72  -  119 percent unfolding
</pre></div>
</div>
<img alt="../_images/fa75fb74dc610cb5c3ff99889620abed47e5f7a75393bb6820c6537e2436cfd5.png" src="../_images/fa75fb74dc610cb5c3ff99889620abed47e5f7a75393bb6820c6537e2436cfd5.png" />
</div>
</div>
</section>
<section id="foldtest-magic">
<h2>foldtest_magic<a class="headerlink" href="#foldtest-magic" title="Permalink to this heading">#</a></h2>
<p><a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#foldtest_magic.py%5D">[command line version]</a></p>
<p>This is just the MagIC formatted file version of <strong>foldtest</strong> and can be done using <strong>ipmag.bootstrap_fold_test()</strong> as above.  We just have to read in the MagIC formattest files and make a data matrix of the format expected by <strong>ipmag.bootstrap_fold_test()</strong>.  Here, <strong>Pandas</strong> is our friend.  We will:</p>
<ul class="simple">
<li><p>Read in the MagIC (data model 3) formatted file</p></li>
<li><p>Make a <strong>Numpy</strong> array with the required fields</p></li>
<li><p>call <strong>ipmag.bootstrap_foldtest_magic()</strong></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sites</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data_files/foldtest_magic/sites.txt&#39;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">sites</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;bed_dip&#39;, &#39;bed_dip_direction&#39;, &#39;citations&#39;, &#39;conglomerate_test&#39;,
       &#39;contact_test&#39;, &#39;description&#39;, &#39;dir_dec&#39;, &#39;dir_inc&#39;, &#39;dir_k&#39;,
       &#39;dir_n_samples&#39;, &#39;dir_nrm_origin&#39;, &#39;dir_polarity&#39;,
       &#39;dir_tilt_correction&#39;, &#39;geologic_classes&#39;, &#39;geologic_types&#39;, &#39;lat&#39;,
       &#39;lithologies&#39;, &#39;location&#39;, &#39;lon&#39;, &#39;method_codes&#39;, &#39;result_quality&#39;,
       &#39;result_type&#39;, &#39;site&#39;, &#39;vgp_lat&#39;, &#39;vgp_lon&#39;, &#39;vgp_n_samples&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<p>The columns we need are: dir_dec, dir_inc, bed_dip_direction, bed_dip
The dir_dec and dir_inc have to have a dir_tilt_correction of 0 (geographic coordinates).
A little looking through the sites data file shows that the bed_dip_direction are on a separate line (oh database conversion tool maestro, how clever!).  So we will have to pair the bedding orientations with the geographic directional info.  Thank goodness for <strong>Pandas</strong>!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># read in data file</span>
<span class="n">sites</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data_files/foldtest_magic/sites.txt&#39;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># get the records with bed_dip and bed_dip_direction</span>
<span class="n">sites_bedding</span><span class="o">=</span><span class="n">sites</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;bed_dip&#39;</span><span class="p">,</span><span class="s1">&#39;bed_dip_direction&#39;</span><span class="p">])</span>
<span class="c1"># get rid of them out of the original data frame</span>
<span class="n">sites</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;bed_dip&#39;</span><span class="p">,</span><span class="s1">&#39;bed_dip_direction&#39;</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># just pick out what we want (bedding orientation of the sites)</span>
<span class="n">sites_bedding</span><span class="o">=</span><span class="n">sites_bedding</span><span class="p">[[</span><span class="s1">&#39;site&#39;</span><span class="p">,</span><span class="s1">&#39;bed_dip&#39;</span><span class="p">,</span><span class="s1">&#39;bed_dip_direction&#39;</span><span class="p">]]</span>
<span class="c1"># put them back into the original data frame</span>
<span class="n">sites</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">sites</span><span class="p">,</span><span class="n">sites_bedding</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">,</span><span class="n">on</span><span class="o">=</span><span class="s1">&#39;site&#39;</span><span class="p">)</span>
<span class="c1"># now we can pick out the desired coordinate system</span>
<span class="n">sites_geo</span><span class="o">=</span><span class="n">sites</span><span class="p">[</span><span class="n">sites</span><span class="o">.</span><span class="n">dir_tilt_correction</span><span class="o">==</span><span class="mi">0</span><span class="p">]</span>
<span class="c1"># and make our data array</span>
<span class="n">data</span><span class="o">=</span><span class="n">sites_geo</span><span class="p">[[</span><span class="s1">&#39;dir_dec&#39;</span><span class="p">,</span><span class="s1">&#39;dir_inc&#39;</span><span class="p">,</span><span class="s1">&#39;bed_dip_direction&#39;</span><span class="p">,</span><span class="s1">&#39;bed_dip&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
</div>
<p>NB: One unfortunate thing about the MagIC data model is that bedding orientation information can be either in the samples.txt or the sites.txt file.  This example assumes the data are in the <em>sites.txt</em> file.  If not, you can read in the <em>samples.txt</em> file and merge the bedding information with the site directions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># and off we go! </span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">bootstrap_fold_test</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">num_sims</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/de300506e98c5c43b6e471de225f19b39423b5349ff0deb8ec7633d27c5678ee.png" src="../_images/de300506e98c5c43b6e471de225f19b39423b5349ff0deb8ec7633d27c5678ee.png" />
<img alt="../_images/41c7ab2a4434cda4e5cab522dab6ff3affac1dbc2383342d72fcf894caaf0edc.png" src="../_images/41c7ab2a4434cda4e5cab522dab6ff3affac1dbc2383342d72fcf894caaf0edc.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>doing  300  iterations...please be patient.....

tightest grouping of vectors obtained at (95% confidence bounds):
94 - 119 percent unfolding
range of all bootstrap samples: 
63  -  119 percent unfolding
</pre></div>
</div>
<img alt="../_images/103cdbe204b2fcda85a1e6628ee4d206818c612e4fdcd173b3295cad8d838530.png" src="../_images/103cdbe204b2fcda85a1e6628ee4d206818c612e4fdcd173b3295cad8d838530.png" />
</div>
</div>
</section>
<section id="forc-diagram">
<h2>forc_diagram<a class="headerlink" href="#forc-diagram" title="Permalink to this heading">#</a></h2>
<p><a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#forc_diagram.py">[command line version]</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">programs.forc_diagram</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">forc</span> <span class="o">=</span> <span class="n">Forc</span><span class="p">(</span><span class="n">fileAdres</span><span class="o">=</span><span class="s1">&#39;data_files/forc_diagram/conventional_example.forc&#39;</span><span class="p">,</span><span class="n">SF</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.18</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.97</span><span class="p">,</span>
                    <span class="n">bottom</span><span class="o">=</span><span class="mf">0.18</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">forc</span><span class="o">.</span><span class="n">xi</span><span class="o">*</span><span class="mi">1000</span><span class="p">,</span>
            <span class="n">forc</span><span class="o">.</span><span class="n">yi</span><span class="o">*</span><span class="mi">1000</span><span class="p">,</span>
            <span class="n">forc</span><span class="o">.</span><span class="n">zi</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span>
            <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">linewidths</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span><span class="c1">#mt to T</span>

<span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">forc</span><span class="o">.</span><span class="n">xi</span><span class="o">*</span><span class="mi">1000</span><span class="p">,</span>
               <span class="n">forc</span><span class="o">.</span><span class="n">yi</span><span class="o">*</span><span class="mi">1000</span><span class="p">,</span>
               <span class="n">forc</span><span class="o">.</span><span class="n">zi</span><span class="p">,</span>
               <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;rainbow&#39;</span><span class="p">))</span><span class="c1">#vmin=np.min(rho)-0.2)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;B$_</span><span class="si">{c}</span><span class="s1">$ (mT)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;B$_</span><span class="si">{i}</span><span class="s1">$ (mT)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/b6b921a32ce7efc2927473ec34d69079d0afe282c903b3d0ed60a93e9df42ef7.png" src="../_images/b6b921a32ce7efc2927473ec34d69079d0afe282c903b3d0ed60a93e9df42ef7.png" />
</div>
</div>
</section>
<section id="histplot">
<h2>histplot<a class="headerlink" href="#histplot" title="Permalink to this heading">#</a></h2>
<p><a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#gaussian.py">[command line version (in gaussian.py example)]</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span><span class="o">=</span><span class="mi">1000</span>
<span class="n">bins</span><span class="o">=</span><span class="mi">100</span>
<span class="n">norm</span><span class="o">=</span><span class="n">pmag</span><span class="o">.</span><span class="n">gaussdev</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span> <span class="n">xlab</span><span class="o">=</span><span class="s1">&#39;Gaussian Deviates&#39;</span><span class="p">,</span> <span class="n">save_plots</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">norm</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/dc63388734d3bf412ed045d882c7ac0a9c822c9cd12eea3b19d5206717a8da2b.png" src="../_images/dc63388734d3bf412ed045d882c7ac0a9c822c9cd12eea3b19d5206717a8da2b.png" />
</div>
</div>
</section>
<section id="hysteresis-magic">
<h2>hysteresis_magic<a class="headerlink" href="#hysteresis-magic" title="Permalink to this heading">#</a></h2>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch5.html#x15-156000813">[Essentials Chapter 5]</a>
<a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch7.html#x15-156000813">[Essentials Chapter 7]</a>
<a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ap3.html#x21-227000B#x15-156000813">[Essentials Appendix C]</a>
<a class="reference external" href="https://earthref.org/MagIC">[MagIC Database]</a><br />
<a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#hysteresis_magic.py">[command line version]</a></p>
<p>This program plots MagIC formatted measurement data as hysteresis loops, <span class="math notranslate nohighlight">\(\Delta\)</span>M, d<span class="math notranslate nohighlight">\(\Delta\)</span>M and backfield curves, depending on what data are available.  There is an <strong>ipmag.hysteresis_magic</strong> function that does this for us.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">ipmag</span><span class="o">.</span><span class="n">hysteresis_magic</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function hysteresis_magic in module pmagpy.ipmag:

hysteresis_magic(output_dir_path=&#39;.&#39;, input_dir_path=&#39;&#39;, spec_file=&#39;specimens.txt&#39;, meas_file=&#39;measurements.txt&#39;, fmt=&#39;svg&#39;, save_plots=True, make_plots=True, pltspec=&#39;&#39;, n_specs=5, interactive=False)
    Calculate hysteresis parameters and plot hysteresis data.
    Plotting may be called interactively with save_plots==False,
    or be suppressed entirely with make_plots==False.
    
    Parameters
    ----------
    output_dir_path : str, default &quot;.&quot;
        Note: if using Windows, all figures will be saved to working directly
              *not* dir_path
    input_dir_path : str
        path for intput file if different from output_dir_path (default is same)
    spec_file : str, default &quot;specimens.txt&quot;
        output file to save hysteresis data
    meas_file : str, default &quot;measurements.txt&quot;
        input measurement file
    fmt : str, default &quot;svg&quot;
        format for figures, [svg, jpg, pdf, png]
    save_plots : bool, default True
        if True, generate and save all requested plots
    make_plots : bool, default True
        if False, skip making plots and just save hysteresis data
        (if False, save_plots will be set to False also)
    pltspec : str, default &quot;&quot;
        specimen name to plot, otherwise will plot all specimens
    n_specs : int
        number of specimens to plot, default 5
        if you want to make all possible plots, specify &quot;all&quot;
    interactive : bool, default False
        interactively plot and display for each specimen
        (this is best used on the command line or in the Python interpreter)
    
    
    Returns
    ---------
    Tuple : (True or False indicating if conversion was sucessful, output file names written)
</pre></div>
</div>
</div>
</div>
<p>So let’s try this out with some data from Ben-Yosef et al., (2008;doi: 10.1029/2007JB005235). The default is to plot the first 5 specimens and that is enough for us.  We also do not need to save plots at this point.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ipmag</span><span class="o">.</span><span class="n">hysteresis_magic</span><span class="p">(</span><span class="n">output_dir_path</span><span class="o">=</span><span class="s1">&#39;data_files/hysteresis_magic/&#39;</span><span class="p">,</span><span class="n">save_plots</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Plots may be on top of each other - use mouse to place 
IS06a-1 1 out of  5
plotting IRM
IS06a-2 2 out of  5
plotting IRM
IS06a-3 3 out of  5
plotting IRM
IS06a-4 4 out of  5
plotting IRM
IS06a-5 5 out of  5
plotting IRM
-I- overwriting /Users/nebula/Python/PmagPy/data_files/hysteresis_magic/specimens.txt
-I- 14 records written to specimens file
hysteresis parameters saved in  /Users/nebula/Python/PmagPy/data_files/hysteresis_magic/specimens.txt
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(True,
 [&#39;/Users/nebula/Python/PmagPy/data_files/hysteresis_magic/specimens.txt&#39;])
</pre></div>
</div>
<img alt="../_images/6288cb2c63aabaf96297d7c729de0a4cb4f2abf0381ce762e8d35c4850916b56.png" src="../_images/6288cb2c63aabaf96297d7c729de0a4cb4f2abf0381ce762e8d35c4850916b56.png" />
<img alt="../_images/162b9510bf50b43fd530865f7643224f0ac415153c1f3a4641e0f5bf4468b27b.png" src="../_images/162b9510bf50b43fd530865f7643224f0ac415153c1f3a4641e0f5bf4468b27b.png" />
<img alt="../_images/59a5c00a134e01808ac8960d514da47732872e92e5a5389c988065d191dd39a5.png" src="../_images/59a5c00a134e01808ac8960d514da47732872e92e5a5389c988065d191dd39a5.png" />
<img alt="../_images/4bfadb6e93457322fa1159cdebf48881e7982c80680361c960b9fc1b9c468844.png" src="../_images/4bfadb6e93457322fa1159cdebf48881e7982c80680361c960b9fc1b9c468844.png" />
<img alt="../_images/3b987aea998208f70a483446138abd9059e7ad69d62ee8d2170dfe20c37eb8c9.png" src="../_images/3b987aea998208f70a483446138abd9059e7ad69d62ee8d2170dfe20c37eb8c9.png" />
<img alt="../_images/d10c0f98da37ef1678eaf103fd3e2970cc778d2179b22b84b814394cda14cf4b.png" src="../_images/d10c0f98da37ef1678eaf103fd3e2970cc778d2179b22b84b814394cda14cf4b.png" />
<img alt="../_images/aee8fa73c7d7702817dea2d6d51d885f2c85bcf0a7c674ade6c374b6ae2cfc44.png" src="../_images/aee8fa73c7d7702817dea2d6d51d885f2c85bcf0a7c674ade6c374b6ae2cfc44.png" />
<img alt="../_images/2fd78a6e58bbc388a7ac8f0637898bb20b86b061dac1cd6a7513bbbac408709f.png" src="../_images/2fd78a6e58bbc388a7ac8f0637898bb20b86b061dac1cd6a7513bbbac408709f.png" />
<img alt="../_images/9dda515d506bbf1378807557a1fb44ca24d1ae920b5421b34f15aded931adde7.png" src="../_images/9dda515d506bbf1378807557a1fb44ca24d1ae920b5421b34f15aded931adde7.png" />
<img alt="../_images/3bb626a8eaeb1ec32a1a44b836a402878ed7125082c60cbd68dd4d4d4a3a1033.png" src="../_images/3bb626a8eaeb1ec32a1a44b836a402878ed7125082c60cbd68dd4d4d4a3a1033.png" />
<img alt="../_images/733e9e6b686c019f1b116c23fd5d67066a5de030b803c923f4bb1258101d4395.png" src="../_images/733e9e6b686c019f1b116c23fd5d67066a5de030b803c923f4bb1258101d4395.png" />
<img alt="../_images/1144c5508bd46b0c8107d1859a4e305081872284192a3994100802693617fc13.png" src="../_images/1144c5508bd46b0c8107d1859a4e305081872284192a3994100802693617fc13.png" />
<img alt="../_images/0ff37066e61d80e4bb7968a49c894925afba759ed11abafe3ee65e9c7dfe1b73.png" src="../_images/0ff37066e61d80e4bb7968a49c894925afba759ed11abafe3ee65e9c7dfe1b73.png" />
<img alt="../_images/ed5efec494dbde7de8731063dd5c7c77e6b9e5278fb9c05d6b258836b28b1a70.png" src="../_images/ed5efec494dbde7de8731063dd5c7c77e6b9e5278fb9c05d6b258836b28b1a70.png" />
<img alt="../_images/a943c086e93ed0f4ca9b2d1560bfa6fce130440dc5a4879b40e5eaa2738f207d.png" src="../_images/a943c086e93ed0f4ca9b2d1560bfa6fce130440dc5a4879b40e5eaa2738f207d.png" />
<img alt="../_images/4065f7dcd6eac75c83dc41d9617cdfc25adf0b719a2b6ed6021c8c25e13fe01a.png" src="../_images/4065f7dcd6eac75c83dc41d9617cdfc25adf0b719a2b6ed6021c8c25e13fe01a.png" />
<img alt="../_images/355e3d51324f9155e1aef3cf3a6c531347f882c83de0907bb9b473724a5fcad1.png" src="../_images/355e3d51324f9155e1aef3cf3a6c531347f882c83de0907bb9b473724a5fcad1.png" />
<img alt="../_images/17ec706e32310d5994548f821aa03a9026a8849b23fb7f30b13438b6cca64bb6.png" src="../_images/17ec706e32310d5994548f821aa03a9026a8849b23fb7f30b13438b6cca64bb6.png" />
<img alt="../_images/3d3c7f595f6c9ffb0f8fe6c6e769d418feb1619deed2701a7c4de50054000838.png" src="../_images/3d3c7f595f6c9ffb0f8fe6c6e769d418feb1619deed2701a7c4de50054000838.png" />
<img alt="../_images/3c244271a3b2baafddd34630a4406d4b2f91254a9775703531c5b63cf23006e2.png" src="../_images/3c244271a3b2baafddd34630a4406d4b2f91254a9775703531c5b63cf23006e2.png" />
</div>
</div>
</section>
<section id="irm-unmix">
<h2>irm_unmix<a class="headerlink" href="#irm-unmix" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">programs.irm_unmix</span> <span class="k">as</span> <span class="nn">irm_unmix</span>
<span class="kn">from</span> <span class="nn">irm_unmix</span> <span class="kn">import</span> <span class="n">dataFit</span><span class="p">,</span> <span class="n">fit_plots</span>
<span class="n">fitResult</span> <span class="o">=</span> <span class="n">dataFit</span><span class="p">(</span><span class="n">filePath</span><span class="o">=</span><span class="s1">&#39;data_files/irm_unmix/irm_unmix_example.dat&#39;</span><span class="p">,</span><span class="n">fitNumber</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">xfit</span><span class="o">=</span><span class="n">fitResult</span><span class="o">.</span><span class="n">fitDf</span><span class="p">[</span><span class="s1">&#39;field&#39;</span><span class="p">]</span>
<span class="n">xraw</span><span class="o">=</span><span class="n">fitResult</span><span class="o">.</span><span class="n">rawDf</span><span class="p">[</span><span class="s1">&#39;field_log&#39;</span><span class="p">]</span>
<span class="n">yfit</span><span class="o">=</span><span class="n">fitResult</span><span class="o">.</span><span class="n">pdf_best</span>
<span class="n">yraw</span><span class="o">=</span><span class="n">fitResult</span><span class="o">.</span><span class="n">rawDf</span><span class="p">[</span><span class="s1">&#39;rem_grad_norm&#39;</span><span class="p">]</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="n">fit_plots</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">xfit</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">xraw</span><span class="p">,</span><span class="n">yfit</span><span class="p">,</span><span class="n">yraw</span><span class="p">)</span>
<span class="n">fitResult</span><span class="o">.</span><span class="n">params</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table><tr><th> name </th><th> value </th><th> initial value </th><th> min </th><th> max </th><th> vary </th></tr><tr><td> g1_amplitude </td><td>  0.53390862 </td><td> 0.5339086179127271 </td><td>        -inf </td><td>         inf </td><td> True </td></tr><tr><td> g1_center </td><td>  1.58427153 </td><td> 1.5842715282200792 </td><td>        -inf </td><td>         inf </td><td> True </td></tr><tr><td> g1_sigma </td><td>  0.22957229 </td><td> 0.22957229327233647 </td><td>        -inf </td><td>         inf </td><td> True </td></tr><tr><td> g2_amplitude </td><td>  0.16396695 </td><td> 0.16396694781869445 </td><td>        -inf </td><td>         inf </td><td> True </td></tr><tr><td> g2_center </td><td>  2.01085036 </td><td> 2.0108503579413246 </td><td>        -inf </td><td>         inf </td><td> True </td></tr><tr><td> g2_sigma </td><td>  0.35539158 </td><td> 0.355391579140608 </td><td>        -inf </td><td>         inf </td><td> True </td></tr><tr><td> g3_amplitude </td><td>  0.30212443 </td><td> 0.3021244342685791 </td><td>        -inf </td><td>         inf </td><td> True </td></tr><tr><td> g3_center </td><td>  1.11138553 </td><td> 1.1113855342978545 </td><td>        -inf </td><td>         inf </td><td> True </td></tr><tr><td> g3_sigma </td><td>  0.33882510 </td><td> 0.33882510063773785 </td><td>        -inf </td><td>         inf </td><td> True </td></tr></table></div><img alt="../_images/2ae454899f003c2068c38f3356bad87b696fd71cf0f0ba8666fd67a1575262ea.png" src="../_images/2ae454899f003c2068c38f3356bad87b696fd71cf0f0ba8666fd67a1575262ea.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fitResult</span><span class="o">.</span><span class="n">params</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table><tr><th> name </th><th> value </th><th> initial value </th><th> min </th><th> max </th><th> vary </th></tr><tr><td> g1_amplitude </td><td>  0.56463331 </td><td> 0.5646333145811641 </td><td>        -inf </td><td>         inf </td><td> True </td></tr><tr><td> g1_center </td><td>  1.58811229 </td><td> 1.5881122865146795 </td><td>        -inf </td><td>         inf </td><td> True </td></tr><tr><td> g1_sigma </td><td>  0.24132846 </td><td> 0.24132846367458435 </td><td>        -inf </td><td>         inf </td><td> True </td></tr><tr><td> g2_amplitude </td><td>  0.22405528 </td><td> 0.22405527561538238 </td><td>        -inf </td><td>         inf </td><td> True </td></tr><tr><td> g2_center </td><td>  1.69583557 </td><td> 1.695835572488449 </td><td>        -inf </td><td>         inf </td><td> True </td></tr><tr><td> g2_sigma </td><td>  0.47641447 </td><td> 0.47641447056475683 </td><td>        -inf </td><td>         inf </td><td> True </td></tr><tr><td> g3_amplitude </td><td>  0.21131141 </td><td> 0.21131140980345442 </td><td>        -inf </td><td>         inf </td><td> True </td></tr><tr><td> g3_center </td><td>  1.03194281 </td><td> 1.03194280657588 </td><td>        -inf </td><td>         inf </td><td> True </td></tr><tr><td> g3_sigma </td><td>  0.31146631 </td><td> 0.31146631138126807 </td><td>        -inf </td><td>         inf </td><td> True </td></tr></table></div></div>
</div>
</section>
<section id="irmaq-magic">
<h2>irmaq_magic<a class="headerlink" href="#irmaq-magic" title="Permalink to this heading">#</a></h2>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch8.html">[Essentials Chapter 8]</a>
<a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#irmaq_magic.py">[command line version]</a></p>
<p>Someone (Saiko Sugisaki) measured a number of samples from IODP Expedition 318 Hole U1359A for IRM acquisition curves. These were converted to the MagIC measurements format and saved in ../irmaq_magic/measurements.txt.</p>
<p>This program reads in a MagIC data model 3 file with IRM acquisition data and plots it by calling <strong>pmagplotlib.plot_mag()</strong> with options to plot by entire data file, site, sample or individual specimen.  We can do that too!  All we need to know is the method_code for IRM acquisition (which I do), and to propogate specimen =&gt; sample =&gt; site identities if any other plotting option besides “entire file” or by specimen is desired.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
<span class="n">help</span><span class="p">(</span><span class="n">pmagplotlib</span><span class="o">.</span><span class="n">plot_mag</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function plot_mag in module pmagpy.pmagplotlib:

plot_mag(fignum, datablock, s, num, units, norm)
    plots magnetization against (de)magnetizing temperature or field
    
    Parameters
    _________________
    fignum : matplotlib figure number for plotting
    datablock : nested list of [step, 0, 0, magnetization, 1,quality]
    s : string for title
    num : matplotlib figure number, can set to 1
    units : [T,K,U] for tesla, kelvin or arbitrary
    norm : [True,False] if True, normalize
    
    Effects
    ______
        plots figure
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 432x288 with 0 Axes&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># make the figure</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="c1">#read in the data</span>
<span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data_files/irmaq_magic/measurements.txt&#39;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># fish out the IRM data</span>
<span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">method_codes</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;LP-IRM&#39;</span><span class="p">)]</span> <span class="c1"># </span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;zero&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span> <span class="c1"># make a dummy field initialized with zero</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span> <span class="c1"># make a dummy field initialized with one</span>
<span class="c1"># make the required list</span>
<span class="c1"># possible intensity fields are:</span>
<span class="c1">#[&#39;magn_moment&#39;, &#39;magn_volume&#39;, &#39;magn_mass&#39;, &#39;magnitude&#39;]</span>
<span class="c1"># this data file has magn_moment data</span>
<span class="c1"># pmagplotlib.plotMT plots data by specimen, so get list of specimens</span>
<span class="n">specimens</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">specimen</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="k">for</span> <span class="n">specimen</span> <span class="ow">in</span> <span class="n">specimens</span><span class="p">:</span> <span class="c1"># step through one by one</span>
    <span class="n">spec_df</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">specimen</span><span class="o">==</span><span class="n">specimen</span><span class="p">]</span> <span class="c1"># get data for this specimen</span>
    <span class="c1"># make the data block required</span>
    <span class="n">datablock</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">spec_df</span><span class="p">[[</span><span class="s1">&#39;treat_dc_field&#39;</span><span class="p">,</span><span class="s1">&#39;zero&#39;</span><span class="p">,</span><span class="s1">&#39;zero&#39;</span><span class="p">,</span><span class="s1">&#39;magn_moment&#39;</span><span class="p">,</span><span class="s1">&#39;one&#39;</span><span class="p">,</span><span class="s1">&#39;quality&#39;</span><span class="p">]])</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="n">pmagplotlib</span><span class="o">.</span><span class="n">plot_mag</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">datablock</span><span class="p">,</span><span class="s1">&#39;Example&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;T&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/4328e8914463f26478709873ef6d71d84adef93bb298bc3350ffedb0da2e5d18.png" src="../_images/4328e8914463f26478709873ef6d71d84adef93bb298bc3350ffedb0da2e5d18.png" />
</div>
</div>
</section>
<section id="lnp-magic">
<h2>lnp_magic<a class="headerlink" href="#lnp-magic" title="Permalink to this heading">#</a></h2>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch11.html#x15-156000813">[Essentials Chapter 11]</a>
<a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ap3.html#x21-227000B#x15-156000813">[Essentials Appendix C]</a>
<a class="reference external" href="https://earthref.org/MagIC">[MagIC Database]</a><br />
<a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#lnp_magic.py">[command line version]</a></p>
<p>This program makes equal area projections site by site along with the
Fisher confidence ellipses using the McFadden and McElhinny (1988, doi: 10.1016/0012-821X(88)90072-6)
method for combining lines and planes.  Options are to plot in specimen, geographic or tilt corrected coordinate systems (although the specimen coordinate system is a bit silly if the specimens were not mutually oriented and the geographic and tilt correctioed would presumably be identical except for a coherent rotation of the site.)
It also builds in filters for MAD or <span class="math notranslate nohighlight">\(\alpha_{95}\)</span> cutoffs at the specimen level.</p>
<p>After filtering, the site level data are processed by <strong>pmag.dolnp()</strong> which calculates the MM88 statistics.  These, along with the data are then plotted by <strong>pmagplotlib.plot_lnp()</strong>.</p>
<p>We can do all that from within the notebook, using the wonders of Pandas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pmagplotlib</span><span class="o">.</span><span class="n">plot_lnp</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function plot_lnp in module pmagpy.pmagplotlib:

plot_lnp(fignum, s, datablock, fpars, direction_type_key)
    plots lines and planes on a great  circle with alpha 95 and mean
    
    Parameters
    _________
    fignum : number of plt.figure() object
    datablock : nested list of dictionaries with keys in 3.0 or 2.5 format
        3.0 keys: dir_dec, dir_inc, dir_tilt_correction = [-1,0,100], direction_type_key =[&#39;p&#39;,&#39;l&#39;]
        2.5 keys: dec, inc, tilt_correction = [-1,0,100],direction_type_key =[&#39;p&#39;,&#39;l&#39;]
    fpars : Fisher parameters calculated by, e.g., pmag.dolnp() or pmag.dolnp3_0()
    direction_type_key : key for dictionary direction_type (&#39;specimen_direction_type&#39;)
    Effects
    _______
    plots the site level figure
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># read in specimen data</span>
<span class="n">spec_df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data_files/lnp_magic/specimens.txt&#39;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># filter for quality = &#39;g&#39;</span>
<span class="k">if</span> <span class="s1">&#39;quality&#39;</span>  <span class="ow">in</span> <span class="n">spec_df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="n">spec_df</span><span class="o">=</span><span class="n">spec_df</span><span class="p">[</span><span class="n">spec_df</span><span class="o">.</span><span class="n">quality</span><span class="o">==</span><span class="s1">&#39;g&#39;</span><span class="p">]</span>
<span class="n">spec_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>specimen</th>
      <th>sample</th>
      <th>experiments</th>
      <th>dir_dec</th>
      <th>dir_inc</th>
      <th>dir_n_measurements</th>
      <th>dir_tilt_correction</th>
      <th>dir_mad_free</th>
      <th>geologic_classes</th>
      <th>geologic_types</th>
      <th>lithologies</th>
      <th>meas_step_max</th>
      <th>meas_step_min</th>
      <th>meas_step_unit</th>
      <th>description</th>
      <th>int_corr</th>
      <th>citations</th>
      <th>method_codes</th>
      <th>specimen_direction_type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>sv01a1</td>
      <td>sv01a</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Igneous</td>
      <td>Lava Flow</td>
      <td>Basalt</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>This study</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>sv01a1</td>
      <td>sv01a</td>
      <td>sv01a1 : LP-DIR-AF</td>
      <td>348.4</td>
      <td>-34.7</td>
      <td>12.0</td>
      <td>0.0</td>
      <td>5.1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.14</td>
      <td>0.005</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-CMD-NORTH : DE-BFP : DA-DIR-GEO</td>
      <td>p</td>
    </tr>
    <tr>
      <th>2</th>
      <td>sv01b1</td>
      <td>sv01b</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Igneous</td>
      <td>Lava Flow</td>
      <td>Basalt</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>This study</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>sv01b1</td>
      <td>sv01b</td>
      <td>sv01b1 : LP-DIR-AF</td>
      <td>122.7</td>
      <td>25.5</td>
      <td>15.0</td>
      <td>0.0</td>
      <td>3.8</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.18</td>
      <td>0.000</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-CMD-NORTH : DE-BFP : DA-DIR-GEO</td>
      <td>p</td>
    </tr>
    <tr>
      <th>4</th>
      <td>sv01g1</td>
      <td>sv01g</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Igneous</td>
      <td>Lava Flow</td>
      <td>Basalt</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>This study</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Of course, this being a data file conerted from data model 2.5 there are several lines per specimen. we want the non-blank dir_dec info with the desired (0) tilt correction</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spec_df</span><span class="o">=</span><span class="n">spec_df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;dir_dec&#39;</span><span class="p">,</span><span class="s1">&#39;dir_inc&#39;</span><span class="p">,</span><span class="s1">&#39;dir_tilt_correction&#39;</span><span class="p">])</span>
<span class="n">spec_df</span><span class="o">=</span><span class="n">spec_df</span><span class="p">[</span><span class="n">spec_df</span><span class="o">.</span><span class="n">dir_tilt_correction</span><span class="o">==</span><span class="mi">0</span><span class="p">]</span>
<span class="n">spec_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>specimen</th>
      <th>sample</th>
      <th>experiments</th>
      <th>dir_dec</th>
      <th>dir_inc</th>
      <th>dir_n_measurements</th>
      <th>dir_tilt_correction</th>
      <th>dir_mad_free</th>
      <th>geologic_classes</th>
      <th>geologic_types</th>
      <th>lithologies</th>
      <th>meas_step_max</th>
      <th>meas_step_min</th>
      <th>meas_step_unit</th>
      <th>description</th>
      <th>int_corr</th>
      <th>citations</th>
      <th>method_codes</th>
      <th>specimen_direction_type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>sv01a1</td>
      <td>sv01a</td>
      <td>sv01a1 : LP-DIR-AF</td>
      <td>348.4</td>
      <td>-34.7</td>
      <td>12.0</td>
      <td>0.0</td>
      <td>5.1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.14</td>
      <td>0.005</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-CMD-NORTH : DE-BFP : DA-DIR-GEO</td>
      <td>p</td>
    </tr>
    <tr>
      <th>3</th>
      <td>sv01b1</td>
      <td>sv01b</td>
      <td>sv01b1 : LP-DIR-AF</td>
      <td>122.7</td>
      <td>25.5</td>
      <td>15.0</td>
      <td>0.0</td>
      <td>3.8</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.18</td>
      <td>0.000</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-CMD-NORTH : DE-BFP : DA-DIR-GEO</td>
      <td>p</td>
    </tr>
    <tr>
      <th>5</th>
      <td>sv01g1</td>
      <td>sv01g</td>
      <td>sv01g1 : LP-DIR-AF</td>
      <td>162.4</td>
      <td>36.6</td>
      <td>13.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.18</td>
      <td>0.010</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-CMD-NORTH : DE-BFP : DA-DIR-GEO</td>
      <td>p</td>
    </tr>
    <tr>
      <th>7</th>
      <td>sv01h1</td>
      <td>sv01h</td>
      <td>sv01h1 : LP-DIR-AF</td>
      <td>190.4</td>
      <td>34.6</td>
      <td>13.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.18</td>
      <td>0.010</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-CMD-NORTH : DE-BFP : DA-DIR-GEO</td>
      <td>p</td>
    </tr>
    <tr>
      <th>9</th>
      <td>sv01j1</td>
      <td>sv01j</td>
      <td>sv01j1 : LP-DIR-AF</td>
      <td>133.4</td>
      <td>21.9</td>
      <td>8.0</td>
      <td>0.0</td>
      <td>5.4</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.18</td>
      <td>0.060</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-CMD-NORTH : DE-BFP : DA-DIR-GEO</td>
      <td>p</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Let’s proceed this way:</p>
<ul class="simple">
<li><p>get a list of all the site names. for this we will have to pair the sample with the site name from the samples.txt file.</p></li>
<li><p>look at the data (only quality = ‘g’), site by site, sending it to first <strong>pmag.dolnp()</strong>, then to <strong>pmagplotlib.plot_lnp()</strong>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># read in samples table in order to pair site name to specimen data</span>
<span class="n">samp_df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data_files/lnp_magic/samples.txt&#39;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">samp_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sample</th>
      <th>site</th>
      <th>specimens</th>
      <th>dir_dec</th>
      <th>dir_inc</th>
      <th>dir_n_specimens</th>
      <th>dir_n_specimens_lines</th>
      <th>dir_n_specimens_planes</th>
      <th>dir_tilt_correction</th>
      <th>lat</th>
      <th>...</th>
      <th>description</th>
      <th>azimuth</th>
      <th>dip</th>
      <th>citations</th>
      <th>method_codes</th>
      <th>location</th>
      <th>sample_direction_type</th>
      <th>age</th>
      <th>sample_inferred_age_sigma</th>
      <th>sample_inferred_age_unit</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>sv01a</td>
      <td>sv01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>35.3432</td>
      <td>...</td>
      <td>NaN</td>
      <td>-19.0</td>
      <td>-45.0</td>
      <td>This study</td>
      <td>SO-MAG : FS-FD : SO-POM : SO-CMD-NORTH</td>
      <td>San Francisco Volcanics</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>sv01a</td>
      <td>sv01</td>
      <td>sv01a1</td>
      <td>348.4</td>
      <td>-34.7</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>sample direction.</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-CMD-NORTH : DE-BFP : DA-DIR-GEO</td>
      <td>San Francisco Volcanics</td>
      <td>p</td>
      <td>2.5</td>
      <td>2.5</td>
      <td>Ma</td>
    </tr>
    <tr>
      <th>2</th>
      <td>sv01b</td>
      <td>sv01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>35.3432</td>
      <td>...</td>
      <td>NaN</td>
      <td>-51.0</td>
      <td>-23.0</td>
      <td>This study</td>
      <td>SO-MAG : FS-FD : SO-POM : SO-CMD-NORTH</td>
      <td>San Francisco Volcanics</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>sv01b</td>
      <td>sv01</td>
      <td>sv01b1</td>
      <td>122.7</td>
      <td>25.5</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>sample direction.</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-CMD-NORTH : DE-BFP : DA-DIR-GEO</td>
      <td>San Francisco Volcanics</td>
      <td>p</td>
      <td>2.5</td>
      <td>2.5</td>
      <td>Ma</td>
    </tr>
    <tr>
      <th>4</th>
      <td>sv01c</td>
      <td>sv01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>35.3432</td>
      <td>...</td>
      <td>NaN</td>
      <td>284.0</td>
      <td>-51.0</td>
      <td>This study</td>
      <td>SO-MAG : FS-FD : SO-POM</td>
      <td>San Francisco Volcanics</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 25 columns</p>
</div></div></div>
</div>
<p>Of course there are duplicate sample records, so let’s drop the blank lat rows (to make sure we have all the blank specimens rows, then make the data frame with just ‘sample’ and site’ columns. Then we can merge it with the spec_df dataframe.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">samp_df</span><span class="o">=</span><span class="n">samp_df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;specimens&#39;</span><span class="p">])</span>
<span class="n">samp_df</span><span class="o">=</span><span class="n">samp_df</span><span class="p">[[</span><span class="s1">&#39;sample&#39;</span><span class="p">,</span><span class="s1">&#39;site&#39;</span><span class="p">]]</span>
<span class="n">spec_df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">spec_df</span><span class="p">,</span><span class="n">samp_df</span><span class="p">,</span><span class="n">on</span><span class="o">=</span><span class="s1">&#39;sample&#39;</span><span class="p">)</span>
<span class="n">spec_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>specimen</th>
      <th>sample</th>
      <th>experiments</th>
      <th>dir_dec</th>
      <th>dir_inc</th>
      <th>dir_n_measurements</th>
      <th>dir_tilt_correction</th>
      <th>dir_mad_free</th>
      <th>geologic_classes</th>
      <th>geologic_types</th>
      <th>lithologies</th>
      <th>meas_step_max</th>
      <th>meas_step_min</th>
      <th>meas_step_unit</th>
      <th>description</th>
      <th>int_corr</th>
      <th>citations</th>
      <th>method_codes</th>
      <th>specimen_direction_type</th>
      <th>site</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>sv01a1</td>
      <td>sv01a</td>
      <td>sv01a1 : LP-DIR-AF</td>
      <td>348.4</td>
      <td>-34.7</td>
      <td>12.0</td>
      <td>0.0</td>
      <td>5.1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.14</td>
      <td>0.005</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-CMD-NORTH : DE-BFP : DA-DIR-GEO</td>
      <td>p</td>
      <td>sv01</td>
    </tr>
    <tr>
      <th>1</th>
      <td>sv01b1</td>
      <td>sv01b</td>
      <td>sv01b1 : LP-DIR-AF</td>
      <td>122.7</td>
      <td>25.5</td>
      <td>15.0</td>
      <td>0.0</td>
      <td>3.8</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.18</td>
      <td>0.000</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-CMD-NORTH : DE-BFP : DA-DIR-GEO</td>
      <td>p</td>
      <td>sv01</td>
    </tr>
    <tr>
      <th>2</th>
      <td>sv01g1</td>
      <td>sv01g</td>
      <td>sv01g1 : LP-DIR-AF</td>
      <td>162.4</td>
      <td>36.6</td>
      <td>13.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.18</td>
      <td>0.010</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-CMD-NORTH : DE-BFP : DA-DIR-GEO</td>
      <td>p</td>
      <td>sv01</td>
    </tr>
    <tr>
      <th>3</th>
      <td>sv01h1</td>
      <td>sv01h</td>
      <td>sv01h1 : LP-DIR-AF</td>
      <td>190.4</td>
      <td>34.6</td>
      <td>13.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.18</td>
      <td>0.010</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-CMD-NORTH : DE-BFP : DA-DIR-GEO</td>
      <td>p</td>
      <td>sv01</td>
    </tr>
    <tr>
      <th>4</th>
      <td>sv01j1</td>
      <td>sv01j</td>
      <td>sv01j1 : LP-DIR-AF</td>
      <td>133.4</td>
      <td>21.9</td>
      <td>8.0</td>
      <td>0.0</td>
      <td>5.4</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.18</td>
      <td>0.060</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-CMD-NORTH : DE-BFP : DA-DIR-GEO</td>
      <td>p</td>
      <td>sv01</td>
    </tr>
    <tr>
      <th>5</th>
      <td>sv02a1</td>
      <td>sv02a</td>
      <td>sv02a1 : LP-DIR-AF</td>
      <td>330.3</td>
      <td>30.4</td>
      <td>6.0</td>
      <td>0.0</td>
      <td>2.5</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.18</td>
      <td>0.080</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-SUN : DE-BFL : DA-DIR-GEO</td>
      <td>l</td>
      <td>sv02</td>
    </tr>
    <tr>
      <th>6</th>
      <td>sv02b1</td>
      <td>sv02b</td>
      <td>sv02b1 : LP-DIR-AF</td>
      <td>225.7</td>
      <td>37.0</td>
      <td>14.0</td>
      <td>0.0</td>
      <td>3.7</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.18</td>
      <td>0.000</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-SUN : DE-BFP : DA-DIR-GEO</td>
      <td>p</td>
      <td>sv02</td>
    </tr>
    <tr>
      <th>7</th>
      <td>sv02c1</td>
      <td>sv02c</td>
      <td>sv02c1 : LP-DIR-AF</td>
      <td>103.1</td>
      <td>32.3</td>
      <td>11.0</td>
      <td>0.0</td>
      <td>3.8</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.18</td>
      <td>0.030</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-SUN : DE-BFP : DA-DIR-GEO</td>
      <td>p</td>
      <td>sv02</td>
    </tr>
    <tr>
      <th>8</th>
      <td>sv02d1</td>
      <td>sv02d</td>
      <td>sv02d1 : LP-DIR-AF</td>
      <td>338.6</td>
      <td>44.5</td>
      <td>11.0</td>
      <td>0.0</td>
      <td>1.3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.18</td>
      <td>0.030</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-CMD-NORTH : DE-BFL : DA-DIR-GEO</td>
      <td>l</td>
      <td>sv02</td>
    </tr>
    <tr>
      <th>9</th>
      <td>sv02e1</td>
      <td>sv02e</td>
      <td>sv02e1 : LP-DIR-AF</td>
      <td>340.6</td>
      <td>42.4</td>
      <td>10.0</td>
      <td>0.0</td>
      <td>0.9</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.18</td>
      <td>0.040</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-CMD-NORTH : DE-BFL : DA-DIR-GEO</td>
      <td>l</td>
      <td>sv02</td>
    </tr>
    <tr>
      <th>10</th>
      <td>sv02k1</td>
      <td>sv02k</td>
      <td>sv02k1 : LP-DIR-AF</td>
      <td>337.7</td>
      <td>40.3</td>
      <td>12.0</td>
      <td>0.0</td>
      <td>2.6</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.18</td>
      <td>0.020</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-SUN : DE-BFL : DA-DIR-GEO</td>
      <td>l</td>
      <td>sv02</td>
    </tr>
    <tr>
      <th>11</th>
      <td>sv03a1</td>
      <td>sv03a</td>
      <td>sv03a1 : LP-DIR-AF</td>
      <td>344.6</td>
      <td>52.1</td>
      <td>4.0</td>
      <td>0.0</td>
      <td>1.3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.15</td>
      <td>0.080</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-CMD-NORTH : DE-BFL : DA-DIR-GEO</td>
      <td>l</td>
      <td>sv03</td>
    </tr>
    <tr>
      <th>12</th>
      <td>sv03b1</td>
      <td>sv03b</td>
      <td>sv03b1 : LP-DIR-AF</td>
      <td>39.5</td>
      <td>-24.5</td>
      <td>6.0</td>
      <td>0.0</td>
      <td>3.8</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.18</td>
      <td>0.080</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-CMD-NORTH : DE-BFP : DA-DIR-GEO</td>
      <td>p</td>
      <td>sv03</td>
    </tr>
    <tr>
      <th>13</th>
      <td>sv03d1</td>
      <td>sv03d</td>
      <td>sv03d1 : LP-DIR-AF</td>
      <td>3.9</td>
      <td>-33.5</td>
      <td>11.0</td>
      <td>0.0</td>
      <td>4.6</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.18</td>
      <td>0.000</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-CMD-NORTH : DE-BFP : DA-DIR-GEO</td>
      <td>p</td>
      <td>sv03</td>
    </tr>
    <tr>
      <th>14</th>
      <td>sv03e1</td>
      <td>sv03e</td>
      <td>sv03e1 : LP-DIR-AF</td>
      <td>8.8</td>
      <td>-33.8</td>
      <td>13.0</td>
      <td>0.0</td>
      <td>2.1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.18</td>
      <td>0.010</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-CMD-NORTH : DE-BFP : DA-DIR-GEO</td>
      <td>p</td>
      <td>sv03</td>
    </tr>
    <tr>
      <th>15</th>
      <td>sv03g1</td>
      <td>sv03g</td>
      <td>sv03g1 : LP-DIR-AF</td>
      <td>352.8</td>
      <td>52.2</td>
      <td>7.0</td>
      <td>0.0</td>
      <td>0.9</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.18</td>
      <td>0.070</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-CMD-NORTH : DE-BFL : DA-DIR-GEO</td>
      <td>l</td>
      <td>sv03</td>
    </tr>
    <tr>
      <th>16</th>
      <td>sv03h1</td>
      <td>sv03h</td>
      <td>sv03h1 : LP-DIR-AF</td>
      <td>349.1</td>
      <td>55.5</td>
      <td>8.0</td>
      <td>0.0</td>
      <td>0.9</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.18</td>
      <td>0.060</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-SUN : DE-BFL : DA-DIR-GEO</td>
      <td>l</td>
      <td>sv03</td>
    </tr>
    <tr>
      <th>17</th>
      <td>sv03i1</td>
      <td>sv03i</td>
      <td>sv03i1 : LP-DIR-AF</td>
      <td>353.2</td>
      <td>57.3</td>
      <td>8.0</td>
      <td>0.0</td>
      <td>0.7</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.18</td>
      <td>0.060</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-SUN : DE-BFL : DA-DIR-GEO</td>
      <td>l</td>
      <td>sv03</td>
    </tr>
    <tr>
      <th>18</th>
      <td>sv03j1</td>
      <td>sv03j</td>
      <td>sv03j1 : LP-DIR-AF</td>
      <td>324.1</td>
      <td>44.6</td>
      <td>8.0</td>
      <td>0.0</td>
      <td>1.9</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.18</td>
      <td>0.060</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-CMD-NORTH : DE-BFL : DA-DIR-GEO</td>
      <td>l</td>
      <td>sv03</td>
    </tr>
    <tr>
      <th>19</th>
      <td>sv04a1</td>
      <td>sv04a</td>
      <td>sv04a1 : LP-DIR-AF</td>
      <td>348.3</td>
      <td>50.2</td>
      <td>12.0</td>
      <td>0.0</td>
      <td>1.5</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.18</td>
      <td>0.020</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-CMD-NORTH : DE-BFL : DA-DIR-GEO</td>
      <td>l</td>
      <td>sv04</td>
    </tr>
    <tr>
      <th>20</th>
      <td>sv04b1</td>
      <td>sv04b</td>
      <td>sv04b1 : LP-DIR-AF</td>
      <td>353.0</td>
      <td>46.6</td>
      <td>12.0</td>
      <td>0.0</td>
      <td>1.3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.18</td>
      <td>0.020</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-CMD-NORTH : DE-BFL : DA-DIR-GEO</td>
      <td>l</td>
      <td>sv04</td>
    </tr>
    <tr>
      <th>21</th>
      <td>sv04d1</td>
      <td>sv04d</td>
      <td>sv04d1 : LP-DIR-AF</td>
      <td>342.6</td>
      <td>48.7</td>
      <td>9.0</td>
      <td>0.0</td>
      <td>2.6</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.18</td>
      <td>0.050</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-CMD-NORTH : DE-BFL : DA-DIR-GEO</td>
      <td>l</td>
      <td>sv04</td>
    </tr>
    <tr>
      <th>22</th>
      <td>sv04e1</td>
      <td>sv04e</td>
      <td>sv04e1 : LP-DIR-AF</td>
      <td>342.2</td>
      <td>56.9</td>
      <td>11.0</td>
      <td>0.0</td>
      <td>1.2</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.18</td>
      <td>0.030</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-CMD-NORTH : DE-BFL : DA-DIR-GEO</td>
      <td>l</td>
      <td>sv04</td>
    </tr>
    <tr>
      <th>23</th>
      <td>sv04i1</td>
      <td>sv04i</td>
      <td>sv04i1 : LP-DIR-AF</td>
      <td>347.4</td>
      <td>50.6</td>
      <td>5.0</td>
      <td>0.0</td>
      <td>2.4</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.15</td>
      <td>0.060</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-CMD-NORTH : DE-BFL : DA-DIR-GEO</td>
      <td>l</td>
      <td>sv04</td>
    </tr>
    <tr>
      <th>24</th>
      <td>sv05a2</td>
      <td>sv05a</td>
      <td>sv05a2 : LP-DIR-AF</td>
      <td>202.3</td>
      <td>31.5</td>
      <td>14.0</td>
      <td>0.0</td>
      <td>4.9</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>423.00</td>
      <td>0.030</td>
      <td>K</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : LP-DIR-T : SO-SUN : DE-BFP : DA-DI...</td>
      <td>p</td>
      <td>sv05</td>
    </tr>
    <tr>
      <th>25</th>
      <td>sv05b1</td>
      <td>sv05b</td>
      <td>sv05b1 : LP-DIR-AF</td>
      <td>160.0</td>
      <td>-47.8</td>
      <td>6.0</td>
      <td>0.0</td>
      <td>1.7</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.18</td>
      <td>0.080</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-SUN : DE-BFL : DA-DIR-GEO</td>
      <td>l</td>
      <td>sv05</td>
    </tr>
    <tr>
      <th>26</th>
      <td>sv05c1</td>
      <td>sv05c</td>
      <td>sv05c1 : LP-DIR-AF</td>
      <td>168.4</td>
      <td>37.3</td>
      <td>6.0</td>
      <td>0.0</td>
      <td>3.2</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.18</td>
      <td>0.080</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-SUN : DE-BFP : DA-DIR-GEO</td>
      <td>p</td>
      <td>sv05</td>
    </tr>
    <tr>
      <th>27</th>
      <td>sv05d2</td>
      <td>sv05d</td>
      <td>sv05d2 : LP-DIR-AF</td>
      <td>161.2</td>
      <td>-47.4</td>
      <td>5.0</td>
      <td>0.0</td>
      <td>3.3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.18</td>
      <td>0.080</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-SUN : DE-BFL : DA-DIR-GEO</td>
      <td>l</td>
      <td>sv05</td>
    </tr>
    <tr>
      <th>28</th>
      <td>sv05f1</td>
      <td>sv05f</td>
      <td>sv05f1 : LP-DIR-AF</td>
      <td>72.5</td>
      <td>-2.6</td>
      <td>13.0</td>
      <td>0.0</td>
      <td>4.4</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.18</td>
      <td>0.010</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-SUN : DE-BFP : DA-DIR-GEO</td>
      <td>p</td>
      <td>sv05</td>
    </tr>
    <tr>
      <th>29</th>
      <td>sv05h1</td>
      <td>sv05h</td>
      <td>sv05h1 : LP-DIR-AF</td>
      <td>172.0</td>
      <td>-44.3</td>
      <td>7.0</td>
      <td>0.0</td>
      <td>4.3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.15</td>
      <td>0.030</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-SUN : DE-BFL : DA-DIR-GEO</td>
      <td>l</td>
      <td>sv05</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>159</th>
      <td>sv58g1</td>
      <td>sv58g</td>
      <td>sv58g1 : LP-DIR-AF</td>
      <td>182.5</td>
      <td>-60.0</td>
      <td>11.0</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.18</td>
      <td>0.030</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-SUN : DE-BFL : DA-DIR-GEO</td>
      <td>l</td>
      <td>sv58</td>
    </tr>
    <tr>
      <th>160</th>
      <td>sv58k1</td>
      <td>sv58k</td>
      <td>sv58k1 : LP-DIR-AF</td>
      <td>188.0</td>
      <td>-65.2</td>
      <td>12.0</td>
      <td>0.0</td>
      <td>0.7</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.18</td>
      <td>0.020</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-SUN : DE-BFL : DA-DIR-GEO</td>
      <td>l</td>
      <td>sv58</td>
    </tr>
    <tr>
      <th>161</th>
      <td>sv59a1</td>
      <td>sv59a</td>
      <td>sv59a1 : LP-DIR-AF</td>
      <td>181.0</td>
      <td>-51.7</td>
      <td>11.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.18</td>
      <td>0.030</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-SUN : DE-BFL : DA-DIR-GEO</td>
      <td>l</td>
      <td>sv59</td>
    </tr>
    <tr>
      <th>162</th>
      <td>sv59f1</td>
      <td>sv59f</td>
      <td>sv59f1 : LP-DIR-AF</td>
      <td>179.6</td>
      <td>-53.1</td>
      <td>11.0</td>
      <td>0.0</td>
      <td>0.8</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.18</td>
      <td>0.030</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-SUN : DE-BFL : DA-DIR-GEO</td>
      <td>l</td>
      <td>sv59</td>
    </tr>
    <tr>
      <th>163</th>
      <td>sv59g1</td>
      <td>sv59g</td>
      <td>sv59g1 : LP-DIR-AF</td>
      <td>178.4</td>
      <td>-52.0</td>
      <td>11.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.18</td>
      <td>0.030</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-SUN : DE-BFL : DA-DIR-GEO</td>
      <td>l</td>
      <td>sv59</td>
    </tr>
    <tr>
      <th>164</th>
      <td>sv59j1</td>
      <td>sv59j</td>
      <td>sv59j1 : LP-DIR-AF</td>
      <td>176.4</td>
      <td>-48.3</td>
      <td>12.0</td>
      <td>0.0</td>
      <td>1.4</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.18</td>
      <td>0.020</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-SUN : DE-BFL : DA-DIR-GEO</td>
      <td>l</td>
      <td>sv59</td>
    </tr>
    <tr>
      <th>165</th>
      <td>sv60a1</td>
      <td>sv60a</td>
      <td>sv60a1 : LP-DIR-AF</td>
      <td>219.1</td>
      <td>-21.0</td>
      <td>7.0</td>
      <td>0.0</td>
      <td>2.3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.08</td>
      <td>0.020</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-SUN : DE-BFL : DA-DIR-GEO</td>
      <td>l</td>
      <td>sv60</td>
    </tr>
    <tr>
      <th>166</th>
      <td>sv60c1</td>
      <td>sv60c</td>
      <td>sv60c1 : LP-DIR-AF</td>
      <td>179.5</td>
      <td>-28.9</td>
      <td>5.0</td>
      <td>0.0</td>
      <td>0.7</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.06</td>
      <td>0.020</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-SUN : DE-BFL : DA-DIR-GEO</td>
      <td>l</td>
      <td>sv60</td>
    </tr>
    <tr>
      <th>167</th>
      <td>sv61a1</td>
      <td>sv61a</td>
      <td>sv61a1 : LP-DIR-AF</td>
      <td>163.3</td>
      <td>61.0</td>
      <td>10.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.18</td>
      <td>0.010</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-SUN : DE-BFL : DA-DIR-GEO</td>
      <td>l</td>
      <td>sv61</td>
    </tr>
    <tr>
      <th>168</th>
      <td>sv61c1</td>
      <td>sv61c</td>
      <td>sv61c1 : LP-DIR-AF</td>
      <td>264.2</td>
      <td>2.6</td>
      <td>9.0</td>
      <td>0.0</td>
      <td>4.8</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.08</td>
      <td>0.000</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-SUN : DE-BFP : DA-DIR-GEO</td>
      <td>p</td>
      <td>sv61</td>
    </tr>
    <tr>
      <th>169</th>
      <td>sv61g1</td>
      <td>sv61g</td>
      <td>sv61g1 : LP-DIR-AF</td>
      <td>348.2</td>
      <td>63.4</td>
      <td>7.0</td>
      <td>0.0</td>
      <td>1.4</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.16</td>
      <td>0.060</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-SUN : DE-BFL : DA-DIR-GEO</td>
      <td>l</td>
      <td>sv61</td>
    </tr>
    <tr>
      <th>170</th>
      <td>sv61i1</td>
      <td>sv61i</td>
      <td>sv61i1 : LP-DIR-AF</td>
      <td>356.8</td>
      <td>54.4</td>
      <td>5.0</td>
      <td>0.0</td>
      <td>1.6</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.14</td>
      <td>0.070</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-SUN : DE-BFL : DA-DIR-GEO</td>
      <td>l</td>
      <td>sv61</td>
    </tr>
    <tr>
      <th>171</th>
      <td>sv62b1</td>
      <td>sv62b</td>
      <td>sv62b1 : LP-DIR-AF</td>
      <td>68.8</td>
      <td>19.6</td>
      <td>9.0</td>
      <td>0.0</td>
      <td>2.2</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.08</td>
      <td>0.000</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-SUN : DE-BFP : DA-DIR-GEO</td>
      <td>p</td>
      <td>sv62</td>
    </tr>
    <tr>
      <th>172</th>
      <td>sv62d1</td>
      <td>sv62d</td>
      <td>sv62d1 : LP-DIR-AF</td>
      <td>345.3</td>
      <td>-35.3</td>
      <td>11.0</td>
      <td>0.0</td>
      <td>2.3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.12</td>
      <td>0.000</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-SUN : DE-BFP : DA-DIR-GEO</td>
      <td>p</td>
      <td>sv62</td>
    </tr>
    <tr>
      <th>173</th>
      <td>sv62g1</td>
      <td>sv62g</td>
      <td>sv62g1 : LP-DIR-AF</td>
      <td>127.1</td>
      <td>35.1</td>
      <td>7.0</td>
      <td>0.0</td>
      <td>3.8</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.07</td>
      <td>0.010</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-SUN : DE-BFP : DA-DIR-GEO</td>
      <td>p</td>
      <td>sv62</td>
    </tr>
    <tr>
      <th>174</th>
      <td>sv63a1</td>
      <td>sv63a</td>
      <td>sv63a1 : LP-DIR-AF</td>
      <td>354.9</td>
      <td>43.6</td>
      <td>8.0</td>
      <td>0.0</td>
      <td>1.3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.12</td>
      <td>0.030</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-SUN : DE-BFL : DA-DIR-GEO</td>
      <td>l</td>
      <td>sv63</td>
    </tr>
    <tr>
      <th>175</th>
      <td>sv63f1</td>
      <td>sv63f</td>
      <td>sv63f1 : LP-DIR-AF</td>
      <td>353.0</td>
      <td>48.0</td>
      <td>5.0</td>
      <td>0.0</td>
      <td>0.8</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.05</td>
      <td>0.010</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-SUN : DE-BFL : DA-DIR-GEO</td>
      <td>l</td>
      <td>sv63</td>
    </tr>
    <tr>
      <th>176</th>
      <td>sv63h1</td>
      <td>sv63h</td>
      <td>sv63h1 : LP-DIR-AF</td>
      <td>351.9</td>
      <td>46.4</td>
      <td>6.0</td>
      <td>0.0</td>
      <td>0.9</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.08</td>
      <td>0.030</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-SUN : DE-BFL : DA-DIR-GEO</td>
      <td>l</td>
      <td>sv63</td>
    </tr>
    <tr>
      <th>177</th>
      <td>sv63j1</td>
      <td>sv63j</td>
      <td>sv63j1 : LP-DIR-AF</td>
      <td>346.5</td>
      <td>42.3</td>
      <td>6.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.08</td>
      <td>0.030</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-SUN : DE-BFL : DA-DIR-GEO</td>
      <td>l</td>
      <td>sv63</td>
    </tr>
    <tr>
      <th>178</th>
      <td>sv64b1</td>
      <td>sv64b</td>
      <td>sv64b1 : LP-DIR-AF</td>
      <td>173.1</td>
      <td>-51.1</td>
      <td>8.0</td>
      <td>0.0</td>
      <td>1.2</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.15</td>
      <td>0.020</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-SUN : DE-BFL : DA-DIR-GEO</td>
      <td>l</td>
      <td>sv64</td>
    </tr>
    <tr>
      <th>179</th>
      <td>sv64c2</td>
      <td>sv64c</td>
      <td>sv64c2 : LP-DIR-AF</td>
      <td>185.3</td>
      <td>-45.3</td>
      <td>10.0</td>
      <td>0.0</td>
      <td>1.2</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.18</td>
      <td>0.040</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-SUN : DE-BFL : DA-DIR-GEO</td>
      <td>l</td>
      <td>sv64</td>
    </tr>
    <tr>
      <th>180</th>
      <td>sv64e1</td>
      <td>sv64e</td>
      <td>sv64e1 : LP-DIR-AF</td>
      <td>162.4</td>
      <td>-53.0</td>
      <td>11.0</td>
      <td>0.0</td>
      <td>0.6</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.16</td>
      <td>0.020</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-SUN : DE-BFL : DA-DIR-GEO</td>
      <td>l</td>
      <td>sv64</td>
    </tr>
    <tr>
      <th>181</th>
      <td>sv64g1</td>
      <td>sv64g</td>
      <td>sv64g1 : LP-DIR-AF</td>
      <td>167.9</td>
      <td>-53.7</td>
      <td>8.0</td>
      <td>0.0</td>
      <td>0.8</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.12</td>
      <td>0.030</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-SUN : DE-BFL : DA-DIR-GEO</td>
      <td>l</td>
      <td>sv64</td>
    </tr>
    <tr>
      <th>182</th>
      <td>sv64h1</td>
      <td>sv64h</td>
      <td>sv64h1 : LP-DIR-AF</td>
      <td>165.5</td>
      <td>-52.9</td>
      <td>8.0</td>
      <td>0.0</td>
      <td>0.8</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.15</td>
      <td>0.020</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-SUN : DE-BFL : DA-DIR-GEO</td>
      <td>l</td>
      <td>sv64</td>
    </tr>
    <tr>
      <th>183</th>
      <td>sv64i1</td>
      <td>sv64i</td>
      <td>sv64i1 : LP-DIR-AF</td>
      <td>165.9</td>
      <td>-52.1</td>
      <td>10.0</td>
      <td>0.0</td>
      <td>0.4</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.14</td>
      <td>0.020</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-SUN : DE-BFL : DA-DIR-GEO</td>
      <td>l</td>
      <td>sv64</td>
    </tr>
    <tr>
      <th>184</th>
      <td>sv65a1</td>
      <td>sv65a</td>
      <td>sv65a1 : LP-DIR-AF</td>
      <td>32.7</td>
      <td>65.0</td>
      <td>6.0</td>
      <td>0.0</td>
      <td>0.8</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.07</td>
      <td>0.020</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-CMD-NORTH : DE-BFL : DA-DIR-GEO</td>
      <td>l</td>
      <td>sv65</td>
    </tr>
    <tr>
      <th>185</th>
      <td>sv65c1</td>
      <td>sv65c</td>
      <td>sv65c1 : LP-DIR-AF</td>
      <td>33.1</td>
      <td>49.7</td>
      <td>5.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.10</td>
      <td>0.050</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-CMD-NORTH : DE-BFL : DA-DIR-GEO</td>
      <td>l</td>
      <td>sv65</td>
    </tr>
    <tr>
      <th>186</th>
      <td>sv65d1</td>
      <td>sv65d</td>
      <td>sv65d1 : LP-DIR-AF</td>
      <td>25.9</td>
      <td>45.0</td>
      <td>6.0</td>
      <td>0.0</td>
      <td>2.5</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.10</td>
      <td>0.040</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-CMD-NORTH : DE-BFL : DA-DIR-GEO</td>
      <td>l</td>
      <td>sv65</td>
    </tr>
    <tr>
      <th>187</th>
      <td>sv65e1</td>
      <td>sv65e</td>
      <td>sv65e1 : LP-DIR-AF</td>
      <td>29.9</td>
      <td>58.3</td>
      <td>5.0</td>
      <td>0.0</td>
      <td>1.3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.08</td>
      <td>0.040</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-CMD-NORTH : DE-BFL : DA-DIR-GEO</td>
      <td>l</td>
      <td>sv65</td>
    </tr>
    <tr>
      <th>188</th>
      <td>sv65g1</td>
      <td>sv65g</td>
      <td>sv65g1 : LP-DIR-AF</td>
      <td>289.8</td>
      <td>10.4</td>
      <td>10.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.15</td>
      <td>0.000</td>
      <td>T</td>
      <td>Recalculated from original measurements; super...</td>
      <td>u</td>
      <td>This study</td>
      <td>LP-DIR-AF : SO-SUN : DE-BFP : DA-DIR-GEO</td>
      <td>p</td>
      <td>sv65</td>
    </tr>
  </tbody>
</table>
<p>189 rows × 20 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># get the site names</span>
<span class="n">sites</span><span class="o">=</span><span class="n">spec_df</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="n">sites</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;sv01&#39;, &#39;sv02&#39;, &#39;sv03&#39;, &#39;sv04&#39;, &#39;sv05&#39;, &#39;sv06&#39;, &#39;sv07&#39;, &#39;sv08&#39;,
       &#39;sv09&#39;, &#39;sv10&#39;, &#39;sv11&#39;, &#39;sv12&#39;, &#39;sv15&#39;, &#39;sv16&#39;, &#39;sv17&#39;, &#39;sv18&#39;,
       &#39;sv19&#39;, &#39;sv20&#39;, &#39;sv21&#39;, &#39;sv22&#39;, &#39;sv23&#39;, &#39;sv24&#39;, &#39;sv25&#39;, &#39;sv26&#39;,
       &#39;sv27&#39;, &#39;sv28&#39;, &#39;sv30&#39;, &#39;sv31&#39;, &#39;sv32&#39;, &#39;sv50&#39;, &#39;sv51&#39;, &#39;sv52&#39;,
       &#39;sv53&#39;, &#39;sv54&#39;, &#39;sv55&#39;, &#39;sv56&#39;, &#39;sv57&#39;, &#39;sv58&#39;, &#39;sv59&#39;, &#39;sv60&#39;,
       &#39;sv61&#39;, &#39;sv62&#39;, &#39;sv63&#39;, &#39;sv64&#39;, &#39;sv65&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<p>Let’s plot up the first 10 or so.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">dolnp</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function dolnp in module pmagpy.pmag:

dolnp(data, direction_type_key)
    Returns fisher mean, a95 for data  using method of Mcfadden and Mcelhinny &#39;88 for lines and planes
    
    Parameters
    __________
    Data : nested list of dictionaries with keys
        Data model 3.0:
            dir_dec
            dir_inc
            dir_tilt_correction
            method_codes
        Data model 2.5:
            dec
            inc
            tilt_correction
            magic_method_codes
         direction_type_key :  [&#39;specimen_direction_type&#39;]
    Returns
    -------
        ReturnData : dictionary with keys
            dec : fisher mean dec of data in Data
            inc : fisher mean inc of data in Data
            n_lines : number of directed lines [method_code = DE-BFL or DE-FM]
            n_planes : number of best fit planes [method_code = DE-BFP]
            alpha95  : fisher confidence circle from Data
            R : fisher R value of Data
            K : fisher k value of Data
    Effects
        prints to screen in case of no data
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pmagplotlib</span><span class="o">.</span><span class="n">plot_lnp</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function plot_lnp in module pmagpy.pmagplotlib:

plot_lnp(fignum, s, datablock, fpars, direction_type_key)
    plots lines and planes on a great  circle with alpha 95 and mean
    
    Parameters
    _________
    fignum : number of plt.figure() object
    datablock : nested list of dictionaries with keys in 3.0 or 2.5 format
        3.0 keys: dir_dec, dir_inc, dir_tilt_correction = [-1,0,100], direction_type_key =[&#39;p&#39;,&#39;l&#39;]
        2.5 keys: dec, inc, tilt_correction = [-1,0,100],direction_type_key =[&#39;p&#39;,&#39;l&#39;]
    fpars : Fisher parameters calculated by, e.g., pmag.dolnp() or pmag.dolnp3_0()
    direction_type_key : key for dictionary direction_type (&#39;specimen_direction_type&#39;)
    Effects
    _______
    plots the site level figure
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cnt</span><span class="o">=</span><span class="mi">1</span>
<span class="k">for</span> <span class="n">site</span> <span class="ow">in</span> <span class="n">sites</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">]:</span>
    <span class="n">pmagplotlib</span><span class="o">.</span><span class="n">plot_init</span><span class="p">(</span><span class="n">cnt</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
    <span class="n">site_data</span><span class="o">=</span><span class="n">spec_df</span><span class="p">[</span><span class="n">spec_df</span><span class="o">.</span><span class="n">site</span><span class="o">==</span><span class="n">site</span><span class="p">]</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="s1">&#39;records&#39;</span><span class="p">)</span>
    <span class="n">fpars</span><span class="o">=</span><span class="n">pmag</span><span class="o">.</span><span class="n">dolnp</span><span class="p">(</span><span class="n">site_data</span><span class="p">,</span><span class="s1">&#39;specimen_direction_type&#39;</span><span class="p">)</span>
    <span class="n">pmagplotlib</span><span class="o">.</span><span class="n">plot_lnp</span><span class="p">(</span><span class="n">cnt</span><span class="p">,</span><span class="n">site</span><span class="p">,</span><span class="n">site_data</span><span class="p">,</span><span class="n">fpars</span><span class="p">,</span><span class="s1">&#39;specimen_direction_type&#39;</span><span class="p">)</span>
    <span class="n">cnt</span><span class="o">+=</span><span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/5f620f82e9162a4fef6ff22fc4c090ddd71b7910a358bad38da95c26d294ef7d.png" src="../_images/5f620f82e9162a4fef6ff22fc4c090ddd71b7910a358bad38da95c26d294ef7d.png" />
<img alt="../_images/13e0da9df3293f368aa22992190956fff51c8c7e5cfc8853b4b3c858b7af51d3.png" src="../_images/13e0da9df3293f368aa22992190956fff51c8c7e5cfc8853b4b3c858b7af51d3.png" />
<img alt="../_images/35a2a57faa105c38ff2a0309e8e20b1f45558ed335c10e9b3807265de6dbed3d.png" src="../_images/35a2a57faa105c38ff2a0309e8e20b1f45558ed335c10e9b3807265de6dbed3d.png" />
<img alt="../_images/cbb9ef0f44aafc225dadef2e1fb4c1883353a362617f40e1a61d939df0adb2e4.png" src="../_images/cbb9ef0f44aafc225dadef2e1fb4c1883353a362617f40e1a61d939df0adb2e4.png" />
<img alt="../_images/976235a8dbfa0d5885dee841a018b59c696e01a9c928dd25378a637baa5c3c55.png" src="../_images/976235a8dbfa0d5885dee841a018b59c696e01a9c928dd25378a637baa5c3c55.png" />
<img alt="../_images/c9a8c4d77302ef430a8d59170b00c3cffacdc9c5e77b628860f697579cba5fb4.png" src="../_images/c9a8c4d77302ef430a8d59170b00c3cffacdc9c5e77b628860f697579cba5fb4.png" />
<img alt="../_images/e9d21df81c3111209c3d91faff6a74405d872c4172d48be4e1bca34f869ff66c.png" src="../_images/e9d21df81c3111209c3d91faff6a74405d872c4172d48be4e1bca34f869ff66c.png" />
<img alt="../_images/204df7df6c9334096d6a25783d4f3aad444636ff04cc7dbd5ef5f29e11a23359.png" src="../_images/204df7df6c9334096d6a25783d4f3aad444636ff04cc7dbd5ef5f29e11a23359.png" />
<img alt="../_images/871c0a294c71c11932b4bab0c6230b637861f6afe46d10b9b0d2fdc5032ab2eb.png" src="../_images/871c0a294c71c11932b4bab0c6230b637861f6afe46d10b9b0d2fdc5032ab2eb.png" />
<img alt="../_images/9c4d226172ee577c8dc0f1bc1517e93b31e4116ee771be9767b1cbd7bcf80a5b.png" src="../_images/9c4d226172ee577c8dc0f1bc1517e93b31e4116ee771be9767b1cbd7bcf80a5b.png" />
</div>
</div>
</section>
<section id="lowes">
<h2>lowes<a class="headerlink" href="#lowes" title="Permalink to this heading">#</a></h2>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch2.html#x15-156000813">[Essentials Chapter 2]</a>
<a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#lowes.py">[command line version]</a></p>
<p>This program generates a Lowes (1974, doi: 10.1111/j.1365-246X.1974.tb00622.x)  spectrum from igrf-like field models.  It will take a specified date, get the gauss coefficients from <span class="xref myst"><strong>pmag.doigrf()</strong></span>, unpack them into a usable format with <strong>pmag.unpack()</strong> and calculate the spectrum with <strong>pmag.lowes()</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">unpack</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function unpack in module pmagpy.pmag:

unpack(gh)
     unpacks gh list into l m g h type list
    
     Parameters
     _________
     gh : list of gauss coefficients (as returned by, e.g., doigrf)
    
     Returns
    data : nested list of [[l,m,g,h],...]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">lowes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function lowes in module pmagpy.pmag:

lowes(data)
    gets Lowe&#39;s power spectrum  from gauss coefficients
    
    Parameters
    _________
    data : nested list of [[l,m,g,h],...] as from pmag.unpack()
    
    Returns
    _______
    Ls : list of degrees (l)
    Rs : power at  degree l
</pre></div>
</div>
</div>
</div>
<p>So let’s do it!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">date</span><span class="o">=</span><span class="mi">1956</span> <span class="c1"># pick a date and what better one than my birth year?  </span>
<span class="n">coeffs</span><span class="o">=</span><span class="n">pmag</span><span class="o">.</span><span class="n">doigrf</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">date</span><span class="p">,</span><span class="n">coeffs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># get the gauss coefficients</span>
<span class="n">data</span><span class="o">=</span><span class="n">pmag</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">coeffs</span><span class="p">)</span> <span class="c1"># unpack them into the form that lowes likes</span>
<span class="n">Ls</span><span class="p">,</span><span class="n">Rs</span><span class="o">=</span><span class="n">pmag</span><span class="o">.</span><span class="n">lowes</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="c1"># get the power spectrum</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Ls</span><span class="p">,</span><span class="n">Rs</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="p">))</span> <span class="c1"># make the plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">()</span> <span class="c1"># semi log it</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Degree (l)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Power ($\mu$T$^2$)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/76a62b359d892c4b48d15ad74afbd85481ced8319552b84318cb3b2b509524a0.png" src="../_images/76a62b359d892c4b48d15ad74afbd85481ced8319552b84318cb3b2b509524a0.png" />
</div>
</div>
</section>
<section id="lowrie">
<h2>lowrie<a class="headerlink" href="#lowrie" title="Permalink to this heading">#</a></h2>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch8.html#x15-156000813">[Essentials Chapter 8]</a>
<a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#lowrie.py">[command line versions]</a></p>
<p>Someone (Saiko Sugisaki) subjected a number of specimens from IODP Expedition 318 Site U1361 specimens to a Lowrie (1990, doi: 10.1029/GL017i002p00159) 3-D IRM experiment (published as Tauxe et al., 2015, doi:10.1016/j.epsl.2014.12.034). <strong>lowrie</strong> makes plots of blocking temperature for the three coercivity fractions.</p>
<p>Both <strong>lowrie</strong> and <strong>lowrie_magic</strong>   take specimen level 3D-IRM data, break them into the cartesian coordinates  of the three IRM field directions and plot the different components versus demagnetizing temperature.  We can  do this with our powerful <strong>Pandas</strong> and <strong>matplotlib</strong>.<br />
The relevent MagIC database method code is ‘LP-IRM-3D’, magnetization code is one of the usual, but in this example it is ‘magn_moment’ and the temperature step is the usual data model 3.0 (‘treat_temp’) in kelvin.</p>
<p>We will use <strong>pmag.dir2cart()</strong> for the heavy lifting.  I also happen to know (because I wrote the original paper), that the X direction was the 1.0 tesla step, Y was 0.5 tesla and Z was .1 tesla, so we can put these in the legend.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">dir2cart</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function dir2cart in module pmagpy.pmag:

dir2cart(d)
    Converts a list or array of vector directions in degrees (declination,
    inclination) to an array of the direction in cartesian coordinates (x,y,z)
    
    Parameters
    ----------
    d : list or array of [dec,inc] or [dec,inc,intensity]
    
    Returns
    -------
    cart : array of [x,y,z]
    
    Examples
    --------
    &gt;&gt;&gt; pmag.dir2cart([200,40,1])
    array([-0.71984631, -0.26200263,  0.64278761])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># read in the data file</span>
<span class="n">meas_df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data_files/lowrie_magic/measurements.txt&#39;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># pick out the 3d-IRM data</span>
<span class="n">meas_df</span><span class="o">=</span><span class="n">meas_df</span><span class="p">[</span><span class="n">meas_df</span><span class="o">.</span><span class="n">method_codes</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;LP-IRM-3D&#39;</span><span class="p">)]</span>
<span class="c1"># get a list of specimen names</span>
<span class="n">specimens</span><span class="o">=</span><span class="n">meas_df</span><span class="o">.</span><span class="n">specimen</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="n">cnt</span><span class="o">=</span><span class="mi">1</span> <span class="c1"># set figure counter</span>
<span class="k">for</span> <span class="n">specimen</span> <span class="ow">in</span> <span class="n">specimens</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">]:</span> <span class="c1"># step through first 10</span>
    <span class="n">spec_df</span><span class="o">=</span><span class="n">meas_df</span><span class="p">[</span><span class="n">meas_df</span><span class="o">.</span><span class="n">specimen</span><span class="o">==</span><span class="n">specimen</span><span class="p">]</span> <span class="c1"># collect this specimen&#39;s data    </span>
    <span class="n">dirs</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">spec_df</span><span class="p">[[</span><span class="s1">&#39;dir_dec&#39;</span><span class="p">,</span><span class="s1">&#39;dir_inc&#39;</span><span class="p">,</span><span class="s1">&#39;magn_moment&#39;</span><span class="p">]])</span>
    <span class="n">norm</span><span class="o">=</span><span class="n">dirs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># let&#39;s normalize to the initial intensity</span>
    <span class="n">carts</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">((</span><span class="n">pmag</span><span class="o">.</span><span class="n">dir2cart</span><span class="p">(</span><span class="n">dirs</span><span class="p">)</span><span class="o">/</span><span class="n">norm</span><span class="p">))</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="c1"># get the X,Y,Z data</span>
    <span class="n">temps</span><span class="o">=</span><span class="n">spec_df</span><span class="p">[</span><span class="s1">&#39;treat_temp&#39;</span><span class="p">]</span><span class="o">-</span><span class="mi">273</span> <span class="c1"># convert to Celcius</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">cnt</span><span class="p">,(</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">temps</span><span class="p">,</span><span class="n">carts</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;ro&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;1 T&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">temps</span><span class="p">,</span><span class="n">carts</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;r-&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">temps</span><span class="p">,</span><span class="n">carts</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;cs&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;0.5 T&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">temps</span><span class="p">,</span><span class="n">carts</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;c-&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">temps</span><span class="p">,</span><span class="n">carts</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="s1">&#39;k^&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;0.1 T&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">temps</span><span class="p">,</span><span class="n">carts</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="s1">&#39;k-&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">specimen</span><span class="o">+</span><span class="s1">&#39; : Lowrie 3-D IRM&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
    <span class="n">cnt</span><span class="o">+=</span><span class="mi">1</span>

        
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d41e1b4d6a6a0dc809b72b508174b3745231d157b9dd8020021c4fad0f78a319.png" src="../_images/d41e1b4d6a6a0dc809b72b508174b3745231d157b9dd8020021c4fad0f78a319.png" />
<img alt="../_images/1d3bbc31adeeed34f3712178d941e2406c3735380394e213ead94df2eb50362c.png" src="../_images/1d3bbc31adeeed34f3712178d941e2406c3735380394e213ead94df2eb50362c.png" />
<img alt="../_images/be5e87191081b6fc4daf17af7001b5922bc6d6ccfa2ef7e013536d4e13910b47.png" src="../_images/be5e87191081b6fc4daf17af7001b5922bc6d6ccfa2ef7e013536d4e13910b47.png" />
<img alt="../_images/20646378535178913de07ef5ee9ab5cb793156a41228a78e824e7e2797131fb0.png" src="../_images/20646378535178913de07ef5ee9ab5cb793156a41228a78e824e7e2797131fb0.png" />
<img alt="../_images/af75ee9153a7e5b4eb5bb08ea7f83f46ea216da993110622d56bde7ea0b73ab6.png" src="../_images/af75ee9153a7e5b4eb5bb08ea7f83f46ea216da993110622d56bde7ea0b73ab6.png" />
<img alt="../_images/6f185be4fd495a6c0cd804f6daec92736bf8b5ce9ef02ebdf528360cb2d4f730.png" src="../_images/6f185be4fd495a6c0cd804f6daec92736bf8b5ce9ef02ebdf528360cb2d4f730.png" />
<img alt="../_images/50768fc34bce9fa5597742265e1330a70fad1e7b3ed0d01b86778c443e996fa0.png" src="../_images/50768fc34bce9fa5597742265e1330a70fad1e7b3ed0d01b86778c443e996fa0.png" />
<img alt="../_images/046775e4033f805e3d9bd18f68334032124c4e3d82363f504054b7248fb220e9.png" src="../_images/046775e4033f805e3d9bd18f68334032124c4e3d82363f504054b7248fb220e9.png" />
<img alt="../_images/540dde2c5415c02e6d1b95f8008dea2e2e5388e994aa6aed98f483120d10313d.png" src="../_images/540dde2c5415c02e6d1b95f8008dea2e2e5388e994aa6aed98f483120d10313d.png" />
<img alt="../_images/2bffc5990ba58d534d46fedc681787754df865d7e6f20b88c37a361ecc7edea3.png" src="../_images/2bffc5990ba58d534d46fedc681787754df865d7e6f20b88c37a361ecc7edea3.png" />
</div>
</div>
</section>
<section id="plot-cdf">
<h2>plot_cdf<a class="headerlink" href="#plot-cdf" title="Permalink to this heading">#</a></h2>
<p><a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#plot_cdf.py">[command line version]</a></p>
<p>This program reads in a data file, sorts it and plots the data as a cumulative distribution function (using <strong>pmagplotlib.plot_cdf()</strong>.  But we can do this directly from within the notebook without much fuss. And for plot_2cdfs, just do this twice.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># read the data in</span>
<span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;data_files/plot_cdf/gaussian.out&#39;</span><span class="p">)</span>
<span class="c1"># sort the data</span>
<span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="c1"># create a y array</span>
<span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="s1">&#39;r-&#39;</span><span class="p">)</span>
<span class="c1"># label</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Data&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Cumulative Distribution&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/9c56f9f1c5e4efdf504ba7f3aa4633c1806ccd5deb3c79cad6f9e27003652382.png" src="../_images/9c56f9f1c5e4efdf504ba7f3aa4633c1806ccd5deb3c79cad6f9e27003652382.png" />
</div>
</div>
</section>
<section id="plot-geomagia">
<h2>plot_geomagia<a class="headerlink" href="#plot-geomagia" title="Permalink to this heading">#</a></h2>
<p><a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#plot_geomagia.py">[command line version]</a></p>
<p>Geomagia is a database specially designed for archaeomagnetic and volcanic data for the last 50 kyr with a friendly search interface.   <strong>plot_geomagia</strong>   is meant to plot data from files downloaded from the geomagia website: <a class="reference external" href="http://geomagia.gfz-potsdam.de/geomagiav3/AAquery.php">http://geomagia.gfz-potsdam.de/geomagiav3/AAquery.php</a>.  We can do this within the notebook.  The example used here  was for Sicily so if we felt like it, we could combine it with the <strong>ipmag.igrf()</strong> using one of the data models (which are in large part based on data in the geomagia database.</p>
<p>Here we want to plot inclination as a function of age.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">geomagia</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data_files/geomagia/geomagia_sel.txt&#39;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">geomagia</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Age[yr.AD]</th>
      <th>Sigma-ve[yr.]</th>
      <th>Sigma+ve[yr.]</th>
      <th>SigmaAgeID</th>
      <th>N_Ba</th>
      <th>n_Ba[meas.]</th>
      <th>n_Ba[acc.]</th>
      <th>Ba[microT]</th>
      <th>SigmaBa[microT]</th>
      <th>VDM[E22_AmE2]</th>
      <th>...</th>
      <th>SpecTypeID</th>
      <th>RefID</th>
      <th>CompilationID</th>
      <th>UploadMonth</th>
      <th>UploadYear</th>
      <th>Uploader</th>
      <th>Editor</th>
      <th>LastEditDate</th>
      <th>C14ID</th>
      <th>UID</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1607</td>
      <td>-9999</td>
      <td>-9999</td>
      <td>1</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>-999.00</td>
      <td>...</td>
      <td>3</td>
      <td>36</td>
      <td>1005</td>
      <td>-999</td>
      <td>2009</td>
      <td>Fabio Donadini</td>
      <td>Maxwell Brown</td>
      <td>24/07/2017</td>
      <td>-1</td>
      <td>857</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1610</td>
      <td>10</td>
      <td>10</td>
      <td>1</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999.0</td>
      <td>-999.0</td>
      <td>-999.00</td>
      <td>...</td>
      <td>0</td>
      <td>259</td>
      <td>1001</td>
      <td>-999</td>
      <td>2009</td>
      <td>Fabio Donadini</td>
      <td>-999</td>
      <td>-999</td>
      <td>-1</td>
      <td>5666</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1610</td>
      <td>-9999</td>
      <td>-9999</td>
      <td>1</td>
      <td>1</td>
      <td>-999</td>
      <td>5</td>
      <td>42.1</td>
      <td>3.2</td>
      <td>6.74</td>
      <td>...</td>
      <td>3</td>
      <td>36</td>
      <td>1001;1006;1010</td>
      <td>-999</td>
      <td>2007</td>
      <td>Fabio Donadini</td>
      <td>Maxwell Brown</td>
      <td>24/07/2017</td>
      <td>-1</td>
      <td>858</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1610</td>
      <td>5</td>
      <td>5</td>
      <td>1</td>
      <td>1</td>
      <td>-999</td>
      <td>4</td>
      <td>40.5</td>
      <td>8.1</td>
      <td>-999.00</td>
      <td>...</td>
      <td>1</td>
      <td>57</td>
      <td>1001;1006;1010;1011</td>
      <td>-999</td>
      <td>2007</td>
      <td>Fabio Donadini</td>
      <td>-999</td>
      <td>-999</td>
      <td>-1</td>
      <td>1403</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1614</td>
      <td>-9999</td>
      <td>-9999</td>
      <td>1</td>
      <td>1</td>
      <td>-999</td>
      <td>5</td>
      <td>40.8</td>
      <td>3.2</td>
      <td>-999.00</td>
      <td>...</td>
      <td>3</td>
      <td>36</td>
      <td>1001;1006;1010</td>
      <td>-999</td>
      <td>2007</td>
      <td>Fabio Donadini</td>
      <td>Maxwell Brown</td>
      <td>24/07/2017</td>
      <td>-1</td>
      <td>836</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 46 columns</p>
</div></div></div>
</div>
<p>We have to ‘clean’ the dataset by getting rid of the records with no inclinations (-999)  We can use Panda’s filtering power for that:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">geomagia_incs</span><span class="o">=</span><span class="n">geomagia</span><span class="p">[</span><span class="n">geomagia</span><span class="p">[</span><span class="s1">&#39;Inc[deg.]&#39;</span><span class="p">]</span><span class="o">&gt;-</span><span class="mi">90</span><span class="p">]</span>
<span class="n">geomagia_incs</span><span class="p">[</span><span class="s1">&#39;Inc[deg.]&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0     62.8
1     60.0
2     65.1
5     65.0
6     61.5
7     61.6
9     61.4
10    57.5
11    62.2
12    57.3
13    60.7
14    62.5
15    60.4
17    61.8
18    63.3
19    64.0
20    65.4
21    64.1
22    57.7
23    54.2
24    54.2
25    56.6
26    58.3
28    56.1
29    57.9
31    53.2
32    54.8
35    55.7
37    51.5
38    52.0
42    50.5
43    49.8
44    49.8
46    51.7
48    51.3
50    50.7
51    49.0
52    51.6
53    52.3
56    50.9
59    49.0
Name: Inc[deg.], dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">geomagia_incs</span><span class="p">[</span><span class="s1">&#39;Age[yr.AD]&#39;</span><span class="p">],</span><span class="n">geomagia_incs</span><span class="p">[</span><span class="s1">&#39;Inc[deg.]&#39;</span><span class="p">],</span><span class="s1">&#39;ro&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Age (CE)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Inclination&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/e457cbaaaaab6eaeb8ccef7e05225d627ef6bcc305921888936b5210232b5aac.png" src="../_images/e457cbaaaaab6eaeb8ccef7e05225d627ef6bcc305921888936b5210232b5aac.png" />
</div>
</div>
</section>
<section id="plot-mag-map">
<h2>plot_mag_map<a class="headerlink" href="#plot-mag-map" title="Permalink to this heading">#</a></h2>
<p><a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#plot_mag_map.py">[command line version]</a></p>
<p>This program was designed to make color contour maps of geomagnetic field elements drawn from various IGRF-like field models (see also <span class="xref myst">igrf</span>).<br />
It calls <strong>pmag.do_mag_map())</strong> to generate arrays for plotting with the <strong>pmagplotlib.plot_mag_map()</strong> function.   We can do that from within this notebook.  NB: The cartopy version of this is still a bit buggy and functions best with the PlateCarree projection.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">do_mag_map</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function do_mag_map in module pmagpy.pmag:

do_mag_map(date, lon_0=0, alt=0, file=&#39;&#39;, mod=&#39;cals10k&#39;, resolution=&#39;low&#39;)
    returns lists of declination, inclination and intensities for lat/lon grid for
    desired model and date.
    
    Parameters:
    _________________
    date = Required date in decimal years (Common Era, negative for Before Common Era)
    
    Optional Parameters:
    ______________
    mod  = model to use (&#39;arch3k&#39;,&#39;cals3k&#39;,&#39;pfm9k&#39;,&#39;hfm10k&#39;,&#39;cals10k.2&#39;,&#39;shadif14k&#39;,&#39;cals10k.1b&#39;,&#39;custom&#39;)
    file = l m g h formatted filefor custom model
    lon_0 : central longitude for Hammer projection
    alt  = altitude
    resolution = [&#39;low&#39;,&#39;high&#39;] default is low
    
    Returns:
    ______________
    Bdec=list of declinations
    Binc=list of inclinations
    B = list of total field intensities in nT
    Br = list of radial field intensities
    lons = list of longitudes evaluated
    lats = list of latitudes evaluated
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># define some useful parameters</span>
<span class="n">date</span><span class="p">,</span><span class="n">mod</span><span class="p">,</span><span class="n">lon_0</span><span class="p">,</span><span class="n">alt</span><span class="p">,</span><span class="n">ghfile</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;cals10k.2&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;&quot;</span> <span class="c1"># only date is required</span>
<span class="n">Ds</span><span class="p">,</span><span class="n">Is</span><span class="p">,</span><span class="n">Bs</span><span class="p">,</span><span class="n">Brs</span><span class="p">,</span><span class="n">lons</span><span class="p">,</span><span class="n">lats</span><span class="o">=</span><span class="n">pmag</span><span class="o">.</span><span class="n">do_mag_map</span><span class="p">(</span><span class="n">date</span><span class="p">,</span><span class="n">mod</span><span class="o">=</span><span class="n">mod</span><span class="p">,</span><span class="n">lon_0</span><span class="o">=</span><span class="n">lon_0</span><span class="p">,</span><span class="n">alt</span><span class="o">=</span><span class="n">alt</span><span class="p">,</span><span class="n">file</span><span class="o">=</span><span class="n">ghfile</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">ipmag</span><span class="o">.</span><span class="n">igrf</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function igrf in module pmagpy.ipmag:

igrf(input_list, mod=&#39;&#39;, ghfile=&#39;&#39;)
    Determine Declination, Inclination and Intensity from the IGRF model.
    (http://www.ngdc.noaa.gov/IAGA/vmod/igrf.html)
    
    Parameters
    ----------
    input_list : list with format [Date, Altitude, Latitude, Longitude]
        date must be in decimal year format XXXX.XXXX (Common Era)
    mod :  desired model
        &quot;&quot; : Use the IGRF
        custom : use values supplied in ghfile
        or choose from this list
        [&#39;arch3k&#39;,&#39;cals3k&#39;,&#39;pfm9k&#39;,&#39;hfm10k&#39;,&#39;cals10k.2&#39;,&#39;cals10k.1b&#39;]
        where:
            arch3k (Korte et al., 2009)
            cals3k (Korte and Constable, 2011)
            cals10k.1b (Korte et al., 2011)
            pfm9k  (Nilsson et al., 2014)
            hfm10k is the hfm.OL1.A1 of Constable et al. (2016)
            cals10k.2 (Constable et al., 2016)
            the first four of these models, are constrained to agree
            with gufm1 (Jackson et al., 2000) for the past four centuries
    
    
    gh : path to file with l m g h data
    
    Returns
    -------
    igrf_array : array of IGRF values (0: dec; 1: inc; 2: intensity (in nT))
    
    Examples
    --------
    &gt;&gt;&gt; local_field = ipmag.igrf([2013.6544, .052, 37.87, -122.27])
    &gt;&gt;&gt; local_field
    array([  1.39489916e+01,   6.13532008e+01,   4.87452644e+04])
    &gt;&gt;&gt; ipmag.igrf_print(local_field)
    Declination: 13.949
    Inclination: 61.353
    Intensity: 48745.264 nT
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pmagplotlib</span><span class="o">.</span><span class="n">plot_mag_map</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function plot_mag_map in module pmagpy.pmagplotlib:

plot_mag_map(fignum, element, lons, lats, element_type, cmap=&#39;coolwarm&#39;, lon_0=0, date=&#39;&#39;, contours=False, proj=&#39;PlateCarree&#39;, min=False, max=False)
    makes a color contour map of geomagnetic field element
    
    Parameters
    ____________
    fignum : matplotlib figure number
    element : field element array from pmag.do_mag_map for plotting
    lons : longitude array from pmag.do_mag_map for plotting
    lats : latitude array from pmag.do_mag_map for plotting
    element_type : [B,Br,I,D] geomagnetic element type
        B : field intensity
        Br : radial field intensity
        I : inclinations
        D : declinations
    Optional
    _________
    contours : plot the contour lines on top of the heat map if True
    proj : cartopy projection [&#39;PlateCarree&#39;,&#39;Mollweide&#39;]
           NB: The Mollweide projection can only be reliably with cartopy=0.17.0; otherwise use lon_0=0.  Also, for declinations, PlateCarree is recommended.
    cmap : matplotlib color map - see https://matplotlib.org/examples/color/colormaps_reference.html for options
    lon_0 : central longitude of the Mollweide projection
    date : date used for field evaluation,
           if custom ghfile was used, supply filename
    min : int
        minimum value for color contour on intensity map : default is minimum value  - useful for making many maps with same scale
    max : int
        maximum value for color contour on intensity map : default is maximum value - useful for making many maps with same scale
    
    Effects
    ______________
    plots a color contour map with  the desired field element
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span> <span class="c1"># nice color map for contourf</span>
<span class="k">if</span> <span class="n">has_cartopy</span><span class="p">:</span>
    <span class="n">pmagplotlib</span><span class="o">.</span><span class="n">plot_mag_map</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">Bs</span><span class="p">,</span><span class="n">lons</span><span class="p">,</span><span class="n">lats</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span><span class="n">date</span><span class="o">=</span><span class="n">date</span><span class="p">,</span><span class="n">proj</span><span class="o">=</span><span class="s1">&#39;Mollweide&#39;</span><span class="p">,</span><span class="n">contours</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># plot the field strength</span>
    <span class="n">pmagplotlib</span><span class="o">.</span><span class="n">plot_mag_map</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">Is</span><span class="p">,</span><span class="n">lons</span><span class="p">,</span><span class="n">lats</span><span class="p">,</span><span class="s1">&#39;I&#39;</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span><span class="n">date</span><span class="o">=</span><span class="n">date</span><span class="p">,</span><span class="n">proj</span><span class="o">=</span><span class="s1">&#39;Mollweide&#39;</span><span class="p">,</span><span class="n">contours</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="c1"># plot the inclination</span>
    <span class="n">pmagplotlib</span><span class="o">.</span><span class="n">plot_mag_map</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">Ds</span><span class="p">,</span><span class="n">lons</span><span class="p">,</span><span class="n">lats</span><span class="p">,</span><span class="s1">&#39;D&#39;</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span><span class="n">date</span><span class="o">=</span><span class="n">date</span><span class="p">,</span><span class="n">contours</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="c1"># plot the declination    </span>
<span class="k">elif</span> <span class="n">has_basemap</span><span class="p">:</span>
    <span class="n">pmagplotlib</span><span class="o">.</span><span class="n">plot_mag_map_basemap</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">Bs</span><span class="p">,</span><span class="n">lons</span><span class="p">,</span><span class="n">lats</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="n">date</span><span class="o">=</span><span class="n">date</span><span class="p">)</span> <span class="c1"># plot the field strength</span>
    <span class="n">pmagplotlib</span><span class="o">.</span><span class="n">plot_mag_map_basemap</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">Is</span><span class="p">,</span><span class="n">lons</span><span class="p">,</span><span class="n">lats</span><span class="p">,</span><span class="s1">&#39;I&#39;</span><span class="p">,</span><span class="n">date</span><span class="o">=</span><span class="n">date</span><span class="p">)</span><span class="c1"># plot the inclination</span>
    <span class="n">pmagplotlib</span><span class="o">.</span><span class="n">plot_mag_map_basemap</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">Ds</span><span class="p">,</span><span class="n">lons</span><span class="p">,</span><span class="n">lats</span><span class="p">,</span><span class="s1">&#39;D&#39;</span><span class="p">,</span><span class="n">date</span><span class="o">=</span><span class="n">date</span><span class="p">)</span><span class="c1"># plot the declination</span>
    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ca9a16d8e05d28eb630e796e8e0026249e534ae4a33f29f91f9a2485afd33ce4.png" src="../_images/ca9a16d8e05d28eb630e796e8e0026249e534ae4a33f29f91f9a2485afd33ce4.png" />
<img alt="../_images/24d6907654660c19643ba296c6b4571c89466646d1567ebadab667ccf1b780c7.png" src="../_images/24d6907654660c19643ba296c6b4571c89466646d1567ebadab667ccf1b780c7.png" />
<img alt="../_images/2b97abd797e43443ab348c24bf72a7ed1e24fb6f9536b19c262b51df6e060396.png" src="../_images/2b97abd797e43443ab348c24bf72a7ed1e24fb6f9536b19c262b51df6e060396.png" />
</div>
</div>
</section>
<section id="plot-map-pts">
<h2>plot_map_pts<a class="headerlink" href="#plot-map-pts" title="Permalink to this heading">#</a></h2>
<p><a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#plot_map_pts.py">[command line version]</a></p>
<p>This program will generate a simple map of the data points read from a file (lon lat) on the desired projection. If you want to use high resolution or the etopo20 meshgrid with basemap, you must install the etopo20 data files (run  <strong>install_etopo.py</strong> from the command line).</p>
<p>This program sets  a bunch of options and calls <strong>pmagplotlib.plot_map()</strong>.  Note, if Basemap is  installed, you can use <strong>pmagplotlib.plot_map_basemap()</strong> instead which uses the older (but less buggy) and soon to be deprecated <strong>Basemap</strong> plotting package.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pmagplotlib</span><span class="o">.</span><span class="n">plot_map</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function plot_map in module pmagpy.pmagplotlib:

plot_map(fignum, lats, lons, Opts)
    makes a cartopy map  with lats/lons
    Requires installation of cartopy
    
    Parameters:
    _______________
    fignum : matplotlib figure number
    lats : array or list of latitudes
    lons : array or list of longitudes
    Opts : dictionary of plotting options:
        Opts.keys=
            proj : projection [supported cartopy projections:
                pc = Plate Carree
                aea = Albers Equal Area
                aeqd = Azimuthal Equidistant
                lcc = Lambert Conformal
                lcyl = Lambert Cylindrical
                merc = Mercator
                mill = Miller Cylindrical
                moll = Mollweide [default]
                ortho = Orthographic
                robin = Robinson
                sinu = Sinusoidal
                stere = Stereographic
                tmerc = Transverse Mercator
                utm = UTM [set zone and south keys in Opts]
                laea = Lambert Azimuthal Equal Area
                geos = Geostationary
                npstere = North-Polar Stereographic
                spstere = South-Polar Stereographic
            latmin : minimum latitude for plot
            latmax : maximum latitude for plot
            lonmin : minimum longitude for plot
            lonmax : maximum longitude
            lat_0 : central latitude
            lon_0 : central longitude
            sym : matplotlib symbol
            symsize : symbol size in pts
            edge : markeredgecolor
            cmap : matplotlib color map
            res :  resolution [c,l,i,h] for low/crude, intermediate, high
            boundinglat : bounding latitude
            sym : matplotlib symbol for plotting
            symsize : matplotlib symbol size for plotting
            names : list of names for lats/lons (if empty, none will be plotted)
            pltgrd : if True, put on grid lines
            padlat : padding of latitudes
            padlon : padding of longitudes
            gridspace : grid line spacing
            global : global projection [default is True]
            oceancolor : &#39;azure&#39;
            landcolor : &#39;bisque&#39; [choose any of the valid color names for matplotlib
              see https://matplotlib.org/examples/color/named_colors.html
            details : dictionary with keys:
                coasts : if True, plot coastlines
                rivers : if True, plot rivers
                states : if True, plot states
                countries : if True, plot countries
                ocean : if True, plot ocean
                fancy : if True, plot etopo 20 grid
                    NB:  etopo must be installed
        if Opts keys not set :these are the defaults:
           Opts={&#39;latmin&#39;:-90,&#39;latmax&#39;:90,&#39;lonmin&#39;:0,&#39;lonmax&#39;:360,&#39;lat_0&#39;:0,&#39;lon_0&#39;:0,&#39;proj&#39;:&#39;moll&#39;,&#39;sym&#39;:&#39;ro,&#39;symsize&#39;:5,&#39;edge&#39;:&#39;black&#39;,&#39;pltgrid&#39;:1,&#39;res&#39;:&#39;c&#39;,&#39;boundinglat&#39;:0.,&#39;padlon&#39;:0,&#39;padlat&#39;:0,&#39;gridspace&#39;:30,&#39;details&#39;:all False,&#39;edge&#39;:None,&#39;cmap&#39;:&#39;jet&#39;,&#39;fancy&#39;:0,&#39;zone&#39;:&#39;&#39;,&#39;south&#39;:False,&#39;oceancolor&#39;:&#39;azure&#39;,&#39;landcolor&#39;:&#39;bisque&#39;}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># read in some data: </span>
<span class="c1"># this is the cartopy version</span>
<span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;data_files/plot_map_pts/uniform.out&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="n">lons</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># longitudes array</span>
<span class="n">lats</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># latitudes array</span>
<span class="c1"># set some options </span>
<span class="n">Opts</span><span class="o">=</span><span class="p">{}</span>
<span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;sym&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;bo&#39;</span> <span class="c1"># sets the symbol to white dots</span>
<span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;symsize&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">3</span> <span class="c1"># sets symbol size to 3 pts</span>
<span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;proj&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;robin&#39;</span> <span class="c1"># Robinson projection</span>
<span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;details&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">{}</span>
<span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;details&#39;</span><span class="p">][</span><span class="s1">&#39;coasts&#39;</span><span class="p">]</span><span class="o">=</span><span class="kc">True</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span> <span class="c1"># optional - make a map</span>
<span class="k">if</span> <span class="n">has_cartopy</span><span class="p">:</span>
    <span class="n">pmagplotlib</span><span class="o">.</span><span class="n">plot_map</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">lats</span><span class="p">,</span> <span class="n">lons</span><span class="p">,</span> <span class="n">Opts</span><span class="p">)</span>
<span class="k">elif</span> <span class="n">has_basemap</span><span class="p">:</span>
    <span class="n">pmagplotlib</span><span class="o">.</span><span class="n">plot_map_basemap</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">lats</span><span class="p">,</span> <span class="n">lons</span><span class="p">,</span> <span class="n">Opts</span><span class="p">)</span>
    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>gridlines only supported for PlateCarree, Lambert Conformal, and Mercator plots currently
</pre></div>
</div>
<img alt="../_images/2710ef6c7c4c474888be057f802288a096d0ee1c4262bca47fbb7a8bef936e4a.png" src="../_images/2710ef6c7c4c474888be057f802288a096d0ee1c4262bca47fbb7a8bef936e4a.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># read in some data: </span>
<span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;data_files/plot_map_pts/uniform.out&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="n">lons</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># longitudes array</span>
<span class="n">lats</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># latitudes array</span>
<span class="c1"># set some options </span>
<span class="n">Opts</span><span class="o">=</span><span class="p">{}</span>
<span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;sym&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;wo&#39;</span> <span class="c1"># sets the symbol to white dots</span>
<span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;symsize&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">3</span> <span class="c1"># sets symbol size to 10 pts</span>
<span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;proj&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;pc&#39;</span> <span class="c1"># Platecarre projection</span>
<span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;edge&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;black&#39;</span>
<span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;details&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">{}</span>
<span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;details&#39;</span><span class="p">][</span><span class="s1">&#39;fancy&#39;</span><span class="p">]</span><span class="o">=</span><span class="kc">True</span> <span class="c1"># this option takes a while....   </span>
<span class="k">if</span> <span class="n">has_cartopy</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span> <span class="c1"># optional - make a map</span>
    <span class="n">pmagplotlib</span><span class="o">.</span><span class="n">plot_map</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">lats</span><span class="p">,</span> <span class="n">lons</span><span class="p">,</span> <span class="n">Opts</span><span class="p">)</span>   
<span class="k">elif</span> <span class="n">has_basemap</span><span class="p">:</span> <span class="c1"># this only works if you have basemap installed</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,(</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span> <span class="c1"># optional - make a map</span>
    <span class="n">pmagplotlib</span><span class="o">.</span><span class="n">plot_map_basemap</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">lats</span><span class="p">,</span> <span class="n">lons</span><span class="p">,</span> <span class="n">Opts</span><span class="p">)</span>
    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/90ef9d3b69631cffd0a99bc85424ff5c002d9b927f81375184091ba82eb6fe3f.png" src="../_images/90ef9d3b69631cffd0a99bc85424ff5c002d9b927f81375184091ba82eb6fe3f.png" />
</div>
</div>
<p>Here’s an example with a simple site location.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Opts</span><span class="o">=</span><span class="p">{}</span>
<span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;sym&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;r*&#39;</span> <span class="c1"># sets the symbol to white dots</span>
<span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;symsize&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">100</span> <span class="c1"># sets symbol size to 3 pts</span>
<span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;proj&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;lcc&#39;</span> <span class="c1"># Lambert Conformal projection</span>
<span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;pltgrid&#39;</span><span class="p">]</span><span class="o">=</span><span class="kc">True</span>
<span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;lat_0&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">33</span>
<span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;lon_0&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">260</span>
<span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;latmin&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">20</span>
<span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;latmax&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">52</span>
<span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;lonmin&#39;</span><span class="p">]</span><span class="o">=-</span><span class="mi">130</span>
<span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;lonmax&#39;</span><span class="p">]</span><span class="o">=-</span><span class="mi">70</span>
<span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;gridspace&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">10</span>
<span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;details&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">{}</span>
<span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;details&#39;</span><span class="p">][</span><span class="s1">&#39;coasts&#39;</span><span class="p">]</span><span class="o">=</span><span class="kc">True</span>
<span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;details&#39;</span><span class="p">][</span><span class="s1">&#39;ocean&#39;</span><span class="p">]</span><span class="o">=</span><span class="kc">True</span>
<span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;details&#39;</span><span class="p">][</span><span class="s1">&#39;countries&#39;</span><span class="p">]</span><span class="o">=</span><span class="kc">True</span>
<span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;global&#39;</span><span class="p">]</span><span class="o">=</span><span class="kc">False</span>
<span class="n">lats</span><span class="p">,</span><span class="n">lons</span><span class="o">=</span><span class="p">[</span><span class="mi">33</span><span class="p">],[</span><span class="o">-</span><span class="mi">117</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span> <span class="c1"># optional - make a map</span>
<span class="k">if</span> <span class="n">has_cartopy</span><span class="p">:</span>
    <span class="n">pmagplotlib</span><span class="o">.</span><span class="n">plot_map</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">lats</span><span class="p">,</span> <span class="n">lons</span><span class="p">,</span> <span class="n">Opts</span><span class="p">)</span>
<span class="k">elif</span> <span class="n">has_basemap</span><span class="p">:</span>
    <span class="n">pmagplotlib</span><span class="o">.</span><span class="n">plot_map_basemap</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">lats</span><span class="p">,</span> <span class="n">lons</span><span class="p">,</span> <span class="n">Opts</span><span class="p">)</span>

    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/fe8dce3eb032d5a0b0c155ce7d52ab72b54023f89532a875e3d8065d3c306641.png" src="../_images/fe8dce3eb032d5a0b0c155ce7d52ab72b54023f89532a875e3d8065d3c306641.png" />
</div>
</div>
</section>
<section id="plot-di-mean">
<h2>plot_di_mean<a class="headerlink" href="#plot-di-mean" title="Permalink to this heading">#</a></h2>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch11.html">[Essentials Chapter 11]</a></p>
<p>We can use the function <strong>ipmag.plot_di_mean()</strong> to make plots of declination, inclination with <span class="math notranslate nohighlight">\(\alpha_{95}\)</span> uncertainty.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">ipmag</span><span class="o">.</span><span class="n">plot_di_mean</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function plot_di_mean in module pmagpy.ipmag:

plot_di_mean(dec, inc, a95, color=&#39;k&#39;, marker=&#39;o&#39;, markersize=20, label=&#39;&#39;, legend=&#39;no&#39;)
    Plot a mean direction (declination, inclination) with alpha_95 ellipse on
    an equal area plot.
    
    Before this function is called, a plot needs to be initialized with code
    that looks something like:
    &gt;fignum = 1
    &gt;plt.figure(num=fignum,figsize=(10,10),dpi=160)
    &gt;ipmag.plot_net(fignum)
    
    Required Parameters
    -----------
    dec : declination of mean being plotted
    inc : inclination of mean being plotted
    a95 : a95 confidence ellipse of mean being plotted
    
    Optional Parameters (defaults are used if not specified)
    -----------
    color : the default color is black. Other colors can be chosen (e.g. &#39;r&#39;).
    marker : the default is a circle. Other symbols can be chosen (e.g. &#39;s&#39;).
    markersize : the default is 20. Other sizes can be chosen.
    label : the default is no label. Labels can be assigned.
    legend : the default is no legend (&#39;no&#39;). Putting &#39;yes&#39; will plot a legend.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># read in some data</span>
<span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;data_files/plotdi_a/plotdi_a_example.dat&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="n">decs</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># array of declinations</span>
<span class="n">incs</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># array of inclinations</span>
<span class="n">a95s</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># array of alpha95s</span>
<span class="c1"># make the plots</span>
<span class="n">fignum</span><span class="o">=</span><span class="mi">1</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">fignum</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span> <span class="c1"># make a figure object</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">plot_net</span><span class="p">(</span><span class="n">fignum</span><span class="p">)</span> <span class="c1"># plot the equal area net</span>
<span class="k">for</span> <span class="n">pt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">decs</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span> <span class="c1"># step through the data</span>
    <span class="n">ipmag</span><span class="o">.</span><span class="n">plot_di_mean</span><span class="p">(</span><span class="n">dec</span><span class="o">=</span><span class="n">decs</span><span class="p">[</span><span class="n">pt</span><span class="p">],</span><span class="n">inc</span><span class="o">=</span><span class="n">incs</span><span class="p">[</span><span class="n">pt</span><span class="p">],</span><span class="n">a95</span><span class="o">=</span><span class="n">a95s</span><span class="p">[</span><span class="n">pt</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/a4cc3218bd4c245079374a6a5bbba70f41ded79624e05a6592130b6fe3dc014b.png" src="../_images/a4cc3218bd4c245079374a6a5bbba70f41ded79624e05a6592130b6fe3dc014b.png" />
</div>
</div>
<section id="polemap-magic">
<h3>polemap_magic<a class="headerlink" href="#polemap-magic" title="Permalink to this heading">#</a></h3>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch16.html">[Essentials Chapter 16]</a>
<a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#polemap_magic.py">[command line version]</a></p>
<p><strong>polemap_magic</strong> plots poles from a MagIC formatted <strong>locations.txt</strong> file.  Alternatively, we
can use <strong>ipmag.plot_vgp()</strong> for this, but substituting paleomagnetic poles for VGPs (the math is the same).  We’ll try this out on a set of poles downloaded from the MagIC database for the Cretaceous of Europe.</p>
<p>Let’s try it both ways, first with <strong>ipmag.plot_vgp( )</strong>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">ipmag</span><span class="o">.</span><span class="n">plot_vgp</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function plot_vgp in module pmagpy.ipmag:

plot_vgp(map_axis, vgp_lon=None, vgp_lat=None, di_block=None, label=&#39;&#39;, color=&#39;k&#39;, marker=&#39;o&#39;, edge=&#39;black&#39;, markersize=20, legend=False)
    This function plots a paleomagnetic pole position on a cartopy map axis.
    
    Before this function is called, a plot needs to be initialized with code
    such as that in the make_orthographic_map function.
    
    Example
    -------
    &gt;&gt;&gt; vgps = ipmag.fishrot(dec=200,inc=30)
    &gt;&gt;&gt; vgp_lon_list,vgp_lat_list,intensities= ipmag.unpack_di_block(vgps)
    &gt;&gt;&gt; map_axis = ipmag.make_orthographic_map(central_longitude=200,central_latitude=30)
    &gt;&gt;&gt; ipmag.plot_vgp(map_axis,vgp_lon=vgp_lon_list,vgp_lat=vgp_lat_list,color=&#39;red&#39;,markersize=40)
    
    Required Parameters
    -----------
    map_axis : the name of the current map axis that has been developed using cartopy
    plon : the longitude of the paleomagnetic pole being plotted (in degrees E)
    plat : the latitude of the paleomagnetic pole being plotted (in degrees)
    
    Optional Parameters (defaults are used if not specified)
    -----------
    color : the color desired for the symbol (default is &#39;k&#39; aka black)
    marker : the marker shape desired for the pole mean symbol (default is &#39;o&#39; aka a circle)
    edge : the color of the edge of the marker (default is black)
    markersize : size of the marker in pt (default is 20)
    label : the default is no label. Labels can be assigned.
    legend : the default is no legend (False). Putting True will plot a legend.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">ipmag</span><span class="o">.</span><span class="n">make_orthographic_map</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function make_orthographic_map in module pmagpy.ipmag:

make_orthographic_map(central_longitude=0, central_latitude=0, figsize=(8, 8), add_land=True, land_color=&#39;tan&#39;, add_ocean=False, ocean_color=&#39;lightblue&#39;, grid_lines=True, lat_grid=[-80.0, -60.0, -30.0, 0.0, 30.0, 60.0, 80.0], lon_grid=[-180.0, -150.0, -120.0, -90.0, -60.0, -30.0, 0.0, 30.0, 60.0, 90.0, 120.0, 150.0, 180.0])
    Function creates and returns an orthographic map projection using cartopy
    
    Example
    -------
    &gt;&gt;&gt; map_axis = make_orthographic_map(central_longitude=200,central_latitude=30)
    
    Optional Parameters
    -----------
    central_longitude : central longitude of projection (default is 0)
    central_latitude : central latitude of projection (default is 0)
    figsize : size of the figure (default is 8x8)
    add_land : chose whether land is plotted on map (default is true)
    land_color : specify land color (default is &#39;tan&#39;)
    add_ocean : chose whether land is plotted on map (default is False, change to True to plot)
    ocean_color : specify ocean color (default is &#39;lightblue&#39;)
    grid_lines : chose whether gird lines are plotted on map (default is true)
    lat_grid : specify the latitude grid (default is 30 degree spacing)
    lon_grid : specify the longitude grid (default is 30 degree spacing)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data_files/polemap_magic/locations.txt&#39;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">lats</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;pole_lat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">lons</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;pole_lon&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="k">if</span> <span class="n">has_cartopy</span><span class="p">:</span>
    <span class="n">map_axis</span> <span class="o">=</span><span class="n">ipmag</span><span class="o">.</span><span class="n">make_orthographic_map</span><span class="p">(</span><span class="n">central_latitude</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span><span class="n">land_color</span><span class="o">=</span><span class="s1">&#39;bisque&#39;</span><span class="p">)</span>
    <span class="n">ipmag</span><span class="o">.</span><span class="n">plot_vgp</span><span class="p">(</span><span class="n">map_axis</span><span class="p">,</span> <span class="n">vgp_lon</span><span class="o">=</span><span class="n">lons</span><span class="p">,</span> <span class="n">vgp_lat</span><span class="o">=</span><span class="n">lats</span><span class="p">,</span>\
                   <span class="n">markersize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span>    
    
<span class="k">elif</span> <span class="n">has_basemap</span><span class="p">:</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">Basemap</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;ortho&#39;</span><span class="p">,</span><span class="n">lat_0</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span><span class="n">lon_0</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">m</span><span class="o">.</span><span class="n">drawcoastlines</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">fillcontinents</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;bisque&#39;</span><span class="p">,</span><span class="n">lake_color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">drawmapboundary</span><span class="p">(</span><span class="n">fill_color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">drawmeridians</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">360</span><span class="p">,</span><span class="mi">30</span><span class="p">))</span>
    <span class="n">m</span><span class="o">.</span><span class="n">drawparallels</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mi">30</span><span class="p">))</span>
    <span class="n">ipmag</span><span class="o">.</span><span class="n">plot_vgp_basemap</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">vgp_lon</span><span class="o">=</span><span class="n">lons</span><span class="p">,</span> <span class="n">vgp_lat</span><span class="o">=</span><span class="n">lats</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> \
                   <span class="n">markersize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/a06d616f570d99ddaf7708f8026cef558177fa970c6e182b13283edd4f8527d0.png" src="../_images/a06d616f570d99ddaf7708f8026cef558177fa970c6e182b13283edd4f8527d0.png" />
</div>
</div>
<p>Alternatively, you can use the function <strong>ipmag.polemap_magic</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">ipmag</span><span class="o">.</span><span class="n">polemap_magic</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function polemap_magic in module pmagpy.ipmag:

polemap_magic(loc_file=&#39;locations.txt&#39;, dir_path=&#39;.&#39;, interactive=False, crd=&#39;&#39;, sym=&#39;ro&#39;, symsize=40, rsym=&#39;g^&#39;, rsymsize=40, fmt=&#39;pdf&#39;, res=&#39;c&#39;, proj=&#39;ortho&#39;, flip=False, anti=False, fancy=False, ell=False, ages=False, lat_0=90.0, lon_0=0.0, save_plots=True, contribution=None, image_records=False)
    Use a MagIC format locations table to plot poles.
    
    Parameters
    ----------
    loc_file : str, default &quot;locations.txt&quot;
    dir_path : str, default &quot;.&quot;
        directory name to find loc_file in (if not included in loc_file)
    interactive : bool, default False
       if True, interactively plot and display
        (this is best used on the command line only)
    crd : str, default &quot;&quot;
       coordinate system [g, t] (geographic, tilt_corrected)
    sym : str, default &quot;ro&quot;
        symbol color and shape, default red circles
        (see matplotlib documentation for more options)
    symsize : int, default 40
        symbol size
    rsym : str, default &quot;g^&quot;
        symbol for plotting reverse poles
    rsymsize : int, default 40
        symbol size for reverse poles
    fmt : str, default &quot;pdf&quot;
        format for figures, [&quot;svg&quot;, &quot;jpg&quot;, &quot;pdf&quot;, &quot;png&quot;]
    res : str, default &quot;c&quot;
        resolution [c, l, i, h] (crude, low, intermediate, high)
    proj : str, default &quot;ortho&quot;
        ortho = orthographic
        lcc = lambert conformal
        moll = molweide
        merc = mercator
    flip : bool, default False
        if True, flip reverse poles to normal antipode
    anti : bool, default False
        if True, plot antipodes for each pole
    fancy : bool, default False
        if True, plot topography (not yet implementedj)
    ell : bool, default False
        if True, plot ellipses
    ages : bool, default False
        if True, plot ages
    lat_0 : float, default 90.
        eyeball latitude
    lon_0 : float, default 0.
        eyeball longitude
    save_plots : bool, default True
        if True, create and save all requested plots
    image_records : generate and return a record for each image in a list of dicts
        which can be ingested by pmag.magic_write
        bool, default False
    
    Returns
    ---------
    if image_records == False:
        type - Tuple : (True or False indicating if conversion was sucessful, file name(s) written)
    if image_records == True:
       Tuple : (True or False indicating if conversion was sucessful, output file name written, list of image recs)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ipmag</span><span class="o">.</span><span class="n">polemap_magic</span><span class="p">(</span><span class="s1">&#39;data_files/polemap_magic/locations.txt&#39;</span><span class="p">,</span> <span class="n">save_plots</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(True, [])
</pre></div>
</div>
<img alt="../_images/389be0271bbc4a494bbfb34be5bf892993463306801ae8f6b6392260eb56a42b.png" src="../_images/389be0271bbc4a494bbfb34be5bf892993463306801ae8f6b6392260eb56a42b.png" />
</div>
</div>
</section>
<section id="plotting-poles-with-a-95-ellipse">
<h3>Plotting poles with A_{95} ellipse<a class="headerlink" href="#plotting-poles-with-a-95-ellipse" title="Permalink to this heading">#</a></h3>
<p><strong>ipmag.plot_pole()</strong> can be used to plot a poles with a A_{95} uncertainty ellipse.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">ipmag</span><span class="o">.</span><span class="n">plot_pole</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function plot_pole in module pmagpy.ipmag:

plot_pole(map_axis, plon, plat, A95, label=&#39;&#39;, color=&#39;k&#39;, edgecolor=&#39;k&#39;, marker=&#39;o&#39;, markersize=20, legend=&#39;no&#39;)
    This function plots a paleomagnetic pole and A95 error ellipse on a cartopy map axis.
    
    Before this function is called, a plot needs to be initialized with code
    such as that in the make_orthographic_map function.
    
    Example
    -------
    &gt;&gt;&gt; plon = 200
    &gt;&gt;&gt; plat = 60
    &gt;&gt;&gt; A95 = 6
    &gt;&gt;&gt; map_axis = ipmag.make_orthographic_map(central_longitude=200,central_latitude=30)
    &gt;&gt;&gt; ipmag.plot_pole(map_axis, plon, plat, A95 ,color=&#39;red&#39;,markersize=40)
    
    Required Parameters
    -----------
    map_axis : the name of the current map axis that has been developed using cartopy
    plon : the longitude of the paleomagnetic pole being plotted (in degrees E)
    plat : the latitude of the paleomagnetic pole being plotted (in degrees)
    A95 : the A_95 confidence ellipse of the paleomagnetic pole (in degrees)
    
    Optional Parameters (defaults are used if not specified)
    -----------
    color : the default color is black. Other colors can be chosen (e.g. &#39;r&#39;)
    marker : the default is a circle. Other symbols can be chosen (e.g. &#39;s&#39;)
    markersize : the default is 20. Other size can be chosen
    label : the default is no label. Labels can be assigned.
    legend : the default is no legend (&#39;no&#39;). Putting &#39;yes&#39; will plot a legend.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plon</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">plat</span> <span class="o">=</span> <span class="mi">60</span>
<span class="n">A95</span> <span class="o">=</span> <span class="mi">6</span>

<span class="k">if</span> <span class="n">has_cartopy</span><span class="p">:</span>
    <span class="n">map_axis</span> <span class="o">=</span> <span class="n">ipmag</span><span class="o">.</span><span class="n">make_orthographic_map</span><span class="p">(</span><span class="n">central_longitude</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span><span class="n">central_latitude</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
    <span class="n">ipmag</span><span class="o">.</span><span class="n">plot_pole</span><span class="p">(</span><span class="n">map_axis</span><span class="p">,</span> <span class="n">plon</span><span class="p">,</span> <span class="n">plat</span><span class="p">,</span> <span class="n">A95</span> <span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/72e1a962c9724fc0782c809b7dabd31c70c0d4a819eb68c95bc2b9a062b11dcb.png" src="../_images/72e1a962c9724fc0782c809b7dabd31c70c0d4a819eb68c95bc2b9a062b11dcb.png" />
</div>
</div>
</section>
<section id="plot-ts">
<h3>plot_ts<a class="headerlink" href="#plot-ts" title="Permalink to this heading">#</a></h3>
<p><strong>pmagplotlib.plot_ts( )</strong> makes a plot of the Geomagnetic Reversal Time Scale (your choice of several) between specified age points.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pmagplotlib</span><span class="o">.</span><span class="n">plot_ts</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function plot_ts in module pmagpy.pmagplotlib:

plot_ts(ax, agemin, agemax, timescale=&#39;gts12&#39;, ylabel=&#39;Age (Ma)&#39;)
    Make a time scale plot between specified ages.
    
    Parameters:
    ------------
    ax : figure object
    agemin : Minimum age for timescale
    agemax : Maximum age for timescale
    timescale : Time Scale [ default is Gradstein et al., (2012)]
       for other options see pmag.get_ts()
    ylabel : if set, plot as ylabel
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,(</span><span class="mi">3</span><span class="p">,</span><span class="mi">12</span><span class="p">))</span>
<span class="n">ax</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">agemin</span><span class="p">,</span><span class="n">agemax</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span>
<span class="n">pmagplotlib</span><span class="o">.</span><span class="n">plot_ts</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">agemin</span><span class="p">,</span><span class="n">agemax</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/2f32dc5f520c8efd46b74638a8e58ef9b551f7b88ea489d74fc7ce542190aa0a.png" src="../_images/2f32dc5f520c8efd46b74638a8e58ef9b551f7b88ea489d74fc7ce542190aa0a.png" />
</div>
</div>
</section>
<section id="qqplot">
<h3>qqplot<a class="headerlink" href="#qqplot" title="Permalink to this heading">#</a></h3>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ap2.html">[Essentials Appendix B.1.5]</a>
<a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#qqplot.py">[command line version]</a></p>
<p><strong>qqplot</strong> makes  a quantile-quantile plot of the input data file against a normal distribution. The plot has the mean, standard deviation and the <span class="math notranslate nohighlight">\(D\)</span> statistic as well as the <span class="math notranslate nohighlight">\(D_c\)</span> statistic expected from a normal distribution. We can read in a data file and then call <strong>pmagplotlib.plot_qq_norm()</strong>. Let’s reprise the <span class="xref myst"><strong>gaussian</strong></span> example from before and test if the data are in fact likely to be normally distributed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">gaussdev</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pmagplotlib</span><span class="o">.</span><span class="n">plot_qq_norm</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function plot_qq_norm in module pmagpy.pmagplotlib:

plot_qq_norm(fignum, Y, title)
    makes a Quantile-Quantile plot for data
    Parameters
    _________
    fignum : matplotlib figure number
    Y : list or array of data
    title : title string for plot
    
    Returns
    ___________
    d,dc : the values for D and Dc (the critical value)
       if d&gt;dc, likely to be normally distributed (95\% confidence)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">D</span><span class="p">,</span><span class="n">Dc</span><span class="o">=</span><span class="n">pmagplotlib</span><span class="o">.</span><span class="n">plot_qq_norm</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">data</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">D</span><span class="p">,</span><span class="n">Dc</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.05511804318865765 0.0886
</pre></div>
</div>
<img alt="../_images/e43f55a5569e851485b893ea7b432004dbd38bb908a765429c989f8d91b5db09.png" src="../_images/e43f55a5569e851485b893ea7b432004dbd38bb908a765429c989f8d91b5db09.png" />
</div>
</div>
<p>Whew!  it worked this time.  It will fail about 5% of the time.</p>
</section>
<section id="qqunf">
<h3>qqunf<a class="headerlink" href="#qqunf" title="Permalink to this heading">#</a></h3>
<p><a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#qqunf.py">[command line version]</a></p>
<p>This program is very much like <span class="xref myst"><strong>qqplot</strong></span> and <span class="xref myst"><strong>fishqq</strong></span> which plot data against a normal and Fisherian distributions respectively.  In fact <strong>fishqq</strong> plots the declination values against a uniform distribution just like <strong>qqunf</strong>.</p>
<p><strong><a class="reference external" href="http://qqunf.py">qqunf.py</a></strong> (the command line version) calls <strong>pmagplotlib.plot_qq_unf()</strong>.  To demonstrate the functionality of <strong>qqplot</strong>, we can generate a simulated data set with <strong>random.uniform()</strong>, inspect it with a histogram and then test whether it is likely to actually have been drawn from a uniform distribution (95% confidence) using <strong>pmagplotlib.plot_qq_unf()</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy.random</span> <span class="k">as</span> <span class="nn">random</span>
<span class="n">uniform</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">uniform</span><span class="p">,</span><span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;step&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([0.01111701, 0.01010637, 0.01111701, 0.01010637, 0.00505319,
        0.01515956, 0.00404255, 0.0080851 , 0.01212764, 0.01414892]),
 array([ 0.83282701, 10.72757607, 20.62232513, 30.51707419, 40.41182324,
        50.3065723 , 60.20132136, 70.09607041, 79.99081947, 89.88556853,
        99.78031758]),
 &lt;a list of 1 Patch objects&gt;)
</pre></div>
</div>
<img alt="../_images/d18fe50294789582057ce5435bbfe5d4745fcb53d4e8b94f049180d8b9beef98.png" src="../_images/d18fe50294789582057ce5435bbfe5d4745fcb53d4e8b94f049180d8b9beef98.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Mu</span><span class="p">,</span><span class="n">Mu_0</span><span class="o">=</span><span class="n">pmagplotlib</span><span class="o">.</span><span class="n">plot_qq_unf</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">uniform</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="n">degrees</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/a90446c3977e3d0634ae46c67d4903c2dec466d4c21798c0a4e2a599f57cbc31.png" src="../_images/a90446c3977e3d0634ae46c67d4903c2dec466d4c21798c0a4e2a599f57cbc31.png" />
</div>
</div>
</section>
<section id="quick-hyst">
<h3>quick_hyst<a class="headerlink" href="#quick-hyst" title="Permalink to this heading">#</a></h3>
<p><a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#quick_hyst.py">[command line version]</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">ipmag</span><span class="o">.</span><span class="n">quick_hyst</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function quick_hyst in module pmagpy.ipmag:

quick_hyst(dir_path=&#39;.&#39;, meas_file=&#39;measurements.txt&#39;, save_plots=True, interactive=False, fmt=&#39;png&#39;, specimen=&#39;&#39;, verbose=True, n_plots=10, contribution=None, image_records=False)
    makes specimen plots of hysteresis data
    
    Parameters
    ----------
    dir_path : str, default &quot;.&quot;
        input directory
    meas_file : str, default &quot;measurements.txt&quot;
        name of MagIC measurement file
    save_plots : bool, default True
        save figures
    interactive : bool, default False
        if True, interactively plot and display
        (this is best used on the command line only)
    fmt : str, default &quot;svg&quot;
        format for figures, [&quot;svg&quot;, &quot;jpg&quot;, &quot;pdf&quot;, &quot;png&quot;]
    specimen : str, default &quot;&quot;
        specific specimen to plot
    verbose : bool, default True
        if True, print more verbose output
    image_records : bool, default False
        if True, return a list of created images
    
    Returns
    ---------
    if image_records == False:
        Tuple : (True or False indicating if conversion was sucessful, output file name(s) written)
    if image_records == True:
        Tuple : (True or False indicating if conversion was sucessful, output file name(s) written, list of images)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ipmag</span><span class="o">.</span><span class="n">quick_hyst</span><span class="p">(</span><span class="s2">&quot;data_files/3_0/McMurdo&quot;</span><span class="p">,</span> <span class="n">save_plots</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>mc04c-1 1 out of  8
working on t:  273
</pre></div>
</div>
<img alt="../_images/e476af4ccc30afa577a7c0d2e575791a4f0439714d4c1d7c016b63cae2135f90.png" src="../_images/e476af4ccc30afa577a7c0d2e575791a4f0439714d4c1d7c016b63cae2135f90.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>mc113a1-1 2 out of  8
working on t:  273
</pre></div>
</div>
<img alt="../_images/2e40542618de431b2720802629f37450919610e541b2432d568523b58fb89819.png" src="../_images/2e40542618de431b2720802629f37450919610e541b2432d568523b58fb89819.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>mc117a2-1 3 out of  8
working on t:  273
</pre></div>
</div>
<img alt="../_images/efc6c7a4acfed7db1a324a1f922c8f4e15ac5587d980c932d1050149577e6ece.png" src="../_images/efc6c7a4acfed7db1a324a1f922c8f4e15ac5587d980c932d1050149577e6ece.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>mc120a2-1 4 out of  8
working on t:  273
</pre></div>
</div>
<img alt="../_images/a820cda4634f7de6a31d16a56c42d4e51a7a1ae128e254c335f31a067ff33d79.png" src="../_images/a820cda4634f7de6a31d16a56c42d4e51a7a1ae128e254c335f31a067ff33d79.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>mc129a1-1 5 out of  8
working on t:  273
</pre></div>
</div>
<img alt="../_images/8dfd8aaccf3d57df0e73adad3a3fcf38e5138b53c52389742c6c4d98bf4bd589.png" src="../_images/8dfd8aaccf3d57df0e73adad3a3fcf38e5138b53c52389742c6c4d98bf4bd589.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>mc164a2-1 6 out of  8
working on t:  273
</pre></div>
</div>
<img alt="../_images/c5d6477f5f3ffe0576445e284da059aa3a47423368b3c5c3228a59bcbc63b1a4.png" src="../_images/c5d6477f5f3ffe0576445e284da059aa3a47423368b3c5c3228a59bcbc63b1a4.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>mc205a1-1 7 out of  8
working on t:  273
</pre></div>
</div>
<img alt="../_images/e7dc56ad20833a1d8118ecf74336fae272564eff55d70535a68dc9f8a3203168.png" src="../_images/e7dc56ad20833a1d8118ecf74336fae272564eff55d70535a68dc9f8a3203168.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>mc217a2-1 8 out of  8
working on t:  273
</pre></div>
</div>
<img alt="../_images/dd06aa1734d9a38a6ce7ea6aaec23997dede0a60584598eb6cc999d2b25dab59.png" src="../_images/dd06aa1734d9a38a6ce7ea6aaec23997dede0a60584598eb6cc999d2b25dab59.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(True, [])
</pre></div>
</div>
</div>
</div>
</section>
<section id="revtest">
<h3>revtest<a class="headerlink" href="#revtest" title="Permalink to this heading">#</a></h3>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch12.html">[Essentials Chapter 12]</a>
<a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#revtest.py">[command line version]</a></p>
<p><strong>revtest</strong> uses the boostrap reversals test described in detail in <a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch12.html">[Chapter 12]</a> of the online text book “Essentials of Paleomagnetism”.  It splits the data into two polarity groups, flips the “reverse” mode to its antipodes and does the test for <span class="xref myst">common_mean</span> on the two groups.   It has been implemented for notebooks as <strong>ipmag.reversal_test_bootstrap())</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">ipmag</span><span class="o">.</span><span class="n">reversal_test_bootstrap</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function reversal_test_bootstrap in module pmagpy.ipmag:

reversal_test_bootstrap(dec=None, inc=None, di_block=None, plot_stereo=False, save=False, save_folder=&#39;.&#39;, fmt=&#39;svg&#39;)
    Conduct a reversal test using bootstrap statistics (Tauxe, 2010) to
    determine whether two populations of directions could be from an antipodal
    common mean.
    
    Parameters
    ----------
    dec: list of declinations
    inc: list of inclinations
        or
    di_block: a nested list of [dec,inc]
        A di_block can be provided in which case it will be used instead of
        dec, inc lists.
    
    plot_stereo : before plotting the CDFs, plot stereonet with the
        bidirectionally separated data (default is False)
    save : boolean argument to save plots (default is False)
    save_folder : directory where plots will be saved (default is current directory, &#39;.&#39;)
    fmt : format of saved figures (default is &#39;svg&#39;)
    
    Returns
    -------
    plots : Plots of the cumulative distribution of Cartesian components are
        shown as is an equal area plot if plot_stereo = True
    
    Examples
    --------
    Populations of roughly antipodal directions are developed here using
    ``ipmag.fishrot``. These directions are combined into a single di_block
    given that the function determines the principal component and splits the
    data accordingly by polarity.
    
    &gt;&gt;&gt; directions_n = ipmag.fishrot(k=20, n=30, dec=5, inc=-60)
    &gt;&gt;&gt; directions_r = ipmag.fishrot(k=35, n=25, dec=182, inc=57)
    &gt;&gt;&gt; directions = directions_n + directions_r
    &gt;&gt;&gt; ipmag.reversal_test_bootstrap(di_block=directions, plot_stereo = True)
    
    Data can also be input to the function as separate lists of dec and inc.
    In this example, the di_block from above is split into lists of dec and inc
    which are then used in the function:
    
    &gt;&gt;&gt; direction_dec, direction_inc, direction_moment = ipmag.unpack_di_block(directions)
    &gt;&gt;&gt; ipmag.reversal_test_bootstrap(dec=direction_dec,inc=direction_inc, plot_stereo = True)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">di_block</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;data_files/revtest/revtest_example.txt&#39;</span><span class="p">)</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">reversal_test_bootstrap</span><span class="p">(</span><span class="n">di_block</span><span class="o">=</span><span class="n">di_block</span><span class="p">,</span><span class="n">plot_stereo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/44d32255fc0abf471c0338578c57beb0d75d7148ab5886a8edee05d93c4d126a.png" src="../_images/44d32255fc0abf471c0338578c57beb0d75d7148ab5886a8edee05d93c4d126a.png" />
<img alt="../_images/f3dd9f06cc50ea7e48dbeb1f443fb850ab23a8339f0058b8b1cd0c4879b71be3.png" src="../_images/f3dd9f06cc50ea7e48dbeb1f443fb850ab23a8339f0058b8b1cd0c4879b71be3.png" />
</div>
</div>
</section>
<section id="revtest-magic">
<h3>revtest_magic<a class="headerlink" href="#revtest-magic" title="Permalink to this heading">#</a></h3>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch12.html">[Essentials Chapter 12]</a>
<a class="reference external" href="https://earthref.org/MagIC">[MagIC Database]</a>
<a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#revtest_magic.py">[command line version]</a></p>
<p>This is the same idea as <strong>revtest</strong> but reads in MagIC formatted data files.  We will do this the <strong>Pandas</strong> way.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data_files/revtest_magic/sites.txt&#39;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">decs</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">dir_dec</span><span class="o">.</span><span class="n">values</span>
<span class="n">incs</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">dir_inc</span><span class="o">.</span><span class="n">values</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">reversal_test_bootstrap</span><span class="p">(</span><span class="n">dec</span><span class="o">=</span><span class="n">decs</span><span class="p">,</span><span class="n">inc</span><span class="o">=</span><span class="n">incs</span><span class="p">,</span><span class="n">plot_stereo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/0b29edd139f66c3d24eb1229380888c3bb18ba43af63f2870439fbefc04bac50.png" src="../_images/0b29edd139f66c3d24eb1229380888c3bb18ba43af63f2870439fbefc04bac50.png" />
<img alt="../_images/7a503aefee025c9881c68db23a934d8e51a201ad5d756126086ac5a37a3e77f8.png" src="../_images/7a503aefee025c9881c68db23a934d8e51a201ad5d756126086ac5a37a3e77f8.png" />
</div>
</div>
</section>
<section id="revtest-mm1990">
<h3>revtest_mm1990<a class="headerlink" href="#revtest-mm1990" title="Permalink to this heading">#</a></h3>
<p>This program has been deprecated as it  is the same as <span class="xref myst">watsons_v</span> - check that one out.</p>
</section>
<section id="thellier-magic">
<h3>thellier_magic<a class="headerlink" href="#thellier-magic" title="Permalink to this heading">#</a></h3>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch10.html">[Essentials Chapter 10]</a>
<a class="reference external" href="https://earthref.org/MagIC">[MagIC Database]</a>
<a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#thellier_magic.py">[command line version]</a></p>
<p><strong>thellier_magic</strong> makes plots for Thellier-Thellier (Thellier E and Thellier O, 1959, Annales de Geophysique 15: 285–378) type experimental data.<br />
It reads in MagIC formatted data, sorts the data into datablocks for plotting as Arai (Nagata et al., 1963, doi: 10.1029/JZ068i018p05277) or  Zijderveld (Zijderveld, J. D. A. (1967). A.C. demagnetization of rocks: analysis of results. In D. Collinson, K. Creer, &amp; S. Runcorn (Eds.), Methods in Paleomagnetism (pp. 254–286). Amsterdam: Elsevier) as well as equal area projections and de (re) magnetization plots.</p>
<p>For full functionality, you should use the Thellier GUI program (in <strong>pmag_gui.py</strong> from the command line), but within a notebook you can take a quick look using <strong>ipmag.thellier_magic()</strong>.</p>
<p>Here we will look at some data from Shaar et al. (2011, doi: 10.1016/j.epsl.2010.11.013).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot the first five specimens</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">thellier_magic</span><span class="p">(</span><span class="n">input_dir_path</span><span class="o">=</span><span class="s1">&#39;data_files/thellier_magic/&#39;</span><span class="p">,</span> 
                     <span class="n">n_specs</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">save_plots</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;png&quot;</span><span class="p">)</span> <span class="c1"># s2s0-05 </span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>s2s0-01
s2s0-02
s2s0-03
s2s0-04
s2s0-05
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(True, [])
</pre></div>
</div>
<img alt="../_images/06e032ffb42a3dcfbc27696beb9a645435ee615454d0b23a9162c008dd21370a.png" src="../_images/06e032ffb42a3dcfbc27696beb9a645435ee615454d0b23a9162c008dd21370a.png" />
<img alt="../_images/db2f1cee609bcbd45c197baabe6ae8259dee8f31d881247c3bcb1fdd059ed18d.png" src="../_images/db2f1cee609bcbd45c197baabe6ae8259dee8f31d881247c3bcb1fdd059ed18d.png" />
<img alt="../_images/17e9af1881efd14bcea7a00adcd01145713b0d362ff506a5c90e80d7b3ef3e8a.png" src="../_images/17e9af1881efd14bcea7a00adcd01145713b0d362ff506a5c90e80d7b3ef3e8a.png" />
<img alt="../_images/ded4b6e8cd5cdec17a575bf11202d4ca48e9462e527cfb59714aab93867e399f.png" src="../_images/ded4b6e8cd5cdec17a575bf11202d4ca48e9462e527cfb59714aab93867e399f.png" />
<img alt="../_images/978370b22cc6ce6dec965354955c8d5d0ff4ae8c0dd55ee0aefcd8b552c84d54.png" src="../_images/978370b22cc6ce6dec965354955c8d5d0ff4ae8c0dd55ee0aefcd8b552c84d54.png" />
<img alt="../_images/e1da9ef89bac4351d6d727b85b2de8b1528ed45f7aedf5ac4d2ee2144730d889.png" src="../_images/e1da9ef89bac4351d6d727b85b2de8b1528ed45f7aedf5ac4d2ee2144730d889.png" />
<img alt="../_images/62ed4d690aefe66fc8850f56bfbe1621ac394d04fe754a4056de36099a3039ce.png" src="../_images/62ed4d690aefe66fc8850f56bfbe1621ac394d04fe754a4056de36099a3039ce.png" />
<img alt="../_images/ba3bd84fe3c4c35129058299842f42578353f9a3ec955204bf9a0890d60a86d4.png" src="../_images/ba3bd84fe3c4c35129058299842f42578353f9a3ec955204bf9a0890d60a86d4.png" />
<img alt="../_images/09766dee01181a6a3585dc9f2f05e1b3de579c3541dfd729138ff5d7c36d09aa.png" src="../_images/09766dee01181a6a3585dc9f2f05e1b3de579c3541dfd729138ff5d7c36d09aa.png" />
<img alt="../_images/9eb58364a26af2b7e45681d7f62fdf4427912f509e2efcec8df73456f80c6015.png" src="../_images/9eb58364a26af2b7e45681d7f62fdf4427912f509e2efcec8df73456f80c6015.png" />
<img alt="../_images/d9c6da914f23770511c8fbf3ecfd6124688271e2baaf7edf302eb26e559dafd4.png" src="../_images/d9c6da914f23770511c8fbf3ecfd6124688271e2baaf7edf302eb26e559dafd4.png" />
<img alt="../_images/19f449ac24723b58de0ec9c650cf3f6f3700155fda5a90f5db1d2f72beec19c8.png" src="../_images/19f449ac24723b58de0ec9c650cf3f6f3700155fda5a90f5db1d2f72beec19c8.png" />
<img alt="../_images/0629528d67646ddebdff5e7f71fd1f5e3df40a49a025e59896d31c0c850e8706.png" src="../_images/0629528d67646ddebdff5e7f71fd1f5e3df40a49a025e59896d31c0c850e8706.png" />
<img alt="../_images/0d09daf599d0af33b0904c0a1cba60f7484f50ff9d02c583e049429bc673129e.png" src="../_images/0d09daf599d0af33b0904c0a1cba60f7484f50ff9d02c583e049429bc673129e.png" />
<img alt="../_images/18e809c8a1bd45756657c27d0b42080dba1b3219566ac8e59e4e197c8b0ba24b.png" src="../_images/18e809c8a1bd45756657c27d0b42080dba1b3219566ac8e59e4e197c8b0ba24b.png" />
<img alt="../_images/685260b163b3a625d75a99bce9e1456f298d98039538f6a63f5ca3db52a40e1c.png" src="../_images/685260b163b3a625d75a99bce9e1456f298d98039538f6a63f5ca3db52a40e1c.png" />
<img alt="../_images/44b44c2f61792a78194da225fa01946d3ab1cc9d8cce638d5ca80150da367ab5.png" src="../_images/44b44c2f61792a78194da225fa01946d3ab1cc9d8cce638d5ca80150da367ab5.png" />
<img alt="../_images/b11e28d9730162aa175ac8d8ad6a8d9fda01b24fc6252c916fac5f09696498c8.png" src="../_images/b11e28d9730162aa175ac8d8ad6a8d9fda01b24fc6252c916fac5f09696498c8.png" />
<img alt="../_images/a9ccb524e995310bbadb742568c8ba915d1bca56aa592e490ffbaffd344f7457.png" src="../_images/a9ccb524e995310bbadb742568c8ba915d1bca56aa592e490ffbaffd344f7457.png" />
<img alt="../_images/43816c7cbcfff54bcc334fe3b084a3d4cd4f95949e92528976f80390a4a5259b.png" src="../_images/43816c7cbcfff54bcc334fe3b084a3d4cd4f95949e92528976f80390a4a5259b.png" />
</div>
</div>
</section>
<section id="vgpmap-magic">
<h3>vgpmap_magic<a class="headerlink" href="#vgpmap-magic" title="Permalink to this heading">#</a></h3>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch2.html">[Essentials Chapter 2]</a>
<a class="reference external" href="https://earthref.org/MagIC">[MagIC Database]</a>
<a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#vgpmap_magic.py">[command line version]</a></p>
<p>Plotting distributions of Virtual Geomagnetic Poles on many desired map projections is a frequent need in paleomagnetism.  <strong>vgpmap_magic</strong> reads in MagIC formatted files and has a number of plotting options.  It has been implemented into the <strong>ipmag</strong> module by Nick Swanson-Hysell as <strong>ipmag.plot_vgp()</strong>.<br />
We cam use  <strong>ipmag.plot_vgp()</strong> after reading in a MagIC formatted sites.txt file.</p>
<p>NB: you could also use <strong>pmagplotlib.plot_map()</strong> (see <span class="xref myst"><strong>plot_map_pts</strong></span>) if more options are desired.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">ipmag</span><span class="o">.</span><span class="n">plot_vgp</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function plot_vgp in module pmagpy.ipmag:

plot_vgp(map_axis, vgp_lon=None, vgp_lat=None, di_block=None, label=&#39;&#39;, color=&#39;k&#39;, marker=&#39;o&#39;, edge=&#39;black&#39;, markersize=20, legend=False)
    This function plots a paleomagnetic pole position on a cartopy map axis.
    
    Before this function is called, a plot needs to be initialized with code
    such as that in the make_orthographic_map function.
    
    Example
    -------
    &gt;&gt;&gt; vgps = ipmag.fishrot(dec=200,inc=30)
    &gt;&gt;&gt; vgp_lon_list,vgp_lat_list,intensities= ipmag.unpack_di_block(vgps)
    &gt;&gt;&gt; map_axis = ipmag.make_orthographic_map(central_longitude=200,central_latitude=30)
    &gt;&gt;&gt; ipmag.plot_vgp(map_axis,vgp_lon=vgp_lon_list,vgp_lat=vgp_lat_list,color=&#39;red&#39;,markersize=40)
    
    Required Parameters
    -----------
    map_axis : the name of the current map axis that has been developed using cartopy
    plon : the longitude of the paleomagnetic pole being plotted (in degrees E)
    plat : the latitude of the paleomagnetic pole being plotted (in degrees)
    
    Optional Parameters (defaults are used if not specified)
    -----------
    color : the color desired for the symbol (default is &#39;k&#39; aka black)
    marker : the marker shape desired for the pole mean symbol (default is &#39;o&#39; aka a circle)
    edge : the color of the edge of the marker (default is black)
    markersize : size of the marker in pt (default is 20)
    label : the default is no label. Labels can be assigned.
    legend : the default is no legend (False). Putting True will plot a legend.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data_files/vgpmap_magic/sites.txt&#39;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;age&#39;, &#39;age_sigma&#39;, &#39;age_unit&#39;, &#39;citations&#39;, &#39;conglomerate_test&#39;,
       &#39;contact_test&#39;, &#39;criteria&#39;, &#39;description&#39;, &#39;dir_alpha95&#39;, &#39;dir_dec&#39;,
       &#39;dir_inc&#39;, &#39;dir_k&#39;, &#39;dir_n_samples&#39;, &#39;dir_nrm_origin&#39;, &#39;dir_polarity&#39;,
       &#39;dir_r&#39;, &#39;dir_tilt_correction&#39;, &#39;int_abs&#39;, &#39;int_abs_sigma&#39;,
       &#39;int_n_samples&#39;, &#39;lat&#39;, &#39;location&#39;, &#39;lon&#39;, &#39;method_codes&#39;,
       &#39;result_type&#39;, &#39;site&#39;, &#39;specimens&#39;, &#39;vadm&#39;, &#39;vadm_sigma&#39;, &#39;vgp_dm&#39;,
       &#39;vgp_dp&#39;, &#39;vgp_lat&#39;, &#39;vgp_lon&#39;, &#39;vgp_n_samples&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">ipmag</span><span class="o">.</span><span class="n">make_orthographic_map</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function make_orthographic_map in module pmagpy.ipmag:

make_orthographic_map(central_longitude=0, central_latitude=0, figsize=(8, 8), add_land=True, land_color=&#39;tan&#39;, add_ocean=False, ocean_color=&#39;lightblue&#39;, grid_lines=True, lat_grid=[-80.0, -60.0, -30.0, 0.0, 30.0, 60.0, 80.0], lon_grid=[-180.0, -150.0, -120.0, -90.0, -60.0, -30.0, 0.0, 30.0, 60.0, 90.0, 120.0, 150.0, 180.0])
    Function creates and returns an orthographic map projection using cartopy
    
    Example
    -------
    &gt;&gt;&gt; map_axis = make_orthographic_map(central_longitude=200,central_latitude=30)
    
    Optional Parameters
    -----------
    central_longitude : central longitude of projection (default is 0)
    central_latitude : central latitude of projection (default is 0)
    figsize : size of the figure (default is 8x8)
    add_land : chose whether land is plotted on map (default is true)
    land_color : specify land color (default is &#39;tan&#39;)
    add_ocean : chose whether land is plotted on map (default is False, change to True to plot)
    ocean_color : specify ocean color (default is &#39;lightblue&#39;)
    grid_lines : chose whether gird lines are plotted on map (default is true)
    lat_grid : specify the latitude grid (default is 30 degree spacing)
    lon_grid : specify the longitude grid (default is 30 degree spacing)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lats</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;vgp_lat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">lons</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;vgp_lon&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="k">if</span> <span class="n">has_cartopy</span><span class="p">:</span>
    <span class="n">map_axis</span> <span class="o">=</span><span class="n">ipmag</span><span class="o">.</span><span class="n">make_orthographic_map</span><span class="p">(</span><span class="n">central_latitude</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span><span class="n">land_color</span><span class="o">=</span><span class="s1">&#39;bisque&#39;</span><span class="p">,</span>\
                                          <span class="n">add_ocean</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">ocean_color</span><span class="o">=</span><span class="s1">&#39;azure&#39;</span><span class="p">)</span>
    <span class="n">ipmag</span><span class="o">.</span><span class="n">plot_vgp</span><span class="p">(</span><span class="n">map_axis</span><span class="p">,</span> <span class="n">vgp_lon</span><span class="o">=</span><span class="n">lons</span><span class="p">,</span> <span class="n">vgp_lat</span><span class="o">=</span><span class="n">lats</span><span class="p">,</span>\
                   <span class="n">markersize</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>    
    
<span class="k">elif</span> <span class="n">has_basemap</span><span class="p">:</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">Basemap</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;ortho&#39;</span><span class="p">,</span><span class="n">lat_0</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span><span class="n">lon_0</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">m</span><span class="o">.</span><span class="n">drawcoastlines</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">fillcontinents</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;bisque&#39;</span><span class="p">,</span><span class="n">lake_color</span><span class="o">=</span><span class="s1">&#39;azure&#39;</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">drawmapboundary</span><span class="p">(</span><span class="n">fill_color</span><span class="o">=</span><span class="s1">&#39;azure&#39;</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">drawmeridians</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">360</span><span class="p">,</span><span class="mi">30</span><span class="p">))</span>
    <span class="n">m</span><span class="o">.</span><span class="n">drawparallels</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mi">30</span><span class="p">))</span>
    <span class="n">ipmag</span><span class="o">.</span><span class="n">plot_vgp_basemap</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">vgp_lon</span><span class="o">=</span><span class="n">lons</span><span class="p">,</span> <span class="n">vgp_lat</span><span class="o">=</span><span class="n">lats</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> \
                   <span class="n">markersize</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/8753e915d94715a7233f718f675a1473df160fb25a293371fa3233c1dd8fe089.png" src="../_images/8753e915d94715a7233f718f675a1473df160fb25a293371fa3233c1dd8fe089.png" />
</div>
</div>
<p>Or, you can run ipmag.vgpmap_magic:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">ipmag</span><span class="o">.</span><span class="n">vgpmap_magic</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function vgpmap_magic in module pmagpy.ipmag:

vgpmap_magic(dir_path=&#39;.&#39;, results_file=&#39;sites.txt&#39;, crd=&#39;&#39;, sym=&#39;ro&#39;, size=8, rsym=&#39;g^&#39;, rsize=8, fmt=&#39;pdf&#39;, res=&#39;c&#39;, proj=&#39;ortho&#39;, flip=False, anti=False, fancy=False, ell=False, ages=False, lat_0=0, lon_0=0, save_plots=True, interactive=False, contribution=None, image_records=False)
    makes a map of vgps and a95/dp,dm for site means in a sites table
    
    Parameters
    ----------
    dir_path : str, default &quot;.&quot;
        input directory path
    results_file : str, default &quot;sites.txt&quot;
        name of MagIC format sites file
    crd : str, default &quot;&quot;
       coordinate system [g, t] (geographic, tilt_corrected)
    sym : str, default &quot;ro&quot;
        symbol color and shape, default red circles
        (see matplotlib documentation for more color/shape options)
    size : int, default 8
        symbol size
    rsym : str, default &quot;g^&quot;
        symbol for plotting reverse poles
        (see matplotlib documentation for more color/shape options)
    rsize : int, default 8
        symbol size for reverse poles
    fmt : str, default &quot;pdf&quot;
        format for figures, [&quot;svg&quot;, &quot;jpg&quot;, &quot;pdf&quot;, &quot;png&quot;]
    res : str, default &quot;c&quot;
        resolution [c, l, i, h] (crude, low, intermediate, high)
    proj : str, default &quot;ortho&quot;
        ortho = orthographic
        lcc = lambert conformal
        moll = molweide
        merc = mercator
    flip : bool, default False
        if True, flip reverse poles to normal antipode
    anti : bool, default False
        if True, plot antipodes for each pole
    fancy : bool, default False
        if True, plot topography (not yet implemented)
    ell : bool, default False
        if True, plot ellipses
    ages : bool, default False
        if True, plot ages
    lat_0 : float, default 0.
        eyeball latitude
    lon_0 : float, default 0.
        eyeball longitude
    save_plots : bool, default True
        if True, create and save all requested plots
    interactive : bool, default False
       if True, interactively plot and display
        (this is best used on the command line only)
    image_records : bool, default False
        if True, return a list of created images
    
    Returns
    ---------
    if image_records == False:
        type - Tuple : (True or False indicating if conversion was sucessful, file name(s) written)
    if image_records == True:
       Tuple : (True or False indicating if conversion was sucessful, output file name written, list of image recs)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ipmag</span><span class="o">.</span><span class="n">vgpmap_magic</span><span class="p">(</span><span class="s1">&#39;data_files/vgpmap_magic&#39;</span><span class="p">,</span> <span class="n">lat_0</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">save_plots</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>gridlines only supported for PlateCarree, Lambert Conformal, and Mercator plots currently
</pre></div>
</div>
<img alt="../_images/18ccb8cc5be02378d16e528838784a93569b5dc3542a16a95e7236ba8438ef4c.png" src="../_images/18ccb8cc5be02378d16e528838784a93569b5dc3542a16a95e7236ba8438ef4c.png" />
</div>
</div>
</section>
<section id="watsons-v">
<h3>watsons_v<a class="headerlink" href="#watsons-v" title="Permalink to this heading">#</a></h3>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch11.html">[Essentials Chapter 11]</a>
<a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#watsons_v.py">[command line version]</a></p>
<p>Watson (1983, doi: 10.1016/0378-3758(83)90043-5) proposed a clever Monte Carlo type test for a common mean direction for two data sets.  This was implemented as
<strong>ipmag.common_mean_watson()</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">ipmag</span><span class="o">.</span><span class="n">common_mean_watson</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function common_mean_watson in module pmagpy.ipmag:

common_mean_watson(Data1, Data2, NumSims=5000, print_result=True, plot=&#39;no&#39;, save=False, save_folder=&#39;.&#39;, fmt=&#39;svg&#39;)
    Conduct a Watson V test for a common mean on two directional data sets.
    
    This function calculates Watson&#39;s V statistic from input files through
    Monte Carlo simulation in order to test whether two populations of
    directional data could have been drawn from a common mean. The critical
    angle between the two sample mean directions and the corresponding
    McFadden and McElhinny (1990) classification is printed.
    
    Parameters
    ----------
    Data1 : a nested list of directional data [dec,inc] (a di_block)
    Data2 : a nested list of directional data [dec,inc] (a di_block)
    NumSims : number of Monte Carlo simulations (default is 5000)
    print_result : default is to print the test result (True)
    plot : the default is no plot (&#39;no&#39;). Putting &#39;yes&#39; will the plot the CDF
        from the Monte Carlo simulations.
    save : optional save of plots (default is False)
    save_folder : path to where plots will be saved (default is current)
    fmt : format of figures to be saved (default is &#39;svg&#39;)
    
    Returns
    -------
    printed text : text describing the test result is printed
    result : a boolean where 0 is fail and 1 is pass
    angle : angle between the Fisher means of the two data sets
    critical_angle : critical angle for the test to pass
    
    Examples
    --------
    Develop two populations of directions using ``ipmag.fishrot``. Use the
    function to determine if they share a common mean.
    
    &gt;&gt;&gt; directions_A = ipmag.fishrot(k=20, n=30, dec=40, inc=60)
    &gt;&gt;&gt; directions_B = ipmag.fishrot(k=35, n=25, dec=42, inc=57)
    &gt;&gt;&gt; ipmag.common_mean_watson(directions_A, directions_B)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># use the same data as for watsons_f</span>
<span class="n">DI1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;data_files/watsons_f/watsons_f_example_file1.dat&#39;</span><span class="p">)</span>
<span class="n">DI2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;data_files/watsons_f/watsons_f_example_file2.dat&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">common_mean_watson</span><span class="p">(</span><span class="n">DI1</span><span class="p">,</span><span class="n">DI2</span><span class="p">,</span><span class="n">plot</span><span class="o">=</span><span class="s1">&#39;yes&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Results of Watson V test: 

Watson&#39;s V:           10.5
Critical value of V:  6.4
&quot;Fail&quot;: Since V is greater than Vcrit, the two means can
be distinguished at the 95% confidence level.

M&amp;M1990 classification:

Angle between data set means: 21.5
Critical angle for M&amp;M1990:   16.9
</pre></div>
</div>
<img alt="../_images/4f4897f383def95d8ed726c4dc3d3e7d508709f6a61ed3d1ce454cf4d6e98976.png" src="../_images/4f4897f383def95d8ed726c4dc3d3e7d508709f6a61ed3d1ce454cf4d6e98976.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 252x180 with 0 Axes&gt;
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0, 21.534333502358034, 16.88456182576388)
</pre></div>
</div>
</div>
</div>
</section>
<section id="zeq">
<h3>zeq<a class="headerlink" href="#zeq" title="Permalink to this heading">#</a></h3>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch9.html">[Essentials Chapter 9]</a>
<a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#zeq.py">[command line version]</a></p>
<p><strong>zeq</strong> is a quick and dirty plotter for Zijderveld (Zijderveld, J. D. A. (1967). A.C. demagnetization of rocks: analysis of results. In D. Collinson, K. Creer, &amp; S. Runcorn (Eds.), Methods in Paleomagnetism (pp. 254–286). Amsterdam: Elsevier) diagrams.  It calls <strong>pmagplotlib.plot_zed()</strong> to do the plotting.</p>
<p>This example plots the data in specimen coordinates = if other coordinate systems are desired, perform <span class="xref myst"><strong>di_geo</strong></span> and <span class="xref myst"><strong>di_tilt</strong></span> steps first.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pmagplotlib</span><span class="o">.</span><span class="n">plot_zed</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function plot_zed in module pmagpy.pmagplotlib:

plot_zed(ZED, datablock, angle, s, units)
    function to make equal area plot and zijderveld plot
    
    Parameters
    _________
    ZED : dictionary with keys for plots
        eqarea : figure number for equal area projection
        zijd   : figure number for  zijderveld plot
        demag :  figure number for magnetization against demag step
        datablock : nested list of [step, dec, inc, M (Am2), quality]
        step : units assumed in SI
        M    : units assumed Am2
        quality : [g,b], good or bad measurement; if bad will be marked as such
    angle : angle for X axis in horizontal plane, if 0, x will be 0 declination
    s : specimen name
    units :  SI units [&#39;K&#39;,&#39;T&#39;,&#39;U&#39;] for kelvin, tesla or undefined
    
    Effects
    _______
       calls plotting functions for equal area, zijderveld and demag figures
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># we can make the figure dictionary that pmagplotlib likes:</span>
<span class="n">ZED</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;eqarea&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;zijd&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;demag&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">}</span><span class="c1"># make datablock</span>
 <span class="c1"># read in data</span>
<span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data_files/zeq/zeq_example.dat&#39;</span><span class="p">,</span><span class="n">delim_whitespace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;specimen&#39;</span><span class="p">,</span><span class="s1">&#39;step&#39;</span><span class="p">,</span><span class="s1">&#39;m (emu)&#39;</span><span class="p">,</span><span class="s1">&#39;dec&#39;</span><span class="p">,</span><span class="s1">&#39;inc&#39;</span><span class="p">]</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;m SI&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;m (emu)&#39;</span><span class="p">]</span><span class="o">*</span><span class="mf">1e-3</span> <span class="c1"># convert to SI units from lab (emu) units</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;quality&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;g&#39;</span> <span class="c1"># add in default &quot;good&quot; quality designation</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;step SI&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;step&#39;</span><span class="p">]</span><span class="o">*</span><span class="mf">1e-3</span> <span class="c1"># convert to tesla </span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;blank&#39;</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;&quot;</span> <span class="c1"># this is a dummy variable expected by plotZED</span>
<span class="n">specimens</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">specimen</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="n">angle</span><span class="o">=</span><span class="mi">0</span>
<span class="n">units</span><span class="o">=</span><span class="s1">&#39;T&#39;</span> <span class="c1"># these are AF data</span>
<span class="n">cnt</span><span class="o">=</span><span class="mi">1</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">specimens</span><span class="p">:</span>
    <span class="c1"># we can make the figure dictionary that pmagplotlib likes:</span>
    <span class="n">ZED</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;eqarea&#39;</span><span class="p">:</span><span class="n">cnt</span><span class="p">,</span><span class="s1">&#39;zijd&#39;</span><span class="p">:</span><span class="n">cnt</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;demag&#39;</span><span class="p">:</span><span class="n">cnt</span><span class="o">+</span><span class="mi">2</span><span class="p">}</span><span class="c1"># make datablock</span>
    <span class="n">cnt</span><span class="o">+=</span><span class="mi">3</span>
    <span class="n">spec_df</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">specimen</span><span class="o">==</span><span class="n">s</span><span class="p">]</span>
    <span class="n">datablock</span><span class="o">=</span><span class="n">spec_df</span><span class="p">[[</span><span class="s1">&#39;step SI&#39;</span><span class="p">,</span><span class="s1">&#39;dec&#39;</span><span class="p">,</span><span class="s1">&#39;inc&#39;</span><span class="p">,</span><span class="s1">&#39;m SI&#39;</span><span class="p">,</span><span class="s1">&#39;blank&#39;</span><span class="p">,</span><span class="s1">&#39;quality&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="n">pmagplotlib</span><span class="o">.</span><span class="n">plot_zed</span><span class="p">(</span><span class="n">ZED</span><span class="p">,</span><span class="n">datablock</span><span class="p">,</span><span class="n">angle</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">units</span><span class="p">)</span>
    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/53497845246c2f5ac371cd025a8ce6c0d52a6ba0e50ecfb4034c156e57ba78c0.png" src="../_images/53497845246c2f5ac371cd025a8ce6c0d52a6ba0e50ecfb4034c156e57ba78c0.png" />
<img alt="../_images/b3b56e7aaecfc34b905064d8db9306e90adcf5fbe5fc47adb668524a46f33833.png" src="../_images/b3b56e7aaecfc34b905064d8db9306e90adcf5fbe5fc47adb668524a46f33833.png" />
<img alt="../_images/0d78ae2cf5c6cdeb8a56e8a2f5f69ba52a261195c0ca5c12399560487108e5be.png" src="../_images/0d78ae2cf5c6cdeb8a56e8a2f5f69ba52a261195c0ca5c12399560487108e5be.png" />
</div>
</div>
</section>
<section id="zeq-magic">
<h3>zeq_magic<a class="headerlink" href="#zeq-magic" title="Permalink to this heading">#</a></h3>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch9.html">[Essentials Chapter 9]</a>
<a class="reference external" href="https://earthref.org/MagIC">[MagIC Database]</a>
<a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#zeq_magic.py">[command line version]</a></p>
<p>This program is the same as <span class="xref myst"><strong>zeq</strong></span> but for MagIC formatted input files.  This example plots the data in specimen coordinates = if other coordinate systems are desired, perform <span class="xref myst"><strong>di_geo</strong></span> and <span class="xref myst"><strong>di_tilt</strong></span> steps first.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span> <span class="c1"># read in MagIC foramatted data</span>
<span class="n">dir_path</span><span class="o">=</span><span class="s1">&#39;data_files/zeq_magic/&#39;</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">zeq_magic</span><span class="p">(</span><span class="n">input_dir_path</span><span class="o">=</span><span class="n">dir_path</span><span class="p">,</span> <span class="n">save_plots</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(True, [])
</pre></div>
</div>
<img alt="../_images/56fe7100fc519f92fc5006b45a872467f9414f6e26caf24263984691b52f5a4e.png" src="../_images/56fe7100fc519f92fc5006b45a872467f9414f6e26caf24263984691b52f5a4e.png" />
<img alt="../_images/5bb21ede7184d17045f74bd2a18f6b5685d1948b94780a4c2e0b3096bc195b01.png" src="../_images/5bb21ede7184d17045f74bd2a18f6b5685d1948b94780a4c2e0b3096bc195b01.png" />
<img alt="../_images/78de480ad1d24ac35faa060d9bb40a9fb5d10429b5f6edd223c09d2d42ab7662.png" src="../_images/78de480ad1d24ac35faa060d9bb40a9fb5d10429b5f6edd223c09d2d42ab7662.png" />
<img alt="../_images/4dd7b8712686a79f7773985600c7322139f6b3972acca6ac93d17a09d73cd9c5.png" src="../_images/4dd7b8712686a79f7773985600c7322139f6b3972acca6ac93d17a09d73cd9c5.png" />
<img alt="../_images/c9c2ec921047f0edfcf695239663900dd39561fbeba204aa497d8fbe32dbfe5b.png" src="../_images/c9c2ec921047f0edfcf695239663900dd39561fbeba204aa497d8fbe32dbfe5b.png" />
<img alt="../_images/d1f8cfbd889deb45ece17220a61f8a8cb02b0cbde21170d723e3fce010dcad31.png" src="../_images/d1f8cfbd889deb45ece17220a61f8a8cb02b0cbde21170d723e3fce010dcad31.png" />
<img alt="../_images/dd68be0102e2ce70f624ea2284977e8393d2a82a1dc0f2d67b216478be6edc30.png" src="../_images/dd68be0102e2ce70f624ea2284977e8393d2a82a1dc0f2d67b216478be6edc30.png" />
<img alt="../_images/6eb4fd562be78135a8943e01013815a3844b3ee5089813ab8b21c19ea7d42210.png" src="../_images/6eb4fd562be78135a8943e01013815a3844b3ee5089813ab8b21c19ea7d42210.png" />
<img alt="../_images/ac1674158cde4ff88a86bef999449cfeab1e2ef07fc4360aa9fd0667f6a7510d.png" src="../_images/ac1674158cde4ff88a86bef999449cfeab1e2ef07fc4360aa9fd0667f6a7510d.png" />
<img alt="../_images/81aafabc9521cbc13912d400390d87a01e29dd6d3e41166cf8d13f8eb45d293a.png" src="../_images/81aafabc9521cbc13912d400390d87a01e29dd6d3e41166cf8d13f8eb45d293a.png" />
<img alt="../_images/6552e3e48ac0793876593f33c8de1b1a06ecb9fa9b58164277742030d3e67b0a.png" src="../_images/6552e3e48ac0793876593f33c8de1b1a06ecb9fa9b58164277742030d3e67b0a.png" />
<img alt="../_images/c7342388c1cefbebea16a8c48c3c0e7be033e624d6cce6d2847dd5e755821526.png" src="../_images/c7342388c1cefbebea16a8c48c3c0e7be033e624d6cce6d2847dd5e755821526.png" />
<img alt="../_images/67e0fcb2462e55dcb616cecca5117bb72aac8cadb95e46676dc820dff440efbf.png" src="../_images/67e0fcb2462e55dcb616cecca5117bb72aac8cadb95e46676dc820dff440efbf.png" />
<img alt="../_images/08fc965f26d6f54e3005f2799176dcec0dd73f00c14034900d2eda7eea1f22ef.png" src="../_images/08fc965f26d6f54e3005f2799176dcec0dd73f00c14034900d2eda7eea1f22ef.png" />
<img alt="../_images/3b9441f17d2a5a7f654d3029729a97fe3104dbbb72049e05e0019af8f9a8bd18.png" src="../_images/3b9441f17d2a5a7f654d3029729a97fe3104dbbb72049e05e0019af8f9a8bd18.png" />
</div>
</div>
</section>
</section>
<section id="clean-up">
<h2>Clean up<a class="headerlink" href="#clean-up" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="c1"># remove some individual files</span>

<span class="n">filenames</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;chart.txt&#39;</span><span class="p">,</span>
            <span class="s1">&#39;data_files/azdip_magic/samples.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;data_files/download_magic/criteria.txt&#39;</span><span class="p">,</span> 
            <span class="s1">&#39;data_files/orientation_magic/samples.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;data_files/orientation_magic/sites.txt&#39;</span><span class="p">,</span>
            <span class="s1">&#39;data_files/download_magic/ages.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;data_files/download_magic/contribution.txt&#39;</span><span class="p">,</span> 
            <span class="s1">&#39;data_files/download_magic/measurements.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;data_files/download_magic/samples.txt&#39;</span><span class="p">,</span>
            <span class="s1">&#39;data_files/download_magic/specimens.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;data_files/download_magic/locations.txt&#39;</span><span class="p">]</span>


<span class="k">for</span> <span class="n">fname</span> <span class="ow">in</span> <span class="n">filenames</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
        <span class="k">pass</span>
  

<span class="c1"># remove all MagIC-generated files from a given directory</span>

<span class="k">def</span> <span class="nf">remove_magic_files</span><span class="p">(</span><span class="n">directory</span><span class="p">):</span>
    <span class="n">magic_files</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;specimens.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;samples.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;sites.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;locations.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;measurements.txt&#39;</span><span class="p">,</span> 
                   <span class="s1">&#39;contribution.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;ages.txt&#39;</span><span class="p">]</span>
    <span class="n">dir_files</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">dtype</span> <span class="ow">in</span> <span class="n">magic_files</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">for</span> <span class="n">fname</span> <span class="ow">in</span> <span class="n">dir_files</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">fname</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">dtype</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">directory</span><span class="p">,</span> <span class="n">fname</span><span class="p">))</span>
                <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
                    <span class="k">pass</span>
    <span class="k">for</span> <span class="n">full_fname</span> <span class="ow">in</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">directory</span><span class="p">,</span> <span class="s1">&#39;*.magic&#39;</span><span class="p">)):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">full_fname</span><span class="p">)</span>
        
        
        
<span class="c1"># not convert_2_magic/jr6_magic</span>

<span class="k">for</span> <span class="n">directory</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;data_files/convert_2_magic/2g_bin_magic/mn1&#39;</span><span class="p">,</span> <span class="s1">&#39;data_files/convert_2_magic/pmd_magic/PMD/&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;data_files&#39;</span><span class="p">,</span> <span class="s1">&#39;data_files/k15_s&#39;</span><span class="p">,</span> <span class="s1">&#39;data_files/convert_2_magic/agm_magic&#39;</span><span class="p">,</span> 
                  <span class="s1">&#39;data_files/convert_2_magic/huji_magic&#39;</span><span class="p">,</span> <span class="s1">&#39;data_files/convert_2_magic/bgc_magic&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;data_files/convert_2_magic/kly4s_magic&#39;</span><span class="p">,</span> <span class="s1">&#39;data_files/convert_2_magic/mst_magic&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;data_files/convert_ages&#39;</span><span class="p">,</span> <span class="s1">&#39;data_files/convert_2_magic/cit_magic/MIT/7325B&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;data_files/convert_2_magic/cit_magic/USGS/bl9-1&#39;</span><span class="p">,</span> <span class="s1">&#39;data_files/convert_2_magic/tdt_magic&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;data_files/convert_2_magic/ldeo_magic&#39;</span><span class="p">,</span> <span class="s1">&#39;data_files/convert_2_magic/k15_magic&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;data_files/convert_2_magic/generic_magic&#39;</span><span class="p">]:</span>
    <span class="n">remove_magic_files</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>


<span class="n">lst</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;*.png&#39;</span><span class="p">,</span> <span class="s1">&#39;./data_files/convert_2_magic/jr6_magic/SML*.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;./data_files/download_magic/Snake*&#39;</span><span class="p">,</span>
      <span class="s1">&#39;./data_files/convert_2_magic/jr6_magic/AP12_*.txt&#39;</span><span class="p">,</span> 
      <span class="s1">&#39;./data_files/convert_2_magic/jr6_magic/*_measurements.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;./data_files/convert_2_magic/jr6_magic/*.magic&#39;</span><span class="p">,</span>
      <span class="s1">&#39;./data_files/3_0/McMurdo/*.tex&#39;</span><span class="p">,</span> <span class="s1">&#39;./data_files/3_0/McMurdo/*.xls&#39;</span><span class="p">,</span> <span class="s1">&#39;./data_files/3_0/Megiddo/*.tex&#39;</span><span class="p">,</span>
      <span class="s1">&#39;data_files/3_0/Megiddo/*.xls&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">directory</span> <span class="ow">in</span> <span class="n">lst</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">fname</span> <span class="ow">in</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">directory</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>  
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./documentation_notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="PmagPy_calculations.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Calculations with PmagPy</p>
      </div>
    </a>
    <a class="right-next"
       href="PmagPy_MagIC.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Working with the MagIC database using PmagPy</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#guide-to-pmagpy">Guide to PmagPy</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#customizing-this-notebook">Customizing this notebook</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#get-started">Get started</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#functions-demonstrated-within-pmagpy-plots-analysis-ipynb">Functions demonstrated within <span class="xref myst">PmagPy_plots_analysis.ipynb</span>:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#figures">Figures</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ani-depthplot">ani_depthplot</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#aniso-magic">aniso_magic</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#biplot-magic">biplot_magic</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#chi-magic">chi_magic</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#common-mean">common_mean</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cont-rot">cont_rot</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#core-depthplot">core_depthplot</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#curie">curie</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dayplot-magic">dayplot_magic</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dmag-magic">dmag_magic</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dmag-magic-with-a-downloaded-file">dmag_magic with a downloaded file</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dms2dd">dms2dd</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#eqarea">eqarea</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#eqarea-ell">eqarea_ell</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bingham-ellipses">Bingham ellipses</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fisher-mean-a95">Fisher mean, a95</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#kent-mean-and-ellipse">Kent mean and ellipse</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bootstrap-eigenvectors">Bootstrap eigenvectors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bootstrapped-ellipses">Bootstrapped ellipses</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#eqarea-magic">eqarea_magic</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#whole-study">whole study</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#whole-study-with-color-contour-option">whole study with color contour option</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#specimens-by-site">specimens by site</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#measurements-by-specimen">measurements by specimen</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#individual-specimens">Individual specimens</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#find-ei">find_ei</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fishqq">fishqq</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#foldtest">foldtest</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#foldtest-magic">foldtest_magic</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#forc-diagram">forc_diagram</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#histplot">histplot</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hysteresis-magic">hysteresis_magic</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#irm-unmix">irm_unmix</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#irmaq-magic">irmaq_magic</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lnp-magic">lnp_magic</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lowes">lowes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lowrie">lowrie</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-cdf">plot_cdf</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-geomagia">plot_geomagia</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-mag-map">plot_mag_map</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-map-pts">plot_map_pts</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-di-mean">plot_di_mean</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#polemap-magic">polemap_magic</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-poles-with-a-95-ellipse">Plotting poles with A_{95} ellipse</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-ts">plot_ts</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#qqplot">qqplot</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#qqunf">qqunf</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#quick-hyst">quick_hyst</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#revtest">revtest</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#revtest-magic">revtest_magic</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#revtest-mm1990">revtest_mm1990</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#thellier-magic">thellier_magic</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#vgpmap-magic">vgpmap_magic</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#watsons-v">watsons_v</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#zeq">zeq</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#zeq-magic">zeq_magic</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#clean-up">Clean up</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By PmagPy Contributors
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=927b94d3fcb96560df09"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=927b94d3fcb96560df09"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>