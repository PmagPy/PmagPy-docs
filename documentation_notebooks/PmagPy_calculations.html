
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Calculations with PmagPy &#8212; PmagPy Notebooks</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Visualizations and more analysis with PmagPy" href="PmagPy_plots_analysis.html" />
    <link rel="prev" title="Introduction to PmagPy" href="PmagPy_introduction.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/pmagpy_logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">PmagPy Notebooks</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    PmagPy: An open source package for paleomagnetic data analysis
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Installation
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../installation/osx_pip.html">
   OSX pip install
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Documentation notebooks
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="PmagPy_introduction.html">
   Introduction to PmagPy
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Calculations with PmagPy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="PmagPy_plots_analysis.html">
   Visualizations and more analysis with PmagPy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="PmagPy_MagIC.html">
   Working with the MagIC database using PmagPy
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/pmagpy/pmagpy-docs/master?urlpath=tree/documentation_notebooks/PmagPy_calculations.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/pmagpy/pmagpy-docs"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/pmagpy/pmagpy-docs/issues/new?title=Issue%20on%20page%20%2Fdocumentation_notebooks/PmagPy_calculations.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/documentation_notebooks/PmagPy_calculations.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#guide-to-pmagpy">
   Guide to PmagPy
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#customizing-this-notebook">
   Customizing this notebook
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#get-started">
   Get started
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#functions-demonstrated-within-this-notebook">
   Functions demonstrated within this notebook:
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#aarm-magic">
   aarm_magic
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#atrm-magic">
   atrm_magic
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#angle">
   angle
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#apwp">
   apwp
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#b-vdm">
   b_vdm
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bootams">
   bootams
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cart-dir">
   cart_dir
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#di-eq">
   di_eq
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#di-geo">
   di_geo
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#di-rot">
   di_rot
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#di-tilt">
   di_tilt
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#di-vgp">
   di_vgp
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dipole-pinc">
   dipole_pinc
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dipole-plat">
   dipole_plat
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dir-cart">
   dir_cart
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#eigs-s">
   eigs_s
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#eq-di">
   eq_di
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fcalc">
   fcalc
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fisher">
   fisher
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fishrot">
   fishrot
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#flip">
   flip
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#gaussian">
   gaussian
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#gobing">
   gobing
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#gofish">
   gofish
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fisher-mean-on-pandas-dataframes">
     fisher mean on pandas DataFrames
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#gokent">
   gokent
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#goprinc">
   goprinc
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#igrf">
   igrf
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#incfish">
   incfish
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pca">
   pca
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pt-rot">
   pt_rot
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#s-eigs">
   s_eigs
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#s-geo">
   s_geo
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#s-hext">
   s_hext
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#s-magic">
   s_magic
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#s-tilt">
   s_tilt
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#scalc">
   scalc
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#scalc-magic">
   scalc_magic
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#separate-directions">
   separate_directions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#squish">
   squish
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#stats">
   stats
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#strip-magic">
   strip_magic
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sundec">
   sundec
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tk03">
   tk03
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#uniform">
   uniform
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#unsquish">
   unsquish
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#vdm-b">
   vdm_b
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#vector-mean">
   vector_mean
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#vgp-di">
   vgp_di
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#watsons-f">
   watsons_f
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Calculations with PmagPy</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#guide-to-pmagpy">
   Guide to PmagPy
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#customizing-this-notebook">
   Customizing this notebook
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#get-started">
   Get started
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#functions-demonstrated-within-this-notebook">
   Functions demonstrated within this notebook:
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#aarm-magic">
   aarm_magic
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#atrm-magic">
   atrm_magic
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#angle">
   angle
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#apwp">
   apwp
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#b-vdm">
   b_vdm
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bootams">
   bootams
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cart-dir">
   cart_dir
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#di-eq">
   di_eq
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#di-geo">
   di_geo
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#di-rot">
   di_rot
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#di-tilt">
   di_tilt
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#di-vgp">
   di_vgp
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dipole-pinc">
   dipole_pinc
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dipole-plat">
   dipole_plat
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dir-cart">
   dir_cart
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#eigs-s">
   eigs_s
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#eq-di">
   eq_di
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fcalc">
   fcalc
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fisher">
   fisher
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fishrot">
   fishrot
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#flip">
   flip
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#gaussian">
   gaussian
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#gobing">
   gobing
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#gofish">
   gofish
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fisher-mean-on-pandas-dataframes">
     fisher mean on pandas DataFrames
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#gokent">
   gokent
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#goprinc">
   goprinc
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#igrf">
   igrf
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#incfish">
   incfish
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pca">
   pca
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pt-rot">
   pt_rot
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#s-eigs">
   s_eigs
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#s-geo">
   s_geo
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#s-hext">
   s_hext
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#s-magic">
   s_magic
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#s-tilt">
   s_tilt
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#scalc">
   scalc
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#scalc-magic">
   scalc_magic
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#separate-directions">
   separate_directions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#squish">
   squish
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#stats">
   stats
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#strip-magic">
   strip_magic
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sundec">
   sundec
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tk03">
   tk03
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#uniform">
   uniform
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#unsquish">
   unsquish
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#vdm-b">
   vdm_b
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#vector-mean">
   vector_mean
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#vgp-di">
   vgp_di
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#watsons-f">
   watsons_f
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="calculations-with-pmagpy">
<h1>Calculations with PmagPy<a class="headerlink" href="#calculations-with-pmagpy" title="Permalink to this headline">#</a></h1>
<p>This notebook demonstrates many of the PmagPy calculation functions such as those that rotate directions, return statistical parameters, and simulate data from specified distributions.</p>
<section id="guide-to-pmagpy">
<h2>Guide to PmagPy<a class="headerlink" href="#guide-to-pmagpy" title="Permalink to this headline">#</a></h2>
<p>The notebook is one of a series of notebooks that demonstrate the functionality of PmagPy. The other notebooks are:</p>
<ul class="simple">
<li><p><a class="reference internal" href="PmagPy_introduction.html"><span class="doc std std-doc">PmagPy_introduction.ipynb</span></a> This notebook introduces PmagPy and lists the functions that are demonstrated in the other notebooks.</p></li>
<li><p><a class="reference internal" href="PmagPy_plots_analysis.html"><span class="doc std std-doc">PmagPy_plots_analysis.ipynb</span></a> This notebook demonstrates PmagPy functions that can be used to visualize data as well as those that conduct statistical tests that have associated visualizations.</p></li>
<li><p><a class="reference internal" href="PmagPy_MagIC.html"><span class="doc std std-doc">PmagPy_MagIC.ipynb</span></a> This notebook demonstrates how PmagPy can be used to read and write data to and from the MagIC database format including conversion from many individual lab measurement file formats.</p></li>
</ul>
</section>
<section id="customizing-this-notebook">
<h2>Customizing this notebook<a class="headerlink" href="#customizing-this-notebook" title="Permalink to this headline">#</a></h2>
<p>If you want to make changes to this notebook, you should make a copy (see File menu).  Otherwise each time you update <strong>PmagPy</strong>, your changes will be overwritten.</p>
</section>
<section id="get-started">
<h2>Get started<a class="headerlink" href="#get-started" title="Permalink to this headline">#</a></h2>
<p>To use the functions in this notebook, we have to   import the <strong>PmagPy</strong> modules <strong>pmagplotlib</strong>, <strong>pmag</strong> and <strong>ipmag</strong> and some other handy functions for use in the notebook.  This is done in the following code block which must be executed before running any other code block. To execute, click on the code block and then click on the “Run” button in the menu.</p>
<p>In order to access the example data, this notebook is meant to be run in the PmagPy-data directory (PmagPy directory for developers).</p>
<p>Try it!  Run the code block below (click on the cell and then click ‘Run’):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pmagpy.pmag</span> <span class="k">as</span> <span class="nn">pmag</span>
<span class="kn">import</span> <span class="nn">pmagpy.pmagplotlib</span> <span class="k">as</span> <span class="nn">pmagplotlib</span>
<span class="kn">import</span> <span class="nn">pmagpy.ipmag</span> <span class="k">as</span> <span class="nn">ipmag</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span> <span class="c1"># our plotting buddy</span>
<span class="kn">from</span> <span class="nn">pmagpy</span> <span class="kn">import</span> <span class="n">convert_2_magic</span> <span class="k">as</span> <span class="n">convert</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span> <span class="c1"># the fabulous NumPy package</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span> <span class="c1"># and of course Pandas</span>
<span class="n">has_basemap</span><span class="p">,</span> <span class="n">Basemap</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">import_basemap</span><span class="p">()</span>
<span class="n">has_cartopy</span><span class="p">,</span> <span class="n">Cartopy</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">import_cartopy</span><span class="p">()</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="o">%</span><span class="k">matplotlib</span> inline 
</pre></div>
</div>
</div>
</div>
</section>
<section id="functions-demonstrated-within-this-notebook">
<h2>Functions demonstrated within this notebook:<a class="headerlink" href="#functions-demonstrated-within-this-notebook" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p>Functions in <strong>PmagPy_calculations.ipynb</strong>:</p>
<ul>
<li><p><a class="reference external" href="#aarm_magic">aarm_magic</a> : calculate AARM tensors</p></li>
<li><p><a class="reference external" href="#aarm_magic">atrm_magic</a> : calculate ATRM tensors</p></li>
<li><p><a class="reference external" href="#angle">angle</a> : calculates the angle between two vectors</p></li>
<li><p><a class="reference external" href="#apwp">apwp</a> : returns predicted paleolatitudes, directions and pole latitude/longitude from apparent polar wander paths of Besse and Courtillot (2002).</p></li>
<li><p><a class="reference external" href="#b_vdm">b_vdm</a> : converts B (in microT) and (magnetic) latitude to V(A)DM (see <a class="reference external" href="#vdm_b">vdm_b</a>)</p></li>
<li><p><a class="reference external" href="#bootams">bootams</a> : calculates bootstrap statistics for tensor data</p></li>
<li><p><a class="reference external" href="#cart_dir">cart_dir</a> : converts cartesian coordinates (x,y,z) to declination, inclination, intensity (see <a class="reference external" href="#dir_cart">dir_cart</a>)</p></li>
<li><p><a class="reference external" href="#di_eq">di_eq</a> : maps declination, inclinatitions to X,Y for plotting in equal area projections</p></li>
<li><p><a class="reference external" href="#di_geo">di_geo</a> : rotates declination, inclination in specimen coordinates to geographic coordinates</p></li>
<li><p><a class="reference external" href="#di_rot">di_rot</a> : rotates directions to a  coordinate system with D,I as center</p></li>
<li><p><a class="reference external" href="#di_tilt">di_tilt</a> : rotates directions to stratigraphic coordinates</p></li>
<li><p><a class="reference external" href="#di_vgp">di_vgp</a> : converts direction to Virtual Geomagnetic Pole (see <a class="reference external" href="#vgp_di">vgp_di</a>)</p></li>
<li><p><a class="reference external" href="#dia_vgp">dia_vgp</a> : converts direction and <span class="math notranslate nohighlight">\(\alpha_{95}\)</span> to Virtual Geomagnetic Pole and dp,dm</p></li>
<li><p><a class="reference external" href="#dipole_pinc">dipole_pinc</a> : calculates inclination given latitude assuming geocentric axial dipole</p></li>
<li><p><a class="reference external" href="#dipole_plat">dipole_plat</a> : calculates latitude given inclination assuming geocentric axial dipole</p></li>
<li><p><a class="reference external" href="#dir_cart">dir_cart</a> : converts declination, inclination, intensity to cartesian coordinates (see <a class="reference external" href="#cart_dir">cart_dir</a>)</p></li>
<li><p><a class="reference external" href="#eigs_s">eigs_s</a> : converts eigenparameters to equivalent 6 element tensor (see <a class="reference external" href="#s_eigs">s_eigs</a>)</p></li>
<li><p><a class="reference external" href="#eq_di">eq_di</a> : takes X,Y from equal area projection (e.g., from digitized coordinates) and  converts to declination, inclination</p></li>
<li><p><a class="reference external" href="#fcalc">fcalc</a> : returns the value from an F table, given the degrees of freedom.</p></li>
<li><p><a class="reference external" href="#fisher">fisher</a> : generates sets of directions drawn from Fisher distributions with vertical true mean</p></li>
<li><p><a class="reference external" href="#fishrot">fishrot</a> : generates sets of directions drawn from Fisher distributions with arbitrary true mean</p></li>
<li><p><a class="reference external" href="#flip">flip</a> : flips a second mode (reverse directions) to their antipodes</p></li>
<li><p><a class="reference external" href="#gaussian">gaussian</a> : generates data drawn from a normal distribution</p></li>
<li><p><a class="reference external" href="#gobing">gobing</a> : calculates Bingham statistics from a set of directions</p></li>
<li><p><a class="reference external" href="#gofish">gofish</a> : calculates Fisher statistics from a set of directions</p></li>
<li><p><a class="reference external" href="#gokent">gokent</a> : calculates Kent statistics from a set of directions</p></li>
<li><p><a class="reference external" href="#goprinc">goprinc</a> : calculates principal directions statistics</p></li>
<li><p><a class="reference external" href="#igrf">igrf</a> : calculates geomagnetic field vectors for location, age given a field model (e.g., IGRF) including paleofield models (e.g., cals10k)</p></li>
<li><p><a class="reference external" href="#incfish">incfish</a> : estimates the true mean inclination from inclination only data</p></li>
<li><p><a class="reference external" href="#pca">pca</a> : calculates the best-fit line or plane for demagnetization data and associated statistics</p></li>
<li><p><a class="reference external" href="#pt_rot">pt_rot</a> : rotates point given finite rotation pole</p></li>
<li><p><a class="reference external" href="#s_eigs">s_eigs</a> : takes a 6 element tensor and calculates eigen parameters (see <a class="reference external" href="#eigs_s">eigs_s</a>)</p></li>
<li><p><a class="reference external" href="#s_geo">s_geo</a> : rotates 6 element tensors to geographic coordinates</p></li>
<li><p><a class="reference external" href="#s_hext">s_hext</a> : calculates Hext statistics from 6 element tensors</p></li>
<li><p><a class="reference external" href="#s_tilt">s_tilt</a> : rotates 6 element tensors to stratigraphic coordinates</p></li>
<li><p><a class="reference external" href="#s_tilt">s_magic</a> :</p></li>
<li><p><a class="reference external" href="#scalc">scalc</a> : calculates  VGP scatter</p></li>
<li><p><a class="reference external" href="#scalc">scalc_magic</a> : calculates  VGP scatter</p></li>
<li><p><a class="reference external" href="#separate_directions">separate_directions</a> : separates a set of directions into two modes (normal and reverse)</p></li>
<li><p><a class="reference external" href="#squish">squish</a>: flattens inclination data given flattening factor (see <a class="reference external" href="#unsquish">unsquish</a>)</p></li>
<li><p><a class="reference external" href="#sundec">sundec</a> : calulates direction to sun for location, date, time and sun azimuth</p></li>
<li><p><a class="reference external" href="#tk03">tk03</a> : generates sets of directions consistent with the TK03 field model</p></li>
<li><p><a class="reference external" href="#uniform">uniform</a> : generates sets of uniformly distributed directions</p></li>
<li><p><a class="reference external" href="#unsquish">unsquish</a> : unsquishes flattened inclinations, given flattening factor (see <a class="reference external" href="#squish">squish</a>)</p></li>
<li><p><a class="reference external" href="#vdm_b">vdm_b</a> : calculates intensity at given location from specified virtual dipole moment (see <a class="reference external" href="#b_vdm">b_vdm</a>)</p></li>
<li><p><a class="reference external" href="#vector_mean">vector_mean</a> : calculates vector mean for sets of vectors (declination, inclination, intensity)</p></li>
<li><p><a class="reference external" href="#vgp_di">vgp_di</a> : calculates direction at given location from virtual geomagnetic pole (see <a class="reference external" href="#di_vgp">di_vgp</a>)</p></li>
<li><p><a class="reference external" href="#watsons_f">watsons_f</a> : calculates Watson’s F statistic for testing for common mean</p></li>
</ul>
</li>
</ul>
</section>
<section id="aarm-magic">
<h2>aarm_magic<a class="headerlink" href="#aarm-magic" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#aarm_magic.py">[command line version]</a></p>
<p>Anisotropy of anhysteretic or other remanence can be converted to a tensor and used to correct natural remanence data for the effects of anisotropy remanence acquisition. For example, directions may be deflected from the geomagnetic field direction or intensities may be biased by strong anisotropies in the magnetic fabric of the specimen. By imparting an anhysteretic or thermal remanence in many specific orientations, the anisotropy of remanence acquisition can be characterized and used for correction. We do this for anisotropy of anhysteretic remanence (AARM) by imparting an ARM in 9, 12 or 15 positions. Each ARM must be preceded by an AF demagnetization step. The 15 positions are shown in the <a class="reference external" href="#k15_magic">k15_magic</a> example.</p>
<p>For the 9 position scheme, <strong>aarm_magic</strong> assumes that the AARMs are imparted in positions 1,2,3, 6,7,8, 11,12,13. Someone (a.k.a. Josh Feinberg) has kindly made the measurements and saved them an SIO formatted measurement file named aarm_magic_example.dat in the datafile directory called aarm_magic. Note the special format of these files - the treatment column (column #2) has the position number (1,2,3,6, etc.) followed by either a “00” for the obligatory zero field baseline step or a “10” for the in-field step. These could also be ‘0‘ and ‘1’.</p>
<p>We need to first import these into the measurements format and then calculate the anisotropy tensors. These can then be plotted or used to correct paleointensity or directional data for anisotropy of remanence.</p>
<p>So, first follow the instructions in  <a class="reference external" href="#sio_magic">sio_magic</a> to import the AARM data into the MagIC format. The DC field was 50 μT, the peak AC field was 180 mT, the location was “Bushveld” and the lab protocol was AF and Anisotropy. The naming convention used Option # 3 (see help menu).</p>
<p>Then we need  to calculate the best-fit tensor and write them out to the specimens.txt MagIC tables which can be used to correct remanence data for anisotropy.</p>
<p>The <strong>aarm_magic</strong> program takes a measurements.txt formatted file with anisotropy of ARM data in it and calculates the tensors, rotates it into the desired coordinate system and stores the data in a specimens.txt format file.  To do this in a notebook, use <strong>ipmag.aarm_magic()</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">convert</span><span class="o">.</span><span class="n">sio</span><span class="p">(</span><span class="s1">&#39;arm_magic_example.dat&#39;</span><span class="p">,</span><span class="n">dir_path</span><span class="o">=</span><span class="s1">&#39;data_files/aarm_magic/&#39;</span><span class="p">,</span><span class="n">specnum</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
           <span class="n">location</span><span class="o">=</span><span class="s1">&#39;Bushveld&#39;</span><span class="p">,</span><span class="n">codelist</span><span class="o">=</span><span class="s1">&#39;AF:ANI&#39;</span><span class="p">,</span><span class="n">samp_con</span><span class="o">=</span><span class="s1">&#39;3&#39;</span><span class="p">,</span>
           <span class="n">meas_file</span><span class="o">=</span><span class="s1">&#39;aarm_measurements.txt&#39;</span><span class="p">,</span><span class="n">peakfield</span><span class="o">=</span><span class="mi">180</span><span class="p">,</span><span class="n">labfield</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">phi</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">theta</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-W- You are trying to open a file: /Users/unimos/0000_Github/PmagPy-docs/documentation_notebooks/data_files/aarm_magic/arm_magic_example.dat that does not exist
you must provide a valid mag_file
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(False, &#39;you must provide a valid mag_file&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">ipmag</span><span class="o">.</span><span class="n">aarm_magic</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function aarm_magic in module pmagpy.ipmag:

aarm_magic(meas_file, dir_path=&#39;.&#39;, input_dir_path=&#39;&#39;, input_spec_file=&#39;specimens.txt&#39;, output_spec_file=&#39;specimens.txt&#39;)
    Converts AARM  data to best-fit tensor (6 elements plus sigma)
    
    Parameters
    ----------
    meas_file : str
        input measurement file
    dir_path : str
        output directory, default &quot;.&quot;
    input_dir_path : str
        input file directory IF different from dir_path, default &quot;&quot;
    input_spec_file : str
        input specimen file name, default &quot;specimens.txt&quot;
    output_spec_file : str
        output specimen file name, default &quot;specimens.txt&quot;
    
    
    Returns
    ---------
    Tuple : (True or False indicating if conversion was successful, output file name written)
    
    Info
    ---------
        Input for is a series of baseline, ARM pairs.
      The baseline should be the AF demagnetized state (3 axis demag is
      preferable) for the following ARM acquisition. The order of the
      measurements is:
           for 6 positions (AF demag before each step):
               1) labfield parallel to X
               2) labfield parallel to Y
               3) labfield parallel to Z
               4) labfield anti-parallel to X
               5) labfield anti-parallel to Y
               6) labfield anti-parallel to Z
            for 9 positions (AF demag before each step):
                positions 1,2,3, 6,7,8, 11,12,13 (from Figure D.2 in Essentials, earthref.org/MagIC/books/Tauxe/Essentials, Appendix D)
            for 15  positions (AF demag before each step):
                positions 1-15 (for 15 positions)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ipmag</span><span class="o">.</span><span class="n">aarm_magic</span><span class="p">(</span><span class="s1">&#39;aarm_measurements.txt&#39;</span><span class="p">,</span><span class="n">dir_path</span><span class="o">=</span><span class="s1">&#39;data_files/aarm_magic/&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-E- /Users/unimos/0000_Github/PmagPy-docs/documentation_notebooks/data_files/aarm_magic/aarm_measurements.txt is not a valid measurements file, empty_file
for data model 2.0 please use atrm_magic_dm2
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot the data generated by aarm_magic:</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">aniso_magic_nb</span><span class="p">(</span><span class="n">infile</span><span class="o">=</span><span class="s1">&#39;data_files/aarm_magic/specimens.txt&#39;</span><span class="p">,</span> <span class="n">save_plots</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-I- Using online data model
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-I- Getting method codes from earthref.org
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-I- Importing controlled vocabularies from https://earthref.org
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyError</span><span class="g g-Whitespace">                                  </span>Traceback (most recent call last)
<span class="nn">Input In [5],</span> in <span class="ni">&lt;cell line: 2&gt;</span><span class="nt">()</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1"># plot the data generated by aarm_magic:</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">ipmag</span><span class="o">.</span><span class="n">aniso_magic_nb</span><span class="p">(</span><span class="n">infile</span><span class="o">=</span><span class="s1">&#39;data_files/aarm_magic/specimens.txt&#39;</span><span class="p">,</span> <span class="n">save_plots</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="nn">File ~/0000_Github/PmagPy/pmagpy/ipmag.py:10391,</span> in <span class="ni">aniso_magic_nb</span><span class="nt">(infile, samp_file, site_file, verbose, ipar, ihext, ivec, isite, iloc, iboot, vec, Dir, PDir, crd, num_bootstraps, dir_path, fignum, save_plots, interactive, fmt, contribution)</span>
<span class="g g-Whitespace">  </span><span class="mi">10384</span> <span class="k">def</span> <span class="nf">aniso_magic_nb</span><span class="p">(</span><span class="n">infile</span><span class="o">=</span><span class="s1">&#39;specimens.txt&#39;</span><span class="p">,</span> <span class="n">samp_file</span><span class="o">=</span><span class="s1">&#39;samples.txt&#39;</span><span class="p">,</span> <span class="n">site_file</span><span class="o">=</span><span class="s1">&#39;sites.txt&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="g g-Whitespace">  </span><span class="mi">10385</span>                    <span class="n">ipar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ihext</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ivec</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">isite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">iloc</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">iboot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">vec</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="g g-Whitespace">  </span><span class="mi">10386</span>                    <span class="n">Dir</span><span class="o">=</span><span class="p">[],</span> <span class="n">PDir</span><span class="o">=</span><span class="p">[],</span> <span class="n">crd</span><span class="o">=</span><span class="s2">&quot;s&quot;</span><span class="p">,</span> <span class="n">num_bootstraps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">dir_path</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">fignum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="g g-Whitespace">  </span><span class="mi">10387</span>                    <span class="n">save_plots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">interactive</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;png&quot;</span><span class="p">,</span> <span class="n">contribution</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="g g-Whitespace">  </span><span class="mi">10388</span>     <span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">  </span><span class="mi">10389</span><span class="sd">     Wrapper for aniso_magic</span>
<span class="g g-Whitespace">  </span><span class="mi">10390</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">&gt; </span><span class="mi">10391</span>     <span class="k">return</span> <span class="n">aniso_magic</span><span class="p">(</span><span class="n">infile</span><span class="p">,</span> <span class="n">samp_file</span><span class="p">,</span> <span class="n">site_file</span><span class="p">,</span> <span class="n">verbose</span><span class="p">,</span> <span class="n">ipar</span><span class="p">,</span> <span class="n">ihext</span><span class="p">,</span> <span class="n">ivec</span><span class="p">,</span>
<span class="g g-Whitespace">  </span><span class="mi">10392</span>                        <span class="n">isite</span><span class="p">,</span> <span class="n">iloc</span><span class="p">,</span> <span class="n">iboot</span><span class="p">,</span> <span class="n">vec</span><span class="p">,</span> <span class="n">Dir</span><span class="p">,</span> <span class="n">PDir</span><span class="p">,</span> <span class="n">crd</span><span class="p">,</span> <span class="n">num_bootstraps</span><span class="p">,</span>
<span class="g g-Whitespace">  </span><span class="mi">10393</span>                        <span class="n">dir_path</span><span class="p">,</span> <span class="n">fignum</span><span class="p">,</span> <span class="n">save_plots</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">fmt</span><span class="p">,</span> <span class="n">contribution</span><span class="p">)</span>

<span class="nn">File ~/0000_Github/PmagPy/pmagpy/ipmag.py:10481,</span> in <span class="ni">aniso_magic</span><span class="nt">(infile, samp_file, site_file, verbose, ipar, ihext, ivec, isite, iloc, iboot, vec, Dir, PDir, crd, num_bootstraps, dir_path, fignum, save_plots, interactive, fmt, contribution, image_records)</span>
<span class="g g-Whitespace">  </span><span class="mi">10479</span> <span class="c1"># get other data</span>
<span class="g g-Whitespace">  </span><span class="mi">10480</span> <span class="n">con</span><span class="o">.</span><span class="n">propagate_location_to_specimens</span><span class="p">()</span>
<span class="ne">&gt; </span><span class="mi">10481</span> <span class="n">spec_container</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="s1">&#39;specimens&#39;</span><span class="p">]</span>
<span class="g g-Whitespace">  </span><span class="mi">10482</span> <span class="n">spec_df</span> <span class="o">=</span> <span class="n">spec_container</span><span class="o">.</span><span class="n">df</span>
<span class="g g-Whitespace">  </span><span class="mi">10483</span> <span class="c1"># use only anisotropy records</span>

<span class="ne">KeyError</span>: &#39;specimens&#39;
</pre></div>
</div>
</div>
</div>
</section>
<section id="atrm-magic">
<h2>atrm_magic<a class="headerlink" href="#atrm-magic" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#atrm_magic.py">[command line version]</a></p>
<p>Anisotropy of thermal remanence (ATRM) is similar to anisotropy of anhysteretic remanence (AARM) and the procedure for obtaining the tensor is also similar. Therefore, the <strong>atrm_magic</strong> is quite similar to <a class="reference external" href="#aarm_magic">aarm_magic</a>. However, the SIO lab procedures for the two experiments are somewhat different. In the ATRM experiment, there is a single, zero field step at the chosen temperature which is used as a baseline. We use only six positions (as opposed to nine for AARM) because of the additional risk of alteration at each temperature step. The positions are also different:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Image</span><span class="p">(</span><span class="s1">&#39;data_files/Figures/atrm_meas.png&#39;</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/PmagPy_calculations_9_0.png" src="../_images/PmagPy_calculations_9_0.png" />
</div>
</div>
<p>The file atrm_magic_example.dat in the data_files/atrm_magic directory is an SIO formatted data file containing ATRM measurement data done in a temperature of 520∘C. Note the special format of these files - the treatment column (column 2) has the temperature in centigrade followed by either a “00” for the obligatory zero field baseline step or a “10” for the first postion, and so on. These could also be ‘0‘ and ‘1’, etc..</p>
<p>Follow the instructions for  <a class="reference external" href="#sio_magic">sio_magic</a> to import the ATRM data into the MagIC format. The DC field was 40 μT. The sample/site naming convention used option # 1 (see help menu) and the specimen and sample name are the same (specnum=0).</p>
<p>We will use <strong>ipmag.atrm_magic()</strong> to calculate the best-fit tensor and write out the MagIC tables which can be used to correct remanence data  for the effects of remanent anisotropy.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">convert</span><span class="o">.</span><span class="n">sio</span><span class="p">(</span><span class="s1">&#39;atrm_magic_example.dat&#39;</span><span class="p">,</span><span class="n">dir_path</span><span class="o">=</span><span class="s1">&#39;data_files/atrm_magic/&#39;</span><span class="p">,</span><span class="n">specnum</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
           <span class="n">location</span><span class="o">=</span><span class="s1">&#39;unknown&#39;</span><span class="p">,</span><span class="n">codelist</span><span class="o">=</span><span class="s1">&#39;T:ANI&#39;</span><span class="p">,</span><span class="n">samp_con</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="p">,</span>
           <span class="n">meas_file</span><span class="o">=</span><span class="s1">&#39;measurements.txt&#39;</span><span class="p">,</span><span class="n">labfield</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">phi</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">theta</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-I- Using online data model
-I- Getting method codes from earthref.org
-I- Importing controlled vocabularies from https://earthref.org
-I- overwriting /Users/ltauxe/PmagPy/data_files/atrm_magic/specimens.txt
-I- 30 records written to specimens file
-I- writing samples records to /Users/ltauxe/PmagPy/data_files/atrm_magic/samples.txt
-I- 30 records written to samples file
-I- writing sites records to /Users/ltauxe/PmagPy/data_files/atrm_magic/sites.txt
-I- 10 records written to sites file
-I- writing locations records to /Users/ltauxe/PmagPy/data_files/atrm_magic/locations.txt
-I- 1 records written to locations file
-I- overwriting /Users/ltauxe/PmagPy/data_files/atrm_magic/measurements.txt
-I- 210 records written to measurements file
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(True, &#39;/Users/ltauxe/PmagPy/data_files/atrm_magic/measurements.txt&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">ipmag</span><span class="o">.</span><span class="n">atrm_magic</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function atrm_magic in module pmagpy.ipmag:

atrm_magic(meas_file, dir_path=&#39;.&#39;, input_dir_path=&#39;&#39;, input_spec_file=&#39;specimens.txt&#39;, output_spec_file=&#39;specimens.txt&#39;, data_model_num=3)
    Converts ATRM  data to best-fit tensor (6 elements plus sigma)
    
    Parameters
    ----------
    meas_file : str
        input measurement file
    dir_path : str
        output directory, default &quot;.&quot;
    input_dir_path : str
        input file directory IF different from dir_path, default &quot;&quot;
    input_spec_file : str
        input specimen file name, default &quot;specimens.txt&quot;
    output_spec_file : str
        output specimen file name, default &quot;specimens.txt&quot;
    data_model_num : number
        MagIC data model [2, 3], default 3
    
    Returns
    ---------
    Tuple : (True or False indicating if conversion was sucessful, output file name written)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ipmag</span><span class="o">.</span><span class="n">atrm_magic</span><span class="p">(</span><span class="s1">&#39;measurements.txt&#39;</span><span class="p">,</span><span class="n">dir_path</span><span class="o">=</span><span class="s1">&#39;data_files/atrm_magic&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>adding ATRM data for  ak01a
adding ATRM data for  ak01b
adding ATRM data for  ak01c
adding ATRM data for  ak01d
adding ATRM data for  ak03a
adding ATRM data for  ak03b
adding ATRM data for  ak03c
adding ATRM data for  ak04a
adding ATRM data for  ak04b
adding ATRM data for  ak04c
adding ATRM data for  ak04d
adding ATRM data for  cb01a
adding ATRM data for  cb01b
adding ATRM data for  cb01c
adding ATRM data for  cb02a
adding ATRM data for  cb02c
adding ATRM data for  cb05a
adding ATRM data for  cb05b
adding ATRM data for  cb06a
adding ATRM data for  cb06b
adding ATRM data for  cb09a
adding ATRM data for  cb09b
adding ATRM data for  cb09w
adding ATRM data for  cb09x
adding ATRM data for  cb11a
adding ATRM data for  cb11b
adding ATRM data for  cb12a
adding ATRM data for  cb12b
adding ATRM data for  cb12w
adding ATRM data for  cb12x
30  records written to file  /Users/ltauxe/PmagPy/data_files/atrm_magic/specimens.txt
</pre></div>
</div>
</div>
</div>
</section>
<section id="angle">
<h2>angle<a class="headerlink" href="#angle" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ap1.html#x20-215000A.3.4">[Essentials Appendix A.3.4]</a> <a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#angle.py">[command line version]</a></p>
<p><strong>angle</strong> calculates the angle <span class="math notranslate nohighlight">\(\alpha\)</span> between two declination,inclination pairs.</p>
<p>There are several ways to use this function from the notebook - one loading the data into a Pandas dataframe, then converting to the desired arrays, or load directly into a <strong>Numpy</strong> array of desired shape.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">angle</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function angle in module pmagpy.pmag:

angle(D1, D2)
    Calculate the angle between two directions.
    
    Parameters
    ----------
    D1 : Direction 1 as an array of [declination, inclination] pair or pairs
    D2 : Direction 2 as an array of [declination, inclination] pair or pairs
    
    Returns
    -------
    angle : angle between the directions as a single-element array
    
    Examples
    --------
    &gt;&gt;&gt; pmag.angle([350.0,10.0],[320.0,20.0])
    array([ 30.59060998])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Pandas way:</span>
<span class="n">di</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data_files/angle/angle.dat&#39;</span><span class="p">,</span><span class="n">delim_whitespace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="c1">#rename column headers</span>
<span class="n">di</span><span class="o">.</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Dec1&#39;</span><span class="p">,</span><span class="s1">&#39;Inc1&#39;</span><span class="p">,</span><span class="s1">&#39;Dec2&#39;</span><span class="p">,</span><span class="s1">&#39;Inc2&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Here’s the sort of data  in the file:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">di</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Dec1</th>
      <th>Inc1</th>
      <th>Dec2</th>
      <th>Inc2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>11.2</td>
      <td>32.9</td>
      <td>6.4</td>
      <td>-42.9</td>
    </tr>
    <tr>
      <th>1</th>
      <td>11.5</td>
      <td>63.7</td>
      <td>10.5</td>
      <td>-55.4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11.9</td>
      <td>31.4</td>
      <td>358.1</td>
      <td>-71.8</td>
    </tr>
    <tr>
      <th>3</th>
      <td>349.6</td>
      <td>36.2</td>
      <td>356.3</td>
      <td>-45.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>60.3</td>
      <td>63.5</td>
      <td>58.9</td>
      <td>-56.6</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Now we will use <strong>pmag.angle()</strong> to calculate the angles.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># call pmag.angle</span>
<span class="n">pmag</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">di</span><span class="p">[[</span><span class="s1">&#39;Dec1&#39;</span><span class="p">,</span><span class="s1">&#39;Inc1&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">di</span><span class="p">[[</span><span class="s1">&#39;Dec2&#39;</span><span class="p">,</span><span class="s1">&#39;Inc2&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 75.92745193, 119.10251273, 103.65330599,  81.42586582,
       120.1048559 , 100.8579262 ,  95.07347774,  74.10981614,
        78.41266977, 120.05285684, 114.36156914,  66.30664335,
        85.38356936,  95.07546203,  93.84174   ,  93.116631  ,
       105.39087299,  71.78167883, 104.04746653,  93.84450445,
        93.29827337,  96.34377954,  90.14271929, 112.17559328,
        90.06592091, 120.00493016,  75.31604123,  86.19902246,
        85.85667799,  82.64834934, 115.51261896,  99.28623007,
        65.9466766 ,  90.55185269,  90.50418859,  84.49253198,
        93.00731365,  67.47153733,  76.84279617,  83.80354   ,
       128.3068145 ,  91.690954  ,  46.87441241, 110.66917836,
       103.69699188,  64.35444341,  81.94448359,  94.01817998,
       121.19588845,  83.64445512, 113.72812352,  76.38276774,
       113.38742874,  74.09024232,  79.42493098,  74.92842387,
        90.5556631 ,  91.44844861, 112.71773111,  77.26775912,
        77.06338144,  62.41361128,  88.42053203, 106.29965884,
       100.55759278, 143.79308212, 104.94537375,  91.83604987,
        96.21780532,  85.58941479,  65.61977586,  88.64226464,
        75.64540868,  93.36044834, 101.25961804, 115.14897178,
        86.70974597,  92.32998728,  91.89347431, 102.39692204,
        78.93051946,  93.41996659,  88.08998457,  94.50358255,
        76.96036419, 110.40068516,  89.23179785,  80.90505187,
       100.40590063,  91.88885371, 107.05953781, 115.8185023 ,
       111.2919312 , 124.61718069,  88.12341445,  66.94129884,
        99.90439898,  76.73639992,  71.37398958, 100.7789606 ])
</pre></div>
</div>
</div>
</div>
<p>Here is the other (equally valid) way using <strong>np.loadtext()</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Numpy way:</span>
<span class="n">di</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;data_files/angle/angle.dat&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="c1"># read in file</span>
<span class="n">D1</span><span class="o">=</span><span class="n">di</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="c1"># assign to first array</span>
<span class="n">D2</span><span class="o">=</span><span class="n">di</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="c1"># assign to second array</span>
<span class="n">pmag</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">D1</span><span class="p">,</span><span class="n">D2</span><span class="p">)</span> <span class="c1"># call pmag.angle</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 75.92745193, 119.10251273, 103.65330599,  81.42586582,
       120.1048559 , 100.8579262 ,  95.07347774,  74.10981614,
        78.41266977, 120.05285684, 114.36156914,  66.30664335,
        85.38356936,  95.07546203,  93.84174   ,  93.116631  ,
       105.39087299,  71.78167883, 104.04746653,  93.84450445,
        93.29827337,  96.34377954,  90.14271929, 112.17559328,
        90.06592091, 120.00493016,  75.31604123,  86.19902246,
        85.85667799,  82.64834934, 115.51261896,  99.28623007,
        65.9466766 ,  90.55185269,  90.50418859,  84.49253198,
        93.00731365,  67.47153733,  76.84279617,  83.80354   ,
       128.3068145 ,  91.690954  ,  46.87441241, 110.66917836,
       103.69699188,  64.35444341,  81.94448359,  94.01817998,
       121.19588845,  83.64445512, 113.72812352,  76.38276774,
       113.38742874,  74.09024232,  79.42493098,  74.92842387,
        90.5556631 ,  91.44844861, 112.71773111,  77.26775912,
        77.06338144,  62.41361128,  88.42053203, 106.29965884,
       100.55759278, 143.79308212, 104.94537375,  91.83604987,
        96.21780532,  85.58941479,  65.61977586,  88.64226464,
        75.64540868,  93.36044834, 101.25961804, 115.14897178,
        86.70974597,  92.32998728,  91.89347431, 102.39692204,
        78.93051946,  93.41996659,  88.08998457,  94.50358255,
        76.96036419, 110.40068516,  89.23179785,  80.90505187,
       100.40590063,  91.88885371, 107.05953781, 115.8185023 ,
       111.2919312 , 124.61718069,  88.12341445,  66.94129884,
        99.90439898,  76.73639992,  71.37398958, 100.7789606 ])
</pre></div>
</div>
</div>
</div>
<p>You can always save your output using <strong>np.savetxt()</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">angles</span><span class="o">=</span><span class="n">pmag</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">D1</span><span class="p">,</span><span class="n">D2</span><span class="p">)</span> <span class="c1"># assign the returned array to angles</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="apwp">
<h2>apwp<a class="headerlink" href="#apwp" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch16.html#x15-15600016">[Essentials Chapter 16]</a>  <a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#apwp.py">[command line version]</a></p>
<p>The program <strong>apwp</strong> calculates paleolatitude, declination, inclination from a pole latitude and longitude based on the paper Besse and Courtillot (2002; see <a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch16.html#x15-15600016">Essentials Chapter 16</a>   for complete discussion). Here we will  calculate the expected direction for 100 million year old rocks at a locality in La Jolla Cove (Latitude: 33<span class="math notranslate nohighlight">\(^{\circ}\)</span>N, Longitude 117<span class="math notranslate nohighlight">\(^{\circ}\)</span>W). Assume that we are on the North American Plate! (Note that there IS no option for the Pacific plate in the program <strong>apwp</strong>, and that La Jolla was on the North American plate until a few million years ago (6?).</p>
<p>Within the notebook we will call <strong>pmag.apwp</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">apwp</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function apwp in module pmagpy.pmag:

apwp(data, print_results=False)
    calculates expected pole positions and directions for given plate, location and age
    Parameters
    _________
        data : [plate,lat,lon,age]
            plate : [NA, SA, AF, IN, EU, AU, ANT, GL]
                NA : North America
                SA : South America
                AF : Africa
                IN : India
                EU : Eurasia
                AU : Australia
                ANT: Antarctica
                GL : Greenland
             lat/lon : latitude/longitude in degrees N/E
             age : age in millions of years
        print_results : if True will print out nicely formatted results
    Returns
    _________
        if print_results is False, [Age,Paleolat, Dec, Inc, Pole_lat, Pole_lon]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># here are the desired plate, latitude, longitude and age:</span>
<span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;NA&#39;</span><span class="p">,</span><span class="mi">33</span><span class="p">,</span><span class="o">-</span><span class="mi">117</span><span class="p">,</span><span class="mi">100</span><span class="p">]</span> <span class="c1"># North American plate, lat and lon of San Diego at 100 Ma</span>
<span class="n">pmag</span><span class="o">.</span><span class="n">apwp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">print_results</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Age   Paleolat.   Dec.   Inc.   Pole_lat.  Pole_Long.
  100.0    38.8   352.4    58.1    81.5    198.3
</pre></div>
</div>
</div>
</div>
</section>
<section id="b-vdm">
<h2>b_vdm<a class="headerlink" href="#b-vdm" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch2.html#x15-1560002">[Essentials Chapter 2]</a>  <a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#b_vdm.py">[command line version]</a></p>
<p><strong>b_vdm</strong> converts geomagnetic field intensity observed at the earth’s surface at a particular (paleo)latitude and calculates the Virtual [Axial] Dipole Moment (vdm or vadm).  We will call <strong>pmag.b_vdm()</strong> directly from within the notebook. [See also <a class="reference external" href="#vdm_b"><strong>vdm_b</strong></a>.]</p>
<p>Here we use the function  <strong>pmag.b_vdm()</strong> to convert an estimated paleofield value of 33 <span class="math notranslate nohighlight">\(\mu\)</span>T obtained from a lava flow at 22<span class="math notranslate nohighlight">\(^{\circ}\)</span> N latitude to the equivalent Virtual Dipole Moment (VDM) in Am<span class="math notranslate nohighlight">\(^2\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">b_vdm</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function b_vdm in module pmagpy.pmag:

b_vdm(B, lat)
    Converts a magnetic field value (input in units of tesla) to a virtual
    dipole moment (VDM) or a virtual axial dipole moment (VADM); output
    in units of Am^2)
    
    Parameters
    ----------
    B: local magnetic field strength in tesla
    lat: latitude of site in degrees
    
    Returns
    ----------
    V(A)DM in units of Am^2
    
    Examples
    --------
    &gt;&gt;&gt; pmag.b_vdm(33e-6,22)*1e-21
    
    71.58815974511788
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;</span><span class="si">%7.1f</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">b_vdm</span><span class="p">(</span><span class="mf">33e-6</span><span class="p">,</span><span class="mi">22</span><span class="p">)</span><span class="o">*</span><span class="mf">1e-21</span><span class="p">),</span><span class="s1">&#39; ZAm^2&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   71.6  ZAm^2
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pmag</span><span class="o">.</span><span class="n">b_vdm</span><span class="p">(</span><span class="mf">33e-6</span><span class="p">,</span><span class="mi">22</span><span class="p">)</span><span class="o">*</span><span class="mf">1e-21</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>71.58815974511788
</pre></div>
</div>
</div>
</div>
</section>
<section id="bootams">
<h2>bootams<a class="headerlink" href="#bootams" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch13.html#x15-15600013">[Essentials Chapter 13]</a>  <a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#bootams.py">[command line version]</a></p>
<p><strong>bootams</strong> calculates bootstrap statistics for anisotropy tensor data in the form of:</p>
<p>x11 x22 x33 x12 x23 x13</p>
<p>It does this by selecting para-data sets and calculating the Hext average eigenparameters. It has an optional parametric bootstrap whereby the <span class="math notranslate nohighlight">\(\sigma\)</span> for the data set as a whole is used to draw new para data sets. The bootstrapped eigenparameters are assumed to be Kent distributed and the program calculates Kent error ellipses for each set of eigenvectors. It also estimates the standard deviations of the bootstrapped eigenvalues.</p>
<p><strong>bootams</strong>   reads in a file with data for the six tensor elements (x11 x22 x33 x12 x23 x13) for specimens, calls <strong>pmag.s_boot()</strong>  using a parametric or non-parametric bootstrap as desired. If all that is desired is the bootstrapped eigenparameters, <strong>pmag.s_boot()</strong> has all we need, but if the Kent ellipses are required, and we can call <strong>pmag.sbootpars()</strong> to calculated these more derived products and  print them out.</p>
<p>Note that every time the bootstrap program gets called, the output will be slightly different because this depends on calls to random number generators. If the answers are different by a lot, then the number of bootstrap calculations is too low. The number of bootstraps can be changed with the nb option below.</p>
<p>We can do all this from within the notebook as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">s_boot</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function s_boot in module pmagpy.pmag:

s_boot(Ss, ipar=0, nb=1000)
    Returns bootstrap parameters for S data
    
    Parameters
    __________
    Ss : nested array of [[x11 x22 x33 x12 x23 x13],....] data
    ipar : if True, do a parametric bootstrap
    nb : number of bootstraps
    
    Returns
    ________
    Tmean : average eigenvalues
    Vmean : average eigvectors
    Taus : bootstrapped eigenvalues
    Vs :  bootstrapped eigenvectors
</pre></div>
</div>
</div>
</div>
<p>So we will:</p>
<ul class="simple">
<li><p>read in the AMS tensor data</p></li>
<li><p>get the bootstrapped eigenparameters</p></li>
<li><p>print out the formatted results</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Ss</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;data_files/bootams/bootams_example.dat&#39;</span><span class="p">)</span>
<span class="n">Tmean</span><span class="p">,</span><span class="n">Vmean</span><span class="p">,</span><span class="n">Taus</span><span class="p">,</span><span class="n">Vs</span><span class="o">=</span><span class="n">pmag</span><span class="o">.</span><span class="n">s_boot</span><span class="p">(</span><span class="n">Ss</span><span class="p">)</span> <span class="c1"># get the bootstrapped eigenparameters</span>
<span class="n">bpars</span><span class="o">=</span><span class="n">pmag</span><span class="o">.</span><span class="n">sbootpars</span><span class="p">(</span><span class="n">Taus</span><span class="p">,</span><span class="n">Vs</span><span class="p">)</span> <span class="c1"># calculate kent parameters for bootstrap</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;tau tau_sigma V_dec V_inc V_eta V_eta_dec V_eta_inc V_zeta V_zeta_dec V_zeta_inc</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
<span class="n">outstring</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%7.5f</span><span class="s1"> </span><span class="si">%7.5f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span>\
          <span class="n">Tmean</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;t1_sigma&quot;</span><span class="p">],</span><span class="n">Vmean</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">Vmean</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>\
          <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v1_zeta&quot;</span><span class="p">],</span><span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v1_zeta_dec&quot;</span><span class="p">],</span><span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v1_zeta_inc&quot;</span><span class="p">],</span>\
          <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v1_eta&quot;</span><span class="p">],</span><span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v1_eta_dec&quot;</span><span class="p">],</span><span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v1_eta_inc&quot;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">outstring</span><span class="p">)</span>
<span class="n">outstring</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%7.5f</span><span class="s1"> </span><span class="si">%7.5f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span>\
          <span class="n">Tmean</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;t2_sigma&quot;</span><span class="p">],</span><span class="n">Vmean</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">Vmean</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>\
          <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v2_zeta&quot;</span><span class="p">],</span><span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v2_zeta_dec&quot;</span><span class="p">],</span><span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v2_zeta_inc&quot;</span><span class="p">],</span>\
          <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v2_eta&quot;</span><span class="p">],</span><span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v2_eta_dec&quot;</span><span class="p">],</span><span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v2_eta_inc&quot;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">outstring</span><span class="p">)</span>
<span class="n">outstring</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%7.5f</span><span class="s1"> </span><span class="si">%7.5f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span>\
          <span class="n">Tmean</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;t3_sigma&quot;</span><span class="p">],</span><span class="n">Vmean</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">Vmean</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>\
          <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v3_zeta&quot;</span><span class="p">],</span><span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v3_zeta_dec&quot;</span><span class="p">],</span><span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v3_zeta_inc&quot;</span><span class="p">],</span>\
          <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v3_eta&quot;</span><span class="p">],</span><span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v3_eta_dec&quot;</span><span class="p">],</span><span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v3_eta_inc&quot;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">outstring</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tau tau_sigma V_dec V_inc V_eta V_eta_dec V_eta_inc V_zeta V_zeta_dec V_zeta_inc

0.33505 0.00022     5.3    14.7    10.2   263.6    33.0    13.3   116.3    52.3
0.33334 0.00020   124.5    61.7     6.0   225.5     5.9    17.0   318.8    28.8
0.33161 0.00014   268.8    23.6    10.5     5.0    18.1    12.3   128.3    59.2
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># with parametric bootstrap: </span>
<span class="n">Ss</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;data_files/bootams/bootams_example.dat&#39;</span><span class="p">)</span>
<span class="n">Tmean</span><span class="p">,</span><span class="n">Vmean</span><span class="p">,</span><span class="n">Taus</span><span class="p">,</span><span class="n">Vs</span><span class="o">=</span><span class="n">pmag</span><span class="o">.</span><span class="n">s_boot</span><span class="p">(</span><span class="n">Ss</span><span class="p">,</span><span class="n">ipar</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nb</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span> <span class="c1"># get the bootstrapped eigenparameters</span>
<span class="n">bpars</span><span class="o">=</span><span class="n">pmag</span><span class="o">.</span><span class="n">sbootpars</span><span class="p">(</span><span class="n">Taus</span><span class="p">,</span><span class="n">Vs</span><span class="p">)</span> <span class="c1"># calculate kent parameters for bootstrap</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;tau tau_sigma V_dec V_inc V_eta V_eta_dec V_eta_inc V_zeta V_zeta_dec V_zeta_inc</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
<span class="n">outstring</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%7.5f</span><span class="s1"> </span><span class="si">%7.5f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span>\
          <span class="n">Tmean</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;t1_sigma&quot;</span><span class="p">],</span><span class="n">Vmean</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">Vmean</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>\
          <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v1_zeta&quot;</span><span class="p">],</span><span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v1_zeta_dec&quot;</span><span class="p">],</span><span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v1_zeta_inc&quot;</span><span class="p">],</span>\
          <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v1_eta&quot;</span><span class="p">],</span><span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v1_eta_dec&quot;</span><span class="p">],</span><span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v1_eta_inc&quot;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">outstring</span><span class="p">)</span>
<span class="n">outstring</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%7.5f</span><span class="s1"> </span><span class="si">%7.5f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span>\
          <span class="n">Tmean</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;t2_sigma&quot;</span><span class="p">],</span><span class="n">Vmean</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">Vmean</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>\
          <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v2_zeta&quot;</span><span class="p">],</span><span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v2_zeta_dec&quot;</span><span class="p">],</span><span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v2_zeta_inc&quot;</span><span class="p">],</span>\
          <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v2_eta&quot;</span><span class="p">],</span><span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v2_eta_dec&quot;</span><span class="p">],</span><span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v2_eta_inc&quot;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">outstring</span><span class="p">)</span>
<span class="n">outstring</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%7.5f</span><span class="s1"> </span><span class="si">%7.5f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span>\
          <span class="n">Tmean</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;t3_sigma&quot;</span><span class="p">],</span><span class="n">Vmean</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">Vmean</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>\
          <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v3_zeta&quot;</span><span class="p">],</span><span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v3_zeta_dec&quot;</span><span class="p">],</span><span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v3_zeta_inc&quot;</span><span class="p">],</span>\
          <span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v3_eta&quot;</span><span class="p">],</span><span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v3_eta_dec&quot;</span><span class="p">],</span><span class="n">bpars</span><span class="p">[</span><span class="s2">&quot;v3_eta_inc&quot;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">outstring</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tau tau_sigma V_dec V_inc V_eta V_eta_dec V_eta_inc V_zeta V_zeta_dec V_zeta_inc

0.33505 0.00021     5.3    14.7    10.1   266.7    30.1    22.6   116.7    56.2
0.33334 0.00022   124.5    61.7    19.2   237.3    11.4    23.7   332.5    24.0
0.33161 0.00026   268.8    23.6    10.5     7.3    19.5    20.3   133.9    59.3
</pre></div>
</div>
</div>
</div>
</section>
<section id="cart-dir">
<h2>cart_dir<a class="headerlink" href="#cart-dir" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch2.html#x15-1560002">[Essentials Chapter 2]</a>  <a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#cart_dir.py">[command line version]</a></p>
<p><strong>cart_dir</strong> converts cartesian coordinates (X,Y,Z) to polar coordinates (Declination, Inclination, Intensity).  We will call <strong>pmag.cart2dir()</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">cart2dir</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function cart2dir in module pmagpy.pmag:

cart2dir(cart)
    Converts a direction in cartesian coordinates into declination, inclinations
    
    Parameters
    ----------
    cart : input list of [x,y,z] or list of lists [[x1,y1,z1],[x2,y2,z2]...]
    
    Returns
    -------
    direction_array : returns an array of [declination, inclination, intensity]
    
    Examples
    --------
    &gt;&gt;&gt; pmag.cart2dir([0,1,0])
    array([ 90.,   0.,   1.])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># read in data file from example file</span>
<span class="n">cart</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;data_files/cart_dir/cart_dir_example.dat&#39;</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Input: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">cart</span><span class="p">)</span> <span class="c1"># print out the cartesian coordinates</span>
<span class="c1"># print out the  results</span>
<span class="n">dirs</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">cart2dir</span><span class="p">(</span><span class="n">cart</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Output: &quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">dirs</span><span class="p">:</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;</span><span class="si">%7.1f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1"> </span><span class="si">%8.3e</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">d</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Input: 
 [[ 0.3971 -0.1445  0.9063]
 [-0.5722  0.04   -0.8192]]
Output: 
  340.0    65.0 1.000e+00
  176.0   -55.0 1.000e+00
</pre></div>
</div>
</div>
</div>
</section>
<section id="di-eq">
<h2>di_eq<a class="headerlink" href="#di-eq" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ap2.html#equal_area">[Essentials Appendix B]</a>
<a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#di_eq.py">[command line version]</a></p>
<p>Paleomagnetic data are frequently plotted in equal area projection. PmagPy has several plotting options which do this (e.g., <a class="reference external" href="#eqarea"><strong>eqarea</strong></a>, but occasionally it is handy to be able to convert the directions to X,Y coordinates directly, without plotting them at all.  Here is an example transcript of a session using the datafile di_eq_example.dat:</p>
<p>The program <strong>di_eq</strong>  program calls <strong>pmag.dimap()</strong> which we can do from within a Jupyter notebook.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">dimap</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function dimap in module pmagpy.pmag:

dimap(D, I)
    Function to map directions  to x,y pairs in equal area projection
    
    Parameters
    ----------
    D : list or array of declinations (as float)
    I : list or array or inclinations (as float)
    
    Returns
    -------
    XY : x, y values of directions for equal area projection [x,y]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DIs</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;data_files/di_eq/di_eq_example.dat&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="c1"># load in the data</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">dimap</span><span class="p">(</span><span class="n">DIs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">DIs</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="c1"># call the function</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[-0.23941025 -0.8934912 ]
 [ 0.43641303  0.71216134]
 [ 0.06384422  0.76030049]
 [ 0.32144709  0.68621606]
 [ 0.32271993  0.67056248]
 [ 0.40741223  0.54065429]
 [ 0.5801562   0.34037562]
 [ 0.10535089  0.65772758]
 [ 0.24717308  0.59968683]
 [ 0.18234908  0.61560016]
 [ 0.17481507  0.60171742]
 [ 0.282746    0.54547233]
 [ 0.26486315  0.53827299]
 [ 0.23575838  0.5345358 ]
 [ 0.29066509  0.50548208]
 [ 0.26062905  0.51151332]
 [ 0.23208983  0.51642328]
 [ 0.24444839  0.50566578]
 [ 0.27792652  0.46438138]
 [ 0.2505103   0.47715181]
 [ 0.29177004  0.44081644]
 [ 0.10876949  0.51614821]
 [ 0.19670646  0.48201446]
 [ 0.34938995  0.38129223]
 [ 0.1684068   0.47556614]
 [ 0.20628586  0.44644351]
 [ 0.17570082  0.45064929]
 [ 0.30110381  0.37853937]
 [ 0.20495497  0.42396971]
 [ 0.19975473  0.4225844 ]
 [ 0.34691999  0.30800998]
 [ 0.11902989  0.44114437]
 [ 0.23984794  0.37648585]
 [ 0.26952843  0.34250954]
 [ 0.08545091  0.42378931]
 [ 0.19222399  0.38723272]
 [ 0.17260777  0.39508358]
 [ 0.27200846  0.32074137]
 [ 0.39398077  0.11745077]
 [-0.01772645  0.40600235]
 [ 0.15427268  0.36700021]
 [ 0.21390276  0.33576007]
 [ 0.10322076  0.37220205]
 [ 0.23183349  0.28324518]
 [ 0.07216042  0.35153814]
 [ 0.00780196  0.31923589]
 [ 0.15258303  0.26535002]
 [ 0.24813332  0.13641245]]
</pre></div>
</div>
</div>
</div>
</section>
<section id="di-geo">
<h2>di_geo<a class="headerlink" href="#di-geo" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch9.html">[Essentials Chapter 9]</a>
and <a class="reference external" href="http://earthref.org/MAGIC/books/Tauxe/Essentials/WebBook3ap1.html#Changing_coordinate_systems">Changing coordinate systems</a>
<a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#di_geo.py">[command line version]</a></p>
<p>Here we will convert D = 8.1,I = 45.2 from specimen coordinates to geographic-adjusted coordinates. The orientation of laboratory arrow on the specimen was: azimuth = 347; plunge = 27. To do this we will call <strong>pmag.dogeo()</strong>. There is also <strong>pmag.dogeo_V</strong> for arrays of data.</p>
<p>So let’s start with <strong>pmag.dogeo()</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">dogeo</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function dogeo in module pmagpy.pmag:

dogeo(dec, inc, az, pl)
    Rotates declination and inclination into geographic coordinates using the
    azimuth and plunge of the X direction (lab arrow) of a specimen.
    
    Parameters
    ----------
    dec : declination in specimen coordinates
    inc : inclination in specimen coordinates
    
    Returns
    -------
    rotated_direction : tuple of declination, inclination in geographic coordinates
    
    Examples
    --------
    &gt;&gt;&gt; pmag.dogeo(0.0,90.0,0.0,45.5)
    (180.0, 44.5)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pmag</span><span class="o">.</span><span class="n">dogeo</span><span class="p">(</span><span class="n">dec</span><span class="o">=</span><span class="mi">81</span><span class="p">,</span><span class="n">inc</span><span class="o">=</span><span class="mf">45.2</span><span class="p">,</span><span class="n">az</span><span class="o">=</span><span class="mi">347</span><span class="p">,</span><span class="n">pl</span><span class="o">=</span><span class="mi">27</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(94.83548541337562, 43.02168490109632)
</pre></div>
</div>
</div>
</div>
<p>Now let’s check out the version that takes many data points at once.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">dogeo_V</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function dogeo_V in module pmagpy.pmag:

dogeo_V(indat)
    Rotates declination and inclination into geographic coordinates using the
    azimuth and plunge of the X direction (lab arrow) of a specimen.
    
    Parameters
    ----------
    indat: nested list of [dec, inc, az, pl] data
    
    Returns
    -------
    rotated_directions : arrays of Declinations and Inclinations
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">indata</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;data_files/di_geo/di_geo_example.dat&#39;</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">indata</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 288.1   35.8   67.   -36. ]
 [ 256.8   22.5   84.   -81. ]
 [ 262.4   19.1   91.   -48. ]
 [ 258.6   19.6   89.   -61. ]
 [ 259.9   54.7   49.   -76. ]
 [ 279.1   27.9   62.   -41. ]
 [ 228.3  -47.5  141.   -84. ]
 [ 249.8   25.    60.   -82. ]
 [ 239.8  -33.9  108.   -91. ]
 [ 271.7   50.8   28.   -52. ]
 [ 266.8   67.1   16.   -67. ]
 [ 238.9   51.9   27.   -76. ]
 [ 238.9   55.3   17.   -90. ]
 [ 252.6   41.    43.   -73. ]
 [ 112.7   17.1  282.6  -78. ]
 [ 134.9   -8.9  234.   -56. ]
 [ 138.6   -1.1  244.6  -73. ]
 [  83.5   31.1  292.   -28. ]
 [ 151.1  -35.2  196.6  -69. ]
 [ 146.8  -14.5  217.   -51. ]
 [  13.8   35.   332.6  -44. ]
 [ 293.1    3.9   53.5  -25.5]
 [  99.5  -11.   243.6  -30. ]
 [ 267.8  -12.7   91.5  -49. ]
 [  47.    12.8  298.6  -28. ]
 [  45.8   -9.   297.   -33.5]
 [  81.7  -26.8  254.6  -51. ]
 [  79.7  -25.7  256.   -60. ]
 [  84.7  -20.9  256.6  -60. ]
 [ 303.3   66.7    3.6  -71.5]
 [ 104.6   32.2  297.  -100.5]
 [ 262.8   77.9  357.1  -87. ]
 [  63.3   53.2  316.   -63. ]
 [  37.7   60.1  331.6  -57. ]
 [ 109.3    5.4  255.6  -58.5]
 [ 119.3    5.5  252.6  -52. ]
 [ 108.7   23.6  287.6  -79. ]]
</pre></div>
</div>
</div>
</div>
<p>Let’s take a look at these data in equal area projection: (see <a class="reference external" href="#eqarea">eqarea</a> for details)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ipmag</span><span class="o">.</span><span class="n">plot_net</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">plot_di</span><span class="p">(</span><span class="n">dec</span><span class="o">=</span><span class="n">indata</span><span class="o">.</span><span class="n">transpose</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span><span class="n">inc</span><span class="o">=</span><span class="n">indata</span><span class="o">.</span><span class="n">transpose</span><span class="p">()[</span><span class="mi">1</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">edge</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/PmagPy_calculations_50_0.png" src="../_images/PmagPy_calculations_50_0.png" />
</div>
</div>
<p>The data are highly scattered and we hope that the geographic coordinate system looks better! To find out try:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">decs</span><span class="p">,</span><span class="n">incs</span><span class="o">=</span><span class="n">pmag</span><span class="o">.</span><span class="n">dogeo_V</span><span class="p">(</span><span class="n">indata</span><span class="p">)</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">plot_net</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">plot_di</span><span class="p">(</span><span class="n">dec</span><span class="o">=</span><span class="n">decs</span><span class="p">,</span><span class="n">inc</span><span class="o">=</span><span class="n">incs</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">edge</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/PmagPy_calculations_52_0.png" src="../_images/PmagPy_calculations_52_0.png" />
</div>
</div>
<p>These data are clearly much better grouped.</p>
<p>And here they are printed out.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">([</span><span class="n">decs</span><span class="p">,</span><span class="n">incs</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 1.23907966e+01  1.89735424e+01]
 [ 1.49830732e+01  1.55593373e+01]
 [ 1.06667819e+01  1.81693342e+01]
 [ 1.14047553e+01  1.89951632e+01]
 [ 1.24483163e+01  1.72036203e+01]
 [ 3.57299071e+02  1.51561580e+01]
 [ 3.53883281e+02  2.17091208e+01]
 [ 3.53789196e+02  2.16365727e+01]
 [ 3.40503777e+02  2.52889275e+01]
 [ 3.42563974e+02  2.75374519e+01]
 [ 3.51164668e+02  2.23293805e+01]
 [ 3.49415385e+02  2.99754627e+01]
 [ 3.46335983e+02  1.71006907e+01]
 [ 3.50937970e+02  2.40567015e+01]
 [ 3.59146910e+02  2.49558990e+01]
 [ 5.20812064e-01  2.94481211e+01]
 [ 3.54368265e+02  4.53644133e+01]
 [ 9.11626301e-01  2.42403293e+01]
 [ 3.50170459e+02  2.74704564e+01]
 [ 3.54249362e-02  2.81645605e+01]
 [ 3.43981389e+02 -8.04836591e+00]
 [ 3.46130907e+02 -6.14959601e+00]
 [ 3.47283278e+02 -4.83219850e+00]
 [ 3.50443170e+02 -6.65953274e+00]
 [ 3.44495997e+02 -6.69629260e+00]
 [ 3.52433892e+02 -3.06972914e+01]
 [ 1.55709734e+00 -2.25743459e+01]
 [ 4.40491709e+00 -2.08767482e+01]
 [ 2.54671945e+00 -1.46610862e+01]
 [ 3.44221055e+02  4.90397368e+00]
 [ 3.52498530e+02  6.46629212e+00]
 [ 3.45060173e+02  4.43967268e+00]
 [ 3.48635524e+02  7.10612965e+00]
 [ 3.49534584e+02  8.12663013e+00]
 [ 3.51173216e+02  1.92524262e+01]
 [ 3.57092897e+02  2.62872553e+01]
 [ 3.56384865e+02  2.13946656e+01]]
</pre></div>
</div>
</div>
</div>
</section>
<section id="di-rot">
<h2>di_rot<a class="headerlink" href="#di-rot" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch11.html">[Essentials Chapter 11]</a>
<a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#di_rot.py">[command line version]</a></p>
<p><strong>di_rot</strong>   rotates dec inc pairs to a new origin.  We can call <strong>pmag.dodirot()</strong> for single [dec,inc,Dbar,Ibar] data or <strong>pmag.dodirot_V()</strong> for an array of Dec, Inc pairs.  We can use the data from the <a class="reference external" href="#di_geo">di_geo</a> example and rotate the geographic coordinate data such that the center of the distribution is the principal direction.</p>
<p>We do it like this:</p>
<ul class="simple">
<li><p>read in a data set with dec inc pairs</p></li>
<li><p>make an equal area projection of the data to remind us what they look like</p></li>
<li><p>calculate the principal component with <strong>pmag.doprinc())</strong></p></li>
<li><p>rotate the data to the principal direction</p></li>
<li><p>plot the rotated data in an equal area projection.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">di_block</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;data_files/di_rot/di_rot_example.txt&#39;</span><span class="p">)</span> <span class="c1"># read in some data</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">plot_net</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># make the plot</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">plot_di</span><span class="p">(</span><span class="n">di_block</span><span class="o">=</span><span class="n">di_block</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;geographic&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">edge</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/PmagPy_calculations_57_0.png" src="../_images/PmagPy_calculations_57_0.png" />
</div>
</div>
<p>Now we calculate the principal direction using the method described inthe <a class="reference external" href="#goprinc">goprinc</a> section.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">princ</span><span class="o">=</span><span class="n">pmag</span><span class="o">.</span><span class="n">doprinc</span><span class="p">(</span><span class="n">di_block</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>And note we use <strong>pmag.dodirot_V</strong> to do the rotation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">dodirot_V</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function dodirot_V in module pmagpy.pmag:

dodirot_V(di_block, Dbar, Ibar)
    Rotate an array of dec/inc pairs to coordinate system with Dec,Inc as 0,90
    
    Parameters
    ___________________
    di_block : array of [[Dec1,Inc1],[Dec2,Inc2],....]
    Dbar : declination of desired center
    Ibar : inclination of desired center
    
    Returns
    __________
    array of rotated decs and incs: [[rot_Dec1,rot_Inc1],[rot_Dec2,rot_Inc2],....]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rot_block</span><span class="o">=</span><span class="n">pmag</span><span class="o">.</span><span class="n">dodirot_V</span><span class="p">(</span><span class="n">di_block</span><span class="p">,</span><span class="n">princ</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">],</span><span class="n">princ</span><span class="p">[</span><span class="s1">&#39;inc&#39;</span><span class="p">])</span>
<span class="n">rot_block</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[354.75645822,  85.48653154],
       [  7.99632503,  76.34238986],
       [218.59309456,  71.32523704],
       [256.72254094,  81.2757586 ],
       [ 36.92916127,  71.27696636],
       [107.0627481 ,  74.65934147],
       [149.72796903,  84.48123415],
       [ 98.10291566,  69.6463126 ],
       [348.29161295,  72.10250018],
       [285.08151847,  74.70297918],
       [273.35642946,  68.89864852],
       [330.28910824,  88.29039388],
       [280.73571259,  70.61791032],
       [  3.71124387,  76.1147856 ],
       [ 42.78313341,  81.09119604],
       [264.92037462,  82.36734047],
       [228.29288415,  88.01160809],
       [ 55.75081265,  80.3717505 ],
       [ 43.32707637,  84.27753112],
       [271.79063108,  77.21159274],
       [104.84899776,  83.08877923],
       [139.82061837,  76.3993491 ],
       [228.41478454,  68.21812033],
       [184.94964644,  85.8780573 ],
       [290.12100275,  80.82170974],
       [164.81453236,  80.16691249],
       [ 40.09107584,  66.25110527],
       [298.44492688,  70.85449532],
       [229.95810882,  87.16480711],
       [341.36209131,  56.49504557],
       [161.4027806 ,  55.85892511],
       [243.45576845,  80.16805823],
       [ 92.95291456,  87.9768544 ],
       [277.0303939 ,  57.70952077],
       [236.25509448,  77.33331201],
       [217.34511494,  61.35545307],
       [ 79.43533762,  70.47284374],
       [128.52228098,  52.95597767],
       [305.3580388 ,  79.90489952],
       [ 74.184968  ,  78.12469469],
       [ 21.27466927,  68.81257393],
       [ 23.49656306,  59.06513099],
       [ 44.65570709,  87.79057524],
       [ 57.60260544,  74.0252133 ],
       [120.82174991,  58.86801901],
       [149.68771685,  67.1484272 ],
       [121.72422639,  75.27918125],
       [181.82291633,  53.55593668],
       [ 33.34840452,  82.71868637],
       [135.24107166,  88.10701922],
       [312.71205472,  82.96349888],
       [245.36645022,  73.64842748],
       [ 36.71037036,  83.69777544],
       [ 88.92589842,  71.82553941],
       [303.76292348,  82.95952847],
       [ 46.32527218,  73.32388994],
       [  8.73534352,  70.19628754],
       [131.5368215 ,  72.47500848],
       [272.34524655,  65.75867311],
       [257.66968142,  80.83680899],
       [ 77.32702941,  80.56050729],
       [121.94427365,  63.58296413],
       [330.03559663,  66.08337506],
       [ 51.00447804,  75.7842832 ],
       [202.41794483,  68.43613925],
       [132.25871642,  71.76054598],
       [291.45278027,  48.82252799],
       [ 93.69827493,  71.5775386 ],
       [351.6954523 ,  79.30962868],
       [337.44083997,  65.69494318],
       [266.95948753,  68.62351084],
       [ 83.630119  ,  79.65111206],
       [350.24134592,  78.048473  ],
       [197.96350635,  83.98150407],
       [197.71481284,  76.14348773],
       [310.55033705,  78.23192585],
       [ 78.77356327,  58.02447289],
       [259.60162484,  79.15809287],
       [286.77106467,  60.86301322],
       [205.76280361,  76.9572738 ],
       [156.13298085,  85.59867107],
       [164.45839371,  78.82453195],
       [ 56.73345517,  68.17101814],
       [333.84210333,  86.57135527],
       [148.52724727,  85.55221936],
       [222.19677177,  88.35415535],
       [260.32772137,  77.7377499 ],
       [112.97103002,  77.71005599],
       [ 20.05703624,  86.20899093],
       [322.97567646,  75.06538153],
       [222.26720753,  55.73330804],
       [139.90526594,  72.40397416],
       [312.48926048,  79.65647491],
       [200.97503066,  60.43114047],
       [ 82.81519452,  80.55563807],
       [  4.47891063,  78.31133276],
       [152.93461275,  86.9201173 ],
       [130.61844695,  86.22975549],
       [ 73.38056924,  83.81526149],
       [183.81900156,  71.53579093]])
</pre></div>
</div>
</div>
</div>
<p>And of course look at what we have done!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ipmag</span><span class="o">.</span><span class="n">plot_net</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># make the plot</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">plot_di</span><span class="p">(</span><span class="n">di_block</span><span class="o">=</span><span class="n">rot_block</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;rotated&#39;</span><span class="p">,</span><span class="n">edge</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/PmagPy_calculations_64_0.png" src="../_images/PmagPy_calculations_64_0.png" />
</div>
</div>
</section>
<section id="di-tilt">
<h2>di_tilt<a class="headerlink" href="#di-tilt" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch9.html">[Essentials Chapter 9]</a> <a class="reference external" href="http://earthref.org/MAGIC/books/Tauxe/Essentials/WebBook3ap1.html#Changing_coordinate_systems">[Changing coordinate systems]</a>
<a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#di_tilt.py">[command line version]</a></p>
<p><strong>di_tilt</strong> can rotate a direction of Declination = 5.3 and Inclination = 71.6 to “stratigraphic” coordinates, assuming the  strike was 135 and the dip was 21. The convention in this program is to use the dip direction, which is to the “right” of this strike.</p>
<p>We can perform this calculation by calling  <strong>pmag.dotilt</strong> or <strong>pmag.dotilt_V()</strong> depending on if we have a single point or an array to rotate.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">dotilt</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function dotilt in module pmagpy.pmag:

dotilt(dec, inc, bed_az, bed_dip)
    Does a tilt correction on a direction (dec,inc) using bedding dip direction
    and bedding dip.
    
    Parameters
    __________
        dec : declination directions in degrees
        inc : inclination direction in degrees
        bed_az : bedding dip direction
        bed_dip : bedding dip
    
    Returns
    _______
        dec,inc : a tuple of rotated dec, inc values
    
    Examples
    ________
    &gt;&gt;&gt; pmag.dotilt(91.2,43.1,90.0,20.0)
    (90.952568837153436, 23.103411670066617)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">dotilt_V</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function dotilt_V in module pmagpy.pmag:

dotilt_V(indat)
    Does a tilt correction on an array with rows of dec,inc bedding dip direction and dip.
    
    Parameters
    __________
        input : declination, inclination, bedding dip direction and bedding dip
        nested array of [[dec1, inc1, bed_az1, bed_dip1],[dec2,inc2,bed_az2,bed_dip2]...]
    
    Returns
    _______
        dec,inc : arrays of rotated declination, inclination
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># read in some data</span>
<span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;data_files/di_tilt/di_tilt_example.dat&#39;</span><span class="p">)</span> <span class="c1"># load up the data</span>
<span class="n">di_block</span><span class="o">=</span><span class="n">data</span><span class="p">[:,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]]</span> <span class="c1"># let&#39;s look at the data first! </span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">plot_net</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">plot_di</span><span class="p">(</span><span class="n">di_block</span><span class="o">=</span><span class="n">di_block</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/PmagPy_calculations_68_0.png" src="../_images/PmagPy_calculations_68_0.png" />
</div>
</div>
<p>Now we can rotate them</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 9.700e+00,  5.300e+01,  1.050e+02,  2.200e+01],
       [ 3.170e+02,  4.420e+01,  1.050e+02,  2.200e+01],
       [ 3.331e+02,  8.900e+00,  1.050e+02,  2.200e+01],
       [ 3.543e+02, -1.000e-01,  1.050e+02,  2.200e+01],
       [ 3.389e+02,  5.020e+01,  1.050e+02,  2.200e+01],
       [ 3.552e+02,  2.430e+01,  1.050e+02,  2.200e+01],
       [ 3.374e+02,  3.950e+01,  1.050e+02,  2.200e+01],
       [ 3.224e+02,  4.340e+01,  1.050e+02,  2.200e+01],
       [ 3.412e+02, -1.230e+01,  1.050e+02,  2.200e+01],
       [ 3.565e+02,  1.600e+01,  1.050e+02,  2.200e+01],
       [ 3.360e+02,  3.780e+01,  1.050e+02,  2.200e+01],
       [ 3.407e+02,  3.920e+01,  1.050e+02,  2.200e+01],
       [ 3.148e+02,  4.680e+01,  1.050e+02,  2.200e+01],
       [ 4.200e+00,  3.130e+01,  1.050e+02,  2.200e+01],
       [ 3.440e+02,  2.150e+01,  1.050e+02,  2.200e+01],
       [ 5.300e+00,  4.930e+01,  1.050e+02,  2.200e+01],
       [ 7.100e+00,  4.360e+01,  1.050e+02,  2.200e+01],
       [ 3.400e+02,  2.790e+01,  1.050e+02,  2.200e+01],
       [ 3.344e+02,  3.600e+01,  1.050e+02,  2.200e+01],
       [ 1.280e+01,  5.400e+00,  1.050e+02,  2.200e+01],
       [ 1.898e+02, -2.760e+01,  1.050e+02,  2.200e+01],
       [ 1.614e+02, -5.350e+01,  1.050e+02,  2.200e+01],
       [ 1.442e+02, -1.820e+01,  1.050e+02,  2.200e+01],
       [ 1.727e+02, -5.160e+01,  1.050e+02,  2.200e+01],
       [ 1.844e+02,  1.880e+01,  1.050e+02,  2.200e+01],
       [ 1.612e+02, -2.810e+01,  1.050e+02,  2.200e+01],
       [ 1.729e+02, -3.940e+01,  1.050e+02,  2.200e+01],
       [ 1.796e+02, -4.700e+00,  1.050e+02,  2.200e+01],
       [ 1.638e+02, -4.410e+01,  1.050e+02,  2.200e+01],
       [ 1.603e+02,  1.350e+01,  1.050e+02,  2.200e+01],
       [ 1.679e+02, -2.880e+01,  1.050e+02,  2.200e+01],
       [ 1.724e+02, -4.240e+01,  1.050e+02,  2.200e+01],
       [ 1.581e+02,  6.300e+00,  1.050e+02,  2.200e+01],
       [ 1.938e+02, -2.550e+01,  1.050e+02,  2.200e+01],
       [ 1.647e+02, -2.790e+01,  1.050e+02,  2.200e+01],
       [ 1.567e+02, -4.340e+01,  1.050e+02,  2.200e+01],
       [ 1.652e+02, -1.820e+01,  1.050e+02,  2.200e+01],
       [ 1.926e+02,  1.700e+01,  1.050e+02,  2.200e+01],
       [ 1.573e+02, -2.550e+01,  1.050e+02,  2.200e+01],
       [ 1.619e+02, -1.240e+01,  1.050e+02,  2.200e+01],
       [ 6.420e+01,  6.590e+01,  3.400e+02,  4.000e+01],
       [ 1.225e+02,  8.230e+01,  3.400e+02,  4.000e+01],
       [ 1.049e+02,  8.030e+01,  3.400e+02,  4.000e+01],
       [ 5.280e+01,  6.710e+01,  3.400e+02,  4.000e+01],
       [ 3.400e+02,  4.700e+01,  3.400e+02,  4.000e+01],
       [ 2.886e+02,  8.670e+01,  3.400e+02,  4.000e+01],
       [ 2.560e+01,  5.930e+01,  3.400e+02,  4.000e+01],
       [ 3.130e+01,  4.590e+01,  3.400e+02,  4.000e+01],
       [ 2.928e+02,  7.240e+01,  3.400e+02,  4.000e+01],
       [ 1.008e+02,  6.960e+01,  3.400e+02,  4.000e+01],
       [ 8.750e+01,  6.850e+01,  3.400e+02,  4.000e+01],
       [ 3.536e+02,  5.070e+01,  3.400e+02,  4.000e+01],
       [ 3.515e+02,  6.650e+01,  3.400e+02,  4.000e+01],
       [ 5.320e+01,  8.270e+01,  3.400e+02,  4.000e+01],
       [ 3.577e+02,  4.610e+01,  3.400e+02,  4.000e+01],
       [ 3.390e+01,  6.490e+01,  3.400e+02,  4.000e+01],
       [ 1.247e+02,  5.920e+01,  3.400e+02,  4.000e+01],
       [ 7.220e+01,  7.130e+01,  3.400e+02,  4.000e+01],
       [ 8.840e+01,  5.640e+01,  3.400e+02,  4.000e+01],
       [ 2.730e+01,  3.130e+01,  3.400e+02,  4.000e+01],
       [ 1.483e+02, -8.840e+01,  3.400e+02,  4.000e+01],
       [ 1.661e+02, -4.870e+01,  3.400e+02,  4.000e+01],
       [ 2.509e+02, -8.480e+01,  3.400e+02,  4.000e+01],
       [ 2.036e+02, -7.470e+01,  3.400e+02,  4.000e+01],
       [ 1.804e+02, -6.450e+01,  3.400e+02,  4.000e+01],
       [ 2.444e+02, -5.890e+01,  3.400e+02,  4.000e+01],
       [ 1.947e+02, -3.120e+01,  3.400e+02,  4.000e+01],
       [ 1.763e+02, -6.210e+01,  3.400e+02,  4.000e+01],
       [ 2.743e+02, -8.570e+01,  3.400e+02,  4.000e+01],
       [ 1.981e+02, -6.260e+01,  3.400e+02,  4.000e+01],
       [ 2.004e+02, -6.250e+01,  3.400e+02,  4.000e+01],
       [ 2.034e+02, -6.410e+01,  3.400e+02,  4.000e+01],
       [ 2.339e+02, -8.150e+01,  3.400e+02,  4.000e+01],
       [ 1.993e+02, -7.640e+01,  3.400e+02,  4.000e+01],
       [ 2.944e+02, -7.690e+01,  3.400e+02,  4.000e+01],
       [ 2.210e+02, -5.380e+01,  3.400e+02,  4.000e+01],
       [ 2.830e+02, -7.190e+01,  3.400e+02,  4.000e+01],
       [ 1.742e+02, -6.650e+01,  3.400e+02,  4.000e+01],
       [ 2.887e+02, -7.490e+01,  3.400e+02,  4.000e+01],
       [ 2.253e+02, -7.170e+01,  3.400e+02,  4.000e+01]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Dt</span><span class="p">,</span><span class="n">It</span><span class="o">=</span><span class="n">pmag</span><span class="o">.</span><span class="n">dotilt_V</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="c1"># rotate them</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">plot_net</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># and take another look</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">plot_di</span><span class="p">(</span><span class="n">dec</span><span class="o">=</span><span class="n">Dt</span><span class="p">,</span><span class="n">inc</span><span class="o">=</span><span class="n">It</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/PmagPy_calculations_71_0.png" src="../_images/PmagPy_calculations_71_0.png" />
</div>
</div>
<p>Use the handy function <strong>np.column_stack</strong> to pair the decs and incs together</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">Dt</span><span class="p">,</span><span class="n">It</span><span class="p">))</span> <span class="c1"># if you want to see the output: </span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 3.74524673e+01,  4.95794971e+01],
       [ 3.36467520e+02,  6.09447203e+01],
       [ 3.38016562e+02,  2.29922937e+01],
       [ 3.55656248e+02,  7.51556739e+00],
       [ 8.17695697e+00,  5.86079487e+01],
       [ 6.24312543e+00,  2.98149642e+01],
       [ 3.57033733e+02,  5.00073921e+01],
       [ 3.42811107e+02,  5.85702274e+01],
       [ 3.39284414e+02,  3.48942163e-01],
       [ 3.85757431e+00,  2.17049062e+01],
       [ 3.54347623e+02,  4.89864710e+01],
       [ 2.83925013e-01,  4.85556186e+01],
       [ 3.35776430e+02,  6.39503873e+01],
       [ 1.81481921e+01,  3.27972491e+01],
       [ 3.53945383e+02,  3.12870301e+01],
       [ 3.08201120e+01,  4.80808730e+01],
       [ 2.80340193e+01,  4.25855265e+01],
       [ 3.52849360e+02,  3.85903328e+01],
       [ 3.51431548e+02,  4.79200709e+01],
       [ 1.49895755e+01,  5.82971278e+00],
       [ 2.01405693e+02, -2.73644346e+01],
       [ 1.94529222e+02, -6.03000930e+01],
       [ 1.51711653e+02, -3.44278588e+01],
       [ 2.02439369e+02, -5.45796578e+01],
       [ 1.78129642e+02,  1.35071395e+01],
       [ 1.74193635e+02, -3.83557833e+01],
       [ 1.92458609e+02, -4.42202097e+01],
       [ 1.82404516e+02, -1.00854450e+01],
       [ 1.87192313e+02, -5.16833347e+01],
       [ 1.58078673e+02,  5.20435367e-01],
       [ 1.81335139e+02, -3.65993719e+01],
       [ 1.94115720e+02, -4.70131320e+01],
       [ 1.58208438e+02, -6.99710447e+00],
       [ 2.04050923e+02, -2.39690981e+01],
       [ 1.77668058e+02, -3.69335311e+01],
       [ 1.79312818e+02, -5.36825261e+01],
       [ 1.73740461e+02, -2.78039697e+01],
       [ 1.86273785e+02,  1.48376413e+01],
       [ 1.68858936e+02, -3.72957242e+01],
       [ 1.68155763e+02, -2.35094484e+01],
       [ 1.33030870e+01,  4.22794606e+01],
       [ 3.48352284e+02,  5.58391509e+01],
       [ 3.53867446e+02,  5.47913351e+01],
       [ 8.65352111e+00,  3.91760462e+01],
       [ 3.40000000e+02,  7.00000000e+00],
       [ 3.36154223e+02,  4.78755564e+01],
       [ 3.81797572e+00,  2.54089397e+01],
       [ 1.43419909e+01,  1.56898879e+01],
       [ 3.23928409e+02,  3.67361188e+01],
       [ 1.27352972e+01,  5.63798793e+01],
       [ 1.42359910e+01,  5.15897401e+01],
       [ 3.48737862e+02,  1.13663807e+01],
       [ 3.45111147e+02,  2.68299034e+01],
       [ 3.50355082e+02,  4.74111159e+01],
       [ 3.52271716e+02,  7.31725552e+00],
       [ 3.89741169e+00,  3.22117431e+01],
       [ 3.19005940e+01,  6.79140326e+01],
       [ 8.12324186e+00,  4.71819989e+01],
       [ 3.25923242e+01,  4.86194246e+01],
       [ 1.89143987e+01,  1.46150626e+00],
       [ 1.59511050e+02, -4.84321911e+01],
       [ 1.64070130e+02, -8.83925684e+00],
       [ 1.68071076e+02, -4.98009543e+01],
       [ 1.73357015e+02, -3.80292679e+01],
       [ 1.69578333e+02, -2.55976667e+01],
       [ 2.01113352e+02, -3.85750376e+01],
       [ 1.89188527e+02,  3.16419245e+00],
       [ 1.68193460e+02, -2.28496326e+01],
       [ 1.66316564e+02, -5.16025617e+01],
       [ 1.78511559e+02, -2.65720102e+01],
       [ 1.79619680e+02, -2.69659149e+01],
       [ 1.80072436e+02, -2.90190442e+01],
       [ 1.72017252e+02, -4.69940123e+01],
       [ 1.71028729e+02, -3.88734330e+01],
       [ 1.77793107e+02, -5.79993286e+01],
       [ 1.94987994e+02, -2.57291361e+01],
       [ 1.88426223e+02, -5.68143203e+01],
       [ 1.66302864e+02, -2.70024954e+01],
       [ 1.82295485e+02, -5.75960780e+01],
       [ 1.81867322e+02, -4.00131799e+01]])
</pre></div>
</div>
</div>
</div>
</section>
<section id="di-vgp">
<h2>di_vgp<a class="headerlink" href="#di-vgp" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch2.html">[Essentials Chapter 2]</a>
<a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#di_vgp.py">[command line version]</a></p>
<p><strong>di_vgp</strong> converts directions (declination,inclination) to Virtual Geomagnetic Pole positions.   This is the inverse of <a class="reference external" href="#vgp_di"><strong>vgp_di</strong></a>.
To do so, we will call <strong>pmag.dia_vgp()</strong> from within the notebook.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">dia_vgp</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function dia_vgp in module pmagpy.pmag:

dia_vgp(*args)
    Converts directional data (declination, inclination, alpha95) at a given
    location (Site latitude, Site longitude) to pole position (pole longitude,
    pole latitude, dp, dm)
    
    Parameters
    ----------
    Takes input as (Dec, Inc, a95, Site latitude, Site longitude)
    Input can be as individual values (5 parameters)
    or
    as a list of lists: [[Dec, Inc, a95, lat, lon],[Dec, Inc, a95, lat, lon]]
    
    Returns
    ----------
    if input is individual values for one pole the return is:
    pole longitude, pole latitude, dp, dm
    
    if input is list of lists the return is:
    list of pole longitudes, list of pole latitude, list of dp, list of dm
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;data_files/di_vgp/di_vgp_example.dat&#39;</span><span class="p">)</span> <span class="c1"># read in some data</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 11.   63.   55.   13. ]
 [154.  -58.   45.5 -73. ]]
</pre></div>
</div>
</div>
</div>
<p>The data are almost in the correct format, but there is no a95 field, so that will have to be inserted (as zeros).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a95</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
<span class="n">a95</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0., 0.])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DIs</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">transpose</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="c1"># get the DIs</span>
<span class="n">LatLons</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">transpose</span><span class="p">()[</span><span class="mi">2</span><span class="p">:]</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="c1"># get the Lat Lons</span>
<span class="n">newdata</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">DIs</span><span class="p">,</span><span class="n">a95</span><span class="p">,</span><span class="n">LatLons</span><span class="p">))</span> <span class="c1"># stitch them back together</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">newdata</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 11.   63.    0.   55.   13. ]
 [154.  -58.    0.   45.5 -73. ]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vgps</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">dia_vgp</span><span class="p">(</span><span class="n">newdata</span><span class="p">))</span> <span class="c1"># get a tuple with lat,lon,dp,dm, convert to array</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">vgps</span><span class="o">.</span><span class="n">transpose</span><span class="p">())</span> <span class="c1">#  print out the vgps</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[154.65869784  77.3180885    0.           0.        ]
 [  6.62978666 -69.63701906   0.           0.        ]]
</pre></div>
</div>
</div>
</div>
</section>
<section id="dipole-pinc">
<h2>dipole_pinc<a class="headerlink" href="#dipole-pinc" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch2.html">[Essentials Chapter 2]</a>
<a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#dipole_pinc.py">[command line version]</a></p>
<p>If we assume a geocentric axial dipole, we can calculate an expected inclination at a given latitude and that is what <strong>dipole_pinc</strong> does.   It calls <strong>pmag.pinc()</strong> and so will we to find the expected inclination at a paleolatitude of 24<span class="math notranslate nohighlight">\(^{\circ}\)</span>S!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">pinc</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function pinc in module pmagpy.pmag:

pinc(lat)
    calculate paleoinclination from latitude using dipole formula: tan(I) = 2tan(lat)
    Parameters
    ________________
    
    lat : either a single value or an array of latitudes
    
    Returns
    -------
    
    array of inclinations
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lat</span><span class="o">=-</span><span class="mi">24</span>
<span class="n">pmag</span><span class="o">.</span><span class="n">pinc</span><span class="p">(</span><span class="o">-</span><span class="mi">24</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-41.68370203503222
</pre></div>
</div>
</div>
</div>
<p>Or as an array</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lats</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="n">incs</span><span class="o">=</span><span class="n">pmag</span><span class="o">.</span><span class="n">pinc</span><span class="p">(</span><span class="n">lats</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">incs</span><span class="p">,</span><span class="n">lats</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="o">-</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Latitude&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Inclination&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/PmagPy_calculations_85_0.png" src="../_images/PmagPy_calculations_85_0.png" />
</div>
</div>
</section>
<section id="dipole-plat">
<h2>dipole_plat<a class="headerlink" href="#dipole-plat" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch2.html">[Essentials Chapter 2]</a>
<a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#dipole_plat.py">[command line version]</a></p>
<p><strong>dipole_plat</strong> is similar to <a class="reference external" href="#dipole_pinc">dipole_pinc</a> but calculates the paleolatitude from the inclination.  We will call <strong>pmag.plat()</strong>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">plat</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function plat in module pmagpy.pmag:

plat(inc)
    calculate paleolatitude from inclination using dipole formula: tan(I) = 2tan(lat)
    Parameters
    ________________
    
    inc : either a single value or an array of inclinations
    
    Returns
    -------
    
    array of latitudes
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">inc</span><span class="o">=</span><span class="mi">42</span>
<span class="n">pmag</span><span class="o">.</span><span class="n">plat</span><span class="p">(</span><span class="n">inc</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>24.237370383549177
</pre></div>
</div>
</div>
</div>
</section>
<section id="dir-cart">
<h2>dir_cart<a class="headerlink" href="#dir-cart" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch2.html#x15-1560002">[Essentials Chapter 2]</a>  <a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#dir_cart.py">[command line version]</a></p>
<p><strong>pmag.dir2cart()</strong> converts directions (Declination, Inclination, Intensity) to cartesian coordinates (X,Y,Z).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">dir2cart</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function dir2cart in module pmagpy.pmag:

dir2cart(d)
    Converts a list or array of vector directions in degrees (declination,
    inclination) to an array of the direction in cartesian coordinates (x,y,z)
    
    Parameters
    ----------
    d : list or array of [dec,inc] or [dec,inc,intensity]
    
    Returns
    -------
    cart : array of [x,y,z]
    
    Examples
    --------
    &gt;&gt;&gt; pmag.dir2cart([200,40,1])
    array([-0.71984631, -0.26200263,  0.64278761])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># read in data file from example file</span>
<span class="n">dirs</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;data_files/dir_cart/dir_cart_example.dat&#39;</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Input: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">dirs</span><span class="p">)</span> <span class="c1"># print out the cartesian coordinates</span>
<span class="c1"># print out the  results</span>
<span class="n">carts</span> <span class="o">=</span> <span class="n">pmag</span><span class="o">.</span><span class="n">dir2cart</span><span class="p">(</span><span class="n">dirs</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Output: &quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">carts</span><span class="p">:</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;</span><span class="si">%8.4e</span><span class="s1"> </span><span class="si">%8.4e</span><span class="s1"> </span><span class="si">%8.4e</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">c</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Input: 
 [[ 20.   46.    1.3]
 [175.  -24.    4.2]]
Output: 
8.4859e-01 3.0886e-01 9.3514e-01
-3.8223e+00 3.3441e-01 -1.7083e+00
</pre></div>
</div>
</div>
</div>
</section>
<section id="eigs-s">
<h2>eigs_s<a class="headerlink" href="#eigs-s" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch13.html#x15-156000813">[Essentials Chapter 13]</a> <a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#eigs_s.py">[command line version]</a></p>
<p>This program converts eigenparameters to the six tensor elements.  This is the inverse of <a class="reference external" href="#s_eigs">s_eigs</a>.
There is a function <strong>ipmag.eigs_s()</strong> which will do this in a notebook:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">ipmag</span><span class="o">.</span><span class="n">eigs_s</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function eigs_s in module pmagpy.ipmag:

eigs_s(infile=&#39;&#39;, dir_path=&#39;.&#39;)
    Converts eigenparamters format data to s format
    
    Parameters
    ___________________
    Input:
        file : input file name with eigenvalues (tau) and eigenvectors (V) with  format:
            tau_1 V1_dec V1_inc tau_2 V2_dec V2_inc tau_3 V3_dec V3_inc
    Output
         the six tensor elements as a nested array
          [[x11,x22,x33,x12,x23,x13],....]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Ss</span><span class="o">=</span><span class="n">ipmag</span><span class="o">.</span><span class="n">eigs_s</span><span class="p">(</span><span class="n">infile</span><span class="o">=</span><span class="s2">&quot;eigs_s_example.dat&quot;</span><span class="p">,</span> <span class="n">dir_path</span><span class="o">=</span><span class="s1">&#39;data_files/eigs_s&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">Ss</span><span class="p">:</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.33416328, 0.33280227, 0.33303446, -0.00016631071, 0.0012316267, 0.0013552071]
[0.33555713, 0.33197427, 0.3324687, 0.00085685047, 0.00025266458, 0.0009815096]
[0.335853, 0.33140355, 0.3327435, 0.0013230764, 0.0011778723, 4.5534102e-06]
[0.3347939, 0.33140817, 0.33379796, -0.0004308845, 0.0004885784, 0.00045610438]
[0.33502916, 0.33117944, 0.3337915, -0.00106313, 0.00029828132, 0.00035882858]
[0.33407047, 0.3322691, 0.33366045, -6.384468e-06, 0.0009844461, 5.9963346e-05]
[0.33486328, 0.33215088, 0.3329859, -0.0003427944, 0.00038177703, 0.0002014497]
[0.33509853, 0.33195898, 0.33294258, 0.000769761, 0.00056717254, 0.00011960149]
</pre></div>
</div>
</div>
</div>
</section>
<section id="eq-di">
<h2>eq_di<a class="headerlink" href="#eq-di" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ap2.html#x21-227000B#x15-156000813">[Essentials Appendix B]</a> <a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#eq_di.py">[command line version]</a></p>
<p>Data are frequently published as equal area projections and not listed in data tables. These data can be digitized as x,y data (assuming the outer rim is unity) and converted to approximate directions with the program <strong>eq_di</strong>. To use this program, install a graph digitizer (GraphClick from <a class="reference external" href="http://www.arizona-software.ch/graphclick/">http://www.arizona-software.ch/graphclick/</a> works on Macs).</p>
<p>Digitize the data from the equal area projection saved in the file eqarea.png in the eq_di directory. You should only work on one hemisphere at a time (upper or lower) and save each hemisphere in its own file. Then you can convert the X,Y data to approximate dec and inc data - the quality of the data depends on your care in digitizing and the quality of the figure that you are digitizing.</p>
<p>Here we will try this out on a datafile already prepared, which are the digitized data from the lower hemisphere of a plot.  You  check your work with <a class="reference external" href="#eqarea">eqarea</a>.</p>
<p>To do this in a notebook, we can use <strong>pmag.doeqdi()</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">doeqdi</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function doeqdi in module pmagpy.pmag:

doeqdi(x, y, UP=False)
    Takes digitized x,y, data and returns the dec,inc, assuming an
    equal area projection
    Parameters
    __________________
        x : array of digitized x from point on equal area projection
        y : array of  igitized y from point on equal area projection
        UP : if True, is an upper hemisphere projection
    Output :
        dec : declination
        inc : inclination
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># read in the data into an array</span>
<span class="c1"># x is assumed first column, y, second</span>
<span class="n">xy</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;data_files/eq_di/eq_di_example.dat&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="n">decs</span><span class="p">,</span><span class="n">incs</span><span class="o">=</span><span class="n">pmag</span><span class="o">.</span><span class="n">doeqdi</span><span class="p">(</span><span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">plot_net</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">plot_di</span><span class="p">(</span><span class="n">dec</span><span class="o">=</span><span class="n">decs</span><span class="p">,</span><span class="n">inc</span><span class="o">=</span><span class="n">incs</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">edge</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/PmagPy_calculations_97_0.png" src="../_images/PmagPy_calculations_97_0.png" />
</div>
</div>
</section>
<section id="fcalc">
<h2>fcalc<a class="headerlink" href="#fcalc" title="Permalink to this headline">#</a></h2>
<p><strong>pmag.fcalc()</strong> returns the values of an F-test from  an F table.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">fcalc</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function fcalc in module pmagpy.pmag:

fcalc(col, row)
    looks up an F-test stastic from F tables F(col,row), where row is number of degrees of freedom - this is 95% confidence (p=0.05).
    
      Parameters
      _________
          col : degrees of freedom column
          row : degrees of freedom row
    
      Returns
          F : value for 95% confidence from the F-table
</pre></div>
</div>
</div>
</div>
</section>
<section id="fisher">
<h2>fisher<a class="headerlink" href="#fisher" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch11.html">[Essentials Chapter 11]</a>
<a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#fisher.py">[command line version]</a></p>
<p><strong>fisher</strong>  draws <span class="math notranslate nohighlight">\(N\)</span>  directions  from a Fisher distribution with specified <span class="math notranslate nohighlight">\(\kappa\)</span> and a vertical mean. (For other directions see <a class="reference external" href="#fishrot">fishrot</a>).  To do this, we can just call the function <strong>pmag.fshdev()</strong> <span class="math notranslate nohighlight">\(N\)</span> times.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">fshdev</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function fshdev in module pmagpy.pmag:

fshdev(k)
    Generate a random draw from a Fisher distribution with mean declination
    of 0 and inclination of 90 with a specified kappa.
    
    Parameters
    ----------
    k : kappa (precision parameter) of the distribution
        k can be a single number or an array of values
    
    Returns
    ----------
    dec, inc : declination and inclination of random Fisher distribution draw
               if k is an array, dec, inc are returned as arrays, otherwise, single values
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># set the number, N, and kappa</span>
<span class="n">N</span><span class="p">,</span><span class="n">kappa</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="mi">20</span>
<span class="c1"># a basket to put our fish in</span>
<span class="n">fish</span><span class="o">=</span><span class="p">[]</span>
<span class="c1"># get the Fisherian deviates</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="n">d</span><span class="p">,</span><span class="n">i</span><span class="o">=</span><span class="n">pmag</span><span class="o">.</span><span class="n">fshdev</span><span class="p">(</span><span class="n">kappa</span><span class="p">)</span>
    <span class="n">fish</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">d</span><span class="p">,</span><span class="n">i</span><span class="p">])</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">plot_net</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">plot_di</span><span class="p">(</span><span class="n">di_block</span><span class="o">=</span><span class="n">fish</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">edge</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/PmagPy_calculations_102_0.png" src="../_images/PmagPy_calculations_102_0.png" />
</div>
</div>
</section>
<section id="fishrot">
<h2>fishrot<a class="headerlink" href="#fishrot" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch11.html">[Essentials Chapter 11]</a>
<a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#fishrot.py">[command line version]</a></p>
<p>This program is similar to <a class="reference external" href="#fisher">fisher</a>, but allows you to specify the mean direction.
This has been implemented as <strong>ipmag.fishrot()</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">ipmag</span><span class="o">.</span><span class="n">fishrot</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function fishrot in module pmagpy.ipmag:

fishrot(k=20, n=100, dec=0, inc=90, di_block=True)
    Generates Fisher distributed unit vectors from a specified distribution
    using the pmag.py fshdev and dodirot functions.
    
    Parameters
    ----------
    k : kappa precision parameter (default is 20)
    n : number of vectors to determine (default is 100)
    dec : mean declination of distribution (default is 0)
    inc : mean inclination of distribution (default is 90)
    di_block : this function returns a nested list of [dec,inc,1.0] as the default
    if di_block = False it will return a list of dec and a list of inc
    
    Returns
    ---------
    di_block : a nested list of [dec,inc,1.0] (default)
    dec, inc : a list of dec and a list of inc (if di_block = False)
    
    Examples
    --------
    &gt;&gt;&gt; ipmag.fishrot(k=20, n=5, dec=40, inc=60)
    [[44.766285502555775, 37.440866867657235, 1.0],
     [33.866315796883725, 64.732532250463436, 1.0],
     [47.002912770597163, 54.317853800896977, 1.0],
     [36.762165614432547, 56.857240672884252, 1.0],
     [71.43950604474395, 59.825830945715431, 1.0]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rotdi</span><span class="o">=</span><span class="n">ipmag</span><span class="o">.</span><span class="n">fishrot</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">dec</span><span class="o">=</span><span class="mi">33</span><span class="p">,</span><span class="n">inc</span><span class="o">=</span><span class="mi">41</span><span class="p">)</span>
<span class="k">for</span> <span class="n">di</span> <span class="ow">in</span> <span class="n">rotdi</span><span class="p">:</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;</span><span class="si">%7.1f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">di</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">di</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   35.1    45.9
   47.4    20.6
   20.2    34.6
   48.9    28.6
   33.1    34.2
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ipmag</span><span class="o">.</span><span class="n">plot_net</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">plot_di</span><span class="p">(</span><span class="n">di_block</span><span class="o">=</span><span class="n">rotdi</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/PmagPy_calculations_106_0.png" src="../_images/PmagPy_calculations_106_0.png" />
</div>
</div>
</section>
<section id="flip">
<h2>flip<a class="headerlink" href="#flip" title="Permalink to this headline">#</a></h2>
<p>Fisher statistics requires unimodal data (all in one direction with no reversals) but many paleomagnetic data sets are bimodal.  To flip bimodal data into a single mode, we can use <strong>pmag.flip( )</strong>.  This function calculates the principle direction and flips all the ‘reverse’ data to the ‘normal’ direction along the principle axis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">flip</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function flip in module pmagpy.pmag:

flip(di_block, combine=False)
    determines &#39;normal&#39; direction along the principle eigenvector, then flips the antipodes of
    the reverse mode to the antipode
    
    Parameters
    ___________
    di_block : nested list of directions
    Return
    D1 : normal mode
    D2 : flipped reverse mode as two DI blocks
    combine : if True return combined D1, D2, nested D,I pairs
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#read in the data into an array</span>
<span class="n">vectors</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;data_files/eqarea_ell/tk03.out&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="n">di_block</span><span class="o">=</span><span class="n">vectors</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="c1"># decs are di_block[0], incs are di_block[1]</span>
<span class="c1"># flip the reverse directions to their normal antipodes</span>
<span class="n">normal</span><span class="p">,</span><span class="n">flipped</span><span class="o">=</span><span class="n">pmag</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">di_block</span><span class="p">)</span>
<span class="c1"># and plot them up</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">plot_net</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">plot_di</span><span class="p">(</span><span class="n">di_block</span><span class="o">=</span><span class="n">di_block</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">plot_di</span><span class="p">(</span><span class="n">di_block</span><span class="o">=</span><span class="n">flipped</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/PmagPy_calculations_109_0.png" src="../_images/PmagPy_calculations_109_0.png" />
</div>
</div>
</section>
<section id="gaussian">
<h2>gaussian<a class="headerlink" href="#gaussian" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch11.html">[Essentials Chapter 11]</a>
<a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#gaussian.py">[command line version]</a></p>
<p>This program generates sets of data drawn from a normal distribution with a given mean and standard deviation.  It is just a wrapper for a call to  <strong>pmag.gaussdev()</strong> which just calls <strong>numpy.random.normal()</strong> which we could do, but we would have to import it, so it is easiest just to call the <strong>pmag</strong> version which we have already imported.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">gaussdev</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function gaussdev in module pmagpy.pmag:

gaussdev(mean, sigma, N=1)
        returns a number randomly drawn from a gaussian distribution with the given mean, sigma
        Parmeters:
        _____________________________
        mean : mean of the gaussian distribution from which to draw deviates
        sigma : standard deviation of same
        N : number of deviates desired
    
        Returns
        -------
    
        N deviates from the normal distribution from
    .
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span><span class="o">=</span><span class="mi">1000</span>
<span class="n">bins</span><span class="o">=</span><span class="mi">100</span>
<span class="n">norm</span><span class="o">=</span><span class="n">pmag</span><span class="o">.</span><span class="n">gaussdev</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">norm</span><span class="p">,</span><span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;step&#39;</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Gaussian Deviates&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/PmagPy_calculations_112_0.png" src="../_images/PmagPy_calculations_112_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># alternatively we can plot with ipmag.histplot:</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span> <span class="n">xlab</span><span class="o">=</span><span class="s1">&#39;Gaussian Deviates&#39;</span><span class="p">,</span> <span class="n">save_plots</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">norm</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/PmagPy_calculations_113_0.png" src="../_images/PmagPy_calculations_113_0.png" />
</div>
</div>
</section>
<section id="gobing">
<h2>gobing<a class="headerlink" href="#gobing" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch12.html">[Essentials Chapter 12]</a>
<a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#gobing.py">[command line version]</a></p>
<p><strong>gobing</strong> calculates Bingham statistics for sets of directional data (see the section for eqarea_ell in the PmagPy_plots_analysis documentation for nice examples).  We do this by calling <strong>pmag.dobingham()</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">dobingham</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function dobingham in module pmagpy.pmag:

dobingham(di_block)
    Calculates the Bingham mean and associated statistical parameters from
    directions that are input as a di_block
    
    Parameters
    ----------
    di_block : a nested list of [dec,inc] or [dec,inc,intensity]
    
    Returns
    -------
    bpars : dictionary containing the Bingham mean and associated statistics
    dictionary keys
        dec : mean declination
        inc : mean inclination
        n : number of datapoints
        Eta : major ellipse
        Edec : declination of major ellipse axis
        Einc : inclination of major ellipse axis
        Zeta : minor ellipse
        Zdec : declination of minor ellipse axis
        Zinc : inclination of minor ellipse axis
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">di_block</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;data_files/gobing/gobing_example.txt&#39;</span><span class="p">)</span>
<span class="n">pmag</span><span class="o">.</span><span class="n">dobingham</span><span class="p">(</span><span class="n">di_block</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;dec&#39;: 357.77952733337463,
 &#39;inc&#39;: 60.3168380083183,
 &#39;Edec&#39;: 105.71735145158095,
 &#39;Einc&#39;: 9.956900268236785,
 &#39;Zdec&#39;: 20.99389065755772,
 &#39;Zinc&#39;: -27.647853556651516,
 &#39;n&#39;: 20,
 &#39;Zeta&#39;: 4.480026907803641,
 &#39;Eta&#39;: 4.4907543191720025}
</pre></div>
</div>
</div>
</div>
</section>
<section id="gofish">
<h2>gofish<a class="headerlink" href="#gofish" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch11.html">[Essentials Chapter 11]</a>
<a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#gofish.py">[command line version]</a></p>
<p><strong>gofish</strong> calculates Fisher statistics for sets of directional data.  (see the section for eqarea_ell in the PmagPy_plots_analysis documentation for nice examples).
This can be done with <strong>ipmag.fisher_mean()</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">ipmag</span><span class="o">.</span><span class="n">fisher_mean</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function fisher_mean in module pmagpy.ipmag:

fisher_mean(dec=None, inc=None, di_block=None)
    Calculates the Fisher mean and associated parameters from either a list of
    declination values and a separate list of inclination values or from a
    di_block (a nested list a nested list of [dec,inc,1.0]). Returns a
    dictionary with the Fisher mean and statistical parameters.
    
    Parameters
    ----------
    dec : list of declinations or longitudes
    inc : list of inclinations or latitudes
    di_block : a nested list of [dec,inc,1.0]
        A di_block can be provided instead of dec, inc lists in which case it
        will be used. Either dec, inc lists or a di_block need to be provided.
    
    Returns
    -------
    fisher_mean : dictionary containing the Fisher mean parameters
    
    Examples
    --------
    Use lists of declination and inclination to calculate a Fisher mean:
    
    &gt;&gt;&gt; ipmag.fisher_mean(dec=[140,127,142,136],inc=[21,23,19,22])
    {&#39;alpha95&#39;: 7.292891411309177,
    &#39;csd&#39;: 6.4097743211340896,
    &#39;dec&#39;: 136.30838974272072,
    &#39;inc&#39;: 21.347784026899987,
    &#39;k&#39;: 159.69251473636305,
    &#39;n&#39;: 4,
    &#39;r&#39;: 3.9812138971889026}
    
    Use a di_block to calculate a Fisher mean (will give the same output as the
    example with the lists):
    
    &gt;&gt;&gt; ipmag.fisher_mean(di_block=[[140,21],[127,23],[142,19],[136,22]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">di_block</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;data_files/gofish/fishrot.out&#39;</span><span class="p">)</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">fisher_mean</span><span class="p">(</span><span class="n">di_block</span><span class="o">=</span><span class="n">di_block</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;dec&#39;: 10.783552984917437,
 &#39;inc&#39;: 39.602582993520244,
 &#39;n&#39;: 10,
 &#39;r&#39;: 9.848433230859508,
 &#39;k&#39;: 59.379770717798884,
 &#39;alpha95&#39;: 6.320446730051139,
 &#39;csd&#39;: 10.511525802823254}
</pre></div>
</div>
</div>
</div>
<section id="fisher-mean-on-pandas-dataframes">
<h3>fisher mean on pandas DataFrames<a class="headerlink" href="#fisher-mean-on-pandas-dataframes" title="Permalink to this headline">#</a></h3>
<p>There is also a function <strong>pmag.dir_df_fisher_mean()</strong> that calculates Fisher statistics on a Pandas DataFrame with directional data</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">dir_df_fisher_mean</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function dir_df_fisher_mean in module pmagpy.pmag:

dir_df_fisher_mean(dir_df)
    calculates fisher mean for Pandas data frame
    
    Parameters
    __________
    dir_df: pandas data frame with columns:
        dir_dec : declination
        dir_inc : inclination
    Returns
    -------
    fpars : dictionary containing the Fisher mean and statistics
        dec : mean declination
        inc : mean inclination
        r : resultant vector length
        n : number of data points
        k : Fisher k value
        csd : Fisher circular standard deviation
        alpha95 : Fisher circle of 95% confidence
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># make the data frame</span>
<span class="n">dir_df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data_files/gofish/fishrot.out&#39;</span><span class="p">,</span><span class="n">delim_whitespace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">dir_df</span><span class="o">.</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;dir_dec&#39;</span><span class="p">,</span><span class="s1">&#39;dir_inc&#39;</span><span class="p">]</span>
<span class="n">pmag</span><span class="o">.</span><span class="n">dir_df_fisher_mean</span><span class="p">(</span><span class="n">dir_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;dec&#39;: 10.78355298491744,
 &#39;inc&#39;: 39.60258299352024,
 &#39;n&#39;: 10,
 &#39;r&#39;: 9.848433230859508,
 &#39;k&#39;: 59.379770717798884,
 &#39;alpha95&#39;: 6.320446730051139,
 &#39;csd&#39;: 10.511525802823254}
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="gokent">
<h2>gokent<a class="headerlink" href="#gokent" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch12.html">[Essentials Chapter 12]</a>
<a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#gokent.py">[command line version]</a></p>
<p>With <strong>gokent</strong> we can calculate Kent statistics on sets of directional data (see the section for eqarea_ell in the PmagPy_plots_analysis documentation for nice examples).</p>
<p>This calls <strong>pmag.dokent()</strong> (see also <strong>eqarea_ell</strong> example)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">dokent</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function dokent in module pmagpy.pmag:

dokent(data, NN)
    gets Kent  parameters for data
    Parameters
    ___________________
    data :  nested pairs of [Dec,Inc]
    NN  : normalization
        NN is the number of data for Kent ellipse
        NN is 1 for Kent ellipses of bootstrapped mean directions
    
    Return
    kpars dictionary keys
        dec : mean declination
        inc : mean inclination
        n : number of datapoints
        Eta : major ellipse
        Edec : declination of major ellipse axis
        Einc : inclination of major ellipse axis
        Zeta : minor ellipse
        Zdec : declination of minor ellipse axis
        Zinc : inclination of minor ellipse axis
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">di_block</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;data_files/gokent/gokent_example.txt&#39;</span><span class="p">)</span>
<span class="n">pmag</span><span class="o">.</span><span class="n">dokent</span><span class="p">(</span><span class="n">di_block</span><span class="p">,</span><span class="n">di_block</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;dec&#39;: 359.1530456710398,
 &#39;inc&#39;: 55.03341554254794,
 &#39;n&#39;: 20,
 &#39;Zdec&#39;: 246.82080930796928,
 &#39;Zinc&#39;: 14.881429411175574,
 &#39;Edec&#39;: 147.69921287231705,
 &#39;Einc&#39;: 30.819395154843157,
 &#39;Zeta&#39;: 7.805151237185049,
 &#39;Eta&#39;: 9.304659303299626}
</pre></div>
</div>
</div>
</div>
</section>
<section id="goprinc">
<h2>goprinc<a class="headerlink" href="#goprinc" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch12.html">[Essentials Chapter 12]</a>
<a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#goprinc.py">[command line version]</a></p>
<p><strong>goprinc</strong> calculates the principal directions (and their eigenvalues) for sets of paleomagnetic vectors.  It doesn’t do any statistics on them, unlike the other programs.
We will call <strong>pmag.doprinc()</strong>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">doprinc</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function doprinc in module pmagpy.pmag:

doprinc(data)
    Gets principal components from data in form of a list of [dec,inc] data.
    
    Parameters
    ----------
    data : nested list of dec, inc directions
    
    Returns
    -------
    ppars : dictionary with the principal components
        dec : principal directiion declination
        inc : principal direction inclination
        V2dec : intermediate eigenvector declination
        V2inc : intermediate eigenvector inclination
        V3dec : minor eigenvector declination
        V3inc : minor eigenvector inclination
        tau1 : major eigenvalue
        tau2 : intermediate eigenvalue
        tau3 : minor eigenvalue
        N  : number of points
        Edir : elongation direction [dec, inc, length]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">di_block</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;data_files/goprinc/goprinc_example.txt&#39;</span><span class="p">)</span>
<span class="n">pmag</span><span class="o">.</span><span class="n">doprinc</span><span class="p">(</span><span class="n">di_block</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;Edir&#39;: array([151.85261736,  29.07891169,   1.        ]),
 &#39;dec&#39;: 3.869443846664467,
 &#39;inc&#39;: 56.740159941913355,
 &#39;N&#39;: 20,
 &#39;tau1&#39;: 0.8778314142896239,
 &#39;tau2&#39;: 0.07124540042876253,
 &#39;tau3&#39;: 0.05092318528161358,
 &#39;V2dec&#39;: 151.85261735984162,
 &#39;V2inc&#39;: 29.078911691227447,
 &#39;V3dec&#39;: 250.25426093396385,
 &#39;V3inc&#39;: 14.721055437689328}
</pre></div>
</div>
</div>
</div>
</section>
<section id="igrf">
<h2>igrf<a class="headerlink" href="#igrf" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch2.html">[Essentials Chapter 2]</a>
<a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#igrf.py">[command line version]</a></p>
<p>This program gives geomagnetic field vector data for a specified place at a specified time.  It has many built in models including  IGRFs, GUFM and several archeomagnetic models.   It calls the  function <strong>ipmag.igrf()</strong> for this so that is what we will do.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">ipmag</span><span class="o">.</span><span class="n">igrf</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function igrf in module pmagpy.ipmag:

igrf(input_list, mod=&#39;&#39;, ghfile=&#39;&#39;)
    Determine Declination, Inclination and Intensity from the IGRF model.
    (http://www.ngdc.noaa.gov/IAGA/vmod/igrf.html)
    
    Parameters
    ----------
    input_list : list with format [Date, Altitude, Latitude, Longitude]
        date must be in decimal year format XXXX.XXXX (Common Era)
        altitude is in kilometers
    mod :  desired model
        &quot;&quot; : Use the IGRF
        custom : use values supplied in ghfile
        or choose from this list
        [&#39;arch3k&#39;,&#39;cals3k&#39;,&#39;pfm9k&#39;,&#39;hfm10k&#39;,&#39;cals10k.2&#39;,&#39;cals10k.1b&#39;]
        where:
            arch3k (Korte et al., 2009)
            cals3k (Korte and Constable, 2011)
            cals10k.1b (Korte et al., 2011)
            pfm9k  (Nilsson et al., 2014)
            hfm10k is the hfm.OL1.A1 of Constable et al. (2016)
            cals10k.2 (Constable et al., 2016)
            the first four of these models, are constrained to agree
            with gufm1 (Jackson et al., 2000) for the past four centuries
    
    
    gh : path to file with l m g h data
    
    Returns
    -------
    igrf_array : array of IGRF values (0: dec; 1: inc; 2: intensity (in nT))
    
    Examples
    --------
    &gt;&gt;&gt; local_field = ipmag.igrf([2013.6544, .052, 37.87, -122.27])
    &gt;&gt;&gt; local_field
    array([  1.39489916e+01,   6.13532008e+01,   4.87452644e+04])
    &gt;&gt;&gt; ipmag.igrf_print(local_field)
    Declination: 13.949
    Inclination: 61.353
    Intensity: 48745.264 nT
</pre></div>
</div>
</div>
</div>
<p>We will calculate the field for San Diego from 3000 BCE to 1950 in 50 year increments using the hfm.OL1.A1 model of Constable et al. (2016, doi: 10.1016/j.epsl.2016.08.015).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># make a list of desired dates</span>
<span class="n">dates</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">3000</span><span class="p">,</span><span class="mi">1950</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span> <span class="c1"># list of dates in +/- Common Era</span>
<span class="n">mod</span> <span class="o">=</span> <span class="s1">&#39;hfm10k&#39;</span> <span class="c1"># choose the desired model</span>
<span class="n">lat</span><span class="p">,</span><span class="n">lon</span><span class="p">,</span><span class="n">alt</span><span class="o">=</span><span class="mi">33</span><span class="p">,</span><span class="o">-</span><span class="mi">117</span><span class="p">,</span><span class="mi">0</span> <span class="c1"># desired latitude, longitude and alitude</span>
<span class="n">Vecs</span><span class="o">=</span><span class="p">[]</span> <span class="c1"># list for Dec,Inc,Int outputs</span>
<span class="k">for</span> <span class="n">date</span> <span class="ow">in</span> <span class="n">dates</span><span class="p">:</span> <span class="c1"># step through the dates</span>
    <span class="n">Vecs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ipmag</span><span class="o">.</span><span class="n">igrf</span><span class="p">([</span><span class="n">date</span><span class="p">,</span><span class="n">alt</span><span class="p">,</span><span class="n">lat</span><span class="p">,</span><span class="n">lon</span><span class="p">],</span><span class="n">mod</span><span class="o">=</span><span class="n">mod</span><span class="p">))</span> <span class="c1"># append to list</span>
<span class="n">vector_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">Vecs</span><span class="p">)</span>   <span class="c1"># make it into a Pandas dataframe</span>
<span class="n">vector_df</span><span class="o">.</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">,</span><span class="s1">&#39;inc&#39;</span><span class="p">,</span><span class="s1">&#39;int&#39;</span><span class="p">]</span>
<span class="n">vector_df</span><span class="p">[</span><span class="s1">&#39;vadms&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">pmag</span><span class="o">.</span><span class="n">b_vdm</span><span class="p">(</span><span class="n">vector_df</span><span class="o">.</span><span class="n">int</span><span class="o">.</span><span class="n">values</span><span class="o">*</span><span class="mf">1e-9</span><span class="p">,</span> <span class="n">lat</span><span class="p">)</span> <span class="c1"># calculate the VADMs</span>
<span class="n">vector_df</span><span class="p">[</span><span class="s1">&#39;dec_adj&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">vector_df</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">]</span> 
<span class="n">vector_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">vector_df</span><span class="o">.</span><span class="n">dec</span><span class="o">&gt;</span><span class="mi">180</span><span class="p">,[</span><span class="s1">&#39;dec_adj&#39;</span><span class="p">]]</span><span class="o">=</span><span class="n">vector_df</span><span class="o">.</span><span class="n">dec</span><span class="o">-</span><span class="mi">360</span> <span class="c1"># adjust declinations to be -180 =&gt; 180</span>
<span class="n">fig</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">9</span><span class="p">))</span> <span class="c1"># set up the figure</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">411</span><span class="p">)</span> <span class="c1"># make 4 rows of plots, this is the first</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dates</span><span class="p">,</span><span class="n">vector_df</span><span class="o">.</span><span class="n">dec_adj</span><span class="p">)</span> <span class="c1"># plot the adjusted declinations</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Declination ($^{\circ}$)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Geomagnetic field evaluated at Lat: &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">lat</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; / Lon: &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">lon</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">412</span><span class="p">)</span> <span class="c1"># this is the second</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dates</span><span class="p">,</span><span class="n">vector_df</span><span class="o">.</span><span class="n">inc</span><span class="p">)</span> <span class="c1"># plot  the inclinations</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Inclination ($^{\circ}$)&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">413</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dates</span><span class="p">,</span><span class="n">vector_df</span><span class="o">.</span><span class="n">int</span><span class="o">*</span><span class="mf">1e-3</span><span class="p">)</span> <span class="c1"># plot the intensites (in uT instead of nT)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Intensity ($\mu$T)&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">414</span><span class="p">)</span> <span class="c1"># plot the VADMs </span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dates</span><span class="p">,</span><span class="n">vector_df</span><span class="o">.</span><span class="n">vadms</span><span class="o">*</span><span class="mf">1e-21</span><span class="p">)</span> <span class="c1"># plot as ZAm^2</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;VADM (ZAm$^2$)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Dates (CE)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/PmagPy_calculations_132_0.png" src="../_images/PmagPy_calculations_132_0.png" />
</div>
</div>
</section>
<section id="incfish">
<h2>incfish<a class="headerlink" href="#incfish" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch11.html">[Essentials Chapter 11]</a>
<a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#incfish.py">[command line version]</a></p>
<p>You can’t get a meaningful average inclination from inclination only data because of the exponential relationship between inclinations and the true mean inclination for Fisher distributions (except exactly at the pole and the equator).  So, McFadden and Reid (1982, doi:  10.1111/j.1365-246X.1982.tb04950.x) developed a maximum liklihood estimate for getting an estimate for true mean absent declination.   <strong>pmag.doincfish()</strong> is an implementation of that concept.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">doincfish</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function doincfish in module pmagpy.pmag:

doincfish(inc)
    gets fisher mean inc from inc only data
    input: list of inclination values
    output: dictionary of
        &#39;n&#39; : number of inclination values supplied
        &#39;ginc&#39; : gaussian mean of inclinations
        &#39;inc&#39; : estimated Fisher mean
        &#39;r&#39; : estimated Fisher R value
        &#39;k&#39; : estimated Fisher kappa
        &#39;alpha95&#39; : estimated fisher alpha_95
        &#39;csd&#39; : estimated circular standard deviation
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">incs</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;data_files/incfish/incfish_example_inc.dat&#39;</span><span class="p">)</span>
<span class="n">pmag</span><span class="o">.</span><span class="n">doincfish</span><span class="p">(</span><span class="n">incs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;n&#39;: 100,
 &#39;ginc&#39;: 57.135000000000005,
 &#39;inc&#39;: 61.024999999999764,
 &#39;r&#39;: 92.8908144677846,
 &#39;k&#39;: 13.925645849497057,
 &#39;alpha95&#39;: 0.9966295962964244,
 &#39;csd&#39;: 21.70587740469687}
</pre></div>
</div>
</div>
</div>
</section>
<section id="pca">
<h2>pca<a class="headerlink" href="#pca" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch11.html">[Essentials Chapter 11]</a> <a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#pca.py">[command line version]</a></p>
<p><strong>pca</strong>  calculates best-fit lines, planes or Fisher means through selected treatment steps along with Kirschvink (1980, doi:  10.1111/j.1365-246X.1980.tb02601.x) MAD values. The file format is a simple space delimited file with specimen name, treatment step, intensity, declination and inclination. <strong><a class="reference external" href="http://pca.py">pca.py</a></strong>  calls <strong>pmag.domean()</strong>, so that is what we will do here.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">domean</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function domean in module pmagpy.pmag:

domean(data, start, end, calculation_type)
    Gets average direction using Fisher or principal component analysis (line
    or plane) methods
    
    Parameters
    ----------
    data : nest list of data: [[treatment,dec,inc,int,quality],...]
    start : step being used as start of fit (often temperature minimum)
    end : step being used as end of fit (often temperature maximum)
    calculation_type : string describing type of calculation to be made
    &#39;DE-BFL&#39; (line), &#39;DE-BFL-A&#39; (line-anchored), &#39;DE-BFL-O&#39; (line-with-origin),
    &#39;DE-BFP&#39; (plane), &#39;DE-FM&#39; (Fisher mean)
    
    Returns
    -------
    mpars : dictionary with the keys &quot;specimen_n&quot;,&quot;measurement_step_min&quot;,
    &quot;measurement_step_max&quot;,&quot;specimen_mad&quot;,&quot;specimen_dec&quot;,&quot;specimen_inc&quot;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># read in data as space delimited file</span>
<span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data_files/pca/pca_example.txt&#39;</span><span class="p">,</span>\
                 <span class="n">delim_whitespace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="c1"># we need to add a column for quality</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;quality&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;g&#39;</span>
<span class="c1"># strip off the specimen name and reorder records </span>
<span class="c1">#  from:  int,dec,inc to: dec,inc,int </span>
<span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;quality&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">pmag</span><span class="o">.</span><span class="n">domean</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="s1">&#39;DE-BFL&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;calculation_type&#39;: &#39;DE-BFL&#39;,
 &#39;center_of_mass&#39;: [1.9347888195464598e-05,
  -2.1736620227095438e-05,
  2.5042313896882542e-05],
 &#39;specimen_direction_type&#39;: &#39;l&#39;,
 &#39;specimen_dec&#39;: 334.9058336155927,
 &#39;specimen_inc&#39;: 51.50973235790523,
 &#39;specimen_mad&#39;: 8.75370050160012,
 &#39;specimen_n&#39;: 10,
 &#39;specimen_dang&#39;: 19.257783100769142,
 &#39;measurement_step_min&#39;: 2.5,
 &#39;measurement_step_max&#39;: 70.0}
</pre></div>
</div>
</div>
</div>
</section>
<section id="pt-rot">
<h2>pt_rot<a class="headerlink" href="#pt-rot" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch16.html">[Essentials Chapter 16]</a>
<a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ap1.html">[Essentials Appendix A.3.5]</a>
<a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#pt_rot.py">[command line version]</a></p>
<p>This program finds rotation poles  for a specified location, age and destination plate, then rotates the point into the destination plate coordinates using the roations and methods described in Essentials Appendix A.3.5.<br />
This can be done for you using the function <strong>frp.get_pole()</strong> in the finite rotation pole module called <strong>pmagpy.frp</strong>. You then call <strong>pmag.pt_rot()</strong> to do the rotation.  Let’s do this for to rotate the Cretaceous poles from Europe (sane data as in the polemap_magic example) and rotate them to South African coordinates.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># need to load this special module</span>
<span class="kn">import</span> <span class="nn">pmagpy.frp</span> <span class="k">as</span> <span class="nn">frp</span>
<span class="n">help</span><span class="p">(</span><span class="n">frp</span><span class="o">.</span><span class="n">get_pole</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function get_pole in module pmagpy.frp:

get_pole(continent, age)
    returns rotation poles and angles for specified continents and ages
    assumes fixed Africa.  
    Parameters
    __________
        continent : 
            aus : Australia
            eur : Eurasia
            mad : Madacascar
            [nwaf,congo] : NW Africa  [choose one]
            col :  Colombia
            grn : Greenland
            nam : North America
            par : Paraguay
            eant :  East Antarctica
            ind : India
            [neaf,kala] : NE Africa [choose one]
            [sac,sam] :  South America [choose one]
            ib : Iberia
            saf : South Africa
      Returns
      _______
          [pole longitude, pole latitude, rotation angle] : for the continent at specified age
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Prot</span><span class="o">=</span><span class="n">frp</span><span class="o">.</span><span class="n">get_pole</span><span class="p">(</span><span class="s1">&#39;eur&#39;</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">Prot</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[40.2, -12.5, 28.5]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">pt_rot</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function pt_rot in module pmagpy.pmag:

pt_rot(EP, Lats, Lons)
    Rotates points on a globe by an Euler pole rotation using method of
    Cox and Hart 1986, box 7-3.
    
    Parameters
    ----------
    EP : Euler pole list [lat,lon,angle]
    Lats : list of latitudes of points to be rotated
    Lons : list of longitudes of points to be rotated
    
    Returns
    _________
    RLats : rotated latitudes
    RLons : rotated longitudes
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data_files/polemap_magic/locations.txt&#39;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">lats</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;pole_lat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">lons</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;pole_lon&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">RLats</span><span class="p">,</span><span class="n">RLons</span><span class="o">=</span><span class="n">rot_pts</span><span class="o">=</span><span class="n">pmag</span><span class="o">.</span><span class="n">pt_rot</span><span class="p">(</span><span class="n">Prot</span><span class="p">,</span><span class="n">lats</span><span class="p">,</span><span class="n">lons</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>And now we can plot them using <strong>pmagplotlib.plot_map()</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Opts</span><span class="o">=</span><span class="p">{}</span>
<span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;sym&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;wo&#39;</span> <span class="c1"># sets the symbol</span>
<span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;symsize&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">10</span>
<span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;proj&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;ortho&#39;</span>
<span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;edge&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;black&#39;</span>
<span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;lat_0&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">90</span>
<span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;details&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">{}</span>
<span class="n">Opts</span><span class="p">[</span><span class="s1">&#39;details&#39;</span><span class="p">][</span><span class="s1">&#39;fancy&#39;</span><span class="p">]</span><span class="o">=</span><span class="kc">True</span> <span class="c1"># warning : this option takes a few minutes</span>
<span class="k">if</span> <span class="n">has_cartopy</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,(</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span> <span class="c1"># optional - make a map</span>
    <span class="n">pmagplotlib</span><span class="o">.</span><span class="n">plot_map</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">RLats</span><span class="p">,</span> <span class="n">RLons</span><span class="p">,</span> <span class="n">Opts</span><span class="p">)</span>
<span class="k">elif</span> <span class="n">has_basemap</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,(</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span> <span class="c1"># optional - make a map</span>
    <span class="n">pmagplotlib</span><span class="o">.</span><span class="n">plot_map_basemap</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">RLats</span><span class="p">,</span> <span class="n">RLons</span><span class="p">,</span> <span class="n">Opts</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>gridlines only supported for PlateCarree, Lambert Conformal, and Mercator plots currently
</pre></div>
</div>
<img alt="../_images/PmagPy_calculations_145_1.png" src="../_images/PmagPy_calculations_145_1.png" />
</div>
</div>
</section>
<section id="s-eigs">
<h2>s_eigs<a class="headerlink" href="#s-eigs" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch13.html#x15-156000813">[Essentials Chapter 13]</a> <a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#s_eigs.py">[command line version]</a></p>
<p>This program converts  the six tensor elements to eigenparameters - the inverse of <a class="reference external" href="#eigs_s">eigs_s</a>.<br />
We can call the function <strong>pmag.doseigs()</strong> from the notebook.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">doseigs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function doseigs in module pmagpy.pmag:

doseigs(s)
    convert s format for eigenvalues and eigenvectors
    
    Parameters
    __________
    s=[x11,x22,x33,x12,x23,x13] : the six tensor elements
    
    Return
    __________
        tau : [t1,t2,t3]
           tau is an list of eigenvalues in decreasing order:
        V : [[V1_dec,V1_inc],[V2_dec,V2_inc],[V3_dec,V3_inc]]
            is an list of the eigenvector directions
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Ss</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;data_files/s_eigs/s_eigs_example.dat&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">Ss</span><span class="p">:</span>
    <span class="n">tau</span><span class="p">,</span><span class="n">V</span><span class="o">=</span><span class="n">pmag</span><span class="o">.</span><span class="n">doseigs</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;</span><span class="si">%f</span><span class="s1"> </span><span class="si">%8.2f</span><span class="s1"> </span><span class="si">%8.2f</span><span class="s1"> </span><span class="si">%f</span><span class="s1"> </span><span class="si">%8.2f</span><span class="s1"> </span><span class="si">%8.2f</span><span class="s1"> </span><span class="si">%f</span><span class="s1"> </span><span class="si">%8.2f</span><span class="s1"> </span><span class="si">%8.2f</span><span class="s1">&#39;</span><span class="o">%</span>\
           <span class="p">(</span><span class="n">tau</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">V</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">V</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">tau</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">V</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">V</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">tau</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">V</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">V</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.331272   239.53    44.70 0.333513   126.62    21.47 0.335215    19.03    37.54
0.331779   281.12     6.18 0.332183   169.79    73.43 0.336039    12.82    15.32
0.330470   283.57    27.30 0.333283   118.37    61.91 0.336247    16.75     6.13
0.331238   261.36    12.07 0.333776   141.40    66.82 0.334986   355.70    19.48
0.330857   255.71     7.13 0.333792   130.85    77.65 0.335352   346.97    10.03
0.331759   268.51    26.79 0.334050   169.66    16.95 0.334190    51.04    57.53
0.331950   261.59    20.68 0.333133    92.18    68.99 0.334917   352.93     3.54
0.331576   281.42    21.32 0.333121   117.04    67.94 0.335303    13.54     5.41
</pre></div>
</div>
</div>
</div>
</section>
<section id="s-geo">
<h2>s_geo<a class="headerlink" href="#s-geo" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch13.html#x15-156000813">[Essentials Chapter 13]</a> <a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#s_geo.py">[command line version]</a></p>
<p><strong>s_geo</strong> takes the 6 tensor elements in specimen coordinates and applies the rotation similar to <a class="reference external" href="#di_geo"><strong>di_geo</strong></a>.  To do this we will call <strong>pmag.dosgeo()</strong> from within the notebook.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">dosgeo</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function dosgeo in module pmagpy.pmag:

dosgeo(s, az, pl)
    rotates  matrix a to az,pl returns  s
    Parameters
    __________
    s : [x11,x22,x33,x12,x23,x13] - the six tensor elements
    az : the azimuth of the specimen X direction
    pl : the plunge (inclination) of the specimen X direction
    
    Return
    s_rot : [x11,x22,x33,x12,x23,x13] - after rotation
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Ss</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;data_files/s_geo/s_geo_example.dat&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">Ss</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">dosgeo</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">7</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[ 3.3412680e-01  3.3282733e-01  3.3304587e-01 -1.5288725e-04
  1.2484333e-03  1.3572115e-03]
[3.3556300e-01 3.3198264e-01 3.3245432e-01 8.7258930e-04 2.4140846e-04
 9.6166186e-04]
[3.3584908e-01 3.3140627e-01 3.3274469e-01 1.3184461e-03 1.1881561e-03
 2.9863901e-05]
[ 0.33479756  0.3314253   0.3337772  -0.00047493  0.00049539  0.00044303]
[ 3.3505613e-01  3.3114848e-01  3.3379540e-01 -1.0137478e-03
  2.8535718e-04  3.4851654e-04]
[ 3.3406156e-01  3.3226916e-01  3.3366925e-01 -2.2665596e-05
  9.8547747e-04  5.5531069e-05]
[ 3.3486596e-01  3.3216032e-01  3.3297369e-01 -3.5492037e-04
  3.9253550e-04  1.5402706e-04]
[3.3510646e-01 3.3196402e-01 3.3292958e-01 7.5965287e-04 5.7242444e-04
 1.0112141e-04]
</pre></div>
</div>
</div>
</div>
</section>
<section id="s-hext">
<h2>s_hext<a class="headerlink" href="#s-hext" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch13.html#x15-156000813">[Essentials Chapter 13]</a> <a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#s_hext.py">[command line version]</a></p>
<p><strong>s_hext</strong> calculates Hext (1963, doi: 10.2307/2333905) statistics for anisotropy data in the six tensor element format.<br />
It  calls <strong>pmag.dohext()</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">dohext</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function dohext in module pmagpy.pmag:

dohext(nf, sigma, s)
    calculates hext parameters for nf, sigma and s
    
    Parameters
    __________
    nf :  number of degrees of freedom (measurements - 6)
    sigma : the sigma of the measurements
    s : [x11,x22,x33,x12,x23,x13] - the six tensor elements
    
    Return
    hpars : dictionary of Hext statistics with keys:
        &#39;F_crit&#39; : critical value for anisotropy
        &#39;F12_crit&#39; : critical value for tau1&gt;tau2, tau2&gt;3
        &#39;F&#39; : value of F
        &#39;F12&#39; : value of F12
        &#39;F23&#39; : value of F23
        &#39;v1_dec&#39;: declination of principal eigenvector
        &#39;v1_inc&#39;: inclination of principal eigenvector
        &#39;v2_dec&#39;: declination of major eigenvector
        &#39;v2_inc&#39;: inclination of major eigenvector
        &#39;v3_dec&#39;: declination of minor eigenvector
        &#39;v3_inc&#39;: inclination of minor eigenvector
        &#39;t1&#39;: principal eigenvalue
        &#39;t2&#39;: major eigenvalue
        &#39;t3&#39;: minor eigenvalue
        &#39;e12&#39;: angle of confidence ellipse of principal eigenvector in direction of major eigenvector
        &#39;e23&#39;: angle of confidence ellipse of major eigenvector in direction of minor eigenvector
        &#39;e13&#39;: angle of confidence ellipse of principal eigenvector in direction of minor eigenvector
    
    If working with data set with no sigmas and the average is desired, use nf,sigma,avs=pmag.sbar(Ss) as input
</pre></div>
</div>
</div>
</div>
<p>We are working with data that have no sigmas attached to them and want to average all the values in the file together.  Let’s look at the rotated data from the <a class="reference external" href="#s_geo"><strong>s_geo</strong></a> example.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># read in the data</span>
<span class="n">Ss</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;data_files/s_geo/s_geo_example.dat&#39;</span><span class="p">)</span>
<span class="c1"># make a container for the rotated S values</span>
<span class="n">SGeos</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">Ss</span><span class="p">:</span>
    <span class="n">SGeos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">dosgeo</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">7</span><span class="p">]))</span>
<span class="n">nf</span><span class="p">,</span><span class="n">sigma</span><span class="p">,</span><span class="n">avs</span><span class="o">=</span><span class="n">pmag</span><span class="o">.</span><span class="n">sbar</span><span class="p">(</span><span class="n">SGeos</span><span class="p">)</span>  <span class="c1"># get the average over all the data</span>
<span class="n">hpars</span><span class="o">=</span><span class="n">pmag</span><span class="o">.</span><span class="n">dohext</span><span class="p">(</span><span class="n">nf</span><span class="p">,</span><span class="n">sigma</span><span class="p">,</span><span class="n">avs</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">hpars</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;F_crit&#39;: &#39;2.4377&#39;, &#39;F12_crit&#39;: &#39;3.2199&#39;, &#39;F&#39;: 5.752167064666719, &#39;F12&#39;: 3.5510601243464004, &#39;F23&#39;: 3.663557566868797, &#39;v1_dec&#39;: 5.330894345303252, &#39;v1_inc&#39;: 14.682483596068828, &#39;v2_dec&#39;: 124.47233106679136, &#39;v2_inc&#39;: 61.71700837018042, &#39;v3_dec&#39;: 268.75792759495505, &#39;v3_inc&#39;: 23.599173682479822, &#39;t1&#39;: 0.3350527, &#39;t2&#39;: 0.33334228, &#39;t3&#39;: 0.331605, &#39;e12&#39;: 25.45983619637674, &#39;e23&#39;: 25.114754046379378, &#39;e13&#39;: 13.28977437428862}
</pre></div>
</div>
</div>
</div>
</section>
<section id="s-magic">
<h2>s_magic<a class="headerlink" href="#s-magic" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#s_magic.py">[command line version]</a></p>
<p>NEED TO ADD THIS ONE….</p>
</section>
<section id="s-tilt">
<h2>s_tilt<a class="headerlink" href="#s-tilt" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch13.html#x15-156000813">[Essentials Chapter 13]</a> <a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#s_tilt.py">[command line version]</a></p>
<p><strong>s_tilt</strong> takes the 6 tensor elements in geographic coordinates and applies the rotation similar to <a class="reference external" href="#di_tilt"><strong>di_tilt</strong></a> into stratigraphic coordinates.  It  calls <strong>pmag.dostilt()</strong>.  But be careful!  <strong>s_tilt.py</strong> (the command line program) assumes that the bedding info is the strike, with the dip to the right of strike unlike <strong>pmag.dostilt</strong> which assumes that the azimuth is the dip direction.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">dostilt</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function dostilt in module pmagpy.pmag:

dostilt(s, bed_az, bed_dip)
    Rotates &quot;s&quot; tensor to stratigraphic coordinates
    
    Parameters
    __________
    s : [x11,x22,x33,x12,x23,x13] - the six tensor elements
    bed_az : bedding dip direction
    bed_dip :  bedding dip
    
    Return
    s_rot : [x11,x22,x33,x12,x23,x13] - after rotation
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># note that the data in this example are Ss and strike and dip (not bed_az,bed_pl)</span>
<span class="n">Ss</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;data_files/s_tilt/s_tilt_example.dat&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">Ss</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">dostilt</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">+</span><span class="mf">90.</span><span class="p">,</span><span class="n">s</span><span class="p">[</span><span class="mi">7</span><span class="p">]))</span> <span class="c1"># make the bedding azimuth dip direction, not strike. </span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[ 0.3345571   0.33192658  0.3335163  -0.00043562  0.00092779  0.00105006]
[ 3.3585501e-01  3.3191565e-01  3.3222935e-01  5.5959972e-04
 -5.3161417e-05  6.4731773e-04]
[3.3586669e-01 3.3084923e-01 3.3328408e-01 1.4226610e-03 1.3233915e-04
 9.2028757e-05]
[ 3.3488664e-01  3.3138493e-01  3.3372843e-01 -5.6597008e-04
 -3.9085373e-04  4.8729391e-05]
[ 3.3506602e-01  3.3127019e-01  3.3366373e-01 -1.0519302e-03
 -5.7256600e-04 -2.9959495e-04]
[3.3407688e-01 3.3177567e-01 3.3414748e-01 7.0073889e-05 1.8446925e-04
 5.0731825e-05]
[ 3.3483925e-01  3.3197853e-01  3.3318222e-01 -2.8446535e-04
  3.5184901e-05 -2.9261652e-04]
[ 3.3513144e-01  3.3175036e-01  3.3311823e-01  7.7914412e-04
 -6.4021988e-05  4.6115947e-05]
</pre></div>
</div>
</div>
</div>
</section>
<section id="scalc">
<h2>scalc<a class="headerlink" href="#scalc" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch14.html#x15-156000813">[Essentials Chapter 14]</a> <a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#scalc.py">[command line version]</a></p>
<p>This program reads in data files with vgp_lon, vgp_lat and optional kappa, N, and site latitude.
It allows some filtering based on the requirements of the study, such as:</p>
<ul class="simple">
<li><p>Fisher k cutoff</p></li>
<li><p>VGP latitudinal cutoff</p></li>
<li><p>Vandamme (1994, doi: 10.1016/0031-9201(94)90012-4) iterative cutoff</p></li>
<li><p>flipping the reverse mode to antipodes</p></li>
<li><p>rotating principle direction to the spin axis</p></li>
<li><p>bootstrap confidence bounds</p></li>
<li><p>optionally calculates the scatter (Sp or Sf of McElhinny &amp; McFadden, 1997) of VGPs
with  correction for within site scatter.</p></li>
</ul>
<p>The filtering is just what <strong>Pandas</strong> was designed for, so we can  calls <strong>pmag.scalc_vgp_df()</strong> which works on a suitably constructed  <strong>Pandas</strong> DataFrame.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">scalc_vgp_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function scalc_vgp_df in module pmagpy.pmag:

scalc_vgp_df(vgp_df, anti=0, rev=0, cutoff=180.0, kappa=0, n=0, spin=0, v=0, boot=0, mm97=0, nb=1000)
    Calculates Sf for a dataframe with VGP Lat., and optional Fisher&#39;s k, site latitude and N information can be used to correct for within site scatter (McElhinny &amp; McFadden, 1997)
    
    Parameters
    _________
    df : Pandas Dataframe with columns
        REQUIRED:
        vgp_lat :  VGP latitude
        ONLY REQUIRED for MM97 correction:
        dir_k : Fisher kappa estimate
        dir_n_samples : number of samples per site
        lat : latitude of the site
        mm97 : if True, will do the correction for within site scatter
        OPTIONAL:
        boot : if True. do bootstrap
        nb : number of bootstraps, default is 1000
    
    Returns
    _____________
        N : number of VGPs used in calculation
        S : S
        low : 95% confidence lower bound [0 if boot=0]
        high  95% confidence upper bound [0 if boot=0]
        cutoff : cutoff used in calculation of  S
</pre></div>
</div>
</div>
</div>
<p>To just calculate the value of S (without the within site scatter) we read in a data file and attach the correct headers to it depending on what is in it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vgp_df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data_files/scalc/scalc_example.txt&#39;</span><span class="p">,</span><span class="n">delim_whitespace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">vgp_df</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
    <span class="n">vgp_df</span><span class="o">.</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;vgp_lon&#39;</span><span class="p">,</span><span class="s1">&#39;vgp_lat&#39;</span><span class="p">]</span>
    <span class="n">vgp_df</span><span class="p">[</span><span class="s1">&#39;dir_k&#39;</span><span class="p">],</span><span class="n">vgp_df</span><span class="p">[</span><span class="s1">&#39;dir_n&#39;</span><span class="p">],</span><span class="n">vgp_df</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">vgp_df</span><span class="o">.</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;vgp_lon&#39;</span><span class="p">,</span><span class="s1">&#39;vgp_lat&#39;</span><span class="p">,</span><span class="s1">&#39;dir_k&#39;</span><span class="p">,</span><span class="s1">&#39;dir_n_samples&#39;</span><span class="p">,</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span>
<span class="n">pmag</span><span class="o">.</span><span class="n">scalc_vgp_df</span>
<span class="n">N</span><span class="p">,</span><span class="n">S_B</span><span class="p">,</span><span class="n">low</span><span class="p">,</span><span class="n">high</span><span class="p">,</span><span class="n">cutoff</span><span class="o">=</span><span class="n">pmag</span><span class="o">.</span><span class="n">scalc_vgp_df</span><span class="p">(</span><span class="n">vgp_df</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%7.1f</span><span class="s1">  </span><span class="si">%7.1f</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">S_B</span><span class="p">,</span> <span class="n">cutoff</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100    21.8    180.0 
</pre></div>
</div>
</div>
</div>
<p>To apply a cutoff for the Fisher k value, we just filter the DataFrame prior to calculating S_b. Let’s filter for kappa&gt;50</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span><span class="p">,</span><span class="n">S_B</span><span class="p">,</span><span class="n">low</span><span class="p">,</span><span class="n">high</span><span class="p">,</span><span class="n">cutoff</span><span class="o">=</span><span class="n">pmag</span><span class="o">.</span><span class="n">scalc_vgp_df</span><span class="p">(</span><span class="n">vgp_df</span><span class="p">,</span><span class="n">kappa</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%7.1f</span><span class="s1">  </span><span class="si">%7.1f</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">S_B</span><span class="p">,</span> <span class="n">cutoff</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>73    18.5    180.0 
</pre></div>
</div>
</div>
</div>
<p>To apply the Vandamme (1994) approach, we set v to True</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span><span class="p">,</span><span class="n">S_B</span><span class="p">,</span><span class="n">low</span><span class="p">,</span><span class="n">high</span><span class="p">,</span><span class="n">cutoff</span><span class="o">=</span><span class="n">pmag</span><span class="o">.</span><span class="n">scalc_vgp_df</span><span class="p">(</span><span class="n">vgp_df</span><span class="p">,</span><span class="n">v</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%7.1f</span><span class="s1">  </span><span class="si">%7.1f</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">S_B</span><span class="p">,</span> <span class="n">cutoff</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>89    15.2     32.3 
</pre></div>
</div>
</div>
</div>
<p>To flip the “reverse” directions, we set anti to 1</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span><span class="p">,</span><span class="n">S_B</span><span class="p">,</span><span class="n">low</span><span class="p">,</span><span class="n">high</span><span class="p">,</span><span class="n">cutoff</span><span class="o">=</span><span class="n">pmag</span><span class="o">.</span><span class="n">scalc_vgp_df</span><span class="p">(</span><span class="n">vgp_df</span><span class="p">,</span><span class="n">anti</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%7.1f</span><span class="s1">  </span><span class="si">%7.1f</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">S_B</span><span class="p">,</span> <span class="n">cutoff</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>flipping reverse
100    21.1    180.0 
</pre></div>
</div>
</div>
</div>
<p>And, to do relative to the spin axis, set spin to True:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span><span class="p">,</span><span class="n">S_B</span><span class="p">,</span><span class="n">low</span><span class="p">,</span><span class="n">high</span><span class="p">,</span><span class="n">cutoff</span><span class="o">=</span><span class="n">pmag</span><span class="o">.</span><span class="n">scalc_vgp_df</span><span class="p">(</span><span class="n">vgp_df</span><span class="p">,</span><span class="n">spin</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%7.1f</span><span class="s1">  </span><span class="si">%7.1f</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">S_B</span><span class="p">,</span> <span class="n">cutoff</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100    21.6    180.0 
</pre></div>
</div>
</div>
</div>
</section>
<section id="scalc-magic">
<h2>scalc_magic<a class="headerlink" href="#scalc-magic" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch14.html#x15-156000813">[Essentials Chapter 14]</a> <a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#scalc_magic.py">[command line version]</a></p>
<p>This program does the same thing as <a class="reference external" href="#scalc"><strong>scalc</strong></a>, but reads in a MagIC formatted file. So, we can do that easy-peasy.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vgp_df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data_files/scalc_magic/sites.txt&#39;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">N</span><span class="p">,</span><span class="n">S_B</span><span class="p">,</span><span class="n">low</span><span class="p">,</span><span class="n">high</span><span class="p">,</span><span class="n">cutoff</span><span class="o">=</span><span class="n">pmag</span><span class="o">.</span><span class="n">scalc_vgp_df</span><span class="p">(</span><span class="n">vgp_df</span><span class="p">,</span><span class="n">anti</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%7.1f</span><span class="s1">  </span><span class="si">%7.1f</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">S_B</span><span class="p">,</span> <span class="n">cutoff</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>flipping reverse
21    17.3    180.0 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vgp_df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data_files/scalc_magic/sites.txt&#39;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">N</span><span class="p">,</span><span class="n">S_B</span><span class="p">,</span><span class="n">low</span><span class="p">,</span><span class="n">high</span><span class="p">,</span><span class="n">cutoff</span><span class="o">=</span><span class="n">pmag</span><span class="o">.</span><span class="n">scalc_vgp_df</span><span class="p">(</span><span class="n">vgp_df</span><span class="p">,</span><span class="n">anti</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">spin</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%7.1f</span><span class="s1">  </span><span class="si">%7.1f</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">S_B</span><span class="p">,</span> <span class="n">cutoff</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>flipping reverse
21    16.8    180.0 
</pre></div>
</div>
</div>
</div>
</section>
<section id="separate-directions">
<h2>separate_directions<a class="headerlink" href="#separate-directions" title="Permalink to this headline">#</a></h2>
<p>Like <a class="reference external" href="#flip">pmag.flip( )</a>, <strong>pmag.separate_directions</strong> divides a directional data set into two modes.  Unlike <a class="reference external" href="#flip">pmag.flip( )</a>, it returns the two separate modes (e.g., normal and reverse)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">separate_directions</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function separate_directions in module pmagpy.pmag:

separate_directions(di_block)
    Separates set of directions into two modes based on principal direction
    
    Parameters
    _______________
    di_block : block of nested dec,inc pairs
    
    Return
    mode_1_block,mode_2_block :  two lists of nested dec,inc pairs
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#read in the data into an array</span>
<span class="n">vectors</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;data_files/eqarea_ell/tk03.out&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="n">di_block</span><span class="o">=</span><span class="n">vectors</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="c1"># decs are di_block[0], incs are di_block[1]</span>
<span class="c1"># flip the reverse directions to their normal antipodes</span>
<span class="n">normal</span><span class="p">,</span><span class="n">reverse</span><span class="o">=</span><span class="n">pmag</span><span class="o">.</span><span class="n">separate_directions</span><span class="p">(</span><span class="n">di_block</span><span class="p">)</span>
<span class="c1"># and plot them up</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">plot_net</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">plot_di</span><span class="p">(</span><span class="n">di_block</span><span class="o">=</span><span class="n">normal</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">plot_di</span><span class="p">(</span><span class="n">di_block</span><span class="o">=</span><span class="n">reverse</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/PmagPy_calculations_177_0.png" src="../_images/PmagPy_calculations_177_0.png" />
</div>
</div>
</section>
<section id="squish">
<h2>squish<a class="headerlink" href="#squish" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch7.html#x15-156000813">[Essentials Chapter 7]</a> <a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#squish.py">[command line version]</a></p>
<p>This program reads in dec/inc data and “squishes” the inclinations using the formula from King
(1955, doi: 10.1111/j.1365-246X.1955.tb06558.x)  <span class="math notranslate nohighlight">\(\tan(I_o)=flat \tan(I_f)\)</span>.  [See also <a class="reference external" href="#unsquish">unsquish</a>].
We can call <strong>pmag.squish()</strong> from within the notebook.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">squish</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function squish in module pmagpy.pmag:

squish(incs, f)
    returns &#39;flattened&#39; inclination, assuming factor, f and King (1955) formula:
    tan (I_o) = f tan (I_f)
    
    Parameters
    __________
    incs : array of inclination (I_f)  data to flatten
    f : flattening factor
    
    Returns
    _______
    I_o :  inclinations after flattening
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">di_block</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;data_files/squish/squish_example.dat&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="n">decs</span><span class="o">=</span><span class="n">di_block</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">incs</span><span class="o">=</span><span class="n">di_block</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">flat</span><span class="o">=</span><span class="mf">0.4</span>
<span class="n">fincs</span><span class="o">=</span><span class="n">pmag</span><span class="o">.</span><span class="n">squish</span><span class="p">(</span><span class="n">incs</span><span class="p">,</span><span class="n">flat</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ipmag</span><span class="o">.</span><span class="n">plot_net</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">plot_di</span><span class="p">(</span><span class="n">dec</span><span class="o">=</span><span class="n">decs</span><span class="p">,</span><span class="n">inc</span><span class="o">=</span><span class="n">incs</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Original&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">plot_net</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">plot_di</span><span class="p">(</span><span class="n">dec</span><span class="o">=</span><span class="n">decs</span><span class="p">,</span><span class="n">inc</span><span class="o">=</span><span class="n">fincs</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Squished&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/PmagPy_calculations_181_0.png" src="../_images/PmagPy_calculations_181_0.png" />
<img alt="../_images/PmagPy_calculations_181_1.png" src="../_images/PmagPy_calculations_181_1.png" />
</div>
</div>
</section>
<section id="stats">
<h2>stats<a class="headerlink" href="#stats" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch11.html#x15-156000813">[Essentials Chapter 11]</a> <a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#/stats.py">[command line version]</a></p>
<p>This program just calculates the N, mean, sum, sigma and sigma % for data.  There are numerous ways to do that in <strong>Numpy</strong>, so let’s just use those.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;data_files/gaussian/gauss.out&#39;</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">data</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span><span class="n">data</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span><span class="n">data</span><span class="o">.</span><span class="n">std</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100 9.949869990000002 994.9869990000001 0.9533644867617789
</pre></div>
</div>
</div>
</div>
</section>
<section id="strip-magic">
<h2>strip_magic<a class="headerlink" href="#strip-magic" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch15.html">[Essentials Chapter 15]</a>
<a class="reference external" href="https://earthref.org/MagIC">[MagIC Database]</a>
<a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#strip_magic.py">[command line version]</a></p>
<p>We can do this easily using the wonders of <strong>Pandas</strong> and <strong>matplotlib</strong> as demonstrated here.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># read in the data</span>
<span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data_files/strip_magic/sites.txt&#39;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># see what&#39;s there</span>
<span class="n">data</span><span class="o">.</span><span class="n">columns</span>

<span class="c1"># you might have to use **df.dropna()** to clean off unwanted NaN lines or other data massaging</span>
<span class="c1"># but not for this example</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;site&#39;, &#39;location&#39;, &#39;age&#39;, &#39;age_unit&#39;, &#39;dir_dec&#39;, &#39;dir_inc&#39;,
       &#39;core_depth&#39;, &#39;lat&#39;, &#39;lon&#39;, &#39;geologic_classes&#39;, &#39;geologic_types&#39;,
       &#39;lithologies&#39;, &#39;citations&#39;, &#39;vgp_lat&#39;, &#39;vgp_lon&#39;, &#39;paleolatitude&#39;,
       &#39;vgp_lat_rev&#39;, &#39;vgp_lon_rev&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span> <span class="c1"># make the figure</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">age</span><span class="p">,</span><span class="n">data</span><span class="o">.</span><span class="n">vgp_lat</span><span class="p">,</span><span class="s1">&#39;b-&#39;</span><span class="p">)</span> <span class="c1"># plot as blue line</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">age</span><span class="p">,</span><span class="n">data</span><span class="o">.</span><span class="n">vgp_lat</span><span class="p">,</span><span class="s1">&#39;ro&#39;</span><span class="p">,</span><span class="n">markeredgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span> <span class="c1"># plot as red dots with black rims</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Age (Ma)&#39;</span><span class="p">)</span> <span class="c1"># label the time axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;VGP Lat.$^{\circ}$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="mi">90</span><span class="p">)</span> <span class="c1"># set the plot limits</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">);</span> <span class="c1"># put on a zero line</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/PmagPy_calculations_186_0.png" src="../_images/PmagPy_calculations_186_0.png" />
</div>
</div>
</section>
<section id="sundec">
<h2>sundec<a class="headerlink" href="#sundec" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch9.html">[Essentials Chapter 9]</a>
<a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#sundec.py">[command line version]</a></p>
<p>Paleomagnetists often use the sun to orient their cores, especially if the sampling site is strongly magnetic and would deflect the magnetic compass.  The information required is: where are you (e.g., latitude and longitude), what day is it, what time is it in Greenwhich Mean Time (a.k.a. Universal Time) and where is the sun (e.g., the antipode of the angle the shadow of a gnomon makes with the desired direction)?</p>
<p>This calculation is surprisingly accurate and is implemented in the function
<strong>pmag.dosundec()</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">dosundec</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function dosundec in module pmagpy.pmag:

dosundec(sundata)
    returns the declination for a given set of suncompass data
    Parameters
    __________
      sundata : dictionary with these keys:
          date: time string with the format &#39;yyyy:mm:dd:hr:min&#39;
          delta_u: time to SUBTRACT from local time for Universal time
          lat: latitude of location (negative for south)
          lon: longitude of location (negative for west)
          shadow_angle: shadow angle of the desired direction with respect to the sun.
    Returns
    ________
       sunaz : the declination of the desired direction wrt true north.
</pre></div>
</div>
</div>
</div>
<p>Say you (or your elderly colleague) were located at 35<span class="math notranslate nohighlight">\(^{\circ}\)</span> N and 33<span class="math notranslate nohighlight">\(^{\circ}\)</span> E. The local time was three hours ahead of Universal Time. The shadow angle for the drilling direction was 68<span class="math notranslate nohighlight">\(^{\circ}\)</span>  measured at 16:09 on May 23, 1994. <strong>pmag.dosundec()</strong> requires a dictionary with the necessary information:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sundata</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;delta_u&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;lat&#39;</span><span class="p">:</span><span class="mi">35</span><span class="p">,</span><span class="s1">&#39;lon&#39;</span><span class="p">:</span><span class="mi">33</span><span class="p">,</span>\
         <span class="s1">&#39;date&#39;</span><span class="p">:</span><span class="s1">&#39;1994:05:23:16:9&#39;</span><span class="p">,</span><span class="s1">&#39;shadow_angle&#39;</span><span class="p">:</span><span class="mi">68</span><span class="p">}</span>
<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;</span><span class="si">%7.1f</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">dosundec</span><span class="p">(</span><span class="n">sundata</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  154.2
</pre></div>
</div>
</div>
</div>
</section>
<section id="tk03">
<h2>tk03<a class="headerlink" href="#tk03" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch16.html">[Essentials Chapter 16]</a>
<a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#tk03.py">[command line version]</a></p>
<p>Sometimes it is useful to generate a distribution of synthetic geomagnetic field vectors that you might expect to find from paleosecular variation of the geomagnetic field. The program <strong>tk03</strong> generates distributions of field vectors from the PSV model of Tauxe and Kent (2004, doi: 10.1029/145GM08).  This program was implemented for notebook use as <strong>ipmag.tk03()</strong>.  [See also <a class="reference external" href="#find_ei"><strong>find_ei</strong></a>].</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">ipmag</span><span class="o">.</span><span class="n">tk03</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function tk03 in module pmagpy.ipmag:

tk03(n=100, dec=0, lat=0, rev=&#39;no&#39;, G2=0, G3=0)
    Generates vectors drawn from the TK03.gad model of secular
    variation (Tauxe and Kent, 2004) at given latitude and rotated
    about a vertical axis by the given declination. Return a nested list of
    of [dec,inc,intensity].
    
    Parameters
    ----------
    n : number of vectors to determine (default is 100)
    dec : mean declination of data set (default is 0)
    lat : latitude at which secular variation is simulated (default is 0)
    rev : if reversals are to be included this should be &#39;yes&#39; (default is &#39;no&#39;)
    G2 : specify average g_2^0 fraction (default is 0)
    G3 : specify average g_3^0 fraction (default is 0)
    
    Returns
    ----------
    tk_03_output : a nested list of declination, inclination, and intensity (in nT)
    
    Examples
    --------
    &gt;&gt;&gt; ipmag.tk03(n=5, dec=0, lat=0)
    [[14.752502674158681, -36.189370642603834, 16584.848620957589],
     [9.2859465437113311, -10.064247301056071, 17383.950391596223],
     [2.4278460589582913, 4.8079990844938019, 18243.679003572055],
     [352.93759572283585, 0.086693343935840397, 18524.551174838372],
     [352.48366219759953, 11.579098286352332, 24928.412830772766]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">di_block</span><span class="o">=</span><span class="n">ipmag</span><span class="o">.</span><span class="n">tk03</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">plot_net</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">plot_di</span><span class="p">(</span><span class="n">di_block</span><span class="o">=</span><span class="n">di_block</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">edge</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/PmagPy_calculations_193_0.png" src="../_images/PmagPy_calculations_193_0.png" />
</div>
</div>
</section>
<section id="uniform">
<h2>uniform<a class="headerlink" href="#uniform" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#uniform.py">[command line version]</a></p>
<p>It is at times handy to be able to generate a uniformly distributed set of directions (or geographic locations). This is done using a technique described by Fisher et al. (Fisher, N. I., Lewis, T., &amp; Embleton, B. J. J. (1987). Statistical Analysis of Spherical Data. Cambridge: Cambridge University Press).   We do this by calling  <strong>pmag.get_unf()</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">get_unf</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function get_unf in module pmagpy.pmag:

get_unf(N=100)
    Generates N uniformly distributed directions
    using the way described in Fisher et al. (1987).
    Parameters
    __________
    N : number of directions, default is 100
    
    Returns
    ______
    array of nested dec,inc pairs
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">di_block</span><span class="o">=</span><span class="n">pmag</span><span class="o">.</span><span class="n">get_unf</span><span class="p">()</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">plot_net</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">plot_di</span><span class="p">(</span><span class="n">di_block</span><span class="o">=</span><span class="n">di_block</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">edge</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/PmagPy_calculations_196_0.png" src="../_images/PmagPy_calculations_196_0.png" />
</div>
</div>
</section>
<section id="unsquish">
<h2>unsquish<a class="headerlink" href="#unsquish" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch7.html#x15-156000813">[Essentials Chapter 7]</a>
<a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch16.html#x15-156000813">[Essentials Chapter 16]</a>
<a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#unsquish.py">[command line version]</a></p>
<p>This program is just the inverse of <a class="reference external" href="#squish"><strong>squish</strong></a> in that it takes “squished” data and “unsquishes” them, assuming a King (1955, doi: 10.1111/j.1365-246X.1955.tb06558.x)  relationship:  <span class="math notranslate nohighlight">\(\tan(I_o)=flat \tan(I_f)\)</span>. So, <span class="math notranslate nohighlight">\(\tan(I_f) = \tan(I_o)/flat\)</span>.</p>
<p>It calls <strong>pmag.unquish()</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">unsquish</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function unsquish in module pmagpy.pmag:

unsquish(incs, f)
    returns &#39;unflattened&#39; inclination, assuming factor, f and King (1955) formula:
    tan (I_o) = tan (I_f)/f
    
    Parameters
    __________
    incs : array of inclination (I_f)  data to unflatten
    f : flattening factor
    
    Returns
    _______
    I_o :  inclinations after unflattening
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">di_block</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;data_files/unsquish/unsquish_example.dat&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="n">decs</span><span class="o">=</span><span class="n">di_block</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">incs</span><span class="o">=</span><span class="n">di_block</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">flat</span><span class="o">=</span><span class="mf">.4</span>
<span class="n">fincs</span><span class="o">=</span><span class="n">pmag</span><span class="o">.</span><span class="n">unsquish</span><span class="p">(</span><span class="n">incs</span><span class="p">,</span><span class="n">flat</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ipmag</span><span class="o">.</span><span class="n">plot_net</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">plot_di</span><span class="p">(</span><span class="n">dec</span><span class="o">=</span><span class="n">decs</span><span class="p">,</span><span class="n">inc</span><span class="o">=</span><span class="n">incs</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Squished&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">plot_net</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ipmag</span><span class="o">.</span><span class="n">plot_di</span><span class="p">(</span><span class="n">dec</span><span class="o">=</span><span class="n">decs</span><span class="p">,</span><span class="n">inc</span><span class="o">=</span><span class="n">fincs</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Unsquished&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/PmagPy_calculations_200_0.png" src="../_images/PmagPy_calculations_200_0.png" />
<img alt="../_images/PmagPy_calculations_200_1.png" src="../_images/PmagPy_calculations_200_1.png" />
</div>
</div>
</section>
<section id="vdm-b">
<h2>vdm_b<a class="headerlink" href="#vdm-b" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch2.html#x15-1560002">[Essentials Chapter 2]</a>  <a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#vdm_b.py">[command line version]</a></p>
<p><strong>vdm_b</strong> is the inverse of <a class="reference external" href="#b_vdm"><strong>b_vdm</strong></a> in that it converts a virtual [axial] dipole moment (vdm or vadm) to a predicted geomagnetic field intensity observed at the earth’s surface at a particular (paleo)latitude. This  program calls <strong>pmag.vdm_b()</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">vdm_b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function vdm_b in module pmagpy.pmag:

vdm_b(vdm, lat)
    Converts a virtual dipole moment (VDM) or a virtual axial dipole moment
    (VADM; input in units of Am^2) to a local magnetic field value (output in
    units of tesla)
    
    Parameters
    ----------
    vdm : V(A)DM in units of Am^2
    lat: latitude of site in degrees
    
    Returns
    -------
    B: local magnetic field strength in tesla
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;</span><span class="si">%7.1f</span><span class="s1"> microtesla&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">vdm_b</span><span class="p">(</span><span class="mf">7.159e22</span><span class="p">,</span><span class="mi">22</span><span class="p">)</span><span class="o">*</span><span class="mf">1e6</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   33.0 microtesla
</pre></div>
</div>
</div>
</div>
</section>
<section id="vector-mean">
<h2>vector_mean<a class="headerlink" href="#vector-mean" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch2.html#x15-1560002">[Essentials Chapter 2]</a>  <a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#vector_mean.py">[command line version]</a></p>
<p><strong>vector_mean</strong> calculates the vector mean for a set of vectors in polar coordinates (e.g., declination, inclination, intensity).  This is similar to the Fisher mean (<a class="reference external" href="#gofish"><strong>gofish</strong></a>) but uses vector length instead of unit vectors.  It calls
calls <strong>pmag.vector_mean()</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">vector_mean</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function vector_mean in module pmagpy.pmag:

vector_mean(data)
    calculates the vector mean of a given set of vectors
    Parameters
    __________
    data :  nested array of [dec,inc,intensity]
    
    Returns
    _______
    dir : array of [dec, inc, 1]
    R : resultant vector length
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;data_files/vector_mean/vector_mean_example.dat&#39;</span><span class="p">)</span>
<span class="n">Dir</span><span class="p">,</span><span class="n">R</span><span class="o">=</span><span class="n">pmag</span><span class="o">.</span><span class="n">vector_mean</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">((</span><span class="s1">&#39;</span><span class="si">%i</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1"> </span><span class="si">%f</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">%</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">Dir</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">Dir</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">R</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100     1.3    49.6 2289431.981383
</pre></div>
</div>
</div>
</div>
</section>
<section id="vgp-di">
<h2>vgp_di<a class="headerlink" href="#vgp-di" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch2.html">[Essentials Chapter 2]</a>
<a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#vgp_di.py">[command line version]</a></p>
<p>We use <strong>vgp_di</strong> to convert virtual geomagnetic pole positions to predicted directions at a given location.  [See also <a class="reference external" href="#di_vgp"><strong>di_vgp</strong></a>].</p>
<p>This program uses the function <strong>pmag.vgp_di()</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">vgp_di</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function vgp_di in module pmagpy.pmag:

vgp_di(plat, plong, slat, slong)
    Converts a pole position (pole latitude, pole longitude) to a direction
    (declination, inclination) at a given location (slat, slong) assuming a
    dipolar field.
    
    Parameters
    ----------
    plat : latitude of pole (vgp latitude)
    plong : longitude of pole (vgp longitude)
    slat : latitude of site
    slong : longitude of site
    
    Returns
    ----------
    dec,inc : tuple of declination and inclination
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="p">,</span><span class="n">i</span><span class="o">=</span><span class="n">pmag</span><span class="o">.</span><span class="n">vgp_di</span><span class="p">(</span><span class="mi">68</span><span class="p">,</span><span class="mi">191</span><span class="p">,</span><span class="mi">33</span><span class="p">,</span><span class="mi">243</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;</span><span class="si">%7.1f</span><span class="s1"> </span><span class="si">%7.1f</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="n">i</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  335.6    62.9
</pre></div>
</div>
</div>
</div>
</section>
<section id="watsons-f">
<h2>watsons_f<a class="headerlink" href="#watsons-f" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="https://earthref.org/MagIC/books/Tauxe/Essentials/WebBook3ch11.html">[Essentials Chapter 11]</a>
<a class="reference external" href="https://pmagpy.github.io/PmagPy-cli.html#watsons_f.py">[command line version]</a></p>
<p>There are several different ways of testing whether two sets of directional data share a common mean.  One popular (although perhaps not the best) way is to use Watson’s F test (Watson, 1956, doi: 10.1111/j.1365-246X.1956.tb05560.x).   [See also <a class="reference external" href="#watsons_v"><strong>watsons_v</strong></a> or  Lisa Tauxe’s bootstrap way: <a class="reference external" href="#common_mean"><strong>common_mean</strong></a>].</p>
<p>If you still want to use Waston’s F, then try
<strong>pmag.watsons_f()</strong> for this.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pmag</span><span class="o">.</span><span class="n">watsons_f</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function watsons_f in module pmagpy.pmag:

watsons_f(DI1, DI2)
    calculates Watson&#39;s F statistic (equation 11.16 in Essentials text book).
    
    Parameters
    _________
    DI1 : nested array of [Dec,Inc] pairs
    DI2 : nested array of [Dec,Inc] pairs
    
    Returns
    _______
    F : Watson&#39;s F
    Fcrit : critical value from F table
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DI1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;data_files/watsons_f/watsons_f_example_file1.dat&#39;</span><span class="p">)</span>
<span class="n">DI2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;data_files/watsons_f/watsons_f_example_file2.dat&#39;</span><span class="p">)</span>
<span class="n">F</span><span class="p">,</span><span class="n">Fcrit</span><span class="o">=</span><span class="n">pmag</span><span class="o">.</span><span class="n">watsons_f</span><span class="p">(</span><span class="n">DI1</span><span class="p">,</span><span class="n">DI2</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;</span><span class="si">%7.2f</span><span class="s1"> </span><span class="si">%7.2f</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">F</span><span class="p">,</span><span class="n">Fcrit</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   5.23    3.26
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./documentation_notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="PmagPy_introduction.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Introduction to PmagPy</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="PmagPy_plots_analysis.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Visualizations and more analysis with PmagPy</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Lisa Tauxe, Nick Swanson-Hysell, and Lori Jonestrask<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>